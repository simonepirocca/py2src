[{"sha": "a22871f50a78d5d6784b6e978014bfa1b70a98ce", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6YTIyODcxZjUwYTc4ZDVkNjc4NGI2ZTk3ODAxNGJmYTFiNzBhOThjZQ==", "commit": {"author": {"name": "gengjiaan", "email": "gengjiaan@360.cn", "date": "2020-09-10T11:25:32Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-10T11:25:32Z"}, "message": "[SPARK-32777][SQL] Aggregation support aggregate function with multiple foldable expressions\n\n### What changes were proposed in this pull request?\nSpark SQL exists a bug show below:\n\n```\nspark.sql(\n  \" SELECT COUNT(DISTINCT 2), COUNT(DISTINCT 2, 3)\")\n  .show()\n+-----------------+--------------------+\n|count(DISTINCT 2)|count(DISTINCT 2, 3)|\n+-----------------+--------------------+\n|                1|                   1|\n+-----------------+--------------------+\n\nspark.sql(\n  \" SELECT COUNT(DISTINCT 2), COUNT(DISTINCT 3, 2)\")\n  .show()\n+-----------------+--------------------+\n|count(DISTINCT 2)|count(DISTINCT 3, 2)|\n+-----------------+--------------------+\n|                1|                   0|\n+-----------------+--------------------+\n```\nThe first query is correct, but the second query is not.\nThe root reason is the second query rewrited by `RewriteDistinctAggregates` who expand the output but lost the 2.\n\n### Why are the changes needed?\nFix a bug.\n`SELECT COUNT(DISTINCT 2), COUNT(DISTINCT 3, 2)` should return `1, 1`\n\n### Does this PR introduce _any_ user-facing change?\nYes\n\n### How was this patch tested?\nNew UT\n\nCloses #29626 from beliefer/support-multiple-foldable-distinct-expressions.\n\nLead-authored-by: gengjiaan <gengjiaan@360.cn>\nCo-authored-by: beliefer <beliefer@163.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "b39dcf33b0c6579447007ea21925e0ee4ca5f9c8", "url": "https://api.github.com/repos/apache/spark/git/trees/b39dcf33b0c6579447007ea21925e0ee4ca5f9c8"}, "url": "https://api.github.com/repos/apache/spark/git/commits/a22871f50a78d5d6784b6e978014bfa1b70a98ce", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/a22871f50a78d5d6784b6e978014bfa1b70a98ce", "html_url": "https://github.com/apache/spark/commit/a22871f50a78d5d6784b6e978014bfa1b70a98ce", "comments_url": "https://api.github.com/repos/apache/spark/commits/a22871f50a78d5d6784b6e978014bfa1b70a98ce/comments", "author": {"login": "beliefer", "id": 8486025, "node_id": "MDQ6VXNlcjg0ODYwMjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/8486025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/beliefer", "html_url": "https://github.com/beliefer", "followers_url": "https://api.github.com/users/beliefer/followers", "following_url": "https://api.github.com/users/beliefer/following{/other_user}", "gists_url": "https://api.github.com/users/beliefer/gists{/gist_id}", "starred_url": "https://api.github.com/users/beliefer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/beliefer/subscriptions", "organizations_url": "https://api.github.com/users/beliefer/orgs", "repos_url": "https://api.github.com/users/beliefer/repos", "events_url": "https://api.github.com/users/beliefer/events{/privacy}", "received_events_url": "https://api.github.com/users/beliefer/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5669b212ec38a55ce5db62835801a65ff1021c7f", "url": "https://api.github.com/repos/apache/spark/commits/5669b212ec38a55ce5db62835801a65ff1021c7f", "html_url": "https://github.com/apache/spark/commit/5669b212ec38a55ce5db62835801a65ff1021c7f"}]}, {"sha": "5669b212ec38a55ce5db62835801a65ff1021c7f", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6NTY2OWIyMTJlYzM4YTU1Y2U1ZGI2MjgzNTgwMWE2NWZmMTAyMWM3Zg==", "commit": {"author": {"name": "Kent Yao", "email": "yaooqinn@hotmail.com", "date": "2020-09-10T11:20:05Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-10T11:20:05Z"}, "message": "[SPARK-32840][SQL] Invalid interval value can happen to be just adhesive with the unit\n\n### What changes were proposed in this pull request?\nIn this PR, we add a checker for STRING form interval value ahead for parsing multiple units intervals and fail directly if the interval value contains alphabets to prevent correctness issues like `interval '1 day 2' day`=`3 days`.\n\n### Why are the changes needed?\n\nfix correctness issue\n\n### Does this PR introduce _any_ user-facing change?\n\nyes, in spark 3.0.0 `interval '1 day 2' day`=`3 days` but now we fail with ParseException\n### How was this patch tested?\n\nadd a test.\n\nCloses #29708 from yaooqinn/SPARK-32840.\n\nAuthored-by: Kent Yao <yaooqinn@hotmail.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "a1e198d0ad296a666e33f7c475aca6599191b532", "url": "https://api.github.com/repos/apache/spark/git/trees/a1e198d0ad296a666e33f7c475aca6599191b532"}, "url": "https://api.github.com/repos/apache/spark/git/commits/5669b212ec38a55ce5db62835801a65ff1021c7f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/5669b212ec38a55ce5db62835801a65ff1021c7f", "html_url": "https://github.com/apache/spark/commit/5669b212ec38a55ce5db62835801a65ff1021c7f", "comments_url": "https://api.github.com/repos/apache/spark/commits/5669b212ec38a55ce5db62835801a65ff1021c7f/comments", "author": {"login": "yaooqinn", "id": 8326978, "node_id": "MDQ6VXNlcjgzMjY5Nzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/8326978?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaooqinn", "html_url": "https://github.com/yaooqinn", "followers_url": "https://api.github.com/users/yaooqinn/followers", "following_url": "https://api.github.com/users/yaooqinn/following{/other_user}", "gists_url": "https://api.github.com/users/yaooqinn/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaooqinn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaooqinn/subscriptions", "organizations_url": "https://api.github.com/users/yaooqinn/orgs", "repos_url": "https://api.github.com/users/yaooqinn/repos", "events_url": "https://api.github.com/users/yaooqinn/events{/privacy}", "received_events_url": "https://api.github.com/users/yaooqinn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7eb76d698836a251065753117e22285dd1a8aa8f", "url": "https://api.github.com/repos/apache/spark/commits/7eb76d698836a251065753117e22285dd1a8aa8f", "html_url": "https://github.com/apache/spark/commit/7eb76d698836a251065753117e22285dd1a8aa8f"}]}, {"sha": "7eb76d698836a251065753117e22285dd1a8aa8f", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6N2ViNzZkNjk4ODM2YTI1MTA2NTc1MzExN2UyMjI4NWRkMWE4YWE4Zg==", "commit": {"author": {"name": "Takeshi Yamamuro", "email": "yamamuro@apache.org", "date": "2020-09-10T10:19:26Z"}, "committer": {"name": "Takeshi Yamamuro", "email": "yamamuro@apache.org", "date": "2020-09-10T10:19:26Z"}, "message": "[SPARK-32828][SQL] Cast from a derived user-defined type to a base type\n\n### What changes were proposed in this pull request?\n\nThis PR intends to fix an existing bug below in `UserDefinedTypeSuite`;\n```\n[info] - SPARK-19311: UDFs disregard UDT type hierarchy (931 milliseconds)\n16:22:35.936 WARN org.apache.spark.sql.catalyst.expressions.SafeProjection: Expr codegen error and falling back to interpreter mode\norg.apache.spark.SparkException: Cannot cast org.apache.spark.sql.ExampleSubTypeUDT46b1771f to org.apache.spark.sql.ExampleBaseTypeUDT31e8d979.\n\tat org.apache.spark.sql.catalyst.expressions.CastBase.nullSafeCastFunction(Cast.scala:891)\n\tat org.apache.spark.sql.catalyst.expressions.CastBase.doGenCode(Cast.scala:852)\n\tat org.apache.spark.sql.catalyst.expressions.Expression.$anonfun$genCode$3(Expression.scala:147)\n    ...\n```\n\n### Why are the changes needed?\n\nbugfix\n\n### Does this PR introduce _any_ user-facing change?\n\nNo.\n\n### How was this patch tested?\n\nAdded unit tests.\n\nCloses #29691 from maropu/FixUdtBug.\n\nAuthored-by: Takeshi Yamamuro <yamamuro@apache.org>\nSigned-off-by: Takeshi Yamamuro <yamamuro@apache.org>", "tree": {"sha": "3401e56e347a1cad85a714fdc3da4ae450ba26ea", "url": "https://api.github.com/repos/apache/spark/git/trees/3401e56e347a1cad85a714fdc3da4ae450ba26ea"}, "url": "https://api.github.com/repos/apache/spark/git/commits/7eb76d698836a251065753117e22285dd1a8aa8f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/7eb76d698836a251065753117e22285dd1a8aa8f", "html_url": "https://github.com/apache/spark/commit/7eb76d698836a251065753117e22285dd1a8aa8f", "comments_url": "https://api.github.com/repos/apache/spark/commits/7eb76d698836a251065753117e22285dd1a8aa8f/comments", "author": {"login": "maropu", "id": 692303, "node_id": "MDQ6VXNlcjY5MjMwMw==", "avatar_url": "https://avatars3.githubusercontent.com/u/692303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maropu", "html_url": "https://github.com/maropu", "followers_url": "https://api.github.com/users/maropu/followers", "following_url": "https://api.github.com/users/maropu/following{/other_user}", "gists_url": "https://api.github.com/users/maropu/gists{/gist_id}", "starred_url": "https://api.github.com/users/maropu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maropu/subscriptions", "organizations_url": "https://api.github.com/users/maropu/orgs", "repos_url": "https://api.github.com/users/maropu/repos", "events_url": "https://api.github.com/users/maropu/events{/privacy}", "received_events_url": "https://api.github.com/users/maropu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "maropu", "id": 692303, "node_id": "MDQ6VXNlcjY5MjMwMw==", "avatar_url": "https://avatars3.githubusercontent.com/u/692303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maropu", "html_url": "https://github.com/maropu", "followers_url": "https://api.github.com/users/maropu/followers", "following_url": "https://api.github.com/users/maropu/following{/other_user}", "gists_url": "https://api.github.com/users/maropu/gists{/gist_id}", "starred_url": "https://api.github.com/users/maropu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maropu/subscriptions", "organizations_url": "https://api.github.com/users/maropu/orgs", "repos_url": "https://api.github.com/users/maropu/repos", "events_url": "https://api.github.com/users/maropu/events{/privacy}", "received_events_url": "https://api.github.com/users/maropu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8f610057232c4c2919bdd8bdfba7a4608a360b9f", "url": "https://api.github.com/repos/apache/spark/commits/8f610057232c4c2919bdd8bdfba7a4608a360b9f", "html_url": "https://github.com/apache/spark/commit/8f610057232c4c2919bdd8bdfba7a4608a360b9f"}]}, {"sha": "8f610057232c4c2919bdd8bdfba7a4608a360b9f", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6OGY2MTAwNTcyMzJjNGMyOTE5YmRkOGJkZmJhN2E0NjA4YTM2MGI5Zg==", "commit": {"author": {"name": "Jungtaek Lim (HeartSaVioR)", "email": "kabhwan.opensource@gmail.com", "date": "2020-09-10T08:10:32Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-10T08:10:32Z"}, "message": "[SPARK-32456][SS][FOLLOWUP] Update doc to note about using SQL statement with streaming Dataset\n\n### What changes were proposed in this pull request?\n\nThis patch proposes to update the doc (both SS guide doc and Dataset dropDuplicates method doc) to leave a note to check on using SQL statements with streaming Dataset.\n\nOnce end users create a temp view based on streaming Dataset, they won't bother with thinking about \"streaming\" and do whatever they do with batch query. In many cases it works, but not just smoothly for the case when streaming aggregation is involved. They still need to concern about maintaining state store.\n\n### Why are the changes needed?\n\nAlthough SPARK-32456 fixed the weird error message, as a side effect some operations are enabled on streaming workload via SQL statement, which is error-prone if end users don't indicate what they're doing.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo.\n\n### How was this patch tested?\n\nOnly doc change.\n\nCloses #29461 from HeartSaVioR/SPARK-32456-FOLLOWUP-DOC.\n\nAuthored-by: Jungtaek Lim (HeartSaVioR) <kabhwan.opensource@gmail.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "b5536d63cef13717598787347e9e251a5dd46b44", "url": "https://api.github.com/repos/apache/spark/git/trees/b5536d63cef13717598787347e9e251a5dd46b44"}, "url": "https://api.github.com/repos/apache/spark/git/commits/8f610057232c4c2919bdd8bdfba7a4608a360b9f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/8f610057232c4c2919bdd8bdfba7a4608a360b9f", "html_url": "https://github.com/apache/spark/commit/8f610057232c4c2919bdd8bdfba7a4608a360b9f", "comments_url": "https://api.github.com/repos/apache/spark/commits/8f610057232c4c2919bdd8bdfba7a4608a360b9f/comments", "author": {"login": "HeartSaVioR", "id": 1317309, "node_id": "MDQ6VXNlcjEzMTczMDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1317309?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HeartSaVioR", "html_url": "https://github.com/HeartSaVioR", "followers_url": "https://api.github.com/users/HeartSaVioR/followers", "following_url": "https://api.github.com/users/HeartSaVioR/following{/other_user}", "gists_url": "https://api.github.com/users/HeartSaVioR/gists{/gist_id}", "starred_url": "https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HeartSaVioR/subscriptions", "organizations_url": "https://api.github.com/users/HeartSaVioR/orgs", "repos_url": "https://api.github.com/users/HeartSaVioR/repos", "events_url": "https://api.github.com/users/HeartSaVioR/events{/privacy}", "received_events_url": "https://api.github.com/users/HeartSaVioR/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dbc41376de636ca2aec354021647a67df319d914", "url": "https://api.github.com/repos/apache/spark/commits/dbc41376de636ca2aec354021647a67df319d914", "html_url": "https://github.com/apache/spark/commit/dbc41376de636ca2aec354021647a67df319d914"}]}, {"sha": "dbc41376de636ca2aec354021647a67df319d914", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6ZGJjNDEzNzZkZTYzNmNhMmFlYzM1NDAyMTY0N2E2N2RmMzE5ZDkxNA==", "commit": {"author": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-10T07:11:07Z"}, "committer": {"name": "Dongjoon Hyun", "email": "dongjoon@apache.org", "date": "2020-09-10T07:11:07Z"}, "message": "[SPARK-32841][BUILD] Use Apache Hadoop 3.2.0 for PyPI and CRAN\n\n### What changes were proposed in this pull request?\n\nPyPI and CRAN did not change because of the concern about selecting Hadoop and Hive versions.\n\nFor PyPI, now there is a PR open at https://github.com/apache/spark/pull/29703\nFor CRAN, we can already select Hadoop and Hive versions via `SparkR::install.spark`.\n\n### Why are the changes needed?\n\nTo keep the default profiles consistent in distributions\n\n### Does this PR introduce _any_ user-facing change?\n\nYes, the default distributions will use Hadoop 3.2.\n\n### How was this patch tested?\n\nJenkins tests.\n\nCloses #29704 from HyukjinKwon/SPARK-32058.\n\nAuthored-by: HyukjinKwon <gurwls223@apache.org>\nSigned-off-by: Dongjoon Hyun <dongjoon@apache.org>", "tree": {"sha": "8754f746f7e97c69a069cdc2bda8e9434da0a673", "url": "https://api.github.com/repos/apache/spark/git/trees/8754f746f7e97c69a069cdc2bda8e9434da0a673"}, "url": "https://api.github.com/repos/apache/spark/git/commits/dbc41376de636ca2aec354021647a67df319d914", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/dbc41376de636ca2aec354021647a67df319d914", "html_url": "https://github.com/apache/spark/commit/dbc41376de636ca2aec354021647a67df319d914", "comments_url": "https://api.github.com/repos/apache/spark/commits/dbc41376de636ca2aec354021647a67df319d914/comments", "author": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dongjoon-hyun", "id": 9700541, "node_id": "MDQ6VXNlcjk3MDA1NDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9700541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dongjoon-hyun", "html_url": "https://github.com/dongjoon-hyun", "followers_url": "https://api.github.com/users/dongjoon-hyun/followers", "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}", "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}", "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions", "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs", "repos_url": "https://api.github.com/users/dongjoon-hyun/repos", "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}", "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2f85f9516cfc33a376871cf27f9fb4ac30ecbed8", "url": "https://api.github.com/repos/apache/spark/commits/2f85f9516cfc33a376871cf27f9fb4ac30ecbed8", "html_url": "https://github.com/apache/spark/commit/2f85f9516cfc33a376871cf27f9fb4ac30ecbed8"}]}, {"sha": "2f85f9516cfc33a376871cf27f9fb4ac30ecbed8", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6MmY4NWY5NTE2Y2ZjMzNhMzc2ODcxY2YyN2Y5ZmI0YWMzMGVjYmVkOA==", "commit": {"author": {"name": "Dongjoon Hyun", "email": "dongjoon@apache.org", "date": "2020-09-10T06:41:32Z"}, "committer": {"name": "Dongjoon Hyun", "email": "dongjoon@apache.org", "date": "2020-09-10T06:41:32Z"}, "message": "[SPARK-32832][SS] Use CaseInsensitiveMap for DataStreamReader/Writer options\n\n### What changes were proposed in this pull request?\n\nThis PR aims to fix indeterministic behavior on DataStreamReader/Writer options like the following.\n```scala\nscala> spark.readStream.format(\"parquet\").option(\"paTh\", \"1\").option(\"PATH\", \"2\").option(\"Path\", \"3\").option(\"patH\", \"4\").option(\"path\", \"5\").load()\norg.apache.spark.sql.AnalysisException: Path does not exist: 1;\n```\n\n### Why are the changes needed?\n\nThis will make the behavior deterministic.\n\n### Does this PR introduce _any_ user-facing change?\n\nYes, but the previous behavior is indeterministic.\n\n### How was this patch tested?\n\nPass the newly test cases.\n\nCloses #29702 from dongjoon-hyun/SPARK-32832.\n\nAuthored-by: Dongjoon Hyun <dongjoon@apache.org>\nSigned-off-by: Dongjoon Hyun <dongjoon@apache.org>", "tree": {"sha": "ec6a1cfc1f55b600b6d71e6217dfc4cce005f775", "url": "https://api.github.com/repos/apache/spark/git/trees/ec6a1cfc1f55b600b6d71e6217dfc4cce005f775"}, "url": "https://api.github.com/repos/apache/spark/git/commits/2f85f9516cfc33a376871cf27f9fb4ac30ecbed8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/2f85f9516cfc33a376871cf27f9fb4ac30ecbed8", "html_url": "https://github.com/apache/spark/commit/2f85f9516cfc33a376871cf27f9fb4ac30ecbed8", "comments_url": "https://api.github.com/repos/apache/spark/commits/2f85f9516cfc33a376871cf27f9fb4ac30ecbed8/comments", "author": {"login": "dongjoon-hyun", "id": 9700541, "node_id": "MDQ6VXNlcjk3MDA1NDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9700541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dongjoon-hyun", "html_url": "https://github.com/dongjoon-hyun", "followers_url": "https://api.github.com/users/dongjoon-hyun/followers", "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}", "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}", "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions", "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs", "repos_url": "https://api.github.com/users/dongjoon-hyun/repos", "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}", "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dongjoon-hyun", "id": 9700541, "node_id": "MDQ6VXNlcjk3MDA1NDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9700541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dongjoon-hyun", "html_url": "https://github.com/dongjoon-hyun", "followers_url": "https://api.github.com/users/dongjoon-hyun/followers", "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}", "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}", "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions", "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs", "repos_url": "https://api.github.com/users/dongjoon-hyun/repos", "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}", "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "db89b0e1b8bb98db6672f2b89e42e8a14e06e745", "url": "https://api.github.com/repos/apache/spark/commits/db89b0e1b8bb98db6672f2b89e42e8a14e06e745", "html_url": "https://github.com/apache/spark/commit/db89b0e1b8bb98db6672f2b89e42e8a14e06e745"}]}, {"sha": "db89b0e1b8bb98db6672f2b89e42e8a14e06e745", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6ZGI4OWIwZTFiOGJiOThkYjY2NzJmMmI4OWU0MmU4YTE0ZTA2ZTc0NQ==", "commit": {"author": {"name": "Jungtaek Lim (HeartSaVioR)", "email": "kabhwan.opensource@gmail.com", "date": "2020-09-10T06:33:18Z"}, "committer": {"name": "Jungtaek Lim (HeartSaVioR)", "email": "kabhwan.opensource@gmail.com", "date": "2020-09-10T06:33:18Z"}, "message": "[SPARK-32831][SS] Refactor SupportsStreamingUpdate to represent actual meaning of the behavior\n\n### What changes were proposed in this pull request?\n\nThis PR renames `SupportsStreamingUpdate` to `SupportsStreamingUpdateAsAppend` as the new interface name represents the actual behavior clearer. This PR also removes the `update()` method (so the interface is more likely a marker), as the implementations of `SupportsStreamingUpdateAsAppend` should support append mode by default, hence no need to trigger some flag on it.\n\n### Why are the changes needed?\n\nSupportsStreamingUpdate was intended to revive the functionality of Streaming update output mode for internal data sources, but despite the name, that interface isn't really used to do actual update on sink; all sinks are implementing this interface to do append, so strictly saying, it's just to support update as append. Renaming the interface would make it clear.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo, as the class is only for internal data sources.\n\n### How was this patch tested?\n\nJenkins test will follow.\n\nCloses #29693 from HeartSaVioR/SPARK-32831.\n\nAuthored-by: Jungtaek Lim (HeartSaVioR) <kabhwan.opensource@gmail.com>\nSigned-off-by: Jungtaek Lim (HeartSaVioR) <kabhwan.opensource@gmail.com>", "tree": {"sha": "5b17cc22279962b6eeb31032c6e191744023f873", "url": "https://api.github.com/repos/apache/spark/git/trees/5b17cc22279962b6eeb31032c6e191744023f873"}, "url": "https://api.github.com/repos/apache/spark/git/commits/db89b0e1b8bb98db6672f2b89e42e8a14e06e745", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/db89b0e1b8bb98db6672f2b89e42e8a14e06e745", "html_url": "https://github.com/apache/spark/commit/db89b0e1b8bb98db6672f2b89e42e8a14e06e745", "comments_url": "https://api.github.com/repos/apache/spark/commits/db89b0e1b8bb98db6672f2b89e42e8a14e06e745/comments", "author": {"login": "HeartSaVioR", "id": 1317309, "node_id": "MDQ6VXNlcjEzMTczMDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1317309?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HeartSaVioR", "html_url": "https://github.com/HeartSaVioR", "followers_url": "https://api.github.com/users/HeartSaVioR/followers", "following_url": "https://api.github.com/users/HeartSaVioR/following{/other_user}", "gists_url": "https://api.github.com/users/HeartSaVioR/gists{/gist_id}", "starred_url": "https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HeartSaVioR/subscriptions", "organizations_url": "https://api.github.com/users/HeartSaVioR/orgs", "repos_url": "https://api.github.com/users/HeartSaVioR/repos", "events_url": "https://api.github.com/users/HeartSaVioR/events{/privacy}", "received_events_url": "https://api.github.com/users/HeartSaVioR/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HeartSaVioR", "id": 1317309, "node_id": "MDQ6VXNlcjEzMTczMDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1317309?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HeartSaVioR", "html_url": "https://github.com/HeartSaVioR", "followers_url": "https://api.github.com/users/HeartSaVioR/followers", "following_url": "https://api.github.com/users/HeartSaVioR/following{/other_user}", "gists_url": "https://api.github.com/users/HeartSaVioR/gists{/gist_id}", "starred_url": "https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HeartSaVioR/subscriptions", "organizations_url": "https://api.github.com/users/HeartSaVioR/orgs", "repos_url": "https://api.github.com/users/HeartSaVioR/repos", "events_url": "https://api.github.com/users/HeartSaVioR/events{/privacy}", "received_events_url": "https://api.github.com/users/HeartSaVioR/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4a096131eee99ff8cb32022072e085dda87f766f", "url": "https://api.github.com/repos/apache/spark/commits/4a096131eee99ff8cb32022072e085dda87f766f", "html_url": "https://github.com/apache/spark/commit/4a096131eee99ff8cb32022072e085dda87f766f"}]}, {"sha": "4a096131eee99ff8cb32022072e085dda87f766f", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6NGEwOTYxMzFlZWU5OWZmOGNiMzIwMjIwNzJlMDg1ZGRhODdmNzY2Zg==", "commit": {"author": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-10T05:22:38Z"}, "committer": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-10T05:23:10Z"}, "message": "Revert \"[SPARK-32772][SQL][FOLLOWUP] Remove legacy silent support mode for spark-sql CLI\"\n\nThis reverts commit f1f7ae420ee5cfc5755141d5ff25604bb78be465.", "tree": {"sha": "4f155d32fb044d75171238281214ead754d47187", "url": "https://api.github.com/repos/apache/spark/git/trees/4f155d32fb044d75171238281214ead754d47187"}, "url": "https://api.github.com/repos/apache/spark/git/commits/4a096131eee99ff8cb32022072e085dda87f766f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/4a096131eee99ff8cb32022072e085dda87f766f", "html_url": "https://github.com/apache/spark/commit/4a096131eee99ff8cb32022072e085dda87f766f", "comments_url": "https://api.github.com/repos/apache/spark/commits/4a096131eee99ff8cb32022072e085dda87f766f/comments", "author": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e0538bd38cd43feaa064e30df940edf8fb2088de", "url": "https://api.github.com/repos/apache/spark/commits/e0538bd38cd43feaa064e30df940edf8fb2088de", "html_url": "https://github.com/apache/spark/commit/e0538bd38cd43feaa064e30df940edf8fb2088de"}]}, {"sha": "e0538bd38cd43feaa064e30df940edf8fb2088de", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6ZTA1MzhiZDM4Y2Q0M2ZlYWEwNjRlMzBkZjk0MGVkZjhmYjIwODhkZQ==", "commit": {"author": {"name": "Bryan Cutler", "email": "cutlerb@gmail.com", "date": "2020-09-10T05:16:19Z"}, "committer": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-10T05:16:19Z"}, "message": "[SPARK-32312][SQL][PYTHON][TEST-JAVA11] Upgrade Apache Arrow to version 1.0.1\n\n### What changes were proposed in this pull request?\n\nUpgrade Apache Arrow to version 1.0.1 for the Java dependency and increase minimum version of PyArrow to 1.0.0.\n\nThis release marks a transition to binary stability of the columnar format (which was already informally backward-compatible going back to December 2017) and a transition to Semantic Versioning for the Arrow software libraries. Also note that the Java arrow-memory artifact has been split to separate dependence on netty-buffer and allow users to select an allocator. Spark will continue to use `arrow-memory-netty` to maintain performance benefits.\n\nVersion 1.0.0 - 1.0.0 include the following selected fixes/improvements relevant to Spark users:\n\nARROW-9300 - [Java] Separate Netty Memory to its own module\nARROW-9272 - [C++][Python] Reduce complexity in python to arrow conversion\nARROW-9016 - [Java] Remove direct references to Netty/Unsafe Allocators\nARROW-8664 - [Java] Add skip null check to all Vector types\nARROW-8485 - [Integration][Java] Implement extension types integration\nARROW-8434 - [C++] Ipc RecordBatchFileReader deserializes the Schema multiple times\nARROW-8314 - [Python] Provide a method to select a subset of columns of a Table\nARROW-8230 - [Java] Move Netty memory manager into a separate module\nARROW-8229 - [Java] Move ArrowBuf into the Arrow package\nARROW-7955 - [Java] Support large buffer for file/stream IPC\nARROW-7831 - [Java] unnecessary buffer allocation when calling splitAndTransferTo on variable width vectors\nARROW-6111 - [Java] Support LargeVarChar and LargeBinary types and add integration test with C++\nARROW-6110 - [Java] Support LargeList Type and add integration test with C++\nARROW-5760 - [C++] Optimize Take implementation\nARROW-300 - [Format] Add body buffer compression option to IPC message protocol using LZ4 or ZSTD\nARROW-9098 - RecordBatch::ToStructArray cannot handle record batches with 0 column\nARROW-9066 - [Python] Raise correct error in isnull()\nARROW-9223 - [Python] Fix to_pandas() export for timestamps within structs\nARROW-9195 - [Java] Wrong usage of Unsafe.get from bytearray in ByteFunctionsHelper class\nARROW-7610 - [Java] Finish support for 64 bit int allocations\nARROW-8115 - [Python] Conversion when mixing NaT and datetime objects not working\nARROW-8392 - [Java] Fix overflow related corner cases for vector value comparison\nARROW-8537 - [C++] Performance regression from ARROW-8523\nARROW-8803 - [Java] Row count should be set before loading buffers in VectorLoader\nARROW-8911 - [C++] Slicing a ChunkedArray with zero chunks segfaults\n\nView release notes here:\nhttps://arrow.apache.org/release/1.0.1.html\nhttps://arrow.apache.org/release/1.0.0.html\n\n### Why are the changes needed?\n\nUpgrade brings fixes, improvements and stability guarantees.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo\n\n### How was this patch tested?\n\nExisting tests with pyarrow 1.0.0 and 1.0.1\n\nCloses #29686 from BryanCutler/arrow-upgrade-100-SPARK-32312.\n\nAuthored-by: Bryan Cutler <cutlerb@gmail.com>\nSigned-off-by: HyukjinKwon <gurwls223@apache.org>", "tree": {"sha": "14ec9610c35126e4952dc4edac383a3defdce1ea", "url": "https://api.github.com/repos/apache/spark/git/trees/14ec9610c35126e4952dc4edac383a3defdce1ea"}, "url": "https://api.github.com/repos/apache/spark/git/commits/e0538bd38cd43feaa064e30df940edf8fb2088de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/e0538bd38cd43feaa064e30df940edf8fb2088de", "html_url": "https://github.com/apache/spark/commit/e0538bd38cd43feaa064e30df940edf8fb2088de", "comments_url": "https://api.github.com/repos/apache/spark/commits/e0538bd38cd43feaa064e30df940edf8fb2088de/comments", "author": {"login": "BryanCutler", "id": 4534389, "node_id": "MDQ6VXNlcjQ1MzQzODk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4534389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BryanCutler", "html_url": "https://github.com/BryanCutler", "followers_url": "https://api.github.com/users/BryanCutler/followers", "following_url": "https://api.github.com/users/BryanCutler/following{/other_user}", "gists_url": "https://api.github.com/users/BryanCutler/gists{/gist_id}", "starred_url": "https://api.github.com/users/BryanCutler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BryanCutler/subscriptions", "organizations_url": "https://api.github.com/users/BryanCutler/orgs", "repos_url": "https://api.github.com/users/BryanCutler/repos", "events_url": "https://api.github.com/users/BryanCutler/events{/privacy}", "received_events_url": "https://api.github.com/users/BryanCutler/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9ab8a2c36db324748295d23c62339e9cb68ba77e", "url": "https://api.github.com/repos/apache/spark/commits/9ab8a2c36db324748295d23c62339e9cb68ba77e", "html_url": "https://github.com/apache/spark/commit/9ab8a2c36db324748295d23c62339e9cb68ba77e"}]}, {"sha": "9ab8a2c36db324748295d23c62339e9cb68ba77e", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6OWFiOGEyYzM2ZGIzMjQ3NDgyOTVkMjNjNjIzMzllOWNiNjhiYTc3ZQ==", "commit": {"author": {"name": "Kent Yao", "email": "yaooqinn@hotmail.com", "date": "2020-09-10T04:53:38Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-10T04:53:38Z"}, "message": "[SPARK-32826][SQL] Set the right column size for the null type in SparkGetColumnsOperation\n\n### What changes were proposed in this pull request?\n\nIn Spark 3.0.0, the SparkGetColumnsOperation can not recognize NULL columns but now we can because the side effect of https://issues.apache.org/jira/browse/SPARK-32696 / https://github.com/apache/spark/commit/f14f3742e0c98dd306abf02e93d2f10d89bc423f, but the test coverage for this change was not added.\n\nIn Spark, the column size for null fields should be 1, in this PR, we set the right column size for the null type.\n\n### Why are the changes needed?\n\ntest coverage and fix the client-side information about the null type through jdbc\n\n### Does this PR introduce _any_ user-facing change?\n\nNO\n### How was this patch tested?\n\nadded ut both for this pr and SPARK-32696\n\nCloses #29687 from yaooqinn/SPARK-32826.\n\nAuthored-by: Kent Yao <yaooqinn@hotmail.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "86a8747d8b8a58246368d5e509bbc37615bd842a", "url": "https://api.github.com/repos/apache/spark/git/trees/86a8747d8b8a58246368d5e509bbc37615bd842a"}, "url": "https://api.github.com/repos/apache/spark/git/commits/9ab8a2c36db324748295d23c62339e9cb68ba77e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/9ab8a2c36db324748295d23c62339e9cb68ba77e", "html_url": "https://github.com/apache/spark/commit/9ab8a2c36db324748295d23c62339e9cb68ba77e", "comments_url": "https://api.github.com/repos/apache/spark/commits/9ab8a2c36db324748295d23c62339e9cb68ba77e/comments", "author": {"login": "yaooqinn", "id": 8326978, "node_id": "MDQ6VXNlcjgzMjY5Nzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/8326978?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaooqinn", "html_url": "https://github.com/yaooqinn", "followers_url": "https://api.github.com/users/yaooqinn/followers", "following_url": "https://api.github.com/users/yaooqinn/following{/other_user}", "gists_url": "https://api.github.com/users/yaooqinn/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaooqinn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaooqinn/subscriptions", "organizations_url": "https://api.github.com/users/yaooqinn/orgs", "repos_url": "https://api.github.com/users/yaooqinn/repos", "events_url": "https://api.github.com/users/yaooqinn/events{/privacy}", "received_events_url": "https://api.github.com/users/yaooqinn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "add267c4de51274f8f57dbdcce8c497e09899df3", "url": "https://api.github.com/repos/apache/spark/commits/add267c4de51274f8f57dbdcce8c497e09899df3", "html_url": "https://github.com/apache/spark/commit/add267c4de51274f8f57dbdcce8c497e09899df3"}]}, {"sha": "add267c4de51274f8f57dbdcce8c497e09899df3", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6YWRkMjY3YzRkZTUxMjc0ZjhmNTdkYmRjY2U4YzQ5N2UwOTg5OWRmMw==", "commit": {"author": {"name": "Liang-Chi Hsieh", "email": "viirya@gmail.com", "date": "2020-09-10T02:53:22Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-10T02:53:22Z"}, "message": "[SPARK-32819][SQL] ignoreNullability parameter should be effective recursively\n\n### What changes were proposed in this pull request?\n\nThis patch proposes to check `ignoreNullability` parameter recursively in `equalsStructurally` method.\n\n### Why are the changes needed?\n\n`equalsStructurally` is used to check type equality. We can optionally ask to ignore nullability check. But the parameter `ignoreNullability` is not passed recursively down to nested types. So it produces weird error like:\n\n```\ndata type mismatch: argument 3 requires array<array<string>> type, however ... is of array<array<string>> type.\n```\n\nwhen running the query `select aggregate(split('abcdefgh',''), array(array('')), (acc, x) -> array(array( x ) ) )`.\n\n### Does this PR introduce _any_ user-facing change?\n\nYes, fixed a bug when running user query.\n\n### How was this patch tested?\n\nUnit tests.\n\nCloses #29698 from viirya/SPARK-32819.\n\nAuthored-by: Liang-Chi Hsieh <viirya@gmail.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "741fb3dc071e4856d2a6fd80c45a2a069656a40e", "url": "https://api.github.com/repos/apache/spark/git/trees/741fb3dc071e4856d2a6fd80c45a2a069656a40e"}, "url": "https://api.github.com/repos/apache/spark/git/commits/add267c4de51274f8f57dbdcce8c497e09899df3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/add267c4de51274f8f57dbdcce8c497e09899df3", "html_url": "https://github.com/apache/spark/commit/add267c4de51274f8f57dbdcce8c497e09899df3", "comments_url": "https://api.github.com/repos/apache/spark/commits/add267c4de51274f8f57dbdcce8c497e09899df3/comments", "author": {"login": "viirya", "id": 68855, "node_id": "MDQ6VXNlcjY4ODU1", "avatar_url": "https://avatars1.githubusercontent.com/u/68855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/viirya", "html_url": "https://github.com/viirya", "followers_url": "https://api.github.com/users/viirya/followers", "following_url": "https://api.github.com/users/viirya/following{/other_user}", "gists_url": "https://api.github.com/users/viirya/gists{/gist_id}", "starred_url": "https://api.github.com/users/viirya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/viirya/subscriptions", "organizations_url": "https://api.github.com/users/viirya/orgs", "repos_url": "https://api.github.com/users/viirya/repos", "events_url": "https://api.github.com/users/viirya/events{/privacy}", "received_events_url": "https://api.github.com/users/viirya/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "06a994517fc3080b14f01183eeb17e56ab52eaa8", "url": "https://api.github.com/repos/apache/spark/commits/06a994517fc3080b14f01183eeb17e56ab52eaa8", "html_url": "https://github.com/apache/spark/commit/06a994517fc3080b14f01183eeb17e56ab52eaa8"}]}, {"sha": "06a994517fc3080b14f01183eeb17e56ab52eaa8", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6MDZhOTk0NTE3ZmMzMDgwYjE0ZjAxMTgzZWViMTdlNTZhYjUyZWFhOA==", "commit": {"author": {"name": "Dongjoon Hyun", "email": "dongjoon@apache.org", "date": "2020-09-10T02:46:55Z"}, "committer": {"name": "Dongjoon Hyun", "email": "dongjoon@apache.org", "date": "2020-09-10T02:46:55Z"}, "message": "[SPARK-32836][SS][TESTS] Fix DataStreamReaderWriterSuite to check writer options correctly\n\n### What changes were proposed in this pull request?\n\nThis PR aims to fix the test coverage at `DataStreamReaderWriterSuite`.\n\n### Why are the changes needed?\n\nCurrently, the test case checks `DataStreamReader` options instead of `DataStreamWriter` options.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo.\n\n### How was this patch tested?\n\nPass the revised test case.\n\nCloses #29701 from dongjoon-hyun/SPARK-32836.\n\nAuthored-by: Dongjoon Hyun <dongjoon@apache.org>\nSigned-off-by: Dongjoon Hyun <dongjoon@apache.org>", "tree": {"sha": "7585b6615bf86aa9ecdfd3633a2b3976955d1b45", "url": "https://api.github.com/repos/apache/spark/git/trees/7585b6615bf86aa9ecdfd3633a2b3976955d1b45"}, "url": "https://api.github.com/repos/apache/spark/git/commits/06a994517fc3080b14f01183eeb17e56ab52eaa8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/06a994517fc3080b14f01183eeb17e56ab52eaa8", "html_url": "https://github.com/apache/spark/commit/06a994517fc3080b14f01183eeb17e56ab52eaa8", "comments_url": "https://api.github.com/repos/apache/spark/commits/06a994517fc3080b14f01183eeb17e56ab52eaa8/comments", "author": {"login": "dongjoon-hyun", "id": 9700541, "node_id": "MDQ6VXNlcjk3MDA1NDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9700541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dongjoon-hyun", "html_url": "https://github.com/dongjoon-hyun", "followers_url": "https://api.github.com/users/dongjoon-hyun/followers", "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}", "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}", "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions", "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs", "repos_url": "https://api.github.com/users/dongjoon-hyun/repos", "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}", "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dongjoon-hyun", "id": 9700541, "node_id": "MDQ6VXNlcjk3MDA1NDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9700541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dongjoon-hyun", "html_url": "https://github.com/dongjoon-hyun", "followers_url": "https://api.github.com/users/dongjoon-hyun/followers", "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}", "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}", "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions", "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs", "repos_url": "https://api.github.com/users/dongjoon-hyun/repos", "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}", "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ab2fa881edb0a75a94b7f5965a49687658d74060", "url": "https://api.github.com/repos/apache/spark/commits/ab2fa881edb0a75a94b7f5965a49687658d74060", "html_url": "https://github.com/apache/spark/commit/ab2fa881edb0a75a94b7f5965a49687658d74060"}]}, {"sha": "ab2fa881edb0a75a94b7f5965a49687658d74060", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6YWIyZmE4ODFlZGIwYTc1YTk0YjdmNTk2NWE0OTY4NzY1OGQ3NDA2MA==", "commit": {"author": {"name": "Terry Kim", "email": "yuminkim@gmail.com", "date": "2020-09-10T01:48:51Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-10T01:48:51Z"}, "message": "[SPARK-32516][SQL][FOLLOWUP] Remove unnecessary check if path string is empty for DataFrameWriter.save(), DataStreamReader.load() and DataStreamWriter.start()\n\n### What changes were proposed in this pull request?\n\nThis PR is a follow up to https://github.com/apache/spark/pull/29543#discussion_r485409606, which correctly points out that the check for the empty string is not necessary.\n\n### Why are the changes needed?\n\nThe unnecessary check actually could cause more confusion.\n\nFor example,\n```scala\nscala> Seq(1).toDF.write.option(\"path\", \"/tmp/path1\").parquet(\"\")\njava.lang.IllegalArgumentException: Can not create a Path from an empty string\n  at org.apache.hadoop.fs.Path.checkPathArg(Path.java:168)\n```\neven when `path` option is available. This PR addresses to fix this confusion.\n\n### Does this PR introduce _any_ user-facing change?\n\nYes, now the above example prints the consistent exception message whether the path parameter value is empty or not.\n```scala\nscala> Seq(1).toDF.write.option(\"path\", \"/tmp/path1\").parquet(\"\")\norg.apache.spark.sql.AnalysisException: There is a 'path' option set and save() is called with a path parameter. Either remove the path option, or call save() without the parameter. To ignore this check, set 'spark.sql.legacy.pathOptionBehavior.enabled' to 'true'.;\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:290)\n  at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:856)\n  ... 47 elided\n```\n\n### How was this patch tested?\n\nAdded unit tests.\n\nCloses #29697 from imback82/SPARK-32516-followup.\n\nAuthored-by: Terry Kim <yuminkim@gmail.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "dfbeb8c7981b9de561b69540df7c97ea9e670cda", "url": "https://api.github.com/repos/apache/spark/git/trees/dfbeb8c7981b9de561b69540df7c97ea9e670cda"}, "url": "https://api.github.com/repos/apache/spark/git/commits/ab2fa881edb0a75a94b7f5965a49687658d74060", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/ab2fa881edb0a75a94b7f5965a49687658d74060", "html_url": "https://github.com/apache/spark/commit/ab2fa881edb0a75a94b7f5965a49687658d74060", "comments_url": "https://api.github.com/repos/apache/spark/commits/ab2fa881edb0a75a94b7f5965a49687658d74060/comments", "author": {"login": "imback82", "id": 12103644, "node_id": "MDQ6VXNlcjEyMTAzNjQ0", "avatar_url": "https://avatars3.githubusercontent.com/u/12103644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imback82", "html_url": "https://github.com/imback82", "followers_url": "https://api.github.com/users/imback82/followers", "following_url": "https://api.github.com/users/imback82/following{/other_user}", "gists_url": "https://api.github.com/users/imback82/gists{/gist_id}", "starred_url": "https://api.github.com/users/imback82/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imback82/subscriptions", "organizations_url": "https://api.github.com/users/imback82/orgs", "repos_url": "https://api.github.com/users/imback82/repos", "events_url": "https://api.github.com/users/imback82/events{/privacy}", "received_events_url": "https://api.github.com/users/imback82/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f7995c576aa16f04681ca8f43f8c0f71818a9f44", "url": "https://api.github.com/repos/apache/spark/commits/f7995c576aa16f04681ca8f43f8c0f71818a9f44", "html_url": "https://github.com/apache/spark/commit/f7995c576aa16f04681ca8f43f8c0f71818a9f44"}]}, {"sha": "f7995c576aa16f04681ca8f43f8c0f71818a9f44", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6Zjc5OTVjNTc2YWExNmYwNDY4MWNhOGY0M2Y4YzBmNzE4MThhOWY0NA==", "commit": {"author": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-09T18:15:22Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-09T18:15:22Z"}, "message": "Revert \"[SPARK-32677][SQL] Load function resource before create\"\n\nThis reverts commit 05fcf26b7966781772338e1f6d53690ab52cc66f.", "tree": {"sha": "1cd419e4880cf5a636b3312d5206140e24afd8e1", "url": "https://api.github.com/repos/apache/spark/git/trees/1cd419e4880cf5a636b3312d5206140e24afd8e1"}, "url": "https://api.github.com/repos/apache/spark/git/commits/f7995c576aa16f04681ca8f43f8c0f71818a9f44", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/f7995c576aa16f04681ca8f43f8c0f71818a9f44", "html_url": "https://github.com/apache/spark/commit/f7995c576aa16f04681ca8f43f8c0f71818a9f44", "comments_url": "https://api.github.com/repos/apache/spark/commits/f7995c576aa16f04681ca8f43f8c0f71818a9f44/comments", "author": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e4237bbda68c23a3367fab56fd8cdb521f8a1ae2", "url": "https://api.github.com/repos/apache/spark/commits/e4237bbda68c23a3367fab56fd8cdb521f8a1ae2", "html_url": "https://github.com/apache/spark/commit/e4237bbda68c23a3367fab56fd8cdb521f8a1ae2"}]}, {"sha": "e4237bbda68c23a3367fab56fd8cdb521f8a1ae2", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6ZTQyMzdiYmRhNjhjMjNhMzM2N2ZhYjU2ZmQ4Y2RiNTIxZjhhMWFlMg==", "commit": {"author": {"name": "Tathagata Das", "email": "tathagata.das1565@gmail.com", "date": "2020-09-09T17:35:51Z"}, "committer": {"name": "Tathagata Das", "email": "tathagata.das1565@gmail.com", "date": "2020-09-09T17:35:51Z"}, "message": "[SPARK-32794][SS] Fixed rare corner case error in micro-batch engine with some stateful queries + no-data-batches + V1 sources\n\n### What changes were proposed in this pull request?\nMake MicroBatchExecution explicitly call `getBatch` when the start and end offsets are the same.\n\n### Why are the changes needed?\n\nStructured Streaming micro-batch engine has the contract with V1 data sources that, after a restart, it will call `source.getBatch()` on the last batch attempted before the restart. However, a very rare combination of sequences violates this contract. It occurs only when\n- The streaming query has specific types of stateful operations with watermarks (e.g., aggregation in append, mapGroupsWithState with timeouts).\n    - These queries can execute a batch even without new data when the previous updates the watermark and the stateful ops are such that the new watermark can cause new output/cleanup. Such batches are called no-data-batches.\n- The last batch before termination was an incomplete no-data-batch. Upon restart, the micro-batch engine fails to call `source.getBatch` when attempting to re-execute the incomplete no-data-batch.\n\nThis occurs because no-data-batches has the same and end offsets, and when a batch is executed, if the start and end offset is same then calling `source.getBatch` is skipped as it is assumed the generated plan will be empty. This only affects V1 data sources like Delta and Autoloader which rely on this invariant to detect in the source whether the query is being started from scratch or restarted.\n\n### Does this PR introduce _any_ user-facing change?\nNo\n\n### How was this patch tested?\n\nNew unit test with a mock v1 source that fails without the fix.\n\nCloses #29651 from tdas/SPARK-32794.\n\nAuthored-by: Tathagata Das <tathagata.das1565@gmail.com>\nSigned-off-by: Tathagata Das <tathagata.das1565@gmail.com>", "tree": {"sha": "2e7707ac6294507e548552a79af660fc7b4ec411", "url": "https://api.github.com/repos/apache/spark/git/trees/2e7707ac6294507e548552a79af660fc7b4ec411"}, "url": "https://api.github.com/repos/apache/spark/git/commits/e4237bbda68c23a3367fab56fd8cdb521f8a1ae2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/e4237bbda68c23a3367fab56fd8cdb521f8a1ae2", "html_url": "https://github.com/apache/spark/commit/e4237bbda68c23a3367fab56fd8cdb521f8a1ae2", "comments_url": "https://api.github.com/repos/apache/spark/commits/e4237bbda68c23a3367fab56fd8cdb521f8a1ae2/comments", "author": {"login": "tdas", "id": 663212, "node_id": "MDQ6VXNlcjY2MzIxMg==", "avatar_url": "https://avatars1.githubusercontent.com/u/663212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tdas", "html_url": "https://github.com/tdas", "followers_url": "https://api.github.com/users/tdas/followers", "following_url": "https://api.github.com/users/tdas/following{/other_user}", "gists_url": "https://api.github.com/users/tdas/gists{/gist_id}", "starred_url": "https://api.github.com/users/tdas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tdas/subscriptions", "organizations_url": "https://api.github.com/users/tdas/orgs", "repos_url": "https://api.github.com/users/tdas/repos", "events_url": "https://api.github.com/users/tdas/events{/privacy}", "received_events_url": "https://api.github.com/users/tdas/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tdas", "id": 663212, "node_id": "MDQ6VXNlcjY2MzIxMg==", "avatar_url": "https://avatars1.githubusercontent.com/u/663212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tdas", "html_url": "https://github.com/tdas", "followers_url": "https://api.github.com/users/tdas/followers", "following_url": "https://api.github.com/users/tdas/following{/other_user}", "gists_url": "https://api.github.com/users/tdas/gists{/gist_id}", "starred_url": "https://api.github.com/users/tdas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tdas/subscriptions", "organizations_url": "https://api.github.com/users/tdas/orgs", "repos_url": "https://api.github.com/users/tdas/repos", "events_url": "https://api.github.com/users/tdas/events{/privacy}", "received_events_url": "https://api.github.com/users/tdas/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fc10511d15a17c091e977dc4759be96247a8433e", "url": "https://api.github.com/repos/apache/spark/commits/fc10511d15a17c091e977dc4759be96247a8433e", "html_url": "https://github.com/apache/spark/commit/fc10511d15a17c091e977dc4759be96247a8433e"}]}, {"sha": "fc10511d15a17c091e977dc4759be96247a8433e", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6ZmMxMDUxMWQxNWExN2MwOTFlOTc3ZGM0NzU5YmU5NjI0N2E4NDMzZQ==", "commit": {"author": {"name": "yangjie01", "email": "yangjie01@baidu.com", "date": "2020-09-09T14:40:49Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-09T14:40:49Z"}, "message": "[SPARK-32755][SQL][FOLLOWUP] Ensure `--` method of AttributeSet have same behavior under Scala 2.12 and 2.13\n\n### What changes were proposed in this pull request?\n `--` method of `AttributeSet` behave differently under Scala 2.12 and 2.13 because `--` method of `LinkedHashSet` in Scala 2.13 can't maintains the insertion order.\n\nThis pr use a Scala 2.12 based code to ensure `--` method of AttributeSet have same behavior under Scala 2.12 and 2.13.\n\n### Why are the changes needed?\nThe behavior of `AttributeSet`  needs to be compatible with Scala 2.12 and 2.13\n\n### Does this PR introduce _any_ user-facing change?\nNo\n\n### How was this patch tested?\nScala 2.12: Pass the Jenkins or GitHub Action\n\nScala 2.13: Manual test sub-suites of `PlanStabilitySuite`\n\n- **Before** \uff1a293 TESTS FAILED\n\n- **After**\uff1a13 TESTS FAILED(The remaining failures are not associated with the current issue)\n\nCloses #29689 from LuciferYang/SPARK-32755-FOLLOWUP.\n\nAuthored-by: yangjie01 <yangjie01@baidu.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "dc080617728f1abcfb6754535a1238a1844dc5e3", "url": "https://api.github.com/repos/apache/spark/git/trees/dc080617728f1abcfb6754535a1238a1844dc5e3"}, "url": "https://api.github.com/repos/apache/spark/git/commits/fc10511d15a17c091e977dc4759be96247a8433e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/fc10511d15a17c091e977dc4759be96247a8433e", "html_url": "https://github.com/apache/spark/commit/fc10511d15a17c091e977dc4759be96247a8433e", "comments_url": "https://api.github.com/repos/apache/spark/commits/fc10511d15a17c091e977dc4759be96247a8433e/comments", "author": {"login": "LuciferYang", "id": 1475305, "node_id": "MDQ6VXNlcjE0NzUzMDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1475305?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LuciferYang", "html_url": "https://github.com/LuciferYang", "followers_url": "https://api.github.com/users/LuciferYang/followers", "following_url": "https://api.github.com/users/LuciferYang/following{/other_user}", "gists_url": "https://api.github.com/users/LuciferYang/gists{/gist_id}", "starred_url": "https://api.github.com/users/LuciferYang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LuciferYang/subscriptions", "organizations_url": "https://api.github.com/users/LuciferYang/orgs", "repos_url": "https://api.github.com/users/LuciferYang/repos", "events_url": "https://api.github.com/users/LuciferYang/events{/privacy}", "received_events_url": "https://api.github.com/users/LuciferYang/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "513d51a2c5dd2c7ff2c2fadc26ec122883372be1", "url": "https://api.github.com/repos/apache/spark/commits/513d51a2c5dd2c7ff2c2fadc26ec122883372be1", "html_url": "https://github.com/apache/spark/commit/513d51a2c5dd2c7ff2c2fadc26ec122883372be1"}]}, {"sha": "513d51a2c5dd2c7ff2c2fadc26ec122883372be1", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6NTEzZDUxYTJjNWRkMmM3ZmYyYzJmYWRjMjZlYzEyMjg4MzM3MmJlMQ==", "commit": {"author": {"name": "yangjie01", "email": "yangjie01@baidu.com", "date": "2020-09-09T13:53:44Z"}, "committer": {"name": "Sean Owen", "email": "srowen@gmail.com", "date": "2020-09-09T13:53:44Z"}, "message": "[SPARK-32808][SQL] Fix some test cases of `sql/core` module in scala 2.13\n\n### What changes were proposed in this pull request?\nThe purpose of this pr is to partial resolve [SPARK-32808](https://issues.apache.org/jira/browse/SPARK-32808), total of 26 failed test cases were fixed, the related suite as follow:\n\n- `StreamingAggregationSuite` related test cases (2 FAILED -> Pass)\n\n- `GeneratorFunctionSuite` related test cases (2 FAILED -> Pass)\n\n- `UDFSuite` related test cases (2 FAILED -> Pass)\n\n- `SQLQueryTestSuite` related test cases (5 FAILED -> Pass)\n\n- `WholeStageCodegenSuite` related test cases (1 FAILED -> Pass)\n\n- `DataFrameSuite` related test cases (3 FAILED -> Pass)\n\n- `OrcV1QuerySuite\\OrcV2QuerySuite` related test cases (4 FAILED -> Pass)\n\n- `ExpressionsSchemaSuite` related test cases (1 FAILED -> Pass)\n\n- `DataFrameStatSuite` related test cases (1 FAILED -> Pass)\n\n- `JsonV1Suite\\JsonV2Suite\\JsonLegacyTimeParserSuite` related test cases (6 FAILED -> Pass)\n\nThe main change of this pr as following:\n\n- Fix Scala 2.13 compilation problems in   `ShuffleBlockFetcherIterator`  and `Analyzer`\n\n- Specified `Seq` to `scala.collection.Seq` in `objects.scala` and `GenericArrayData` because internal use `Seq` maybe `mutable.ArraySeq` and not easy to call `.toSeq`\n\n- Should specified `Seq` to `scala.collection.Seq`  when we call `Row.getAs[Seq]` and `Row.get(i).asInstanceOf[Seq]` because the data maybe `mutable.ArraySeq` but `Seq` is `immutable.Seq` in Scala 2.13\n\n- Use a compatible way to let `+` and `-` method  of `Decimal` having the same behavior in Scala 2.12 and Scala 2.13\n\n- Call `toList` in `RelationalGroupedDataset.toDF` method when `groupingExprs` is `Stream` type because `Stream` can't serialize in Scala 2.13\n\n- Add a manual sort to `classFunsMap` in `ExpressionsSchemaSuite` because `Iterable.groupBy` in Scala 2.13 has different result with `TraversableLike.groupBy`  in Scala 2.12\n\n### Why are the changes needed?\nWe need to support a Scala 2.13 build.\n\n### Does this PR introduce _any_ user-facing change?\n\nShould specified `Seq` to `scala.collection.Seq`  when we call `Row.getAs[Seq]` and `Row.get(i).asInstanceOf[Seq]` because the data maybe `mutable.ArraySeq` but the `Seq` is `immutable.Seq` in Scala 2.13\n\n### How was this patch tested?\n\n- Scala 2.12: Pass the Jenkins or GitHub Action\n\n- Scala 2.13: Do the following:\n\n```\ndev/change-scala-version.sh 2.13\nmvn clean install -DskipTests  -pl sql/core -Pscala-2.13 -am\nmvn test -pl sql/core -Pscala-2.13\n```\n\n**Before**\n```\nTests: succeeded 8166, failed 319, canceled 1, ignored 52, pending 0\n*** 319 TESTS FAILED ***\n\n```\n\n**After**\n\n```\nTests: succeeded 8204, failed 286, canceled 1, ignored 52, pending 0\n*** 286 TESTS FAILED ***\n\n```\n\nCloses #29660 from LuciferYang/SPARK-32808.\n\nAuthored-by: yangjie01 <yangjie01@baidu.com>\nSigned-off-by: Sean Owen <srowen@gmail.com>", "tree": {"sha": "19320f8ca8d74bdde1ac8342518385beecff24c8", "url": "https://api.github.com/repos/apache/spark/git/trees/19320f8ca8d74bdde1ac8342518385beecff24c8"}, "url": "https://api.github.com/repos/apache/spark/git/commits/513d51a2c5dd2c7ff2c2fadc26ec122883372be1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/513d51a2c5dd2c7ff2c2fadc26ec122883372be1", "html_url": "https://github.com/apache/spark/commit/513d51a2c5dd2c7ff2c2fadc26ec122883372be1", "comments_url": "https://api.github.com/repos/apache/spark/commits/513d51a2c5dd2c7ff2c2fadc26ec122883372be1/comments", "author": {"login": "LuciferYang", "id": 1475305, "node_id": "MDQ6VXNlcjE0NzUzMDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1475305?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LuciferYang", "html_url": "https://github.com/LuciferYang", "followers_url": "https://api.github.com/users/LuciferYang/followers", "following_url": "https://api.github.com/users/LuciferYang/following{/other_user}", "gists_url": "https://api.github.com/users/LuciferYang/gists{/gist_id}", "starred_url": "https://api.github.com/users/LuciferYang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LuciferYang/subscriptions", "organizations_url": "https://api.github.com/users/LuciferYang/orgs", "repos_url": "https://api.github.com/users/LuciferYang/repos", "events_url": "https://api.github.com/users/LuciferYang/events{/privacy}", "received_events_url": "https://api.github.com/users/LuciferYang/received_events", "type": "User", "site_admin": false}, "committer": {"login": "srowen", "id": 822522, "node_id": "MDQ6VXNlcjgyMjUyMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/822522?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srowen", "html_url": "https://github.com/srowen", "followers_url": "https://api.github.com/users/srowen/followers", "following_url": "https://api.github.com/users/srowen/following{/other_user}", "gists_url": "https://api.github.com/users/srowen/gists{/gist_id}", "starred_url": "https://api.github.com/users/srowen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srowen/subscriptions", "organizations_url": "https://api.github.com/users/srowen/orgs", "repos_url": "https://api.github.com/users/srowen/repos", "events_url": "https://api.github.com/users/srowen/events{/privacy}", "received_events_url": "https://api.github.com/users/srowen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "794b48c1728509bad9e5390646e5119789b79d2b", "url": "https://api.github.com/repos/apache/spark/commits/794b48c1728509bad9e5390646e5119789b79d2b", "html_url": "https://github.com/apache/spark/commit/794b48c1728509bad9e5390646e5119789b79d2b"}]}, {"sha": "794b48c1728509bad9e5390646e5119789b79d2b", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6Nzk0YjQ4YzE3Mjg1MDliYWQ5ZTUzOTA2NDZlNTExOTc4OWI3OWQyYg==", "commit": {"author": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-09T04:22:13Z"}, "committer": {"name": "Gengliang Wang", "email": "gengliang.wang@databricks.com", "date": "2020-09-09T04:22:13Z"}, "message": "[SPARK-32204][SPARK-32182][DOCS][FOLLOW-UP] Use IPython instead of ipython to check if installed in dev/lint-python\n\n### What changes were proposed in this pull request?\n\nIt should check `IPython` as it's imported as a package. Currently, Sphinx build is being skipped in GitHub Actions as below:\n\nhttps://github.com/apache/spark/runs/1084164546\n\n```\nstarting python compilation test...\npython compilation succeeded.\n\nstarting pycodestyle test...\npycodestyle checks passed.\n\nstarting flake8 test...\nflake8 checks passed.\n\npython3 does not have ipython installed. Skipping Sphinx build for now.\n\nall lint-python tests passed!\n```\n\n### Why are the changes needed?\n\nTo run the documentation builds in Github Actions.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo, dev-only\n\n### How was this patch tested?\n\nManually tested as `dev/lint-python`.\n\nCloses #29679 from HyukjinKwon/follow-ipython.\n\nAuthored-by: HyukjinKwon <gurwls223@apache.org>\nSigned-off-by: Gengliang Wang <gengliang.wang@databricks.com>", "tree": {"sha": "ba2eedca55ff1497e5366a36b9a2db0f5922d36a", "url": "https://api.github.com/repos/apache/spark/git/trees/ba2eedca55ff1497e5366a36b9a2db0f5922d36a"}, "url": "https://api.github.com/repos/apache/spark/git/commits/794b48c1728509bad9e5390646e5119789b79d2b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/794b48c1728509bad9e5390646e5119789b79d2b", "html_url": "https://github.com/apache/spark/commit/794b48c1728509bad9e5390646e5119789b79d2b", "comments_url": "https://api.github.com/repos/apache/spark/commits/794b48c1728509bad9e5390646e5119789b79d2b/comments", "author": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "gengliangwang", "id": 1097932, "node_id": "MDQ6VXNlcjEwOTc5MzI=", "avatar_url": "https://avatars0.githubusercontent.com/u/1097932?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gengliangwang", "html_url": "https://github.com/gengliangwang", "followers_url": "https://api.github.com/users/gengliangwang/followers", "following_url": "https://api.github.com/users/gengliangwang/following{/other_user}", "gists_url": "https://api.github.com/users/gengliangwang/gists{/gist_id}", "starred_url": "https://api.github.com/users/gengliangwang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gengliangwang/subscriptions", "organizations_url": "https://api.github.com/users/gengliangwang/orgs", "repos_url": "https://api.github.com/users/gengliangwang/repos", "events_url": "https://api.github.com/users/gengliangwang/events{/privacy}", "received_events_url": "https://api.github.com/users/gengliangwang/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "de0dc52a842bf4374c1ae4f9546dd95b3f35c4f1", "url": "https://api.github.com/repos/apache/spark/commits/de0dc52a842bf4374c1ae4f9546dd95b3f35c4f1", "html_url": "https://github.com/apache/spark/commit/de0dc52a842bf4374c1ae4f9546dd95b3f35c4f1"}]}, {"sha": "de0dc52a842bf4374c1ae4f9546dd95b3f35c4f1", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6ZGUwZGM1MmE4NDJiZjQzNzRjMWFlNGY5NTQ2ZGQ5NWIzZjM1YzRmMQ==", "commit": {"author": {"name": "Liang-Chi Hsieh", "email": "viirya@gmail.com", "date": "2020-09-09T03:23:05Z"}, "committer": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-09T03:23:05Z"}, "message": "[SPARK-32813][SQL] Get default config of ParquetSource vectorized reader if no active SparkSession\n\n### What changes were proposed in this pull request?\n\nIf no active SparkSession is available, let `FileSourceScanExec.needsUnsafeRowConversion` look at default SQL config of ParquetSource vectorized reader instead of failing the query execution.\n\n### Why are the changes needed?\n\nFix a bug that if no active SparkSession is available, file-based data source scan for Parquet Source will throw exception.\n\n### Does this PR introduce _any_ user-facing change?\n\nYes, this change fixes the bug.\n\n### How was this patch tested?\n\nUnit test.\n\nCloses #29667 from viirya/SPARK-32813.\n\nAuthored-by: Liang-Chi Hsieh <viirya@gmail.com>\nSigned-off-by: HyukjinKwon <gurwls223@apache.org>", "tree": {"sha": "10d259080137f9861159467e91d8e953125e9dfd", "url": "https://api.github.com/repos/apache/spark/git/trees/10d259080137f9861159467e91d8e953125e9dfd"}, "url": "https://api.github.com/repos/apache/spark/git/commits/de0dc52a842bf4374c1ae4f9546dd95b3f35c4f1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/de0dc52a842bf4374c1ae4f9546dd95b3f35c4f1", "html_url": "https://github.com/apache/spark/commit/de0dc52a842bf4374c1ae4f9546dd95b3f35c4f1", "comments_url": "https://api.github.com/repos/apache/spark/commits/de0dc52a842bf4374c1ae4f9546dd95b3f35c4f1/comments", "author": {"login": "viirya", "id": 68855, "node_id": "MDQ6VXNlcjY4ODU1", "avatar_url": "https://avatars1.githubusercontent.com/u/68855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/viirya", "html_url": "https://github.com/viirya", "followers_url": "https://api.github.com/users/viirya/followers", "following_url": "https://api.github.com/users/viirya/following{/other_user}", "gists_url": "https://api.github.com/users/viirya/gists{/gist_id}", "starred_url": "https://api.github.com/users/viirya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/viirya/subscriptions", "organizations_url": "https://api.github.com/users/viirya/orgs", "repos_url": "https://api.github.com/users/viirya/repos", "events_url": "https://api.github.com/users/viirya/events{/privacy}", "received_events_url": "https://api.github.com/users/viirya/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "514bf563a7fa1f470b2ab088c0838317500a9aab", "url": "https://api.github.com/repos/apache/spark/commits/514bf563a7fa1f470b2ab088c0838317500a9aab", "html_url": "https://github.com/apache/spark/commit/514bf563a7fa1f470b2ab088c0838317500a9aab"}]}, {"sha": "514bf563a7fa1f470b2ab088c0838317500a9aab", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6NTE0YmY1NjNhN2ZhMWY0NzBiMmFiMDg4YzA4MzgzMTc1MDBhOWFhYg==", "commit": {"author": {"name": "Thomas Graves", "email": "tgraves@nvidia.com", "date": "2020-09-09T01:33:21Z"}, "committer": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-09T01:33:21Z"}, "message": "[SPARK-32823][WEB UI] Fix the master ui resources reporting\n\n### What changes were proposed in this pull request?\n\nFixes the master UI for properly summing the resources total across multiple workers.\nfield:\nResources in use: 0 / 8 gpu\n\nThe bug here is that it was creating MutableResourceInfo and then reducing using the + operator.  the + operator in MutableResourceInfo simple adds the address from one to the addresses of the other.  But its using a HashSet so if the addresses are the same then you lose the correct amount.  ie worker1 has gpu addresses 0,1,2,3 and worker2 has addresses 0,1,2,3 then you only see 4 total GPUs when there are 8.\n\nIn this case we don't really need to create the MutableResourceInfo at all because we just want the sums for used and total so just remove the use of it.  The other uses of it are per Worker so those should be ok.\n\n### Why are the changes needed?\n\nfix UI\n\n### Does this PR introduce _any_ user-facing change?\n\nUI\n\n### How was this patch tested?\n\ntested manually on standalone cluster with multiple workers and multiple GPUs and multiple fpgas\n\nCloses #29683 from tgravescs/SPARK-32823.\n\nLead-authored-by: Thomas Graves <tgraves@nvidia.com>\nCo-authored-by: Thomas Graves <tgraves@apache.org>\nSigned-off-by: HyukjinKwon <gurwls223@apache.org>", "tree": {"sha": "0c4c5bf31e759f85999d152c3f22e661bc5bf848", "url": "https://api.github.com/repos/apache/spark/git/trees/0c4c5bf31e759f85999d152c3f22e661bc5bf848"}, "url": "https://api.github.com/repos/apache/spark/git/commits/514bf563a7fa1f470b2ab088c0838317500a9aab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/514bf563a7fa1f470b2ab088c0838317500a9aab", "html_url": "https://github.com/apache/spark/commit/514bf563a7fa1f470b2ab088c0838317500a9aab", "comments_url": "https://api.github.com/repos/apache/spark/commits/514bf563a7fa1f470b2ab088c0838317500a9aab/comments", "author": {"login": "tgravescs", "id": 4563792, "node_id": "MDQ6VXNlcjQ1NjM3OTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/4563792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tgravescs", "html_url": "https://github.com/tgravescs", "followers_url": "https://api.github.com/users/tgravescs/followers", "following_url": "https://api.github.com/users/tgravescs/following{/other_user}", "gists_url": "https://api.github.com/users/tgravescs/gists{/gist_id}", "starred_url": "https://api.github.com/users/tgravescs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tgravescs/subscriptions", "organizations_url": "https://api.github.com/users/tgravescs/orgs", "repos_url": "https://api.github.com/users/tgravescs/repos", "events_url": "https://api.github.com/users/tgravescs/events{/privacy}", "received_events_url": "https://api.github.com/users/tgravescs/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "adc8d687cee33316a4ec1e006efaea8e823491f6", "url": "https://api.github.com/repos/apache/spark/commits/adc8d687cee33316a4ec1e006efaea8e823491f6", "html_url": "https://github.com/apache/spark/commit/adc8d687cee33316a4ec1e006efaea8e823491f6"}]}, {"sha": "adc8d687cee33316a4ec1e006efaea8e823491f6", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6YWRjOGQ2ODdjZWUzMzMxNmE0ZWMxZTAwNmVmYWVhOGU4MjM0OTFmNg==", "commit": {"author": {"name": "Max Gekk", "email": "max.gekk@gmail.com", "date": "2020-09-09T01:29:58Z"}, "committer": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-09T01:29:58Z"}, "message": "[SPARK-32810][SQL][TESTS][FOLLOWUP] Check path globbing in JSON/CSV datasources v1 and v2\n\n### What changes were proposed in this pull request?\nIn the PR, I propose to move the test `SPARK-32810: CSV and JSON data sources should be able to read files with escaped glob metacharacter in the paths` from `DataFrameReaderWriterSuite` to `CSVSuite` and to `JsonSuite`. This will allow to run the same test in `CSVv1Suite`/`CSVv2Suite` and in `JsonV1Suite`/`JsonV2Suite`.\n\n### Why are the changes needed?\nTo improve test coverage by checking JSON/CSV datasources v1 and v2.\n\n### Does this PR introduce _any_ user-facing change?\nNo\n\n### How was this patch tested?\nBy running affected test suites:\n```\n$ build/sbt \"sql/test:testOnly org.apache.spark.sql.execution.datasources.csv.*\"\n$ build/sbt \"sql/test:testOnly org.apache.spark.sql.execution.datasources.json.*\"\n```\n\nCloses #29684 from MaxGekk/globbing-paths-when-inferring-schema-dsv2.\n\nAuthored-by: Max Gekk <max.gekk@gmail.com>\nSigned-off-by: HyukjinKwon <gurwls223@apache.org>", "tree": {"sha": "fdce4fd29ec80ec16d17f7fe25a3e18d18ea051d", "url": "https://api.github.com/repos/apache/spark/git/trees/fdce4fd29ec80ec16d17f7fe25a3e18d18ea051d"}, "url": "https://api.github.com/repos/apache/spark/git/commits/adc8d687cee33316a4ec1e006efaea8e823491f6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/adc8d687cee33316a4ec1e006efaea8e823491f6", "html_url": "https://github.com/apache/spark/commit/adc8d687cee33316a4ec1e006efaea8e823491f6", "comments_url": "https://api.github.com/repos/apache/spark/commits/adc8d687cee33316a4ec1e006efaea8e823491f6/comments", "author": {"login": "MaxGekk", "id": 1580697, "node_id": "MDQ6VXNlcjE1ODA2OTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1580697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MaxGekk", "html_url": "https://github.com/MaxGekk", "followers_url": "https://api.github.com/users/MaxGekk/followers", "following_url": "https://api.github.com/users/MaxGekk/following{/other_user}", "gists_url": "https://api.github.com/users/MaxGekk/gists{/gist_id}", "starred_url": "https://api.github.com/users/MaxGekk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MaxGekk/subscriptions", "organizations_url": "https://api.github.com/users/MaxGekk/orgs", "repos_url": "https://api.github.com/users/MaxGekk/repos", "events_url": "https://api.github.com/users/MaxGekk/events{/privacy}", "received_events_url": "https://api.github.com/users/MaxGekk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e8634d8f6f8548852a284a32c1b7da24bedd8ff7", "url": "https://api.github.com/repos/apache/spark/commits/e8634d8f6f8548852a284a32c1b7da24bedd8ff7", "html_url": "https://github.com/apache/spark/commit/e8634d8f6f8548852a284a32c1b7da24bedd8ff7"}]}, {"sha": "e8634d8f6f8548852a284a32c1b7da24bedd8ff7", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6ZTg2MzRkOGY2Zjg1NDg4NTJhMjg0YTMyYzFiN2RhMjRiZWRkOGZmNw==", "commit": {"author": {"name": "Thomas Graves", "email": "tgraves@nvidia.com", "date": "2020-09-09T01:28:40Z"}, "committer": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-09T01:28:40Z"}, "message": "[SPARK-32824][CORE] Improve the error message when the user forgets the .amount in a resource config\n\n### What changes were proposed in this pull request?\n\nIf the user forgets to specify .amount on a resource config like spark.executor.resource.gpu, the error message thrown is very confusing:\n\n```\nERROR SparkContext: Error initializing SparkContext.java.lang.StringIndexOutOfBoundsException: String index out of range:\n-1 at java.lang.String.substring(String.java:1967) at\n```\n\nThis makes it so we have a readable error thrown\n\n### Why are the changes needed?\n\nconfusing error for users\n### Does this PR introduce _any_ user-facing change?\n\njust error message\n\n### How was this patch tested?\n\nTested manually on standalone cluster\n\nCloses #29685 from tgravescs/SPARK-32824.\n\nAuthored-by: Thomas Graves <tgraves@nvidia.com>\nSigned-off-by: HyukjinKwon <gurwls223@apache.org>", "tree": {"sha": "6fcb2ae5e83d33ebc9dd513ab672ea7c9820ecae", "url": "https://api.github.com/repos/apache/spark/git/trees/6fcb2ae5e83d33ebc9dd513ab672ea7c9820ecae"}, "url": "https://api.github.com/repos/apache/spark/git/commits/e8634d8f6f8548852a284a32c1b7da24bedd8ff7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/e8634d8f6f8548852a284a32c1b7da24bedd8ff7", "html_url": "https://github.com/apache/spark/commit/e8634d8f6f8548852a284a32c1b7da24bedd8ff7", "comments_url": "https://api.github.com/repos/apache/spark/commits/e8634d8f6f8548852a284a32c1b7da24bedd8ff7/comments", "author": {"login": "tgravescs", "id": 4563792, "node_id": "MDQ6VXNlcjQ1NjM3OTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/4563792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tgravescs", "html_url": "https://github.com/tgravescs", "followers_url": "https://api.github.com/users/tgravescs/followers", "following_url": "https://api.github.com/users/tgravescs/following{/other_user}", "gists_url": "https://api.github.com/users/tgravescs/gists{/gist_id}", "starred_url": "https://api.github.com/users/tgravescs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tgravescs/subscriptions", "organizations_url": "https://api.github.com/users/tgravescs/orgs", "repos_url": "https://api.github.com/users/tgravescs/repos", "events_url": "https://api.github.com/users/tgravescs/events{/privacy}", "received_events_url": "https://api.github.com/users/tgravescs/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "96ff87dce893868c839718798e08fbe15240ec1c", "url": "https://api.github.com/repos/apache/spark/commits/96ff87dce893868c839718798e08fbe15240ec1c", "html_url": "https://github.com/apache/spark/commit/96ff87dce893868c839718798e08fbe15240ec1c"}]}, {"sha": "96ff87dce893868c839718798e08fbe15240ec1c", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6OTZmZjg3ZGNlODkzODY4YzgzOTcxODc5OGUwOGZiZTE1MjQwZWMxYw==", "commit": {"author": {"name": "manuzhang", "email": "owenzhang1990@gmail.com", "date": "2020-09-09T01:20:21Z"}, "committer": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-09T01:20:21Z"}, "message": "[SPARK-32753][SQL][FOLLOWUP] Fix indentation and clean up view in test\n\n### What changes were proposed in this pull request?\nFix indentation and clean up view in the test added by https://github.com/apache/spark/pull/29593.\n\n### Why are the changes needed?\nAddress review comments in https://github.com/apache/spark/pull/29665.\n\n### Does this PR introduce _any_ user-facing change?\nNo.\n\n### How was this patch tested?\nUpdated test.\n\nCloses #29682 from manuzhang/spark-32753-followup.\n\nAuthored-by: manuzhang <owenzhang1990@gmail.com>\nSigned-off-by: HyukjinKwon <gurwls223@apache.org>", "tree": {"sha": "bcd393990f923bf7241553280536b1f92e7ebdb0", "url": "https://api.github.com/repos/apache/spark/git/trees/bcd393990f923bf7241553280536b1f92e7ebdb0"}, "url": "https://api.github.com/repos/apache/spark/git/commits/96ff87dce893868c839718798e08fbe15240ec1c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/96ff87dce893868c839718798e08fbe15240ec1c", "html_url": "https://github.com/apache/spark/commit/96ff87dce893868c839718798e08fbe15240ec1c", "comments_url": "https://api.github.com/repos/apache/spark/commits/96ff87dce893868c839718798e08fbe15240ec1c/comments", "author": {"login": "manuzhang", "id": 1191767, "node_id": "MDQ6VXNlcjExOTE3Njc=", "avatar_url": "https://avatars3.githubusercontent.com/u/1191767?v=4", "gravatar_id": "", "url": "https://api.github.com/users/manuzhang", "html_url": "https://github.com/manuzhang", "followers_url": "https://api.github.com/users/manuzhang/followers", "following_url": "https://api.github.com/users/manuzhang/following{/other_user}", "gists_url": "https://api.github.com/users/manuzhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/manuzhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/manuzhang/subscriptions", "organizations_url": "https://api.github.com/users/manuzhang/orgs", "repos_url": "https://api.github.com/users/manuzhang/repos", "events_url": "https://api.github.com/users/manuzhang/events{/privacy}", "received_events_url": "https://api.github.com/users/manuzhang/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa87b0aba3304aff195e98e76dc036d7ebd4c7c4", "url": "https://api.github.com/repos/apache/spark/commits/aa87b0aba3304aff195e98e76dc036d7ebd4c7c4", "html_url": "https://github.com/apache/spark/commit/aa87b0aba3304aff195e98e76dc036d7ebd4c7c4"}]}, {"sha": "aa87b0aba3304aff195e98e76dc036d7ebd4c7c4", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6YWE4N2IwYWJhMzMwNGFmZjE5NWU5OGU3NmRjMDM2ZDdlYmQ0YzdjNA==", "commit": {"author": {"name": "Max Gekk", "email": "max.gekk@gmail.com", "date": "2020-09-08T14:15:16Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-08T14:15:16Z"}, "message": "[SPARK-32815][ML] Fix LibSVM data source loading error on file paths with glob metacharacters\n\n### What changes were proposed in this pull request?\nIn the PR, I propose to fix an issue with LibSVM datasource when both of the following are true:\n* no user specified schema\n* some file paths contain escaped glob metacharacters, such as `[``]`, `{``}`, `*` etc.\n\nThe fix is based on another bug fix for CSV/JSON datasources https://github.com/apache/spark/pull/29659.\n\n### Why are the changes needed?\nTo fix the issue when the follow two queries try to read from paths `[abc]`:\n```scala\nspark.read.format(\"libsvm\").load(\"\"\"/tmp/\\[abc\\].csv\"\"\").show\n```\nbut would end up hitting an exception:\n```\nPath does not exist: file:/private/var/folders/p3/dfs6mf655d7fnjrsjvldh0tc0000gn/T/spark-6ef0ae5e-ff9f-4c4f-9ff4-0db3ee1f6a82/[abc]/part-00000-26406ab9-4e56-45fd-a25a-491c18a05e76-c000.libsvm;\norg.apache.spark.sql.AnalysisException: Path does not exist: file:/private/var/folders/p3/dfs6mf655d7fnjrsjvldh0tc0000gn/T/spark-6ef0ae5e-ff9f-4c4f-9ff4-0db3ee1f6a82/[abc]/part-00000-26406ab9-4e56-45fd-a25a-491c18a05e76-c000.libsvm;\n\tat org.apache.spark.sql.execution.datasources.DataSource$.$anonfun$checkAndGlobPathIfNecessary$3(DataSource.scala:770)\n\tat org.apache.spark.util.ThreadUtils$.$anonfun$parmap$2(ThreadUtils.scala:373)\n\tat scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)\n\tat scala.util.Success.$anonfun$map$1(Try.scala:255)\n\tat scala.util.Success.map(Try.scala:213)\n```\n\n### Does this PR introduce _any_ user-facing change?\nYes\n\n### How was this patch tested?\nAdded UT to `LibSVMRelationSuite`.\n\nCloses #29670 from MaxGekk/globbing-paths-when-inferring-schema-ml.\n\nAuthored-by: Max Gekk <max.gekk@gmail.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "02308bffc3e07044452a2bac9d5dfb6a757d66aa", "url": "https://api.github.com/repos/apache/spark/git/trees/02308bffc3e07044452a2bac9d5dfb6a757d66aa"}, "url": "https://api.github.com/repos/apache/spark/git/commits/aa87b0aba3304aff195e98e76dc036d7ebd4c7c4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/aa87b0aba3304aff195e98e76dc036d7ebd4c7c4", "html_url": "https://github.com/apache/spark/commit/aa87b0aba3304aff195e98e76dc036d7ebd4c7c4", "comments_url": "https://api.github.com/repos/apache/spark/commits/aa87b0aba3304aff195e98e76dc036d7ebd4c7c4/comments", "author": {"login": "MaxGekk", "id": 1580697, "node_id": "MDQ6VXNlcjE1ODA2OTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1580697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MaxGekk", "html_url": "https://github.com/MaxGekk", "followers_url": "https://api.github.com/users/MaxGekk/followers", "following_url": "https://api.github.com/users/MaxGekk/following{/other_user}", "gists_url": "https://api.github.com/users/MaxGekk/gists{/gist_id}", "starred_url": "https://api.github.com/users/MaxGekk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MaxGekk/subscriptions", "organizations_url": "https://api.github.com/users/MaxGekk/orgs", "repos_url": "https://api.github.com/users/MaxGekk/repos", "events_url": "https://api.github.com/users/MaxGekk/events{/privacy}", "received_events_url": "https://api.github.com/users/MaxGekk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e7d9a245656655e7bb1df3e04df30eb3cc9e23ad", "url": "https://api.github.com/repos/apache/spark/commits/e7d9a245656655e7bb1df3e04df30eb3cc9e23ad", "html_url": "https://github.com/apache/spark/commit/e7d9a245656655e7bb1df3e04df30eb3cc9e23ad"}]}, {"sha": "e7d9a245656655e7bb1df3e04df30eb3cc9e23ad", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6ZTdkOWEyNDU2NTY2NTVlN2JiMWRmM2UwNGRmMzBlYjNjYzllMjNhZA==", "commit": {"author": {"name": "Zhenhua Wang", "email": "wzh_zju@163.com", "date": "2020-09-08T12:36:21Z"}, "committer": {"name": "Takeshi Yamamuro", "email": "yamamuro@apache.org", "date": "2020-09-08T12:36:21Z"}, "message": "[SPARK-32817][SQL] DPP throws error when broadcast side is empty\n\n### What changes were proposed in this pull request?\n\nIn `SubqueryBroadcastExec.relationFuture`, if the `broadcastRelation` is an `EmptyHashedRelation`, then `broadcastRelation.keys()` will throw `UnsupportedOperationException`.\n\n### Why are the changes needed?\n\nTo fix a bug.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo.\n\n### How was this patch tested?\n\nAdded a new test.\n\nCloses #29671 from wzhfy/dpp_empty_broadcast.\n\nAuthored-by: Zhenhua Wang <wzh_zju@163.com>\nSigned-off-by: Takeshi Yamamuro <yamamuro@apache.org>", "tree": {"sha": "524d44f24ff8e6afe8db3b1452e9135d44285420", "url": "https://api.github.com/repos/apache/spark/git/trees/524d44f24ff8e6afe8db3b1452e9135d44285420"}, "url": "https://api.github.com/repos/apache/spark/git/commits/e7d9a245656655e7bb1df3e04df30eb3cc9e23ad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/e7d9a245656655e7bb1df3e04df30eb3cc9e23ad", "html_url": "https://github.com/apache/spark/commit/e7d9a245656655e7bb1df3e04df30eb3cc9e23ad", "comments_url": "https://api.github.com/repos/apache/spark/commits/e7d9a245656655e7bb1df3e04df30eb3cc9e23ad/comments", "author": {"login": "wzhfy", "id": 10878553, "node_id": "MDQ6VXNlcjEwODc4NTUz", "avatar_url": "https://avatars3.githubusercontent.com/u/10878553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wzhfy", "html_url": "https://github.com/wzhfy", "followers_url": "https://api.github.com/users/wzhfy/followers", "following_url": "https://api.github.com/users/wzhfy/following{/other_user}", "gists_url": "https://api.github.com/users/wzhfy/gists{/gist_id}", "starred_url": "https://api.github.com/users/wzhfy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wzhfy/subscriptions", "organizations_url": "https://api.github.com/users/wzhfy/orgs", "repos_url": "https://api.github.com/users/wzhfy/repos", "events_url": "https://api.github.com/users/wzhfy/events{/privacy}", "received_events_url": "https://api.github.com/users/wzhfy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "maropu", "id": 692303, "node_id": "MDQ6VXNlcjY5MjMwMw==", "avatar_url": "https://avatars3.githubusercontent.com/u/692303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maropu", "html_url": "https://github.com/maropu", "followers_url": "https://api.github.com/users/maropu/followers", "following_url": "https://api.github.com/users/maropu/following{/other_user}", "gists_url": "https://api.github.com/users/maropu/gists{/gist_id}", "starred_url": "https://api.github.com/users/maropu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maropu/subscriptions", "organizations_url": "https://api.github.com/users/maropu/orgs", "repos_url": "https://api.github.com/users/maropu/repos", "events_url": "https://api.github.com/users/maropu/events{/privacy}", "received_events_url": "https://api.github.com/users/maropu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bd3dc2f54d871d152331612c53f586181f4e87fc", "url": "https://api.github.com/repos/apache/spark/commits/bd3dc2f54d871d152331612c53f586181f4e87fc", "html_url": "https://github.com/apache/spark/commit/bd3dc2f54d871d152331612c53f586181f4e87fc"}]}, {"sha": "bd3dc2f54d871d152331612c53f586181f4e87fc", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6YmQzZGMyZjU0ZDg3MWQxNTIzMzE2MTJjNTNmNTg2MTgxZjRlODdmYw==", "commit": {"author": {"name": "sychen", "email": "sychen@ctrip.com", "date": "2020-09-08T11:54:04Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-08T11:54:04Z"}, "message": "[SPARK-31511][FOLLOW-UP][TEST][SQL] Make BytesToBytesMap iterators thread-safe\n\n### What changes were proposed in this pull request?\nBefore SPARK-31511 is fixed, `BytesToBytesMap` iterator() is not thread-safe and may cause data inaccuracy.\nWe need to add a unit test.\n\n### Why are the changes needed?\nIncrease test coverage to ensure that iterator() is thread-safe.\n\n### Does this PR introduce _any_ user-facing change?\nNo.\n\n### How was this patch tested?\nadd ut\n\nCloses #29669 from cxzl25/SPARK-31511-test.\n\nAuthored-by: sychen <sychen@ctrip.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "986fbd242745bc018544e1dc588369cfba763d23", "url": "https://api.github.com/repos/apache/spark/git/trees/986fbd242745bc018544e1dc588369cfba763d23"}, "url": "https://api.github.com/repos/apache/spark/git/commits/bd3dc2f54d871d152331612c53f586181f4e87fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/bd3dc2f54d871d152331612c53f586181f4e87fc", "html_url": "https://github.com/apache/spark/commit/bd3dc2f54d871d152331612c53f586181f4e87fc", "comments_url": "https://api.github.com/repos/apache/spark/commits/bd3dc2f54d871d152331612c53f586181f4e87fc/comments", "author": {"login": "cxzl25", "id": 3898450, "node_id": "MDQ6VXNlcjM4OTg0NTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/3898450?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cxzl25", "html_url": "https://github.com/cxzl25", "followers_url": "https://api.github.com/users/cxzl25/followers", "following_url": "https://api.github.com/users/cxzl25/following{/other_user}", "gists_url": "https://api.github.com/users/cxzl25/gists{/gist_id}", "starred_url": "https://api.github.com/users/cxzl25/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cxzl25/subscriptions", "organizations_url": "https://api.github.com/users/cxzl25/orgs", "repos_url": "https://api.github.com/users/cxzl25/repos", "events_url": "https://api.github.com/users/cxzl25/events{/privacy}", "received_events_url": "https://api.github.com/users/cxzl25/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "55d38a479b3d9d2607e1c564f07bf617fca8a6c2", "url": "https://api.github.com/repos/apache/spark/commits/55d38a479b3d9d2607e1c564f07bf617fca8a6c2", "html_url": "https://github.com/apache/spark/commit/55d38a479b3d9d2607e1c564f07bf617fca8a6c2"}]}, {"sha": "55d38a479b3d9d2607e1c564f07bf617fca8a6c2", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6NTVkMzhhNDc5YjNkOWQyNjA3ZTFjNTY0ZjA3YmY2MTdmY2E4YTZjMg==", "commit": {"author": {"name": "Zhenhua Wang", "email": "wzh_zju@163.com", "date": "2020-09-08T11:20:16Z"}, "committer": {"name": "Takeshi Yamamuro", "email": "yamamuro@apache.org", "date": "2020-09-08T11:20:16Z"}, "message": "[SPARK-32748][SQL] Revert \"Support local property propagation in SubqueryBroadcastExec\"\n\n### What changes were proposed in this pull request?\n\nThis reverts commit 04f7f6dac0b9177e11482cca4e7ebf7b7564e45f due to the discussion in [comment](https://github.com/apache/spark/pull/29589#discussion_r484657207).\n\n### Why are the changes needed?\n\nBased on  the discussion in [comment](https://github.com/apache/spark/pull/29589#discussion_r484657207), propagation for thread local properties in `SubqueryBroadcastExec` is not necessary, since they will be propagated by broadcast exchange threads anyway.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo.\n\n### How was this patch tested?\n\nAlso revert the added test.\n\nCloses #29674 from wzhfy/revert_dpp_thread_local.\n\nAuthored-by: Zhenhua Wang <wzh_zju@163.com>\nSigned-off-by: Takeshi Yamamuro <yamamuro@apache.org>", "tree": {"sha": "da0c9291f3c8e175a9ddaa0d0463e7a24e8f3b94", "url": "https://api.github.com/repos/apache/spark/git/trees/da0c9291f3c8e175a9ddaa0d0463e7a24e8f3b94"}, "url": "https://api.github.com/repos/apache/spark/git/commits/55d38a479b3d9d2607e1c564f07bf617fca8a6c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/55d38a479b3d9d2607e1c564f07bf617fca8a6c2", "html_url": "https://github.com/apache/spark/commit/55d38a479b3d9d2607e1c564f07bf617fca8a6c2", "comments_url": "https://api.github.com/repos/apache/spark/commits/55d38a479b3d9d2607e1c564f07bf617fca8a6c2/comments", "author": {"login": "wzhfy", "id": 10878553, "node_id": "MDQ6VXNlcjEwODc4NTUz", "avatar_url": "https://avatars3.githubusercontent.com/u/10878553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wzhfy", "html_url": "https://github.com/wzhfy", "followers_url": "https://api.github.com/users/wzhfy/followers", "following_url": "https://api.github.com/users/wzhfy/following{/other_user}", "gists_url": "https://api.github.com/users/wzhfy/gists{/gist_id}", "starred_url": "https://api.github.com/users/wzhfy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wzhfy/subscriptions", "organizations_url": "https://api.github.com/users/wzhfy/orgs", "repos_url": "https://api.github.com/users/wzhfy/repos", "events_url": "https://api.github.com/users/wzhfy/events{/privacy}", "received_events_url": "https://api.github.com/users/wzhfy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "maropu", "id": 692303, "node_id": "MDQ6VXNlcjY5MjMwMw==", "avatar_url": "https://avatars3.githubusercontent.com/u/692303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maropu", "html_url": "https://github.com/maropu", "followers_url": "https://api.github.com/users/maropu/followers", "following_url": "https://api.github.com/users/maropu/following{/other_user}", "gists_url": "https://api.github.com/users/maropu/gists{/gist_id}", "starred_url": "https://api.github.com/users/maropu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maropu/subscriptions", "organizations_url": "https://api.github.com/users/maropu/orgs", "repos_url": "https://api.github.com/users/maropu/repos", "events_url": "https://api.github.com/users/maropu/events{/privacy}", "received_events_url": "https://api.github.com/users/maropu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "125cbe3ae0d664ddc80b5b83cc82a43a0cefb5ca", "url": "https://api.github.com/repos/apache/spark/commits/125cbe3ae0d664ddc80b5b83cc82a43a0cefb5ca", "html_url": "https://github.com/apache/spark/commit/125cbe3ae0d664ddc80b5b83cc82a43a0cefb5ca"}]}, {"sha": "125cbe3ae0d664ddc80b5b83cc82a43a0cefb5ca", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6MTI1Y2JlM2FlMGQ2NjRkZGM4MGI1YjgzY2M4MmE0M2EwY2VmYjVjYQ==", "commit": {"author": {"name": "yi.wu", "email": "yi.wu@databricks.com", "date": "2020-09-08T04:40:13Z"}, "committer": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-08T04:40:13Z"}, "message": "[SPARK-32736][CORE] Avoid caching the removed decommissioned executors in TaskSchedulerImpl\n\n### What changes were proposed in this pull request?\n\nThe motivation of this PR is to avoid caching the removed decommissioned executors in `TaskSchedulerImpl`. The cache is introduced in https://github.com/apache/spark/pull/29422. The cache will hold the `isHostDecommissioned` info for a while. So if the task `FetchFailure` event comes after the executor loss event, `DAGScheduler` can still get the `isHostDecommissioned` from the cache and unregister the host shuffle map status when the host is decommissioned too.\n\nThis PR tries to achieve the same goal without the cache. Instead of saving the `workerLost` in `ExecutorUpdated` / `ExecutorDecommissionInfo` / `ExecutorDecommissionState`, we could save the `hostOpt` directly. When the host is decommissioned or lost too, the `hostOpt` can be a specific host address. Otherwise, it's `None` to indicate that only the executor is decommissioned or lost.\n\nNow that we have the host info, we can also unregister the host shuffle map status when `executorLost` is triggered for the decommissioned executor.\n\nBesides, this PR also includes a few cleanups around the touched code.\n\n### Why are the changes needed?\n\nIt helps to unregister the shuffle map status earlier for both decommission and normal executor lost cases.\n\nIt also saves memory in  `TaskSchedulerImpl` and simplifies the code a little bit.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo.\n\n### How was this patch tested?\n\nThis PR only refactor the code. The original behaviour should be covered by `DecommissionWorkerSuite`.\n\nCloses #29579 from Ngone51/impr-decom.\n\nAuthored-by: yi.wu <yi.wu@databricks.com>\nSigned-off-by: Wenchen Fan <wenchen@databricks.com>", "tree": {"sha": "46211ba78e3d0d909c6b6919a57b640d30f84e59", "url": "https://api.github.com/repos/apache/spark/git/trees/46211ba78e3d0d909c6b6919a57b640d30f84e59"}, "url": "https://api.github.com/repos/apache/spark/git/commits/125cbe3ae0d664ddc80b5b83cc82a43a0cefb5ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/125cbe3ae0d664ddc80b5b83cc82a43a0cefb5ca", "html_url": "https://github.com/apache/spark/commit/125cbe3ae0d664ddc80b5b83cc82a43a0cefb5ca", "comments_url": "https://api.github.com/repos/apache/spark/commits/125cbe3ae0d664ddc80b5b83cc82a43a0cefb5ca/comments", "author": {"login": "Ngone51", "id": 16397174, "node_id": "MDQ6VXNlcjE2Mzk3MTc0", "avatar_url": "https://avatars1.githubusercontent.com/u/16397174?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ngone51", "html_url": "https://github.com/Ngone51", "followers_url": "https://api.github.com/users/Ngone51/followers", "following_url": "https://api.github.com/users/Ngone51/following{/other_user}", "gists_url": "https://api.github.com/users/Ngone51/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ngone51/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ngone51/subscriptions", "organizations_url": "https://api.github.com/users/Ngone51/orgs", "repos_url": "https://api.github.com/users/Ngone51/repos", "events_url": "https://api.github.com/users/Ngone51/events{/privacy}", "received_events_url": "https://api.github.com/users/Ngone51/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4144b6da5215e9264056c2f6720fd819e18e23a5", "url": "https://api.github.com/repos/apache/spark/commits/4144b6da5215e9264056c2f6720fd819e18e23a5", "html_url": "https://github.com/apache/spark/commit/4144b6da5215e9264056c2f6720fd819e18e23a5"}]}, {"sha": "4144b6da5215e9264056c2f6720fd819e18e23a5", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6NDE0NGI2ZGE1MjE1ZTkyNjQwNTZjMmY2NzIwZmQ4MTllMThlMjNhNQ==", "commit": {"author": {"name": "Wenchen Fan", "email": "wenchen@databricks.com", "date": "2020-09-08T03:43:43Z"}, "committer": {"name": "Dongjoon Hyun", "email": "dongjoon@apache.org", "date": "2020-09-08T03:43:43Z"}, "message": "[SPARK-32764][SQL] -0.0 should be equal to 0.0\n\n### What changes were proposed in this pull request?\n\nThis is a Spark 3.0 regression introduced by https://github.com/apache/spark/pull/26761. We missed a corner case that `java.lang.Double.compare` treats 0.0 and -0.0 as different, which breaks SQL semantic.\n\nThis PR adds back the `OrderingUtil`, to provide custom compare methods that take care of 0.0 vs -0.0\n\n### Why are the changes needed?\n\nFix a correctness bug.\n\n### Does this PR introduce _any_ user-facing change?\n\nYes, now `SELECT  0.0 > -0.0` returns false correctly as Spark 2.x.\n\n### How was this patch tested?\n\nnew tests\n\nCloses #29647 from cloud-fan/float.\n\nAuthored-by: Wenchen Fan <wenchen@databricks.com>\nSigned-off-by: Dongjoon Hyun <dongjoon@apache.org>", "tree": {"sha": "02f25482d4430262532a2b21c565b9cb301ecac4", "url": "https://api.github.com/repos/apache/spark/git/trees/02f25482d4430262532a2b21c565b9cb301ecac4"}, "url": "https://api.github.com/repos/apache/spark/git/commits/4144b6da5215e9264056c2f6720fd819e18e23a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/4144b6da5215e9264056c2f6720fd819e18e23a5", "html_url": "https://github.com/apache/spark/commit/4144b6da5215e9264056c2f6720fd819e18e23a5", "comments_url": "https://api.github.com/repos/apache/spark/commits/4144b6da5215e9264056c2f6720fd819e18e23a5/comments", "author": {"login": "cloud-fan", "id": 3182036, "node_id": "MDQ6VXNlcjMxODIwMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3182036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cloud-fan", "html_url": "https://github.com/cloud-fan", "followers_url": "https://api.github.com/users/cloud-fan/followers", "following_url": "https://api.github.com/users/cloud-fan/following{/other_user}", "gists_url": "https://api.github.com/users/cloud-fan/gists{/gist_id}", "starred_url": "https://api.github.com/users/cloud-fan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cloud-fan/subscriptions", "organizations_url": "https://api.github.com/users/cloud-fan/orgs", "repos_url": "https://api.github.com/users/cloud-fan/repos", "events_url": "https://api.github.com/users/cloud-fan/events{/privacy}", "received_events_url": "https://api.github.com/users/cloud-fan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dongjoon-hyun", "id": 9700541, "node_id": "MDQ6VXNlcjk3MDA1NDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9700541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dongjoon-hyun", "html_url": "https://github.com/dongjoon-hyun", "followers_url": "https://api.github.com/users/dongjoon-hyun/followers", "following_url": "https://api.github.com/users/dongjoon-hyun/following{/other_user}", "gists_url": "https://api.github.com/users/dongjoon-hyun/gists{/gist_id}", "starred_url": "https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dongjoon-hyun/subscriptions", "organizations_url": "https://api.github.com/users/dongjoon-hyun/orgs", "repos_url": "https://api.github.com/users/dongjoon-hyun/repos", "events_url": "https://api.github.com/users/dongjoon-hyun/events{/privacy}", "received_events_url": "https://api.github.com/users/dongjoon-hyun/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c8c082ce380b2357623511c6625503fb3f1d65bf", "url": "https://api.github.com/repos/apache/spark/commits/c8c082ce380b2357623511c6625503fb3f1d65bf", "html_url": "https://github.com/apache/spark/commit/c8c082ce380b2357623511c6625503fb3f1d65bf"}]}, {"sha": "c8c082ce380b2357623511c6625503fb3f1d65bf", "node_id": "MDY6Q29tbWl0MTcxNjU2NTg6YzhjMDgyY2UzODBiMjM1NzYyMzUxMWM2NjI1NTAzZmIzZjFkNjViZg==", "commit": {"author": {"name": "itholic", "email": "haejoon309@naver.com", "date": "2020-09-08T03:22:13Z"}, "committer": {"name": "HyukjinKwon", "email": "gurwls223@apache.org", "date": "2020-09-08T03:22:13Z"}, "message": "[SPARK-32812][PYTHON][TESTS] Avoid initiating a process during the main process for run-tests.py\n\n### What changes were proposed in this pull request?\n\nIn certain environments, seems it fails to run `run-tests.py` script as below:\n\n```\nTraceback (most recent call last):\n File \"<string>\", line 1, in <module>\n...\n\nraise RuntimeError('''\nRuntimeError:\n An attempt has been made to start a new process before the\n current process has finished its bootstrapping phase.\n\nThis probably means that you are not using fork to start your\n child processes and you have forgotten to use the proper idiom\n in the main module:\n\nif __name__ == '__main__':\n freeze_support()\n ...\n\nThe \"freeze_support()\" line can be omitted if the program\n is not going to be frozen to produce an executable.\nTraceback (most recent call last):\n...\n raise EOFError\nEOFError\n\n```\n\nThe reason is that `Manager.dict()` launches another process when the main process is initiated.\n\nIt works in most environments for an unknown reason but it should be good to avoid such pattern as guided from Python itself.\n\n### Why are the changes needed?\n\nTo prevent the test failure for Python.\n\n### Does this PR introduce _any_ user-facing change?\n\nNo, it fixes a test script.\n\n### How was this patch tested?\n\nManually ran the script after fixing.\n\n```\nRunning PySpark tests. Output is in /.../python/unit-tests.log\nWill test against the following Python executables: ['/.../python3', 'python3.8']\nWill test the following Python tests: ['pyspark.sql.dataframe']\n/.../python3 python_implementation is CPython\n/.../python3 version is: Python 3.8.5\npython3.8 python_implementation is CPython\npython3.8 version is: Python 3.8.5\nStarting test(/.../python3): pyspark.sql.dataframe\nStarting test(python3.8): pyspark.sql.dataframe\nFinished test(/.../python3): pyspark.sql.dataframe (33s)\nFinished test(python3.8): pyspark.sql.dataframe (34s)\nTests passed in 34 seconds\n```\n\nCloses #29666 from itholic/SPARK-32812.\n\nAuthored-by: itholic <haejoon309@naver.com>\nSigned-off-by: HyukjinKwon <gurwls223@apache.org>", "tree": {"sha": "46a3350e584aba6ba699e91b8ece1010d654e8ac", "url": "https://api.github.com/repos/apache/spark/git/trees/46a3350e584aba6ba699e91b8ece1010d654e8ac"}, "url": "https://api.github.com/repos/apache/spark/git/commits/c8c082ce380b2357623511c6625503fb3f1d65bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/apache/spark/commits/c8c082ce380b2357623511c6625503fb3f1d65bf", "html_url": "https://github.com/apache/spark/commit/c8c082ce380b2357623511c6625503fb3f1d65bf", "comments_url": "https://api.github.com/repos/apache/spark/commits/c8c082ce380b2357623511c6625503fb3f1d65bf/comments", "author": {"login": "itholic", "id": 44108233, "node_id": "MDQ6VXNlcjQ0MTA4MjMz", "avatar_url": "https://avatars1.githubusercontent.com/u/44108233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/itholic", "html_url": "https://github.com/itholic", "followers_url": "https://api.github.com/users/itholic/followers", "following_url": "https://api.github.com/users/itholic/following{/other_user}", "gists_url": "https://api.github.com/users/itholic/gists{/gist_id}", "starred_url": "https://api.github.com/users/itholic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/itholic/subscriptions", "organizations_url": "https://api.github.com/users/itholic/orgs", "repos_url": "https://api.github.com/users/itholic/repos", "events_url": "https://api.github.com/users/itholic/events{/privacy}", "received_events_url": "https://api.github.com/users/itholic/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HyukjinKwon", "id": 6477701, "node_id": "MDQ6VXNlcjY0Nzc3MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6477701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HyukjinKwon", "html_url": "https://github.com/HyukjinKwon", "followers_url": "https://api.github.com/users/HyukjinKwon/followers", "following_url": "https://api.github.com/users/HyukjinKwon/following{/other_user}", "gists_url": "https://api.github.com/users/HyukjinKwon/gists{/gist_id}", "starred_url": "https://api.github.com/users/HyukjinKwon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HyukjinKwon/subscriptions", "organizations_url": "https://api.github.com/users/HyukjinKwon/orgs", "repos_url": "https://api.github.com/users/HyukjinKwon/repos", "events_url": "https://api.github.com/users/HyukjinKwon/events{/privacy}", "received_events_url": "https://api.github.com/users/HyukjinKwon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c336ae39cdda5f06859374c464778732d3d96917", "url": "https://api.github.com/repos/apache/spark/commits/c336ae39cdda5f06859374c464778732d3d96917", "html_url": "https://github.com/apache/spark/commit/c336ae39cdda5f06859374c464778732d3d96917"}]}]