{"total_count": 4, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/18", "repository_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy", "labels_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/18/labels{/name}", "comments_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/18/comments", "events_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/18/events", "html_url": "https://github.com/Pylons/plaster_pastedeploy/issues/18", "id": 399743546, "node_id": "MDU6SXNzdWUzOTk3NDM1NDY=", "number": 18, "title": "ConfigDict does not add global_conf values to overall settings dict", "user": {"login": "redbaron4", "id": 4869037, "node_id": "MDQ6VXNlcjQ4NjkwMzc=", "avatar_url": "https://avatars2.githubusercontent.com/u/4869037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/redbaron4", "html_url": "https://github.com/redbaron4", "followers_url": "https://api.github.com/users/redbaron4/followers", "following_url": "https://api.github.com/users/redbaron4/following{/other_user}", "gists_url": "https://api.github.com/users/redbaron4/gists{/gist_id}", "starred_url": "https://api.github.com/users/redbaron4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/redbaron4/subscriptions", "organizations_url": "https://api.github.com/users/redbaron4/orgs", "repos_url": "https://api.github.com/users/redbaron4/repos", "events_url": "https://api.github.com/users/redbaron4/events{/privacy}", "received_events_url": "https://api.github.com/users/redbaron4/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-01-16T10:30:37Z", "updated_at": "2019-04-12T07:18:29Z", "closed_at": "2019-04-12T05:33:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "I recently updated from Pyramid-1.7.2 to Pyramid-1.10 and found my app no longer worked. One of my command line scripts uses settings obtained by calling `pyramid.paster.get_appsettings`.\r\n\r\nOn Pyramid-1.7.2, the returned dictionary(I think an instance of `paste.deploy.AttrDict`) has values of the main section as well as those in the `[DEFAULT]` section. In Pyramid-1.10 (which under the hood uses `plaster` and `plaster_pastedeploy`), the returned object(`ConfigDict`) does not have settings from `[DEFAULT]` section. These settings are stored separately in `global_conf` attribute but trying to use them directly gives a `KeyError`.\r\n\r\nIs this intended behaviour - meaning this was broken in older versions (Defaults should never explicitly be part of returned settings) or is this a regression.\r\n\r\nAs a workaround, my loading code checks if DEFAULT values are part of settings and adds them if this is not the case to maintain compatibility across pyramid versions.\r\n\r\n```\r\ndef load_settings(inifile, section_name):\r\n    \"\"\"\r\n    Load the settings from paste ini file\r\n    :param inifile: The full path to the INI file\r\n    :param section_name: Name of the section which has settings.\r\n                         This is passed as name to get_appsettings\r\n    \"\"\"\r\n    settings = get_appsettings(inifile, name=section_name)\r\n    gc_keys = settings.global_conf.keys()\r\n    skeys = settings.keys()\r\n    # Pyramid>=1.9 uses new plaster which mysteriously does not merge\r\n    # global config into settings dict\r\n    if not set(gc_keys).issubset(set(skeys)):\r\n        settings.update(settings.global_conf)\r\n    return settings\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/9", "repository_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy", "labels_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/9/labels{/name}", "comments_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/9/comments", "events_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/9/events", "html_url": "https://github.com/Pylons/plaster_pastedeploy/issues/9", "id": 241805054, "node_id": "MDU6SXNzdWUyNDE4MDUwNTQ=", "number": 9, "title": "Must escape environment variables containing % and other special INI characters", "user": {"login": "mmerickel", "id": 487237, "node_id": "MDQ6VXNlcjQ4NzIzNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/487237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mmerickel", "html_url": "https://github.com/mmerickel", "followers_url": "https://api.github.com/users/mmerickel/followers", "following_url": "https://api.github.com/users/mmerickel/following{/other_user}", "gists_url": "https://api.github.com/users/mmerickel/gists{/gist_id}", "starred_url": "https://api.github.com/users/mmerickel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mmerickel/subscriptions", "organizations_url": "https://api.github.com/users/mmerickel/orgs", "repos_url": "https://api.github.com/users/mmerickel/repos", "events_url": "https://api.github.com/users/mmerickel/events{/privacy}", "received_events_url": "https://api.github.com/users/mmerickel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386725199, "node_id": "MDU6TGFiZWwzODY3MjUxOTk=", "url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2017-07-10T18:32:37Z", "updated_at": "2018-03-29T17:04:48Z", "closed_at": "2018-03-29T17:04:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/5", "repository_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy", "labels_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/5/comments", "events_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/5/events", "html_url": "https://github.com/Pylons/plaster_pastedeploy/issues/5", "id": 239951194, "node_id": "MDU6SXNzdWUyMzk5NTExOTQ=", "number": 5, "title": "Conflict with configparser", "user": {"login": "kapacuk", "id": 5092427, "node_id": "MDQ6VXNlcjUwOTI0Mjc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5092427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kapacuk", "html_url": "https://github.com/kapacuk", "followers_url": "https://api.github.com/users/kapacuk/followers", "following_url": "https://api.github.com/users/kapacuk/following{/other_user}", "gists_url": "https://api.github.com/users/kapacuk/gists{/gist_id}", "starred_url": "https://api.github.com/users/kapacuk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kapacuk/subscriptions", "organizations_url": "https://api.github.com/users/kapacuk/orgs", "repos_url": "https://api.github.com/users/kapacuk/repos", "events_url": "https://api.github.com/users/kapacuk/events{/privacy}", "received_events_url": "https://api.github.com/users/kapacuk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-07-01T14:05:07Z", "updated_at": "2017-07-01T15:42:41Z", "closed_at": "2017-07-01T15:42:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Under python 2.7, plaster_pastedeploy fails to parse the config file if the configparser package in installed. Steps to reproduce:\r\n\r\n1. pip install pyramid==1.9 cookiecutter==1.5.1\r\n2. cookiecutter gh:Pylons/pyramid-cookiecutter-starter --checkout 1.9-branch\r\n3. pip install configparser==3.5.0\r\n4. pserve development.ini\r\n\r\nThe error message:\r\n\r\nTraceback (most recent call last):\r\n  File \"../virt/bin/pserve\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/home/dima/repos/Test/virt/local/lib/python2.7/site-packages/pyramid/scripts/pserve.py\", line 32, in main\r\n    return command.run()\r\n  File \"/home/dima/repos/Test/virt/local/lib/python2.7/site-packages/pyramid/scripts/pserve.py\", line 170, in run\r\n    self.pserve_file_config(loader, global_conf=config_vars)\r\n  File \"/home/dima/repos/Test/virt/local/lib/python2.7/site-packages/pyramid/scripts/pserve.py\", line 133, in pserve_file_config\r\n    settings = loader.get_settings('pserve', global_conf)\r\n  File \"/home/dima/repos/Test/virt/local/lib/python2.7/site-packages/plaster_pastedeploy/__init__.py\", line 72, in get_settings\r\n    return OrderedDict(parser.items(section))\r\n  File \"/usr/lib/python2.7/ConfigParser.py\", line 642, in items\r\n    raise NoSectionError(section)\r\nConfigParser.NoSectionError: No section: 'pserve'\r\n\r\nThe same scenario works fine with python 3.5.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/3", "repository_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy", "labels_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/3/labels{/name}", "comments_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/3/comments", "events_url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/issues/3/events", "html_url": "https://github.com/Pylons/plaster_pastedeploy/issues/3", "id": 230441519, "node_id": "MDU6SXNzdWUyMzA0NDE1MTk=", "number": 3, "title": "Add environment variables to the defaults.", "user": {"login": "mmerickel", "id": 487237, "node_id": "MDQ6VXNlcjQ4NzIzNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/487237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mmerickel", "html_url": "https://github.com/mmerickel", "followers_url": "https://api.github.com/users/mmerickel/followers", "following_url": "https://api.github.com/users/mmerickel/following{/other_user}", "gists_url": "https://api.github.com/users/mmerickel/gists{/gist_id}", "starred_url": "https://api.github.com/users/mmerickel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mmerickel/subscriptions", "organizations_url": "https://api.github.com/users/mmerickel/orgs", "repos_url": "https://api.github.com/users/mmerickel/repos", "events_url": "https://api.github.com/users/mmerickel/events{/privacy}", "received_events_url": "https://api.github.com/users/mmerickel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386725201, "node_id": "MDU6TGFiZWwzODY3MjUyMDE=", "url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 386725202, "node_id": "MDU6TGFiZWwzODY3MjUyMDI=", "url": "https://api.github.com/repos/Pylons/plaster_pastedeploy/labels/help%20wanted", "name": "help wanted", "color": "128A0C", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-22T15:55:43Z", "updated_at": "2017-07-10T05:01:38Z", "closed_at": "2017-07-10T05:01:38Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "After evaluating a few options I think the safest option is to prefix every environment var with `ENV_` and inject it as variables into the INI file.\r\n\r\n```ini\r\n[app:main]\r\nsqlalchemy.url = %(ENV_DATABASE_URL)s\r\n```\r\n\r\nThis interpolation syntax does not support defaults or anything but that is okay for now.", "performed_via_github_app": null, "score": 1.0}]}