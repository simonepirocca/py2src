{"total_count": 138, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/celery/billiard/issues/316", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/316/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/316/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/316/events", "html_url": "https://github.com/celery/billiard/issues/316", "id": 644491074, "node_id": "MDU6SXNzdWU2NDQ0OTEwNzQ=", "number": 316, "title": "Pool callback raised exception: TypeError(\"from_db_value() missing 1 required positional argument: 'context'\",)", "user": {"login": "sbasu1303", "id": 25760809, "node_id": "MDQ6VXNlcjI1NzYwODA5", "avatar_url": "https://avatars0.githubusercontent.com/u/25760809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sbasu1303", "html_url": "https://github.com/sbasu1303", "followers_url": "https://api.github.com/users/sbasu1303/followers", "following_url": "https://api.github.com/users/sbasu1303/following{/other_user}", "gists_url": "https://api.github.com/users/sbasu1303/gists{/gist_id}", "starred_url": "https://api.github.com/users/sbasu1303/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sbasu1303/subscriptions", "organizations_url": "https://api.github.com/users/sbasu1303/orgs", "repos_url": "https://api.github.com/users/sbasu1303/repos", "events_url": "https://api.github.com/users/sbasu1303/events{/privacy}", "received_events_url": "https://api.github.com/users/sbasu1303/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-06-24T10:08:25Z", "updated_at": "2020-06-25T01:53:41Z", "closed_at": "2020-06-25T01:53:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am getting the below error, any help appreciated.\r\nPool callback raised exception: TypeError(\"from_db_value() missing 1 required positional argument: 'context'\",)\r\nHowever my tasks are running, still why the error should come, please help me to correct my project configs.\r\n\r\ncelery.py:\r\n=============\r\n~~~~~~~~~~~\r\n`from __future__ import absolute_import\r\nimport os\r\nfrom celery import Celery\r\nfrom django.conf import settings\r\n\r\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'mydemoproj.settings')\r\n\r\napp = Celery('mydemoproj')\r\napp.config_from_object('django.conf:settings')\r\napp.autodiscover_tasks(lambda: settings.INSTALLED_APPS)\r\napp.conf.update({\r\n    'task_routes': ('mydemoproj.celery.TaskRouter',),\r\n\r\n})\r\n\r\n@app.task(bind=True)\r\ndef debug_task(self):\r\n    print('Request: {0!r}'.format(self.request))\r\n\r\nclass TaskRouter:\r\n    def route_for_task(self, task, *args, **kwargs):\r\n        if ':' not in task:\r\n            return {'queue': 'default'}\r\n\r\n        namespace, _ = task.split(':')\r\n        return {'queue': namespace}`\r\n~~~~~~~~~~~\r\nsettings.py\r\n===========\r\n~~~~~~~~~~~\r\n`djcelery.setup_loader()\r\nBROKER_URL = REDIS_HOST\r\nCELERY_ACCEPT_CONTENT = ['application/json', 'pickle']\r\nCELERY_TASK_SERIALIZER = 'json'\r\nCELERY_RESULT_SERIALIZER = 'json'\r\nCELERY_RESULT_BACKEND = 'djcelery.backends.database:DatabaseBackend'\r\nCELERY_TRACK_STARTED = True\r\nCELERY_SEND_EVENTS = True\r\nCELERYD_PREFETCH_MULTIPLIER = 1\r\nCELERY_ACKS_LATE = True\r\nCELERY_CONCURRENCY = 8\r\nCELERY_DEFAULT_QUEUE = 'default'\r\nCELERY_QUEUES = (\r\n\tQueue('default', Exchange('default'), routing_key='default'),\r\n    Queue('long_tasks', Exchange('long_tasks'), routing_key='long_tasks'),\r\n    Queue('quick_tasks', Exchange('quick_tasks'), routing_key='quick_tasks'),\r\n    Queue('maintenance', Exchange('maintenance'), routing_key='maintenance'),\r\n)\r\nCELERY_IGNORE_RESULT = False\r\nCELERYD_TASK_SOFT_TIME_LIMIT = 60*60`\r\n~~~~~~~~~~~\r\n\r\nWhen the error is occurring?\r\n-If I and scheduling async task from a periodic task.\r\n\r\nmyTask.py\r\n~~~~~~~~~~~~\r\n`\r\nfrom celery.task import periodic_task\r\nfrom celery.task import task\r\nfrom celery.schedules import crontab\r\n...\r\n...\r\n@periodic_task(run_every=crontab(hour='*', minute='00'), name='long_tasks:hourlyTask')\r\ndef the_hourly_periodic_task():\r\nbatch = 0\r\n    for item in getItems():\r\n        td = datetime.utcnow() + timedelta(minutes=batch*20)\r\n        sTask = run_enrich.si(item)\r\n        task = sTask.apply_async(eta=td, queue='long_tasks', routing_key='long_tasks')\r\n        batch += 1\r\n\r\n@task()\r\ndef run_enrich(item):\r\n    do_enrich(item)\r\n`\r\n~~~~~~~~~~~~~~~\r\n\r\nPython - 3.8.3 and 3.6.9(occurring for both)\r\nDjango==3.0.2\r\ncelery==4.4.5\r\ndjango-celery==3.3.1\r\ndjango-celery-beat==2.0.0\r\nkombu==4.6.10\r\nbilliard==3.6.3.0\r\n\r\nError: \r\n`[2020-06-24 09:44:08,589: ERROR/MainProcess] Pool callback raised exception: TypeError(\"from_db_value() missing 1 required positional argument: 'context'\",)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/billiard/pool.py\", line 1796, in safe_apply_callback\r\n    fun(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/celery/worker/request.py\", line 528, in on_failure\r\n    store_result=self.store_errors,\r\n  File \"/usr/local/lib/python3.6/dist-packages/celery/backends/base.py\", line 169, in mark_as_failure\r\n    traceback=traceback, request=request)\r\n  File \"/usr/local/lib/python3.6/dist-packages/celery/backends/base.py\", line 443, in store_result\r\n    request=request, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/djcelery/backends/database.py\", line 33, in _store_result\r\n    traceback=traceback, children=self.current_task_children(request),\r\n  File \"/usr/local/lib/python3.6/dist-packages/djcelery/managers.py\", line 47, in _inner\r\n    return fun(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/djcelery/managers.py\", line 189, in store_result\r\n    'meta': {'children': children}})\r\n  File \"/usr/local/lib/python3.6/dist-packages/djcelery/managers.py\", line 92, in update_or_create\r\n    return get_queryset(self).update_or_create(**kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/djcelery/managers.py\", line 75, in update_or_create\r\n    obj, created = self.get_or_create(**kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/django/db/models/query.py\", line 559, in get_or_create\r\n    return self.get(**kwargs), False\r\n  File \"/usr/local/lib/python3.6/dist-packages/django/db/models/query.py\", line 411, in get\r\n    num = len(clone)\r\n  File \"/usr/local/lib/python3.6/dist-packages/django/db/models/query.py\", line 258, in __len__\r\n    self._fetch_all()\r\n  File \"/usr/local/lib/python3.6/dist-packages/django/db/models/query.py\", line 1261, in _fetch_all\r\n    self._result_cache = list(self._iterable_class(self))\r\n  File \"/usr/local/lib/python3.6/dist-packages/django/db/models/query.py\", line 74, in __iter__\r\n    for row in compiler.results_iter(results):\r\n  File \"/usr/local/lib/python3.6/dist-packages/django/db/models/sql/compiler.py\", line 1096, in apply_converters\r\n    value = converter(value, expression, connection)\r\nTypeError: from_db_value() missing 1 required positional argument: 'context'`\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/314", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/314/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/314/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/314/events", "html_url": "https://github.com/celery/billiard/issues/314", "id": 637992335, "node_id": "MDU6SXNzdWU2Mzc5OTIzMzU=", "number": 314, "title": "AttributeError: 'module' object has no attribute '__spec__' on windows", "user": {"login": "xiva-wgt", "id": 9335978, "node_id": "MDQ6VXNlcjkzMzU5Nzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/9335978?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiva-wgt", "html_url": "https://github.com/xiva-wgt", "followers_url": "https://api.github.com/users/xiva-wgt/followers", "following_url": "https://api.github.com/users/xiva-wgt/following{/other_user}", "gists_url": "https://api.github.com/users/xiva-wgt/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiva-wgt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiva-wgt/subscriptions", "organizations_url": "https://api.github.com/users/xiva-wgt/orgs", "repos_url": "https://api.github.com/users/xiva-wgt/repos", "events_url": "https://api.github.com/users/xiva-wgt/events{/privacy}", "received_events_url": "https://api.github.com/users/xiva-wgt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-12T20:39:34Z", "updated_at": "2020-06-13T20:31:38Z", "closed_at": "2020-06-13T20:31:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`'  File \"c:\\python27\\lib\\site-packages\\billiard\\spawn.py\", line 338, in _fixup_main_from_name\r\n'  File \"c:\\python27\\lib\\site-packages\\billiard\\spawn.py\", line 165, in spawn_main\r\nmodule' object has no attribute '__spec__'    module' object has no attribute '__spec__'\r\nif getattr(current_main.__spec__, \"name\", None) == mod_name:\r\n\r\nexitcode = _main(fd)\r\nAttributeError  File \"c:\\python27\\lib\\site-packages\\billiard\\spawn.py\", line 205, in _main\r\n:     'prepare(preparation_data)\r\nmodule' object has no attribute '__spec__'  File \"c:\\python27\\lib\\site-packages\\billiard\\spawn.py\", line 320, in prepare\r\n\r\n    _fixup_main_from_name(data['init_main_from_name'])\r\n  File \"c:\\python27\\lib\\site-packages\\billiard\\spawn.py\", line 338, in _fixup_main_from_name\r\n    if getattr(current_main.__spec__, \"name\", None) == mod_name:\r\nAttributeError: 'module' object has no attribute '__spec__'`\r\n\r\nat this point there is a check for a nonexistent attribute https://github.com/celery/billiard/blob/ca3220ba4596ac7bb03f64b80e91878353fc5be1/billiard/spawn.py#L264\r\n\r\nin another place there is no check and an error occurs\r\nhttps://github.com/celery/billiard/blob/ca3220ba4596ac7bb03f64b80e91878353fc5be1/billiard/spawn.py#L338", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/306", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/306/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/306/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/306/events", "html_url": "https://github.com/celery/billiard/issues/306", "id": 560294907, "node_id": "MDU6SXNzdWU1NjAyOTQ5MDc=", "number": 306, "title": "AttributeError when terminating Celery worker", "user": {"login": "vsemionov", "id": 1093619, "node_id": "MDQ6VXNlcjEwOTM2MTk=", "avatar_url": "https://avatars1.githubusercontent.com/u/1093619?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vsemionov", "html_url": "https://github.com/vsemionov", "followers_url": "https://api.github.com/users/vsemionov/followers", "following_url": "https://api.github.com/users/vsemionov/following{/other_user}", "gists_url": "https://api.github.com/users/vsemionov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vsemionov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vsemionov/subscriptions", "organizations_url": "https://api.github.com/users/vsemionov/orgs", "repos_url": "https://api.github.com/users/vsemionov/repos", "events_url": "https://api.github.com/users/vsemionov/events{/privacy}", "received_events_url": "https://api.github.com/users/vsemionov/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-02-05T10:59:18Z", "updated_at": "2020-02-24T15:04:14Z", "closed_at": "2020-02-10T19:06:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "After upgrading from version `3.6.1.0` to `3.6.2.0`, the following log event started appearing when terminating the Celery worker:\r\n```\r\n[2020-02-05 10:52:45,723: WARNING/MainProcess] AttributeError: 'NoneType' object has no attribute 'close'\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/302", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/302/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/302/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/302/events", "html_url": "https://github.com/celery/billiard/issues/302", "id": 556798191, "node_id": "MDU6SXNzdWU1NTY3OTgxOTE=", "number": 302, "title": "WorkerLostError: (Worker exited prematurely: signal 9 (SIGKILL))", "user": {"login": "FirojNeosoft", "id": 32124431, "node_id": "MDQ6VXNlcjMyMTI0NDMx", "avatar_url": "https://avatars2.githubusercontent.com/u/32124431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FirojNeosoft", "html_url": "https://github.com/FirojNeosoft", "followers_url": "https://api.github.com/users/FirojNeosoft/followers", "following_url": "https://api.github.com/users/FirojNeosoft/following{/other_user}", "gists_url": "https://api.github.com/users/FirojNeosoft/gists{/gist_id}", "starred_url": "https://api.github.com/users/FirojNeosoft/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FirojNeosoft/subscriptions", "organizations_url": "https://api.github.com/users/FirojNeosoft/orgs", "repos_url": "https://api.github.com/users/FirojNeosoft/repos", "events_url": "https://api.github.com/users/FirojNeosoft/events{/privacy}", "received_events_url": "https://api.github.com/users/FirojNeosoft/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-29T11:21:49Z", "updated_at": "2020-01-31T05:06:41Z", "closed_at": "2020-01-31T05:06:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nI got below error while running long task.\r\nTask handler raised error: WorkerLostError('Worker exited prematurely: signal 9 (SIGKILL).')\r\n\r\nI used below tools-\r\ncelery==4.3.0, amqp==2.5.0, RabbitMQ 3.3.5, AWS EC2 instance as server\r\n\r\nI ran 2 long tasks. I got same error for both tasks. \r\nThen, I converted server type medium to large for EC2 instance, and I got success for one of the 2 tasks. But still one task is not successful due to workerLostError.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/297", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/297/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/297/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/297/events", "html_url": "https://github.com/celery/billiard/issues/297", "id": 546719485, "node_id": "MDU6SXNzdWU1NDY3MTk0ODU=", "number": 297, "title": "Support pytest 5", "user": {"login": "mrunge", "id": 763086, "node_id": "MDQ6VXNlcjc2MzA4Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/763086?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrunge", "html_url": "https://github.com/mrunge", "followers_url": "https://api.github.com/users/mrunge/followers", "following_url": "https://api.github.com/users/mrunge/following{/other_user}", "gists_url": "https://api.github.com/users/mrunge/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrunge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrunge/subscriptions", "organizations_url": "https://api.github.com/users/mrunge/orgs", "repos_url": "https://api.github.com/users/mrunge/repos", "events_url": "https://api.github.com/users/mrunge/events{/privacy}", "received_events_url": "https://api.github.com/users/mrunge/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-08T08:42:24Z", "updated_at": "2020-01-10T06:28:58Z", "closed_at": "2020-01-10T06:28:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nat least Fedora is moving to pytest 5, billiard requires pytest < 5. \r\n\r\nhttps://lists.fedoraproject.org/archives/list/devel@lists.fedoraproject.org/thread/ZK25O6CXGKPT7IFAE3SX3WSZCK4KBO7S/#ZK25O6CXGKPT7IFAE3SX3WSZCK4KBO7S\r\n\r\nIt'd be great if pytest 5 could be supported in billiard.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/295", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/295/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/295/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/295/events", "html_url": "https://github.com/celery/billiard/issues/295", "id": 533222251, "node_id": "MDU6SXNzdWU1MzMyMjIyNTE=", "number": 295, "title": "Remove limitation of pytest version", "user": {"login": "crazyscientist", "id": 1128117, "node_id": "MDQ6VXNlcjExMjgxMTc=", "avatar_url": "https://avatars3.githubusercontent.com/u/1128117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crazyscientist", "html_url": "https://github.com/crazyscientist", "followers_url": "https://api.github.com/users/crazyscientist/followers", "following_url": "https://api.github.com/users/crazyscientist/following{/other_user}", "gists_url": "https://api.github.com/users/crazyscientist/gists{/gist_id}", "starred_url": "https://api.github.com/users/crazyscientist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crazyscientist/subscriptions", "organizations_url": "https://api.github.com/users/crazyscientist/orgs", "repos_url": "https://api.github.com/users/crazyscientist/repos", "events_url": "https://api.github.com/users/crazyscientist/events{/privacy}", "received_events_url": "https://api.github.com/users/crazyscientist/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-05T09:19:54Z", "updated_at": "2019-12-05T09:33:57Z", "closed_at": "2019-12-05T09:33:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi there,\r\n\r\nwhile messing around with the RPM package for openSUSE, I noticed that the testsuite is running quite well with pytest 5.2.4\r\n\r\nMaybe you would care to lift the limitation to pytest versions prior to 5?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/284", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/284/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/284/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/284/events", "html_url": "https://github.com/celery/billiard/issues/284", "id": 479369329, "node_id": "MDU6SXNzdWU0NzkzNjkzMjk=", "number": 284, "title": "New release", "user": {"login": "Jamim", "id": 5607572, "node_id": "MDQ6VXNlcjU2MDc1NzI=", "avatar_url": "https://avatars0.githubusercontent.com/u/5607572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jamim", "html_url": "https://github.com/Jamim", "followers_url": "https://api.github.com/users/Jamim/followers", "following_url": "https://api.github.com/users/Jamim/following{/other_user}", "gists_url": "https://api.github.com/users/Jamim/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jamim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jamim/subscriptions", "organizations_url": "https://api.github.com/users/Jamim/orgs", "repos_url": "https://api.github.com/users/Jamim/repos", "events_url": "https://api.github.com/users/Jamim/events{/privacy}", "received_events_url": "https://api.github.com/users/Jamim/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "auvipy", "id": 6212603, "node_id": "MDQ6VXNlcjYyMTI2MDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/6212603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/auvipy", "html_url": "https://github.com/auvipy", "followers_url": "https://api.github.com/users/auvipy/followers", "following_url": "https://api.github.com/users/auvipy/following{/other_user}", "gists_url": "https://api.github.com/users/auvipy/gists{/gist_id}", "starred_url": "https://api.github.com/users/auvipy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/auvipy/subscriptions", "organizations_url": "https://api.github.com/users/auvipy/orgs", "repos_url": "https://api.github.com/users/auvipy/repos", "events_url": "https://api.github.com/users/auvipy/events{/privacy}", "received_events_url": "https://api.github.com/users/auvipy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "auvipy", "id": 6212603, "node_id": "MDQ6VXNlcjYyMTI2MDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/6212603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/auvipy", "html_url": "https://github.com/auvipy", "followers_url": "https://api.github.com/users/auvipy/followers", "following_url": "https://api.github.com/users/auvipy/following{/other_user}", "gists_url": "https://api.github.com/users/auvipy/gists{/gist_id}", "starred_url": "https://api.github.com/users/auvipy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/auvipy/subscriptions", "organizations_url": "https://api.github.com/users/auvipy/orgs", "repos_url": "https://api.github.com/users/auvipy/repos", "events_url": "https://api.github.com/users/auvipy/events{/privacy}", "received_events_url": "https://api.github.com/users/auvipy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-11T13:18:36Z", "updated_at": "2019-08-19T10:57:30Z", "closed_at": "2019-08-19T10:57:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello @thedrow and @auvipy,\r\n\r\nCan you please issue a new version that will contain #283 fix?\r\nI need it in order to fix [CI for Celery](https://ci.appveyor.com/project/ask/celery).\r\n\r\nThank you!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/278", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/278/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/278/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/278/events", "html_url": "https://github.com/celery/billiard/issues/278", "id": 435515830, "node_id": "MDU6SXNzdWU0MzU1MTU4MzA=", "number": 278, "title": "Race-condition in billiard.pool leads to WorkerLostError: Worker exited prematurely: exitcode 155", "user": {"login": "srafehi", "id": 9069240, "node_id": "MDQ6VXNlcjkwNjkyNDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/9069240?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srafehi", "html_url": "https://github.com/srafehi", "followers_url": "https://api.github.com/users/srafehi/followers", "following_url": "https://api.github.com/users/srafehi/following{/other_user}", "gists_url": "https://api.github.com/users/srafehi/gists{/gist_id}", "starred_url": "https://api.github.com/users/srafehi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srafehi/subscriptions", "organizations_url": "https://api.github.com/users/srafehi/orgs", "repos_url": "https://api.github.com/users/srafehi/repos", "events_url": "https://api.github.com/users/srafehi/events{/privacy}", "received_events_url": "https://api.github.com/users/srafehi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-04-21T14:37:28Z", "updated_at": "2019-06-07T10:14:59Z", "closed_at": "2019-06-07T10:14:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Problem\r\n\r\nWhen using `worker_max_tasks_per_child` in Celery, a race-condition across multiple classes in billiard.pool can lead to a false `WorkerLostError` exception being raised and a successfully processed job being incorrectly marked as unsuccessful.\r\n\r\nThis occurs when the result of the final job of a recycled worker has been put onto the out queue, but that result has not been consumed by the `ResultHandler` prior to the worker being cleaned up by `Pool._join_exited_workers`. Sequence of events:\r\n\r\n1. `Worker.workloop`: The result for job X is calculated and put onto self.outq ([code](https://github.com/celery/billiard/blob/265f119ec8b2944e36e3b0810578b5d615e6f987/billiard/pool.py#L362))\r\n2. `Worker.workloop`: The worker returns `EX_RECYCLE` since it's reached the maximum amount of tasks it should process ([code](https://github.com/celery/billiard/blob/265f119ec8b2944e36e3b0810578b5d615e6f987/billiard/pool.py#L385)). It's exit code is now 155.\r\n3. `Pool._join_exited_workers`: The worker is removed because it has an exit code but it's incorrectly marked as exiting prematurely because the result for job X has not been processed by `ResultHandler`. The calculated result for job X is lost since job X is marked as unsuccessful ([code](https://github.com/celery/billiard/blob/265f119ec8b2944e36e3b0810578b5d615e6f987/billiard/pool.py#L1229)).\r\n\r\nNote that this race-condition could also happen in the case when a worker is recycled due to `max_memory_per_child` or a worker exits with `EX_OK`. This error exists in the master branch of Celery/Billiard.\r\n\r\n### Solution\r\nWe should only return from `Worker.workloop` if we can guarantee that `ResultHandler` has consumed all our results. This can be achieved by checking to see if the calls to `on_ready` (per worker) match the amount of `READY` messages sent by `Worker.workloop`.\r\n\r\n### Potentially related issues\r\n\r\n#273 \r\ncelery/celery#3085", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/268", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/268/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/268/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/268/events", "html_url": "https://github.com/celery/billiard/issues/268", "id": 397047911, "node_id": "MDU6SXNzdWUzOTcwNDc5MTE=", "number": 268, "title": "Add link to documentation", "user": {"login": "faheel", "id": 11466676, "node_id": "MDQ6VXNlcjExNDY2Njc2", "avatar_url": "https://avatars2.githubusercontent.com/u/11466676?v=4", "gravatar_id": "", "url": "https://api.github.com/users/faheel", "html_url": "https://github.com/faheel", "followers_url": "https://api.github.com/users/faheel/followers", "following_url": "https://api.github.com/users/faheel/following{/other_user}", "gists_url": "https://api.github.com/users/faheel/gists{/gist_id}", "starred_url": "https://api.github.com/users/faheel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/faheel/subscriptions", "organizations_url": "https://api.github.com/users/faheel/orgs", "repos_url": "https://api.github.com/users/faheel/repos", "events_url": "https://api.github.com/users/faheel/events{/privacy}", "received_events_url": "https://api.github.com/users/faheel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-01-08T19:17:08Z", "updated_at": "2019-06-24T04:52:38Z", "closed_at": "2019-06-24T04:52:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "It would be really helpful if the link to the documentation (https://billiard.readthedocs.io) is added to the repo as its website and/or is mentioned in the README (either as a badge or under a section titled `Documentation`).\r\n\r\nI couldn't find it anywhere and had to search for `celery billiard documentation` on Google to find it as the 7th result :sweat_smile: ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/261", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/261/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/261/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/261/events", "html_url": "https://github.com/celery/billiard/issues/261", "id": 392866405, "node_id": "MDU6SXNzdWUzOTI4NjY0MDU=", "number": 261, "title": "In the billiard==3.5.0.5 version, the celery worker process is closed! TypeError: can't pickle thread.lock objects", "user": {"login": "yoncan", "id": 5858356, "node_id": "MDQ6VXNlcjU4NTgzNTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5858356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yoncan", "html_url": "https://github.com/yoncan", "followers_url": "https://api.github.com/users/yoncan/followers", "following_url": "https://api.github.com/users/yoncan/following{/other_user}", "gists_url": "https://api.github.com/users/yoncan/gists{/gist_id}", "starred_url": "https://api.github.com/users/yoncan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yoncan/subscriptions", "organizations_url": "https://api.github.com/users/yoncan/orgs", "repos_url": "https://api.github.com/users/yoncan/repos", "events_url": "https://api.github.com/users/yoncan/events{/privacy}", "received_events_url": "https://api.github.com/users/yoncan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-12-20T03:01:31Z", "updated_at": "2018-12-20T14:17:52Z", "closed_at": "2018-12-20T14:17:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "When the project is in use, in the celery task, the subscription signal `worker_shutting_down` is processed before the worker is closed, and an additional task `s_worker_shutting_down` is added to process the task that the current worker has not completed.\r\n\r\n`s_worker_shutting_down` inside only made a connection redis to write a piece of data!\r\n\r\n\r\n```\r\n@signals.worker_shutdown.connect\r\ndef s_worker_shutdown(*args, **kwargs):\r\n    \"\"\"\r\n    :param args:\r\n    :param kwargs:\r\n    :return:\r\n    \"\"\"\r\n    log.warn('worker_shutdown')\r\n\r\n\r\n@signals.worker_shutting_down.connect\r\ndef s_worker_shutting_down(*args, **kwargs):\r\n    \"\"\"\r\n    :param args:\r\n    :param kwargs:\r\n    :return:\r\n    \"\"\"\r\n    log.warn(u'[cd-worker] Receiving signal [worker_shutting_down]'\r\n             u'**** Will actively close all unconfirmed tasks')\r\n    redis.set('__celery_worker_shutdown', 1)\r\n    time.sleep(3)\r\n```\r\n\r\nThen in the process of closing the worker's log below, as long as there are unfinished tasks, the following exception will occur:\r\n\r\n\r\n```\r\n[2018-12-20 10:38:11,344: DEBUG/MainProcess] | Worker: Closing Hub...\r\n[2018-12-20 10:38:11,345: DEBUG/MainProcess] | Worker: Closing Pool...\r\n[2018-12-20 10:38:11,345: DEBUG/MainProcess] | Worker: Closing Consumer...\r\n[2018-12-20 10:38:11,346: DEBUG/MainProcess] | Worker: Stopping Consumer...\r\n[2018-12-20 10:38:11,346: DEBUG/MainProcess] | Consumer: Closing Connection...\r\n[2018-12-20 10:38:11,346: DEBUG/MainProcess] | Consumer: Closing Events...\r\n[2018-12-20 10:38:11,347: DEBUG/MainProcess] | Consumer: Closing Heart...\r\n[2018-12-20 10:38:11,347: DEBUG/MainProcess] | Consumer: Closing Mingle...\r\n[2018-12-20 10:38:11,347: DEBUG/MainProcess] | Consumer: Closing Tasks...\r\n[2018-12-20 10:38:11,348: DEBUG/MainProcess] | Consumer: Closing Control...\r\n[2018-12-20 10:38:11,348: DEBUG/MainProcess] | Consumer: Closing Gossip...\r\n[2018-12-20 10:38:11,348: DEBUG/MainProcess] | Consumer: Closing event loop...\r\n[2018-12-20 10:38:11,349: DEBUG/MainProcess] | Consumer: Stopping event loop...\r\n[2018-12-20 10:38:11,349: DEBUG/MainProcess] | Consumer: Stopping Gossip...\r\n[2018-12-20 10:38:11,352: DEBUG/MainProcess] | Consumer: Stopping Control...\r\n[2018-12-20 10:38:11,354: DEBUG/MainProcess] | Consumer: Stopping Tasks...\r\n[2018-12-20 10:38:11,355: DEBUG/MainProcess] Canceling task consumer...\r\n[2018-12-20 10:38:11,355: DEBUG/MainProcess] | Consumer: Stopping Mingle...\r\n[2018-12-20 10:38:11,355: DEBUG/MainProcess] | Consumer: Stopping Heart...\r\n[2018-12-20 10:38:11,357: DEBUG/MainProcess] | Consumer: Stopping Events...\r\n[2018-12-20 10:38:11,357: DEBUG/MainProcess] | Consumer: Stopping Connection...\r\n[2018-12-20 10:38:11,358: DEBUG/MainProcess] | Worker: Stopping Pool...\r\n\r\n> [2018-12-20 10:38:11,359: WARNING/MainProcess] self.cache: {0: <%s: 0 ack:True ready:False>}\r\n> [2018-12-20 10:38:11,359: WARNING/MainProcess] key==0, val==<%s: 0 ack:True ready:False> , type== <class 'billiard.pool.ApplyResult'>\r\n\r\n[2018-12-20 10:38:11,363: ERROR/MainProcess] Error on stopping Pool: TypeError(\"can't pickle thread.lock objects\",)\r\nTraceback (most recent call last):\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/celery/bootsteps.py\", line 151, in send_all\r\n    fun(parent, *args)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/celery/bootsteps.py\", line 373, in stop\r\n    return self.obj.stop()\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/celery/concurrency/base.py\", line 122, in stop\r\n    self.on_stop()\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/celery/concurrency/prefork.py\", line 140, in on_stop\r\n    self._pool.join()\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/billiard/pool.py\", line 1584, in join\r\n    stop_if_not_current(self._result_handler)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/billiard/pool.py\", line 146, in stop_if_not_current\r\n    thread.stop(timeout)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/billiard/pool.py\", line 503, in stop\r\n    self.on_stop_not_started()\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/celery/concurrency/asynpool.py\", line 332, in on_stop_not_started\r\n    check_timeouts()\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/billiard/pool.py\", line 750, in handle_event\r\n    next(self._it)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/site-packages/billiard/pool.py\", line 703, in handle_timeouts\r\n    cache = copy.deepcopy(self.cache)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 257, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 190, in deepcopy\r\n    y = _reconstruct(x, rv, 1, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 334, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 257, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 264, in _deepcopy_method\r\n    return type(x)(x.im_func, deepcopy(x.im_self, memo), x.im_class)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 190, in deepcopy\r\n    y = _reconstruct(x, rv, 1, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 334, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 237, in _deepcopy_tuple\r\n    y.append(deepcopy(a, memo))\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 257, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 190, in deepcopy\r\n    y = _reconstruct(x, rv, 1, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 334, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 237, in _deepcopy_tuple\r\n    y.append(deepcopy(a, memo))\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 257, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 190, in deepcopy\r\n    y = _reconstruct(x, rv, 1, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 334, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 257, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 190, in deepcopy\r\n    y = _reconstruct(x, rv, 1, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 334, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 163, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 257, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/opt/edsp-assistant/python/lib/python2.7/copy.py\", line 182, in deepcopy\r\n    rv = reductor(2)\r\nTypeError: can't pickle thread.lock objects\r\n[2018-12-20 10:38:11,367: DEBUG/MainProcess] | Worker: Stopping Hub...\r\n[2018-12-20 10:38:11,368: DEBUG/MainProcess] | Consumer: Shutdown Gossip...\r\n[2018-12-20 10:38:11,368: DEBUG/MainProcess] | Consumer: Shutdown Control...\r\n[2018-12-20 10:38:11,369: DEBUG/MainProcess] | Consumer: Shutdown Tasks...\r\n[2018-12-20 10:38:11,369: DEBUG/MainProcess] Canceling task consumer...\r\n[2018-12-20 10:38:11,369: DEBUG/MainProcess] Closing consumer channel...\r\n[2018-12-20 10:38:11,370: DEBUG/MainProcess] | Consumer: Shutdown Heart...\r\n[2018-12-20 10:38:11,370: DEBUG/MainProcess] | Consumer: Shutdown Events...\r\n[2018-12-20 10:38:11,371: DEBUG/MainProcess] | Consumer: Shutdown Connection...\r\n--------------------------------------------------------------------------------\r\nWARNING in tasks [/data/cd/edsp_cd/tasks/tasks.py:83]:\r\nworker_shutdown\r\n--------------------------------------------------------------------------------\r\n[2018-12-20 10:38:11,373: DEBUG/MainProcess] removing tasks from inqueue until task handler finished\r\n```\r\n\r\n\r\nThe problem arises because:\r\n\r\nIn the 3.5.0.4 version of billiard, `copy.deepcopy` is not used to copy the self.cache object.\r\n```\r\n# billiard/pool.py\r\n     .....\r\n\r\n 696     def handle_timeouts(self):\r\n 697         cache = self.cache         <<<<<<<<<<< here\r\n 698         t_hard, t_soft = self.t_hard, self.t_soft\r\n 699         dirty = set()\r\n 700         on_soft_timeout = self.on_soft_timeout\r\n 701         on_hard_timeout = self.on_hard_timeout\r\n ```\r\n \r\n \r\nHowever, in billiard==`3.5.0.5`, `copy.deepcopy` is used, resulting in an error.\r\n```\r\n 696     def handle_timeouts(self):\r\n 697         cache = copy.deepcopy(self.cache)    <<<<<<<<<<< here\r\n 698         t_hard, t_soft = self.t_hard, self.t_soft\r\n 699         dirty = set()\r\n 700         on_soft_timeout = self.on_soft_timeout\r\n 701         on_hard_timeout = self.on_hard_timeout\r\n 702 \r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/260", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/260/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/260/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/260/events", "html_url": "https://github.com/celery/billiard/issues/260", "id": 387945084, "node_id": "MDU6SXNzdWUzODc5NDUwODQ=", "number": 260, "title": "fix for #249 introduces a crash in warm shutdown", "user": {"login": "daleevans", "id": 4944007, "node_id": "MDQ6VXNlcjQ5NDQwMDc=", "avatar_url": "https://avatars1.githubusercontent.com/u/4944007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daleevans", "html_url": "https://github.com/daleevans", "followers_url": "https://api.github.com/users/daleevans/followers", "following_url": "https://api.github.com/users/daleevans/following{/other_user}", "gists_url": "https://api.github.com/users/daleevans/gists{/gist_id}", "starred_url": "https://api.github.com/users/daleevans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daleevans/subscriptions", "organizations_url": "https://api.github.com/users/daleevans/orgs", "repos_url": "https://api.github.com/users/daleevans/repos", "events_url": "https://api.github.com/users/daleevans/events{/privacy}", "received_events_url": "https://api.github.com/users/daleevans/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2018-12-05T21:04:42Z", "updated_at": "2019-03-31T14:08:19Z", "closed_at": "2019-02-06T19:03:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "commit 309f9663663c6dad6d40bf017514695a7c154fd appears to have introduced an issue when doing warm restarts.  Now when I send a SIGTERM, I get a crash at line 697 of billiard/pool.py which kills all the workers, including those with jobs in progress.  Rolling back to 3.5.0.4 resolves this for me.\r\n\r\n```\r\nworker: Warm shutdown (MainProcess)\r\n[2018-12-05 12:23:44,846: ERROR/MainProcess] Error on stopping Pool: TypeError(\"can't pickle _thread.lock objects\",)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/worker/worker.py\", line 205, in start\r\n    self.blueprint.start(self)\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/bootsteps.py\", line 119, in start\r\n    step.start(parent)\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/bootsteps.py\", line 369, in start\r\n    return self.obj.start()\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/worker/consumer/consumer.py\", line 317, in start\r\n    blueprint.start(self)\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/bootsteps.py\", line 119, in start\r\n    step.start(parent)\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/worker/consumer/consumer.py\", line 593, in start\r\n    c.loop(*c.loop_args())\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/worker/loops.py\", line 91, in asynloop\r\n    next(loop)\r\n  File \"/usr/local/lib/python3.6/site-packages/kombu/asynchronous/hub.py\", line 298, in create_loop\r\n    events = poll(poll_timeout)\r\n  File \"/usr/local/lib/python3.6/site-packages/kombu/utils/eventio.py\", line 84, in poll\r\n    return self._epoll.poll(timeout if timeout is not None else -1)\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/apps/worker.py\", line 284, in _handle_request\r\n    raise exc(exitcode)\r\ncelery.exceptions.WorkerShutdown: 0\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/bootsteps.py\", line 151, in send_all\r\n    fun(parent, *args)\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/bootsteps.py\", line 373, in stop\r\n    return self.obj.stop()\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/concurrency/base.py\", line 122, in stop\r\n    self.on_stop()\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/concurrency/prefork.py\", line 140, in on_stop\r\n    self._pool.join()\r\n  File \"/usr/local/lib/python3.6/site-packages/billiard/pool.py\", line 1578, in join\r\n    stop_if_not_current(self._result_handler)\r\n  File \"/usr/local/lib/python3.6/site-packages/billiard/pool.py\", line 143, in stop_if_not_current\r\n    thread.stop(timeout)\r\n  File \"/usr/local/lib/python3.6/site-packages/billiard/pool.py\", line 500, in stop\r\n    self.on_stop_not_started()\r\n  File \"/usr/local/lib/python3.6/site-packages/celery/concurrency/asynpool.py\", line 332, in on_stop_not_started\r\n    check_timeouts()\r\n  File \"/usr/local/lib/python3.6/site-packages/billiard/pool.py\", line 744, in handle_event\r\n    next(self._it)\r\n  File \"/usr/local/lib/python3.6/site-packages/billiard/pool.py\", line 697, in handle_timeouts\r\n    cache = copy.deepcopy(self.cache)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 240, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 280, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 240, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 280, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 240, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 180, in deepcopy\r\n    y = _reconstruct(x, memo, *rv)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 280, in _reconstruct\r\n    state = deepcopy(state, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 150, in deepcopy\r\n    y = copier(x, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 240, in _deepcopy_dict\r\n    y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n  File \"/usr/local/lib/python3.6/copy.py\", line 169, in deepcopy\r\n    rv = reductor(4)\r\nTypeError: can't pickle _thread.lock objects\r\n\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/255", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/255/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/255/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/255/events", "html_url": "https://github.com/celery/billiard/issues/255", "id": 369129345, "node_id": "MDU6SXNzdWUzNjkxMjkzNDU=", "number": 255, "title": "max_memory_per_child reached log is ERROR level, should be INFO", "user": {"login": "yuvalbar", "id": 7135887, "node_id": "MDQ6VXNlcjcxMzU4ODc=", "avatar_url": "https://avatars1.githubusercontent.com/u/7135887?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuvalbar", "html_url": "https://github.com/yuvalbar", "followers_url": "https://api.github.com/users/yuvalbar/followers", "following_url": "https://api.github.com/users/yuvalbar/following{/other_user}", "gists_url": "https://api.github.com/users/yuvalbar/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuvalbar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuvalbar/subscriptions", "organizations_url": "https://api.github.com/users/yuvalbar/orgs", "repos_url": "https://api.github.com/users/yuvalbar/repos", "events_url": "https://api.github.com/users/yuvalbar/events{/privacy}", "received_events_url": "https://api.github.com/users/yuvalbar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-10-11T13:46:32Z", "updated_at": "2019-06-30T18:19:02Z", "closed_at": "2019-06-30T18:18:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "When Celery recycles a Celery worker, it emits this log: \r\n\r\n```\r\n\u200bERROR/ForkPoolWorker-587] child process exiting after exceeding memory limit (421812KiB / 300000KiB)\r\n```\r\n\r\nIt happens in `pool.py:379`:\r\n``` Python\r\n                    if used_kb > 0 and used_kb > max_memory_per_child:\r\n                        error(MAXMEM_USED_FMT.format(\r\n                            used_kb, max_memory_per_child))\r\n```\r\n\r\nThis is not actually an error, but an expected situation where I want to recycle workers as there is no other way to reduce their memory footprint. It should probably be lowered to INFO - I'm willing to open a PR if that's acceptable. Plz let me know - Thanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/250", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/250/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/250/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/250/events", "html_url": "https://github.com/celery/billiard/issues/250", "id": 350934944, "node_id": "MDU6SXNzdWUzNTA5MzQ5NDQ=", "number": 250, "title": "max_memory_per_child doesn't work on Windows (with a fix)", "user": {"login": "genben", "id": 3104779, "node_id": "MDQ6VXNlcjMxMDQ3Nzk=", "avatar_url": "https://avatars1.githubusercontent.com/u/3104779?v=4", "gravatar_id": "", "url": "https://api.github.com/users/genben", "html_url": "https://github.com/genben", "followers_url": "https://api.github.com/users/genben/followers", "following_url": "https://api.github.com/users/genben/following{/other_user}", "gists_url": "https://api.github.com/users/genben/gists{/gist_id}", "starred_url": "https://api.github.com/users/genben/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/genben/subscriptions", "organizations_url": "https://api.github.com/users/genben/orgs", "repos_url": "https://api.github.com/users/genben/repos", "events_url": "https://api.github.com/users/genben/events{/privacy}", "received_events_url": "https://api.github.com/users/genben/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-08-15T19:27:51Z", "updated_at": "2020-06-14T21:53:21Z", "closed_at": "2020-06-14T21:53:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Parameter `max_memory_per_child` is not passed to `Worker.__reduce__` method:\r\n\r\nhttps://github.com/celery/billiard/blob/471d38e72df9cf380be90f89d0dde2735073b851/billiard/pool.py#L267-L272\r\n\r\nAs a result, on Windows, where forking is made via multi-processing, a child process doesn't receive such parameter. So, an automatic restart of a worker after reaching a memory limit doesn't happen.\r\n\r\nTo fix this issue, the method `Worker.__reduce__()` should be modified to:\r\n\r\n```\r\n    def __reduce__(self):\r\n        return self.__class__, (\r\n            self.inq, self.outq, self.synq, self.initializer,\r\n            self.initargs, self.maxtasks, self._shutdown, self.on_exit,\r\n            self.sigprotection, self.wrap_exception, self.max_memory_per_child\r\n        )\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/248", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/248/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/248/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/248/events", "html_url": "https://github.com/celery/billiard/issues/248", "id": 347833778, "node_id": "MDU6SXNzdWUzNDc4MzM3Nzg=", "number": 248, "title": "Thread 'TimeoutHandler' crashes sometimes", "user": {"login": "adamdelman", "id": 3784930, "node_id": "MDQ6VXNlcjM3ODQ5MzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/3784930?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamdelman", "html_url": "https://github.com/adamdelman", "followers_url": "https://api.github.com/users/adamdelman/followers", "following_url": "https://api.github.com/users/adamdelman/following{/other_user}", "gists_url": "https://api.github.com/users/adamdelman/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamdelman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamdelman/subscriptions", "organizations_url": "https://api.github.com/users/adamdelman/orgs", "repos_url": "https://api.github.com/users/adamdelman/repos", "events_url": "https://api.github.com/users/adamdelman/events{/privacy}", "received_events_url": "https://api.github.com/users/adamdelman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-06T08:50:30Z", "updated_at": "2018-09-12T06:42:27Z", "closed_at": "2018-09-12T06:42:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When timeouts are enabled, the following exception occurs sporadically:\r\n\r\nThread 'TimeoutHandler' crashed: RuntimeError('dictionary changed size during iteration',)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/billiard/pool.py\", line 478, in run\r\n    return self.body()\r\n  File \"/usr/local/lib/python3.6/site-packages/billiard/pool.py\", line 734, in body\r\n    for _ in self.handle_timeouts():\r\n  File \"/usr/local/lib/python3.6/site-packages/billiard/pool.py\", line 716, in handle_timeouts\r\n    for i, job in list(cache.items()):\r\nRuntimeError: dictionary changed size during iteration\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/246", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/246/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/246/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/246/events", "html_url": "https://github.com/celery/billiard/issues/246", "id": 332811128, "node_id": "MDU6SXNzdWUzMzI4MTExMjg=", "number": 246, "title": "Could not connect, 0 attempts left", "user": {"login": "davidmir", "id": 4657051, "node_id": "MDQ6VXNlcjQ2NTcwNTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/4657051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmir", "html_url": "https://github.com/davidmir", "followers_url": "https://api.github.com/users/davidmir/followers", "following_url": "https://api.github.com/users/davidmir/following{/other_user}", "gists_url": "https://api.github.com/users/davidmir/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmir/subscriptions", "organizations_url": "https://api.github.com/users/davidmir/orgs", "repos_url": "https://api.github.com/users/davidmir/repos", "events_url": "https://api.github.com/users/davidmir/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmir/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-06-15T15:05:30Z", "updated_at": "2018-06-18T10:11:46Z", "closed_at": "2018-06-18T10:11:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI am periodically seeing the following errors in the logs:\r\n\r\n`[2018-06-15 15:01:32,363: ERROR/ForkPoolWorker-5] Connection to 10.0.0.6:5672 failed: timeout\r\n[2018-06-15 15:01:32,363: WARNING/ForkPoolWorker-5] Could not connect, 0 attempts left`\r\n\r\nI'm using celery 4.1.0 with RabbitMQ connection (amqp=2.2.2).\r\nWhat happens to the celery process in these situations (is it killed and the task is lost, or is it able to recover)? What could be causing this situation?\r\n\r\nThanks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/241", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/241/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/241/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/241/events", "html_url": "https://github.com/celery/billiard/issues/241", "id": 301675587, "node_id": "MDU6SXNzdWUzMDE2NzU1ODc=", "number": 241, "title": "Do`t work spawn start method ", "user": {"login": "tonal", "id": 316216, "node_id": "MDQ6VXNlcjMxNjIxNg==", "avatar_url": "https://avatars0.githubusercontent.com/u/316216?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tonal", "html_url": "https://github.com/tonal", "followers_url": "https://api.github.com/users/tonal/followers", "following_url": "https://api.github.com/users/tonal/following{/other_user}", "gists_url": "https://api.github.com/users/tonal/gists{/gist_id}", "starred_url": "https://api.github.com/users/tonal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tonal/subscriptions", "organizations_url": "https://api.github.com/users/tonal/orgs", "repos_url": "https://api.github.com/users/tonal/repos", "events_url": "https://api.github.com/users/tonal/events{/privacy}", "received_events_url": "https://api.github.com/users/tonal/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-03-02T07:21:57Z", "updated_at": "2018-06-05T08:48:36Z", "closed_at": "2018-06-05T08:48:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Python 3.6.4\r\nbilliard.VERSION = (3, 5, 0, 3)\r\nfile billiard_spawn.py\r\n```python\r\nfrom billiard import get_context\r\n\r\ndef main():\r\n\r\n  ctx = get_context('spawn')\r\n  p = ctx.Process(target=task_from_process, args=('opa',))\r\n  p.start()\r\n  p.join()\r\n  return p.exitcode\r\n\r\ndef task_from_process(name:str):\r\n  print('proc:', name)\r\n\r\nif __name__ == '__main__':\r\n  main()\r\n```\r\nconsole output:\r\n```\r\n$ python billiard_spawn.py \r\nTraceback (most recent call last):\r\n  File \"billiard_spawn.py\", line 16, in <module>\r\n    main()\r\n  File \"billiard_spawn.py\", line 8, in main\r\n    p.start()\r\n  File \"/home/pyenv/versions/remains/lib/python3.6/site-packages/billiard/process.py\", line 124, in start\r\n    self._popen = self._Popen(self)\r\n  File \"/home/pyenv/versions/remains/lib/python3.6/site-packages/billiard/context.py\", line 341, in _Popen\r\n    return Popen(process_obj)\r\n  File \"/home/pyenv/versions/remains/lib/python3.6/site-packages/billiard/popen_spawn_posix.py\", line 39, in __init__\r\n    super(Popen, self).__init__(process_obj)\r\n  File \"/home/pyenv/versions/remains/lib/python3.6/site-packages/billiard/popen_fork.py\", line 24, in __init__\r\n    self._launch(process_obj)\r\n  File \"/home/pyenv/versions/remains/lib/python3.6/site-packages/billiard/popen_spawn_posix.py\", line 49, in _launch\r\n    tracker_fd = semaphore_tracker.getfd()\r\n  File \"/home/pyenv/versions/remains/lib/python3.6/site-packages/billiard/semaphore_tracker.py\", line 38, in getfd\r\n    self.ensure_running()\r\n  File \"/home/pyenv/versions/remains/lib/python3.6/site-packages/billiard/semaphore_tracker.py\", line 62, in ensure_running\r\n    spawnv_passfds(exe, args, fds_to_pass)\r\n  File \"/home/pyenv/versions/remains/lib/python3.6/site-packages/billiard/compat.py\", line 226, in spawnv_passfds\r\n    False, False, None)\r\nTypeError: fork_exec() argument 4 must be tuple, not list\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/239", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/239/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/239/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/239/events", "html_url": "https://github.com/celery/billiard/issues/239", "id": 296675709, "node_id": "MDU6SXNzdWUyOTY2NzU3MDk=", "number": 239, "title": "Billiard support for Windows on python2.7", "user": {"login": "linar-jether", "id": 11908736, "node_id": "MDQ6VXNlcjExOTA4NzM2", "avatar_url": "https://avatars0.githubusercontent.com/u/11908736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/linar-jether", "html_url": "https://github.com/linar-jether", "followers_url": "https://api.github.com/users/linar-jether/followers", "following_url": "https://api.github.com/users/linar-jether/following{/other_user}", "gists_url": "https://api.github.com/users/linar-jether/gists{/gist_id}", "starred_url": "https://api.github.com/users/linar-jether/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/linar-jether/subscriptions", "organizations_url": "https://api.github.com/users/linar-jether/orgs", "repos_url": "https://api.github.com/users/linar-jether/repos", "events_url": "https://api.github.com/users/linar-jether/events{/privacy}", "received_events_url": "https://api.github.com/users/linar-jether/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-02-13T09:56:24Z", "updated_at": "2020-05-15T19:32:44Z", "closed_at": "2019-08-11T06:26:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "What is the current status? is windows support completely dropped after version 3.5?\r\n\r\nCurrently when trying to create a Pool object the following error is raised (https://github.com/celery/billiard/issues/198): \r\nin `popen_spawn_win32.py:64`\r\n```python\r\nTypeError: argument 1 must be an integer, not _subprocess_handle\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/237", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/237/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/237/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/237/events", "html_url": "https://github.com/celery/billiard/issues/237", "id": 268679426, "node_id": "MDU6SXNzdWUyNjg2Nzk0MjY=", "number": 237, "title": "Internal error: AssertionError() assert self._parent is current_process()", "user": {"login": "buckensl", "id": 7717213, "node_id": "MDQ6VXNlcjc3MTcyMTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/7717213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/buckensl", "html_url": "https://github.com/buckensl", "followers_url": "https://api.github.com/users/buckensl/followers", "following_url": "https://api.github.com/users/buckensl/following{/other_user}", "gists_url": "https://api.github.com/users/buckensl/gists{/gist_id}", "starred_url": "https://api.github.com/users/buckensl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/buckensl/subscriptions", "organizations_url": "https://api.github.com/users/buckensl/orgs", "repos_url": "https://api.github.com/users/buckensl/repos", "events_url": "https://api.github.com/users/buckensl/events{/privacy}", "received_events_url": "https://api.github.com/users/buckensl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-10-26T08:58:41Z", "updated_at": "2018-01-13T14:09:21Z", "closed_at": "2018-01-11T16:20:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "We are using \r\nbilliard==3.3.0.20\r\ncelery==3.1.18\r\n\r\n\r\n```\r\n2017-03-26 00:36:09.476 +0000 CRITICAL [__init__._process_task] Internal error: AssertionError()\r\nTraceback (most recent call last):\r\n  File \"venv/lib/python2.7/site-packages/celery/worker/__init__.py\", line 227, in _process_task\r\n    req.execute_using_pool(self.pool)\r\n  File \"venv/lib/python2.7/site-packages/celery/worker/job.py\", line 263, in execute_using_pool\r\n    correlation_id=uuid,\r\n  File \"venv/lib/python2.7/site-packages/celery/concurrency/base.py\", line 156, in apply_async\r\n    **options)\r\n  File \"venv/lib/python2.7/site-packages/billiard/pool.py\", line 1431, in apply_async\r\n    self._start_timeout_handler()\r\n  File \"venv/lib/python2.7/site-packages/billiard/pool.py\", line 1288, in _start_timeout_handler\r\n    self._timeout_handler.start()\r\n  File \"venv/lib/python2.7/site-packages/billiard/pool.py\", line 487, in start\r\n    super(PoolThread, self).start(*args, **kwargs)\r\n  File \"venv/lib/python2.7/site-packages/billiard/dummy/__init__.py\", line 69, in start\r\n    assert self._parent is current_process()\r\nAssertionError\r\nTraceback (most recent call last):\r\n  File \"venv/lib/python2.7/site-packages/celery/worker/__init__.py\", line 227, in _process_task\r\n    req.execute_using_pool(self.pool)\r\n  File \"venv/lib/python2.7/site-packages/celery/worker/job.py\", line 263, in execute_using_pool\r\n    correlation_id=uuid,\r\n  File \"venv/lib/python2.7/site-packages/celery/concurrency/base.py\", line 156, in apply_async\r\n    **options)\r\n  File \"venv/lib/python2.7/site-packages/billiard/pool.py\", line 1431, in apply_async\r\n    self._start_timeout_handler()\r\n  File \"venv/lib/python2.7/site-packages/billiard/pool.py\", line 1288, in _start_timeout_handler\r\n    self._timeout_handler.start()\r\n  File \"venv/lib/python2.7/site-packages/billiard/pool.py\", line 487, in start\r\n    super(PoolThread, self).start(*args, **kwargs)\r\n  File \"venv/lib/python2.7/site-packages/billiard/dummy/__init__.py\", line 69, in start\r\n    assert self._parent is current_process()\r\nAssertionError\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/233", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/233/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/233/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/233/events", "html_url": "https://github.com/celery/billiard/issues/233", "id": 244945789, "node_id": "MDU6SXNzdWUyNDQ5NDU3ODk=", "number": 233, "title": "Queue put-get delay of many seconds?", "user": {"login": "mike-lawrence", "id": 150781, "node_id": "MDQ6VXNlcjE1MDc4MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/150781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mike-lawrence", "html_url": "https://github.com/mike-lawrence", "followers_url": "https://api.github.com/users/mike-lawrence/followers", "following_url": "https://api.github.com/users/mike-lawrence/following{/other_user}", "gists_url": "https://api.github.com/users/mike-lawrence/gists{/gist_id}", "starred_url": "https://api.github.com/users/mike-lawrence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mike-lawrence/subscriptions", "organizations_url": "https://api.github.com/users/mike-lawrence/orgs", "repos_url": "https://api.github.com/users/mike-lawrence/repos", "events_url": "https://api.github.com/users/mike-lawrence/events{/privacy}", "received_events_url": "https://api.github.com/users/mike-lawrence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-07-24T00:02:37Z", "updated_at": "2017-07-26T13:55:03Z", "closed_at": "2017-07-26T13:55:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using billiard to run two processes (a & b) in parallel with a pair of Queue()s to communicate between them (a->b and b->a) and despite using a loop in each process that should be checking the queues every few milliseconds, I'm experiencing a delay of up to many seconds between one process putting a message in a queue and the other process receiving it. Frustratingly, it seems to be variable as to when these delays manifest, with delays of only 10-100ms otherwise. Any suggestions for troubleshooting something like this?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/229", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/229/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/229/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/229/events", "html_url": "https://github.com/celery/billiard/issues/229", "id": 239110877, "node_id": "MDU6SXNzdWUyMzkxMTA4Nzc=", "number": 229, "title": "multiple billiard.Value instances sharing the same state", "user": {"login": "Birne94", "id": 617722, "node_id": "MDQ6VXNlcjYxNzcyMg==", "avatar_url": "https://avatars3.githubusercontent.com/u/617722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Birne94", "html_url": "https://github.com/Birne94", "followers_url": "https://api.github.com/users/Birne94/followers", "following_url": "https://api.github.com/users/Birne94/following{/other_user}", "gists_url": "https://api.github.com/users/Birne94/gists{/gist_id}", "starred_url": "https://api.github.com/users/Birne94/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Birne94/subscriptions", "organizations_url": "https://api.github.com/users/Birne94/orgs", "repos_url": "https://api.github.com/users/Birne94/repos", "events_url": "https://api.github.com/users/Birne94/events{/privacy}", "received_events_url": "https://api.github.com/users/Birne94/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-06-28T09:51:33Z", "updated_at": "2017-07-17T13:35:56Z", "closed_at": "2017-07-17T13:35:56Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Problem description**\r\n\r\nWhen using multiple instances of `billiard.Value` and changing one variable's value, the other one is changed as well. In the example below when I update the variable `value`, `done` is set to the same value as well. When replacing `billiard` with `multiprocessing` the example works as expected.\r\n\r\n**Example**\r\n\r\nSee [below](#issuecomment-311695221) for an easier example.\r\n\r\n```python\r\nimport ctypes\r\nimport time\r\nfrom billiard import Pool, Value\r\n\r\n\r\ndef foo():\r\n    for i in range(10):\r\n        value.value = i\r\n        time.sleep(1)\r\n\r\n    done.value = True\r\n\r\n\r\ndef bar():\r\n    while True:\r\n        print(value.value, '\\t', done.value)\r\n        time.sleep(0.5)\r\n\r\n\r\nif __name__ == '__main__':\r\n    value = Value(ctypes.c_int, 0)\r\n    done = Value(ctypes.c_bool, False)\r\n\r\n    with Pool() as pool:\r\n        pool.apply_async(bar)\r\n        pool.apply(foo)\r\n```\r\n\r\n**Expected output**\r\n\r\n```\r\n0 \t False\r\n0 \t False\r\n1 \t False\r\n1 \t False\r\n1 \t False\r\n2 \t False\r\n3 \t False\r\n3 \t False\r\n4 \t False\r\n4 \t False\r\n5 \t False\r\n5 \t False\r\n6 \t False\r\n6 \t False\r\n7 \t False\r\n7 \t False\r\n8 \t False\r\n8 \t False\r\n9 \t False\r\n9 \t False\r\n9 \t True\r\n```\r\n\r\n**Actual output**\r\n\r\n```\r\n0 \t False\r\n0 \t False\r\n1 \t True\r\n1 \t True\r\n2 \t True\r\n2 \t True\r\n3 \t True\r\n3 \t True\r\n4 \t True\r\n4 \t True\r\n5 \t True\r\n5 \t True\r\n6 \t True\r\n6 \t True\r\n7 \t True\r\n7 \t True\r\n8 \t True\r\n8 \t True\r\n9 \t True\r\n9 \t True\r\n```\r\n\r\n**Versions**\r\n\r\n```shell\r\n % pip freeze | grep billiard  \r\nbilliard==3.5.0.2\r\n % python --version          \r\nPython 3.6.0\r\n % uname -a\r\nDarwin HOST 16.4.0 Darwin Kernel Version 16.4.0: Thu Dec 22 22:53:21 PST 2016; root:xnu-3789.41.3~3/RELEASE_X86_64 x86_64\r\n % sw_vers -productVersion \r\n10.12.3\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/228", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/228/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/228/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/228/events", "html_url": "https://github.com/celery/billiard/issues/228", "id": 238678996, "node_id": "MDU6SXNzdWUyMzg2Nzg5OTY=", "number": 228, "title": "worker unable to determine memory usage", "user": {"login": "listingmirror", "id": 19509188, "node_id": "MDQ6VXNlcjE5NTA5MTg4", "avatar_url": "https://avatars1.githubusercontent.com/u/19509188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/listingmirror", "html_url": "https://github.com/listingmirror", "followers_url": "https://api.github.com/users/listingmirror/followers", "following_url": "https://api.github.com/users/listingmirror/following{/other_user}", "gists_url": "https://api.github.com/users/listingmirror/gists{/gist_id}", "starred_url": "https://api.github.com/users/listingmirror/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/listingmirror/subscriptions", "organizations_url": "https://api.github.com/users/listingmirror/orgs", "repos_url": "https://api.github.com/users/listingmirror/repos", "events_url": "https://api.github.com/users/listingmirror/events{/privacy}", "received_events_url": "https://api.github.com/users/listingmirror/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-06-26T21:45:43Z", "updated_at": "2019-02-01T23:48:53Z", "closed_at": "2018-01-21T15:05:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "Python 3.6.1\r\nBilliard 3.5.0.2\r\n\r\nIn docker on an image based on 3.6-alpine\r\n\r\n> 2017-06-26T21:43:35.854019324Z [2017-06-26 21:43:35,853: ERROR/PoolWorker-7] worker unable to determine worker memory usage\r\n\r\nAny ideas why I am hitting this?\r\n https://github.com/celery/billiard/blob/bfe2dc6387853595ef8877809c1404fe4959519d/billiard/pool.py#L377\r\n\r\nEdit - Investigated on the alpine docker image directly.\r\n\r\nI can run both `compat.mem_rss() `and `getrusage(RUSAGE_SELF).ru_maxrss` without a problem. So very weird that they work directly in docker on the same image I run, but not when actually running via celery..\r\n\r\n```\r\n>>> getrusage(RUSAGE_SELF).ru_maxrss\r\n64520\r\n\r\n```\r\n\r\nEdit 2:\r\n\r\nI even added the following line to a celery task\r\n\r\n`logger.info('Memory: %s', mem_rss())`\r\n\r\nAnd it works. So clearly mem_rss() is good.. so how the heck do I get this error then,...", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/226", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/226/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/226/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/226/events", "html_url": "https://github.com/celery/billiard/issues/226", "id": 234505833, "node_id": "MDU6SXNzdWUyMzQ1MDU4MzM=", "number": 226, "title": "Pool crashes under Windows", "user": {"login": "SPKorhonen", "id": 25795905, "node_id": "MDQ6VXNlcjI1Nzk1OTA1", "avatar_url": "https://avatars0.githubusercontent.com/u/25795905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SPKorhonen", "html_url": "https://github.com/SPKorhonen", "followers_url": "https://api.github.com/users/SPKorhonen/followers", "following_url": "https://api.github.com/users/SPKorhonen/following{/other_user}", "gists_url": "https://api.github.com/users/SPKorhonen/gists{/gist_id}", "starred_url": "https://api.github.com/users/SPKorhonen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SPKorhonen/subscriptions", "organizations_url": "https://api.github.com/users/SPKorhonen/orgs", "repos_url": "https://api.github.com/users/SPKorhonen/repos", "events_url": "https://api.github.com/users/SPKorhonen/events{/privacy}", "received_events_url": "https://api.github.com/users/SPKorhonen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-06-08T12:09:19Z", "updated_at": "2017-07-17T08:11:20Z", "closed_at": "2017-07-17T08:11:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When creating Pool under Windows AttributeError is raised. This prevents the usage of billiard and by extension Celery 4.0 under Windows. For further discussion see https://github.com/celery/celery/issues/3821 For a fix see #225\r\n\r\nFor minimal example, please see below:\r\n\r\nimport billiard\r\np=billiard.Pool()\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"C:\\Program Files\\Python36\\lib\\site-packages\\billiard\\context.py\", line 165, in Pool\r\n    context=self.get_context())\r\n  File \"C:\\Program Files\\Python36\\lib\\site-packages\\billiard\\pool.py\", line 1008, in __init__\r\n    self._create_worker_process(i)\r\n  File \"C:\\Program Files\\Python36\\lib\\site-packages\\billiard\\pool.py\", line 1117, in _create_worker_process\r\n    w.start()\r\n  File \"C:\\Program Files\\Python36\\lib\\site-packages\\billiard\\process.py\", line 122, in start\r\n    self._popen = self._Popen(self)\r\n  File \"C:\\Program Files\\Python36\\lib\\site-packages\\billiard\\context.py\", line 383, in _Popen\r\n    return Popen(process_obj)\r\n  File \"C:\\Program Files\\Python36\\lib\\site-packages\\billiard\\popen_spawn_win32.py\", line 79, in __init__\r\n    reduction.dump(process_obj, to_child)\r\n  File \"C:\\Program Files\\Python36\\lib\\site-packages\\billiard\\reduction.py\", line 99, in dump\r\n    ForkingPickler(file, protocol).dump(obj)\r\nAttributeError: Can't pickle local object 'Pool.__init__.<locals>.Process'\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/222", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/222/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/222/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/222/events", "html_url": "https://github.com/celery/billiard/issues/222", "id": 222706476, "node_id": "MDU6SXNzdWUyMjI3MDY0NzY=", "number": 222, "title": "Please release for compatibility with 2.7", "user": {"login": "23doors", "id": 1051101, "node_id": "MDQ6VXNlcjEwNTExMDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1051101?v=4", "gravatar_id": "", "url": "https://api.github.com/users/23doors", "html_url": "https://github.com/23doors", "followers_url": "https://api.github.com/users/23doors/followers", "following_url": "https://api.github.com/users/23doors/following{/other_user}", "gists_url": "https://api.github.com/users/23doors/gists{/gist_id}", "starred_url": "https://api.github.com/users/23doors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/23doors/subscriptions", "organizations_url": "https://api.github.com/users/23doors/orgs", "repos_url": "https://api.github.com/users/23doors/repos", "events_url": "https://api.github.com/users/23doors/events{/privacy}", "received_events_url": "https://api.github.com/users/23doors/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-04-19T11:28:51Z", "updated_at": "2017-07-17T12:48:43Z", "closed_at": "2017-07-17T12:48:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "Encountered compatibility issues with 2.7 and found that they were already fixed in: https://github.com/celery/billiard/pull/202 and https://github.com/celery/billiard/commit/d0be0308a9dfd17c28277bb582edcf009ecd3153\r\n\r\nPlease make a new release to include these as right now 2.7 compatibility is kind of broken in 4.x celery.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/220", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/220/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/220/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/220/events", "html_url": "https://github.com/celery/billiard/issues/220", "id": 222350214, "node_id": "MDU6SXNzdWUyMjIzNTAyMTQ=", "number": 220, "title": "Indentation error in master", "user": {"login": "BeOleg", "id": 3058791, "node_id": "MDQ6VXNlcjMwNTg3OTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/3058791?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BeOleg", "html_url": "https://github.com/BeOleg", "followers_url": "https://api.github.com/users/BeOleg/followers", "following_url": "https://api.github.com/users/BeOleg/following{/other_user}", "gists_url": "https://api.github.com/users/BeOleg/gists{/gist_id}", "starred_url": "https://api.github.com/users/BeOleg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BeOleg/subscriptions", "organizations_url": "https://api.github.com/users/BeOleg/orgs", "repos_url": "https://api.github.com/users/BeOleg/repos", "events_url": "https://api.github.com/users/BeOleg/events{/privacy}", "received_events_url": "https://api.github.com/users/BeOleg/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-04-18T09:11:33Z", "updated_at": "2017-04-18T10:16:08Z", "closed_at": "2017-04-18T10:16:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://github.com/celery/billiard/commit/a0bdb57b9b5d78411bdb0a18486f5e8d2fa33a33#commitcomment-21796160\r\n\r\nThis broke our production", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/214", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/214/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/214/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/214/events", "html_url": "https://github.com/celery/billiard/issues/214", "id": 204058205, "node_id": "MDU6SXNzdWUyMDQwNTgyMDU=", "number": 214, "title": "v3.5.0.x does no longer work with Celery 3.x", "user": {"login": "saily", "id": 506283, "node_id": "MDQ6VXNlcjUwNjI4Mw==", "avatar_url": "https://avatars0.githubusercontent.com/u/506283?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saily", "html_url": "https://github.com/saily", "followers_url": "https://api.github.com/users/saily/followers", "following_url": "https://api.github.com/users/saily/following{/other_user}", "gists_url": "https://api.github.com/users/saily/gists{/gist_id}", "starred_url": "https://api.github.com/users/saily/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saily/subscriptions", "organizations_url": "https://api.github.com/users/saily/orgs", "repos_url": "https://api.github.com/users/saily/repos", "events_url": "https://api.github.com/users/saily/events{/privacy}", "received_events_url": "https://api.github.com/users/saily/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-30T16:26:18Z", "updated_at": "2018-01-11T17:26:50Z", "closed_at": "2018-01-11T17:26:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is not documented in Changelog. Please add this as a comment.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/212", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/212/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/212/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/212/events", "html_url": "https://github.com/celery/billiard/issues/212", "id": 202857010, "node_id": "MDU6SXNzdWUyMDI4NTcwMTA=", "number": 212, "title": "Logging may not be properly initialized in pool.py", "user": {"login": "pelme", "id": 20529, "node_id": "MDQ6VXNlcjIwNTI5", "avatar_url": "https://avatars1.githubusercontent.com/u/20529?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pelme", "html_url": "https://github.com/pelme", "followers_url": "https://api.github.com/users/pelme/followers", "following_url": "https://api.github.com/users/pelme/following{/other_user}", "gists_url": "https://api.github.com/users/pelme/gists{/gist_id}", "starred_url": "https://api.github.com/users/pelme/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pelme/subscriptions", "organizations_url": "https://api.github.com/users/pelme/orgs", "repos_url": "https://api.github.com/users/pelme/repos", "events_url": "https://api.github.com/users/pelme/events{/privacy}", "received_events_url": "https://api.github.com/users/pelme/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-01-24T15:49:50Z", "updated_at": "2017-04-16T17:54:39Z", "closed_at": "2017-04-16T17:54:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Currently, it just uses `util._logger` directly. It should use `util.get_logger()`.\r\n\r\nI will submit a PR soon!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/203", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/203/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/203/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/203/events", "html_url": "https://github.com/celery/billiard/issues/203", "id": 191772686, "node_id": "MDU6SXNzdWUxOTE3NzI2ODY=", "number": 203, "title": "Celery incompatible with Ansible ", "user": {"login": "dvannatter", "id": 19291225, "node_id": "MDQ6VXNlcjE5MjkxMjI1", "avatar_url": "https://avatars0.githubusercontent.com/u/19291225?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvannatter", "html_url": "https://github.com/dvannatter", "followers_url": "https://api.github.com/users/dvannatter/followers", "following_url": "https://api.github.com/users/dvannatter/following{/other_user}", "gists_url": "https://api.github.com/users/dvannatter/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvannatter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvannatter/subscriptions", "organizations_url": "https://api.github.com/users/dvannatter/orgs", "repos_url": "https://api.github.com/users/dvannatter/repos", "events_url": "https://api.github.com/users/dvannatter/events{/privacy}", "received_events_url": "https://api.github.com/users/dvannatter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-11-25T22:50:38Z", "updated_at": "2017-07-17T14:30:44Z", "closed_at": "2017-07-17T14:30:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using both Billard (by Celery) and the standard process.py module (by Ansible), there are some compatibility issues because they both define _current_process, but they define it differently. In particular, the standard process.py tries to get _current_process._authkey, but this is not an attribute of the Billard version of the _current_process which stores the authkey in  _current_process._config['authkey']", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/201", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/201/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/201/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/201/events", "html_url": "https://github.com/celery/billiard/issues/201", "id": 190795262, "node_id": "MDU6SXNzdWUxOTA3OTUyNjI=", "number": 201, "title": "\"spawn\" method doesn't work on 2.7 (under Linux)", "user": {"login": "pitrou", "id": 1721820, "node_id": "MDQ6VXNlcjE3MjE4MjA=", "avatar_url": "https://avatars2.githubusercontent.com/u/1721820?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pitrou", "html_url": "https://github.com/pitrou", "followers_url": "https://api.github.com/users/pitrou/followers", "following_url": "https://api.github.com/users/pitrou/following{/other_user}", "gists_url": "https://api.github.com/users/pitrou/gists{/gist_id}", "starred_url": "https://api.github.com/users/pitrou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pitrou/subscriptions", "organizations_url": "https://api.github.com/users/pitrou/orgs", "repos_url": "https://api.github.com/users/pitrou/repos", "events_url": "https://api.github.com/users/pitrou/events{/privacy}", "received_events_url": "https://api.github.com/users/pitrou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 405299413, "node_id": "MDU6TGFiZWw0MDUyOTk0MTM=", "url": "https://api.github.com/repos/celery/billiard/labels/Issue%20Type:%20Bug", "name": "Issue Type: Bug", "color": "b60205", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2016-11-21T18:12:27Z", "updated_at": "2018-07-17T13:49:18Z", "closed_at": "2018-07-07T10:33:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following simple script:\r\n```\r\nfrom billiard import get_context\r\n\r\nctx = get_context('spawn')\r\n\r\n\r\ndef f(x):\r\n    return x*x\r\n\r\nif __name__ == '__main__':\r\n    with ctx.Pool(2) as p:\r\n        print(p.map(f, list(range(10))))\r\n```\r\n\r\nfails with:\r\n```\r\nTraceback (most recent call last):\r\n  File \"d.py\", line 11, in <module>\r\n    with ctx.Pool(2) as p:\r\n  File \"/home/antoine/billiard/billiard/context.py\", line 165, in Pool\r\n    context=self.get_context())\r\n  File \"/home/antoine/billiard/billiard/pool.py\", line 1008, in __init__\r\n    self._create_worker_process(i)\r\n  File \"/home/antoine/billiard/billiard/pool.py\", line 1117, in _create_worker_process\r\n    w.start()\r\n  File \"/home/antoine/billiard/billiard/process.py\", line 122, in start\r\n    self._popen = self._Popen(self)\r\n  File \"/home/antoine/billiard/billiard/context.py\", line 341, in _Popen\r\n    return Popen(process_obj)\r\n  File \"/home/antoine/billiard/billiard/popen_spawn_posix.py\", line 39, in __init__\r\n    super(Popen, self).__init__(process_obj)\r\n  File \"/home/antoine/billiard/billiard/popen_fork.py\", line 24, in __init__\r\n    self._launch(process_obj)\r\n  File \"/home/antoine/billiard/billiard/popen_spawn_posix.py\", line 56, in _launch\r\n    reduction.dump(process_obj, fp)\r\n  File \"/home/antoine/billiard/billiard/reduction.py\", line 99, in dump\r\n    ForkingPickler(file, protocol).dump(obj)\r\n  File \"/home/antoine/miniconda3/envs/dask27/lib/python2.7/pickle.py\", line 224, in dump\r\n    self.save(obj)\r\n  File \"/home/antoine/miniconda3/envs/dask27/lib/python2.7/pickle.py\", line 331, in save\r\n    self.save_reduce(obj=obj, *rv)\r\n  File \"/home/antoine/miniconda3/envs/dask27/lib/python2.7/pickle.py\", line 401, in save_reduce\r\n    save(args)\r\n  File \"/home/antoine/miniconda3/envs/dask27/lib/python2.7/pickle.py\", line 286, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/home/antoine/miniconda3/envs/dask27/lib/python2.7/pickle.py\", line 568, in save_tuple\r\n    save(element)\r\n  File \"/home/antoine/miniconda3/envs/dask27/lib/python2.7/pickle.py\", line 286, in save\r\n    f(self, obj) # Call unbound method with explicit self\r\n  File \"/home/antoine/miniconda3/envs/dask27/lib/python2.7/pickle.py\", line 754, in save_global\r\n    (obj, module, name))\r\npickle.PicklingError: Can't pickle <class 'billiard.pool.Process'>: it's not found as billiard.pool.Process\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/199", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/199/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/199/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/199/events", "html_url": "https://github.com/celery/billiard/issues/199", "id": 190770912, "node_id": "MDU6SXNzdWUxOTA3NzA5MTI=", "number": 199, "title": "Missing tag v3.5.0.2", "user": {"login": "jakirkham", "id": 3019665, "node_id": "MDQ6VXNlcjMwMTk2NjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakirkham", "html_url": "https://github.com/jakirkham", "followers_url": "https://api.github.com/users/jakirkham/followers", "following_url": "https://api.github.com/users/jakirkham/following{/other_user}", "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions", "organizations_url": "https://api.github.com/users/jakirkham/orgs", "repos_url": "https://api.github.com/users/jakirkham/repos", "events_url": "https://api.github.com/users/jakirkham/events{/privacy}", "received_events_url": "https://api.github.com/users/jakirkham/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 405298774, "node_id": "MDU6TGFiZWw0MDUyOTg3NzQ=", "url": "https://api.github.com/repos/celery/billiard/labels/Category:%20Packaging%20and%20Release%20Management", "name": "Category: Packaging and Release Management", "color": "1d76db", "default": false, "description": null}, {"id": 405298825, "node_id": "MDU6TGFiZWw0MDUyOTg4MjU=", "url": "https://api.github.com/repos/celery/billiard/labels/Component:%20Pool", "name": "Component: Pool", "color": "d93f0b", "default": false, "description": null}, {"id": 405299413, "node_id": "MDU6TGFiZWw0MDUyOTk0MTM=", "url": "https://api.github.com/repos/celery/billiard/labels/Issue%20Type:%20Bug", "name": "Issue Type: Bug", "color": "b60205", "default": false, "description": null}, {"id": 405300136, "node_id": "MDU6TGFiZWw0MDUzMDAxMzY=", "url": "https://api.github.com/repos/celery/billiard/labels/Priority:%20Normal", "name": "Priority: Normal", "color": "c2e0c6", "default": false, "description": null}, {"id": 405300481, "node_id": "MDU6TGFiZWw0MDUzMDA0ODE=", "url": "https://api.github.com/repos/celery/billiard/labels/Severity:%20Normal", "name": "Severity: Normal", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "auvipy", "id": 6212603, "node_id": "MDQ6VXNlcjYyMTI2MDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/6212603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/auvipy", "html_url": "https://github.com/auvipy", "followers_url": "https://api.github.com/users/auvipy/followers", "following_url": "https://api.github.com/users/auvipy/following{/other_user}", "gists_url": "https://api.github.com/users/auvipy/gists{/gist_id}", "starred_url": "https://api.github.com/users/auvipy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/auvipy/subscriptions", "organizations_url": "https://api.github.com/users/auvipy/orgs", "repos_url": "https://api.github.com/users/auvipy/repos", "events_url": "https://api.github.com/users/auvipy/events{/privacy}", "received_events_url": "https://api.github.com/users/auvipy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "auvipy", "id": 6212603, "node_id": "MDQ6VXNlcjYyMTI2MDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/6212603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/auvipy", "html_url": "https://github.com/auvipy", "followers_url": "https://api.github.com/users/auvipy/followers", "following_url": "https://api.github.com/users/auvipy/following{/other_user}", "gists_url": "https://api.github.com/users/auvipy/gists{/gist_id}", "starred_url": "https://api.github.com/users/auvipy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/auvipy/subscriptions", "organizations_url": "https://api.github.com/users/auvipy/orgs", "repos_url": "https://api.github.com/users/auvipy/repos", "events_url": "https://api.github.com/users/auvipy/events{/privacy}", "received_events_url": "https://api.github.com/users/auvipy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2016-11-21T16:39:56Z", "updated_at": "2017-07-17T13:20:19Z", "closed_at": "2017-07-17T07:10:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "There doesn't seem to be a tag for `v3.5.0.2`. Could one please be added? \ud83d\ude04", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/195", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/195/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/195/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/195/events", "html_url": "https://github.com/celery/billiard/issues/195", "id": 187865867, "node_id": "MDU6SXNzdWUxODc4NjU4Njc=", "number": 195, "title": "Pypi page does not interprets reST doc properly  ", "user": {"login": "pombredanne", "id": 675997, "node_id": "MDQ6VXNlcjY3NTk5Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/675997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pombredanne", "html_url": "https://github.com/pombredanne", "followers_url": "https://api.github.com/users/pombredanne/followers", "following_url": "https://api.github.com/users/pombredanne/following{/other_user}", "gists_url": "https://api.github.com/users/pombredanne/gists{/gist_id}", "starred_url": "https://api.github.com/users/pombredanne/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pombredanne/subscriptions", "organizations_url": "https://api.github.com/users/pombredanne/orgs", "repos_url": "https://api.github.com/users/pombredanne/repos", "events_url": "https://api.github.com/users/pombredanne/events{/privacy}", "received_events_url": "https://api.github.com/users/pombredanne/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 405299470, "node_id": "MDU6TGFiZWw0MDUyOTk0NzA=", "url": "https://api.github.com/repos/celery/billiard/labels/Issue%20Type:%20Documentation", "name": "Issue Type: Documentation", "color": "c5def5", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-11-08T00:06:42Z", "updated_at": "2017-07-19T07:26:51Z", "closed_at": "2017-07-17T15:13:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "See https://pypi.python.org/pypi/billiard\r\nThis is likely something that can be fixed by verifying the README.rst + CHANGES.tst with https://pypi.python.org/pypi/restview for Pypi compatibility.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/194", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/194/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/194/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/194/events", "html_url": "https://github.com/celery/billiard/issues/194", "id": 183659811, "node_id": "MDU6SXNzdWUxODM2NTk4MTE=", "number": 194, "title": "Duplicate tags on af86fea v3.3.0.23 and v3.0.23", "user": {"login": "edmorley", "id": 501702, "node_id": "MDQ6VXNlcjUwMTcwMg==", "avatar_url": "https://avatars3.githubusercontent.com/u/501702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edmorley", "html_url": "https://github.com/edmorley", "followers_url": "https://api.github.com/users/edmorley/followers", "following_url": "https://api.github.com/users/edmorley/following{/other_user}", "gists_url": "https://api.github.com/users/edmorley/gists{/gist_id}", "starred_url": "https://api.github.com/users/edmorley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edmorley/subscriptions", "organizations_url": "https://api.github.com/users/edmorley/orgs", "repos_url": "https://api.github.com/users/edmorley/repos", "events_url": "https://api.github.com/users/edmorley/events{/privacy}", "received_events_url": "https://api.github.com/users/edmorley/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-10-18T11:27:53Z", "updated_at": "2016-11-03T21:08:16Z", "closed_at": "2016-11-03T21:08:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "That revision is tagged twice, with different versions:\nhttps://github.com/celery/billiard/releases/tag/v3.3.0.23\nhttps://github.com/celery/billiard/releases/tag/v3.0.23\n\nI'm presuming the latter is a typo?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/192", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/192/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/192/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/192/events", "html_url": "https://github.com/celery/billiard/issues/192", "id": 180237609, "node_id": "MDU6SXNzdWUxODAyMzc2MDk=", "number": 192, "title": "max_memory_per_child not portable", "user": {"login": "frankier", "id": 299380, "node_id": "MDQ6VXNlcjI5OTM4MA==", "avatar_url": "https://avatars2.githubusercontent.com/u/299380?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frankier", "html_url": "https://github.com/frankier", "followers_url": "https://api.github.com/users/frankier/followers", "following_url": "https://api.github.com/users/frankier/following{/other_user}", "gists_url": "https://api.github.com/users/frankier/gists{/gist_id}", "starred_url": "https://api.github.com/users/frankier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frankier/subscriptions", "organizations_url": "https://api.github.com/users/frankier/orgs", "repos_url": "https://api.github.com/users/frankier/repos", "events_url": "https://api.github.com/users/frankier/events{/privacy}", "received_events_url": "https://api.github.com/users/frankier/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-09-30T07:23:51Z", "updated_at": "2016-11-03T22:52:16Z", "closed_at": "2016-11-03T22:52:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Currently max_memory_per_child is not portable since it uses getrusage().ru_maxrss (here: https://github.com/celery/billiard/blob/cfeac80dfd9136924af066587942c360e9fb67d8/billiard/pool.py#L383 ). On Linux this value is in kilobytes but on BSDs this value is in bytes. Normally it doesn't exist at all on Windows. I propose instead making a soft dependency on psutil https://pypi.python.org/pypi/psutil for this feature.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/191", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/191/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/191/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/191/events", "html_url": "https://github.com/celery/billiard/issues/191", "id": 175484387, "node_id": "MDU6SXNzdWUxNzU0ODQzODc=", "number": 191, "title": "UnboundLocalError: local variable 'chunk' referenced before assignment", "user": {"login": "diresi", "id": 2082266, "node_id": "MDQ6VXNlcjIwODIyNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/2082266?v=4", "gravatar_id": "", "url": "https://api.github.com/users/diresi", "html_url": "https://github.com/diresi", "followers_url": "https://api.github.com/users/diresi/followers", "following_url": "https://api.github.com/users/diresi/following{/other_user}", "gists_url": "https://api.github.com/users/diresi/gists{/gist_id}", "starred_url": "https://api.github.com/users/diresi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/diresi/subscriptions", "organizations_url": "https://api.github.com/users/diresi/orgs", "repos_url": "https://api.github.com/users/diresi/repos", "events_url": "https://api.github.com/users/diresi/events{/privacy}", "received_events_url": "https://api.github.com/users/diresi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-09-07T11:59:54Z", "updated_at": "2016-09-07T23:07:42Z", "closed_at": "2016-09-07T23:07:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\n\nI'm trying to implement a signal handler for SIGUSR2 and have applied the monkey patch from celery/celery#2615 ([this comment](https://github.com/celery/celery/issues/2615#issuecomment-207085293)).\n\nWhile SIGUSR2 is available for my purpuse using this patch, the `_recv()` implementation [here](https://github.com/celery/billiard/blob/master/billiard/connection.py#L427) actually doesn't handle EINTR.\n\nShouldn't the exception handler `continue` upon `EINTR`s?\n\nThis happens using celery 3.1.23 with billiard 3.5.0.0.\nThe full exception stack is:\n\n```\nTraceback (most recent call last):\n  File \"/home/ente/venv/local/lib/python2.7/site-packages/billiard/pool.py\", line 295, in __call__\n    sys.exit(self.workloop(pid=pid))\n  File \"/home/ente/venv/local/lib/python2.7/site-packages/billiard/pool.py\", line 355, in workloop\n    req = wait_for_job()\n  File \"/home/ente/venv/local/lib/python2.7/site-packages/billiard/pool.py\", line 457, in receive\n    ready, req = _receive(1.0)\n  File \"/home/ente/venv/local/lib/python2.7/site-packages/billiard/pool.py\", line 429, in _recv\n    return True, loads(get_payload())\n  File \"/home/ente/venv/local/lib/python2.7/site-packages/billiard/queues.py\", line 355, in get_payload\n    return self._reader.recv_bytes()\n  File \"/home/ente/venv/local/lib/python2.7/site-packages/billiard/connection.py\", line 245, in recv_bytes\n    buf = self._recv_bytes(maxlength)\n  File \"/home/ente/venv/local/lib/python2.7/site-packages/billiard/connection.py\", line 457, in _recv_bytes\n    buf = self._recv(4)\n  File \"/home/ente/venv/local/lib/python2.7/site-packages/billiard/connection.py\", line 428, in _recv\n    n = len(chunk)\nUnboundLocalError: local variable 'chunk' referenced before assignment\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/190", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/190/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/190/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/190/events", "html_url": "https://github.com/celery/billiard/issues/190", "id": 171006069, "node_id": "MDU6SXNzdWUxNzEwMDYwNjk=", "number": 190, "title": "UnboundLocalError in Connection._send", "user": {"login": "spookylukey", "id": 62745, "node_id": "MDQ6VXNlcjYyNzQ1", "avatar_url": "https://avatars1.githubusercontent.com/u/62745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spookylukey", "html_url": "https://github.com/spookylukey", "followers_url": "https://api.github.com/users/spookylukey/followers", "following_url": "https://api.github.com/users/spookylukey/following{/other_user}", "gists_url": "https://api.github.com/users/spookylukey/gists{/gist_id}", "starred_url": "https://api.github.com/users/spookylukey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spookylukey/subscriptions", "organizations_url": "https://api.github.com/users/spookylukey/orgs", "repos_url": "https://api.github.com/users/spookylukey/repos", "events_url": "https://api.github.com/users/spookylukey/events{/privacy}", "received_events_url": "https://api.github.com/users/spookylukey/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-13T12:07:00Z", "updated_at": "2016-09-07T23:08:05Z", "closed_at": "2016-09-07T23:08:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\nUnboundLocalError: local variable 'n' referenced before assignment\n  File \"celery/bootsteps.py\", line 157, in send_all\n    fun(parent, *args)\n  File \"celery/bootsteps.py\", line 380, in stop\n    return self.obj.stop()\n  File \"celery/concurrency/base.py\", line 125, in stop\n    self.on_stop()\n  File \"celery/concurrency/prefork.py\", line 147, in on_stop\n    self._pool.join()\n  File \"billiard/pool.py\", line 1584, in join\n    self._stop_task_handler(self._task_handler)\n  File \"celery/concurrency/asynpool.py\", line 1096, in _stop_task_handler\n    proc.inq.put(None)\n  File \"billiard/queues.py\", line 366, in put\n    self.send_payload(ForkingPickler.dumps(obj))\n  File \"billiard/queues.py\", line 358, in send_payload\n    self._writer.send_bytes(value)\n  File \"billiard/connection.py\", line 220, in send_bytes\n    self._send_bytes(m[offset:offset + size])\n  File \"billiard/connection.py\", line 444, in _send_bytes\n    self._send(header + buf)\n  File \"billiard/connection.py\", line 403, in _send\n    remaining -= n\n```\n\nThe cause of the error is not hard to see:\n\nhttps://github.com/celery/billiard/blob/master/billiard/connection.py#L404\n\nThe first time through the loop, if there is an exception which does not match `getattr(exc, 'errno', None) != errno.EINTR` then no error handling is done, `n` is not set, and this error occurs. \n\nAlso, if it is not the first time through the loop, then `n` will be set, but from the previous time, so the code is very buggy in this case too.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/189", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/189/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/189/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/189/events", "html_url": "https://github.com/celery/billiard/issues/189", "id": 170092812, "node_id": "MDU6SXNzdWUxNzAwOTI4MTI=", "number": 189, "title": "error message: 'Process' object has no attribute '_counter'", "user": {"login": "ShaolongTan", "id": 20452673, "node_id": "MDQ6VXNlcjIwNDUyNjcz", "avatar_url": "https://avatars1.githubusercontent.com/u/20452673?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ShaolongTan", "html_url": "https://github.com/ShaolongTan", "followers_url": "https://api.github.com/users/ShaolongTan/followers", "following_url": "https://api.github.com/users/ShaolongTan/following{/other_user}", "gists_url": "https://api.github.com/users/ShaolongTan/gists{/gist_id}", "starred_url": "https://api.github.com/users/ShaolongTan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ShaolongTan/subscriptions", "organizations_url": "https://api.github.com/users/ShaolongTan/orgs", "repos_url": "https://api.github.com/users/ShaolongTan/repos", "events_url": "https://api.github.com/users/ShaolongTan/events{/privacy}", "received_events_url": "https://api.github.com/users/ShaolongTan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-08-09T06:39:42Z", "updated_at": "2016-11-26T08:11:20Z", "closed_at": "2016-09-07T23:08:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "Python version is:         Python 2.7.6\nbilliard version:             billiard 3.5.0.0\ncelery version:              4.0.0rc3 (0today8)\n\nI have a task to run ansible playbook by celery apply_async, but I get below error message. If just run ansible playbook sole and not by celery. The ansible task work well. I don't sure the issue whether or not is my incorrectly usage with celery. Please help me check. Thanks you very much.\nIf you need the more detail issue information. Please let me know.\n\nerror message:\n[2016-08-09 06:00:35,215: ERROR/PoolWorker-42] Task ansible_manager.playbook_exec[568ae7ad-d17f-43e6-b7ec-40c489569729] raised unexpected: AttributeError(\"'Process' object has no attribute '_counter'\",)\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/celery-4.0.0rc3-py2.7.egg/celery/app/trace.py\", line 358, in trace_task\n    R = retval = fun(_args, *_kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/celery-4.0.0rc3-py2.7.egg/celery/app/trace.py\", line 609, in __protected_call__\n    return self.run(_args, *_kwargs)\n  File \"/home/vagrant/working/ansible_manager.py\", line 87, in playbook_exec\n    result = ansible_handle.ansible_playbook()\n  File \"/home/vagrant/working/ansible_handle/ansible_handle.py\", line 64, in ansible_runner\n    result = tqm.run(play)\n  File \"/usr/lib/python2.7/dist-packages/ansible/executor/task_queue_manager.py\", line 212, in run\n    self._initialize_processes(min(contenders))\n  File \"/usr/lib/python2.7/dist-packages/ansible/executor/task_queue_manager.py\", line 107, in _initialize_processes\n    self._result_prc = ResultProcess(self._final_q, self._workers)\n  File \"/usr/lib/python2.7/dist-packages/ansible/executor/process/result.py\", line 62, in __init__\n    super(ResultProcess, self).**init**()\n  File \"/usr/lib/python2.7/multiprocessing/process.py\", line 97, in **init**\n    count = _current_process._counter.next()\nAttributeError: 'Process' object has no attribute '_counter'\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/188", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/188/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/188/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/188/events", "html_url": "https://github.com/celery/billiard/issues/188", "id": 168809454, "node_id": "MDU6SXNzdWUxNjg4MDk0NTQ=", "number": 188, "title": "TypeError after upgrading to v3.5.0", "user": {"login": "michael-k", "id": 152008, "node_id": "MDQ6VXNlcjE1MjAwOA==", "avatar_url": "https://avatars2.githubusercontent.com/u/152008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michael-k", "html_url": "https://github.com/michael-k", "followers_url": "https://api.github.com/users/michael-k/followers", "following_url": "https://api.github.com/users/michael-k/following{/other_user}", "gists_url": "https://api.github.com/users/michael-k/gists{/gist_id}", "starred_url": "https://api.github.com/users/michael-k/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michael-k/subscriptions", "organizations_url": "https://api.github.com/users/michael-k/orgs", "repos_url": "https://api.github.com/users/michael-k/repos", "events_url": "https://api.github.com/users/michael-k/events{/privacy}", "received_events_url": "https://api.github.com/users/michael-k/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2016-08-02T06:30:29Z", "updated_at": "2018-07-08T13:57:41Z", "closed_at": "2016-09-08T10:04:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "I get the following `TypeError` after upgrading to billiard v3.5.0:\n\n``` python\n[ERROR/MainProcess] Unrecoverable error: TypeError('_Popen() takes 1 positional argument but 2 were given',)\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.5/site-packages/celery/worker/__init__.py\", line 206, in start\n    self.blueprint.start(self)\n  File \"/usr/local/lib/python3.5/site-packages/celery/bootsteps.py\", line 123, in start\n    step.start(parent)\n  File \"/usr/local/lib/python3.5/site-packages/celery/bootsteps.py\", line 374, in start\n    return self.obj.start()\n  File \"/usr/local/lib/python3.5/site-packages/billiard/process.py\", line 122, in start\n    self._popen = self._Popen(self)\nTypeError: _Popen() takes 1 positional argument but 2 were given\n```\n\nWe are running Django 1.9.9 with celery 3.1.23.  The `TypeError` only occurs, when starting celery with the `celery worker -B` (`-B`: celery beat periodic task scheduler).  It works fine when starting a seperate worker and beat server: `celery worker` and `celery beat`.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/185", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/185/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/185/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/185/events", "html_url": "https://github.com/celery/billiard/issues/185", "id": 159316140, "node_id": "MDU6SXNzdWUxNTkzMTYxNDA=", "number": 185, "title": "Fails to run on Jython 2.7.0 (multiprocessing import failure)", "user": {"login": "Gillingham", "id": 385396, "node_id": "MDQ6VXNlcjM4NTM5Ng==", "avatar_url": "https://avatars1.githubusercontent.com/u/385396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Gillingham", "html_url": "https://github.com/Gillingham", "followers_url": "https://api.github.com/users/Gillingham/followers", "following_url": "https://api.github.com/users/Gillingham/following{/other_user}", "gists_url": "https://api.github.com/users/Gillingham/gists{/gist_id}", "starred_url": "https://api.github.com/users/Gillingham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Gillingham/subscriptions", "organizations_url": "https://api.github.com/users/Gillingham/orgs", "repos_url": "https://api.github.com/users/Gillingham/repos", "events_url": "https://api.github.com/users/Gillingham/events{/privacy}", "received_events_url": "https://api.github.com/users/Gillingham/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 405299413, "node_id": "MDU6TGFiZWw0MDUyOTk0MTM=", "url": "https://api.github.com/repos/celery/billiard/labels/Issue%20Type:%20Bug", "name": "Issue Type: Bug", "color": "b60205", "default": false, "description": null}, {"id": 405300208, "node_id": "MDU6TGFiZWw0MDUzMDAyMDg=", "url": "https://api.github.com/repos/celery/billiard/labels/Python%20Version:%20Jython", "name": "Python Version: Jython", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-06-09T02:23:46Z", "updated_at": "2017-08-08T17:47:33Z", "closed_at": "2017-08-08T17:47:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\n  File \"jython/Lib/site-packages/billiard/__init__.py\", line 35, in <module>\n    from .process import Process, current_process, active_children\n  File \"jython/Lib/site-packages/billiard/process.py\", line 23, in <module>\n    from multiprocessing import process as _mproc\nImportError: No module named multiprocessing\n```\n\n```\n./jython/bin/pip list\namqp (1.4.9)\nanyjson (0.3.3)\nbilliard (3.3.0.23)\ncelery (3.1.23)\nkombu (3.0.35)\npip (1.6.dev1)\npytz (2016.4)\nsetuptools (14.3.2.dev0)\n```\n\nI believe this is a regression, as celery claims to have worked on Jython 2.7.0\n\ncelery/celery#2067 is tracking the issue caused by billiards change for celery\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/184", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/184/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/184/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/184/events", "html_url": "https://github.com/celery/billiard/issues/184", "id": 153606023, "node_id": "MDU6SXNzdWUxNTM2MDYwMjM=", "number": 184, "title": "Tag missing for the 3.3.0.23 release", "user": {"login": "edmorley", "id": 501702, "node_id": "MDQ6VXNlcjUwMTcwMg==", "avatar_url": "https://avatars3.githubusercontent.com/u/501702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edmorley", "html_url": "https://github.com/edmorley", "followers_url": "https://api.github.com/users/edmorley/followers", "following_url": "https://api.github.com/users/edmorley/following{/other_user}", "gists_url": "https://api.github.com/users/edmorley/gists{/gist_id}", "starred_url": "https://api.github.com/users/edmorley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edmorley/subscriptions", "organizations_url": "https://api.github.com/users/edmorley/orgs", "repos_url": "https://api.github.com/users/edmorley/repos", "events_url": "https://api.github.com/users/edmorley/events{/privacy}", "received_events_url": "https://api.github.com/users/edmorley/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 405298774, "node_id": "MDU6TGFiZWw0MDUyOTg3NzQ=", "url": "https://api.github.com/repos/celery/billiard/labels/Category:%20Packaging%20and%20Release%20Management", "name": "Category: Packaging and Release Management", "color": "1d76db", "default": false, "description": null}, {"id": 405300625, "node_id": "MDU6TGFiZWw0MDUzMDA2MjU=", "url": "https://api.github.com/repos/celery/billiard/labels/Status:%20Confirmed", "name": "Status: Confirmed", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-07T17:19:03Z", "updated_at": "2016-07-09T03:28:27Z", "closed_at": "2016-07-09T03:28:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The v3.3.0.23 tag is missing:\nhttps://github.com/celery/billiard/tags\n\nMany thanks :-)\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/183", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/183/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/183/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/183/events", "html_url": "https://github.com/celery/billiard/issues/183", "id": 152791736, "node_id": "MDU6SXNzdWUxNTI3OTE3MzY=", "number": 183, "title": "Email with billiard.exceptions.Terminated", "user": {"login": "jhg-tgu", "id": 13555249, "node_id": "MDQ6VXNlcjEzNTU1MjQ5", "avatar_url": "https://avatars3.githubusercontent.com/u/13555249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhg-tgu", "html_url": "https://github.com/jhg-tgu", "followers_url": "https://api.github.com/users/jhg-tgu/followers", "following_url": "https://api.github.com/users/jhg-tgu/following{/other_user}", "gists_url": "https://api.github.com/users/jhg-tgu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhg-tgu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhg-tgu/subscriptions", "organizations_url": "https://api.github.com/users/jhg-tgu/orgs", "repos_url": "https://api.github.com/users/jhg-tgu/repos", "events_url": "https://api.github.com/users/jhg-tgu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhg-tgu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 405298825, "node_id": "MDU6TGFiZWw0MDUyOTg4MjU=", "url": "https://api.github.com/repos/celery/billiard/labels/Component:%20Pool", "name": "Component: Pool", "color": "d93f0b", "default": false, "description": null}, {"id": 405301041, "node_id": "MDU6TGFiZWw0MDUzMDEwNDE=", "url": "https://api.github.com/repos/celery/billiard/labels/Status:%20Needs%20Verification", "name": "Status: Needs Verification", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-05-03T14:43:36Z", "updated_at": "2017-07-31T16:14:52Z", "closed_at": "2017-07-31T16:14:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "I received a email of Celery exceptions with this only:\n\n``` python\nTraceback (most recent call last):\n File \"/opt/my_env/lib/python3.4/site-packages/billiard/pool.py\", line 1678, in _set_terminated\n   raise Terminated(-(signum or 0))\nbilliard.exceptions.Terminated: 0\n```\n\nWhy?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/181", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/181/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/181/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/181/events", "html_url": "https://github.com/celery/billiard/issues/181", "id": 141324447, "node_id": "MDU6SXNzdWUxNDEzMjQ0NDc=", "number": 181, "title": "AttributeError: 'module' object has no attribute WAIT_ABANDONED_0", "user": {"login": "vladmunteanu", "id": 7191745, "node_id": "MDQ6VXNlcjcxOTE3NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/7191745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vladmunteanu", "html_url": "https://github.com/vladmunteanu", "followers_url": "https://api.github.com/users/vladmunteanu/followers", "following_url": "https://api.github.com/users/vladmunteanu/following{/other_user}", "gists_url": "https://api.github.com/users/vladmunteanu/gists{/gist_id}", "starred_url": "https://api.github.com/users/vladmunteanu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vladmunteanu/subscriptions", "organizations_url": "https://api.github.com/users/vladmunteanu/orgs", "repos_url": "https://api.github.com/users/vladmunteanu/repos", "events_url": "https://api.github.com/users/vladmunteanu/events{/privacy}", "received_events_url": "https://api.github.com/users/vladmunteanu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-03-16T16:19:14Z", "updated_at": "2016-04-22T11:48:02Z", "closed_at": "2016-04-22T11:47:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "There is minor mistake in billiard/py3/connection.py preventing celery workers from starting on Windows 2012 R2, but the fix is rather simple. Full traceback below.\n\n> Traceback (most recent call last):\n>   File \"C:\\Python33\\Lib\\runpy.py\", line 160, in _run_module_as_main\n>     \"__main__\", fname, loader, pkg_name)\n>   File \"C:\\Python33\\Lib\\runpy.py\", line 73, in _run_code\n>     exec(code, run_globals)\n>   File \"C:\\Python33\\Scripts\\celery.exe__main__.py\", line 9, in <module>\n>   File \"C:\\Python33\\lib\\site-packages\\celery__main__.py\", line 30, in main\n>     main()\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\bin\\celery.py\", line 81, in main\n>     cmd.execute_from_commandline(argv)\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\bin\\celery.py\", line 793, in execut\n> e_from_commandline\n>     super(CeleryCommand, self).execute_from_commandline(argv)))\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\bin\\base.py\", line 311, in execute_\n> from_commandline\n>     return self.handle_argv(self.prog_name, argv[1:])\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\bin\\celery.py\", line 785, in handle\n> _argv\n>     return self.execute(command, argv)\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\bin\\celery.py\", line 717, in execut\n> e\n>     ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\bin\\worker.py\", line 179, in run_fr\n> om_argv\n>     return self(_args, *_options)\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\bin\\base.py\", line 274, in __call__\n> \n> ```\n> ret = self.run(*args, **kwargs)\n> ```\n> \n>   File \"C:\\Python33\\lib\\site-packages\\celery\\bin\\worker.py\", line 194, in run\n>     pool_cls = (concurrency.get_implementation(pool_cls) or\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\concurrency__init__.py\", line 29,\n> in get_implementation\n>     return symbol_by_name(cls, ALIASES)\n>   File \"C:\\Python33\\lib\\site-packages\\kombu\\utils__init__.py\", line 96, in symb\n> ol_by_name\n>     module = imp(module_name, package=package, **kwargs)\n>   File \"C:\\Python33\\Lib\\importlib__init__.py\", line 90, in import_module\n>     return _bootstrap._gcd_import(name[level:], package, level)\n>   File \"<frozen importlib._bootstrap>\", line 1584, in _gcd_import\n>   File \"<frozen importlib._bootstrap>\", line 1565, in _find_and_load\n>   File \"<frozen importlib._bootstrap>\", line 1532, in _find_and_load_unlocked\n>   File \"<frozen importlib._bootstrap>\", line 584, in _check_name_wrapper\n>   File \"<frozen importlib._bootstrap>\", line 1022, in load_module\n>   File \"<frozen importlib._bootstrap>\", line 1003, in load_module\n>   File \"<frozen importlib._bootstrap>\", line 560, in module_for_loader_wrapper\n>   File \"<frozen importlib._bootstrap>\", line 868, in _load_module\n>   File \"<frozen importlib._bootstrap>\", line 313, in _call_with_frames_removed\n>   File \"C:\\Python33\\lib\\site-packages\\celery\\concurrency\\prefork.py\", line 14, i\n> n <module>\n>     from billiard.pool import RUN, CLOSE, Pool as BlockingPool\n>   File \"C:\\Python33\\lib\\site-packages\\billiard\\pool.py\", line 34, in <module>\n>     from .dummy import DummyProcess\n>   File \"C:\\Python33\\lib\\site-packages\\billiard\\dummy__init__.py\", line 50, in <\n> module>\n>     from billiard.connection import Pipe\n>   File \"C:\\Python33\\lib\\site-packages\\billiard\\connection.py\", line 8, in <modul\n> e>\n>     from .py3 import connection\n>   File \"C:\\Python33\\lib\\site-packages\\billiard\\py3\\connection.py\", line 37, in <\n> module>\n>     WAIT_ABANDONED_0 = _winapi.WAIT_ABANDONED_0\n> AttributeError: 'module' object has no attribute 'WAIT_ABANDONED_0'\n\nThe portion of code that raises this error is:\n\n```\ntry:\n    import _winapi\n\n    WAIT_OBJECT_0 = _winapi.WAIT_OBJECT_0\n    WAIT_TIMEOUT = _winapi.WAIT_TIMEOUT\n    INFINITE = _winapi.INFINITE\n    # if we got here, we seem to be running on Windows. Handle probably\n    # missing WAIT_ABANDONED_0 constant:\n    try:\n        WAIT_ABANDONED_0 = _winapi.WAIT_ABANDONED_0\n    except ImportError:\n        # _winapi seems to be not exporting\n        # this constant, fallback solution until\n        # exported in _winapio\n        WAIT_ABANDONED_0 = 128\nexcept ImportError:\n    if sys.platform == 'win32':\n        raise\n    _winapi = None\n```\n\nHowever, this can be fixed by handling AttributeError instead of ImportError since there is no actual import happening in the inner try-except block:\n\n```\ntry:\n    import _winapi\n\n    WAIT_OBJECT_0 = _winapi.WAIT_OBJECT_0\n    WAIT_TIMEOUT = _winapi.WAIT_TIMEOUT\n    INFINITE = _winapi.INFINITE\n    # if we got here, we seem to be running on Windows. Handle probably\n    # missing WAIT_ABANDONED_0 constant:\n    try:\n        WAIT_ABANDONED_0 = _winapi.WAIT_ABANDONED_0\n    except AttributeError:\n        # _winapi seems to be not exporting\n        # this constant, fallback solution until\n        # exported in _winapio\n        WAIT_ABANDONED_0 = 128\nexcept ImportError:\n    if sys.platform == 'win32':\n        raise\n    _winapi = None\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/180", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/180/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/180/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/180/events", "html_url": "https://github.com/celery/billiard/issues/180", "id": 138259206, "node_id": "MDU6SXNzdWUxMzgyNTkyMDY=", "number": 180, "title": "Traceback object doesn't have a tb_lasti property", "user": {"login": "gavinwahl", "id": 421710, "node_id": "MDQ6VXNlcjQyMTcxMA==", "avatar_url": "https://avatars2.githubusercontent.com/u/421710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gavinwahl", "html_url": "https://github.com/gavinwahl", "followers_url": "https://api.github.com/users/gavinwahl/followers", "following_url": "https://api.github.com/users/gavinwahl/following{/other_user}", "gists_url": "https://api.github.com/users/gavinwahl/gists{/gist_id}", "starred_url": "https://api.github.com/users/gavinwahl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gavinwahl/subscriptions", "organizations_url": "https://api.github.com/users/gavinwahl/orgs", "repos_url": "https://api.github.com/users/gavinwahl/repos", "events_url": "https://api.github.com/users/gavinwahl/events{/privacy}", "received_events_url": "https://api.github.com/users/gavinwahl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-03-03T18:29:58Z", "updated_at": "2016-03-03T20:14:51Z", "closed_at": "2016-03-03T20:06:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Python's Traceback object has a tb_lasti property, but billiard.einfo.Traceback does not. This causes errors in code that expects python tracebacks (getsentry/raven-python#740).\n\nWhy is traceback being wrapped at all? It seems like this causes other bugs too, like #176.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/178", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/178/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/178/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/178/events", "html_url": "https://github.com/celery/billiard/issues/178", "id": 120916850, "node_id": "MDU6SXNzdWUxMjA5MTY4NTA=", "number": 178, "title": "ImportError: No module named 'billiard.py3.compat", "user": {"login": "dessant", "id": 7513068, "node_id": "MDQ6VXNlcjc1MTMwNjg=", "avatar_url": "https://avatars0.githubusercontent.com/u/7513068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dessant", "html_url": "https://github.com/dessant", "followers_url": "https://api.github.com/users/dessant/followers", "following_url": "https://api.github.com/users/dessant/following{/other_user}", "gists_url": "https://api.github.com/users/dessant/gists{/gist_id}", "starred_url": "https://api.github.com/users/dessant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dessant/subscriptions", "organizations_url": "https://api.github.com/users/dessant/orgs", "repos_url": "https://api.github.com/users/dessant/repos", "events_url": "https://api.github.com/users/dessant/events{/privacy}", "received_events_url": "https://api.github.com/users/dessant/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-12-08T02:34:39Z", "updated_at": "2015-12-09T00:57:58Z", "closed_at": "2015-12-08T22:56:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "After upgading from billiard 3.3.0.20 to 3.3.0.21:\n\n``` python\nTraceback (most recent call last):\n  File \"run.py\", line 41, in <module>\n    start_celery()\n  File \"run.py\", line 29, in start_celery\n    worker.start_worker()\n  File \"e:\\dev\\prs\\main\\app\\worker.py\", line 45, in start_worker\n    app.worker_main(argv)\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\app\\base.py\", line 206, in worker_main\n    app=self).execute_from_commandline(argv)\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\bin\\base.py\", line 304, in execute_from_commandline\n    self.maybe_patch_concurrency(argv)\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\bin\\base.py\", line 321, in maybe_patch_concurrency\n    maybe_patch_concurrency(argv, *pool_option)\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\__init__.py\", line 128, in maybe_patch_concurrency\n    concurrency.get_implementation(pool)\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\concurrency\\__init__.py\", line 29, in get_implementation\n    return symbol_by_name(cls, ALIASES)\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\kombu\\utils\\__init__.py\", line 96, in symbol_by_name\n    module = imp(module_name, package=package, **kwargs)\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\importlib\\__init__.py\", line 109, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"<frozen importlib._bootstrap>\", line 2254, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 2237, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 2226, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 1200, in _load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 1129, in _exec\n  File \"<frozen importlib._bootstrap>\", line 1471, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 321, in _call_with_frames_removed\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\concurrency\\prefork.py\", line 14, in <module>\n    from billiard.pool import RUN, CLOSE, Pool as BlockingPool\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\billiard\\pool.py\", line 34, in <module>\n    from .dummy import DummyProcess\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\billiard\\dummy\\__init__.py\", line 50, in <module>\n    from billiard.connection import Pipe\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\billiard\\connection.py\", line 8, in <module>\n    from .py3 import connection\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\billiard\\py3\\connection.py\", line 26, in <module>\n    from ..reduction import ForkingPickler\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\billiard\\reduction.py\", line 6, in <module>\n    from .py3 import reduction\n  File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\billiard\\py3\\reduction.py\", line 69, in <module>\n    from .compat import _winapi\nImportError: No module named 'billiard.py3.compat'\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/177", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/177/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/177/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/177/events", "html_url": "https://github.com/celery/billiard/issues/177", "id": 116443619, "node_id": "MDU6SXNzdWUxMTY0NDM2MTk=", "number": 177, "title": "unable to import billard as package when building a new amazon-ami", "user": {"login": "debuggerpk", "id": 1317783, "node_id": "MDQ6VXNlcjEzMTc3ODM=", "avatar_url": "https://avatars1.githubusercontent.com/u/1317783?v=4", "gravatar_id": "", "url": "https://api.github.com/users/debuggerpk", "html_url": "https://github.com/debuggerpk", "followers_url": "https://api.github.com/users/debuggerpk/followers", "following_url": "https://api.github.com/users/debuggerpk/following{/other_user}", "gists_url": "https://api.github.com/users/debuggerpk/gists{/gist_id}", "starred_url": "https://api.github.com/users/debuggerpk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/debuggerpk/subscriptions", "organizations_url": "https://api.github.com/users/debuggerpk/orgs", "repos_url": "https://api.github.com/users/debuggerpk/repos", "events_url": "https://api.github.com/users/debuggerpk/events{/privacy}", "received_events_url": "https://api.github.com/users/debuggerpk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-11-11T23:24:48Z", "updated_at": "2017-10-20T13:36:25Z", "closed_at": "2015-11-12T00:03:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "i am building a new amazon instance with python 2.7.10 as default.\nafter i have ran my machine provisioning scripts and the moment of truth arrives, celery gave me an import so i debugged the problem to billard.\n\nthe package appears to be in the correct path i.e.\n\n``` bash\nsudo find -name \"billiard\"\n./srv/ia-live/lib64/python2.7/dist-packages/billiard\n```\n\nwhere ia-live is the path of my virtualenv. checking the path in via python virtualenv execuatable\n\n``` python\nimport sys\nsys.path\n\n['',\n '/srv/ia-live/bin',\n '/srv/ia-live/src/django-devserver-redux-master',\n '/usr/lib/python2.7',\n '/srv/ia-live/local/lib64/python2.7/site-packages',\n '/srv/ia-live/local/lib/python2.7/site-packages',\n '/srv/ia-live/lib64/python2.7',\n '/srv/ia-live/lib/python2.7',\n '/srv/ia-live/lib64/python2.7/site-packages',\n '/srv/ia-live/lib/python2.7/site-packages',\n '/srv/ia-live/lib64/python2.7/lib-dynload',\n '/srv/ia-live/local/lib/python2.7/dist-packages',\n '/srv/ia-live/local/lib/python2.7/dist-packages',\n '/srv/ia-live/lib/python2.7/dist-packages',\n '/usr/lib64/python2.7',\n '/usr/lib/python2.7',\n '/srv/ia-live/local/lib/python2.7/dist-packages/IPython/extensions',\n '/home/ec2-user/.ipython']\n```\n\nwhich appears to be correct, but when i do\n\n``` python\nimport billiard\nImportError: No module named billiard\n```\n\ni don't understand why there could be problem\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/172", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/172/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/172/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/172/events", "html_url": "https://github.com/celery/billiard/issues/172", "id": 108228595, "node_id": "MDU6SXNzdWUxMDgyMjg1OTU=", "number": 172, "title": "AttributeError: 'LaxBoundedSemaphore' object has no attribute '_Semaphore__value'", "user": {"login": "dessant", "id": 7513068, "node_id": "MDQ6VXNlcjc1MTMwNjg=", "avatar_url": "https://avatars0.githubusercontent.com/u/7513068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dessant", "html_url": "https://github.com/dessant", "followers_url": "https://api.github.com/users/dessant/followers", "following_url": "https://api.github.com/users/dessant/following{/other_user}", "gists_url": "https://api.github.com/users/dessant/gists{/gist_id}", "starred_url": "https://api.github.com/users/dessant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dessant/subscriptions", "organizations_url": "https://api.github.com/users/dessant/orgs", "repos_url": "https://api.github.com/users/dessant/repos", "events_url": "https://api.github.com/users/dessant/events{/privacy}", "received_events_url": "https://api.github.com/users/dessant/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-09-24T22:49:23Z", "updated_at": "2015-12-09T00:50:44Z", "closed_at": "2015-10-10T01:27:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm starting the worker with `--autoscale=10,1`, when using `--concurrency=10` instead, the worker does not crash.\n\n```\nsoftware -> celery:3.1.18 (Cipater) kombu:3.0.26 py:3.4.3\n            billiard:3.3.0.20 py-amqp:1.4.6\n```\n\n``` python\n[2015-09-25 00:56:02,882: INFO/MainProcess] Scaling up 1 processes.\n[2015-09-25 00:56:02,882: WARNING/MainProcess] 'Autoscaler' crashed: AttributeError(\"'LaxBoundedSemaphore' object has no attribute '_Semaphore__value'\",)\n[2015-09-25 00:56:02,882: WARNING/MainProcess] Traceback (most recent call last):\n[2015-09-25 00:56:02,882: WARNING/MainProcess] File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\utils\\threads.py\", line 64, in run\n    body()\n[2015-09-25 00:56:02,897: WARNING/MainProcess] File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\worker\\autoscale.py\", line 81, in body\n    self.maybe_scale()\n[2015-09-25 00:56:02,897: WARNING/MainProcess] File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\worker\\autoscale.py\", line 95, in maybe_scale\n    if self._maybe_scale(req):\n[2015-09-25 00:56:02,913: WARNING/MainProcess] File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\worker\\autoscale.py\", line 88, in _maybe_scale\n    self.scale_up(cur - procs)\n[2015-09-25 00:56:02,913: WARNING/MainProcess] File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\worker\\autoscale.py\", line 127, in scale_up\n    return self._grow(n)\n[2015-09-25 00:56:02,929: WARNING/MainProcess] File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\celery\\worker\\autoscale.py\", line 137, in _grow\n    self.pool.grow(n)\n[2015-09-25 00:56:02,929: WARNING/MainProcess] File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\billiard\\pool.py\", line 1206, in grow\n    self._putlock.grow()\n[2015-09-25 00:56:02,944: WARNING/MainProcess] File \"e:\\dev\\envs\\py34_x86\\Python\\lib\\site-packages\\billiard\\pool.py\", line 172, in grow\n    self._Semaphore__value += 1\n[2015-09-25 00:56:02,960: WARNING/MainProcess] AttributeError: 'LaxBoundedSemaphore' object has no attribute '_Semaphore__value'\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/171", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/171/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/171/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/171/events", "html_url": "https://github.com/celery/billiard/issues/171", "id": 105823220, "node_id": "MDU6SXNzdWUxMDU4MjMyMjA=", "number": 171, "title": "wheels for billard", "user": {"login": "srkunze", "id": 1389648, "node_id": "MDQ6VXNlcjEzODk2NDg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1389648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srkunze", "html_url": "https://github.com/srkunze", "followers_url": "https://api.github.com/users/srkunze/followers", "following_url": "https://api.github.com/users/srkunze/following{/other_user}", "gists_url": "https://api.github.com/users/srkunze/gists{/gist_id}", "starred_url": "https://api.github.com/users/srkunze/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srkunze/subscriptions", "organizations_url": "https://api.github.com/users/srkunze/orgs", "repos_url": "https://api.github.com/users/srkunze/repos", "events_url": "https://api.github.com/users/srkunze/events{/privacy}", "received_events_url": "https://api.github.com/users/srkunze/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-09-10T14:36:15Z", "updated_at": "2015-12-09T20:35:43Z", "closed_at": "2015-12-08T22:55:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "Do you consider providing Python wheels for billiard? http://pythonwheels.com/\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/170", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/170/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/170/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/170/events", "html_url": "https://github.com/celery/billiard/issues/170", "id": 105581759, "node_id": "MDU6SXNzdWUxMDU1ODE3NTk=", "number": 170, "title": "In 'reduction.py' line 59, 'cls.loads(buf.getbuffer(), protocol)' is wrong!", "user": {"login": "huaxz1986", "id": 3395177, "node_id": "MDQ6VXNlcjMzOTUxNzc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3395177?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huaxz1986", "html_url": "https://github.com/huaxz1986", "followers_url": "https://api.github.com/users/huaxz1986/followers", "following_url": "https://api.github.com/users/huaxz1986/following{/other_user}", "gists_url": "https://api.github.com/users/huaxz1986/gists{/gist_id}", "starred_url": "https://api.github.com/users/huaxz1986/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huaxz1986/subscriptions", "organizations_url": "https://api.github.com/users/huaxz1986/orgs", "repos_url": "https://api.github.com/users/huaxz1986/repos", "events_url": "https://api.github.com/users/huaxz1986/events{/privacy}", "received_events_url": "https://api.github.com/users/huaxz1986/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-09-09T11:56:49Z", "updated_at": "2015-10-26T18:15:32Z", "closed_at": "2015-10-26T18:15:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I use celery, there is something wrong and said:\n\n/***********************\n File \"E:\\SoftWare\\Python34\\lib\\site-packages\\billiard-3.4.0.0b1-py3.4.egg\\billiard\\reduction.py\", line 59, in loadbuf\n    return cls.loads(buf.getbuffer(), protocol)\nTypeError: Function takes at most 1 positional arguments (2 given)\n**************/\n\nI find it that it equals :\n      pickle.loads(buf.getbuffer(), protocol)\nbut in python3.4 ,the prototype is:\n      pickle.loads(bytes_object, *, fix_imports=True, encoding=\"ASCII\", errors=\"strict\") \n\nso the arguments are not right.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/169", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/169/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/169/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/169/events", "html_url": "https://github.com/celery/billiard/issues/169", "id": 99643873, "node_id": "MDU6SXNzdWU5OTY0Mzg3Mw==", "number": 169, "title": "AttributeError: class ForkingPickler has no attribute 'load'", "user": {"login": "freylis", "id": 1232441, "node_id": "MDQ6VXNlcjEyMzI0NDE=", "avatar_url": "https://avatars3.githubusercontent.com/u/1232441?v=4", "gravatar_id": "", "url": "https://api.github.com/users/freylis", "html_url": "https://github.com/freylis", "followers_url": "https://api.github.com/users/freylis/followers", "following_url": "https://api.github.com/users/freylis/following{/other_user}", "gists_url": "https://api.github.com/users/freylis/gists{/gist_id}", "starred_url": "https://api.github.com/users/freylis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/freylis/subscriptions", "organizations_url": "https://api.github.com/users/freylis/orgs", "repos_url": "https://api.github.com/users/freylis/repos", "events_url": "https://api.github.com/users/freylis/events{/privacy}", "received_events_url": "https://api.github.com/users/freylis/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-08-07T13:04:33Z", "updated_at": "2015-12-08T22:32:45Z", "closed_at": "2015-12-08T22:32:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I install billiard from master. And if `billiard/reduction.py` at line `83` i see the code:\n\n```\n    @classmethod\n    def loadbuf(cls, buf, protocol=None):\n        return cls.load(buf, protocol)\n\n    loads = pickle.loads\n```\n\nso, `cls.load != loads`\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/168", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/168/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/168/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/168/events", "html_url": "https://github.com/celery/billiard/issues/168", "id": 99023782, "node_id": "MDU6SXNzdWU5OTAyMzc4Mg==", "number": 168, "title": "Worker processes can't use multiprocessing (indirectly prevents usage of scikit-learn and nltk)", "user": {"login": "martinth", "id": 70785, "node_id": "MDQ6VXNlcjcwNzg1", "avatar_url": "https://avatars0.githubusercontent.com/u/70785?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinth", "html_url": "https://github.com/martinth", "followers_url": "https://api.github.com/users/martinth/followers", "following_url": "https://api.github.com/users/martinth/following{/other_user}", "gists_url": "https://api.github.com/users/martinth/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinth/subscriptions", "organizations_url": "https://api.github.com/users/martinth/orgs", "repos_url": "https://api.github.com/users/martinth/repos", "events_url": "https://api.github.com/users/martinth/events{/privacy}", "received_events_url": "https://api.github.com/users/martinth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 405299542, "node_id": "MDU6TGFiZWw0MDUyOTk1NDI=", "url": "https://api.github.com/repos/celery/billiard/labels/Issue%20Type:%20Feature%20Request", "name": "Issue Type: Feature Request", "color": "f9d0c4", "default": false, "description": null}, {"id": 405300375, "node_id": "MDU6TGFiZWw0MDUzMDAzNzU=", "url": "https://api.github.com/repos/celery/billiard/labels/Severity:%20Critical", "name": "Severity: Critical", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2015-08-04T17:56:17Z", "updated_at": "2018-03-05T11:15:35Z", "closed_at": "2018-01-15T10:42:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is a spin off issue from the Celery issue [#1709 Tasks are not allowed to start subprocesses](https://github.com/celery/celery/issues/1709). The Problem was [first mentioned by ostrokach ](https://github.com/celery/celery/issues/1709#issuecomment-122467424) who provided a stack trace that occures when he uses a scikit-learn classifier inside a worker. Since the problem seems to be cause by billiard and not by Celery itself I'm creating a new issue here.\n### Stacktrace\n\n```\n[2015-07-17 21:23:51,299: ERROR/MainProcess] Task app.f[329d0da4-2e0e-4e1f-8148-d64f47750b1f] raised unexpected: AttributeError(\"'Worker' object has no attribute '_config'\",)\nTraceback (most recent call last):\n  File \"/home/username/anaconda3/lib/python3.4/site-packages/celery/app/trace.py\", line 240, in trace_task\n    R = retval = fun(*args, **kwargs)\n  File \"/home/username/anaconda3/lib/python3.4/site-packages/celery/app/trace.py\", line 438, in __protected_call__\n    return self.run(*args, **kwargs)\n  File \"/home/username/working/playground/celery/app.py\", line 11, in f\n    clf = pickle.load(open('clf.pickle', 'rb'))\n  File \"/home/username/anaconda3/lib/python3.4/site-packages/sklearn/ensemble/__init__.py\", line 6, in <module>\n    from .base import BaseEnsemble\n  File \"/home/username/anaconda3/lib/python3.4/site-packages/sklearn/ensemble/base.py\", line 13, in <module>\n    from ..externals.joblib import cpu_count\n  File \"/home/username/anaconda3/lib/python3.4/site-packages/sklearn/externals/joblib/__init__.py\", line 112, in <module>\n    from .parallel import Parallel\n  File \"/home/username/anaconda3/lib/python3.4/site-packages/sklearn/externals/joblib/parallel.py\", line 23, in <module>\n    from ._multiprocessing_helpers import mp\n  File \"/home/username/anaconda3/lib/python3.4/site-packages/sklearn/externals/joblib/_multiprocessing_helpers.py\", line 25, in <module>\n    _sem = mp.Semaphore()\n  File \"/home/username/anaconda3/lib/python3.4/multiprocessing/context.py\", line 81, in Semaphore\n    return Semaphore(value, ctx=self.get_context())\n  File \"/home/username/anaconda3/lib/python3.4/multiprocessing/synchronize.py\", line 127, in __init__\n    SemLock.__init__(self, SEMAPHORE, value, SEM_VALUE_MAX, ctx=ctx)\n  File \"/home/username/anaconda3/lib/python3.4/multiprocessing/synchronize.py\", line 59, in __init__\n    kind, value, maxvalue, self._make_name(),\n  File \"/home/username/anaconda3/lib/python3.4/multiprocessing/synchronize.py\", line 117, in _make_name\n    return '%s-%s' % (process.current_process()._config['semprefix'],\nAttributeError: 'Worker' object has no attribute '_config'\n```\n### To reproduce\n\nCreate an empty classifier and save it as a pickle:\n\n```\nimport pickle\nfrom sklearn.ensemble import GradientBoostingClassifier\nclf = GradientBoostingClassifier()\npickle.dump(clf, open('clf.pickle', 'wb'))\n```\n\nCreate a simple app (`app.py`):\n\n```\nimport pickle\nimport sklearn\nfrom celery import Celery\n\napp = Celery(__name__, broker='amqp://localhost//')\n\n@app.task\ndef f():\n    print('hello')\n    clf = pickle.load(open('clf.pickle', 'rb'))\n    print(clf)\n```\n\nStart the celery worker:\n\n```\ncelery -A app worker --loglevel=debug\n```\n\nRun the app:\n\n```\npython -c \"from app import f; f.delay()\"\n```\n\n---\n\nI myself also ran into the same error while importing the functions from NLTK (a popular Natural Language Processing library). The problem **only** exists when the code in question is actually run as a worker. It always the problem that the value that is returned by `multiprocessing.current_process()` has no `_config` attribute.\n\nThe current workaround for this specific error is:\n\n```\nfrom celery.signals import worker_process_init\n\n@worker_process_init.connect\ndef fix_multiprocessing(**kwargs):\n    from multiprocessing import current_process\n    try:\n        current_process()._config\n    except AttributeError:\n        current_process()._config = {'semprefix': '/mp'}\n```\n\nHowever, I'm totally not sure what this might break elsewhere.\n\n---\n\nTo me, it looks like the problem was introduced by c7eedbd0ee1498e76d4fa1affac5b1a275660ee7. Prior to that the [`Worker` class](https://github.com/celery/billiard/commit/c7eedbd0ee1498e76d4fa1affac5b1a275660ee7#diff-42cbdfeee4eeeb2688454e975c2d18ffL238) was derived from [`Process`](https://github.com/celery/billiard/blob/master/billiard/process.py#L77) which indeed hat an appropriate `_config` attribute. \n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/167", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/167/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/167/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/167/events", "html_url": "https://github.com/celery/billiard/issues/167", "id": 97792501, "node_id": "MDU6SXNzdWU5Nzc5MjUwMQ==", "number": 167, "title": "Task raised exception: 'Terminated(9,)'", "user": {"login": "rafaelnovello", "id": 423789, "node_id": "MDQ6VXNlcjQyMzc4OQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/423789?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rafaelnovello", "html_url": "https://github.com/rafaelnovello", "followers_url": "https://api.github.com/users/rafaelnovello/followers", "following_url": "https://api.github.com/users/rafaelnovello/following{/other_user}", "gists_url": "https://api.github.com/users/rafaelnovello/gists{/gist_id}", "starred_url": "https://api.github.com/users/rafaelnovello/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rafaelnovello/subscriptions", "organizations_url": "https://api.github.com/users/rafaelnovello/orgs", "repos_url": "https://api.github.com/users/rafaelnovello/repos", "events_url": "https://api.github.com/users/rafaelnovello/events{/privacy}", "received_events_url": "https://api.github.com/users/rafaelnovello/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-07-28T20:16:03Z", "updated_at": "2015-12-08T22:32:55Z", "closed_at": "2015-12-08T22:32:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi!\n\nSometimes one of my tasks is terminated with the following error:\n\n```\nTask tasks.start_campaigns with id 5c1b7b74-d41f-4f2d-86e2-d4655ec58174 raised exception:\n'Terminated(9,)'\n\n\nTask was called with args: [] kwargs: {}.\n\nThe contents of the full traceback was:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/billiard/pool.py\", line 961, in _join_exited_workers\n    raise Terminated(-exitcodes[worker_pid])\nTerminated: 9\n```\n\nAt first I thought it would be lack of space in memory but is not the problem. Can anyone help?\n\nI'm running:\nUbuntu 12.04\nPython 2.7 \nCelery 3.0.24\nbilliard 2.7.3.34\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/165", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/165/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/165/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/165/events", "html_url": "https://github.com/celery/billiard/issues/165", "id": 90178154, "node_id": "MDU6SXNzdWU5MDE3ODE1NA==", "number": 165, "title": "Issue with createLock", "user": {"login": "cbron", "id": 571419, "node_id": "MDQ6VXNlcjU3MTQxOQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/571419?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cbron", "html_url": "https://github.com/cbron", "followers_url": "https://api.github.com/users/cbron/followers", "following_url": "https://api.github.com/users/cbron/following{/other_user}", "gists_url": "https://api.github.com/users/cbron/gists{/gist_id}", "starred_url": "https://api.github.com/users/cbron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cbron/subscriptions", "organizations_url": "https://api.github.com/users/cbron/orgs", "repos_url": "https://api.github.com/users/cbron/repos", "events_url": "https://api.github.com/users/cbron/events{/privacy}", "received_events_url": "https://api.github.com/users/cbron/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-06-22T18:45:29Z", "updated_at": "2017-05-14T12:01:33Z", "closed_at": "2015-06-22T18:58:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm starting celery with this: `venv/bin/celery -A app.lib.tasks.celery worker -Q default`\n\nAnd now I'm getting this error: \n\nTraceback (most recent call last):\n  File \"venv/local/lib/python2.7/site-packages/billiard/process.py\", line 280, in _bootstrap\n    handler.createLock()\nAttributeError: 'ProcessAwareLogger' object has no attribute 'createLock'\nUnrecoverable error: WorkerLostError('Could not start worker processes',)\n\nbilliard version: 3.3.0.19\ncelery version: 3.1.17\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/164", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/164/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/164/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/164/events", "html_url": "https://github.com/celery/billiard/issues/164", "id": 89248170, "node_id": "MDU6SXNzdWU4OTI0ODE3MA==", "number": 164, "title": "CHANGES.txt is missing changelog for 3.3.0.18 and newer", "user": {"login": "edmorley", "id": 501702, "node_id": "MDQ6VXNlcjUwMTcwMg==", "avatar_url": "https://avatars3.githubusercontent.com/u/501702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edmorley", "html_url": "https://github.com/edmorley", "followers_url": "https://api.github.com/users/edmorley/followers", "following_url": "https://api.github.com/users/edmorley/following{/other_user}", "gists_url": "https://api.github.com/users/edmorley/gists{/gist_id}", "starred_url": "https://api.github.com/users/edmorley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edmorley/subscriptions", "organizations_url": "https://api.github.com/users/edmorley/orgs", "repos_url": "https://api.github.com/users/edmorley/repos", "events_url": "https://api.github.com/users/edmorley/events{/privacy}", "received_events_url": "https://api.github.com/users/edmorley/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-06-18T09:48:47Z", "updated_at": "2015-07-11T08:46:46Z", "closed_at": "2015-07-11T08:46:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://github.com/celery/billiard/blob/master/CHANGES.txt does not include entries for 3.3.0.18, 3.3.0.19 and 3.3.0.20, unlike the changelog in the description here:\nhttps://pypi.python.org/pypi/billiard\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/163", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/163/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/163/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/163/events", "html_url": "https://github.com/celery/billiard/issues/163", "id": 88359744, "node_id": "MDU6SXNzdWU4ODM1OTc0NA==", "number": 163, "title": "Celery Kickstarter", "user": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars2.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-06-15T08:44:11Z", "updated_at": "2015-06-15T08:45:03Z", "closed_at": "2015-06-15T08:45:03Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "wrong repository.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/161", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/161/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/161/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/161/events", "html_url": "https://github.com/celery/billiard/issues/161", "id": 87993064, "node_id": "MDU6SXNzdWU4Nzk5MzA2NA==", "number": 161, "title": "Add a CI process for Windows", "user": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars2.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-06-13T12:00:26Z", "updated_at": "2015-12-09T06:09:13Z", "closed_at": "2015-12-08T22:33:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Since this project has some code paths that are Windows specific it is worthwhile to set up a CI process for Windows.\nI have enabled [appveyor](http://www.appveyor.com/) for this purpose but I have not written the build script yet.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/160", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/160/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/160/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/160/events", "html_url": "https://github.com/celery/billiard/issues/160", "id": 87931158, "node_id": "MDU6SXNzdWU4NzkzMTE1OA==", "number": 160, "title": "Travis-CI stopped working for this repository", "user": {"login": "thedrow", "id": 48936, "node_id": "MDQ6VXNlcjQ4OTM2", "avatar_url": "https://avatars2.githubusercontent.com/u/48936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thedrow", "html_url": "https://github.com/thedrow", "followers_url": "https://api.github.com/users/thedrow/followers", "following_url": "https://api.github.com/users/thedrow/following{/other_user}", "gists_url": "https://api.github.com/users/thedrow/gists{/gist_id}", "starred_url": "https://api.github.com/users/thedrow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thedrow/subscriptions", "organizations_url": "https://api.github.com/users/thedrow/orgs", "repos_url": "https://api.github.com/users/thedrow/repos", "events_url": "https://api.github.com/users/thedrow/events{/privacy}", "received_events_url": "https://api.github.com/users/thedrow/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-06-13T04:58:29Z", "updated_at": "2015-06-13T05:02:16Z", "closed_at": "2015-06-13T05:02:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I'm not sure why though.\n@ask Can you please reactivate it.\nIt seems that I can't for some reason.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/158", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/158/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/158/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/158/events", "html_url": "https://github.com/celery/billiard/issues/158", "id": 78004048, "node_id": "MDU6SXNzdWU3ODAwNDA0OA==", "number": 158, "title": "Celery workers halt on _recv", "user": {"login": "nihn", "id": 7430132, "node_id": "MDQ6VXNlcjc0MzAxMzI=", "avatar_url": "https://avatars1.githubusercontent.com/u/7430132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nihn", "html_url": "https://github.com/nihn", "followers_url": "https://api.github.com/users/nihn/followers", "following_url": "https://api.github.com/users/nihn/following{/other_user}", "gists_url": "https://api.github.com/users/nihn/gists{/gist_id}", "starred_url": "https://api.github.com/users/nihn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nihn/subscriptions", "organizations_url": "https://api.github.com/users/nihn/orgs", "repos_url": "https://api.github.com/users/nihn/repos", "events_url": "https://api.github.com/users/nihn/events{/privacy}", "received_events_url": "https://api.github.com/users/nihn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-05-19T09:08:36Z", "updated_at": "2015-06-17T07:21:53Z", "closed_at": "2015-06-15T07:25:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Sometimes our celery workers freeze at:\nhttps://github.com/celery/billiard/blob/master/billiard/pool.py#L417\nIt would be good to provide some kind of timeout here.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/156", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/156/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/156/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/156/events", "html_url": "https://github.com/celery/billiard/issues/156", "id": 72004674, "node_id": "MDU6SXNzdWU3MjAwNDY3NA==", "number": 156, "title": "timeout_callback not triggered for apply_async", "user": {"login": "benb42", "id": 12169274, "node_id": "MDQ6VXNlcjEyMTY5Mjc0", "avatar_url": "https://avatars0.githubusercontent.com/u/12169274?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benb42", "html_url": "https://github.com/benb42", "followers_url": "https://api.github.com/users/benb42/followers", "following_url": "https://api.github.com/users/benb42/following{/other_user}", "gists_url": "https://api.github.com/users/benb42/gists{/gist_id}", "starred_url": "https://api.github.com/users/benb42/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benb42/subscriptions", "organizations_url": "https://api.github.com/users/benb42/orgs", "repos_url": "https://api.github.com/users/benb42/repos", "events_url": "https://api.github.com/users/benb42/events{/privacy}", "received_events_url": "https://api.github.com/users/benb42/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-04-29T22:15:26Z", "updated_at": "2015-10-27T05:07:24Z", "closed_at": "2015-10-26T18:32:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "The timeout_callback does not seem to be working . In the following code the timeout of 3s works ok, but I don't get the callback triggered. Tried this with Billiard 3.3.0.20 on Windows 7 with Python 2.7.9 / 3.4 and Mac OS X 10.10.3 with Python 2.7.9.\n\n```\nimport billiard as mp\nimport time\nimport random\n\ndef fun_cube(x):\n    sleep_time = random.uniform(1,5)\n    time.sleep(sleep_time)\n\n    return x,x**3,sleep_time\n\ndef done(x):\n    print '\\nThe cube of %s is %s.' %(x[0],x[1])\n\ndef timeout():\n    print 'Timeout triggered!'\n\nif __name__ == '__main__':\n    pool = mp.Pool(processes=4)\n    for i in range(1,10):\n        pool.apply_async(func=fun_cube,args=(i,), callback=done, timeout_callback=timeout, timeout=3)\n    pool.close()\n    pool.join()\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/151", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/151/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/151/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/151/events", "html_url": "https://github.com/celery/billiard/issues/151", "id": 68803613, "node_id": "MDU6SXNzdWU2ODgwMzYxMw==", "number": 151, "title": "`BytesIO` object must use `getvalue`", "user": {"login": "jakirkham", "id": 3019665, "node_id": "MDQ6VXNlcjMwMTk2NjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakirkham", "html_url": "https://github.com/jakirkham", "followers_url": "https://api.github.com/users/jakirkham/followers", "following_url": "https://api.github.com/users/jakirkham/following{/other_user}", "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions", "organizations_url": "https://api.github.com/users/jakirkham/orgs", "repos_url": "https://api.github.com/users/jakirkham/repos", "events_url": "https://api.github.com/users/jakirkham/events{/privacy}", "received_events_url": "https://api.github.com/users/jakirkham/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-04-15T22:47:25Z", "updated_at": "2015-04-17T12:47:19Z", "closed_at": "2015-04-17T12:47:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Switch to using `getvalue` for `BytesIO` object as there is no `getbuffer`.\n\n```\nTraceback (most recent call last):\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/process.py\", line 124, in start\n    self._popen = self._Popen(self)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/context.py\", line 339, in _Popen\n    return Popen(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 38, in __init__\n    super(Popen, self).__init__(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_fork.py\", line 22, in __init__\n    self._launch(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 70, in _launch\n    os.write(parent_w, fp.getbuffer())\nAttributeError: '_io.BytesIO' object has no attribute 'getbuffer'\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/149", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/149/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/149/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/149/events", "html_url": "https://github.com/celery/billiard/issues/149", "id": 68801537, "node_id": "MDU6SXNzdWU2ODgwMTUzNw==", "number": 149, "title": "`os.pipe` returns file descriptors not filenames", "user": {"login": "jakirkham", "id": 3019665, "node_id": "MDQ6VXNlcjMwMTk2NjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakirkham", "html_url": "https://github.com/jakirkham", "followers_url": "https://api.github.com/users/jakirkham/followers", "following_url": "https://api.github.com/users/jakirkham/following{/other_user}", "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions", "organizations_url": "https://api.github.com/users/jakirkham/orgs", "repos_url": "https://api.github.com/users/jakirkham/repos", "events_url": "https://api.github.com/users/jakirkham/events{/privacy}", "received_events_url": "https://api.github.com/users/jakirkham/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-04-15T22:31:50Z", "updated_at": "2015-04-17T11:54:20Z", "closed_at": "2015-04-17T11:54:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Need to fix so that it properly converts file descriptors to file objects.\n\n```\nTraceback (most recent call last):\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/process.py\", line 124, in start\n    self._popen = self._Popen(self)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/context.py\", line 339, in _Popen\n    return Popen(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 38, in __init__\n    super(Popen, self).__init__(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_fork.py\", line 22, in __init__\n    self._launch(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 70, in _launch\n    with open(parent_w, 'wb', closefd=False) as f:\nTypeError: coercing to Unicode: need string or buffer, int found\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/147", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/147/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/147/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/147/events", "html_url": "https://github.com/celery/billiard/issues/147", "id": 68799370, "node_id": "MDU6SXNzdWU2ODc5OTM3MA==", "number": 147, "title": "Relative import error (easy fix)", "user": {"login": "jakirkham", "id": 3019665, "node_id": "MDQ6VXNlcjMwMTk2NjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakirkham", "html_url": "https://github.com/jakirkham", "followers_url": "https://api.github.com/users/jakirkham/followers", "following_url": "https://api.github.com/users/jakirkham/following{/other_user}", "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions", "organizations_url": "https://api.github.com/users/jakirkham/orgs", "repos_url": "https://api.github.com/users/jakirkham/repos", "events_url": "https://api.github.com/users/jakirkham/events{/privacy}", "received_events_url": "https://api.github.com/users/jakirkham/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-04-15T22:19:01Z", "updated_at": "2015-04-16T02:11:43Z", "closed_at": "2015-04-16T02:11:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Seems we are going up an extra level.\n\n```\nTraceback (most recent call last):\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/process.py\", line 124, in start\n    self._popen = self._Popen(self)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/context.py\", line 339, in _Popen\n    return Popen(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 38, in __init__\n    super(Popen, self).__init__(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_fork.py\", line 22, in __init__\n    self._launch(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 55, in _launch\n    reduction.dump(process_obj, fp)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/reduction.py\", line 93, in dump\n    ForkingPickler(file, protocol).dump(obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 224, in dump\n    self.save(obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 331, in save\n    self.save_reduce(obj=obj, *rv)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 419, in save_reduce\n    save(state)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 286, in save\n    f(self, obj) # Call unbound method with explicit self\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 649, in save_dict\n    self._batch_setitems(obj.iteritems())\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 663, in _batch_setitems\n    save(v)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 286, in save\n    f(self, obj) # Call unbound method with explicit self\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 562, in save_tuple\n    save(element)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 331, in save\n    self.save_reduce(obj=obj, *rv)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 419, in save_reduce\n    save(state)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 286, in save\n    f(self, obj) # Call unbound method with explicit self\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 562, in save_tuple\n    save(element)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/pickle.py\", line 286, in save\n    f(self, obj) # Call unbound method with explicit self\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/reduction.py\", line 73, in dispatcher\n    rv = reduce(obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/connection.py\", line 1006, in reduce_connection\n    df = reduction.DupFd(conn.fileno())\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/reduction.py\", line 224, in DupFd\n    from ..forking import Popen\nValueError: Attempted relative import beyond toplevel package\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/145", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/145/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/145/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/145/events", "html_url": "https://github.com/celery/billiard/issues/145", "id": 68794736, "node_id": "MDU6SXNzdWU2ODc5NDczNg==", "number": 145, "title": "AttributeError when trying to access `__spec__`", "user": {"login": "jakirkham", "id": 3019665, "node_id": "MDQ6VXNlcjMwMTk2NjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakirkham", "html_url": "https://github.com/jakirkham", "followers_url": "https://api.github.com/users/jakirkham/followers", "following_url": "https://api.github.com/users/jakirkham/following{/other_user}", "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions", "organizations_url": "https://api.github.com/users/jakirkham/orgs", "repos_url": "https://api.github.com/users/jakirkham/repos", "events_url": "https://api.github.com/users/jakirkham/events{/privacy}", "received_events_url": "https://api.github.com/users/jakirkham/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2015-04-15T21:51:25Z", "updated_at": "2018-07-18T06:53:58Z", "closed_at": "2015-04-17T12:47:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Maybe `__spec__` should be retrieved through `getattr` as well with a `None` returned on failure? If the real goal is to get the module's actual name, it might be better to use `__file__` and parse out the filename using `os.path.basename` and `os.path.splitext`. Just a thought.\n\n```\nTraceback (most recent call last):\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/process.py\", line 124, in start\n    self._popen = self._Popen(self)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/context.py\", line 339, in _Popen\n    return Popen(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 38, in __init__\n    super(Popen, self).__init__(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_fork.py\", line 22, in __init__\n    self._launch(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 50, in _launch\n    prep_data = spawn.get_preparation_data(process_obj._name)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/spawn.py\", line 262, in get_preparation_data\n    main_mod_name = getattr(main_module.__spec__, \"name\", None)\nAttributeError: 'module' object has no attribute '__spec__'\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/143", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/143/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/143/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/143/events", "html_url": "https://github.com/celery/billiard/issues/143", "id": 68789422, "node_id": "MDU6SXNzdWU2ODc4OTQyMg==", "number": 143, "title": "Context (ctx) being passed to Array by keyword argument is unexpected", "user": {"login": "jakirkham", "id": 3019665, "node_id": "MDQ6VXNlcjMwMTk2NjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakirkham", "html_url": "https://github.com/jakirkham", "followers_url": "https://api.github.com/users/jakirkham/followers", "following_url": "https://api.github.com/users/jakirkham/following{/other_user}", "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions", "organizations_url": "https://api.github.com/users/jakirkham/orgs", "repos_url": "https://api.github.com/users/jakirkham/repos", "events_url": "https://api.github.com/users/jakirkham/events{/privacy}", "received_events_url": "https://api.github.com/users/jakirkham/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2015-04-15T21:19:30Z", "updated_at": "2015-12-08T22:34:29Z", "closed_at": "2015-12-08T22:34:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I don't know if this is how the API works in Python 3.4. If so, the `ctx` argument should be handled somehow. If not, then maybe it shouldn't be passed?\n\n```\nTraceback (most recent call last):\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/context.py\", line 187, in Array\n    ctx=self.get_context())\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/sharedctypes.py\", line 91, in Array\n    'unrecognized keyword argument(s): %s' % list(kwds.keys()))\nValueError: unrecognized keyword argument(s): ['ctx']\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/142", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/142/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/142/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/142/events", "html_url": "https://github.com/celery/billiard/issues/142", "id": 68788435, "node_id": "MDU6SXNzdWU2ODc4ODQzNQ==", "number": 142, "title": "Error when starting a process (easy fix)", "user": {"login": "jakirkham", "id": 3019665, "node_id": "MDQ6VXNlcjMwMTk2NjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakirkham", "html_url": "https://github.com/jakirkham", "followers_url": "https://api.github.com/users/jakirkham/followers", "following_url": "https://api.github.com/users/jakirkham/following{/other_user}", "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions", "organizations_url": "https://api.github.com/users/jakirkham/orgs", "repos_url": "https://api.github.com/users/jakirkham/repos", "events_url": "https://api.github.com/users/jakirkham/events{/privacy}", "received_events_url": "https://api.github.com/users/jakirkham/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-04-15T21:14:11Z", "updated_at": "2015-04-17T12:50:07Z", "closed_at": "2015-04-17T12:50:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Ran into the following traceback when trying to run `p.start()` where `p` is a `billiard.Process` instance. As `sys.path` is a list, this should be easily corrected by doing `sys_path = sys.path[:]`.\n\n```\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/process.py\", line 124, in start\n    self._popen = self._Popen(self)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/context.py\", line 339, in _Popen\n    return Popen(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 38, in __init__\n    super(Popen, self).__init__(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_fork.py\", line 22, in __init__\n    self._launch(process_obj)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/popen_spawn_posix.py\", line 50, in _launch\n    prep_data = spawn.get_preparation_data(process_obj._name)\n  File \"/zopt/conda/envs/nanshenv/lib/python2.7/site-packages/billiard/spawn.py\", line 242, in get_preparation_data\n    sys_path = sys.path.copy()\nAttributeError: 'list' object has no attribute 'copy'\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/139", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/139/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/139/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/139/events", "html_url": "https://github.com/celery/billiard/issues/139", "id": 67606701, "node_id": "MDU6SXNzdWU2NzYwNjcwMQ==", "number": 139, "title": "\"No such file or directory\" error after upgrading Ubuntu", "user": {"login": "fern4lvarez", "id": 1381925, "node_id": "MDQ6VXNlcjEzODE5MjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/1381925?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fern4lvarez", "html_url": "https://github.com/fern4lvarez", "followers_url": "https://api.github.com/users/fern4lvarez/followers", "following_url": "https://api.github.com/users/fern4lvarez/following{/other_user}", "gists_url": "https://api.github.com/users/fern4lvarez/gists{/gist_id}", "starred_url": "https://api.github.com/users/fern4lvarez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fern4lvarez/subscriptions", "organizations_url": "https://api.github.com/users/fern4lvarez/orgs", "repos_url": "https://api.github.com/users/fern4lvarez/repos", "events_url": "https://api.github.com/users/fern4lvarez/events{/privacy}", "received_events_url": "https://api.github.com/users/fern4lvarez/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-04-10T14:21:45Z", "updated_at": "2015-04-15T08:13:46Z", "closed_at": "2015-04-15T08:13:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "We start celery workers inside Ubuntu 12.04 containers. Few days ago we decided to `dist-upgrade` the image the containers are based on, and when starting the celery worker, we found that billiard raised an `OSError` when Celery was starting-up.\n\nWe are using \n\n```\ncelery==3.1.17\nkombu==3.0.24\nbilliard==3.3.0.19\n```\n\n(among others) for this project.\n\nDoes anyone have a quick idea on why this happened? Here is the error trace, where you can also find more information about the celery worker. \n\n```\n/app/.paasprovider/python/lib/python2.7/site-packages/celery/apps/worker.py:161: CDeprecationWarning:\nStarting from version 3.2 Celery will refuse to accept pickle by default.\n\nThe pickle serializer is a security concern as it may give attackers\nthe ability to execute any command.  It's important to secure\nyour broker from unauthorized access when using pickle, so we think\nthat enabling pickle should require a deliberate action and not be\nthe default choice.\n\nIf you depend on pickle then you should set a setting to disable this\nwarning and to be sure that everything will continue working\nwhen you upgrade to Celery 3.2::\n\n    CELERY_ACCEPT_CONTENT = ['pickle', 'json', 'msgpack', 'yaml']\n\nYou must only enable the serializers that you will actually use.\n\n\n  warnings.warn(CDeprecationWarning(W_PICKLE_DEPRECATED))\n\n -------------- celery@depzrgh893w-16193 v3.1.17 (Cipater)\n---- **** -----\n--- * ***  * -- Linux-3.13.0-32-generic-x86_64-with-debian-wheezy-sid\n-- * - **** ---\n- ** ---------- [config]\n- ** ---------- .> app:         tasks:0x7fc3a778a4d0\n- ** ---------- .> transport:   sqla+mysql://root:...@....:3306/tasks\n- ** ---------- .> results:     disabled\n- *** --- * --- .> concurrency: 2 (prefork)\n-- ******* ----\n--- ***** ----- [queues]\n -------------- .> maintenance      exchange=maintenance(direct) key=maintenance\n                .> tasks            exchange=tasks(direct) key=tasks\n\n[tasks]\n  . app.tasks.add\n  . app.tasks.add_api_creds\n  . app.tasks.add_db_certificate\n  . app.tasks.backup_and_remove\n  . app.tasks.check_worker_life\n  . app.tasks.cleanup_kombu_message_table\n  . app.tasks.cleanup_old_db_dumps\n  . app.tasks.provision_db_instance\n  . app.tasks.remove\n  . app.tasks.update\n[2015-04-10 14:01:07,414: ERROR/MainProcess] Unrecoverable error: OSError(2, 'No such file or directory')\nTraceback (most recent call last):\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/celery/worker/__init__.py\", line 206, in start\n    self.blueprint.start(self)\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/celery/bootsteps.py\", line 123, in start\n    step.start(parent)\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/celery/bootsteps.py\", line 374, in start\n    return self.obj.start()\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/celery/concurrency/base.py\", line 131, in start\n    self.on_start()\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/celery/concurrency/prefork.py\", line 117, in on_start\n    **self.options)\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/billiard/pool.py\", line 925, in __init__\n    self._setup_queues()\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/billiard/pool.py\", line 1268, in _setup_queues\n    self._inqueue = SimpleQueue()\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/billiard/queues.py\", line 370, in __init__\n    self._rlock = Lock()\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/billiard/synchronize.py\", line 160, in __init__\n    SemLock.__init__(self, SEMAPHORE, 1, 1)\n  File \"/app/.paasprovider/python/lib/python2.7/site-packages/billiard/synchronize.py\", line 70, in __init__\n    kind, value, maxvalue, self._make_name(), unlink_immediately)\nOSError: [Errno 2] No such file or directory\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/135", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/135/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/135/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/135/events", "html_url": "https://github.com/celery/billiard/issues/135", "id": 53358603, "node_id": "MDU6SXNzdWU1MzM1ODYwMw==", "number": 135, "title": "AttributeError: 'module' object has no attribute 'SIGKILL' [ on Windows]", "user": {"login": "buendiya", "id": 3340700, "node_id": "MDQ6VXNlcjMzNDA3MDA=", "avatar_url": "https://avatars3.githubusercontent.com/u/3340700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/buendiya", "html_url": "https://github.com/buendiya", "followers_url": "https://api.github.com/users/buendiya/followers", "following_url": "https://api.github.com/users/buendiya/following{/other_user}", "gists_url": "https://api.github.com/users/buendiya/gists{/gist_id}", "starred_url": "https://api.github.com/users/buendiya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/buendiya/subscriptions", "organizations_url": "https://api.github.com/users/buendiya/orgs", "repos_url": "https://api.github.com/users/buendiya/repos", "events_url": "https://api.github.com/users/buendiya/events{/privacy}", "received_events_url": "https://api.github.com/users/buendiya/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-01-05T02:28:24Z", "updated_at": "2015-04-17T12:53:00Z", "closed_at": "2015-04-17T12:53:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using celery on Windows. And I set CELERYD_TASK_TIME_LIMIT to 1200. Depends on the document,  'The worker processing the task will be killed and replaced with a new one when this is exceeded.'\n\nBut when the executing time of my task exceeds the CELERYD_TASK_TIME_LIMIT setting, I got the following error:\n\n> [2015-01-04 12:56:27,994: ERROR/MainProcess] Thread 'TimeoutHandler' crashed: AttributeError(\"'module' object has no attribute 'SIGKILL'\",)\n> Traceback (most recent call last):\n>   File \"C:\\Python27\\lib\\site-packages\\billiard\\pool.py\", line 472, in run\n>     return self.body()\n>   File \"C:\\Python27\\lib\\site-packages\\billiard\\pool.py\", line 708, in body\n>     for _ in self.handle_timeouts():\n>   File \"C:\\Python27\\lib\\site-packages\\billiard\\pool.py\", line 699, in handle_timeouts\n>     on_hard_timeout(job)\n>   File \"C:\\Python27\\lib\\site-packages\\billiard\\pool.py\", line 653, in on_hard_timeout\n>     self._trywaitkill(process)\n>   File \"C:\\Python27\\lib\\site-packages\\billiard\\pool.py\", line 666, in _trywaitkill\n>     _kill(worker.pid, signal.SIGKILL)\n> AttributeError: 'module' object has no attribute 'SIGKILL'\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/133", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/133/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/133/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/133/events", "html_url": "https://github.com/celery/billiard/issues/133", "id": 51530851, "node_id": "MDU6SXNzdWU1MTUzMDg1MQ==", "number": 133, "title": "Subprocess import in util throw exception v3.4.0.0b1", "user": {"login": "PMickael", "id": 122271, "node_id": "MDQ6VXNlcjEyMjI3MQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/122271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PMickael", "html_url": "https://github.com/PMickael", "followers_url": "https://api.github.com/users/PMickael/followers", "following_url": "https://api.github.com/users/PMickael/following{/other_user}", "gists_url": "https://api.github.com/users/PMickael/gists{/gist_id}", "starred_url": "https://api.github.com/users/PMickael/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PMickael/subscriptions", "organizations_url": "https://api.github.com/users/PMickael/orgs", "repos_url": "https://api.github.com/users/PMickael/repos", "events_url": "https://api.github.com/users/PMickael/events{/privacy}", "received_events_url": "https://api.github.com/users/PMickael/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-12-10T08:26:05Z", "updated_at": "2014-12-18T18:56:40Z", "closed_at": "2014-12-18T18:56:40Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Hi,\n\nI would like to try latest version of celery and billiard but I get this error:\n`File \"/usr/local/lib/python2.7/dist-packages/billiard/util.py\", line 15, in <module>\n    from subprocess import _args_from_interpreter_flags  # noqa\nImportError: cannot import name _args_from_interpreter_flags`\n\nMickael\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/127", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/127/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/127/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/127/events", "html_url": "https://github.com/celery/billiard/issues/127", "id": 48501605, "node_id": "MDU6SXNzdWU0ODUwMTYwNQ==", "number": 127, "title": "Consider porting python 3.4 forkserver into billiard", "user": {"login": "jamescasbon", "id": 97495, "node_id": "MDQ6VXNlcjk3NDk1", "avatar_url": "https://avatars3.githubusercontent.com/u/97495?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamescasbon", "html_url": "https://github.com/jamescasbon", "followers_url": "https://api.github.com/users/jamescasbon/followers", "following_url": "https://api.github.com/users/jamescasbon/following{/other_user}", "gists_url": "https://api.github.com/users/jamescasbon/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamescasbon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamescasbon/subscriptions", "organizations_url": "https://api.github.com/users/jamescasbon/orgs", "repos_url": "https://api.github.com/users/jamescasbon/repos", "events_url": "https://api.github.com/users/jamescasbon/events{/privacy}", "received_events_url": "https://api.github.com/users/jamescasbon/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2014-11-12T11:46:31Z", "updated_at": "2015-04-17T12:53:41Z", "closed_at": "2015-04-17T12:53:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "There are quite a few people, including [Ipython notebook users](https://github.com/ipython/ipython/issues/6109) who could benefit from this [feature](https://docs.python.org/3/whatsnew/3.4.html#whatsnew-multiprocessing-no-fork).  Is billiard the right place for this?\n\nI note that [subprocess32](http://code.google.com/p/python-subprocess32/) already has the c extension backported that does the forking.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/125", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/125/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/125/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/125/events", "html_url": "https://github.com/celery/billiard/issues/125", "id": 46782178, "node_id": "MDU6SXNzdWU0Njc4MjE3OA==", "number": 125, "title": "Namespace issue when using exec() inside billiard.process() target", "user": {"login": "mike-lawrence", "id": 150781, "node_id": "MDQ6VXNlcjE1MDc4MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/150781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mike-lawrence", "html_url": "https://github.com/mike-lawrence", "followers_url": "https://api.github.com/users/mike-lawrence/followers", "following_url": "https://api.github.com/users/mike-lawrence/following{/other_user}", "gists_url": "https://api.github.com/users/mike-lawrence/gists{/gist_id}", "starred_url": "https://api.github.com/users/mike-lawrence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mike-lawrence/subscriptions", "organizations_url": "https://api.github.com/users/mike-lawrence/orgs", "repos_url": "https://api.github.com/users/mike-lawrence/repos", "events_url": "https://api.github.com/users/mike-lawrence/events{/privacy}", "received_events_url": "https://api.github.com/users/mike-lawrence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-10-24T20:49:15Z", "updated_at": "2014-10-24T23:31:30Z", "closed_at": "2014-10-24T23:31:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "If I have the following in a file called \"temp.py\"\n\n```\nimport math\ndef g():\n    print math.sqrt(1)\ng()\n```\n\nI can do `python temp.py` and get the expected printout `1`. However, if I additionally have the following in a file called \"runTemp.py\":\n\n```\ndef f():\n    execfile('temp.py')\nif __name__ == '__main__':\n    import billiard\n    billiard.forking_enable(0)\n    process = billiard.Process( target=f)\n    process.start()\n    while True:\n        pass\n```\n\nwhen I do `python runTemp.py` I get the error `NameError: global name 'math' is not defined`.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/124", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/124/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/124/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/124/events", "html_url": "https://github.com/celery/billiard/issues/124", "id": 46269402, "node_id": "MDU6SXNzdWU0NjI2OTQwMg==", "number": 124, "title": "soft time limit on Windows platform", "user": {"login": "CakeOfPiece", "id": 1422553, "node_id": "MDQ6VXNlcjE0MjI1NTM=", "avatar_url": "https://avatars2.githubusercontent.com/u/1422553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CakeOfPiece", "html_url": "https://github.com/CakeOfPiece", "followers_url": "https://api.github.com/users/CakeOfPiece/followers", "following_url": "https://api.github.com/users/CakeOfPiece/following{/other_user}", "gists_url": "https://api.github.com/users/CakeOfPiece/gists{/gist_id}", "starred_url": "https://api.github.com/users/CakeOfPiece/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CakeOfPiece/subscriptions", "organizations_url": "https://api.github.com/users/CakeOfPiece/orgs", "repos_url": "https://api.github.com/users/CakeOfPiece/repos", "events_url": "https://api.github.com/users/CakeOfPiece/events{/privacy}", "received_events_url": "https://api.github.com/users/CakeOfPiece/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-10-20T13:07:45Z", "updated_at": "2014-10-24T15:46:10Z", "closed_at": "2014-10-24T15:46:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi guys,\n\nSoft time limits are currently not supported on windows - it doesn't support SUGUSR1 signal, and unlikely ever will. Since soft time limits is a crucial feature for my application, i did a little research and here's what i found - if you create process and pass CREATE_NEW_PROCESS_GROUP flag in [creationflags arguments](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684863%28v=vs.85%29.aspx), you can [send signal.CTRL_BREAK_EVENT](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683155%28v=vs.85%29.aspx) to this process and it will be handled by signal.SIGBREAK handlers. \n\nCould this be possibly used in billiard as a solution for implementing soft time limits on windows?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/122", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/122/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/122/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/122/events", "html_url": "https://github.com/celery/billiard/issues/122", "id": 45226994, "node_id": "MDU6SXNzdWU0NTIyNjk5NA==", "number": 122, "title": "pool.restart() throw AttributeError exception", "user": {"login": "jackyfkc", "id": 8088318, "node_id": "MDQ6VXNlcjgwODgzMTg=", "avatar_url": "https://avatars2.githubusercontent.com/u/8088318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackyfkc", "html_url": "https://github.com/jackyfkc", "followers_url": "https://api.github.com/users/jackyfkc/followers", "following_url": "https://api.github.com/users/jackyfkc/following{/other_user}", "gists_url": "https://api.github.com/users/jackyfkc/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackyfkc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackyfkc/subscriptions", "organizations_url": "https://api.github.com/users/jackyfkc/orgs", "repos_url": "https://api.github.com/users/jackyfkc/repos", "events_url": "https://api.github.com/users/jackyfkc/events{/privacy}", "received_events_url": "https://api.github.com/users/jackyfkc/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-10-08T10:18:07Z", "updated_at": "2014-11-13T16:40:09Z", "closed_at": "2014-11-13T16:40:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "I found that pool.restart() does not work well under some circumstance.\n\nThe code written is quite simple, as following shown\n\n<pre><code>from billiard import pool\np = pool.Pool(4)\np.restart()\n</code></pre>\n\nAnd the exception is,\n\n<pre>Traceback (most recent call last):\n  File \"D:/workspace/demo/kombu_test.py\", line 4, in <module>\n    p.restart()\n  File \"C:\\Python27\\lib\\site-packages\\billiard\\pool.py\", line 1538, in restart\n    e.set()\nAttributeError: 'NoneType' object has no attribute 'set'</pre>\n\n\nThe related billiard source code are\n\n<pre><code>def restart(self):\n        for e in values(self._poolctrl):\n            e.set()\n</code></pre>\n\n\nDoes we need to test if the e is None at first?\n\n**Environement**\nVersion: '3.3.0.18'\nOS: Windows 7\nPython: 2.7\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/121", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/121/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/121/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/121/events", "html_url": "https://github.com/celery/billiard/issues/121", "id": 43257000, "node_id": "MDU6SXNzdWU0MzI1NzAwMA==", "number": 121, "title": "error using kwargs", "user": {"login": "mike-lawrence", "id": 150781, "node_id": "MDQ6VXNlcjE1MDc4MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/150781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mike-lawrence", "html_url": "https://github.com/mike-lawrence", "followers_url": "https://api.github.com/users/mike-lawrence/followers", "following_url": "https://api.github.com/users/mike-lawrence/following{/other_user}", "gists_url": "https://api.github.com/users/mike-lawrence/gists{/gist_id}", "starred_url": "https://api.github.com/users/mike-lawrence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mike-lawrence/subscriptions", "organizations_url": "https://api.github.com/users/mike-lawrence/orgs", "repos_url": "https://api.github.com/users/mike-lawrence/repos", "events_url": "https://api.github.com/users/mike-lawrence/events{/privacy}", "received_events_url": "https://api.github.com/users/mike-lawrence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2014-09-19T16:30:31Z", "updated_at": "2014-09-19T19:21:46Z", "closed_at": "2014-09-19T19:21:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Not sure if this is a bug, or simply a consequence of my poor understanding. Here's come code:\n\n```\ndef myFunction(aVariable,**kwargs):\n    print aVariable\n    print kwargs['anotherVariable']\nmyVariable = 'hello'\nmyKWArgs = {'anotherVariable':'goodbye'}\nmyFunction(aVariable=myVariable,**myKWArgs)\nif __name__ == '__main__': \n    import billiard\n    billiard.forking_enable(0)\n    myProcess = billiard.Process( target=myFunction , args=(myVariable),kwargs=(myKWArgs) )\n    myProcess.start()\n    while myProcess.is_alive():\n        pass\n    print 'all done'\n```\n\nIf run, I get the following output & error:\n\n```\nhello\ngoodbye\nhello\ngoodbye\nProcess Process-1:\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/site-packages/billiard/process.py\", line 292, in _bootstrap\n    self.run()\n  File \"/usr/local/lib/python2.7/site-packages/billiard/process.py\", line 123, in run\n    self._target(*self._args, **self._kwargs)\nTypeError: myFunction() takes exactly 1 argument (6 given)\nall done\n```\n\nSo, the call to myFunction runs fine the first time, when it is run in the main process, and it also appears to run fine the second time, when it is run in a child process, but for some reason  an error is thrown as the child process is dying. Noteably, however, the error doesn't crash the main process, as the final line is indeed printed. Any thoughts?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/118", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/118/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/118/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/118/events", "html_url": "https://github.com/celery/billiard/issues/118", "id": 39663455, "node_id": "MDU6SXNzdWUzOTY2MzQ1NQ==", "number": 118, "title": "git head unusable", "user": {"login": "cf-natali", "id": 8378227, "node_id": "MDQ6VXNlcjgzNzgyMjc=", "avatar_url": "https://avatars3.githubusercontent.com/u/8378227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cf-natali", "html_url": "https://github.com/cf-natali", "followers_url": "https://api.github.com/users/cf-natali/followers", "following_url": "https://api.github.com/users/cf-natali/following{/other_user}", "gists_url": "https://api.github.com/users/cf-natali/gists{/gist_id}", "starred_url": "https://api.github.com/users/cf-natali/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cf-natali/subscriptions", "organizations_url": "https://api.github.com/users/cf-natali/orgs", "repos_url": "https://api.github.com/users/cf-natali/repos", "events_url": "https://api.github.com/users/cf-natali/events{/privacy}", "received_events_url": "https://api.github.com/users/cf-natali/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2014-08-06T20:39:33Z", "updated_at": "2014-10-03T13:03:50Z", "closed_at": "2014-10-03T13:03:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using billiard git head, CPython 2.7:\n$ ./python -c \"from multiprocessing import Pool; p = Pool(); print(p.map(abs, range(10)))\"\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n$ ./python -c \"from billiard import Pool; p = Pool(); print(p.map(abs, range(10)))\"; echo $?\n1\n\nAfter commenting the - overzealous - except clause in PoolThread.run, one can see this:\nException in thread Thread-4:\nTraceback (most recent call last):\n  File \"/home/cf/python/hg/2.7/Lib/threading.py\", line 810, in __bootstrap_inner\n    self.run()\n  File \"/home/cf/billiard/billiard/pool.py\", line 472, in run\n    return self.body()\n  File \"/home/cf/billiard/billiard/pool.py\", line 836, in body\n    self.finish_at_shutdown()\n  File \"/home/cf/billiard/billiard/pool.py\", line 863, in finish_at_shutdown\n    on_state_change(task)\n  File \"/home/cf/billiard/billiard/pool.py\", line 785, in on_state_change\n    state_handlers[state](*args)\n  File \"/home/cf/billiard/billiard/pool.py\", line 751, in on_ack\n    cache[job]._ack(i, time_accepted, pid, synqW_fd)\nTypeError: _ack() takes exactly 4 arguments (5 given)\n\nIndeed, on ack reception, the code looks like this:\n        def on_ack(job, i, time_accepted, pid, synqW_fd):\n            restart_state.R = 0\n            try:\n                cache[job]._ack(i, time_accepted, pid, synqW_fd)\n            except (KeyError, AttributeError):\n                # Object gone or doesn't support _ack (e.g. IMAPIterator).\n                pass\n\nThe _ack method is supplied with 5 arguments, but MapResult's (and IMapIterator's) _ack only accept 4:\n    def _ack(self, i, time_accepted, pid):\n\nI don't know how this could ever work.\n\nAfter adding an extra 5th argument to MapResult._ack, it gets a little better:\n$ ./python -c \"from billiard import Pool; p = Pool(); print(p.map(abs, range(2)))\"\n[0, 1]\n\nBut let's try to increase the size of the iterable:\n./python -c \"from billiard import Pool; p = Pool(); print(p.map(abs, range(10)))\";\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\nException in thread Thread-4:\nTraceback (most recent call last):\n  File \"/home/cf/python/hg/2.7/Lib/threading.py\", line 810, in __bootstrap_inner\n    self.run()\n  File \"/home/cf/billiard/billiard/pool.py\", line 472, in run\n    return self.body()\n  File \"/home/cf/billiard/billiard/pool.py\", line 831, in body\n    for _ in self._process_result(1.0):  # blocking\n  File \"/home/cf/billiard/billiard/pool.py\", line 810, in _process_result\n    on_state_change(task)\n  File \"/home/cf/billiard/billiard/pool.py\", line 785, in on_state_change\n    state_handlers[state](*args)\n  File \"/home/cf/billiard/billiard/pool.py\", line 751, in on_ack\n    cache[job]._ack(i, time_accepted, pid, synqW_fd)\n  File \"/home/cf/billiard/billiard/pool.py\", line 1801, in _ack\n    self._accepted[j] = True\nIndexError: list assignment index out of range\n\nIndeed, in MapResult._ack:\n    def _ack(self, i, time_accepted, pid, *args):\n        start = i \\* self._chunksize\n        stop = (i + 1) \\* self._chunksize\n        for j in range(start, stop):\n            self._accepted[j] = True\n            self._worker_pid[j] = pid\n            self._time_accepted[j] = time_accepted\n        if self.ready():\n            self._cache.pop(self._job, None)\n\nThis will blow up it chunksize > 1, it should probably be:\n        start = i \\* self._chunksize\n        stop = min((i + 1) \\* self._chunksize, self._length)\n\nWith this, it works as expected:\n./python -c \"from billiard import Pool; p = Pool(); print(p.map(abs, range(10)))\"; echo $?\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n0\n\nAnd the list goes on.\n\nAm I missing something, or has noone ever used this version?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/114", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/114/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/114/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/114/events", "html_url": "https://github.com/celery/billiard/issues/114", "id": 35558748, "node_id": "MDU6SXNzdWUzNTU1ODc0OA==", "number": 114, "title": "Pipe() fails with Python 2.7.7 under Windows AMD64", "user": {"login": "tantale", "id": 6475294, "node_id": "MDQ6VXNlcjY0NzUyOTQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/6475294?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tantale", "html_url": "https://github.com/tantale", "followers_url": "https://api.github.com/users/tantale/followers", "following_url": "https://api.github.com/users/tantale/following{/other_user}", "gists_url": "https://api.github.com/users/tantale/gists{/gist_id}", "starred_url": "https://api.github.com/users/tantale/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tantale/subscriptions", "organizations_url": "https://api.github.com/users/tantale/orgs", "repos_url": "https://api.github.com/users/tantale/repos", "events_url": "https://api.github.com/users/tantale/events{/privacy}", "received_events_url": "https://api.github.com/users/tantale/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-06-12T08:18:34Z", "updated_at": "2014-06-20T13:09:51Z", "closed_at": "2014-06-20T13:09:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "Pipe() fails with Python 2.7.7 under Windows AMD64\n\n``` python\n>python -c \"from billiard.connection import Pipe; p = Pipe(duplex=False)\"\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"C:\\Python27\\lib\\site-packages\\billiard-3.3.0.17-py2.7-win32.egg\\billiard\\py2\\connection.py\", line 233, in Pipe\n    1, obsize, ibsize, win32.NMPWAIT_WAIT_FOREVER, win32.NULL\nWindowsError: [Error 123] La syntaxe du nom de fichier, de r\u00e9pertoire ou de volume est incorrecte\n```\n\nIn English, the message is: \"Error 123: The Filename, Directory Name, or Volume Label Syntax Is Incorrect\".\n\nHow to reproduce:\n- Install `python-2.7.7.msi`,\n- Download and run `ez_setup.py`,\n- Install `billiard`: `pip install billiard` or `easy_install billiard`.\n- Run: `python -c \"from billiard.connection import Pipe; p = Pipe(duplex=False)\"`\n\nMy configuration:\n\n``` python\n>python --version\nPython 2.7.7\n```\n\n``` python\n>python -c \"import platform; print(platform.uname())\"\n('Windows', 'L150LTLE', '7', '6.1.7601', 'AMD64', 'Intel64 Family 6 Model 60 Stepping 3, GenuineIntel')\n```\n\nI don't know if it is a `billiard` bug or a Python 2.7.7 bug...\n\nPipe() works well with the previous version Python 2.7.6 under Windows AMD64.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/111", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/111/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/111/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/111/events", "html_url": "https://github.com/celery/billiard/issues/111", "id": 34431753, "node_id": "MDU6SXNzdWUzNDQzMTc1Mw==", "number": 111, "title": "'Supervisor' object has no attribute '_children'", "user": {"login": "andresriancho", "id": 865200, "node_id": "MDQ6VXNlcjg2NTIwMA==", "avatar_url": "https://avatars0.githubusercontent.com/u/865200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andresriancho", "html_url": "https://github.com/andresriancho", "followers_url": "https://api.github.com/users/andresriancho/followers", "following_url": "https://api.github.com/users/andresriancho/following{/other_user}", "gists_url": "https://api.github.com/users/andresriancho/gists{/gist_id}", "starred_url": "https://api.github.com/users/andresriancho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andresriancho/subscriptions", "organizations_url": "https://api.github.com/users/andresriancho/orgs", "repos_url": "https://api.github.com/users/andresriancho/repos", "events_url": "https://api.github.com/users/andresriancho/events{/privacy}", "received_events_url": "https://api.github.com/users/andresriancho/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2014-05-28T03:02:59Z", "updated_at": "2016-05-08T01:41:51Z", "closed_at": "2014-06-20T13:13:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm running a rather complex celery task which is giving me this error:\n\n```\n'Supervisor' object has no attribute '_children'\n```\n\nIt seems to be related to http://bugs.python.org/issue14881 , and seems to make sense since `Supervisor` is a `threading.Thread` and is doing some stuff with pools.\n\nThese are my versions:\n\n```\ncelery==3.1.6\nbilliard==3.3.0.17\n```\n\nCelery is started using the following command:\n\n```\n/usr/local/bin/celery worker -A octopus -l info -Q scan,default --beat --no-color\n```\n\nAny ideas on how to better debug this? Have you seen it before? Workarounds? Fixes?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/110", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/110/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/110/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/110/events", "html_url": "https://github.com/celery/billiard/issues/110", "id": 33787453, "node_id": "MDU6SXNzdWUzMzc4NzQ1Mw==", "number": 110, "title": "Tests failures with python 3.4", "user": {"login": "rkuska", "id": 1709417, "node_id": "MDQ6VXNlcjE3MDk0MTc=", "avatar_url": "https://avatars3.githubusercontent.com/u/1709417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rkuska", "html_url": "https://github.com/rkuska", "followers_url": "https://api.github.com/users/rkuska/followers", "following_url": "https://api.github.com/users/rkuska/following{/other_user}", "gists_url": "https://api.github.com/users/rkuska/gists{/gist_id}", "starred_url": "https://api.github.com/users/rkuska/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rkuska/subscriptions", "organizations_url": "https://api.github.com/users/rkuska/orgs", "repos_url": "https://api.github.com/users/rkuska/repos", "events_url": "https://api.github.com/users/rkuska/events{/privacy}", "received_events_url": "https://api.github.com/users/rkuska/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-05-19T10:38:00Z", "updated_at": "2014-10-03T13:03:50Z", "closed_at": "2014-10-03T13:03:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Tests fail while building billiard with python3.4\n\n```\nTraceback (most recent call last):\n  File \"setup.py\", line 260, in <module>\n    run_setup(not (is_jython or is_pypy or is_py3k))\n  File \"setup.py\", line 256, in run_setup\n    **extras\n  File \"/usr/lib64/python3.4/distutils/core.py\", line 149, in setup\n    dist.run_commands()\n  File \"/usr/lib64/python3.4/distutils/dist.py\", line 955, in run_commands\n    self.run_command(cmd)\n  File \"/usr/lib64/python3.4/distutils/dist.py\", line 974, in run_command\n    cmd_obj.run()\n  File \"/usr/lib/python3.4/site-packages/setuptools/command/test.py\", line 138, in run\n    self.with_project_on_sys_path(self.run_tests)\n  File \"/usr/lib/python3.4/site-packages/setuptools/command/test.py\", line 118, in with_project_on_sys_path\n    func()\n  File \"/usr/lib/python3.4/site-packages/setuptools/command/test.py\", line 164, in run_tests\n    testLoader = cks\n  File \"/usr/lib64/python3.4/unittest/main.py\", line 93, in __init__\n    self.runTests()\n  File \"/usr/lib64/python3.4/unittest/main.py\", line 244, in runTests\n    self.result = testRunner.run(self.test)\n  File \"/usr/lib64/python3.4/unittest/runner.py\", line 168, in run\n    test(result)\n  File \"/usr/lib64/python3.4/unittest/suite.py\", line 87, in __call__\n    return self.run(*args, **kwds)\n  File \"/usr/lib64/python3.4/unittest/suite.py\", line 130, in run\n    self._removeTestAtIndex(index)\n  File \"/usr/lib64/python3.4/unittest/suite.py\", line 83, in _removeTestAtIndex\n    self._removed_tests += test.countTestCases()\n  File \"/usr/lib64/python3.4/unittest/suite.py\", line 44, in countTestCases\n    cases += test.countTestCases()\n  File \"/usr/lib64/python3.4/unittest/suite.py\", line 41, in countTestCases\n    cases = self._removed_tests\nAttributeError: 'ContextSuite' object has no attribute '_removed_tests'\n```\n\nThis looks like problem with nose nose-devs/nose#759\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/107", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/107/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/107/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/107/events", "html_url": "https://github.com/celery/billiard/issues/107", "id": 30244085, "node_id": "MDU6SXNzdWUzMDI0NDA4NQ==", "number": 107, "title": "Error starting Celery with Python 3.4 with MongoDB transport", "user": {"login": "paparomeo", "id": 305618, "node_id": "MDQ6VXNlcjMwNTYxOA==", "avatar_url": "https://avatars2.githubusercontent.com/u/305618?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paparomeo", "html_url": "https://github.com/paparomeo", "followers_url": "https://api.github.com/users/paparomeo/followers", "following_url": "https://api.github.com/users/paparomeo/following{/other_user}", "gists_url": "https://api.github.com/users/paparomeo/gists{/gist_id}", "starred_url": "https://api.github.com/users/paparomeo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paparomeo/subscriptions", "organizations_url": "https://api.github.com/users/paparomeo/orgs", "repos_url": "https://api.github.com/users/paparomeo/repos", "events_url": "https://api.github.com/users/paparomeo/events{/privacy}", "received_events_url": "https://api.github.com/users/paparomeo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-03-26T19:36:13Z", "updated_at": "2014-03-27T18:36:36Z", "closed_at": "2014-03-27T18:36:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "Starting Celery with `celery -b mongodb:// worker` in Python 3.4 results in the following error:\n\n```\n[2014-03-26 19:31:24,049: ERROR/MainProcess] Unrecoverable error: TypeError(\"Required argument 'name' (pos 4) not found\",)\nTraceback (most recent call last):\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/celery/worker/__init__.py\", line 206, in start\n    self.blueprint.start(self)\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/celery/bootsteps.py\", line 123, in start\n    step.start(parent)\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/celery/bootsteps.py\", line 373, in start\n    return self.obj.start()\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/celery/concurrency/base.py\", line 131, in start\n    self.on_start()\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/celery/concurrency/prefork.py\", line 117, in on_start\n    **self.options)\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/billiard/pool.py\", line 925, in __init__\n    self._setup_queues()\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/billiard/pool.py\", line 1266, in _setup_queues\n    self._inqueue = SimpleQueue()\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/billiard/queues.py\", line 370, in __init__\n    self._rlock = Lock()\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/billiard/synchronize.py\", line 156, in __init__\n    SemLock.__init__(self, SEMAPHORE, 1, 1)\n  File \"/Users/pmcnr/.virtualenvs/billiard-python-3.4/lib/python3.4/site-packages/billiard/synchronize.py\", line 68, in __init__\n    sl = self._semlock = _billiard.SemLock(kind, value, maxvalue)\nTypeError: Required argument 'name' (pos 4) not found\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/105", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/105/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/105/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/105/events", "html_url": "https://github.com/celery/billiard/issues/105", "id": 25920316, "node_id": "MDU6SXNzdWUyNTkyMDMxNg==", "number": 105, "title": "Build failure on NetBSD", "user": {"login": "ask", "id": 1558, "node_id": "MDQ6VXNlcjE1NTg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1558?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ask", "html_url": "https://github.com/ask", "followers_url": "https://api.github.com/users/ask/followers", "following_url": "https://api.github.com/users/ask/following{/other_user}", "gists_url": "https://api.github.com/users/ask/gists{/gist_id}", "starred_url": "https://api.github.com/users/ask/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ask/subscriptions", "organizations_url": "https://api.github.com/users/ask/orgs", "repos_url": "https://api.github.com/users/ask/repos", "events_url": "https://api.github.com/users/ask/events{/privacy}", "received_events_url": "https://api.github.com/users/ask/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2014-01-20T13:57:11Z", "updated_at": "2014-01-28T14:49:20Z", "closed_at": "2014-01-28T14:49:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": " http://ftp.netbsd.org/pub/pkgsrc/misc/joerg/20140104.1915/py26-billiard-3.3.0.13/install.log\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/104", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/104/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/104/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/104/events", "html_url": "https://github.com/celery/billiard/issues/104", "id": 25634744, "node_id": "MDU6SXNzdWUyNTYzNDc0NA==", "number": 104, "title": "Pool gets stuck if hard timeout hits on one or more workers", "user": {"login": "noxdafox", "id": 4214888, "node_id": "MDQ6VXNlcjQyMTQ4ODg=", "avatar_url": "https://avatars2.githubusercontent.com/u/4214888?v=4", "gravatar_id": "", "url": "https://api.github.com/users/noxdafox", "html_url": "https://github.com/noxdafox", "followers_url": "https://api.github.com/users/noxdafox/followers", "following_url": "https://api.github.com/users/noxdafox/following{/other_user}", "gists_url": "https://api.github.com/users/noxdafox/gists{/gist_id}", "starred_url": "https://api.github.com/users/noxdafox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/noxdafox/subscriptions", "organizations_url": "https://api.github.com/users/noxdafox/orgs", "repos_url": "https://api.github.com/users/noxdafox/repos", "events_url": "https://api.github.com/users/noxdafox/events{/privacy}", "received_events_url": "https://api.github.com/users/noxdafox/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2014-01-15T09:25:37Z", "updated_at": "2014-08-11T20:04:46Z", "closed_at": "2014-01-15T13:37:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "Greetings,\n\nI developed a service which runs heavy tasks in C code between a Pool of processes, as the tasks complexity might explode in some cases, the hard timeout feature is really useful for my use case as any signal different from SIGKILL would be ignored.\n\nWhile running I notice that sometimes the service gets silently stuck, CPU usage drops to 0 and all the workers seems idling.\n\nUsing gdb I managed to observe that the pool logic seems unable to read or to write anything from the Pipe (the SimpleQueues), this sounds weird as if the Pipe would be stuffed the writes would block but the reads would definitely succeed.\n\nMy guess is the following:\nWhen a SIGTERM or (especially) a SIGKILL are delivered, meanwhile the process is accessing the Pipe, the shared Lock used to protect the pipe might remain in a \"locked\" state.\n\nThis would explain why both put() and get() from the SimpleQueues are blocking and why I can spot this on gdb:\n\n  93        def **enter**(self):\n\n> 94            return self._semlock.__enter__()\n\nIt is clear that something is unable to acquire a lock.\n\nAt this point the service gets stuck in a deadlock situation from which I cannot easily recover as:\n- A terminate will not work as the sentinels won't be delivered to the workers and there seem not to be any timeout over such mechanism.\n- Trying to call release() on the SimpleQueues lock is blocking, probably on some other lock.\n- Calling restart() on the pool, as well, seems useless.\n\nThis bug is quite critical as, at the moment, the only way to get out seems to be a suicide of the service itself through an unmanaged exception.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/103", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/103/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/103/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/103/events", "html_url": "https://github.com/celery/billiard/issues/103", "id": 25563517, "node_id": "MDU6SXNzdWUyNTU2MzUxNw==", "number": 103, "title": "TypeError: authkey should be a byte string", "user": {"login": "aromanovich", "id": 891264, "node_id": "MDQ6VXNlcjg5MTI2NA==", "avatar_url": "https://avatars2.githubusercontent.com/u/891264?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aromanovich", "html_url": "https://github.com/aromanovich", "followers_url": "https://api.github.com/users/aromanovich/followers", "following_url": "https://api.github.com/users/aromanovich/following{/other_user}", "gists_url": "https://api.github.com/users/aromanovich/gists{/gist_id}", "starred_url": "https://api.github.com/users/aromanovich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aromanovich/subscriptions", "organizations_url": "https://api.github.com/users/aromanovich/orgs", "repos_url": "https://api.github.com/users/aromanovich/repos", "events_url": "https://api.github.com/users/aromanovich/events{/privacy}", "received_events_url": "https://api.github.com/users/aromanovich/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-01-14T10:03:50Z", "updated_at": "2014-01-14T12:14:15Z", "closed_at": "2014-01-14T11:12:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using billiard 3.3.0.13 with Python 2.7.6. The following code doesn't work:\n\n``` python\n>>> import billiard\n>>> manager = billiard.Manager()\n>>> queue = manager.Queue()\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/Volumes/Sources/Envs/celery/lib/python2.7/site-packages/billiard/managers.py\", line 655, in temp\n    token, exp = self._create(typeid, *args, **kwds)\n  File \"/Volumes/Sources/Envs/celery/lib/python2.7/site-packages/billiard/managers.py\", line 550, in _create\n    conn = self._Client(self._address, authkey=self._authkey)\n  File \"/Volumes/Sources/Envs/celery/lib/python2.7/site-packages/billiard/_connection.py\", line 179, in Client\n    raise TypeError('authkey should be a byte string')\nTypeError: authkey should be a byte string\n```\n\nThe culprit is `billiard.compat.bytes`. It's constructor returns built in `bytes` object, which is apparently is not an instance of `billiard.compat.bytes`:\n\n``` python\n>>> from billiard.compat import bytes\n>>> x = bytes('123')\n>>> type(x)\n<type 'str'>\n>>> isinstance(x, bytes)\nFalse\n```\n\nThis causes https://github.com/celery/billiard/blob/master/billiard/_connection.py#179 to be `True` even when `authkey` is a byte string.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/101", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/101/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/101/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/101/events", "html_url": "https://github.com/celery/billiard/issues/101", "id": 24731357, "node_id": "MDU6SXNzdWUyNDczMTM1Nw==", "number": 101, "title": "background celery worker segfaults ", "user": {"login": "robbyt", "id": 58051, "node_id": "MDQ6VXNlcjU4MDUx", "avatar_url": "https://avatars3.githubusercontent.com/u/58051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robbyt", "html_url": "https://github.com/robbyt", "followers_url": "https://api.github.com/users/robbyt/followers", "following_url": "https://api.github.com/users/robbyt/following{/other_user}", "gists_url": "https://api.github.com/users/robbyt/gists{/gist_id}", "starred_url": "https://api.github.com/users/robbyt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robbyt/subscriptions", "organizations_url": "https://api.github.com/users/robbyt/orgs", "repos_url": "https://api.github.com/users/robbyt/repos", "events_url": "https://api.github.com/users/robbyt/events{/privacy}", "received_events_url": "https://api.github.com/users/robbyt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2013-12-24T01:23:58Z", "updated_at": "2014-03-23T00:45:38Z", "closed_at": "2014-03-23T00:42:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am getting a segfault as soon as celery receives it's first task after launching. I think the problem is related to Billiard. I'm running Billiard 3.3.0.13, with Celery 3.1.7, on Ubuntu 13.04 x64, using the latest OS-supplied version of Python v.2.7.4.\n\nCelery only says:\n`Worker exited prematurely: signal 11 (SIGSEGV)`\nand\n`File \"/srv/virtualenv/current/local/lib/python2.7/site-packages/billiard/pool.py\", line 1167, in mark_as_worker_lost`\n\nCelery/Billiard does not segfault when run the foreground:\n\n`su celery -c '/srv/virtualenv/current/bin/python /srv/app/current/manage.py celery worker --workdir=/srv/app/current --pidfile=/var/run/celery/%n.pid --logfile=/var/log/celery/worker.log --loglevel=DEBUG --time-limit=1800 -B -s /var/run/celery/%n-celerybeat-schedule --concurrency=2 -E'`\n\nBut when I start the celery worker from the init script (the generic init script from celery 3.1.7) I get a segfault as soon as the worker receives a task:\n`[ 1145.070685] python[10747]: segfault at 0 ip 00000000004a4e97 sp 00007ffff08dacc0 error 6 in python[400000+239000]`\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/100", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/100/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/100/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/100/events", "html_url": "https://github.com/celery/billiard/issues/100", "id": 24396641, "node_id": "MDU6SXNzdWUyNDM5NjY0MQ==", "number": 100, "title": "load throws EOFError on windows", "user": {"login": "dafang", "id": 207689, "node_id": "MDQ6VXNlcjIwNzY4OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/207689?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dafang", "html_url": "https://github.com/dafang", "followers_url": "https://api.github.com/users/dafang/followers", "following_url": "https://api.github.com/users/dafang/following{/other_user}", "gists_url": "https://api.github.com/users/dafang/gists{/gist_id}", "starred_url": "https://api.github.com/users/dafang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dafang/subscriptions", "organizations_url": "https://api.github.com/users/dafang/orgs", "repos_url": "https://api.github.com/users/dafang/repos", "events_url": "https://api.github.com/users/dafang/events{/privacy}", "received_events_url": "https://api.github.com/users/dafang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2013-12-17T02:45:35Z", "updated_at": "2013-12-18T01:04:16Z", "closed_at": "2013-12-17T12:52:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "These days we are migrating our Celery to Windows platform, we found we cannot start our Celery worker and following exceptions thrown:\n\n``` python\nFile \"<string>\", line 1, in <module>\n  File \"C:\\worker\\env\\push\\lib\\site-packages\\billiard\\forking.py\", line 457, in main\n    self = load(from_parent)\n  File \"C:\\Python27\\Lib\\pickle.py\", line 1378, in load\n    return Unpickler(file).load()\n  File \"C:\\Python27\\Lib\\pickle.py\", line 858, in load\n    dispatch[key](self)\n  File \"C:\\Python27\\Lib\\pickle.py\", line 880, in load_eof\n    raise EOFError\n```\n\nI found some solutions most of them are saying to use the \"rb\" or \"wb\" mode when read/write file, but I saw the billiard has used this:\n\n``` python\nif sys.platform == 'win32':\n        fd = msvcrt.open_osfhandle(handle, os.O_RDONLY)\n    else:\n        fd = handle\n    from_parent = os.fdopen(fd, 'rb')\n```\n\nAny suggestions???\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/99", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/99/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/99/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/99/events", "html_url": "https://github.com/celery/billiard/issues/99", "id": 24094315, "node_id": "MDU6SXNzdWUyNDA5NDMxNQ==", "number": 99, "title": "_ack() takes exactly 4 arguments (5 given)", "user": {"login": "adriaant", "id": 71184, "node_id": "MDQ6VXNlcjcxMTg0", "avatar_url": "https://avatars0.githubusercontent.com/u/71184?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adriaant", "html_url": "https://github.com/adriaant", "followers_url": "https://api.github.com/users/adriaant/followers", "following_url": "https://api.github.com/users/adriaant/following{/other_user}", "gists_url": "https://api.github.com/users/adriaant/gists{/gist_id}", "starred_url": "https://api.github.com/users/adriaant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adriaant/subscriptions", "organizations_url": "https://api.github.com/users/adriaant/orgs", "repos_url": "https://api.github.com/users/adriaant/repos", "events_url": "https://api.github.com/users/adriaant/events{/privacy}", "received_events_url": "https://api.github.com/users/adriaant/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2013-12-11T09:11:35Z", "updated_at": "2014-07-23T15:20:05Z", "closed_at": "2013-12-11T15:14:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using packages:\nbilliard==3.3.0.12\ncelery==3.1.6\ndjango-celery==3.1.1\n\nRunning a task that uses a billard pool to spawn subtasks, I get the following exception.\n\n```\n[2013-12-11 09:59:46,438: ERROR/Worker-2] Thread 'ResultHandler' crashed: TypeError('_ack() takes exactly 4 arguments (5 given)',)\nTraceback (most recent call last):\n  File \"/data/home/splinkchecker/virtualenv-test/lib/python2.6/site-packages/billiard/pool.py\", line 469, in run\n    return self.body()\n  File \"/data/home/splinkchecker/virtualenv-test/lib/python2.6/site-packages/billiard/pool.py\", line 832, in body\n    for _ in self._process_result(1.0):  # blocking\n  File \"/data/home/splinkchecker/virtualenv-test/lib/python2.6/site-packages/billiard/pool.py\", line 811, in _process_result\n    on_state_change(task)\n  File \"/data/home/splinkchecker/virtualenv-test/lib/python2.6/site-packages/billiard/pool.py\", line 786, in on_state_change\n    state_handlers[state](*args)\n  File \"/data/home/splinkchecker/virtualenv-test/lib/python2.6/site-packages/billiard/pool.py\", line 752, in on_ack\n    cache[job]._ack(i, time_accepted, pid, synqW_fd)\nTypeError: _ack() takes exactly 4 arguments (5 given)\n```\n\nSample code that is invoked by celery:\n\n```\n        p = Pool(num_workers)\n        try:\n            p.map(processor, pages, max_size)\n            p.close()\n            p.join()\ntraceback.format_exc()))\n        finally:\n            p.terminate()\n```\n\nWhat could be wrong?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/92", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/92/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/92/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/92/events", "html_url": "https://github.com/celery/billiard/issues/92", "id": 23668366, "node_id": "MDU6SXNzdWUyMzY2ODM2Ng==", "number": 92, "title": "Add Python 3.3 to tox.ini", "user": {"login": "extesy", "id": 65872, "node_id": "MDQ6VXNlcjY1ODcy", "avatar_url": "https://avatars3.githubusercontent.com/u/65872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/extesy", "html_url": "https://github.com/extesy", "followers_url": "https://api.github.com/users/extesy/followers", "following_url": "https://api.github.com/users/extesy/following{/other_user}", "gists_url": "https://api.github.com/users/extesy/gists{/gist_id}", "starred_url": "https://api.github.com/users/extesy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/extesy/subscriptions", "organizations_url": "https://api.github.com/users/extesy/orgs", "repos_url": "https://api.github.com/users/extesy/repos", "events_url": "https://api.github.com/users/extesy/events{/privacy}", "received_events_url": "https://api.github.com/users/extesy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-12-03T19:45:09Z", "updated_at": "2015-06-13T05:10:04Z", "closed_at": "2015-06-13T05:10:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Billiard is used in celery which officially supports python 3.3, therefore billiard must support python 3.3 as well. It looks like it often has issues after each update related to python 3.3 compatibility and it will help to detect that automatically.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/91", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/91/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/91/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/91/events", "html_url": "https://github.com/celery/billiard/issues/91", "id": 23661018, "node_id": "MDU6SXNzdWUyMzY2MTAxOA==", "number": 91, "title": "C Extension wont build in Python 3.3", "user": {"login": "circlingthesun", "id": 1028632, "node_id": "MDQ6VXNlcjEwMjg2MzI=", "avatar_url": "https://avatars0.githubusercontent.com/u/1028632?v=4", "gravatar_id": "", "url": "https://api.github.com/users/circlingthesun", "html_url": "https://github.com/circlingthesun", "followers_url": "https://api.github.com/users/circlingthesun/followers", "following_url": "https://api.github.com/users/circlingthesun/following{/other_user}", "gists_url": "https://api.github.com/users/circlingthesun/gists{/gist_id}", "starred_url": "https://api.github.com/users/circlingthesun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/circlingthesun/subscriptions", "organizations_url": "https://api.github.com/users/circlingthesun/orgs", "repos_url": "https://api.github.com/users/circlingthesun/repos", "events_url": "https://api.github.com/users/circlingthesun/events{/privacy}", "received_events_url": "https://api.github.com/users/circlingthesun/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-12-03T17:58:59Z", "updated_at": "2013-12-09T13:17:40Z", "closed_at": "2013-12-09T13:17:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm getting the following traceback:\n\n```\nTraceback (most recent call last):\n       File \"/srv/venv/bookem/build/billiard/setup.py\", line 249, in <module>\n         run_setup(not (is_jython or is_pypy or is_py3k))\n       File \"/srv/venv/bookem/build/billiard/setup.py\", line 245, in run_setup\n         **extras\n       File \"/usr/lib/python3.3/distutils/core.py\", line 148, in setup\n         dist.run_commands()\n       File \"/usr/lib/python3.3/distutils/dist.py\", line 929, in run_commands\n         self.run_command(cmd)\n       File \"/usr/lib/python3.3/distutils/dist.py\", line 948, in run_command\n         cmd_obj.run()\n       File \"<string>\", line 13, in replacement_run\n       File \"/srv/venv/bookem/lib/python3.3/site-packages/distribute-0.6.34-py3.3.egg/setuptools/command/egg_info.py\", line 413, in write_pkg_info\n         metadata.write_pkg_info(cmd.egg_info)\n       File \"/usr/lib/python3.3/distutils/dist.py\", line 1027, in write_pkg_info\n         self.write_pkg_file(pkg_info)\n       File \"/usr/lib/python3.3/distutils/dist.py\", line 1048, in write_pkg_file\n         long_desc = rfc822_escape(self.get_long_description())\n       File \"/usr/lib/python3.3/distutils/util.py\", line 490, in rfc822_escape\n         lines = header.split('\\n')\n     TypeError: Type str doesn't support the buffer API\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/89", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/89/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/89/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/89/events", "html_url": "https://github.com/celery/billiard/issues/89", "id": 23619166, "node_id": "MDU6SXNzdWUyMzYxOTE2Ng==", "number": 89, "title": "Can't install billiard 3.3.0.10", "user": {"login": "extesy", "id": 65872, "node_id": "MDQ6VXNlcjY1ODcy", "avatar_url": "https://avatars3.githubusercontent.com/u/65872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/extesy", "html_url": "https://github.com/extesy", "followers_url": "https://api.github.com/users/extesy/followers", "following_url": "https://api.github.com/users/extesy/following{/other_user}", "gists_url": "https://api.github.com/users/extesy/gists{/gist_id}", "starred_url": "https://api.github.com/users/extesy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/extesy/subscriptions", "organizations_url": "https://api.github.com/users/extesy/orgs", "repos_url": "https://api.github.com/users/extesy/repos", "events_url": "https://api.github.com/users/extesy/events{/privacy}", "received_events_url": "https://api.github.com/users/extesy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2013-12-03T03:29:06Z", "updated_at": "2013-12-03T17:55:23Z", "closed_at": "2013-12-03T17:33:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Windows 7 x64, Python 3.3\n\n```\nDownloading/unpacking billiard>=3.3.0.10,<3.4 (from celery[redis])\n  Downloading billiard-3.3.0.10.tar.gz (147kB): 147kB downloaded\n  Running setup.py egg_info for package billiard\n\n    warning: no files found matching '*.py' under directory 'Lib'\nCleaning up...\n  Exception:\nTraceback (most recent call last):\n  File \"D:\\Projects\\Web\\stuff\\backend\\lib\\site-packages\\pip\\commands\\install.py\", line 236, in run\n    requirement_set.prepare_files(finder, force_root_egg_info=self.bundle, bundle=self.bundle)\n  File \"D:\\Projects\\Web\\stuff\\backend\\lib\\site-packages\\pip\\req.py\", line 1139, in prepare_files\n    req_to_install.assert_source_matches_version()\n  File \"D:\\Projects\\Web\\stuff\\backend\\lib\\site-packages\\pip\\req.py\", line 394, in assert_source_matches_version\n    version = self.installed_version\n  File \"D:\\Projects\\Web\\stuff\\backend\\lib\\site-packages\\pip\\req.py\", line 390, in installed_version\n    return self.pkg_info()['version']\n  File \"D:\\Projects\\Web\\stuff\\backend\\lib\\site-packages\\pip\\req.py\", line 357, in pkg_info\n    data = self.egg_info_data('PKG-INFO')\n  File \"D:\\Projects\\Web\\stuff\\backend\\lib\\site-packages\\pip\\req.py\", line 297, in egg_info_data\n    data = fp.read()\n  File \"\\Dev\\Python3\\lib\\encodings\\cp1251.py\", line 23, in decode\n    return codecs.charmap_decode(input,self.errors,decoding_table)[0]\nUnicodeDecodeError: 'charmap' codec can't decode byte 0x98 in position 2523: character maps to <undefined>\n```\n\nPrevious version (from celery 3.1.5) installed fine.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/86", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/86/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/86/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/86/events", "html_url": "https://github.com/celery/billiard/issues/86", "id": 22846628, "node_id": "MDU6SXNzdWUyMjg0NjYyOA==", "number": 86, "title": "forking_enable causes hang on OS X", "user": {"login": "mike-lawrence", "id": 150781, "node_id": "MDQ6VXNlcjE1MDc4MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/150781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mike-lawrence", "html_url": "https://github.com/mike-lawrence", "followers_url": "https://api.github.com/users/mike-lawrence/followers", "following_url": "https://api.github.com/users/mike-lawrence/following{/other_user}", "gists_url": "https://api.github.com/users/mike-lawrence/gists{/gist_id}", "starred_url": "https://api.github.com/users/mike-lawrence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mike-lawrence/subscriptions", "organizations_url": "https://api.github.com/users/mike-lawrence/orgs", "repos_url": "https://api.github.com/users/mike-lawrence/repos", "events_url": "https://api.github.com/users/mike-lawrence/events{/privacy}", "received_events_url": "https://api.github.com/users/mike-lawrence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-11-18T16:05:43Z", "updated_at": "2013-11-20T16:58:54Z", "closed_at": "2013-11-20T16:58:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "If I try to do `forking_enable(0)` on my OS 10.9 machine (python 2.7.5), I get a hang. For example:\n\n```\nimport billiard\n\ndef loop():\n    print 'ok'\n    while True:\n        pass\n\n# billiard.forking_enable(0)\nprocess = billiard.Process(target=loop)\nprocess.start()\nwhile True: pass\n```\n\nIf you leave the line `# billiard.forking_enable(0)` as is, it runs fine, but if you uncomment, the script hangs. If you get rid of the `while True: pass` bit, 'ok' keeps printing, suggesting that billiard is running `loop()` repeatedly for some reason. Also, if you do the following instead, the hang doesn't happen:\n\n```\nimport billiard\n\ndef loop():\n    print 'ok'\n    while True: pass\n\nif __name__ == '__main__':\n    billiard.forking_enable(0)\n    process = billiard.Process(target=loop)\n    process.start()\n    while True: pass\n```\n\n_But_, if you put `while True: pass` after and outside the `if __name__ == '__main__':` block, the hang is back.\n\nCurious!\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/84", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/84/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/84/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/84/events", "html_url": "https://github.com/celery/billiard/issues/84", "id": 22778728, "node_id": "MDU6SXNzdWUyMjc3ODcyOA==", "number": 84, "title": "forking_enable with PySDL2 on OS X", "user": {"login": "mike-lawrence", "id": 150781, "node_id": "MDQ6VXNlcjE1MDc4MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/150781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mike-lawrence", "html_url": "https://github.com/mike-lawrence", "followers_url": "https://api.github.com/users/mike-lawrence/followers", "following_url": "https://api.github.com/users/mike-lawrence/following{/other_user}", "gists_url": "https://api.github.com/users/mike-lawrence/gists{/gist_id}", "starred_url": "https://api.github.com/users/mike-lawrence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mike-lawrence/subscriptions", "organizations_url": "https://api.github.com/users/mike-lawrence/orgs", "repos_url": "https://api.github.com/users/mike-lawrence/repos", "events_url": "https://api.github.com/users/mike-lawrence/events{/privacy}", "received_events_url": "https://api.github.com/users/mike-lawrence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2013-11-16T14:35:53Z", "updated_at": "2013-11-18T15:57:55Z", "closed_at": "2013-11-18T15:57:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to run both PySDL2 and OpenCV in a separate process, and find that while OpenCV needs `forking_enable(0)` to be called (if you want to read from a usb webcam at least, see: http://stackoverflow.com/questions/18381560/opencv-crash-on-os-x-when-reading-usb-cam-in-separate-process), it seems that PySDL2 doesn't work with `forking_enable(0)`. Any suggestions? Demo code would be:\n\n```\ndef loop():\n    import sdl2\n    import sdl2.ext\n    sdl2.SDL_Init(sdl2.SDL_INIT_VIDEO)\n    window = sdl2.ext.Window(\"test\", size=(800,600),position=(0,0),flags=sdl2.SDL_WINDOW_SHOWN)\n    window.refresh()\n    while True:\n        sdl2.SDL_PumpEvents()\n\nimport billiard\nbilliard.forking_enable(0)\nprocess = billiard.Process( target=loop )\nprocess.start()\nwhile True:\n    pass\n```\n\nIf you comment out `billiard.forking_enable(0)`, the code runs fine and an SDL2 window appears, but leaving `billiard.forking_enable(0)` uncommented yields no window and max CPU use.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/83", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/83/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/83/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/83/events", "html_url": "https://github.com/celery/billiard/issues/83", "id": 22772106, "node_id": "MDU6SXNzdWUyMjc3MjEwNg==", "number": 83, "title": "Errors when used in a module", "user": {"login": "mike-lawrence", "id": 150781, "node_id": "MDQ6VXNlcjE1MDc4MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/150781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mike-lawrence", "html_url": "https://github.com/mike-lawrence", "followers_url": "https://api.github.com/users/mike-lawrence/followers", "following_url": "https://api.github.com/users/mike-lawrence/following{/other_user}", "gists_url": "https://api.github.com/users/mike-lawrence/gists{/gist_id}", "starred_url": "https://api.github.com/users/mike-lawrence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mike-lawrence/subscriptions", "organizations_url": "https://api.github.com/users/mike-lawrence/orgs", "repos_url": "https://api.github.com/users/mike-lawrence/repos", "events_url": "https://api.github.com/users/mike-lawrence/events{/privacy}", "received_events_url": "https://api.github.com/users/mike-lawrence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-11-16T04:21:27Z", "updated_at": "2013-11-16T14:30:30Z", "closed_at": "2013-11-16T14:30:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to use billiard to manage queues and processes inside a class which in turn is inside a module. So I have the folder `myModule` inside of which is the file`__init__.py` containing the code:\n\n```\nclass myClass:\n    def __init__(self):\n        import billiard\n        billiard.forking_enable(0)\n        manager = billiard.Manager()\n        manager.start()\n        self.q = manager.Queue()\n        self.process = billiard.Process( target=loop , args=(self.q,) )\n        self.process.start()\n        return None\n\ndef loop(q):\n    while True:\n        pass\n```\n\nWhen I try to use this module and class in a separate file with the code:\n\n```\nimport myModule\nthis = myModule.myClass()\nwhile True:\n    pass\n```\n\nI get the errors logged here: https://gist.github.com/mike-lawrence/7495890\n\nAny suggestions?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/82", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/82/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/82/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/82/events", "html_url": "https://github.com/celery/billiard/issues/82", "id": 22771558, "node_id": "MDU6SXNzdWUyMjc3MTU1OA==", "number": 82, "title": "forking crash", "user": {"login": "mike-lawrence", "id": 150781, "node_id": "MDQ6VXNlcjE1MDc4MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/150781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mike-lawrence", "html_url": "https://github.com/mike-lawrence", "followers_url": "https://api.github.com/users/mike-lawrence/followers", "following_url": "https://api.github.com/users/mike-lawrence/following{/other_user}", "gists_url": "https://api.github.com/users/mike-lawrence/gists{/gist_id}", "starred_url": "https://api.github.com/users/mike-lawrence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mike-lawrence/subscriptions", "organizations_url": "https://api.github.com/users/mike-lawrence/orgs", "repos_url": "https://api.github.com/users/mike-lawrence/repos", "events_url": "https://api.github.com/users/mike-lawrence/events{/privacy}", "received_events_url": "https://api.github.com/users/mike-lawrence/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-11-16T03:30:21Z", "updated_at": "2013-11-16T03:36:31Z", "closed_at": "2013-11-16T03:36:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I'm running v3.3.0.7 on OS 10.9 via the default Python 2.7.5, and when I run the following code, I get the error printed below:\n\n> > > import billiard\n> > > def f():\n> > > ...  while True:\n> > > ...   pass\n> > > ... \n> > > billiard.forking_enable(0)\n> > > p = billiard.Process(target=f)\n> > > p.start()\n> > > Traceback (most recent call last):\n> > >   File \"<string>\", line 1, in <module>\n> > >   File \"billiard/forking.py\", line 433, in main\n> > >     os.environ[\"MP_MAIN_FILE\"] = sys.modules[\"**main**\"].**file**\n> > > AttributeError: 'module' object has no attribute '**file**'\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/78", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/78/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/78/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/78/events", "html_url": "https://github.com/celery/billiard/issues/78", "id": 22593461, "node_id": "MDU6SXNzdWUyMjU5MzQ2MQ==", "number": 78, "title": "PyPy 2.1: ImportError: pickling of connections not supported", "user": {"login": "OOPMan", "id": 248980, "node_id": "MDQ6VXNlcjI0ODk4MA==", "avatar_url": "https://avatars1.githubusercontent.com/u/248980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OOPMan", "html_url": "https://github.com/OOPMan", "followers_url": "https://api.github.com/users/OOPMan/followers", "following_url": "https://api.github.com/users/OOPMan/following{/other_user}", "gists_url": "https://api.github.com/users/OOPMan/gists{/gist_id}", "starred_url": "https://api.github.com/users/OOPMan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OOPMan/subscriptions", "organizations_url": "https://api.github.com/users/OOPMan/orgs", "repos_url": "https://api.github.com/users/OOPMan/repos", "events_url": "https://api.github.com/users/OOPMan/events{/privacy}", "received_events_url": "https://api.github.com/users/OOPMan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-11-13T14:15:14Z", "updated_at": "2013-11-13T15:04:03Z", "closed_at": "2013-11-13T15:01:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've been trying to use Celery 3.1.1 with PyPy 2.1 and ran into the following issue:\n\n```\n/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/bin/pypy-c /home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/bin/celery -A recomed.celery worker -l info\nTraceback (most recent call last):\n  File \"app_main.py\", line 72, in run_toplevel\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/bin/celery\", line 9, in <module>\n    load_entry_point('celery==3.1.3', 'console_scripts', 'celery')()\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/__main__.py\", line 29, in main\n    main()\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/bin/celery.py\", line 80, in main\n    cmd.execute_from_commandline(argv)\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/bin/celery.py\", line 723, in execute_from_commandline\n    super(CeleryCommand, self).execute_from_commandline(argv)))\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/bin/base.py\", line 301, in execute_from_commandline\n    return self.handle_argv(self.prog_name, argv[1:])\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/bin/celery.py\", line 715, in handle_argv\n    return self.execute(command, argv)\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/bin/celery.py\", line 671, in execute\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/bin/worker.py\", line 173, in run_from_argv\n    return self(*args, **options)\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/bin/base.py\", line 264, in __call__\n    ret = self.run(*args, **kwargs)\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/bin/worker.py\", line 186, in run\n    pool_cls = (concurrency.get_implementation(pool_cls) or\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/concurrency/__init__.py\", line 29, in get_implementation\n    return symbol_by_name(cls, ALIASES)\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/kombu/utils/__init__.py\", line 90, in symbol_by_name\n    module = imp(module_name, package=package, **kwargs)\n  File \"/home/adamj/Development/Tools/Python/Interpreters/pypy/pypy-2.1/x86_64/lib-python/2.7/importlib/__init__.py\", line 37, in import_module\n    __import__(name)\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/celery/concurrency/prefork.py\", line 15, in <module>\n    from billiard.pool import RUN, CLOSE, Pool as BlockingPool\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/billiard/pool.py\", line 1894, in <module>\n    class ThreadPool(Pool):\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/billiard/pool.py\", line 1896, in ThreadPool\n    from billiard.dummy import Process as DummyProcess\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/billiard/dummy/__init__.py\", line 56, in <module>\n    from billiard.connection import Pipe\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/billiard/connection.py\", line 10, in <module>\n    from . import _connection as connection  # noqa\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/billiard/_connection.py\", line 23, in <module>\n    from . import reduction\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/billiard/reduction.py\", line 8, in <module>\n    from . import _reduction as reduction  # noqa\n  File \"/home/adamj/Development/Tools/Python/VirtualEnv/x86_64/pypy-2.1/site-packages/billiard/_reduction.py\", line 27, in <module>\n    raise ImportError('pickling of connections not supported')\nImportError: pickling of connections not supported\n```\n\nThat lead to to: https://bugs.pypy.org/issue1558\n\nI'm not sure if there is any way to get around this?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/77", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/77/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/77/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/77/events", "html_url": "https://github.com/celery/billiard/issues/77", "id": 22496122, "node_id": "MDU6SXNzdWUyMjQ5NjEyMg==", "number": 77, "title": "Unable to Install 3.3.0.5 on Windows", "user": {"login": "chrisw1229", "id": 1657910, "node_id": "MDQ6VXNlcjE2NTc5MTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1657910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrisw1229", "html_url": "https://github.com/chrisw1229", "followers_url": "https://api.github.com/users/chrisw1229/followers", "following_url": "https://api.github.com/users/chrisw1229/following{/other_user}", "gists_url": "https://api.github.com/users/chrisw1229/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrisw1229/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrisw1229/subscriptions", "organizations_url": "https://api.github.com/users/chrisw1229/orgs", "repos_url": "https://api.github.com/users/chrisw1229/repos", "events_url": "https://api.github.com/users/chrisw1229/events{/privacy}", "received_events_url": "https://api.github.com/users/chrisw1229/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-11-12T03:49:22Z", "updated_at": "2013-11-12T19:20:03Z", "closed_at": "2013-11-12T19:20:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've seen this error/warning in previous versions, but as of 3.3.0.5 pip does not continue with the install and instead rolls it back. I tested forcing pip to use version 3.3.0.4 and it does continue after the warning successfully.\n\n``` bat\nerror: Unable to find vcvarsall.bat\n\n----------------------------------------\n  Rolling back uninstall of billiard\nCleaning up...\nCommand python.exe -c \"import setuptools;__file__='build\\\\billiard\\\\setup.py';exec(compile(open(__file__).read().replace('\\r\\n', '\\n'), __file__, 'exec'))\" install  -record temp\\pip-kcfwov-record\\install-record.txt --single-version-externally-managed --install-headers include\\site\\python2.7 failed with error code 1 in build\\billiard\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/75", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/75/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/75/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/75/events", "html_url": "https://github.com/celery/billiard/issues/75", "id": 20996849, "node_id": "MDU6SXNzdWUyMDk5Njg0OQ==", "number": 75, "title": "3.3.0.0 breaks calling tasks from within tasks", "user": {"login": "dustinfarris", "id": 1087165, "node_id": "MDQ6VXNlcjEwODcxNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1087165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dustinfarris", "html_url": "https://github.com/dustinfarris", "followers_url": "https://api.github.com/users/dustinfarris/followers", "following_url": "https://api.github.com/users/dustinfarris/following{/other_user}", "gists_url": "https://api.github.com/users/dustinfarris/gists{/gist_id}", "starred_url": "https://api.github.com/users/dustinfarris/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dustinfarris/subscriptions", "organizations_url": "https://api.github.com/users/dustinfarris/orgs", "repos_url": "https://api.github.com/users/dustinfarris/repos", "events_url": "https://api.github.com/users/dustinfarris/events{/privacy}", "received_events_url": "https://api.github.com/users/dustinfarris/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2013-10-15T05:04:29Z", "updated_at": "2013-11-04T14:53:33Z", "closed_at": "2013-11-04T14:53:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a scheduler that runs a task at a set interval:\n\n``` python\n@task(ignore_result=True)\ndef update_all_items():\n    for item in items_list:\n        update_item.delay(item)\n\n@task(ignore_result=True)\ndef update_item(item):\n    do_stuff()\n```\n\nThe \"master\" task gets run by celery beat, but the child tasks do not get run at all.  This was working prior to Oct 14 on version 2.7.3.34.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/72", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/72/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/72/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/72/events", "html_url": "https://github.com/celery/billiard/issues/72", "id": 18435250, "node_id": "MDU6SXNzdWUxODQzNTI1MA==", "number": 72, "title": "Compiling fails on Windows even with installed compiler", "user": {"login": "mrtizmo", "id": 2684347, "node_id": "MDQ6VXNlcjI2ODQzNDc=", "avatar_url": "https://avatars0.githubusercontent.com/u/2684347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrtizmo", "html_url": "https://github.com/mrtizmo", "followers_url": "https://api.github.com/users/mrtizmo/followers", "following_url": "https://api.github.com/users/mrtizmo/following{/other_user}", "gists_url": "https://api.github.com/users/mrtizmo/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrtizmo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrtizmo/subscriptions", "organizations_url": "https://api.github.com/users/mrtizmo/orgs", "repos_url": "https://api.github.com/users/mrtizmo/repos", "events_url": "https://api.github.com/users/mrtizmo/events{/privacy}", "received_events_url": "https://api.github.com/users/mrtizmo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-08-22T19:49:07Z", "updated_at": "2013-08-31T13:52:00Z", "closed_at": "2013-08-31T13:52:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "The host is WinXP SP3. Python 2.7.5 for x86.\n\nWhen using pip to install celery, everything completes, but I am getting a warning from billiard stating that \"The C extensions could not be compiled\". I'm using the mingw compiler as you can see from the first few lines of the output.\n\nHere is the line that is downloading billiard:\n\n``` bash\nDownloading/unpacking billiard>=2.7.3.32,<3.0 (from celery->-r PACKAGES.pip (line 1))\n  Downloading billiard-2.7.3.32.tar.gz (134kB): 134kB downloaded\n  Running setup.py egg_info for package billiard\n\n    warning: no files found matching '*.py' under directory 'Lib'\n```\n\nHere is the output when it starts to compile/install billiard.\n\n``` bash\n  Running setup.py install for billiard\n    building '_billiard' extension\n    c:\\MinGW\\bin\\gcc.exe -mdll -O -Wall -IModules/_billiard -IC:\\Python27\\include -Ic:\\msvirtualenv\\PC -c Modules/_billiard/multiprocessing.c -o build\\temp.win32-2.7\\Release\\modules\\_billiard\\multiprocessing.o\n    c:\\MinGW\\bin\\gcc.exe -mdll -O -Wall -IModules/_billiard -IC:\\Python27\\include -Ic:\\msvirtualenv\\PC -c Modules/_billiard/semaphore.c -o build\\temp.win32-2.7\\Release\\modules\\_billiard\\semaphore.o\n    Modules/_billiard/semaphore.c: In function 'Billiard_semlock_acquire':\n    Modules/_billiard/semaphore.c:153:22: warning: format '%d' expects argument of type 'int', but argument 3 has type 'DWORD' [-Wformat]\n    Modules/_billiard/semaphore.c: In function 'Billiard_semlock_getvalue':\n    Modules/_billiard/semaphore.c:522:5: warning: passing argument 2 of '_Billiard_GetSemaphoreValue' from incompatible pointer type [enabled by default]\n    Modules/_billiard/semaphore.c:43:1: note: expected 'long int *' but argument is of type 'int *'\n    Modules/_billiard/semaphore.c: In function 'Billiard_semlock_iszero':\n    Modules/_billiard/semaphore.c:547:5: warning: passing argument 2 of '_Billiard_GetSemaphoreValue' from incompatible pointer type [enabled by default]\n    Modules/_billiard/semaphore.c:43:1: note: expected 'long int *' but argument is of type 'int *'\n    c:\\MinGW\\bin\\gcc.exe -mdll -O -Wall -IModules/_billiard -IC:\\Python27\\include -Ic:\\msvirtualenv\\PC -c Modules/_billiard/pipe_connection.c -o build\\temp.win32-2.7\\Release\\modules\\_billiard\\pipe_connection.o\n    In file included from Modules/_billiard/pipe_connection.c:149:0:\n    Modules/_billiard/connection.h: In function 'Billiard_connection_new':\n    Modules/_billiard/connection.h:51:22: warning: unknown conversion type character 'z' in format [-Wformat]\n    Modules/_billiard/connection.h:51:22: warning: too many arguments for format\n [-Wformat-extra-args]\n    Modules/_billiard/connection.h: In function 'Billiard_connection_send_offset':\n    Modules/_billiard/connection.h:338:5: warning: implicit declaration of function '_Billiard_conn_send_offset' [-Wimplicit-function-declaration]\n    Modules/_billiard/connection.h: In function 'Billiard_connection_recv_payload':\n    Modules/_billiard/connection.h:387:15: warning: unused variable 'result' [-Wunused-variable]\n    Modules/_billiard/connection.h: In function 'Billiard_connection_repr':\n    Modules/_billiard/connection.h:533:24: warning: unknown conversion type character 'z' in format [-Wformat]\n    Modules/_billiard/connection.h:533:24: warning: too many arguments for format [-Wformat-extra-args]\n    c:\\MinGW\\bin\\gcc.exe -mdll -O -Wall -IModules/_billiard -IC:\\Python27\\include -Ic:\\msvirtualenv\\PC -c Modules/_billiard/socket_connection.c -o build\\temp.win32-2.7\\Release\\modules\\_billiard\\socket_connection.o\n    Modules/_billiard/socket_connection.c: In function '_Billiard_sockblock':\n    Modules/_billiard/socket_connection.c:29:21: error: 'FOINBIO' undeclared (first use in this function)\n    Modules/_billiard/socket_connection.c:29:21: note: each undeclared identifier is reported only once for each function it appears in\n    Modules/_billiard/socket_connection.c: In function '_Billiard_conn_send_offset':\n    Modules/_billiard/socket_connection.c:45:5: warning: passing argument 1 of '_Billiard_sockblock' makes integer from pointer without a cast [enabled by default]\n    Modules/_billiard/socket_connection.c:25:6: note: expected 'int' but argument is of type 'HANDLE'\n    Modules/_billiard/socket_connection.c:47:5: warning: passing argument 1 of '_Billiard_sockblock' makes integer from pointer without a cast [enabled by default]\n    Modules/_billiard/socket_connection.c:25:6: note: expected 'int' but argument is of type 'HANDLE'\n    In file included from Modules/_billiard/socket_connection.c:229:0:\n    Modules/_billiard/connection.h: In function 'Billiard_connection_new':\n    Modules/_billiard/connection.h:51:22: warning: unknown conversion type character 'z' in format [-Wformat]\n    Modules/_billiard/connection.h:51:22: warning: too many arguments for format\n [-Wformat-extra-args]\n    Modules/_billiard/connection.h: In function 'Billiard_connection_recv_payload':\n    Modules/_billiard/connection.h:387:15: warning: unused variable 'result' [-W\nunused-variable]\n    Modules/_billiard/connection.h: In function 'Billiard_connection_repr':\n    Modules/_billiard/connection.h:533:24: warning: unknown conversion type character 'z' in format [-Wformat]\n    Modules/_billiard/connection.h:533:24: warning: too many arguments for format [-Wformat-extra-args]\n\n    -----------------------------------------------------------------------\n    WARNING: The C extensions could not be compiled\n    -----------------------------------------------------------------------\n\n    Maybe you do not have a C compiler installed on this system?\n    The reason was:\n      File \"<string>\", line 1, in <module>\n\n      File \"c:\\msvirtualenv\\build\\billiard\\setup.py\", line 245, in <module>\n        sys.stderr.write(BUILD_WARNING % '\\n'.join(traceback.format_stack(), ))\n\n\n    This is just a warning as most of the functionality will work even\n    without the updated C extension.  It will simply fallback to the\n    built-in _multiprocessing module.  Most notably you will not be able to use\n    FORCE_EXECV on POSIX systems.  If this is a problem for you then please\n    install a C compiler or fix the error(s) above.\n    -----------------------------------------------------------------------\n```\n\nThe only error I see is this line from the above output:\n\n``` bash\n    Modules/_billiard/socket_connection.c:29:21: error: 'FOINBIO' undeclared (first use in this function)\n```\n\nIs this a known bug?\n\nThanks,\nNick\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/71", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/71/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/71/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/71/events", "html_url": "https://github.com/celery/billiard/issues/71", "id": 18192677, "node_id": "MDU6SXNzdWUxODE5MjY3Nw==", "number": 71, "title": "AttributeError: 'module' object has no attribute 'reduce_socket'", "user": {"login": "canercandan", "id": 285572, "node_id": "MDQ6VXNlcjI4NTU3Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/285572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/canercandan", "html_url": "https://github.com/canercandan", "followers_url": "https://api.github.com/users/canercandan/followers", "following_url": "https://api.github.com/users/canercandan/following{/other_user}", "gists_url": "https://api.github.com/users/canercandan/gists{/gist_id}", "starred_url": "https://api.github.com/users/canercandan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/canercandan/subscriptions", "organizations_url": "https://api.github.com/users/canercandan/orgs", "repos_url": "https://api.github.com/users/canercandan/repos", "events_url": "https://api.github.com/users/canercandan/events{/privacy}", "received_events_url": "https://api.github.com/users/canercandan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2013-08-17T11:07:41Z", "updated_at": "2013-08-17T11:13:12Z", "closed_at": "2013-08-17T11:13:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "Got this error lauching the celery worker from billiard (master version):\n\n<pre>\ncelery worker\nTraceback (most recent call last):\n  File \"/usr/bin/celery\", line 9, in <module>\n    load_entry_point('celery==3.1.0rc3', 'console_scripts', 'celery')()\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/__main__.py\", line 30, in main\n    main()\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/celery.py\", line 78, in main\n    cmd.execute_from_commandline(argv)\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/celery.py\", line 729, in execute_from_commandline\n    super(CeleryCommand, self).execute_from_commandline(argv)))\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/base.py\", line 300, in execute_from_commandline\n    return self.handle_argv(self.prog_name, argv[1:])\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/celery.py\", line 721, in handle_argv\n    return self.execute(command, argv)\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/celery.py\", line 677, in execute\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/worker.py\", line 155, in run_from_argv\n    return self(*args, **options)\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/base.py\", line 263, in __call__\n    ret = self.run(*args, **kwargs)\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/worker.py\", line 168, in run\n    pool_cls = (concurrency.get_implementation(pool_cls) or\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/concurrency/__init__.py\", line 26, in get_implementation\n    return symbol_by_name(cls, ALIASES)\n  File \"/usr/lib/python3.3/site-packages/kombu-2.5.13-py3.3.egg/kombu/utils/__init__.py\", line 80, in symbol_by_name\n    module = imp(module_name, package=package, **kwargs)\n  File \"/usr/lib/python3.3/importlib/__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"<frozen importlib._bootstrap>\", line 1586, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1567, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1534, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 586, in _check_name_wrapper\n  File \"<frozen importlib._bootstrap>\", line 1024, in load_module\n  File \"<frozen importlib._bootstrap>\", line 1005, in load_module\n  File \"<frozen importlib._bootstrap>\", line 562, in module_for_loader_wrapper\n  File \"<frozen importlib._bootstrap>\", line 870, in _load_module\n  File \"<frozen importlib._bootstrap>\", line 313, in _call_with_frames_removed\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/concurrency/processes.py\", line 28, in <module>\n    from billiard import pool as _pool\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/pool.py\", line 1840, in <module>\n    class ThreadPool(Pool):\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/pool.py\", line 1842, in ThreadPool\n    from billiard.dummy import Process as DummyProcess\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/dummy/__init__.py\", line 56, in <module>\n    from billiard.connection import Pipe\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/connection.py\", line 9, in <module>\n    from . import _connection3 as connection\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/_connection3.py\", line 970, in <module>\n    ForkingPickler.register(socket.socket, reduction.reduce_socket)\nAttributeError: 'module' object has no attribute 'reduce_socket'\n</pre>\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/70", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/70/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/70/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/70/events", "html_url": "https://github.com/celery/billiard/issues/70", "id": 18192617, "node_id": "MDU6SXNzdWUxODE5MjYxNw==", "number": 70, "title": "ImportError: cannot import name popen", "user": {"login": "canercandan", "id": 285572, "node_id": "MDQ6VXNlcjI4NTU3Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/285572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/canercandan", "html_url": "https://github.com/canercandan", "followers_url": "https://api.github.com/users/canercandan/followers", "following_url": "https://api.github.com/users/canercandan/following{/other_user}", "gists_url": "https://api.github.com/users/canercandan/gists{/gist_id}", "starred_url": "https://api.github.com/users/canercandan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/canercandan/subscriptions", "organizations_url": "https://api.github.com/users/canercandan/orgs", "repos_url": "https://api.github.com/users/canercandan/repos", "events_url": "https://api.github.com/users/canercandan/events{/privacy}", "received_events_url": "https://api.github.com/users/canercandan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2013-08-17T11:01:48Z", "updated_at": "2013-08-17T11:05:43Z", "closed_at": "2013-08-17T11:05:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using celery (master version) with billiard (master version) of course, I get the following error in starting a worker:\n\n<pre>\ncelery worker\nTraceback (most recent call last):\n  File \"/usr/bin/celery\", line 9, in <module>\n    load_entry_point('celery==3.1.0rc3', 'console_scripts', 'celery')()\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/__main__.py\", line 30, in main\n    main()\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/celery.py\", line 78, in main\n    cmd.execute_from_commandline(argv)\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/celery.py\", line 729, in execute_from_commandline\n    super(CeleryCommand, self).execute_from_commandline(argv)))\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/base.py\", line 300, in execute_from_commandline\n    return self.handle_argv(self.prog_name, argv[1:])\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/celery.py\", line 721, in handle_argv\n    return self.execute(command, argv)\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/celery.py\", line 677, in execute\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/worker.py\", line 155, in run_from_argv\n    return self(*args, **options)\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/base.py\", line 263, in __call__\n    ret = self.run(*args, **kwargs)\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/bin/worker.py\", line 168, in run\n    pool_cls = (concurrency.get_implementation(pool_cls) or\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/concurrency/__init__.py\", line 26, in get_implementation\n    return symbol_by_name(cls, ALIASES)\n  File \"/usr/lib/python3.3/site-packages/kombu-2.5.13-py3.3.egg/kombu/utils/__init__.py\", line 80, in symbol_by_name\n    module = imp(module_name, package=package, **kwargs)\n  File \"/usr/lib/python3.3/importlib/__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"<frozen importlib._bootstrap>\", line 1586, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1567, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1534, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 586, in _check_name_wrapper\n  File \"<frozen importlib._bootstrap>\", line 1024, in load_module\n  File \"<frozen importlib._bootstrap>\", line 1005, in load_module\n  File \"<frozen importlib._bootstrap>\", line 562, in module_for_loader_wrapper\n  File \"<frozen importlib._bootstrap>\", line 870, in _load_module\n  File \"<frozen importlib._bootstrap>\", line 313, in _call_with_frames_removed\n  File \"/usr/lib/python3.3/site-packages/celery-3.1.0rc3-py3.3.egg/celery/concurrency/processes.py\", line 28, in <module>\n    from billiard import pool as _pool\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/pool.py\", line 1840, in <module>\n    class ThreadPool(Pool):\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/pool.py\", line 1842, in ThreadPool\n    from billiard.dummy import Process as DummyProcess\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/dummy/__init__.py\", line 56, in <module>\n    from billiard.connection import Pipe\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/connection.py\", line 9, in <module>\n    from . import _connection3 as connection\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/_connection3.py\", line 27, in <module>\n    from .forking import ForkingPickler, duplicate\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/forking.py\", line 19, in <module>\n    from .reduction import dump\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/reduction.py\", line 6, in <module>\n    from . import _reduction3 as reduction\n  File \"/usr/lib/python3.3/site-packages/billiard-3.3.0.0rc1-py3.3.egg/billiard/_reduction3.py\", line 18, in <module>\n    from . import popen\nImportError: cannot import name popen\n</pre>\n\n\nI dont really know if it is one in the os library or another one added in the source code.\n\nThanks\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/69", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/69/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/69/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/69/events", "html_url": "https://github.com/celery/billiard/issues/69", "id": 17846658, "node_id": "MDU6SXNzdWUxNzg0NjY1OA==", "number": 69, "title": "Supervisor process dying", "user": {"login": "pegler", "id": 94491, "node_id": "MDQ6VXNlcjk0NDkx", "avatar_url": "https://avatars0.githubusercontent.com/u/94491?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pegler", "html_url": "https://github.com/pegler", "followers_url": "https://api.github.com/users/pegler/followers", "following_url": "https://api.github.com/users/pegler/following{/other_user}", "gists_url": "https://api.github.com/users/pegler/gists{/gist_id}", "starred_url": "https://api.github.com/users/pegler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pegler/subscriptions", "organizations_url": "https://api.github.com/users/pegler/orgs", "repos_url": "https://api.github.com/users/pegler/repos", "events_url": "https://api.github.com/users/pegler/events{/privacy}", "received_events_url": "https://api.github.com/users/pegler/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2013-08-09T04:32:33Z", "updated_at": "2013-09-11T13:09:09Z", "closed_at": "2013-09-11T13:09:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm seeing this error when using autoscaling on celery.\n\n```\n[2013-08-08 21:25:17,717: ERROR/MainProcess] Thread 'Supervisor' crashed: StopIteration()\nTraceback (most recent call last):\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/pool.py\", line 346, in run\n    return self.body()\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/pool.py\", line 398, in body\n    pool._maintain_pool()\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/pool.py\", line 1054, in _maintain_pool\n    self._repopulate_pool(joined)\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/pool.py\", line 1039, in _repopulate_pool\n    self._create_worker_process(self._avail_index())\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/pool.py\", line 1045, in _avail_index\n    return next(i for i in range(self._processes) if i not in indices)\nStopIteration\n```\n\nIt results in this error from the workers:\n\n```\n[2013-08-08 21:25:18,593: ERROR/MainProcess] Process PoolWorker-5\nTraceback (most recent call last):\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/process.py\", line 271, in _bootstrap\n    self.run()\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/process.py\", line 108, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/pool.py\", line 321, in worker\n    put((READY, (job, i, (False, einfo))))\n  File \"/var/www/env/local/lib/python2.7/site-packages/billiard/queues.py\", line 363, in put\n    return send(obj)\nOSError: [Errno 32] Broken pipe\n```\n\nbilliard==2.7.3.31\ncelery==3.0.21\ndjango-celery==3.0.21\nkombu==2.5.12\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/67", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/67/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/67/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/67/events", "html_url": "https://github.com/celery/billiard/issues/67", "id": 17275382, "node_id": "MDU6SXNzdWUxNzI3NTM4Mg==", "number": 67, "title": "WorkerLostError: Worker exited prematurely (exitcode: 155)", "user": {"login": "piskvorky", "id": 610412, "node_id": "MDQ6VXNlcjYxMDQxMg==", "avatar_url": "https://avatars1.githubusercontent.com/u/610412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/piskvorky", "html_url": "https://github.com/piskvorky", "followers_url": "https://api.github.com/users/piskvorky/followers", "following_url": "https://api.github.com/users/piskvorky/following{/other_user}", "gists_url": "https://api.github.com/users/piskvorky/gists{/gist_id}", "starred_url": "https://api.github.com/users/piskvorky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/piskvorky/subscriptions", "organizations_url": "https://api.github.com/users/piskvorky/orgs", "repos_url": "https://api.github.com/users/piskvorky/repos", "events_url": "https://api.github.com/users/piskvorky/events{/privacy}", "received_events_url": "https://api.github.com/users/piskvorky/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2013-07-26T17:48:33Z", "updated_at": "2013-12-14T13:24:20Z", "closed_at": "2013-12-14T13:24:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "I needed `maxtasksprechild` in `Pool` for python2.6, and googled up the `billiard` library. After installing version `2.7.3.31` with `pip`, I simply changed `import multiprocessing` to `import billiard as multiprocessing` and added `maxtasksperchild=1` (no other changes). But now the app fails with:\n\n`Exception: Traceback (most recent call last):\n  File \"/home/radim/workspace/vew/server/lib/python2.6/site-packages/billiard/pool.py\", line 948, in _join_exited_workers\n    lost_ret, ))\nWorkerLostError: Worker exited prematurely (exitcode: 155).`\n\nIt didn't use to fail before (=with built-in `multiprocessing` and no `maxtasksperchild`). Any ideas what's wrong? Where to look for problems?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/66", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/66/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/66/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/66/events", "html_url": "https://github.com/celery/billiard/issues/66", "id": 16708413, "node_id": "MDU6SXNzdWUxNjcwODQxMw==", "number": 66, "title": "Circular dependency between imports", "user": {"login": "extesy", "id": 65872, "node_id": "MDQ6VXNlcjY1ODcy", "avatar_url": "https://avatars3.githubusercontent.com/u/65872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/extesy", "html_url": "https://github.com/extesy", "followers_url": "https://api.github.com/users/extesy/followers", "following_url": "https://api.github.com/users/extesy/following{/other_user}", "gists_url": "https://api.github.com/users/extesy/gists{/gist_id}", "starred_url": "https://api.github.com/users/extesy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/extesy/subscriptions", "organizations_url": "https://api.github.com/users/extesy/orgs", "repos_url": "https://api.github.com/users/extesy/repos", "events_url": "https://api.github.com/users/extesy/events{/privacy}", "received_events_url": "https://api.github.com/users/extesy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-07-13T00:40:21Z", "updated_at": "2013-09-11T13:11:29Z", "closed_at": "2013-09-11T13:11:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Because of this circular dependency:\n\n```\nFile \"C:\\Python33\\lib\\site-packages\\billiard\\connection.py\", line 9, in <module>\n  from . import _connection3 as connection\nFile \"C:\\Python33\\lib\\site-packages\\billiard\\_connection3.py\", line 960, in <module>\n  from . import reduction\nFile \"C:\\Python33\\lib\\site-packages\\billiard\\reduction.py\", line 21, in <module>\n  from billiard.connection import Client, Listener\n```\n\nthe last line in connection.py `sys.modules[__name__] = connection` doesn't execute, so billiard.connection module doesn't get overridden.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/64", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/64/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/64/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/64/events", "html_url": "https://github.com/celery/billiard/issues/64", "id": 16667274, "node_id": "MDU6SXNzdWUxNjY2NzI3NA==", "number": 64, "title": "PicklingError: Can't pickle built-in method recv of _billiard.PipeConnection object", "user": {"login": "extesy", "id": 65872, "node_id": "MDQ6VXNlcjY1ODcy", "avatar_url": "https://avatars3.githubusercontent.com/u/65872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/extesy", "html_url": "https://github.com/extesy", "followers_url": "https://api.github.com/users/extesy/followers", "following_url": "https://api.github.com/users/extesy/following{/other_user}", "gists_url": "https://api.github.com/users/extesy/gists{/gist_id}", "starred_url": "https://api.github.com/users/extesy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/extesy/subscriptions", "organizations_url": "https://api.github.com/users/extesy/orgs", "repos_url": "https://api.github.com/users/extesy/repos", "events_url": "https://api.github.com/users/extesy/events{/privacy}", "received_events_url": "https://api.github.com/users/extesy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2013-07-12T05:31:29Z", "updated_at": "2013-08-15T13:35:21Z", "closed_at": "2013-08-15T13:35:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This happens on Windows using Python 2.7.3:\n\n```\n[2013-07-11 22:29:19,724: ERROR/MainProcess] Unrecoverable error: PicklingError(\"Can't pickle <built-in method recv of _billiard.PipeConnection object at 0x034B7090>: it's not found as __main__.recv\",)\nTraceback (most recent call last):\n  File \"D:\\Dev\\Python\\lib\\site-packages\\celery\\worker\\__init__.py\", line 191, in start\n    self.blueprint.start(self)\n  File \"D:\\Dev\\Python\\lib\\site-packages\\celery\\bootsteps.py\", line 119, in start\n    step.start(parent)\n  File \"D:\\Dev\\Python\\lib\\site-packages\\celery\\bootsteps.py\", line 352, in start\n    return self.obj.start()\n  File \"D:\\Dev\\Python\\lib\\site-packages\\celery\\concurrency\\base.py\", line 112, in start\n    self.on_start()\n  File \"D:\\Dev\\Python\\lib\\site-packages\\celery\\concurrency\\processes.py\", line 461, in on_start\n    **self.options)\n  File \"D:\\Dev\\Python\\lib\\site-packages\\billiard\\pool.py\", line 914, in __init__\n    self._create_worker_process(i)\n  File \"D:\\Dev\\Python\\lib\\site-packages\\billiard\\pool.py\", line 1004, in _create_worker_process\n    w.start()\n  File \"D:\\Dev\\Python\\lib\\site-packages\\billiard\\process.py\", line 125, in start\n    self._popen = Popen(self)\n  File \"D:\\Dev\\Python\\lib\\site-packages\\billiard\\forking.py\", line 352, in __init__\n    dump(process_obj, to_child, HIGHEST_PROTOCOL)\n  File \"D:\\Dev\\Python\\lib\\site-packages\\billiard\\forking.py\", line 146, in dump\n    ForkingPickler(file, protocol).dump(obj)\n  File \"D:\\Dev\\Python\\lib\\pickle.py\", line 224, in dump\n    self.save(obj)\n  File \"D:\\Dev\\Python\\lib\\pickle.py\", line 331, in save\n    self.save_reduce(obj=obj, *rv)\n  File \"D:\\Dev\\Python\\lib\\pickle.py\", line 419, in save_reduce\n    save(state)\n  File \"D:\\Dev\\Python\\lib\\pickle.py\", line 286, in save\n    f(self, obj) # Call unbound method with explicit self\n  File \"D:\\Dev\\Python\\lib\\pickle.py\", line 649, in save_dict\n    self._batch_setitems(obj.iteritems())\n  File \"D:\\Dev\\Python\\lib\\pickle.py\", line 681, in _batch_setitems\n    save(v)\n  File \"D:\\Dev\\Python\\lib\\pickle.py\", line 286, in save\n    f(self, obj) # Call unbound method with explicit self\n  File \"D:\\Dev\\Python\\lib\\pickle.py\", line 748, in save_global\n    (obj, module, name))\nPicklingError: Can't pickle <built-in method recv of _billiard.PipeConnection object at 0x034B7090>: it's not found as __main__.recv\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/62", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/62/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/62/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/62/events", "html_url": "https://github.com/celery/billiard/issues/62", "id": 16667073, "node_id": "MDU6SXNzdWUxNjY2NzA3Mw==", "number": 62, "title": "Can't compile C extension", "user": {"login": "extesy", "id": 65872, "node_id": "MDQ6VXNlcjY1ODcy", "avatar_url": "https://avatars3.githubusercontent.com/u/65872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/extesy", "html_url": "https://github.com/extesy", "followers_url": "https://api.github.com/users/extesy/followers", "following_url": "https://api.github.com/users/extesy/following{/other_user}", "gists_url": "https://api.github.com/users/extesy/gists{/gist_id}", "starred_url": "https://api.github.com/users/extesy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/extesy/subscriptions", "organizations_url": "https://api.github.com/users/extesy/orgs", "repos_url": "https://api.github.com/users/extesy/repos", "events_url": "https://api.github.com/users/extesy/events{/privacy}", "received_events_url": "https://api.github.com/users/extesy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2013-07-12T05:18:53Z", "updated_at": "2013-09-11T13:08:31Z", "closed_at": "2013-09-11T13:08:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When I try to set up billiard from master branch python compiles C extension and fails with this error:\n\n```\npipe_connection.obj : error LNK2019: unresolved external symbol __Billiard_conn_send_offset referenced in function _Billiard_conn_poll\n```\n\nWhen I replace `static` with `extern` in socket_connection.c for _Billiard_conn_send_offset function, everything compiles fine. I'm not sending PR for this because I'm not sure if this problem is local to my machine.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/celery/billiard/issues/59", "repository_url": "https://api.github.com/repos/celery/billiard", "labels_url": "https://api.github.com/repos/celery/billiard/issues/59/labels{/name}", "comments_url": "https://api.github.com/repos/celery/billiard/issues/59/comments", "events_url": "https://api.github.com/repos/celery/billiard/issues/59/events", "html_url": "https://github.com/celery/billiard/issues/59", "id": 16437436, "node_id": "MDU6SXNzdWUxNjQzNzQzNg==", "number": 59, "title": "Python 3 import issues -ImportError: cannot import name WAIT_ABANDONED_0", "user": {"login": "darkseas", "id": 4347161, "node_id": "MDQ6VXNlcjQzNDcxNjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/4347161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/darkseas", "html_url": "https://github.com/darkseas", "followers_url": "https://api.github.com/users/darkseas/followers", "following_url": "https://api.github.com/users/darkseas/following{/other_user}", "gists_url": "https://api.github.com/users/darkseas/gists{/gist_id}", "starred_url": "https://api.github.com/users/darkseas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/darkseas/subscriptions", "organizations_url": "https://api.github.com/users/darkseas/orgs", "repos_url": "https://api.github.com/users/darkseas/repos", "events_url": "https://api.github.com/users/darkseas/events{/privacy}", "received_events_url": "https://api.github.com/users/darkseas/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2013-07-07T00:41:06Z", "updated_at": "2013-10-29T15:50:35Z", "closed_at": "2013-09-11T12:44:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am working the First Steps tutorial, but running into issues with the Python3 imports.\n\nIt looks like some of the _winapi imports are in the win32con or win32event modules.\n\nMy setup\nI'm running Python 3.3 on Windows 7\nI have installed celery, kombu, billiard and py-amqp (as amqp) from git with\n\n```\n>git clone <lib>\n>cd <lib>\n>python setup.py develop\n```\n\ngiving me\n`> pip freeze`\n...\n-e git+https://github.com/celery/py-amqp.git@735c2b409f6e1180f9401132bae2a95bdd3ab34f#egg=amqp-dev\nanyjson==0.3.3\nbilliard==3.3.0.0rc1\n-e git+https://github.com/celery/celery.git@35ef4a557c2adffd4778e795fe64f2d558dc01cf#egg=celery-dev\n-e git+https://github.com/celery/kombu.git@97a67498d86d5f84fff8706a4525b960b6945853#egg=kombu-dev\npymongo==2.5.2\npython-dateutil==2.1\npytz==2013b\nsix==1.3.0\n...\n\nNow running the celery worker\n`C:\\Users\\gav\\src\\python\\proj>celery -A tasks worker -l debug`\n\nTraceback (most recent call last):\n  File \"C:\\WinPython-64bit-3.3.2.1\\python-3.3.2.amd64\\Scripts\\celery-script.py\", line 9, in <module>\n    load_entry_point('celery==3.1.0rc3', 'console_scripts', 'celery')()\n  File \"c:\\users\\gav\\src\\celery\\celery__main__.py\", line 30, in main\n    main()\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 78, in main\n    cmd.execute_from_commandline(argv)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 729, in execute_from_commandline\n    super(CeleryCommand, self).execute_from_commandline(argv)))\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\base.py\", line 300, in execute_from_commandline\n    return self.handle_argv(self.prog_name, argv[1:])\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 721, in handle_argv\n    return self.execute(command, argv)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 677, in execute\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\worker.py\", line 155, in run_from_argv\n    return self(_args, *_options)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\base.py\", line 263, in **call**\n    ret = self.run(_args, *_kwargs)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\worker.py\", line 168, in run\n    pool_cls = (concurrency.get_implementation(pool_cls) or\n  File \"c:\\users\\gav\\src\\celery\\celery\\concurrency__init__.py\", line 26, in get_implementation\n    return symbol_by_name(cls, ALIASES)\n  File \"c:\\users\\gav\\src\\kombu\\kombu\\utils__init__.py\", line 82, in symbol_by_name\n    module = imp(module_name, package=package, **kwargs)\n  File \"C:\\WinPython-64bit-3.3.2.1\\python-3.3.2.amd64\\lib\\importlib__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"<frozen importlib._bootstrap>\", line 1586, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1567, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1534, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 586, in _check_name_wrapper\n  File \"<frozen importlib._bootstrap>\", line 1024, in load_module\n  File \"<frozen importlib._bootstrap>\", line 1005, in load_module\n  File \"<frozen importlib._bootstrap>\", line 562, in module_for_loader_wrapper\n  File \"<frozen importlib._bootstrap>\", line 870, in _load_module\n  File \"<frozen importlib._bootstrap>\", line 313, in _call_with_frames_removed\n  File \"c:\\users\\gav\\src\\celery\\celery\\concurrency\\processes.py\", line 27, in <module>\n    from billiard import pool as _pool\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\pool.py\", line 1831, in <module>\n    class ThreadPool(Pool):\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\pool.py\", line 1833, in ThreadPool\n    from billiard.dummy import Process as DummyProcess\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\dummy__init__.py\", line 56, in <module>\n    from billiard.connection import Pipe\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\connection.py\", line 6, in <module>\n    from . import _connection3 as connection\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard_connection3.py\", line 29, in <module>\n    from _winapi import (\nImportError: cannot import name WAIT_ABANDONED_0\n\nThe problem lies here,\n\n```\nfrom _winapi import (\n       WAIT_OBJECT_0,\n       WAIT_ABANDONED_0,\n       WAIT_TIMEOUT,\n       INFINITE,\n   )\n```\n\nIf I change this to:\n\n```\nimport win32con\nfrom win32con import (\n    WAIT_OBJECT_0,\n    WAIT_ABANDONED_0,\n    WAIT_TIMEOUT,\n)    \nimport win32event\nfrom win32event import INFINITE\nimport _winapi\n```\n\nthen run the worker\n`C:\\Users\\gav\\src\\python\\proj>celery -A tasks worker -l debug`\nTraceback (most recent call last):\n  File \"C:\\WinPython-64bit-3.3.2.1\\python-3.3.2.amd64\\Scripts\\celery-script.py\", line 9, in <module>\n    load_entry_point('celery==3.1.0rc3', 'console_scripts', 'celery')()\n  File \"c:\\users\\gav\\src\\celery\\celery__main__.py\", line 30, in main\n    main()\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 78, in main\n    cmd.execute_from_commandline(argv)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 729, in execute_from_commandline\n    super(CeleryCommand, self).execute_from_commandline(argv)))\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\base.py\", line 300, in execute_from_commandline\n    return self.handle_argv(self.prog_name, argv[1:])\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 721, in handle_argv\n    return self.execute(command, argv)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 677, in execute\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\worker.py\", line 155, in run_from_argv\n    return self(_args, *_options)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\base.py\", line 263, in **call**\n    ret = self.run(_args, *_kwargs)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\worker.py\", line 168, in run\n    pool_cls = (concurrency.get_implementation(pool_cls) or\n  File \"c:\\users\\gav\\src\\celery\\celery\\concurrency__init__.py\", line 26, in get_implementation\n    return symbol_by_name(cls, ALIASES)\n  File \"c:\\users\\gav\\src\\kombu\\kombu\\utils__init__.py\", line 82, in symbol_by_name\n    module = imp(module_name, package=package, **kwargs)\n  File \"C:\\WinPython-64bit-3.3.2.1\\python-3.3.2.amd64\\lib\\importlib__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"<frozen importlib._bootstrap>\", line 1586, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1567, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1534, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 586, in _check_name_wrapper\n  File \"<frozen importlib._bootstrap>\", line 1024, in load_module\n  File \"<frozen importlib._bootstrap>\", line 1005, in load_module\n  File \"<frozen importlib._bootstrap>\", line 562, in module_for_loader_wrapper\n  File \"<frozen importlib._bootstrap>\", line 870, in _load_module\n  File \"<frozen importlib._bootstrap>\", line 313, in _call_with_frames_removed\n  File \"c:\\users\\gav\\src\\celery\\celery\\concurrency\\processes.py\", line 27, in <module>\n    from billiard import pool as _pool\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\pool.py\", line 1831, in <module>\n    class ThreadPool(Pool):\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\pool.py\", line 1833, in ThreadPool\n    from billiard.dummy import Process as DummyProcess\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\dummy__init__.py\", line 56, in <module>\n    from billiard.connection import Pipe\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\connection.py\", line 6, in <module>\n    from . import _connection3 as connection\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard_connection3.py\", line 977, in <module>\n    from . import reduction\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\reduction.py\", line 21, in <module>\n    from billiard.connection import Client, Listener\nImportError: cannot import name Client\n\nMoving to reduction.py\nChanging the import of Client and Listener\n\n```\nif sys.version_info[0] == 3:\n#    from billiard.connection import Client, Listener\n    from billiard._connection3 import Client, Listener\n```\n\nC:\\Users\\gav\\src\\python\\proj>celery -A tasks worker -l debug\nTraceback (most recent call last):\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard_ext.py\", line 21, in <module>\n    Connection = _billiard.Connection\nAttributeError: 'module' object has no attribute 'Connection'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\WinPython-64bit-3.3.2.1\\python-3.3.2.amd64\\Scripts\\celery-script.py\", line 9, in <module>\n    load_entry_point('celery==3.1.0rc3', 'console_scripts', 'celery')()\n  File \"c:\\users\\gav\\src\\celery\\celery__main__.py\", line 30, in main\n    main()\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 78, in main\n    cmd.execute_from_commandline(argv)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 729, in execute_from_commandline\n    super(CeleryCommand, self).execute_from_commandline(argv)))\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\base.py\", line 300, in execute_from_commandline\n    return self.handle_argv(self.prog_name, argv[1:])\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 721, in handle_argv\n    return self.execute(command, argv)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\celery.py\", line 677, in execute\n    ).run_from_argv(self.prog_name, argv[1:], command=argv[0])\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\worker.py\", line 155, in run_from_argv\n    return self(_args, *_options)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\base.py\", line 263, in **call**\n    ret = self.run(_args, *_kwargs)\n  File \"c:\\users\\gav\\src\\celery\\celery\\bin\\worker.py\", line 168, in run\n    pool_cls = (concurrency.get_implementation(pool_cls) or\n  File \"c:\\users\\gav\\src\\celery\\celery\\concurrency__init__.py\", line 26, in get_implementation\n    return symbol_by_name(cls, ALIASES)\n  File \"c:\\users\\gav\\src\\kombu\\kombu\\utils__init__.py\", line 82, in symbol_by_name\n    module = imp(module_name, package=package, **kwargs)\n  File \"C:\\WinPython-64bit-3.3.2.1\\python-3.3.2.amd64\\lib\\importlib__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"<frozen importlib._bootstrap>\", line 1586, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1567, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1534, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 586, in _check_name_wrapper\n  File \"<frozen importlib._bootstrap>\", line 1024, in load_module\n  File \"<frozen importlib._bootstrap>\", line 1005, in load_module\n  File \"<frozen importlib._bootstrap>\", line 562, in module_for_loader_wrapper\n  File \"<frozen importlib._bootstrap>\", line 870, in _load_module\n  File \"<frozen importlib._bootstrap>\", line 313, in _call_with_frames_removed\n  File \"c:\\users\\gav\\src\\celery\\celery\\concurrency\\processes.py\", line 27, in <module>\n    from billiard import pool as _pool\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\pool.py\", line 1831, in <module>\n    class ThreadPool(Pool):\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\pool.py\", line 1833, in ThreadPool\n    from billiard.dummy import Process as DummyProcess\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\dummy__init__.py\", line 56, in <module>\n    from billiard.connection import Pipe\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\connection.py\", line 6, in <module>\n    from . import _connection3 as connection\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard_connection3.py\", line 977, in <module>\n    from . import reduction\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard\\reduction.py\", line 27, in <module>\n    from ._ext import _billiard, win32\n  File \"c:\\users\\gav\\src\\billiard\\build\\lib\\billiard_ext.py\", line 23, in <module>\n    from billiard.connection import Connection  # noqa\nImportError: cannot import name Connection\n\nI will leave this issue here, and continue following the trail of imports a little later.\n", "performed_via_github_app": null, "score": 1.0}]}