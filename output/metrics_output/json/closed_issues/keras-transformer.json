{"total_count": 28, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/34", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/34/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/34/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/34/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/34", "id": 609975798, "node_id": "MDU6SXNzdWU2MDk5NzU3OTg=", "number": 34, "title": "why get the same output with different input?", "user": {"login": "jiayiwang5", "id": 28797714, "node_id": "MDQ6VXNlcjI4Nzk3NzE0", "avatar_url": "https://avatars2.githubusercontent.com/u/28797714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jiayiwang5", "html_url": "https://github.com/jiayiwang5", "followers_url": "https://api.github.com/users/jiayiwang5/followers", "following_url": "https://api.github.com/users/jiayiwang5/following{/other_user}", "gists_url": "https://api.github.com/users/jiayiwang5/gists{/gist_id}", "starred_url": "https://api.github.com/users/jiayiwang5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jiayiwang5/subscriptions", "organizations_url": "https://api.github.com/users/jiayiwang5/orgs", "repos_url": "https://api.github.com/users/jiayiwang5/repos", "events_url": "https://api.github.com/users/jiayiwang5/events{/privacy}", "received_events_url": "https://api.github.com/users/jiayiwang5/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-30T13:19:00Z", "updated_at": "2020-05-01T05:32:29Z", "closed_at": "2020-05-01T05:32:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "thanks for ur sharing first.Code are as same as ur example, the only diffferent is data.As a Demo, I feed 2000 Chinese-English sentences to get a translation model.After trainning, I got same 'decoded' what ever the data I input.And here's an example.\r\n`encode_input : [1, 5, 4, 2, 0, 0, 0, 0, 0, 0]`\r\n`decode_input : [1, 3, 4, 2, 0, 0, 0, 0, 0, 0]`\r\n`decode_output : [[3], [4], [2], [0], [0], [0], [0], [0], [0], [0]]`\r\n`decoded : [1, 9, 204, 4, 4, 2]`\r\nAnd here's the part of the code:\r\n ```\r\ndef generate_train(batch_size):\r\n    steps=0\r\n    while True:\r\n        batch_out = decode_output[steps:steps+batch_size]\r\n        batch_eng = decode_input[steps:steps+batch_size]\r\n        batch_cns = encode_input[steps:steps+batch_size]\r\n        yield [np.array(batch_cns), np.array(batch_eng)], np.array(batch_out)\r\n        steps += batch_size\r\n        if steps == 2000:\r\n            steps = 0\r\nmodel.fit_generator(generate_train(batch_size=100), \r\n                    steps_per_epoch=20, \r\n                    epochs=10, \r\n                    verbose=1, \r\n#                     callbacks=callbacks_list, \r\n#                     validation_data=generate_test(batch_size=100), \r\n#                     validation_steps=200, \r\n                    class_weight=None, \r\n                    max_queue_size=5 \r\n#                     workers=1, \r\n#                     use_multiprocessing=False,\r\n#                     shuffle=False,\r\n#                     initial_epoch=initial_epoch_\r\n                    )\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/33", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/33/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/33/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/33/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/33", "id": 606961349, "node_id": "MDU6SXNzdWU2MDY5NjEzNDk=", "number": 33, "title": "The input of function \"_get_max_suffix_repeat_times\" is not correct.", "user": {"login": "sdq11111", "id": 4705089, "node_id": "MDQ6VXNlcjQ3MDUwODk=", "avatar_url": "https://avatars0.githubusercontent.com/u/4705089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sdq11111", "html_url": "https://github.com/sdq11111", "followers_url": "https://api.github.com/users/sdq11111/followers", "following_url": "https://api.github.com/users/sdq11111/following{/other_user}", "gists_url": "https://api.github.com/users/sdq11111/gists{/gist_id}", "starred_url": "https://api.github.com/users/sdq11111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sdq11111/subscriptions", "organizations_url": "https://api.github.com/users/sdq11111/orgs", "repos_url": "https://api.github.com/users/sdq11111/repos", "events_url": "https://api.github.com/users/sdq11111/events{/privacy}", "received_events_url": "https://api.github.com/users/sdq11111/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299291, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkx", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-04-26T09:05:32Z", "updated_at": "2020-04-27T12:07:01Z", "closed_at": "2020-04-27T12:07:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "the Code in transfomer.py, line 561:\r\n_get_max_suffix_repeat_times(decoder_inputs, max_repeat * max_repeat_block) >= max_repeat:\r\n\r\nshould be corrected as:\r\n\r\n_get_max_suffix_repeat_times(decoder_inputs[index_map[i]], max_repeat * max_repeat_block) >= max_repeat:\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/32", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/32/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/32/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/32/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/32", "id": 591518535, "node_id": "MDU6SXNzdWU1OTE1MTg1MzU=", "number": 32, "title": "Hierarchy of Encoders Not Working", "user": {"login": "rajicon", "id": 17256665, "node_id": "MDQ6VXNlcjE3MjU2NjY1", "avatar_url": "https://avatars2.githubusercontent.com/u/17256665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rajicon", "html_url": "https://github.com/rajicon", "followers_url": "https://api.github.com/users/rajicon/followers", "following_url": "https://api.github.com/users/rajicon/following{/other_user}", "gists_url": "https://api.github.com/users/rajicon/gists{/gist_id}", "starred_url": "https://api.github.com/users/rajicon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rajicon/subscriptions", "organizations_url": "https://api.github.com/users/rajicon/orgs", "repos_url": "https://api.github.com/users/rajicon/repos", "events_url": "https://api.github.com/users/rajicon/events{/privacy}", "received_events_url": "https://api.github.com/users/rajicon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-31T23:54:25Z", "updated_at": "2020-04-08T00:49:08Z", "closed_at": "2020-04-08T00:49:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to encode multiple sentences, into one embedding, so first I use a self attention encoder on each word of a sentence for each sentence, and then I use another self attention encoder on each sentence representation to get a final representation.  However, when I do this, it doesn't seem to work well.  However, if I remove either the word level or self level self attention encoder (and replace it with just mean/sum of the embeddings, it does work.  I cannot seem to figure out where the problem is, do you have any theories of what could be going wrong?\r\n\r\nHere is (a simplified) version of my model:\r\n\r\n    def build_context_encoder(self):\r\n        context = Input(shape=(self.max_num_words_per_context, ), dtype=tf.int64) #num_context x max_num_words_per_context #put back\r\n\r\n      #set up word emb\r\n      word_embs = np.zeros((self.vocab_size+1, self.word_emb_dim))  #MASK\r\n\r\n      for word in self.word2id_dict:\r\n            ind = self.word2id_dict[word]\r\n            if ind > largest_ind:\r\n                largest_ind = ind\r\n            w_emb = self.word_embedding_model.wv[word]\r\n            word_embs[ind] = w_emb\r\n        \r\n\r\n      emb_layer  = EmbeddingRet(\r\n            input_dim=self.vocab_size+1, #is this correct?\r\n            output_dim=self.word_emb_dim,\r\n            mask_zero=True, #is this what we want?  Think about this\r\n            weights=[word_embs],  #self.embedding_matrix,\r\n            trainable=False,\r\n            name='Encoder-Token-Embedding',\r\n        )   \r\n      emb = emb_layer(context) \r\n      encoder_embed = emb[0] \r\n      sa_context_encoder = transformer.get_encoders(self.encoder_num, encoder_embed, self.head_num, self.hidden_dim) #should output batch x num_contexts x emb_size\r\n      context_emb = SumInternal()(sa_context_encoder)\r\n      context_encoder = Model(inputs=[context], outputs=context_emb)\r\n      return context_encoder\r\n\r\n    def build_model(self): \r\n        contexts = Input(shape=(self.max_num_context, self.max_num_words_per_context, ), dtype=tf.int64) #num_context x num_words\r\n\r\n    \r\n      context_embs = TimeDistributed(self.context_encoder)(contexts)\r\n\r\n      context_embs = ZeroVectorMasker()(context_embs)  #READD\r\n\r\n      aggregator_encoder_out = transformer.get_encoders(self.encoder_num, context_embs, self.head_num, self.hidden_dim)\r\n\r\n      final_estimate = MeanInternal()(aggregator_encoder_out)\r\n      model = Model(inputs=[subwords, contexts], outputs=final_estimate)\r\n      model.compile(loss='mean_squared_error', optimizer='adam', metrics=[])\r\n      model.summary()\r\n      return model", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/31", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/31/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/31/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/31/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/31", "id": 578221970, "node_id": "MDU6SXNzdWU1NzgyMjE5NzA=", "number": 31, "title": "How do you use masking with the transformer?", "user": {"login": "rajicon", "id": 17256665, "node_id": "MDQ6VXNlcjE3MjU2NjY1", "avatar_url": "https://avatars2.githubusercontent.com/u/17256665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rajicon", "html_url": "https://github.com/rajicon", "followers_url": "https://api.github.com/users/rajicon/followers", "following_url": "https://api.github.com/users/rajicon/following{/other_user}", "gists_url": "https://api.github.com/users/rajicon/gists{/gist_id}", "starred_url": "https://api.github.com/users/rajicon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rajicon/subscriptions", "organizations_url": "https://api.github.com/users/rajicon/orgs", "repos_url": "https://api.github.com/users/rajicon/repos", "events_url": "https://api.github.com/users/rajicon/events{/privacy}", "received_events_url": "https://api.github.com/users/rajicon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-09T22:15:46Z", "updated_at": "2020-03-19T16:06:33Z", "closed_at": "2020-03-16T23:38:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm having trouble figuring out how to use masking with the transformer.  I have mask_zero set to true with the embeddings, but I'm not sure if the masking is used in the transformer calculation.  Do I need to do anything special to make sure it is taken into account?\r\n\r\nFor example,  if I was putting a sentence through the encoder: (2 3 2 1 0 0 0), and I want the transformer to ignore the zeros, what should I do?  (The 0 embedding is a zero vector, if that matters).", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/30", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/30/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/30/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/30/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/30", "id": 576929644, "node_id": "MDU6SXNzdWU1NzY5Mjk2NDQ=", "number": 30, "title": "doesnt work when test set contains more than two sentences", "user": {"login": "sainikmahata", "id": 16027591, "node_id": "MDQ6VXNlcjE2MDI3NTkx", "avatar_url": "https://avatars0.githubusercontent.com/u/16027591?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sainikmahata", "html_url": "https://github.com/sainikmahata", "followers_url": "https://api.github.com/users/sainikmahata/followers", "following_url": "https://api.github.com/users/sainikmahata/following{/other_user}", "gists_url": "https://api.github.com/users/sainikmahata/gists{/gist_id}", "starred_url": "https://api.github.com/users/sainikmahata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sainikmahata/subscriptions", "organizations_url": "https://api.github.com/users/sainikmahata/orgs", "repos_url": "https://api.github.com/users/sainikmahata/repos", "events_url": "https://api.github.com/users/sainikmahata/events{/privacy}", "received_events_url": "https://api.github.com/users/sainikmahata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-06T13:25:01Z", "updated_at": "2020-04-22T23:46:16Z", "closed_at": "2020-03-15T03:57:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have made the following changes in the code to accommodate my own data.\r\n\r\n```\r\n##import packages\r\nimport numpy as np\r\nfrom keras_transformer import get_model, decode\r\nfrom keras.preprocessing.sequence import pad_sequences\r\n\r\n##open my own file\r\nf1=open('/content/drive/My Drive/trans_en-bn_NMT/English','r',errors='ignore').read().split('\\n')\r\nf2=open('/content/drive/My Drive/trans_en-bn_NMT/Bangla','r',errors='ignore').read().split('\\n')\r\n\r\nsource_tokens=[i.split () for i in f1]\r\ntarget_tokens=[i.split () for i in f2]\r\n\r\n## Generate dictionaries\r\ndef build_token_dict(token_list):\r\n    token_dict = {\r\n        '<PAD>': 0,\r\n        '<START>': 1,\r\n        '<END>': 2,\r\n    }\r\n    for tokens in token_list:\r\n        for token in tokens:\r\n            if token not in token_dict:\r\n                token_dict[token] = len(token_dict)\r\n    return token_dict\r\n\r\nsource_token_dict = build_token_dict(source_tokens)\r\ntarget_token_dict = build_token_dict(target_tokens)\r\ntarget_token_dict_inv = {v: k for k, v in target_token_dict.items()}\r\n\r\n# Add special tokens\r\nencode_tokens = [['<START>'] + tokens + ['<END>'] for tokens in source_tokens]\r\ndecode_tokens = [['<START>'] + tokens + ['<END>'] for tokens in target_tokens]\r\noutput_tokens = [tokens + ['<END>', '<PAD>'] for tokens in target_tokens]\r\n \r\n# Padding\r\nsource_max_len = max(map(len, encode_tokens))\r\ntarget_max_len = max(map(len, decode_tokens))\r\n\r\nencode_tokens = [tokens + ['<PAD>'] * (source_max_len - len(tokens)) for tokens in encode_tokens]\r\ndecode_tokens = [tokens + ['<PAD>'] * (target_max_len - len(tokens)) for tokens in decode_tokens]\r\noutput_tokens = [tokens + ['<PAD>'] * (target_max_len - len(tokens)) for tokens in output_tokens]\r\n \r\nencode_input = [list(map(lambda x: source_token_dict[x], tokens)) for tokens in encode_tokens]\r\ndecode_input = [list(map(lambda x: target_token_dict[x], tokens)) for tokens in decode_tokens]\r\ndecode_output = [list(map(lambda x: [target_token_dict[x]], tokens)) for tokens in output_tokens]\r\n#\r\n# Build & fit model\r\nmodel = get_model(\r\n    token_num=max(len(source_token_dict), len(target_token_dict)),\r\n    embed_dim=32,\r\n    encoder_num=2,\r\n    decoder_num=2,\r\n    head_num=4,\r\n    hidden_dim=128,\r\n    dropout_rate=0.05,\r\n    use_same_embed=False,  # Use different embeddings for different languages\r\n)\r\nmodel.compile(optimizer='adam', loss='sparse_categorical_crossentropy',metrics=['acc'])\r\nmodel.summary()\r\n\r\nmodel.fit(\r\n    x=[np.array(encode_input), np.array(decode_input)],\r\n    y=np.array(decode_output),\r\n    epochs=1,\r\n    batch_size=10,\r\n)\r\n\r\n\r\n# Predict\r\ndecoded = decode(\r\n    model,\r\n    np.array(encode_input)[48999:],\r\n    #test_inp,\r\n    start_token=target_token_dict['<START>'],\r\n    end_token=target_token_dict['<END>'],\r\n    pad_token=target_token_dict['<PAD>'],\r\n)\r\n##print the translated sentences\r\nfor i in decoded:\r\n  print(''.join(map(lambda x: target_token_dict_inv[x], i[1:-1])))\r\n```\r\n\r\nbut when testing, it is giving the following error\r\n\r\n> UFuncTypeError                            Traceback (most recent call last)\r\n> <ipython-input-3-2973eb18adf8> in <module>()\r\n>      72     start_token=target_token_dict['<START>'],\r\n>      73     end_token=target_token_dict['<END>'],\r\n> ---> 74     pad_token=target_token_dict['<PAD>'],\r\n>      75     # top_k=10,\r\n>      76     # temperature=1.0,\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/keras_transformer/transformer.py in decode(model, tokens, start_token, end_token, pad_token, top_k, temperature, max_len, max_repeat, max_repeat_block)\r\n>     541                 max_input_len = max(max_input_len, len(tokens[i]))\r\n>     542         for i in range(len(batch_inputs)):\r\n> --> 543             batch_inputs[i] += [pad_token] * (max_input_len - len(batch_inputs[i]))\r\n>     544         predicts = model.predict([np.array(batch_inputs), np.array(batch_outputs)])\r\n>     545         for i in range(len(predicts)):\r\n> \r\n> UFuncTypeError: Cannot cast ufunc 'add' output from dtype('float64') to dtype('int64') with casting rule 'same_kind'", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/29", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/29/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/29/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/29/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/29", "id": 571079014, "node_id": "MDU6SXNzdWU1NzEwNzkwMTQ=", "number": 29, "title": "How to handle multiple inputs", "user": {"login": "rajicon", "id": 17256665, "node_id": "MDQ6VXNlcjE3MjU2NjY1", "avatar_url": "https://avatars2.githubusercontent.com/u/17256665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rajicon", "html_url": "https://github.com/rajicon", "followers_url": "https://api.github.com/users/rajicon/followers", "following_url": "https://api.github.com/users/rajicon/following{/other_user}", "gists_url": "https://api.github.com/users/rajicon/gists{/gist_id}", "starred_url": "https://api.github.com/users/rajicon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rajicon/subscriptions", "organizations_url": "https://api.github.com/users/rajicon/orgs", "repos_url": "https://api.github.com/users/rajicon/repos", "events_url": "https://api.github.com/users/rajicon/events{/privacy}", "received_events_url": "https://api.github.com/users/rajicon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-26T05:27:51Z", "updated_at": "2020-03-04T06:30:51Z", "closed_at": "2020-03-04T06:30:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "I want to input multiple sentences , but have the encoder applied to each sentence individually (to be combined later in the model).  Is there an easy way to do this?  I've tried using Lambda functions with get_encoders(), but I don't think this is correct, as I want the same set of encoders applied to each sentence.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/28", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/28/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/28/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/28/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/28", "id": 566102032, "node_id": "MDU6SXNzdWU1NjYxMDIwMzI=", "number": 28, "title": "Some question about the decode method", "user": {"login": "qiuhuiGithub", "id": 8860561, "node_id": "MDQ6VXNlcjg4NjA1NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/8860561?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qiuhuiGithub", "html_url": "https://github.com/qiuhuiGithub", "followers_url": "https://api.github.com/users/qiuhuiGithub/followers", "following_url": "https://api.github.com/users/qiuhuiGithub/following{/other_user}", "gists_url": "https://api.github.com/users/qiuhuiGithub/gists{/gist_id}", "starred_url": "https://api.github.com/users/qiuhuiGithub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qiuhuiGithub/subscriptions", "organizations_url": "https://api.github.com/users/qiuhuiGithub/orgs", "repos_url": "https://api.github.com/users/qiuhuiGithub/repos", "events_url": "https://api.github.com/users/qiuhuiGithub/events{/privacy}", "received_events_url": "https://api.github.com/users/qiuhuiGithub/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-17T07:19:15Z", "updated_at": "2020-02-24T08:06:31Z", "closed_at": "2020-02-24T08:06:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, after read your code, I have learned a lot. But I have some question about the decode method.\r\n1.  I guess the method `_get_max_suffix_repeat_times` is check repeat patten in the decoder_inputs,  so line 561 in transformer.py may should be `_get_max_suffix_repeat_times(decoder_inputs[index_map[i]], max_repeat * max_repeat_block) >= max_repeat:`?  This may be a bug.\r\n2. The beam search implementation in decode method use a random choice from the Gibbs distribution,  which is different from the usual beam search method. I think the beam search should remain the top-k results in each decode step, and finally return top-k results for every input.\r\nBest wishes.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/26", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/26/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/26/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/26/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/26", "id": 551093919, "node_id": "MDU6SXNzdWU1NTEwOTM5MTk=", "number": 26, "title": "module 'keras.layers' has no attribute 'Wrapper'", "user": {"login": "Nadni", "id": 27709839, "node_id": "MDQ6VXNlcjI3NzA5ODM5", "avatar_url": "https://avatars2.githubusercontent.com/u/27709839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nadni", "html_url": "https://github.com/Nadni", "followers_url": "https://api.github.com/users/Nadni/followers", "following_url": "https://api.github.com/users/Nadni/following{/other_user}", "gists_url": "https://api.github.com/users/Nadni/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nadni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nadni/subscriptions", "organizations_url": "https://api.github.com/users/Nadni/orgs", "repos_url": "https://api.github.com/users/Nadni/repos", "events_url": "https://api.github.com/users/Nadni/events{/privacy}", "received_events_url": "https://api.github.com/users/Nadni/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299291, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkx", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-16T22:32:24Z", "updated_at": "2020-01-18T14:05:24Z", "closed_at": "2020-01-18T14:05:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying to import the library, I get the following error:\r\n\r\n```Traceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras_transformer\\__init__.py\", line 2, in <module>\r\n    from .transformer import *\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras_transformer\\transformer.py\", line 4, in <module>\r\n    from keras_multi_head import MultiHeadAttention\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras_multi_head\\__init__.py\", line 1, in <module>\r\n    from .multi_head import MultiHead\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras_multi_head\\multi_head.py\", line 6, in <module>\r\n    class MultiHead(keras.layers.Wrapper):\r\nAttributeError: module 'keras.layers' has no attribute 'Wrapper'\r\n```\r\nI am using keras 2.2.5 and tensorflow 2.1.0 on Windows10\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/25", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/25/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/25/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/25/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/25", "id": 536187318, "node_id": "MDU6SXNzdWU1MzYxODczMTg=", "number": 25, "title": "Questions about data input and output", "user": {"login": "zhouhao-learning", "id": 24581773, "node_id": "MDQ6VXNlcjI0NTgxNzcz", "avatar_url": "https://avatars1.githubusercontent.com/u/24581773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhouhao-learning", "html_url": "https://github.com/zhouhao-learning", "followers_url": "https://api.github.com/users/zhouhao-learning/followers", "following_url": "https://api.github.com/users/zhouhao-learning/following{/other_user}", "gists_url": "https://api.github.com/users/zhouhao-learning/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhouhao-learning/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhouhao-learning/subscriptions", "organizations_url": "https://api.github.com/users/zhouhao-learning/orgs", "repos_url": "https://api.github.com/users/zhouhao-learning/repos", "events_url": "https://api.github.com/users/zhouhao-learning/events{/privacy}", "received_events_url": "https://api.github.com/users/zhouhao-learning/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-11T07:17:15Z", "updated_at": "2019-12-18T07:36:26Z", "closed_at": "2019-12-18T07:36:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, nice to see your code, but i have a bit of confusion about data processing, hope you can answer it\r\n\r\nRegarding the following code, I don't know why the data is not taken to the last one\uff1a\r\n\r\n```\r\nfor i in range(1, len(tokens) - 1):\r\n    encode_tokens, decode_tokens = tokens[:i], tokens[i:]\r\n    encode_tokens = ['<START>'] + encode_tokens + ['<END>'] + ['<PAD>'] * (len(tokens) - len(encode_tokens))\r\n    output_tokens = decode_tokens + ['<END>', '<PAD>'] + ['<PAD>'] * (len(tokens) - len(decode_tokens))\r\n```\r\nWhy `range (1, len (tokens) -1)`, not `range (1, len (tokens))`\r\n\r\nCould you give some explanation, I don't know the purpose of doing this, thank you!\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/24", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/24/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/24/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/24/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/24", "id": 515074022, "node_id": "MDU6SXNzdWU1MTUwNzQwMjI=", "number": 24, "title": "Do I need to specify <start> and <end> of sequences", "user": {"login": "LincLabUCCS", "id": 30666434, "node_id": "MDQ6VXNlcjMwNjY2NDM0", "avatar_url": "https://avatars3.githubusercontent.com/u/30666434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LincLabUCCS", "html_url": "https://github.com/LincLabUCCS", "followers_url": "https://api.github.com/users/LincLabUCCS/followers", "following_url": "https://api.github.com/users/LincLabUCCS/following{/other_user}", "gists_url": "https://api.github.com/users/LincLabUCCS/gists{/gist_id}", "starred_url": "https://api.github.com/users/LincLabUCCS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LincLabUCCS/subscriptions", "organizations_url": "https://api.github.com/users/LincLabUCCS/orgs", "repos_url": "https://api.github.com/users/LincLabUCCS/repos", "events_url": "https://api.github.com/users/LincLabUCCS/events{/privacy}", "received_events_url": "https://api.github.com/users/LincLabUCCS/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-31T00:45:39Z", "updated_at": "2019-11-07T06:31:50Z", "closed_at": "2019-11-07T06:31:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a sequence of inputs \r\nencoder_inputs = [[11,22,35,43,6,30,0,0,0,0], \r\n                             [31,43,56,23,45,0,0,0,0]]\r\ndecoder_inputs = [[8,3,2,4,5,2,0,0,0,0],\r\n                             6,4,5,3,7,4,0,0,0,0]]                          \r\ndecoder_output =[[[8],[3],[2],[4],[5],[2],[0],[0],[0],[0]],\r\n                             [6],[4],[5],[3],[7],[4],[0],[0],[0],[0]]]\r\n\r\nMy question, Do I need to specify start and end of sequences in my case? \r\nDoes the keras-transformer already know the padding is zero? \r\n\r\nFinally, when evaluating, do I do this\r\n\r\nmodel.evaluate(x=[encoder_inputs,decoder_inputs], y=[decoder_outputs])\r\n\r\nThank you \r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/23", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/23/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/23/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/23/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/23", "id": 494377103, "node_id": "MDU6SXNzdWU0OTQzNzcxMDM=", "number": 23, "title": "why get same output with different input?", "user": {"login": "maozezhong", "id": 18650170, "node_id": "MDQ6VXNlcjE4NjUwMTcw", "avatar_url": "https://avatars2.githubusercontent.com/u/18650170?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maozezhong", "html_url": "https://github.com/maozezhong", "followers_url": "https://api.github.com/users/maozezhong/followers", "following_url": "https://api.github.com/users/maozezhong/following{/other_user}", "gists_url": "https://api.github.com/users/maozezhong/gists{/gist_id}", "starred_url": "https://api.github.com/users/maozezhong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maozezhong/subscriptions", "organizations_url": "https://api.github.com/users/maozezhong/orgs", "repos_url": "https://api.github.com/users/maozezhong/repos", "events_url": "https://api.github.com/users/maozezhong/events{/privacy}", "received_events_url": "https://api.github.com/users/maozezhong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-17T03:12:57Z", "updated_at": "2019-09-24T04:23:13Z", "closed_at": "2019-09-24T04:23:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "@CyberZHG Thanks for your sharing, I use transformer to do seq2seq task. Like, input a article and predict the abstract. When I finish training, I get almost same output with different input. Code are same as your example, data should be right, because with same data, and use lstm block as seq2seq, I got the proper output.\r\nHope for your answer, Thanks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/22", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/22/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/22/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/22/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/22", "id": 485698054, "node_id": "MDU6SXNzdWU0ODU2OTgwNTQ=", "number": 22, "title": "Using get_encoders in my model, output is all zeros", "user": {"login": "UriLawgeex", "id": 35651523, "node_id": "MDQ6VXNlcjM1NjUxNTIz", "avatar_url": "https://avatars0.githubusercontent.com/u/35651523?v=4", "gravatar_id": "", "url": "https://api.github.com/users/UriLawgeex", "html_url": "https://github.com/UriLawgeex", "followers_url": "https://api.github.com/users/UriLawgeex/followers", "following_url": "https://api.github.com/users/UriLawgeex/following{/other_user}", "gists_url": "https://api.github.com/users/UriLawgeex/gists{/gist_id}", "starred_url": "https://api.github.com/users/UriLawgeex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/UriLawgeex/subscriptions", "organizations_url": "https://api.github.com/users/UriLawgeex/orgs", "repos_url": "https://api.github.com/users/UriLawgeex/repos", "events_url": "https://api.github.com/users/UriLawgeex/events{/privacy}", "received_events_url": "https://api.github.com/users/UriLawgeex/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299297, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk3", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-27T09:35:15Z", "updated_at": "2019-09-04T16:15:42Z", "closed_at": "2019-09-04T16:15:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, thanks for all your work. I'd be very grateful if you could help me with this question:\r\nI'm trying to create a multilabel text classification model based off the transformer code. My model looks like this (I'm using a pretrained w2v embedding, so the input receives the vectorized text):\r\n\r\n\r\n```\r\nlin = Input((maxlen, w2vWordSize))  \r\ntrig_pos_embedding = TrigPosEmbedding(mode=TrigPosEmbedding.MODE_ADD, output_dim=w2vWordSize)(lin)  \r\nencoders = get_encoders(3, trig_pos_embedding, 5, 120, None, gelu)  \r\nflat = Flatten()(encoders)  \r\nd = Dense(512, activation='tanh')(flat)  \r\nd = Dropout(dov)(d)  \r\nlout = Dense(units=model_output_shape, activation='sigmoid')(d)\r\n```\r\n\r\nHowever, this model always outputs all zeros. Do you have any ideas or tips why this could be happening?\r\nThank you!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/21", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/21/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/21/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/21/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/21", "id": 476715719, "node_id": "MDU6SXNzdWU0NzY3MTU3MTk=", "number": 21, "title": "How to train a transformer model with fit_generator?", "user": {"login": "CrazyGuitarAndCode", "id": 37400691, "node_id": "MDQ6VXNlcjM3NDAwNjkx", "avatar_url": "https://avatars3.githubusercontent.com/u/37400691?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CrazyGuitarAndCode", "html_url": "https://github.com/CrazyGuitarAndCode", "followers_url": "https://api.github.com/users/CrazyGuitarAndCode/followers", "following_url": "https://api.github.com/users/CrazyGuitarAndCode/following{/other_user}", "gists_url": "https://api.github.com/users/CrazyGuitarAndCode/gists{/gist_id}", "starred_url": "https://api.github.com/users/CrazyGuitarAndCode/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CrazyGuitarAndCode/subscriptions", "organizations_url": "https://api.github.com/users/CrazyGuitarAndCode/orgs", "repos_url": "https://api.github.com/users/CrazyGuitarAndCode/repos", "events_url": "https://api.github.com/users/CrazyGuitarAndCode/events{/privacy}", "received_events_url": "https://api.github.com/users/CrazyGuitarAndCode/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-05T08:09:08Z", "updated_at": "2019-08-12T08:47:04Z", "closed_at": "2019-08-12T08:47:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "In this project, we can find that you use  model.fit to train a transformer model. But I should use mode.fit_generator because of massive data. When I code a model, I should declare the input layers's names which were defined in generator function. So, can you show me a case of transformer+mode.fit_generator ?Thanks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/20", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/20/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/20/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/20/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/20", "id": 470927459, "node_id": "MDU6SXNzdWU0NzA5Mjc0NTk=", "number": 20, "title": "star-transformer", "user": {"login": "yongzhuo", "id": 31341349, "node_id": "MDQ6VXNlcjMxMzQxMzQ5", "avatar_url": "https://avatars3.githubusercontent.com/u/31341349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yongzhuo", "html_url": "https://github.com/yongzhuo", "followers_url": "https://api.github.com/users/yongzhuo/followers", "following_url": "https://api.github.com/users/yongzhuo/following{/other_user}", "gists_url": "https://api.github.com/users/yongzhuo/gists{/gist_id}", "starred_url": "https://api.github.com/users/yongzhuo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yongzhuo/subscriptions", "organizations_url": "https://api.github.com/users/yongzhuo/orgs", "repos_url": "https://api.github.com/users/yongzhuo/repos", "events_url": "https://api.github.com/users/yongzhuo/events{/privacy}", "received_events_url": "https://api.github.com/users/yongzhuo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299293, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkz", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/enhancement", "name": "enhancement", "color": "a2eeef", "default": true, "description": "New feature or request"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-07-22T07:02:50Z", "updated_at": "2019-07-29T16:13:19Z", "closed_at": "2019-07-29T16:13:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Could you support  star-transformer is this project? Thanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/18", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/18/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/18/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/18/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/18", "id": 455619909, "node_id": "MDU6SXNzdWU0NTU2MTk5MDk=", "number": 18, "title": "get metrics accuracy in compile", "user": {"login": "kewin1807", "id": 30885438, "node_id": "MDQ6VXNlcjMwODg1NDM4", "avatar_url": "https://avatars0.githubusercontent.com/u/30885438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kewin1807", "html_url": "https://github.com/kewin1807", "followers_url": "https://api.github.com/users/kewin1807/followers", "following_url": "https://api.github.com/users/kewin1807/following{/other_user}", "gists_url": "https://api.github.com/users/kewin1807/gists{/gist_id}", "starred_url": "https://api.github.com/users/kewin1807/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kewin1807/subscriptions", "organizations_url": "https://api.github.com/users/kewin1807/orgs", "repos_url": "https://api.github.com/users/kewin1807/repos", "events_url": "https://api.github.com/users/kewin1807/events{/privacy}", "received_events_url": "https://api.github.com/users/kewin1807/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299291, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkx", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-06-13T09:02:12Z", "updated_at": "2019-06-20T10:14:39Z", "closed_at": "2019-06-20T10:14:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "When i compile the model in metrics, i can't fit the model with training data\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/17", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/17/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/17/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/17/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/17", "id": 453625341, "node_id": "MDU6SXNzdWU0NTM2MjUzNDE=", "number": 17, "title": "experiments on Real world examples", "user": {"login": "kaeflint", "id": 5113461, "node_id": "MDQ6VXNlcjUxMTM0NjE=", "avatar_url": "https://avatars1.githubusercontent.com/u/5113461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaeflint", "html_url": "https://github.com/kaeflint", "followers_url": "https://api.github.com/users/kaeflint/followers", "following_url": "https://api.github.com/users/kaeflint/following{/other_user}", "gists_url": "https://api.github.com/users/kaeflint/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaeflint/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaeflint/subscriptions", "organizations_url": "https://api.github.com/users/kaeflint/orgs", "repos_url": "https://api.github.com/users/kaeflint/repos", "events_url": "https://api.github.com/users/kaeflint/events{/privacy}", "received_events_url": "https://api.github.com/users/kaeflint/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-07T17:47:41Z", "updated_at": "2019-06-14T18:49:13Z", "closed_at": "2019-06-14T18:49:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thanks for the awesome library. \r\nI tried to run on real world NMT task on the IWSLT 2014 de-en translation task. I trained the model for about 20 epochs but during inference, the trained model failed to generate meaningful sentences. Can you make a sample run on datasets such as IWSLT or WMT ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/15", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/15/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/15/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/15/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/15", "id": 451386784, "node_id": "MDU6SXNzdWU0NTEzODY3ODQ=", "number": 15, "title": "beam search", "user": {"login": "adolf69", "id": 26019690, "node_id": "MDQ6VXNlcjI2MDE5Njkw", "avatar_url": "https://avatars2.githubusercontent.com/u/26019690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adolf69", "html_url": "https://github.com/adolf69", "followers_url": "https://api.github.com/users/adolf69/followers", "following_url": "https://api.github.com/users/adolf69/following{/other_user}", "gists_url": "https://api.github.com/users/adolf69/gists{/gist_id}", "starred_url": "https://api.github.com/users/adolf69/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adolf69/subscriptions", "organizations_url": "https://api.github.com/users/adolf69/orgs", "repos_url": "https://api.github.com/users/adolf69/repos", "events_url": "https://api.github.com/users/adolf69/events{/privacy}", "received_events_url": "https://api.github.com/users/adolf69/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299293, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkz", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/enhancement", "name": "enhancement", "color": "a2eeef", "default": true, "description": "New feature or request"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-06-03T09:42:20Z", "updated_at": "2019-06-10T12:41:43Z", "closed_at": "2019-06-10T12:41:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "how to use beam search in this lib\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/14", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/14/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/14/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/14/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/14", "id": 451327815, "node_id": "MDU6SXNzdWU0NTEzMjc4MTU=", "number": 14, "title": "**Describe the Bug**", "user": {"login": "adolf69", "id": 26019690, "node_id": "MDQ6VXNlcjI2MDE5Njkw", "avatar_url": "https://avatars2.githubusercontent.com/u/26019690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adolf69", "html_url": "https://github.com/adolf69", "followers_url": "https://api.github.com/users/adolf69/followers", "following_url": "https://api.github.com/users/adolf69/following{/other_user}", "gists_url": "https://api.github.com/users/adolf69/gists{/gist_id}", "starred_url": "https://api.github.com/users/adolf69/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adolf69/subscriptions", "organizations_url": "https://api.github.com/users/adolf69/orgs", "repos_url": "https://api.github.com/users/adolf69/repos", "events_url": "https://api.github.com/users/adolf69/events{/privacy}", "received_events_url": "https://api.github.com/users/adolf69/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-06-03T07:17:29Z", "updated_at": "2019-06-03T09:41:09Z", "closed_at": "2019-06-03T09:41:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/13", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/13/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/13/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/13/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/13", "id": 449668328, "node_id": "MDU6SXNzdWU0NDk2NjgzMjg=", "number": 13, "title": "Error in get_model() : ValueError: too many values to unpack (expected 2)", "user": {"login": "nshaud", "id": 2974890, "node_id": "MDQ6VXNlcjI5NzQ4OTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/2974890?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nshaud", "html_url": "https://github.com/nshaud", "followers_url": "https://api.github.com/users/nshaud/followers", "following_url": "https://api.github.com/users/nshaud/following{/other_user}", "gists_url": "https://api.github.com/users/nshaud/gists{/gist_id}", "starred_url": "https://api.github.com/users/nshaud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nshaud/subscriptions", "organizations_url": "https://api.github.com/users/nshaud/orgs", "repos_url": "https://api.github.com/users/nshaud/repos", "events_url": "https://api.github.com/users/nshaud/events{/privacy}", "received_events_url": "https://api.github.com/users/nshaud/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299291, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkx", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-05-29T08:30:48Z", "updated_at": "2019-06-12T10:21:30Z", "closed_at": "2019-06-06T16:27:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the Bug**\r\n\r\nCreating a Transformer model fails due to a tuple unpacking error (at least using eager execution). See below for the stacktrace, apparently the error is due to the `decoder_embed_layer`.\r\n\r\n**Version Info**\r\n\r\n* [x] I'm using the latest version\r\n\r\n**Minimal Codes To Reproduce**\r\n\r\n```python\r\nfrom keras_transformer import\r\nimport tensorflow as tf\r\ntf.enable_eager_execution()\r\n\r\nmodel = get_model(token_num=1000, embed_dim=32, encoder_num=2, decoder_num=2, head_num=4, hidden_dim=128, dropout_rate=0.05)\r\n```\r\n\r\nresults in\r\n```\r\n    377     decoder_input = keras.layers.Input(shape=(None,), name='Decoder-Input')\r\n--> 378     decoder_embed, decoder_embed_weights = decoder_embed_layer(decoder_input)\r\n    379     decoder_embed = TrigPosEmbedding(\r\n    380         mode=TrigPosEmbedding.MODE_ADD,\r\n\r\nValueError: too many values to unpack (expected 2)\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/12", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/12/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/12/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/12/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/12", "id": 448130365, "node_id": "MDU6SXNzdWU0NDgxMzAzNjU=", "number": 12, "title": "Possible bug: Encoder fed every step", "user": {"login": "veqtor", "id": 1068445, "node_id": "MDQ6VXNlcjEwNjg0NDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1068445?v=4", "gravatar_id": "", "url": "https://api.github.com/users/veqtor", "html_url": "https://github.com/veqtor", "followers_url": "https://api.github.com/users/veqtor/followers", "following_url": "https://api.github.com/users/veqtor/following{/other_user}", "gists_url": "https://api.github.com/users/veqtor/gists{/gist_id}", "starred_url": "https://api.github.com/users/veqtor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/veqtor/subscriptions", "organizations_url": "https://api.github.com/users/veqtor/orgs", "repos_url": "https://api.github.com/users/veqtor/repos", "events_url": "https://api.github.com/users/veqtor/events{/privacy}", "received_events_url": "https://api.github.com/users/veqtor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299291, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkx", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-05-24T11:53:27Z", "updated_at": "2019-05-31T14:06:30Z", "closed_at": "2019-05-31T13:06:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the Bug**\r\n\r\nIn the transformer.py .decode() loop I found what I believe to be a bug:\r\nThe encoder is fed new information at every step, an encoder should have the input sequence fed only once, to generate the encoded representation, which is then decoded step by step.\r\n\r\nedit:\r\nI think the proper achitecture would be to split encoder and decoder into two models.\r\nSo when you infer, you would run the encoder model once to get the representation", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/11", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/11/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/11/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/11/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/11", "id": 446567244, "node_id": "MDU6SXNzdWU0NDY1NjcyNDQ=", "number": 11, "title": "Is there only Multi-Head Attention? ", "user": {"login": "kaen2891", "id": 46586785, "node_id": "MDQ6VXNlcjQ2NTg2Nzg1", "avatar_url": "https://avatars0.githubusercontent.com/u/46586785?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaen2891", "html_url": "https://github.com/kaen2891", "followers_url": "https://api.github.com/users/kaen2891/followers", "following_url": "https://api.github.com/users/kaen2891/following{/other_user}", "gists_url": "https://api.github.com/users/kaen2891/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaen2891/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaen2891/subscriptions", "organizations_url": "https://api.github.com/users/kaen2891/orgs", "repos_url": "https://api.github.com/users/kaen2891/repos", "events_url": "https://api.github.com/users/kaen2891/events{/privacy}", "received_events_url": "https://api.github.com/users/kaen2891/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299293, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkz", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/enhancement", "name": "enhancement", "color": "a2eeef", "default": true, "description": "New feature or request"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-05-21T11:32:20Z", "updated_at": "2019-05-29T06:49:00Z", "closed_at": "2019-05-29T06:49:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, Thanks for your open sources. This helps great to me.\r\n\r\nI have some questions.\r\n\r\nIn \"Attention is All You Need\", the Multi-Head Attention is in encoder, decoder and the Masked Multi-Head Attention is only in the decoder part. But in your transformer code, I guess there's no mask part. Is it wrong? Or if there, would you let me know the \"Masked\" part?\r\n\r\nThanks a lot.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/9", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/9/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/9/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/9/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/9", "id": 438746077, "node_id": "MDU6SXNzdWU0Mzg3NDYwNzc=", "number": 9, "title": "Use it as a layer", "user": {"login": "guyko81", "id": 10399767, "node_id": "MDQ6VXNlcjEwMzk5NzY3", "avatar_url": "https://avatars3.githubusercontent.com/u/10399767?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guyko81", "html_url": "https://github.com/guyko81", "followers_url": "https://api.github.com/users/guyko81/followers", "following_url": "https://api.github.com/users/guyko81/following{/other_user}", "gists_url": "https://api.github.com/users/guyko81/gists{/gist_id}", "starred_url": "https://api.github.com/users/guyko81/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guyko81/subscriptions", "organizations_url": "https://api.github.com/users/guyko81/orgs", "repos_url": "https://api.github.com/users/guyko81/repos", "events_url": "https://api.github.com/users/guyko81/events{/privacy}", "received_events_url": "https://api.github.com/users/guyko81/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299293, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkz", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/enhancement", "name": "enhancement", "color": "a2eeef", "default": true, "description": "New feature or request"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-04-30T12:11:53Z", "updated_at": "2019-05-13T11:48:03Z", "closed_at": "2019-05-13T11:48:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Can you share an example where it is used as an internal layer in a model besides other keras layers? Many thanks! \r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/7", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/7/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/7/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/7/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/7", "id": 432901739, "node_id": "MDU6SXNzdWU0MzI5MDE3Mzk=", "number": 7, "title": "ValueError: Unknown layer: EmbeddingRet", "user": {"login": "Nadni", "id": 27709839, "node_id": "MDQ6VXNlcjI3NzA5ODM5", "avatar_url": "https://avatars2.githubusercontent.com/u/27709839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nadni", "html_url": "https://github.com/Nadni", "followers_url": "https://api.github.com/users/Nadni/followers", "following_url": "https://api.github.com/users/Nadni/following{/other_user}", "gists_url": "https://api.github.com/users/Nadni/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nadni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nadni/subscriptions", "organizations_url": "https://api.github.com/users/Nadni/orgs", "repos_url": "https://api.github.com/users/Nadni/repos", "events_url": "https://api.github.com/users/Nadni/events{/privacy}", "received_events_url": "https://api.github.com/users/Nadni/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299291, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkx", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-04-13T21:19:30Z", "updated_at": "2019-04-14T13:16:26Z", "closed_at": "2019-04-14T13:16:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to save and re-load the model for future use in other apps, however there is an error which I cannot work around.\r\n\r\nThis is the code:\r\n\r\n```python\r\nimport keras\r\nimport numpy as np\r\nfrom keras_transformer import get_custom_objects, get_model, decode\r\n\r\n\r\ntokens = 'all work and no play makes jack a dull boy'.split(' ')\r\ntoken_dict = {\r\n    '<PAD>': 0,\r\n    '<START>': 1,\r\n    '<END>': 2,\r\n}\r\nfor token in tokens:\r\n    if token not in token_dict:\r\n        token_dict[token] = len(token_dict)\r\n\r\nencoder_inputs_no_padding = []\r\nencoder_inputs, decoder_inputs, decoder_outputs = [], [], []\r\nfor i in range(1, len(tokens) - 1):\r\n    encode_tokens, decode_tokens = tokens[:i], tokens[i:]\r\n    encode_tokens = ['<START>'] + encode_tokens + ['<END>'] + ['<PAD>'] * (len(tokens) - len(encode_tokens))\r\n    output_tokens = decode_tokens + ['<END>', '<PAD>'] + ['<PAD>'] * (len(tokens) - len(decode_tokens))\r\n    decode_tokens = ['<START>'] + decode_tokens + ['<END>'] + ['<PAD>'] * (len(tokens) - len(decode_tokens))\r\n    encode_tokens = list(map(lambda x: token_dict[x], encode_tokens))\r\n    decode_tokens = list(map(lambda x: token_dict[x], decode_tokens))\r\n    output_tokens = list(map(lambda x: [token_dict[x]], output_tokens))\r\n    encoder_inputs_no_padding.append(encode_tokens[:i + 2])\r\n    encoder_inputs.append(encode_tokens)\r\n    decoder_inputs.append(decode_tokens)\r\n    decoder_outputs.append(output_tokens)\r\n\r\nmodel = get_model(\r\n    token_num=len(token_dict),\r\n    embed_dim=30,\r\n    encoder_num=3,\r\n    decoder_num=2,\r\n    head_num=3,\r\n    hidden_dim=120,\r\n    attention_activation='relu',\r\n    feed_forward_activation='relu',\r\n    dropout_rate=0.05,\r\n    embed_weights=np.random.random((13, 30)),\r\n)\r\nmodel.compile(\r\n    optimizer=keras.optimizers.Adam(),\r\n    loss=keras.losses.sparse_categorical_crossentropy,\r\n    metrics={})\r\n\r\nmodel.fit(\r\n    x=[np.asarray(encoder_inputs * 500), np.asarray(decoder_inputs * 500)],\r\n    y=np.asarray(decoder_outputs * 500),\r\n    epochs=3,\r\n)\r\n\r\nmodel.save('saved_model.hdf5')\r\n\r\nmodel = keras.models.load_model('saved_model.hdf5')\r\n```\r\n\r\nand the error that I get is:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"example.py\", line 56, in <module>\r\n    model = keras.models.load_model('saved_model.hdf5')\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\engine\\saving.py\", line 419, in load_model\r\n    model = _deserialize_model(f, custom_objects, compile)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\engine\\saving.py\", line 225, in _deserialize_model\r\n    model = model_from_config(model_config, custom_objects=custom_objects)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\engine\\saving.py\", line 458, in model_from_config\r\n    return deserialize(config, custom_objects=custom_objects)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\layers\\__init__.py\", line 55, in deserialize\r\n    printable_module_name='layer')\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\utils\\generic_utils.py\", line 145, in deserialize_keras_object\r\n    list(custom_objects.items())))\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\engine\\network.py\", line 1022, in from_config\r\n    process_layer(layer_data)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\engine\\network.py\", line 1008, in process_layer\r\n    custom_objects=custom_objects)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\layers\\__init__.py\", line 55, in deserialize\r\n    printable_module_name='layer')\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\keras\\utils\\generic_utils.py\", line 138, in deserialize_keras_object\r\n    ': ' + class_name)\r\nValueError: Unknown layer: EmbeddingRet\r\n```\r\n\r\nI am using Python 3.7.3, TensorFlow 1.13.1 and keras 2.2.4", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/6", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/6/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/6/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/6/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/6", "id": 419320219, "node_id": "MDU6SXNzdWU0MTkzMjAyMTk=", "number": 6, "title": "Tensorflow dependency remove", "user": {"login": "flydsc", "id": 4379221, "node_id": "MDQ6VXNlcjQzNzkyMjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/4379221?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flydsc", "html_url": "https://github.com/flydsc", "followers_url": "https://api.github.com/users/flydsc/followers", "following_url": "https://api.github.com/users/flydsc/following{/other_user}", "gists_url": "https://api.github.com/users/flydsc/gists{/gist_id}", "starred_url": "https://api.github.com/users/flydsc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flydsc/subscriptions", "organizations_url": "https://api.github.com/users/flydsc/orgs", "repos_url": "https://api.github.com/users/flydsc/repos", "events_url": "https://api.github.com/users/flydsc/events{/privacy}", "received_events_url": "https://api.github.com/users/flydsc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1120299293, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjkz", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/enhancement", "name": "enhancement", "color": "a2eeef", "default": true, "description": "New feature or request"}, {"id": 1120299298, "node_id": "MDU6TGFiZWwxMTIwMjk5Mjk4", "url": "https://api.github.com/repos/CyberZHG/keras-transformer/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-03-11T06:58:24Z", "updated_at": "2019-03-18T08:28:59Z", "closed_at": "2019-03-18T08:28:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, thank you for these handy tool box, really helpful.\r\n\r\nAnd one issue I met is I had to download tensorflow every time when I tried to install from pypi or this git repository.\r\n\r\nI think the reason is I installed tensorflow GPU version, the package's name is tensorflow-gpu in pypi, however in the dependency file, we always get name of tensorflow, like in requirement file.\r\n\r\nMay I suggest to remove some common basic packages like tensorflow and keras since users open had these tools installed already.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/5", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/5/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/5/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/5", "id": 410735573, "node_id": "MDU6SXNzdWU0MTA3MzU1NzM=", "number": 5, "title": "after stacked decoder layer\uff0cI think it should be concatenate with a linear and softmax layer.", "user": {"login": "flyboyer", "id": 22725967, "node_id": "MDQ6VXNlcjIyNzI1OTY3", "avatar_url": "https://avatars3.githubusercontent.com/u/22725967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flyboyer", "html_url": "https://github.com/flyboyer", "followers_url": "https://api.github.com/users/flyboyer/followers", "following_url": "https://api.github.com/users/flyboyer/following{/other_user}", "gists_url": "https://api.github.com/users/flyboyer/gists{/gist_id}", "starred_url": "https://api.github.com/users/flyboyer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flyboyer/subscriptions", "organizations_url": "https://api.github.com/users/flyboyer/orgs", "repos_url": "https://api.github.com/users/flyboyer/repos", "events_url": "https://api.github.com/users/flyboyer/events{/privacy}", "received_events_url": "https://api.github.com/users/flyboyer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-02-15T11:54:05Z", "updated_at": "2019-02-19T10:33:38Z", "closed_at": "2019-02-19T10:33:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "after stacked decoder layer\uff0cI think it should be concatenate with a linear and softmax layer.but in your code, it's \r\n`dense_layer = EmbeddingSim(\r\n        trainable=trainable,\r\n        name='Output',\r\n    )([decoded_layer, decoder_embed_weights])`\r\nwhy do this operate?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/3", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/3/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/3/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/3/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/3", "id": 396247112, "node_id": "MDU6SXNzdWUzOTYyNDcxMTI=", "number": 3, "title": "Default value max_len=None in keras_transformer.decode is dangerous", "user": {"login": "Koziev", "id": 5499222, "node_id": "MDQ6VXNlcjU0OTkyMjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/5499222?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Koziev", "html_url": "https://github.com/Koziev", "followers_url": "https://api.github.com/users/Koziev/followers", "following_url": "https://api.github.com/users/Koziev/following{/other_user}", "gists_url": "https://api.github.com/users/Koziev/gists{/gist_id}", "starred_url": "https://api.github.com/users/Koziev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Koziev/subscriptions", "organizations_url": "https://api.github.com/users/Koziev/orgs", "repos_url": "https://api.github.com/users/Koziev/repos", "events_url": "https://api.github.com/users/Koziev/events{/privacy}", "received_events_url": "https://api.github.com/users/Koziev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-06T10:43:31Z", "updated_at": "2019-01-07T16:23:36Z", "closed_at": "2019-01-07T16:23:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "It is not a bug really. But I think changing it to something like max_len=10000 in https://github.com/CyberZHG/keras-transformer/blob/master/keras_transformer/transformer.py#L395 can be reasonable.\r\n\r\nI have spent a half of day debugging the model, trying to find the reason it hangs *sometimes* when predicting with (under)trained model. Well, the problem is <END> sometimes not selected as next token (https://github.com/CyberZHG/keras-transformer/blob/master/keras_transformer/transformer.py#L428), so the condition in https://github.com/CyberZHG/keras-transformer/blob/master/keras_transformer/transformer.py#L430 is always False.\r\n\r\nAnother option would be raising an error when length of tokens list exceeds some reasonable limit.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/2", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/2/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/2/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/2/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/2", "id": 394066447, "node_id": "MDU6SXNzdWUzOTQwNjY0NDc=", "number": 2, "title": "unexpected keyword argument 'activation'", "user": {"login": "weize07", "id": 6076187, "node_id": "MDQ6VXNlcjYwNzYxODc=", "avatar_url": "https://avatars3.githubusercontent.com/u/6076187?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weize07", "html_url": "https://github.com/weize07", "followers_url": "https://api.github.com/users/weize07/followers", "following_url": "https://api.github.com/users/weize07/following{/other_user}", "gists_url": "https://api.github.com/users/weize07/gists{/gist_id}", "starred_url": "https://api.github.com/users/weize07/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weize07/subscriptions", "organizations_url": "https://api.github.com/users/weize07/orgs", "repos_url": "https://api.github.com/users/weize07/repos", "events_url": "https://api.github.com/users/weize07/events{/privacy}", "received_events_url": "https://api.github.com/users/weize07/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-26T02:25:34Z", "updated_at": "2018-12-26T02:41:26Z", "closed_at": "2018-12-26T02:41:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please update examples in readme, use  `feed_forward_activation` or `attention_activation` instead of `activation` for get_model().", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/1", "repository_url": "https://api.github.com/repos/CyberZHG/keras-transformer", "labels_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/1/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-transformer/issues/1/events", "html_url": "https://github.com/CyberZHG/keras-transformer/issues/1", "id": 381462978, "node_id": "MDU6SXNzdWUzODE0NjI5Nzg=", "number": 1, "title": "Invalid head number 3 with the given input dim 128", "user": {"login": "gengkeng", "id": 45089681, "node_id": "MDQ6VXNlcjQ1MDg5Njgx", "avatar_url": "https://avatars1.githubusercontent.com/u/45089681?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gengkeng", "html_url": "https://github.com/gengkeng", "followers_url": "https://api.github.com/users/gengkeng/followers", "following_url": "https://api.github.com/users/gengkeng/following{/other_user}", "gists_url": "https://api.github.com/users/gengkeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/gengkeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gengkeng/subscriptions", "organizations_url": "https://api.github.com/users/gengkeng/orgs", "repos_url": "https://api.github.com/users/gengkeng/repos", "events_url": "https://api.github.com/users/gengkeng/events{/privacy}", "received_events_url": "https://api.github.com/users/gengkeng/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-16T06:20:16Z", "updated_at": "2018-11-19T01:06:05Z", "closed_at": "2018-11-19T01:06:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "when i give a pre_train embedding matrix where the dimension is 128\uff0cand choose the  head_num=3,it occurs this question\uff0chow can i to solve it ?", "performed_via_github_app": null, "score": 1.0}]}