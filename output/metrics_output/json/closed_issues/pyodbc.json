{"total_count": 485, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/807", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/807/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/807/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/807/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/807", "id": 679738213, "node_id": "MDU6SXNzdWU2Nzk3MzgyMTM=", "number": 807, "title": "Filter._in(list) breaking?", "user": {"login": "varmanishant", "id": 4084912, "node_id": "MDQ6VXNlcjQwODQ5MTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/4084912?v=4", "gravatar_id": "", "url": "https://api.github.com/users/varmanishant", "html_url": "https://github.com/varmanishant", "followers_url": "https://api.github.com/users/varmanishant/followers", "following_url": "https://api.github.com/users/varmanishant/following{/other_user}", "gists_url": "https://api.github.com/users/varmanishant/gists{/gist_id}", "starred_url": "https://api.github.com/users/varmanishant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/varmanishant/subscriptions", "organizations_url": "https://api.github.com/users/varmanishant/orgs", "repos_url": "https://api.github.com/users/varmanishant/repos", "events_url": "https://api.github.com/users/varmanishant/events{/privacy}", "received_events_url": "https://api.github.com/users/varmanishant/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-16T11:28:58Z", "updated_at": "2020-08-16T15:08:17Z", "closed_at": "2020-08-16T13:58:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.8\r\n- pyodbc: 4.0.26\r\n- OS: Linux\r\n- DB: MSSQL\r\n- driver: MSODBC 17\r\n\r\n### Issue\r\n\r\nOne of our queries that was working in Python 2 + mxODBC is not working in Python 3 + pyodbc; it raises an error like this: `Maximum number of parameters in the sql query is 2100`. It seems to be something specific to the way pyodbc handles the `_in` operator -- it seems to treat it as mutiple params as opposed to a single param?\r\n\r\nIs it correct to send a list as multiple params, because the param list is going to be proportional to the length of list? Won't it break somewhere or the other? 2100 is not a very uncommon limit. I think it looks a bit odd to do it this way; I would have preferred concatenating the `list` into a single `string` because the DB doesn't understand the `list` datatype. Type casting to a string doesn't work, so is there a good way to achieve this without going down to the bare-query level? Some solutions like **chunking** all the queries seems like some-work-to-do and also I am not sure if it is a good solution to this problem!\r\n\r\n```\r\nimport sqlalchemy\r\nimport sqlalchemy.orm\r\n\r\nfrom sqlalchemy import MetaData, Table\r\nfrom sqlalchemy.ext.declarative import declarative_base\r\n\r\nfrom  sqlalchemy.orm.session import Session\r\n\r\nBase = declarative_base()\r\n\r\ncreate_tables = \"\"\"\r\nCREATE TABLE products(\r\n    idn NUMERIC(8) PRIMARY KEY\r\n);\r\n\"\"\"\r\n\r\ncheck_tables = \"\"\"   \r\nSELECT * FROM products;\r\n\"\"\"\r\n\r\ninsert_values = \"\"\"\r\nINSERT INTO products\r\n(idn)\r\nvalues\r\n(1),\r\n(2);\r\n\"\"\"\r\n\r\ndelete_tables = \"\"\"\r\nDROP TABLE products;\r\n\"\"\"\r\n\r\nengine = sqlalchemy.create_engine('mssql+pyodbc://user:password@dsn')\r\nconnection = engine.connect()\r\ncursor = engine.raw_connection().cursor()\r\nSession = sqlalchemy.orm.sessionmaker(bind=connection)\r\nsession = Session()\r\n\r\nsession.execute(create_tables)\r\n\r\nmetadata = MetaData(connection)\r\n\r\nclass Products(Base):\r\n   __table__ = Table('products', metadata, autoload=True)\r\n\r\ntry:\r\n    session.execute(check_tables)\r\n    session.execute(insert_values)\r\n    session.commit()\r\n    query = session.query(Products).filter(\r\n        Products.idn.in_(list(range(0, 3000)))\r\n    )\r\n    query.all()\r\n    f = open(\"query.sql\", \"w\")\r\n    f.write(str(query))\r\n    f.close()\r\nfinally:\r\n    session.execute(delete_tables)\r\n    session.commit()\r\n```\r\n\r\n### References\r\n\r\nInternal: https://github.com/mkleehammer/pyodbc/issues/120\r\nInternal: https://github.com/mkleehammer/pyodbc/issues/576\r\nStackOverflow: [_in operator using PyODBC and SQL Server](https://stackoverflow.com/questions/4819356/sql-in-operator-using-pyodbc-and-sql-server)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/804", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/804/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/804/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/804/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/804", "id": 675704436, "node_id": "MDU6SXNzdWU2NzU3MDQ0MzY=", "number": 804, "title": "MS Access SQL with column data type number", "user": {"login": "diegobill", "id": 1781321, "node_id": "MDQ6VXNlcjE3ODEzMjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1781321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/diegobill", "html_url": "https://github.com/diegobill", "followers_url": "https://api.github.com/users/diegobill/followers", "following_url": "https://api.github.com/users/diegobill/following{/other_user}", "gists_url": "https://api.github.com/users/diegobill/gists{/gist_id}", "starred_url": "https://api.github.com/users/diegobill/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/diegobill/subscriptions", "organizations_url": "https://api.github.com/users/diegobill/orgs", "repos_url": "https://api.github.com/users/diegobill/repos", "events_url": "https://api.github.com/users/diegobill/events{/privacy}", "received_events_url": "https://api.github.com/users/diegobill/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-09T13:56:50Z", "updated_at": "2020-08-11T13:06:10Z", "closed_at": "2020-08-11T13:06:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Environment\r\n\r\n- Python: 3.6.9\r\n- pyodbc: 4.0.27\r\n- OS: Ubuntu 18.04\r\n- DB: Microsoft Access 97\r\n- driver: MDBTools\r\n\r\n### Issue\r\n\r\nWhen I execute the SQL \"select CircuitName, Street, City, State, Zip, VoicePhone, NumberOfScreens from TheatreProfile\" the code bellow works without error, but when I add one column with data type \"Number\", for example \"Theatre1Cap\", I receive the error bellow:\r\n\r\nPython Error code line:\r\n```\r\nimport pyodbc\r\nconn_str = 'DRIVER={MDBTools};DBQ=/mnt/SensibleDatabase/Config/BP_Settings.mdb'\r\ncnxn = pyodbc.connect(conn_str, autocommit=True)\r\n# I also tried the encodings iso-8859-1, utf-8, utf-32le and I also tried without the lines setdecoding and setencoding bellow\r\ncnxn.setdecoding(pyodbc.SQL_CHAR, encoding='iso-8859-5')\r\ncnxn.setdecoding(pyodbc.SQL_WCHAR, encoding='iso-8859-5')\r\ncnxn.setdecoding(pyodbc.SQL_WMETADATA, encoding='iso-8859-5')\r\ncnxn.setencoding(encoding='iso-8859-5')\r\ncrsr = cnxn.cursor()\r\ncrsr.execute(\"select CircuitName, Street, City, State, Zip, VoicePhone, NumberOfScreens, Theatre1Cap, Theatre2Cap, Theatre3Cap, Theatre4Cap, Theatre5Cap, Theatre6Cap, Theatre7Cap, Theatre8Cap, Theatre9Cap, Theatre10Cap, Theatre11Cap, Theatre12Cap, Theatre13Cap, Theatre14Cap, Theatre15Cap, Theatre16Cap, Theatre17Cap, Theatre18Cap, Theatre19Cap, Theatre20Cap, Theatre21Cap, Theatre22Cap, Theatre23Cap, Theatre24Cap, Theatre25Cap, Theatre26Cap, Theatre27Cap, Theatre28Cap, Theatre29Cap, Theatre30Cap from TheatreProfile\").fetchone()\r\n```\r\n\r\nThe .mdb file directory is a windows share mounted on my ubuntu:\r\n```\r\nsudo mount -t cifs -o username=xxx,password=xxx //192.168.15.9/Database /mnt/Database\r\n```\r\n\r\n.mdb charset:\r\n```\r\n$ encguess /mnt/SensibleDatabase/Config/BP_Settings.mdb\r\n/mnt/SensibleDatabase/Config/BP_Settings.mdb\tUTF-32LE\r\n$ uchardet /mnt/SensibleDatabase/Config/BP_Settings.mdb\r\nISO-8859-5\r\n```\r\n\r\nPython Error Output:\r\n```\r\npyodbc.Error: ('HY000', 'The driver did not supply an error!')\r\n```\r\n\r\nODBC trace log:\r\n```\r\n[ODBC][5487][1596979100.892590][__handles.c][460]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tEnvironment = 0x7fd4e00018a0\r\n[ODBC][5487][1596979100.892971][SQLSetEnvAttr.c][189]\r\n\t\tEntry:\r\n\t\t\tEnvironment = 0x7fd4e00018a0\r\n\t\t\tAttribute = SQL_ATTR_ODBC_VERSION\r\n\t\t\tValue = 0x3\r\n\t\t\tStrLen = 4\r\n[ODBC][5487][1596979100.892996][SQLSetEnvAttr.c][381]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.893018][SQLAllocHandle.c][377]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 2\r\n\t\t\tInput Handle = 0x7fd4e00018a0\r\n[ODBC][5487][1596979100.893039][SQLAllocHandle.c][493]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tOutput Handle = 0x7fd4e0002a50\r\n[ODBC][5487][1596979100.894907][SQLDriverConnectW.c][290]\r\n\t\tEntry:\r\n\t\t\tConnection = 0x7fd4e0002a50\r\n\t\t\tWindow Hdl = (nil)\r\n\t\t\tStr In = [DRIVER={MDBTools};DBQ=/mnt/SensibleDatabase/Config/BP_Settings.mdb][length = 66 (SQL_NTS)]\r\n\t\t\tStr Out = (nil)\r\n\t\t\tStr Out Max = 0\r\n\t\t\tStr Out Ptr = (nil)\r\n\t\t\tCompletion = 0\r\n\t\tUNICODE Using encoding ASCII 'UTF-8' and UNICODE 'UTF-16LE'\r\n\r\n[ODBC][5487][1596979100.905322][SQLDriverConnectW.c][914]\r\n\t\tExit:[SQL_SUCCESS]                    \r\n\t\t\tConnection Out [[NULL]]\r\n[ODBC][5487][1596979100.905556][SQLGetInfo.c][236]\r\n\t\tEntry:\r\n\t\t\tConnection = 0x7fd4e0002a50\r\n\t\t\tInfo Type = SQL_DRIVER_ODBC_VER (77)\r\n\t\t\tInfo Value = 0x7fd4e7ffd080\r\n\t\t\tBuffer Length = 20\r\n\t\t\tStrLen = 0x7fd4e7ffd046\r\n[ODBC][5487][1596979100.905653][SQLGetInfo.c][236]\r\n\t\tEntry:\r\n\t\t\tConnection = 0x7fd4e0002a50\r\n\t\t\tInfo Type = SQL_DESCRIBE_PARAMETER (10002)\r\n\t\t\tInfo Value = 0x7fd4e7ffd07e\r\n\t\t\tBuffer Length = 2\r\n\t\t\tStrLen = 0x7fd4e7ffd046\r\n[ODBC][5487][1596979100.905736][SQLGetInfo.c][236]\r\n\t\tEntry:\r\n\t\t\tConnection = 0x7fd4e0002a50\r\n\t\t\tInfo Type = SQL_NEED_LONG_DATA_LEN (111)\r\n\t\t\tInfo Value = 0x7fd4e7ffd07e\r\n\t\t\tBuffer Length = 2\r\n\t\t\tStrLen = 0x7fd4e7ffd046\r\n[ODBC][5487][1596979100.905818][SQLAllocHandle.c][540]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e0002a50\r\n[ODBC][5487][1596979100.905903][SQLAllocHandle.c][1085]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tOutput Handle = 0x7fd4e00348b0\r\n[ODBC][5487][1596979100.905974][SQLGetTypeInfo.c][168]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00348b0\r\n\t\t\tData Type = SQL_VARCHAR\r\n[ODBC][5487][1596979100.906089][SQLGetTypeInfo.c][321]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.906161][SQLFetch.c][162]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00348b0\r\n[ODBC][5487][1596979100.906227][SQLFetch.c][352]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.906289][SQLGetData.c][237]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00348b0\r\n\t\t\tColumn Number = 3\r\n\t\t\tTarget Type = 4 SQL_INTEGER\r\n\t\t\tBuffer Length = 4\r\n\t\t\tTarget Value = 0x7fd4e7ffd048\r\n\t\t\tStrLen Or Ind = (nil)\r\n[ODBC][5487][1596979100.906369][SQLGetData.c][545]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tBuffer = [255]                \r\n\t\t\tStrlen Or Ind = NULLPTR\r\n[ODBC][5487][1596979100.906433][SQLFreeStmt.c][144]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00348b0\r\n\t\t\tOption = 0\r\n[ODBC][5487][1596979100.906521][SQLFreeStmt.c][266]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.906581][SQLFreeHandle.c][387]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e00348b0\r\n[ODBC][5487][1596979100.906654][SQLFreeHandle.c][490]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.906716][SQLAllocHandle.c][540]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e0002a50\r\n[ODBC][5487][1596979100.906789][SQLAllocHandle.c][1085]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tOutput Handle = 0x7fd4e0038990\r\n[ODBC][5487][1596979100.906851][SQLGetTypeInfo.c][168]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e0038990\r\n\t\t\tData Type = Unknown(-9)\r\n[ODBC][5487][1596979100.906931][SQLGetTypeInfo.c][321]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.906991][SQLFetch.c][162]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e0038990\r\n[ODBC][5487][1596979100.907051][SQLFetch.c][352]\r\n\t\tExit:[SQL_NO_DATA]\r\n[ODBC][5487][1596979100.907112][SQLFreeStmt.c][144]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e0038990\r\n\t\t\tOption = 0\r\n[ODBC][5487][1596979100.907177][SQLFreeStmt.c][266]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.907235][SQLFreeHandle.c][387]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e0038990\r\n[ODBC][5487][1596979100.907301][SQLFreeHandle.c][490]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.907358][SQLAllocHandle.c][540]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e0002a50\r\n[ODBC][5487][1596979100.907422][SQLAllocHandle.c][1085]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tOutput Handle = 0x7fd4e0038990\r\n[ODBC][5487][1596979100.907480][SQLGetTypeInfo.c][168]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e0038990\r\n\t\t\tData Type = SQL_VARBINARY\r\n[ODBC][5487][1596979100.907558][SQLGetTypeInfo.c][321]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.907628][SQLFetch.c][162]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e0038990\r\n[ODBC][5487][1596979100.907691][SQLFetch.c][352]\r\n\t\tExit:[SQL_NO_DATA]\r\n[ODBC][5487][1596979100.907745][SQLFreeStmt.c][144]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e0038990\r\n\t\t\tOption = 0\r\n[ODBC][5487][1596979100.907814][SQLFreeStmt.c][266]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.907869][SQLFreeHandle.c][387]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e0038990\r\n[ODBC][5487][1596979100.907943][SQLFreeHandle.c][490]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.908002][SQLAllocHandle.c][540]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e0002a50\r\n[ODBC][5487][1596979100.908063][SQLAllocHandle.c][1085]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tOutput Handle = 0x7fd4e00367d0\r\n[ODBC][5487][1596979100.908115][SQLGetTypeInfo.c][168]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tData Type = SQL_TYPE_TIMESTAMP\r\n[ODBC][5487][1596979100.908179][SQLGetTypeInfo.c][321]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.908226][SQLFetch.c][162]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n[ODBC][5487][1596979100.908273][SQLFetch.c][352]\r\n\t\tExit:[SQL_NO_DATA]\r\n[ODBC][5487][1596979100.908321][SQLFreeStmt.c][144]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tOption = 0\r\n[ODBC][5487][1596979100.908375][SQLFreeStmt.c][266]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.908423][SQLFreeHandle.c][387]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e00367d0\r\n[ODBC][5487][1596979100.908482][SQLFreeHandle.c][490]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.910955][SQLAllocHandle.c][540]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 3\r\n\t\t\tInput Handle = 0x7fd4e0002a50\r\n[ODBC][5487][1596979100.911086][SQLAllocHandle.c][1085]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tOutput Handle = 0x7fd4e00367d0\r\n[ODBC][5487][1596979100.911331][SQLFreeStmt.c][144]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tOption = 0\r\n[ODBC][5487][1596979100.911401][SQLFreeStmt.c][266]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.911534][SQLExecDirect.c][240]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tSQL = [\r\n            select CircuitName, Street, City, State, Zip, VoicePhone, NumberOfScreens,\r\n            Theatre1Cap, Theatre2Cap, Th...][length = 574]\r\n[ODBC][5487][1596979100.927042][SQLExecDirect.c][521]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979100.927112][SQLRowCount.c][173]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tRow Count = 0x7fd4e7ffd310\r\n[ODBC][5487][1596979100.927133][SQLRowCount.c][247]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tRow Count = 0x7fd4e7ffd310 -> 0\r\n[ODBC][5487][1596979100.927171][SQLNumResultCols.c][156]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Count = 0x7fd4e7ffd308\r\n[ODBC][5487][1596979100.927218][SQLNumResultCols.c][251]\r\n\t\tExit:[SQL_SUCCESS]\r\n\t\t\tCount = 0x7fd4e7ffd308 -> 37\r\n[ODBC][5487][1596979100.927271][SQLDescribeCol.c][247]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 1\r\n\t\t\tColumn Name = 0x7fd4e7ffd1a0\r\n\t\t\tBuffer Length = 200\r\n\t\t\tName Length = 0x7fd4e7ffd188\r\n\t\t\tData Type = 0x7fd4e7ffd18a\r\n\t\t\tColumn Size = 0x7fd4e7ffd190\r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c\r\n\t\t\tNullable = 0x7fd4e7ffd18e\r\n[ODBC][5487][1596979100.927327][SQLDescribeCol.c][504]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tColumn Name = [CircuitName]                \r\n\t\t\tData Type = 0x7fd4e7ffd18a -> 12                \r\n\t\t\tColumn Size = 0x7fd4e7ffd190 -> 30                \r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c -> 0                \r\n\t\t\tNullable = 0x7fd4e7ffd18e -> 1\r\n[ODBC][5487][1596979100.927375][SQLDescribeCol.c][247]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 2\r\n\t\t\tColumn Name = 0x7fd4e7ffd1a0\r\n\t\t\tBuffer Length = 200\r\n\t\t\tName Length = 0x7fd4e7ffd188\r\n\t\t\tData Type = 0x7fd4e7ffd18a\r\n\t\t\tColumn Size = 0x7fd4e7ffd190\r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c\r\n\t\t\tNullable = 0x7fd4e7ffd18e\r\n[ODBC][5487][1596979100.927426][SQLDescribeCol.c][504]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tColumn Name = [Street]                \r\n\t\t\tData Type = 0x7fd4e7ffd18a -> 12                \r\n\t\t\tColumn Size = 0x7fd4e7ffd190 -> 50                \r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c -> 0                \r\n\t\t\tNullable = 0x7fd4e7ffd18e -> 1\r\n[ODBC][5487][1596979100.927472][SQLDescribeCol.c][247]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 3\r\n\t\t\tColumn Name = 0x7fd4e7ffd1a0\r\n\t\t\tBuffer Length = 200\r\n\t\t\tName Length = 0x7fd4e7ffd188\r\n\t\t\tData Type = 0x7fd4e7ffd18a\r\n\t\t\tColumn Size = 0x7fd4e7ffd190\r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c\r\n\t\t\tNullable = 0x7fd4e7ffd18e\r\n[ODBC][5487][1596979100.927524][SQLDescribeCol.c][504]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tColumn Name = [City]                \r\n\t\t\tData Type = 0x7fd4e7ffd18a -> 12                \r\n\t\t\tColumn Size = 0x7fd4e7ffd190 -> 50                \r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c -> 0                \r\n\t\t\tNullable = 0x7fd4e7ffd18e -> 1\r\n[ODBC][5487][1596979100.927577][SQLDescribeCol.c][247]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 4\r\n\t\t\tColumn Name = 0x7fd4e7ffd1a0\r\n\t\t\tBuffer Length = 200\r\n\t\t\tName Length = 0x7fd4e7ffd188\r\n\t\t\tData Type = 0x7fd4e7ffd18a\r\n\t\t\tColumn Size = 0x7fd4e7ffd190\r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c\r\n\t\t\tNullable = 0x7fd4e7ffd18e\r\n[ODBC][5487][1596979100.927652][SQLDescribeCol.c][504]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tColumn Name = [State]                \r\n\t\t\tData Type = 0x7fd4e7ffd18a -> 12                \r\n\t\t\tColumn Size = 0x7fd4e7ffd190 -> 2                \r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c -> 0                \r\n\t\t\tNullable = 0x7fd4e7ffd18e -> 1\r\n[ODBC][5487][1596979100.927726][SQLDescribeCol.c][247]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 5\r\n\t\t\tColumn Name = 0x7fd4e7ffd1a0\r\n\t\t\tBuffer Length = 200\r\n\t\t\tName Length = 0x7fd4e7ffd188\r\n\t\t\tData Type = 0x7fd4e7ffd18a\r\n\t\t\tColumn Size = 0x7fd4e7ffd190\r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c\r\n\t\t\tNullable = 0x7fd4e7ffd18e\r\n[ODBC][5487][1596979100.927785][SQLDescribeCol.c][504]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tColumn Name = [Zip]                \r\n\t\t\tData Type = 0x7fd4e7ffd18a -> 12                \r\n\t\t\tColumn Size = 0x7fd4e7ffd190 -> 11                \r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c -> 0                \r\n\t\t\tNullable = 0x7fd4e7ffd18e -> 1\r\n[ODBC][5487][1596979100.927852][SQLDescribeCol.c][247]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 6\r\n\t\t\tColumn Name = 0x7fd4e7ffd1a0\r\n\t\t\tBuffer Length = 200\r\n\t\t\tName Length = 0x7fd4e7ffd188\r\n\t\t\tData Type = 0x7fd4e7ffd18a\r\n\t\t\tColumn Size = 0x7fd4e7ffd190\r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c\r\n\t\t\tNullable = 0x7fd4e7ffd18e\r\n[ODBC][5487][1596979100.927984][SQLDescribeCol.c][504]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tColumn Name = [VoicePhone]                \r\n\t\t\tData Type = 0x7fd4e7ffd18a -> 12                \r\n\t\t\tColumn Size = 0x7fd4e7ffd190 -> 20                \r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c -> 0                \r\n\t\t\tNullable = 0x7fd4e7ffd18e -> 1\r\n[ODBC][5487][1596979100.928177][SQLDescribeCol.c][247]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 7\r\n\t\t\tColumn Name = 0x7fd4e7ffd1a0\r\n\t\t\tBuffer Length = 200\r\n\t\t\tName Length = 0x7fd4e7ffd188\r\n\t\t\tData Type = 0x7fd4e7ffd18a\r\n\t\t\tColumn Size = 0x7fd4e7ffd190\r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c\r\n\t\t\tNullable = 0x7fd4e7ffd18e\r\n[ODBC][5487][1596979100.928273][SQLDescribeCol.c][504]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tColumn Name = [NumberOfScreens]                \r\n\t\t\tData Type = 0x7fd4e7ffd18a -> 12                \r\n\t\t\tColumn Size = 0x7fd4e7ffd190 -> 2                \r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c -> 0                \r\n\t\t\tNullable = 0x7fd4e7ffd18e -> 1\r\n[ODBC][5487][1596979100.928346][SQLDescribeCol.c][247]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 8\r\n\t\t\tColumn Name = 0x7fd4e7ffd1a0\r\n\t\t\tBuffer Length = 200\r\n\t\t\tName Length = 0x7fd4e7ffd188\r\n\t\t\tData Type = 0x7fd4e7ffd18a\r\n\t\t\tColumn Size = 0x7fd4e7ffd190\r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c\r\n\t\t\tNullable = 0x7fd4e7ffd18e\r\n[ODBC][5487][1596979100.928377][SQLDescribeCol.c][504]\r\n\t\tExit:[SQL_SUCCESS]                \r\n\t\t\tColumn Name = [Theatre1Cap]                \r\n\t\t\tData Type = 0x7fd4e7ffd18a -> 4                \r\n\t\t\tColumn Size = 0x7fd4e7ffd190 -> 4                \r\n\t\t\tDecimal Digits = 0x7fd4e7ffd18c -> 0                \r\n\t\t\tNullable = 0x7fd4e7ffd18e -> 0\r\n[ODBC][5487][1596979100.928406][SQLColAttribute.c][294]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tColumn Number = 8\r\n\t\t\tField Identifier = SQL_DESC_UNSIGNED\r\n\t\t\tCharacter Attr = (nil)\r\n\t\t\tBuffer Length = 0\r\n\t\t\tString Length = (nil)\r\n\t\t\tNumeric Attribute = 0x7fd4e7ffd198\r\n[ODBC][5487][1596979100.928438][SQLColAttribute.c][709]\r\n\t\tExit:[SQL_ERROR]\r\n[ODBC][5487][1596979100.928471][SQLGetDiagRecW.c][535]\r\n\t\tEntry:\r\n\t\t\tStatement = 0x7fd4e00367d0\r\n\t\t\tRec Number = 1\r\n\t\t\tSQLState = 0x7fd4e7ffc914\r\n\t\t\tNative = 0x7fd4e7ffc910\r\n\t\t\tMessage Text = 0x7fd4e7ffc920\r\n\t\t\tBuffer Length = 1023\r\n\t\t\tText Len Ptr = 0x7fd4e7ffc90e\r\n[ODBC][5487][1596979100.928502][SQLGetDiagRecW.c][596]\r\n\t\tExit:[SQL_NO_DATA]\r\n[ODBC][5487][1596979104.307835][SQLDisconnect.c][208]\r\n\t\tEntry:\r\n\t\t\tConnection = 0x7fd4e0002a50\r\n[ODBC][5487][1596979104.310806][SQLDisconnect.c][379]\r\n\t\tExit:[SQL_SUCCESS]\r\n[ODBC][5487][1596979104.310995][SQLFreeHandle.c][290]\r\n\t\tEntry:\r\n\t\t\tHandle Type = 2\r\n\t\t\tInput Handle = 0x7fd4e0002a50\r\n[ODBC][5487][1596979104.311051][SQLFreeHandle.c][339]\r\n\t\tExit:[SQL_SUCCESS]\r\n\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/800", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/800/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/800/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/800/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/800", "id": 663918073, "node_id": "MDU6SXNzdWU2NjM5MTgwNzM=", "number": 800, "title": "Login failed for user '<token-identified principal>'", "user": {"login": "stevenhurwitt", "id": 7502272, "node_id": "MDQ6VXNlcjc1MDIyNzI=", "avatar_url": "https://avatars0.githubusercontent.com/u/7502272?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stevenhurwitt", "html_url": "https://github.com/stevenhurwitt", "followers_url": "https://api.github.com/users/stevenhurwitt/followers", "following_url": "https://api.github.com/users/stevenhurwitt/following{/other_user}", "gists_url": "https://api.github.com/users/stevenhurwitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/stevenhurwitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stevenhurwitt/subscriptions", "organizations_url": "https://api.github.com/users/stevenhurwitt/orgs", "repos_url": "https://api.github.com/users/stevenhurwitt/repos", "events_url": "https://api.github.com/users/stevenhurwitt/events{/privacy}", "received_events_url": "https://api.github.com/users/stevenhurwitt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2020-07-22T17:10:03Z", "updated_at": "2020-07-23T16:47:58Z", "closed_at": "2020-07-23T16:36:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 64-bit\r\n- pyodbc: 4.0.30\r\n- OS: Windows\r\n- DB: SQL Server\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\n\r\n#### Expected behavior\r\nEstablish a connection to SQL Server database.\r\n\r\n#### Observed behavior\r\nGetting an error that I don't have permission, when I can connect and run basic queries in MSSMS. Only thing I can think of is that there needs to be some sort of permissions thing done on the backend, but it doesn't make sense that it worked through SQL Server but not pyodbc.\r\n\r\nAuthentication:\r\n![image](https://user-images.githubusercontent.com/7502272/88206218-8a99c680-cc13-11ea-8b85-e487e035b7b1.png)\r\n\r\nBasic Query:\r\n![image](https://user-images.githubusercontent.com/7502272/88206390-c92f8100-cc13-11ea-8e5e-ade5ab9f339f.png)\r\n\r\n### Code\r\n```python\r\nimport pyodbc\r\n\r\nserver = 'my_server.database.windows.net' \r\ndatabase = 'my_db' \r\nusername = '{me@gmail.com}'\r\n\r\ncnxn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER='+server+';DATABASE='+database+';UID='+username + '; AUTHENTICATION=ActiveDirectoryInteractive')\r\n```\r\n### Error\r\n```python\r\nInterfaceError: ('28000', \"[28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user '<token-identified principal>'. (18456) (SQLDriverConnect); [28000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Login failed for user '<token-identified principal>'. (18456)\")\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/798", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/798/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/798/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/798/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/798", "id": 659762423, "node_id": "MDU6SXNzdWU2NTk3NjI0MjM=", "number": 798, "title": "Complex Encoding Interaction", "user": {"login": "rlichtenwalter", "id": 2200662, "node_id": "MDQ6VXNlcjIyMDA2NjI=", "avatar_url": "https://avatars0.githubusercontent.com/u/2200662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rlichtenwalter", "html_url": "https://github.com/rlichtenwalter", "followers_url": "https://api.github.com/users/rlichtenwalter/followers", "following_url": "https://api.github.com/users/rlichtenwalter/following{/other_user}", "gists_url": "https://api.github.com/users/rlichtenwalter/gists{/gist_id}", "starred_url": "https://api.github.com/users/rlichtenwalter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rlichtenwalter/subscriptions", "organizations_url": "https://api.github.com/users/rlichtenwalter/orgs", "repos_url": "https://api.github.com/users/rlichtenwalter/repos", "events_url": "https://api.github.com/users/rlichtenwalter/events{/privacy}", "received_events_url": "https://api.github.com/users/rlichtenwalter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-07-18T00:18:34Z", "updated_at": "2020-07-18T20:45:49Z", "closed_at": "2020-07-18T16:18:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.7.6\r\n- pyodbc: 4.0.30\r\n- OS: GNU/Linux (kernel Linux 4.4.0-1073-aws)\r\n- DB: Cloudera Hadoop/Impala *and* Cloudera Hadoop/Hive\r\n- Impala Driver: Cloudera Impala ODBC Driver 64-bit version 2.6.10\r\nhttps://downloads.cloudera.com/connectors/ClouderaImpala_ODBC_2.6.10.1010/Debian/clouderaimpalaodbc_2.6.10.1010-2_amd64.deb\r\n- Hive Driver: https://downloads.cloudera.com/connectors/ClouderaHive_ODBC_2.6.4.1004/Debian/clouderahiveodbc_2.6.4.1004-2_amd64.deb\r\n\r\nversus (see long explanation below)\r\n\r\n- OS: MacOS (kernel xnu 6153.141.1)\r\n- Impala Driver: https://downloads.cloudera.com/connectors/ClouderaImpala_ODBC_2.6.10.1010/macOS/ClouderaImpalaODBC.dmg\r\n- Hive Driver: https://downloads.cloudera.com/connectors/hive_odbc_2.6.1.1001/OSX/ClouderaHiveODBC.dmg\r\n\r\n### Issue\r\nPlease hang in with me here...\r\n\r\n#### Background\r\nWe have a Hadoop cluster that exposes data through both Impala and Hive with which we interact through pyodbc using the Cloudera Impala and Cloudera Hive drivers (see above for versions).\r\n\r\nOn Linux, when we use pyodbc to query Hadoop via either Hive or Impala, we can only see full and correct column names if we use\r\ncn.setdecoding(pyodbc.SQL_WMETADATA, encoding=\"utf-32le\")\r\nNo other encodings work. However, when we do use this encoding, queries that generate errors cause a UnicodeDecodeError: 'utf-32-le' codec can't decode bytes in position 0-3: code point not in range(0x110000)\r\n\r\nOn the other hand, if we use:\r\ncn.setdecoding(pyodbc.SQL_WMETADATA, encoding=\"utf-16\")\r\nthen we get proper SQL error messages without the exception, but column names that come back are mangled.\r\n\r\nWhich means there is no single encoding that we can set that permits both error messages to work and column names to show correctly.\r\n\r\nAgain, this is the case with *both* Impala and Hive drivers *on Linux*. You might suspect that it's a driver issue, so we tried using R and the 'odbc' library. There, we query the same databases on the same system with the same drivers, and everything works correctly with UTF-8 and does *not* work with *either* UTF-16 or UTF-32LE.\r\n\r\nSo then you might suspect that it's a pyodbc issue. So then we tried the same thing locally on our Macs. We're using the same version of pyodbc and the Mac version of the Cloudera Impala and Hive drivers (same version for the Mac platform as for Linux), and pyodbc works for both query errors and column names with UTF-8 and does *not* work with *either* UTF-16 or UTF-32LE.\r\n\r\nWe're at a loss where to go from here, but Cloudera support is vehemently insisting that the issue is with pyodbc and not on their side. The R odbc versus pyodbc test on Linux seems to support that. But then the Linux versus Mac ODBC test seems to contradict it.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/797", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/797/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/797/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/797/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/797", "id": 658117724, "node_id": "MDU6SXNzdWU2NTgxMTc3MjQ=", "number": 797, "title": "Support for python3.8?", "user": {"login": "djnorrisdev", "id": 42302814, "node_id": "MDQ6VXNlcjQyMzAyODE0", "avatar_url": "https://avatars2.githubusercontent.com/u/42302814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djnorrisdev", "html_url": "https://github.com/djnorrisdev", "followers_url": "https://api.github.com/users/djnorrisdev/followers", "following_url": "https://api.github.com/users/djnorrisdev/following{/other_user}", "gists_url": "https://api.github.com/users/djnorrisdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/djnorrisdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djnorrisdev/subscriptions", "organizations_url": "https://api.github.com/users/djnorrisdev/orgs", "repos_url": "https://api.github.com/users/djnorrisdev/repos", "events_url": "https://api.github.com/users/djnorrisdev/events{/privacy}", "received_events_url": "https://api.github.com/users/djnorrisdev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-07-16T11:37:04Z", "updated_at": "2020-07-17T15:23:56Z", "closed_at": "2020-07-17T15:23:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "Architecture: Linux arch x86_64, version 4.4.0-173-generic release #203, running Mate OS \r\n\r\nI currently have pyodbc version 4.0.30 successfully running on the server with python 3.5.2. When I installed Python 3.8.4, reinstalled pyodbc, and placed it in 3.8.4's path, I now receive an error saying `ModuleNotFoundError: No module named 'pyodbc'`. When I enter interactive mode on command line and `import pyodbc`, I get the same error. \r\n\r\nDoes anyone have any insight into this issue? The only things I can find from searching is a pull request to pypl to add python3.7 and python3.8 to the list of supported versions, and a stack overflow post saying python 3.8 is now supported.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/791", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/791/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/791/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/791/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/791", "id": 646890294, "node_id": "MDU6SXNzdWU2NDY4OTAyOTQ=", "number": 791, "title": "Django Failed to connect SQL Server 2019", "user": {"login": "SeekerDexter", "id": 25416581, "node_id": "MDQ6VXNlcjI1NDE2NTgx", "avatar_url": "https://avatars1.githubusercontent.com/u/25416581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SeekerDexter", "html_url": "https://github.com/SeekerDexter", "followers_url": "https://api.github.com/users/SeekerDexter/followers", "following_url": "https://api.github.com/users/SeekerDexter/following{/other_user}", "gists_url": "https://api.github.com/users/SeekerDexter/gists{/gist_id}", "starred_url": "https://api.github.com/users/SeekerDexter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SeekerDexter/subscriptions", "organizations_url": "https://api.github.com/users/SeekerDexter/orgs", "repos_url": "https://api.github.com/users/SeekerDexter/repos", "events_url": "https://api.github.com/users/SeekerDexter/events{/privacy}", "received_events_url": "https://api.github.com/users/SeekerDexter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-28T10:32:27Z", "updated_at": "2020-06-29T02:33:43Z", "closed_at": "2020-06-29T02:33:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Environment\r\n\r\n- Python:  3.7 64-bit\r\n- pyodbc:  4.0.30\r\n- OS:  Windows10 professional 1803 17134.1130\r\n- DB:  SQL Server 2019 15.0.4033.1\r\n- driver: {ODBC Driver 17 for SQL Server}\r\n\r\n### Issue\r\n\r\nI used sql server 2012 as database for my django peoject (via django-pyodbc-azure=2.1.0.0), it worked well. But after the DBA update sql server to version 2019, the code dose not work, it raise error : \r\n\r\n> `django.db.utils.NotSupportedError: SQL Server v15 is not supported.`\r\n\r\naccording to trackback, I found the reason is \"15\" id not a key in dict `DatabaseWrapper._sql_server_versions` ([PyEnvs]\\Lib\\site-packages\\sql_server\\pyodbc\\base.py).\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/790", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/790/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/790/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/790/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/790", "id": 646348456, "node_id": "MDU6SXNzdWU2NDYzNDg0NTY=", "number": 790, "title": "fast_executemany throwing error [Microsoft][ODBC Driver 17 for SQL Server]Invalid character value for cast specification (0) (SQLExecute)", "user": {"login": "djrscally", "id": 4592235, "node_id": "MDQ6VXNlcjQ1OTIyMzU=", "avatar_url": "https://avatars0.githubusercontent.com/u/4592235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djrscally", "html_url": "https://github.com/djrscally", "followers_url": "https://api.github.com/users/djrscally/followers", "following_url": "https://api.github.com/users/djrscally/following{/other_user}", "gists_url": "https://api.github.com/users/djrscally/gists{/gist_id}", "starred_url": "https://api.github.com/users/djrscally/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djrscally/subscriptions", "organizations_url": "https://api.github.com/users/djrscally/orgs", "repos_url": "https://api.github.com/users/djrscally/repos", "events_url": "https://api.github.com/users/djrscally/events{/privacy}", "received_events_url": "https://api.github.com/users/djrscally/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-26T15:40:41Z", "updated_at": "2020-06-26T15:52:07Z", "closed_at": "2020-06-26T15:52:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "Seems to be a few similar issues, but I couldn't see a match\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7.4 64 bit\r\n- pyodbc: 4.0.30\r\n- OS: Windows 10\r\n- DB: MSSQL\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\n\r\nRunning the following in a python shell:\r\n\r\n```python\r\nimport pyodbc\r\nconn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER=<server>;DATABASE=BI;trusted_connection=yes')\r\ncur = conn.cursor()\r\n\r\ncur.fast_executemany=True\r\n\r\nparams = < data goes here >\r\n\r\ncur.executemany(\"insert into BI.Clarizen.Stage__Project values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\", params)\r\n```\r\n\r\nExpected behaviour; the insert statement is completed without exception\r\n\r\nActual behaviour: the following exception is thrown:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\npyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server]Invalid character value for cast specification (0) (SQLExecute)')\r\n```\r\n\r\nIf I set `cur.fast_executemany=False` then things will complete successfully. Possibly relevant information that might help figure out wtf is going on:\r\n\r\n**Table definition from MSSQL**\r\n```sql\r\ncreate table Clarizen.Stage__Project (\r\n\tProjectID nvarchar(16) not null primary key\r\n\t, Name nvarchar(256) not null\r\n\t, Description nvarchar(max) null\r\n\t, ProjectManagerID nvarchar(64) not null\r\n\t, CreatedOn datetime2 not null\r\n\t, CreatedByID nvarchar(64) not null\r\n\t, LastUpdatedOn datetime2 not null\r\n\t, LastUpdatedByID nvarchar(64) not null\r\n\t, ParentID nvarchar(16) null\r\n\t, ProjectType nvarchar(64) null\r\n\t, Billable bit not null\r\n\t, iCareEntity nvarchar(8) null\r\n\t, iCareSubsidiary nvarchar(16) null\r\n)\r\n```\r\n\r\n**Example input data**\r\n```python\r\n('P-306702', 'Billing', '', '/User/a578e72c-ba2b-4bee-b184-eaa39d0a6e63', '2019-09-12T08:25:29.9332950', '/User/1704099b1ccbevc83pshxldbi656', '2020-04-15T08:29:15.9363900', '/User/6l6bufusgp42yi6c5bgwno2f76473', 'P-306701', 'Partner Services', 0, 'UK01', 'UK'),\r\n('P-254212', 'Billing', None, '/User/6l6bufusgp42yi6c5bgwno2f76473', '2019-03-20T08:19:27.8522760', '/User/1704099b1ccbevc83pshxldbi656', '2020-04-15T08:29:15.9363900', '/User/6l6bufusgp42yi6c5bgwno2f76473', 'P-254211', 'Partner Services', True, 'UK01', 'UK')\r\n```\r\n\r\nThe only guesses I had were that the conversion from the Boolean to Bit for the Billable field or the conversion from a None into nvarchar in the Description field were buggering it, but I explicitly converted them into an empty string and a 0 in the input params and the issue still occurs. \r\n\r\n**ODBC Trace**\r\nI couldn't get this working I'm afraid, sorry.  Tried numerous times but the log file simply isn't being written for some reason.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/781", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/781/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/781/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/781/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/781", "id": 639319428, "node_id": "MDU6SXNzdWU2MzkzMTk0Mjg=", "number": 781, "title": "install fails on Amazon Linux 2", "user": {"login": "jmarshall9120", "id": 30184747, "node_id": "MDQ6VXNlcjMwMTg0NzQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/30184747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmarshall9120", "html_url": "https://github.com/jmarshall9120", "followers_url": "https://api.github.com/users/jmarshall9120/followers", "following_url": "https://api.github.com/users/jmarshall9120/following{/other_user}", "gists_url": "https://api.github.com/users/jmarshall9120/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmarshall9120/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmarshall9120/subscriptions", "organizations_url": "https://api.github.com/users/jmarshall9120/orgs", "repos_url": "https://api.github.com/users/jmarshall9120/repos", "events_url": "https://api.github.com/users/jmarshall9120/events{/privacy}", "received_events_url": "https://api.github.com/users/jmarshall9120/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-16T02:21:52Z", "updated_at": "2020-06-17T02:24:42Z", "closed_at": "2020-06-17T02:24:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n\r\n### Environment\r\n- Python: \r\n   Python 3.7.6\r\n- pyodbc: \r\n    Cheese Factory latest\r\n- OS: \r\n    Amazon Linux 2\r\n- DB:\r\n    NA\r\n- driver:\r\n    NA\r\n### Issue\r\n\r\npyodbc simply won't install on my Amazon Linux 2 server. \r\n\r\n\r\n```\r\npip3 install pyodbc\r\n\r\nCollecting pyodbc\r\n  Using cached https://files.pythonhosted.org/packages/81/0d/bb08bb16c97765244791c73e49de9fd4c24bb3ef00313aed82e5640dee5d/pyodbc-4.0.30.tar.gz\r\nInstalling collected packages: pyodbc\r\n  Running setup.py install for pyodbc ... error\r\n    Complete output from command /usr/bin/python3 -u -c \"import setuptools, tokenize;__file__='/tmp/pip-build-19y7mmge/pyodbc/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-k1aqu9nj-record/install-record.txt --single-version-externally-managed --compile:\r\n    /usr/lib64/python3.7/distutils/dist.py:274: UserWarning: Unknown distribution option: 'long_description_content_type'\r\n      warnings.warn(msg)\r\n    running install\r\n    running build\r\n    running build_ext\r\n    building 'pyodbc' extension\r\n    creating build\r\n    creating build/temp.linux-x86_64-3.7\r\n    creating build/temp.linux-x86_64-3.7/src\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -DPYODBC_VERSION=4.0.30 -I/usr/include/python3.7m -c src/buffer.cpp -o build/temp.linux-x86_64-3.7/src/buffer.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/usr/include\r\n    unable to execute 'gcc': No such file or directory\r\n    error: command 'gcc' failed with exit status 1\r\n\r\n    ----------------------------------------\r\nCommand \"/usr/bin/python3 -u -c \"import setuptools, tokenize;__file__='/tmp/pip-build-19y7mmge/pyodbc/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-k1aqu9nj-record/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-build-19y7mmge/pyodbc/\r\n\r\n```\r\n\r\nI've read in some old support issues here about needing python3-dev and unixodbc-dev for Ubuntu by Amazon Linux 2 is definitely rhel like.  Here are some dependency checks.  That error message above looks pretty terse to me as well.  If there's a better way to look into the error, please let me know. \r\n\r\n```\r\n[ec2-user@tableau_master ~]$ yum list installed | grep python3\r\nRepository packages-microsoft-com-prod is listed more than once in the configuration\r\npython3.x86_64                     3.7.6-1.amzn2.0.1                 @amzn2-core\r\npython3-libs.x86_64                3.7.6-1.amzn2.0.1                 @amzn2-core\r\npython3-pip.noarch                 9.0.3-1.amzn2.0.2                 @amzn2-core\r\npython3-setuptools.noarch          38.4.0-3.amzn2.0.6                @amzn2-core\r\n\r\n[ec2-user@tableau_master ~]$ yum list installed | grep unix\r\nRepository packages-microsoft-com-prod is listed more than once in the configuration\r\nunixODBC.x86_64                    2.3.1-14.amzn2                    @amzn2-core\r\nunixODBC-devel.x86_64              2.3.1-14.amzn2                    @amzn2-core\r\n\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/770", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/770/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/770/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/770/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/770", "id": 625114638, "node_id": "MDU6SXNzdWU2MjUxMTQ2Mzg=", "number": 770, "title": "__enter__ attribute error while using context managers in pyodbc connection", "user": {"login": "InsaneDhina", "id": 62996818, "node_id": "MDQ6VXNlcjYyOTk2ODE4", "avatar_url": "https://avatars0.githubusercontent.com/u/62996818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/InsaneDhina", "html_url": "https://github.com/InsaneDhina", "followers_url": "https://api.github.com/users/InsaneDhina/followers", "following_url": "https://api.github.com/users/InsaneDhina/following{/other_user}", "gists_url": "https://api.github.com/users/InsaneDhina/gists{/gist_id}", "starred_url": "https://api.github.com/users/InsaneDhina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/InsaneDhina/subscriptions", "organizations_url": "https://api.github.com/users/InsaneDhina/orgs", "repos_url": "https://api.github.com/users/InsaneDhina/repos", "events_url": "https://api.github.com/users/InsaneDhina/events{/privacy}", "received_events_url": "https://api.github.com/users/InsaneDhina/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-26T19:00:29Z", "updated_at": "2020-05-27T05:40:30Z", "closed_at": "2020-05-27T05:40:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python:  3.7.2\r\n- pyodbc: 4.0.30\r\n- OS: Windows 10 64 bit\r\n- DB: MSSQL Local DB\r\n- driver: SQL Server Native Client 11.0\r\n\r\n### Issue\r\n I am trying to extract a table using pyodbc package from Python with context managers.\r\n\r\nit is a pretty simplecode, but eventhough I have coded the__enter__ method I am receiving __enter__ Attribute error. does pyodbc support python context Managers?\r\n\r\nCode:\r\n```\r\n\r\nimport pyodbc\r\n\r\nposts = {}\r\n\r\n\r\nclass DataBaseConnection:\r\n    def __init__(self):\r\n        self.connection = None\r\n\r\n    def __enter__(self):\r\n        self.connection = pyodbc.connect(\"\"\"Driver={SQL Server Native Client 11.0};\"\r\n                      \"Server=(LocalDB)\\LocalDBDemo;\"\r\n                      \"Database=pythondev;\"\r\n                      \"Trusted_Connection=yes;\"\"\")\r\n        return self.connection\r\n\r\n    def __exit__(self, exc_type, exc_val, exc_tb):\r\n        if exc_type or exc_tb or exc_tb:\r\n            self.connection.close()\r\n        self.connection.commit()\r\n        self.connection.close()\r\n\r\n\r\nwith DataBaseConnection as connection:\r\n    cursor = connection.cursor\r\n    cursor.execute('SELECT * FROM tblpost')\r\n    for row in cursor.fetchall():\r\n        dtlist = list(row)\r\n        posts[dtlist[0].strip()] = {'id': dtlist[0].strip(), 'title': dtlist[1], 'content': dtlist[2]}\r\n\r\nprint(posts)\r\n```\r\n\r\n```\r\nC:\\Users\\Lenovo\\PycharmProjects\\import_project\\venv\\Scripts\\python.exe C:/Users/Lenovo/PycharmProjects/dbcheck/app.py\r\nTraceback (most recent call last):\r\n  File \"C:/Users/Lenovo/PycharmProjects/dbcheck/app.py\", line 24, in <module>\r\n    with DataBaseConnection as connection:\r\nAttributeError: __enter__\r\nProcess finished with exit code 1\r\n```\r\n\r\n \r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/769", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/769/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/769/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/769/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/769", "id": 624645513, "node_id": "MDU6SXNzdWU2MjQ2NDU1MTM=", "number": 769, "title": "Connection to sql server working from container but not from aws lambda", "user": {"login": "nrjchnd2", "id": 28232613, "node_id": "MDQ6VXNlcjI4MjMyNjEz", "avatar_url": "https://avatars0.githubusercontent.com/u/28232613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrjchnd2", "html_url": "https://github.com/nrjchnd2", "followers_url": "https://api.github.com/users/nrjchnd2/followers", "following_url": "https://api.github.com/users/nrjchnd2/following{/other_user}", "gists_url": "https://api.github.com/users/nrjchnd2/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrjchnd2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrjchnd2/subscriptions", "organizations_url": "https://api.github.com/users/nrjchnd2/orgs", "repos_url": "https://api.github.com/users/nrjchnd2/repos", "events_url": "https://api.github.com/users/nrjchnd2/events{/privacy}", "received_events_url": "https://api.github.com/users/nrjchnd2/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-26T06:58:52Z", "updated_at": "2020-05-26T15:12:48Z", "closed_at": "2020-05-26T15:12:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi All,\r\n\r\nI am trying to establish a connection with sql server from aws lambda function. Was following this blog [https://medium.com/faun/aws-lambda-microsoft-sql-server-how-to-66c5f9d275ed](url). The only difference is that I am using python 3.8 image for lambda CI as well as my aws lambda function is also using python 3.8 runtime.  The connection works just fine from inside of a container but fails when I zip the code to aws lambda. \r\n\r\nI have looked everywhere but didn't find any solution.  Below is the error which I get on aws lamda.\r\n\r\n```\r\nSTART RequestId: 6f3ec44e-aac0-4cc3-b5ed-f8935c4dff4d Version: $LATEST\r\n[ERROR] Error: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib '/var/task/msodbcsql/lib64/libmsodbcsql-13.1.so.9.2' : file not found (0) (SQLDriverConnect)\")\r\nTraceback (most recent call last):\r\n  File \"/var/lang/lib/python3.8/imp.py\", line 234, in load_module\r\n    return load_source(name, filename, file)\r\n  File \"/var/lang/lib/python3.8/imp.py\", line 171, in load_source\r\n    module = _load(spec)\r\n  File \"<frozen importlib._bootstrap>\", line 702, in _load\r\n  File \"<frozen importlib._bootstrap>\", line 671, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 783, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"/var/task/test.py\", line 9, in <module>\r\n    conn=pyodbc.connect(\"DRIVER={ODBC Driver 13 for SQL Server};SERVER=***;PORT=1433;DATABASE=***;UID=***;PWD=***\")END RequestId: 6f3ec44e-aac0-4cc3-b5ed-f8935c4dff4d\r\nREPORT RequestId: 6f3ec44e-aac0-4cc3-b5ed-f8935c4dff4d  Duration: 1583.04 ms    Billed Duration: 1600 ms    Memory Size: 128 MB Max Memory Used: 15 MB  \r\nUnknown application error occurred\r\n```\r\nWhen I put below code in python file, I can see that the file is indeed present there.\r\n```\r\narr = os.listdir('/var/task/msodbcsql/lib64')\r\nprint(arr)\r\n```\r\noutput - libmsodbcsql-13.1.so.9.2\r\n\r\nMore details : [https://stackoverflow.com/questions/62001501/sql-server-connection-works-fine-from-lambda-container-but-fails-after-uploading?noredirect=1#comment109660362_62001501](url)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/768", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/768/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/768/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/768/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/768", "id": 624260980, "node_id": "MDU6SXNzdWU2MjQyNjA5ODA=", "number": 768, "title": "Facing error: ModuleNotFoundError: No module named 'pyodbc', when I run the python based BAT file comprising of pyodbc", "user": {"login": "prateekralhan", "id": 29462447, "node_id": "MDQ6VXNlcjI5NDYyNDQ3", "avatar_url": "https://avatars2.githubusercontent.com/u/29462447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prateekralhan", "html_url": "https://github.com/prateekralhan", "followers_url": "https://api.github.com/users/prateekralhan/followers", "following_url": "https://api.github.com/users/prateekralhan/following{/other_user}", "gists_url": "https://api.github.com/users/prateekralhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/prateekralhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prateekralhan/subscriptions", "organizations_url": "https://api.github.com/users/prateekralhan/orgs", "repos_url": "https://api.github.com/users/prateekralhan/repos", "events_url": "https://api.github.com/users/prateekralhan/events{/privacy}", "received_events_url": "https://api.github.com/users/prateekralhan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-25T12:11:25Z", "updated_at": "2020-07-16T18:23:09Z", "closed_at": "2020-05-27T15:32:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n- Python: 3.6.1 32bit\r\n- pyodbc: 4.0.30\r\n- OS: Win10 Version 1709\r\n- DB: SQL Server\r\n\r\n### Issue\r\nI had installed pyodbc - 4.0.30 in my Win10 OS using pip install pyodbc. It got installed successfully and works fine when I execute the python script. But I want to run my script periodically, so I created an executable batch file (.bat) which can be run by a single click to invoke and run the python script. \r\n\r\nBut I am facing this error whenever I execute the batch file. I tried uninstalling and reinstalling. Additionally I also have dependencies installed as well.\r\n\r\n![PYODBC_error](https://user-images.githubusercontent.com/29462447/82811546-a7817a00-9eae-11ea-9479-1e8efd1d67f0.png)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/761", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/761/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/761/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/761/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/761", "id": 619179781, "node_id": "MDU6SXNzdWU2MTkxNzk3ODE=", "number": 761, "title": "inst -j", "user": {"login": "karlmoad", "id": 22076233, "node_id": "MDQ6VXNlcjIyMDc2MjMz", "avatar_url": "https://avatars3.githubusercontent.com/u/22076233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karlmoad", "html_url": "https://github.com/karlmoad", "followers_url": "https://api.github.com/users/karlmoad/followers", "following_url": "https://api.github.com/users/karlmoad/following{/other_user}", "gists_url": "https://api.github.com/users/karlmoad/gists{/gist_id}", "starred_url": "https://api.github.com/users/karlmoad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karlmoad/subscriptions", "organizations_url": "https://api.github.com/users/karlmoad/orgs", "repos_url": "https://api.github.com/users/karlmoad/repos", "events_url": "https://api.github.com/users/karlmoad/events{/privacy}", "received_events_url": "https://api.github.com/users/karlmoad/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-15T19:04:26Z", "updated_at": "2020-05-21T15:41:43Z", "closed_at": "2020-05-21T15:41:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: \r\n- pyodbc: \r\n- OS: \r\n- DB:\r\n- driver:\r\n\r\n### Issue\r\n\r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/760", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/760/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/760/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/760/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/760", "id": 618800030, "node_id": "MDU6SXNzdWU2MTg4MDAwMzA=", "number": 760, "title": "pyodbc.ProgrammingError: ('42000', \"[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Sintaxis incorrecta cerca de 'Gait\u00f3n'. (102) (SQLExecDirectW)\")", "user": {"login": "manel00", "id": 8410687, "node_id": "MDQ6VXNlcjg0MTA2ODc=", "avatar_url": "https://avatars0.githubusercontent.com/u/8410687?v=4", "gravatar_id": "", "url": "https://api.github.com/users/manel00", "html_url": "https://github.com/manel00", "followers_url": "https://api.github.com/users/manel00/followers", "following_url": "https://api.github.com/users/manel00/following{/other_user}", "gists_url": "https://api.github.com/users/manel00/gists{/gist_id}", "starred_url": "https://api.github.com/users/manel00/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/manel00/subscriptions", "organizations_url": "https://api.github.com/users/manel00/orgs", "repos_url": "https://api.github.com/users/manel00/repos", "events_url": "https://api.github.com/users/manel00/events{/privacy}", "received_events_url": "https://api.github.com/users/manel00/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-15T08:40:08Z", "updated_at": "2020-05-27T07:37:59Z", "closed_at": "2020-05-27T07:37:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7\r\n- pyodbc: 4.0.30\r\n- OS: Windows 10\r\n- DB: SQL Server\r\n- driver: -\r\n- IDE: PyCharm\r\n\r\n### Issue\r\n\r\nError in the title, i'm trying to add an insert with accents and these spanish things but it pisses me off because don't know how to deal it on python, can you help me with this please? thank you so much\r\n\r\nUPDATE:\r\n\r\nClose the issue, i already realized what happened, by error PyCharm was taking me the Python 2.7 instead of 3.8, and was giving me strange errors, im sorry, now it works", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/759", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/759/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/759/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/759/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/759", "id": 615159310, "node_id": "MDU6SXNzdWU2MTUxNTkzMTA=", "number": 759, "title": "Stored Procedure parameters with TABLE Types", "user": {"login": "sjhughes77", "id": 63757086, "node_id": "MDQ6VXNlcjYzNzU3MDg2", "avatar_url": "https://avatars3.githubusercontent.com/u/63757086?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sjhughes77", "html_url": "https://github.com/sjhughes77", "followers_url": "https://api.github.com/users/sjhughes77/followers", "following_url": "https://api.github.com/users/sjhughes77/following{/other_user}", "gists_url": "https://api.github.com/users/sjhughes77/gists{/gist_id}", "starred_url": "https://api.github.com/users/sjhughes77/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sjhughes77/subscriptions", "organizations_url": "https://api.github.com/users/sjhughes77/orgs", "repos_url": "https://api.github.com/users/sjhughes77/repos", "events_url": "https://api.github.com/users/sjhughes77/events{/privacy}", "received_events_url": "https://api.github.com/users/sjhughes77/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-09T11:47:11Z", "updated_at": "2020-05-11T00:55:01Z", "closed_at": "2020-05-11T00:53:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.8\r\n- pyodbc: 4.0.30\r\n- OS: Windows 10 x64\r\n- DB: SQL Server 2019\r\n- driver: 17\r\n\r\n### Issue\r\n\r\nI created a TABLE Type and am trying to pass it into a stored procedure with other parameters, e.g. a VARCHAR(45) field.  If I call the stored procedure with just the Type as a parameter. it works OK.  If I add any other parameters, the result is  **Invalid string or buffer length (0) (SQLBindParameter)**.\r\nIt  would appear that pyodbc can only call a stored procedure with a table type OR other parameters but not both. \r\n I modified the test script from GitHub as follows:\r\nCREATE PROCEDURE [SelectTVP] @name VARCHAR(45), @TVP TestTVP READONLY,  @description VARCHAR(45) AS SELECT * FROM @TVP;\r\n\r\nresult_array = self.cursor.execute(\"exec SelectTVP ?, ?, ?\",['XXXX', [param_array], 'DDDD']\r\n\r\nResult text: Exception: [Error] ('HY090', '[HY090] [Microsoft][ODBC Driver Manager] Invalid string or buffer length (0) (SQLBindParameter)')\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/758", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/758/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/758/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/758/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/758", "id": 614702669, "node_id": "MDU6SXNzdWU2MTQ3MDI2Njk=", "number": 758, "title": "ius or epel for pyodbc??Python.h no such file or directory , python36u-3.6.8-1.el7.ius.x86_64 conflicts with file from package python36-3.6.6-1.el7.x86_64", "user": {"login": "divyalakshmi24", "id": 46859189, "node_id": "MDQ6VXNlcjQ2ODU5MTg5", "avatar_url": "https://avatars0.githubusercontent.com/u/46859189?v=4", "gravatar_id": "", "url": "https://api.github.com/users/divyalakshmi24", "html_url": "https://github.com/divyalakshmi24", "followers_url": "https://api.github.com/users/divyalakshmi24/followers", "following_url": "https://api.github.com/users/divyalakshmi24/following{/other_user}", "gists_url": "https://api.github.com/users/divyalakshmi24/gists{/gist_id}", "starred_url": "https://api.github.com/users/divyalakshmi24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/divyalakshmi24/subscriptions", "organizations_url": "https://api.github.com/users/divyalakshmi24/orgs", "repos_url": "https://api.github.com/users/divyalakshmi24/repos", "events_url": "https://api.github.com/users/divyalakshmi24/events{/privacy}", "received_events_url": "https://api.github.com/users/divyalakshmi24/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-05-08T12:08:16Z", "updated_at": "2020-05-26T05:25:28Z", "closed_at": "2020-05-26T05:24:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using\r\n- Python: Python 3.6.6\r\n- OS: \"CentOS Linux 7 (Core)\"\r\n\r\nfollowing steps in https://github.com/mkleehammer/pyodbc/wiki/Connecting-to-SQL-Server-from-RHEL-6-or-Centos-7\r\n\r\n got results till  the step\r\n# check the DSN installation with:\r\nodbcinst -j\r\n\r\nunixODBC 2.3.1\r\nDRIVERS............: /usr/local/etc/odbcinst.ini\r\nSYSTEM DATA SOURCES: /usr/local/etc/odbc.ini\r\nFILE DATA SOURCES..: /usr/local/etc/ODBCDataSources\r\nUSER DATA SOURCES..: /usr/local/etc/odbc.ini\r\nSQLULEN Size.......: 8\r\nSQLLEN Size........: 8\r\nSQLSETPOSIROW Size.: 8\r\n\r\ncat /etc/odbc.ini\r\n returned header\r\n\r\npip install pyodbc\r\nRequirement already satisfied: pyodbc in /usr/lib64/python2.7/site-packages (4.0.30)\r\nCould not build wheels for pyodbc, since package 'wheel' is not installed.\r\n\r\nBut i want to execute  the code using python3.6 \r\n     ModuleNotFoundError: No module named 'pyodbc'\r\n\r\nSo tried \r\npython3.6 pip install pyodbc \r\n #include <Python.h>\r\n                        ^\r\n    compilation terminated.\r\n    error: command 'gcc' failed with exit status 1\r\n\r\nthen tried\r\nyum install python36u-devel\r\nfile /usr/bin/python3.6m from install of python36u-3.6.8-1.el7.ius.x86_64 conflicts with file from package python36-3.6.6-1.el7.x86_64\r\n\r\n\r\n\r\nKindly help.\r\nshould i need ius repo ,is epel not supported\r\n  \r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/757", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/757/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/757/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/757/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/757", "id": 613555596, "node_id": "MDU6SXNzdWU2MTM1NTU1OTY=", "number": 757, "title": "SYBASE + FreeTDS: Issues getting insert row ID passing in parameters", "user": {"login": "snowman2", "id": 8699967, "node_id": "MDQ6VXNlcjg2OTk5Njc=", "avatar_url": "https://avatars3.githubusercontent.com/u/8699967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/snowman2", "html_url": "https://github.com/snowman2", "followers_url": "https://api.github.com/users/snowman2/followers", "following_url": "https://api.github.com/users/snowman2/following{/other_user}", "gists_url": "https://api.github.com/users/snowman2/gists{/gist_id}", "starred_url": "https://api.github.com/users/snowman2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/snowman2/subscriptions", "organizations_url": "https://api.github.com/users/snowman2/orgs", "repos_url": "https://api.github.com/users/snowman2/repos", "events_url": "https://api.github.com/users/snowman2/events{/privacy}", "received_events_url": "https://api.github.com/users/snowman2/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-05-06T19:24:07Z", "updated_at": "2020-06-08T14:25:39Z", "closed_at": "2020-05-07T18:40:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.7.5\r\n- pyodbc: 4.0.30\r\n- OS: Linux-4.15.0-99-generic-x86_64-with-Ubuntu-18.04-bionic\r\n- DB: sybase (Adaptive Server Enterprise/16.0 SP02)\r\n- driver: FreeTDS\r\n\r\n### Issue\r\n\r\nForwarded from: https://github.com/sqlalchemy/sqlalchemy/issues/5311\r\n\r\n```python\r\nimport pyodbc\r\n\r\nconnect_args = {\"autoconnect\": True}\r\nconnector = pyodbc.connect(\r\n    database=database,\r\n    user=username,\r\n    password=password,\r\n    driver=\"FreeTDS\",\r\n    host=host,\r\n    port=port,\r\n    **connect_args,\r\n)\r\n```\r\n\r\nThis works:\r\n```py\r\ncnxn = connector.connect()\r\ncursor = cnxn.cursor()\r\ncursor.execute(\r\n    \"INSERT INTO mytable (type, description, create_date) \"\r\n    f\"VALUES ('TEST', 'TEST', '{datetime.utcnow().isoformat()}')\r\n)\r\ncursor.execute(\"SELECT @@identity AS lastrowid\")\r\nprint(cursor.fetchone()[0])\r\n```\r\n```\r\nlarge number\r\n```\r\n\r\nBut this fails (returns 0):\r\n```py\r\ncnxn = connector.connect()\r\ncursor = cnxn.cursor()\r\ncursor.execute(\"INSERT INTO mytable (type, description, create_date) VALUES (?, ?, ?)\", 'TEST', 'TEST', '2020-05-06T13:22:43.923404')\r\ncursor.execute(\"SELECT @@identity AS lastrowid\")\r\nprint(cursor.fetchone()[0])\r\n```\r\n```\r\n0\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/756", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/756/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/756/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/756/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/756", "id": 613040986, "node_id": "MDU6SXNzdWU2MTMwNDA5ODY=", "number": 756, "title": "Invalid parameter type", "user": {"login": "DCyph", "id": 54941994, "node_id": "MDQ6VXNlcjU0OTQxOTk0", "avatar_url": "https://avatars1.githubusercontent.com/u/54941994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DCyph", "html_url": "https://github.com/DCyph", "followers_url": "https://api.github.com/users/DCyph/followers", "following_url": "https://api.github.com/users/DCyph/following{/other_user}", "gists_url": "https://api.github.com/users/DCyph/gists{/gist_id}", "starred_url": "https://api.github.com/users/DCyph/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DCyph/subscriptions", "organizations_url": "https://api.github.com/users/DCyph/orgs", "repos_url": "https://api.github.com/users/DCyph/repos", "events_url": "https://api.github.com/users/DCyph/events{/privacy}", "received_events_url": "https://api.github.com/users/DCyph/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-06T04:26:02Z", "updated_at": "2020-05-06T13:03:45Z", "closed_at": "2020-05-06T13:03:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Environment\r\n\r\n- Python:  3.8 32-bit\r\n- pyodbc: 4.0.30\r\n- OS: Windows 10\r\n- DB: SQL Server 18\r\n- driver: SQL Server\r\n\r\n### Issue\r\n\r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n\r\nReturning the following error when attempting to insert data into a table - \r\n\r\n**pyodbc.ProgrammingError: ('Invalid parameter type.  param-index=0 param-type=set', 'HY105')**\r\n\r\nI presume the error is referring to the first parameter (_the query uses 24 parameters_), and is used to populate a column with an INT datatype.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/750", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/750/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/750/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/750/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/750", "id": 605672047, "node_id": "MDU6SXNzdWU2MDU2NzIwNDc=", "number": 750, "title": "Issue Encoding DB Microsoft SQL 2008", "user": {"login": "lschneidpro", "id": 40396043, "node_id": "MDQ6VXNlcjQwMzk2MDQz", "avatar_url": "https://avatars2.githubusercontent.com/u/40396043?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lschneidpro", "html_url": "https://github.com/lschneidpro", "followers_url": "https://api.github.com/users/lschneidpro/followers", "following_url": "https://api.github.com/users/lschneidpro/following{/other_user}", "gists_url": "https://api.github.com/users/lschneidpro/gists{/gist_id}", "starred_url": "https://api.github.com/users/lschneidpro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lschneidpro/subscriptions", "organizations_url": "https://api.github.com/users/lschneidpro/orgs", "repos_url": "https://api.github.com/users/lschneidpro/repos", "events_url": "https://api.github.com/users/lschneidpro/events{/privacy}", "received_events_url": "https://api.github.com/users/lschneidpro/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-04-23T16:24:01Z", "updated_at": "2020-04-24T09:59:16Z", "closed_at": "2020-04-24T09:59:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Environment\r\n- Python: 3.6.1 64bits\r\n- pyodbc: 4.0.30\r\n- OS: win10\r\n- DB: Microsoft SQL 2008\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\n Hi there,\r\n\r\nI'm retrieving data from a Microsft SQL 2008 (enconding is 'cp1252') as shown up below. All is good except, I end up sometimes with `\\xa0` within strings. I have been playing around with parameters:\r\n\r\n```\r\npyodbc.SQL_CHAR\r\npyodbc.SQL_WCHAR\r\npyodbc.SQL_WMETADATA\r\n```\r\nBut nothing seems to fix this.\r\nWhat could i try with pyodbc before assessing there is issues with the DB.\r\nThanks a lot for your help\r\n\r\n```\r\nimport pandas as pd\r\nimport pyodbc\r\n\r\ncon = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER=' + server + ';PORT=' + port+\";Trusted_Connection=yes;\")\r\ndf = pd.read_sql(query, con)\r\ncon.close()\r\n```\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/748", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/748/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/748/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/748/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/748", "id": 604066987, "node_id": "MDU6SXNzdWU2MDQwNjY5ODc=", "number": 748, "title": "DROP DATABASE not possible: database is still in use", "user": {"login": "grap3-fru1t", "id": 52132296, "node_id": "MDQ6VXNlcjUyMTMyMjk2", "avatar_url": "https://avatars2.githubusercontent.com/u/52132296?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grap3-fru1t", "html_url": "https://github.com/grap3-fru1t", "followers_url": "https://api.github.com/users/grap3-fru1t/followers", "following_url": "https://api.github.com/users/grap3-fru1t/following{/other_user}", "gists_url": "https://api.github.com/users/grap3-fru1t/gists{/gist_id}", "starred_url": "https://api.github.com/users/grap3-fru1t/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grap3-fru1t/subscriptions", "organizations_url": "https://api.github.com/users/grap3-fru1t/orgs", "repos_url": "https://api.github.com/users/grap3-fru1t/repos", "events_url": "https://api.github.com/users/grap3-fru1t/events{/privacy}", "received_events_url": "https://api.github.com/users/grap3-fru1t/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-04-21T14:59:13Z", "updated_at": "2020-04-21T16:22:19Z", "closed_at": "2020-04-21T16:20:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.8.0\r\n- pyodbc: 4.0.30\r\n- OS: Windows Server 2012\r\n- DB: SQL Server 2012\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\nAs a part of my unittest procedure, a database needs to be created in a SetUp function and dropped in the TearDown function of the same unittest instance. I am running into errors when trying to drop the database.\r\n\r\nThe code can be simplified to the following lines that can be executed alone:\r\n\r\n```\r\nself.project_name = \"FE0000001035_Python_Testcase_BPwithoutBU\"\r\nself.connection_string = r'Driver={{{}}}; Server={},{}; Database={}; Trusted_Connection=yes;' \\\r\n                                .format(\"ODBC Driver 17 for SQL Server\", self.conf_host, self.conf_port,\"Master_db\")\r\nself.project_conn_string = r'Driver={{{}}}; Server={},{}; Database={}; Trusted_Connection=yes;' \\\r\n                                .format(\"ODBC Driver 17 for SQL Server\", self.conf_host, self.conf_port, self.project_name)\r\n\r\n# read from the database\r\nwith pyodbc.connect(self.project_conn_string, autocommit=True) as conn:\r\n    query = \"\"\" SELECT * FROM [import].[preJournal] \"\"\"\r\n    cursor = conn.cursor()\r\n    cursor.execute(query)\r\n    result = list(cursor.fetchall())\r\n    conn.close()\r\n\r\n#drop the database\r\nwith pyodbc.connect(self.connection_string, autocommit=True) as conn:\r\n    cursor = conn.cursor()\r\n    query_drop= \"\"\"  drop database \"\"\" + self.project_name             \r\n    cursor.execute(query_drop)\r\n    conn.close()\r\n```\r\n\r\nThe database drop doesn't happen as the connection still seems to be open. Following error is displayed:\r\n\r\n```\r\npyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Cannot drop database \"FE0000001035_Python_Testcase_BPwithoutBU\" because it is currently in use. (3702) (SQLExecDirectW)')\r\n```\r\n\r\nODBC Trace:\r\n\r\n[20200421SQL_backup.LOG](https://github.com/mkleehammer/pyodbc/files/4510733/20200421SQL_backup.LOG)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/746", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/746/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/746/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/746/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/746", "id": 603009764, "node_id": "MDU6SXNzdWU2MDMwMDk3NjQ=", "number": 746, "title": "pyodbc.ProgrammingError: ('42000', \"[42000] ...", "user": {"login": "driep01", "id": 34473082, "node_id": "MDQ6VXNlcjM0NDczMDgy", "avatar_url": "https://avatars3.githubusercontent.com/u/34473082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/driep01", "html_url": "https://github.com/driep01", "followers_url": "https://api.github.com/users/driep01/followers", "following_url": "https://api.github.com/users/driep01/following{/other_user}", "gists_url": "https://api.github.com/users/driep01/gists{/gist_id}", "starred_url": "https://api.github.com/users/driep01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/driep01/subscriptions", "organizations_url": "https://api.github.com/users/driep01/orgs", "repos_url": "https://api.github.com/users/driep01/repos", "events_url": "https://api.github.com/users/driep01/events{/privacy}", "received_events_url": "https://api.github.com/users/driep01/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-04-20T07:31:39Z", "updated_at": "2020-04-22T07:10:28Z", "closed_at": "2020-04-22T07:10:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hallo,\r\n \r\nMy set-up\r\nPython - 3.7.3 (64 bit)\r\npyodbc - 4.0.30\r\nOS - Windows 10 (64 bit)\r\nDB - MS Access 2016 (office 365) (64 bit)\r\ndriver - ODBC for Access = ['Microsoft Access Driver (*.mdb, *.accdb)']\r\n\r\nIn my Access db, I have defined a query (see the attached file \"temp_sql_file.txt\") and below:\r\n\r\n```\r\nSELECT TasksTime.projID, Projects.[Project Name] AS Project_Name, TasksTime.TaskID, Tasks.Title\r\n, TasksTime.employID, Employees.[Last Name] AS Last_Name\r\n, Employees.[First Name] AS First_Name\r\n, TasksTime.dateEntry, TasksTime.startTime, TasksTime.endTime\r\n, TasksTime.comment, get_hours([startTime],[EndTime]) AS Hours\r\n, TasksTime.posted, TasksTime.invoice, TasksTime.ratecat, [Hours]*[ratecat] AS Cost\r\nFROM ((Employees AS Employees_1 \r\n  INNER JOIN Projects ON Employees_1.ID = Projects.Owner) \r\n  INNER JOIN (Employees \r\n   INNER JOIN Tasks ON Employees.ID = Tasks.[Assigned To]) ON Projects.ID = Tasks.Project) \r\n  INNER JOIN TasksTime ON (Tasks.Project = TasksTime.projID) AND (Tasks.ID = TasksTime.TaskID);\r\n\r\n```\r\n\r\nIn this query, I call a user defined function \"getHours\" that does a calculation of hours using the fields stime and etime in the query\r\n\r\nThe Access VBA function looks like this:\r\n```\r\nPublic Function get_hours(x_start_time As String, x_end_time As String) As Double\r\n\r\n\r\nDim v_shr As String\r\nDim v_shrD As Double\r\nDim v_smin As String\r\nDim v_ehr As String\r\nDim v_ehrD As Double\r\nDim v_emin As String\r\nDim v_hours As Double\r\n\r\n\r\nIf Len(x_start_time) = 3 Then\r\n    v_shr = Mid(x_start_time, 1, 1)\r\n    v_smin = Mid(x_start_time, 2, 2)\r\nElseIf Len(x_start_time) = 4 Then\r\n    v_shr = Mid(x_start_time, 1, 2)\r\n    v_smin = Mid(x_start_time, 3, 2)\r\nElse\r\n    v_shr = 0\r\n    v_smin = 0\r\n    v_ehr = 0\r\n    v_emin = 0\r\nEnd If\r\n\r\nIf Len(x_end_time) = 3 Then\r\n    v_ehr = Mid(x_end_time, 1, 1)\r\n    v_emin = Mid(x_end_time, 2, 2)\r\nElseIf Len(x_end_time) = 4 Then\r\n    v_ehr = Mid(x_end_time, 1, 2)\r\n    v_emin = Mid(x_end_time, 3, 2)\r\nElse\r\n    v_shr = 0\r\n    v_smin = 0\r\n    v_ehr = 0\r\n    v_emin = 0\r\nEnd If\r\n\r\nv_shrD = CDbl(v_shr) + (CDbl(v_smin) / 60)\r\nv_ehrD = CDbl(v_ehr) + (CDbl(v_emin) / 60)\r\nv_hours = v_ehrD - v_shrD\r\n\r\nget_hours = Round(v_hours, 2)\r\nEnd Function\r\n```\r\n\r\n**Expected outcome**: when I run this query in Access, I get the perfect result from calling this function  - see the attached file \"temp_sql_Access_output.png\". I thus expect this field to be returned in the pyodbc result set.\r\n\r\n**Actual behavior**: when I use this query in Python with pyodbc, I get the result `\"pyodbc.ProgrammingError: ('42000', \"[42000] [Microsoft][ODBC Microsoft Access Driver] Undefined function 'get_hours' in expression. (-3102) (SQLExecDirectW)\")\"\r\n`\r\n\r\nMy select in Python looks like this:\r\n\r\n```\r\nv_select: str = \"\"\"SELECT * \r\nFROM TasksTime_Extended \r\nORDER BY dateEntry, startTime, projID, TaskID\"\"\"\r\n```\r\n\r\nAny ideas for a solution to get this field returned? Else I will have to redefine the hours calculation in the Python project.\r\n\r\nI checked the wiki page at \"https://github.com/mkleehammer/pyodbc/wiki/Connecting-to-Microsoft-Access\" as suggested, but there is no specific information about fields with a function call. \r\n\r\nI have also checked the 4 similar issues reported before, but they do not address the same issue.\r\n\r\nThanks in advance.\r\n\r\nPhlip\r\n\r\n\r\n![temp_sql_Access_output](https://user-images.githubusercontent.com/34473082/79723221-ad030780-82e5-11ea-9250-e8f0e9c2f78c.png)\r\n.\r\n\r\n[temp_sql_file.txt](https://github.com/mkleehammer/pyodbc/files/4501673/temp_sql_file.txt)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/744", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/744/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/744/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/744/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/744", "id": 601418718, "node_id": "MDU6SXNzdWU2MDE0MTg3MTg=", "number": 744, "title": "Ticket Expired Error when connecting to SQL Server from Red Hat 8 using Active DIrectory Authentication", "user": {"login": "jrisi256", "id": 9837612, "node_id": "MDQ6VXNlcjk4Mzc2MTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/9837612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrisi256", "html_url": "https://github.com/jrisi256", "followers_url": "https://api.github.com/users/jrisi256/followers", "following_url": "https://api.github.com/users/jrisi256/following{/other_user}", "gists_url": "https://api.github.com/users/jrisi256/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrisi256/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrisi256/subscriptions", "organizations_url": "https://api.github.com/users/jrisi256/orgs", "repos_url": "https://api.github.com/users/jrisi256/repos", "events_url": "https://api.github.com/users/jrisi256/events{/privacy}", "received_events_url": "https://api.github.com/users/jrisi256/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-16T20:09:51Z", "updated_at": "2020-04-24T15:31:38Z", "closed_at": "2020-04-24T15:31:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n* Python: 3.7.6\r\n* pyodbc: 4.0.30\r\n* OS: Red Hat 8\r\n* DB: SQL Server (and SQL Server Express)\r\n* driver: ODBC Driver for 17 for SQL Server\r\n\r\n### Issue\r\n\r\nHello! Thanks for making such a great package, and I hope you're staying safe and healthy during these difficult times.\r\n\r\nBelow is a screenshot detailing the error message I receive upon trying to connect to a particular server at my company using pyodbc.\r\n\r\n![image](https://user-images.githubusercontent.com/9837612/79501013-5e125500-7ffb-11ea-9f04-2415c7af0958.png)\r\n\r\nI don't believe there is an issue with the odbc.ini entry or the server itself because I'm able to connect to the server (from the machine in question) using the R programming language so I believe it has something to do with pyodbc.\r\n\r\nBelow is the relevant entry in the odbc.ini file (with sensitive information excluded).\r\n\r\n```\r\n[Projects]\r\nDriver = ODBC Driver 17 for SQL Server\r\nDescription = Microsoft ODBC Driver 17 for SQL Server\r\nServer = /* sensitive */\r\nServerSPN = /* sensitive */\r\nTrusted_Connection = yes\r\n```\r\n\r\nI suspect the issue has something to do with the fact we authenticate users using our Active Directory system, and pyodbc has its \"prompt\" turned off by default. As a result, users aren't able to enter in their credentials. This is just a hunch though, and I figured I would submit this as an issue to see if you had any further insight into what may be causing the issue.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/740", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/740/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/740/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/740/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/740", "id": 599102888, "node_id": "MDU6SXNzdWU1OTkxMDI4ODg=", "number": 740, "title": "Missing the output value from a SQL Server stored procedure performing a DB BACKUP", "user": {"login": "grap3-fru1t", "id": 52132296, "node_id": "MDQ6VXNlcjUyMTMyMjk2", "avatar_url": "https://avatars2.githubusercontent.com/u/52132296?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grap3-fru1t", "html_url": "https://github.com/grap3-fru1t", "followers_url": "https://api.github.com/users/grap3-fru1t/followers", "following_url": "https://api.github.com/users/grap3-fru1t/following{/other_user}", "gists_url": "https://api.github.com/users/grap3-fru1t/gists{/gist_id}", "starred_url": "https://api.github.com/users/grap3-fru1t/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grap3-fru1t/subscriptions", "organizations_url": "https://api.github.com/users/grap3-fru1t/orgs", "repos_url": "https://api.github.com/users/grap3-fru1t/repos", "events_url": "https://api.github.com/users/grap3-fru1t/events{/privacy}", "received_events_url": "https://api.github.com/users/grap3-fru1t/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-04-13T20:01:58Z", "updated_at": "2020-05-06T16:30:44Z", "closed_at": "2020-05-06T16:30:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.8.0, 64 bit\r\n- pyodbc: 4.0.30\r\n- OS: Windows Server 2012\r\n- DB: SQL Server 2012\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\n\r\nI need to call a stored procedure from python. The stored procedure is performing a database backup; an output value is to be returned to python.\r\n\r\n### SP:\r\n```SET ANSI_NULLS ON \r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nALTER PROCEDURE [util].[backup_db_] (\r\n\t @pDB_name NVARCHAR(MAX)\r\n\t, @pBackup_name NVARCHAR(MAX)\r\n\t, @pBackup_path NVARCHAR(MAX)\r\n\t, @pErrorStatus NVARCHAR(MAX) OUTPUT\t\r\n)\r\nAS\r\nBEGIN\r\nSET NOCOUNT ON\r\nDECLARE @vDynamic_SQL_command NVARCHAR(MAX);\t\r\nSET @pErrorStatus = '0'\t\t\r\n\r\n\tSET @vdynamic_SQL_command = '\r\n\t\tBACKUP DATABASE '+@pdb_name+'\r\n\t\tTO DISK = '''+@pbackup_path+@pbackup_name+'.Bak''';\r\n\r\nEXEC(@vdynamic_SQL_command);\r\nSET @pErrorStatus = '1'\t\t\r\n\r\nEND\r\n```\r\n\r\n### Python:\r\n```\r\nconn = pyodbc.connect(self.master_conn_string, autocommit=True)\r\nsql = \"\"\"\r\nSET NOCOUNT ON;\r\nDECLARE @pErrorStatus nvarchar(max)\r\nEXEC [util].[backup_db_] \r\n       @pDB_name = ?\r\n\t , @pBackup_name = ?\r\n\t , @pBackup_path = ?\r\n        , @pErrorStatus = @pErrorStatus OUTPUT;\r\n        SELECT @pErrorStatus;\r\n        \"\"\"\r\ncursor = conn.cursor()\r\n        \r\nparameters = (self.ProjectID, \"\\\\\"+self.ProjectID + datetime.now().strftime('%Y_%m_%d_%H_%M_%S'), self.serverPathArchive)\r\n\r\ncursor.execute(sql, parameters)\r\ncursor.commit()\r\nwhile (cursor.nextset()):\r\n    pass\r\nerror = list(cursor.fetchall()[0])\r\nconn.close()\r\n```\r\n\r\nI can see that the stored procedure is recognized correctly by pyodbc and the backup of the database is performed. It just has a problem with returning the output parameter.\r\n\r\n### Traceback:\r\n```\r\n  File \"Project.py\", line 187, in backup_function\r\n    error = list(cursor.fetchall()[0])\r\npyodbc.ProgrammingError: No results.  Previous SQL was not a query.\r\n```\r\n\r\nODBC Trace:\r\n[SQL_backup.LOG](https://github.com/mkleehammer/pyodbc/files/4476221/SQL_backup.LOG)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/739", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/739/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/739/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/739/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/739", "id": 598520158, "node_id": "MDU6SXNzdWU1OTg1MjAxNTg=", "number": 739, "title": "pyodbc ignores exception after first result is sent", "user": {"login": "ffoersterchen", "id": 21067768, "node_id": "MDQ6VXNlcjIxMDY3NzY4", "avatar_url": "https://avatars2.githubusercontent.com/u/21067768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ffoersterchen", "html_url": "https://github.com/ffoersterchen", "followers_url": "https://api.github.com/users/ffoersterchen/followers", "following_url": "https://api.github.com/users/ffoersterchen/following{/other_user}", "gists_url": "https://api.github.com/users/ffoersterchen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ffoersterchen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ffoersterchen/subscriptions", "organizations_url": "https://api.github.com/users/ffoersterchen/orgs", "repos_url": "https://api.github.com/users/ffoersterchen/repos", "events_url": "https://api.github.com/users/ffoersterchen/events{/privacy}", "received_events_url": "https://api.github.com/users/ffoersterchen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-12T16:20:33Z", "updated_at": "2020-04-13T15:12:37Z", "closed_at": "2020-04-13T15:12:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.6.0, x64 (Anaconda 4.3.0) \r\n- pyodbc: 4.0.30\r\n- OS: Windows 10 \r\n- DB: SQL Server 2016\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\n\r\n_Step 1_\r\nCreated a SQL Stored Procedure on SQL Server:\r\n`CREATE PROC toFail \r\nAS BEGIN\r\nSELECT 'abc' AS Col1;\r\nTHROW 50000, 'This is an error to be caught', 1;\r\nEND\r\n`\r\n_Step 2_\r\ncreated python connection and cursor and executed the stored proc\r\n`\r\nimport pyodbc\r\nconn = pyodbc.connect('DRIVER={ODBC Driver 17 For SQL Server};SERVER=XXXX;DATABASE=YYYY;')\r\ncrsr = conn.cursor()\r\ncrsr.execute('EXEC toFail;')\r\n`\r\n\r\nExpected Behavior: pyodbc should raise an exception (ProgrammingError)\r\nObserved Behavior: no exception, cursor has one row with a tuple of ('abc', )\r\n\r\nNote: when commenting out the select, pyodbc raises an exception \r\nNote: when changing the SELECT to a PRINT pyodbc fails to raise an exception\r\nNote: when executing another procedure in lieu of the SELECT or PRINT which will generate a resultset, pyodbc also fails to raise an appropriate exception.\r\n\r\nplease fix. ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/734", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/734/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/734/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/734/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/734", "id": 592350936, "node_id": "MDU6SXNzdWU1OTIzNTA5MzY=", "number": 734, "title": "Connection Pooling Timeouts", "user": {"login": "reedjosh", "id": 9508385, "node_id": "MDQ6VXNlcjk1MDgzODU=", "avatar_url": "https://avatars3.githubusercontent.com/u/9508385?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedjosh", "html_url": "https://github.com/reedjosh", "followers_url": "https://api.github.com/users/reedjosh/followers", "following_url": "https://api.github.com/users/reedjosh/following{/other_user}", "gists_url": "https://api.github.com/users/reedjosh/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedjosh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedjosh/subscriptions", "organizations_url": "https://api.github.com/users/reedjosh/orgs", "repos_url": "https://api.github.com/users/reedjosh/repos", "events_url": "https://api.github.com/users/reedjosh/events{/privacy}", "received_events_url": "https://api.github.com/users/reedjosh/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-04-02T04:34:13Z", "updated_at": "2020-04-03T19:24:26Z", "closed_at": "2020-04-03T19:24:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7+\r\n- pyodbc: 4.028\r\n- OS: SLES 12\r\n- DB: Oracle 12\r\n- driver: UnixOCBC 2.3.0\r\n\r\n### Issue\r\n\r\nWhen connection pooling has been up for some time, the connections fail when reused due to timeout. We're using this connection for an API, so this kills us. Haha\r\n\r\nI am currently gathering further information regarding timeout timing. The messages are of the form: \r\n\r\npyodbc.Error: ('HY000', '[HY000] [Oracle][ODBC][Ora]ORA-02396: exceeded maximum idle time, please connect again\\n\\x00\\x00\\x00\\x00\\x00\u8ef7\ub89e\u2aaa\\x00\uff90\u5630\u5555\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\u6a43\u563b\u5555\\x00\\x7f\\x00\\x00\\x00\u6a43\u563b\u5555\\x00\u69c8\u563b\u5555\\x00\\x00\\x00\\x00\\x00\u4544\u454c\u4554\u5f44\u4c46\u4741\u4559\\x00\u0520\u5631\u5555\\x00`\\x00\\x00\\x00\u00a8\\x00\\x00\\x00\u0520\u5631\u5555\\x00\\u0e98\uc860\u2aaa\\x00\u5248\u563b\u5555\\x00\u2a38\u563b\u5555\\x00\u0520\u5631 (2396) (SQLExecDirectW)')\r\n\r\nThe extra chars as I now know are an Oracle driver issue.\r\n\r\nI'm pretty new to a lot of this, so I apologize in advance if this is just a simple setting misconfiguration. I will update as I investigate further.\r\n\r\nThank you!\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/733", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/733/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/733/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/733/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/733", "id": 592241908, "node_id": "MDU6SXNzdWU1OTIyNDE5MDg=", "number": 733, "title": "Persistent connection time out", "user": {"login": "deejcunningham", "id": 30193983, "node_id": "MDQ6VXNlcjMwMTkzOTgz", "avatar_url": "https://avatars0.githubusercontent.com/u/30193983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deejcunningham", "html_url": "https://github.com/deejcunningham", "followers_url": "https://api.github.com/users/deejcunningham/followers", "following_url": "https://api.github.com/users/deejcunningham/following{/other_user}", "gists_url": "https://api.github.com/users/deejcunningham/gists{/gist_id}", "starred_url": "https://api.github.com/users/deejcunningham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deejcunningham/subscriptions", "organizations_url": "https://api.github.com/users/deejcunningham/orgs", "repos_url": "https://api.github.com/users/deejcunningham/repos", "events_url": "https://api.github.com/users/deejcunningham/events{/privacy}", "received_events_url": "https://api.github.com/users/deejcunningham/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-04-01T22:30:12Z", "updated_at": "2020-04-05T05:22:32Z", "closed_at": "2020-04-05T05:22:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.8.1\r\n- pyodbc: 4.0.30\r\n- unixodbc: 2.3.7\r\n- OS: Arch Linux, kernel: 5.5.6-arch1-1\r\n- DB: 14.0.3223.3 Express Edition (64-bit)\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\nI am unable to connect to my database and the attempt times out after ~30 seconds.\r\n\r\nTrying to connect with `conn = pyodbc.connect(\"DRIVER={ODBC Driver 17 for SQL Server};SERVER=localhost,1433;DATABASE=dbname;UID=username;PWD=password;\")`\r\n\r\nI receive this error: `OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')`\r\n\r\nI am able to connect using azuredatastudio as well as with the SQL server VSCode extension, so I am pretty certain that my port is forwarded correctly and I know that the user/pass is correct.\r\n\r\n`cat /etc/odbcinst.ini` gives me\r\n\r\n> `[ODBC Driver 17 for SQL Server]`\r\n> `Description=Microsoft ODBC Driver 17 for SQL Server`\r\n> `Driver=/opt/microsoft/msodbcsql/lib64/libmsodbcsql-17.4.so.2.1`\r\n> `UsageCount=1`\r\n\r\nThe [documentation for Linux](https://github.com/mkleehammer/pyodbc/wiki/Connecting-to-SQL-Server-from-Linux) only covers connection using a DSN. Is that method required if connecting from Linux?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/728", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/728/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/728/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/728/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/728", "id": 579568396, "node_id": "MDU6SXNzdWU1Nzk1NjgzOTY=", "number": 728, "title": "pyodbc fails to connect without dsn= kwarg", "user": {"login": "io-d", "id": 57019974, "node_id": "MDQ6VXNlcjU3MDE5OTc0", "avatar_url": "https://avatars0.githubusercontent.com/u/57019974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/io-d", "html_url": "https://github.com/io-d", "followers_url": "https://api.github.com/users/io-d/followers", "following_url": "https://api.github.com/users/io-d/following{/other_user}", "gists_url": "https://api.github.com/users/io-d/gists{/gist_id}", "starred_url": "https://api.github.com/users/io-d/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/io-d/subscriptions", "organizations_url": "https://api.github.com/users/io-d/orgs", "repos_url": "https://api.github.com/users/io-d/repos", "events_url": "https://api.github.com/users/io-d/events{/privacy}", "received_events_url": "https://api.github.com/users/io-d/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-11T21:58:14Z", "updated_at": "2020-03-12T20:27:20Z", "closed_at": "2020-03-12T20:27:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nCan connect using the `pyodbc.connect(dsn, Database=...)` syntax\r\n\r\n## Actual behavior\r\n\r\nMust connect using the `pyodbc.connect(dsn=dsn, Database=...)` syntax, which causes issues on other platforms (on macOS, this causes the connection string to be passed as though prepended by `dsn=`). \r\n\r\n## Details\r\n\r\nTraceback:\r\n```\r\n  File \"/home/coquest/tr/api/utils.py\", line 115, in get_db\r\n    db = g._db = pyodbc.connect(dsn, Database='CQ_SworderNetProductAnalysis', autocommit=autocommit)\r\npyodbc.Error: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server' : file not found (0) (SQLDriverConnect)\")\r\n```\r\n\r\nDSN:\r\n```\r\n\t\t\t\t'Driver=SQL Server;'\r\n\t\t\t\t'Server=[redacted];'\r\n\t\t\t\t'DSN=CoquestDev;'\r\n\t\t\t\t'uid=[redacted];pwd=[redacted];'\r\n```\r\n\r\n## Environment\r\n\r\n- Python: CPython 3.8.2\r\n- pyodbc: 4.0.30\r\n- OS: Debian 10\r\n- DB: MS SQL Server\r\n- driver: unixodbc + libmsodbcsql-17.5.so.1.1\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/723", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/723/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/723/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/723/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/723", "id": 576571732, "node_id": "MDU6SXNzdWU1NzY1NzE3MzI=", "number": 723, "title": "Single character string to CHAR(1) field", "user": {"login": "yankyhoffman", "id": 41123800, "node_id": "MDQ6VXNlcjQxMTIzODAw", "avatar_url": "https://avatars3.githubusercontent.com/u/41123800?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yankyhoffman", "html_url": "https://github.com/yankyhoffman", "followers_url": "https://api.github.com/users/yankyhoffman/followers", "following_url": "https://api.github.com/users/yankyhoffman/following{/other_user}", "gists_url": "https://api.github.com/users/yankyhoffman/gists{/gist_id}", "starred_url": "https://api.github.com/users/yankyhoffman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yankyhoffman/subscriptions", "organizations_url": "https://api.github.com/users/yankyhoffman/orgs", "repos_url": "https://api.github.com/users/yankyhoffman/repos", "events_url": "https://api.github.com/users/yankyhoffman/events{/privacy}", "received_events_url": "https://api.github.com/users/yankyhoffman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-05T22:32:30Z", "updated_at": "2020-03-05T23:49:41Z", "closed_at": "2020-03-05T23:49:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a column `accepted` which is set to `CHAR(1)` and can only accept from a predefined list of letters.\r\n\r\nHowever when I try passing a single character python string as follows\r\n``` python\r\ndb = pyodbc.connect(os.environ['DB_DSN'])\r\ndb.cursor().execute(\"\"\"\r\n        SELECT COUNT(*)\r\n        FROM [views].[listings_to_approve]\r\n        WHERE COALESCE([accepted], '') = ?;\r\n    \"\"\", ('A',)\r\n)\r\n```\r\nI get this error\r\n```\r\npyodbc.DataError: ('22018', \"[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Conversion failed when converting the nvarchar value 'A' to data type int. (245) (SQLExecDirectW)\")\r\n```\r\n\r\n- Python: 3.7.5 (64 bit)\r\n- pyodbc: 4.0.28\r\n- OS: Ubuntu 19.10\r\n- DB: SQL Server (Docker - mcr.microsoft.com/mssql/server 2017-latest-ubuntu)\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\nI understand that it might be related to the type conversion between python and the database.\r\n\r\nhere is my odbc trace\r\n[odbc-trace.txt](https://github.com/mkleehammer/pyodbc/files/4295448/odbc-trace.txt)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/720", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/720/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/720/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/720/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/720", "id": 573942273, "node_id": "MDU6SXNzdWU1NzM5NDIyNzM=", "number": 720, "title": "Error with select query when using PostgreSQL 12", "user": {"login": "tqa236", "id": 25203655, "node_id": "MDQ6VXNlcjI1MjAzNjU1", "avatar_url": "https://avatars2.githubusercontent.com/u/25203655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tqa236", "html_url": "https://github.com/tqa236", "followers_url": "https://api.github.com/users/tqa236/followers", "following_url": "https://api.github.com/users/tqa236/following{/other_user}", "gists_url": "https://api.github.com/users/tqa236/gists{/gist_id}", "starred_url": "https://api.github.com/users/tqa236/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tqa236/subscriptions", "organizations_url": "https://api.github.com/users/tqa236/orgs", "repos_url": "https://api.github.com/users/tqa236/repos", "events_url": "https://api.github.com/users/tqa236/events{/privacy}", "received_events_url": "https://api.github.com/users/tqa236/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-03-02T12:29:52Z", "updated_at": "2020-03-02T16:40:19Z", "closed_at": "2020-03-02T16:40:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.6\r\n- pyodbc: 4.0.30\r\n- Host OS: Ubuntu 18.04\r\n- DB: PostgreSQL\r\n- driver: PostgreSQL Unicode\r\n- Docker Image for PostgreSQL: [postgres:12.2-alpine](https://hub.docker.com/layers/postgres/library/postgres/12.2-alpine/images/sha256-05e2ec8c0b8248201d410a6f2944606b28692622daf20ba6ba3fe6ef87059469?context=explore)\r\n- All code runs on docker containers.\r\n(Note: The error doesn't occur for PostgreSQL 11.7, I believe it only affects PostgreSQL 12+, please see the StackOverflow question below.)\r\n\r\n### Issue\r\n\r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n\r\n- Observed behavior:\r\n\r\nWhen I execute a select query, this error occurs but I still receive the result of the query.\r\n\r\n```bash\r\nERROR:  column c.relhasoids does not exist at character 245\r\nSTATEMENT:  select n.nspname, c.relname, a.attname, a.atttypid, t.typname, a.attnum, a.attlen, a.atttypmod, a.attnotnull, c.relhasrules, c.relkind, c.oid, pg_get_expr(d.adbin, d.adrelid), case t.typtype when 'd' then t.typbasetype else 0 end, t.typtypmod, c.relhasoids, attidentity from (((pg_catalog.pg_class c inner join pg_catalog.pg_namespace n on n.oid = c.relnamespace and c.oid = 16395) inner join pg_catalog.pg_attribute a on (not a.attisdropped) and a.attnum > 0 and a.attrelid = c.oid) inner join pg_catalog.pg_type t on t.oid = a.atttypid) left outer join pg_attrdef d on a.atthasdef and d.adrelid = a.attrelid and d.adnum = a.attnum order by n.nspname, c.relname, attnum\r\nERROR:  current transaction is aborted, commands ignored until end of transaction block\r\n```\r\n\r\nRelated: https://stackoverflow.com/questions/58461178/how-to-fix-error-column-c-relhasoids-does-not-exist-in-postgres \r\n\r\n- Expected behavior: This error doesn't happen.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/714", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/714/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/714/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/714/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/714", "id": 570816166, "node_id": "MDU6SXNzdWU1NzA4MTYxNjY=", "number": 714, "title": "cursor execute command prematurely exits without error for long running stored procedure?", "user": {"login": "reedv", "id": 15711729, "node_id": "MDQ6VXNlcjE1NzExNzI5", "avatar_url": "https://avatars1.githubusercontent.com/u/15711729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedv", "html_url": "https://github.com/reedv", "followers_url": "https://api.github.com/users/reedv/followers", "following_url": "https://api.github.com/users/reedv/following{/other_user}", "gists_url": "https://api.github.com/users/reedv/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedv/subscriptions", "organizations_url": "https://api.github.com/users/reedv/orgs", "repos_url": "https://api.github.com/users/reedv/repos", "events_url": "https://api.github.com/users/reedv/events{/privacy}", "received_events_url": "https://api.github.com/users/reedv/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-02-25T20:35:45Z", "updated_at": "2020-02-26T00:19:01Z", "closed_at": "2020-02-26T00:19:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python:  Python 3.6.8\r\n- pyodbc: pyodbc 4.0.28\r\n- OS: centOS 7\r\n- DB: MSSQL 2012\r\n- driver: msodbcsql17\r\n\r\n### Issue\r\n\r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n\r\nHave a pyodbc script that is supposed to execute a stored procedure on an MSSQL server, but appears to be cutting out without error in the middle of running.\r\n\r\nI have pyodbc that connects to a MSSQL (2012) server runs a stored procedure (that runs several other subordinate stored procedures) which normally lasts for about 45min, but when running via pyodbc it appears to exit after a certain amount of time (though never exactly consistent in how long) where it just quits without warning or error (*does not occur when running manually on the MSSQL server itself*, thus why I think having \"SET ANSI_WARNINGS OFF\" is [fine][1]). Adding debugging print statements to the subordinate stored procedures seems to confirm this: execution seems to simply end in the middle of running (usually after about 25-26min). The code looks like...\r\n```python\r\ncnxn = pyodbc.connect(f\"DSN={CONFS['odbc_dsn']};\"\r\n                      f\"DATABASE={'mydb'};\"\r\n                      f\"UID={CONFS['username']};PWD={CONFS['password']};\"\r\n                      f\"MultipleActiveResultSets=True;\",\r\n                      autocommit=True)\r\ncursor = cnxn.cursor()\r\n\r\nprint(\"\\n\\n\\nRunning web reporting processes...\")\r\nstored_procs = [\r\n    \"mydb..some_initialization_stuff\",\r\n    \"mydb..long_running_stored_proc\"\r\n]\r\ncursor.commit()\r\nfor sp in stored_procs:\r\n    print(f\"\\n\\t[{datetime.datetime.now()}] Running stored procedure {sp}\")\r\n    cursor.execute(f\"SET ANSI_WARNINGS OFF; exec {sp}\")\r\n    # cursor.commit()\r\n    print(f\"\\t[{datetime.datetime.now()}] stored procedure {sp} completed\")\r\n    # print(cursor.fetchall())\r\ncursor.close()\r\ncnxn.close()\r\n```\r\n\r\nAnyone with more experience with pyodbc know what could be causing this? Any other information / specific debugging steps to improve this question? \r\n\r\n\r\n  [1]: https://stackoverflow.com/a/6992641/8236733\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/712", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/712/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/712/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/712/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/712", "id": 565365138, "node_id": "MDU6SXNzdWU1NjUzNjUxMzg=", "number": 712, "title": "Source package for 4.0.30 missing", "user": {"login": "edwardreed81", "id": 26143936, "node_id": "MDQ6VXNlcjI2MTQzOTM2", "avatar_url": "https://avatars0.githubusercontent.com/u/26143936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edwardreed81", "html_url": "https://github.com/edwardreed81", "followers_url": "https://api.github.com/users/edwardreed81/followers", "following_url": "https://api.github.com/users/edwardreed81/following{/other_user}", "gists_url": "https://api.github.com/users/edwardreed81/gists{/gist_id}", "starred_url": "https://api.github.com/users/edwardreed81/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edwardreed81/subscriptions", "organizations_url": "https://api.github.com/users/edwardreed81/orgs", "repos_url": "https://api.github.com/users/edwardreed81/repos", "events_url": "https://api.github.com/users/edwardreed81/events{/privacy}", "received_events_url": "https://api.github.com/users/edwardreed81/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-14T14:36:27Z", "updated_at": "2020-02-20T15:35:22Z", "closed_at": "2020-02-20T15:35:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "My package manager (poetry) is having trouble updating because 4.0.30 is the most recent version, but the source package isn't available at https://pypi.org/project/pyodbc/4.0.30/.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/711", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/711/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/711/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/711/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/711", "id": 564983739, "node_id": "MDU6SXNzdWU1NjQ5ODM3Mzk=", "number": 711, "title": "Error installing pyodbc 4.0.30 on Max OS X", "user": {"login": "srossgupta", "id": 19485531, "node_id": "MDQ6VXNlcjE5NDg1NTMx", "avatar_url": "https://avatars1.githubusercontent.com/u/19485531?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srossgupta", "html_url": "https://github.com/srossgupta", "followers_url": "https://api.github.com/users/srossgupta/followers", "following_url": "https://api.github.com/users/srossgupta/following{/other_user}", "gists_url": "https://api.github.com/users/srossgupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/srossgupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srossgupta/subscriptions", "organizations_url": "https://api.github.com/users/srossgupta/orgs", "repos_url": "https://api.github.com/users/srossgupta/repos", "events_url": "https://api.github.com/users/srossgupta/events{/privacy}", "received_events_url": "https://api.github.com/users/srossgupta/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-02-13T22:18:19Z", "updated_at": "2020-02-22T20:56:33Z", "closed_at": "2020-02-22T20:56:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.7.6\r\n- pyodbc: 4.0.30\r\n- OS: Mac OS Catalina\r\n- DB:\r\n- driver:\r\n\r\n### Issue\r\nUnable to find matching distribution corresponding to Pyodbc 4.0.30. There are no files published for Mac OSX for 4.0.30.\r\nhttps://pypi.org/project/pyodbc/4.0.30/#files\r\n```\r\n[pipenv.exceptions.InstallError]: ['ERROR: Could not find a version that satisfies the requirement pyodbc==4.0.30 (from -r /tmp/pipenv-37pca4lx-requirements/pipenv-exfib4dx-requirement.txt (line 1)) (from versions: 2.1.1, 2.1.2, 2.1.3, 2.1.4, 2.1.5, 2.1.6, 2.1.7, 2.1.8, 2.1.9, 2.1.10, 2.1.11, 3.0.3, 3.0.6, 3.0.7, 3.0.8, 3.0.9, 3.0.10, 3.1.1, 4.0.1, 4.0.2, 4.0.3, 4.0.5, 4.0.6, 4.0.7, 4.0.8, 4.0.9, 4.0.10, 4.0.11, 4.0.12, 4.0.13, 4.0.14, 4.0.15, 4.0.16, 4.0.17, 4.0.18, 4.0.19, 4.0.20, 4.0.21, 4.0.22, 4.0.23, 4.0.24, 4.0.25, 4.0.26, 4.0.27, 4.0.28, 4.0.30b1)', 'ERROR: No matching distribution found for pyodbc==4.0.30 (from -r /tmp/pipenv-37pca4lx-requirements/pipenv-exfib4dx-requirement.txt (line 1))']\r\n```\r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/710", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/710/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/710/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/710/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/710", "id": 564209422, "node_id": "MDU6SXNzdWU1NjQyMDk0MjI=", "number": 710, "title": "Call to cursor.fetchmany results in an exception of ValueError: microsecond must be in 0..999999", "user": {"login": "sonicd007", "id": 9023078, "node_id": "MDQ6VXNlcjkwMjMwNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/9023078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sonicd007", "html_url": "https://github.com/sonicd007", "followers_url": "https://api.github.com/users/sonicd007/followers", "following_url": "https://api.github.com/users/sonicd007/following{/other_user}", "gists_url": "https://api.github.com/users/sonicd007/gists{/gist_id}", "starred_url": "https://api.github.com/users/sonicd007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sonicd007/subscriptions", "organizations_url": "https://api.github.com/users/sonicd007/orgs", "repos_url": "https://api.github.com/users/sonicd007/repos", "events_url": "https://api.github.com/users/sonicd007/events{/privacy}", "received_events_url": "https://api.github.com/users/sonicd007/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-02-12T19:14:32Z", "updated_at": "2020-02-19T20:34:01Z", "closed_at": "2020-02-19T20:34:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n- Python: 3.6.9\r\n- pyodbc: Tried both 4.0.30b1 and 4.0.28 and 4.0.23\r\n- OS: Debian GNU/Linux 10 (buster) on an ARMv7 Processor rev 4 (v7l)\r\n- DB: Oracle (Retail Pro Point of Sale software which uses an Oracle database)\r\n- driver: Easysoft Oracle ODBC Driver (https://www.easysoft.com/products/data_access/odbc_oracle_driver/#section=tab-1)\r\n\r\n### Issue\r\n\r\nI'm migrating a python 2.7 codebase to python 3.6 and the code for the most part is exactly the same aside from minor syntax changes. Same hardware, same ODBC driver, different pyodbc and different python version.  The pyodbc used in the 2.7 codebase was 3.0.6 and came from the debian package repo (python-pyodbc).  No issues were encountered in the 2.7 code base and data was retrieved. pyodbc was installed using pip in the 3.6 code base and throws the ValueError exception after getting data back from the database. The versions tried for the pip package were 4.0.30b1 and 4.0.28\r\n\r\n**Expected outcome**: pyodbc.cursor.fetchmany(size) should return data from the database\r\n**Actual outcome**: pyodbc.cursor.fetchmany(size) throws a ValueError: microsecond must be in 0..999999\r\n\r\nI'm assuming there must be a row that contains a datetime stamp that has more than 6 decimal values and is causing pyodbc to throw this exception. I would expect pyodbc to truncate the value to 6 decimals if this is indeed the issue. The query is a simple select * from table.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/707", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/707/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/707/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/707/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/707", "id": 562601059, "node_id": "MDU6SXNzdWU1NjI2MDEwNTk=", "number": 707, "title": "pyodbc.Error: ('HY000', '[HY000] [unixODBC][Oracle][ODBC][Ora]ORA-28009: connection as SYS should be as SYSDBA or SYSOPER\\n (28009) (SQLDriverConnect)')", "user": {"login": "alexisrolland", "id": 13064696, "node_id": "MDQ6VXNlcjEzMDY0Njk2", "avatar_url": "https://avatars0.githubusercontent.com/u/13064696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexisrolland", "html_url": "https://github.com/alexisrolland", "followers_url": "https://api.github.com/users/alexisrolland/followers", "following_url": "https://api.github.com/users/alexisrolland/following{/other_user}", "gists_url": "https://api.github.com/users/alexisrolland/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexisrolland/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexisrolland/subscriptions", "organizations_url": "https://api.github.com/users/alexisrolland/orgs", "repos_url": "https://api.github.com/users/alexisrolland/repos", "events_url": "https://api.github.com/users/alexisrolland/events{/privacy}", "received_events_url": "https://api.github.com/users/alexisrolland/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-10T14:33:38Z", "updated_at": "2020-05-06T02:36:25Z", "closed_at": "2020-02-10T15:29:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi Michael,\r\n\r\nFirst of all I would like to thank you for the great work you've done on this page:\r\nhttps://github.com/mkleehammer/pyodbc/wiki/Connecting-to-Oracle-from-RHEL-or-Centos\r\n\r\nAfter struggling so bad with Oracle's documentation, your documentation to install Oracle ODBC driver on Linux is the most succint, clear and efficient!\r\n\r\nI have successfully installed the driver in my Python Docker image. I think it works fine because I am able to reach the database and receive the error message:\r\n\r\n> pyodbc.Error: ('HY000', '[HY000] [unixODBC][Oracle][ODBC][Ora]ORA-28009: connection as SYS should be as SYSDBA or SYSOPER\\n (28009) (SQLDriverConnect)')\r\n\r\nWhen connecting to Oracle db with SQL plus, this kind of message can be avoided with a connection string like: `$ sqlplus sys/1234@//localhost:1521/ORCLCDB as sysdba`\r\n\r\nI would like to know if you are aware of any ODBC driver parameter which would allow to provide the role `sysdba` in pyodbc connection string. Here is the string I am using:\r\n\r\n```py\r\nimport pyodbc\r\nconnection_string = \"driver={Oracle};dbq=db-oracle:1521/orclcdb;uid=sys;pwd=1234\"\r\nconnection = pyodbc.connect(connection_string)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\npyodbc.Error: ('HY000', '[HY000] [unixODBC][Oracle][ODBC][Ora]ORA-28009: connection as SYS should be as SYSDBA or SYSOPER\\n (28009) (SQLDriverConnect)')\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/704", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/704/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/704/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/704/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/704", "id": 562433566, "node_id": "MDU6SXNzdWU1NjI0MzM1NjY=", "number": 704, "title": "pyodbc 4.0.{29,30} unavailable for Mac OS X", "user": {"login": "cbcoutinho", "id": 12901868, "node_id": "MDQ6VXNlcjEyOTAxODY4", "avatar_url": "https://avatars1.githubusercontent.com/u/12901868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cbcoutinho", "html_url": "https://github.com/cbcoutinho", "followers_url": "https://api.github.com/users/cbcoutinho/followers", "following_url": "https://api.github.com/users/cbcoutinho/following{/other_user}", "gists_url": "https://api.github.com/users/cbcoutinho/gists{/gist_id}", "starred_url": "https://api.github.com/users/cbcoutinho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cbcoutinho/subscriptions", "organizations_url": "https://api.github.com/users/cbcoutinho/orgs", "repos_url": "https://api.github.com/users/cbcoutinho/repos", "events_url": "https://api.github.com/users/cbcoutinho/events{/privacy}", "received_events_url": "https://api.github.com/users/cbcoutinho/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-02-10T09:33:41Z", "updated_at": "2020-02-11T22:50:13Z", "closed_at": "2020-02-10T15:44:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "When installing `pyodbc` into a fresh virtualenv, `pip` downloads v4.0.28 - wheels for later versions are not available", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/700", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/700/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/700/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/700/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/700", "id": 561583887, "node_id": "MDU6SXNzdWU1NjE1ODM4ODc=", "number": 700, "title": "Cursor.fetchone() works only after cursor.nextset() on a seemingly correct query script", "user": {"login": "Semiarty", "id": 26329691, "node_id": "MDQ6VXNlcjI2MzI5Njkx", "avatar_url": "https://avatars0.githubusercontent.com/u/26329691?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Semiarty", "html_url": "https://github.com/Semiarty", "followers_url": "https://api.github.com/users/Semiarty/followers", "following_url": "https://api.github.com/users/Semiarty/following{/other_user}", "gists_url": "https://api.github.com/users/Semiarty/gists{/gist_id}", "starred_url": "https://api.github.com/users/Semiarty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Semiarty/subscriptions", "organizations_url": "https://api.github.com/users/Semiarty/orgs", "repos_url": "https://api.github.com/users/Semiarty/repos", "events_url": "https://api.github.com/users/Semiarty/events{/privacy}", "received_events_url": "https://api.github.com/users/Semiarty/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-07T11:33:10Z", "updated_at": "2020-02-11T08:39:41Z", "closed_at": "2020-02-11T08:39:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7.6.final.0 64-bit\r\n- pyodbc: 4.0.28\r\n- OS: Windows 10 64-bit\r\n- DB: MS SQL\r\n- driver: SQL Server / ODBC Driver 17 for SQL Server (tried both)\r\n\r\n### Issue\r\n```python\r\nimport pyodbc\r\nimport sys\r\nfrom contextlib import contextmanager\r\nimport textwrap\r\nimport pandas as pd\r\n\r\n@contextmanager\r\ndef open_db_connection(connection_string):\r\n    pyodbc.pooling = False\r\n    connection = pyodbc.connect(connection_string)\r\n\r\n    try:\r\n        yield connection\r\n    except pyodbc.DatabaseError as err:\r\n        error, = err.args\r\n        sys.stderr.write(error.message)\r\n    finally:\r\n        connection.close()\r\n\r\ndef create_query_string(sql_full_path):\r\n    with open(sql_full_path, 'r') as f_in:\r\n        lines = f_in.read()\r\n\r\n    query_string = textwrap.dedent(\"\"\"{}\"\"\".format(lines))\r\n    return query_string\r\n\r\ndef query(server, database, driver, queryObj):\r\n\r\n    connection_string = 'DRIVER={};SERVER={};DATABASE={};Trusted_Connection=yes'.format(driver, server, database)\r\n    \r\n    noCount = \"\"\" SET NOCOUNT ON; \"\"\"\r\n    with open_db_connection(connection_string) as conn:\r\n        res = pd.read_sql_query(noCount+queryObj, conn)\r\n\r\n    return res\r\n\r\n\r\ndef get_data_set(sql_file_name, db_info):\r\n    query_string = create_query_string(sql_file_name+'.sql')\r\n    server = db_info['server']\r\n    database = db_info['database']\r\n    driver = db_info['driver']\r\n    df = query(server, database, driver, query_string)\r\n    #df.to_excel(sql_file_name+'_backup.xlsx', index=False)\r\n    return df\r\n\r\ndb_info = {'server' : 'wsp', 'database' : 'fin', 'driver' : 'SQL Server'}\r\n\r\ndf = get_data_set('equities', db_info)\r\n```\r\nSQL part \r\n```sql\r\nIF OBJECT_ID('tempdb..#tmp') IS NOT NULL DROP TABLE #tmp;\r\nselect * \r\ninto #tmp \r\nfrom fin.dbo.items_info\r\n\r\nIF OBJECT_ID('tempdb..#test1') IS NOT NULL DROP TABLE #test1;\r\nselect t.PositionID, b.SecurityID\r\ninto #test1\r\nfrom #tmp as t\r\ninner join fin.dbo.items  as b on (b.PositionID = t.PositionID and b.StudyDate = '20191230')\r\nwhere t.ast = 'eq';\r\n\r\nIF OBJECT_ID('tempdb..#beta_index') IS NOT NULL DROP TABLE #beta_index;\r\nselect distinct isin, beta_index into #beta_index from md.data.equity; \r\n\r\nIF OBJECT_ID('tempdb..#test2') IS NOT NULL DROP TABLE #test2;\r\nselect t.PositionID,    \r\n       case\r\n       when count(i.beta_index)=0 then 1\r\n       else count(i.beta_index)\r\n       end as noIndex\r\ninto #test2 \r\nfrom #test1 as t \r\n   left join #beta_index as i on (t.SecurityID = i.isin)\r\n   group by t.PositionID;\r\n\r\nselect * from #test2\r\n```\r\n#### Problem description\r\nInitially I figured it had something to do with pandas read_from_sql() function, however I tried manually fetching a table from database by using pyodbc, which resulted in the same error.\r\n \r\nI am trying to fetch #test2 table, however it results in \"ProgrammingError: No results.  Previous SQL was not a query.\". If I try to fetch #test1, it works fine. It may has something to do with counting/grouping, I am not sure. No issues with other lengthy queries with insert, update, group though.\r\n\r\nAdditionally, this query works fine when running it in SSMS v18.4 and I get results from #test2.\r\n\r\nWhile doing further research, I have found a \"potential\" solution, but it won't help me as I need pandas to pull data.\r\nAfter connecting to the base manually and executing a query:\r\ncursor.fetchone() (fails with the aforementioned error)\r\ncursor.nextset() (Results: True)\r\ncursor.fetchone() (Returns expected output)\r\n\r\nIt may be down to my lack of knowledge in SQL and my query is not properly written or it could be something else. Could you please advise?\r\n\r\n#### Expected Output\r\nI expect to get an output from #test2 table. The select statement should return a non empty table (which it does in SSMS). However cursor.fetchone()/fetchall() throws an error initially and only after calling cursor.nextset(), fetching is working. ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/699", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/699/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/699/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/699/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/699", "id": 559777873, "node_id": "MDU6SXNzdWU1NTk3Nzc4NzM=", "number": 699, "title": "Wrong error message when driver version is not found", "user": {"login": "hypdeb", "id": 18333810, "node_id": "MDQ6VXNlcjE4MzMzODEw", "avatar_url": "https://avatars1.githubusercontent.com/u/18333810?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hypdeb", "html_url": "https://github.com/hypdeb", "followers_url": "https://api.github.com/users/hypdeb/followers", "following_url": "https://api.github.com/users/hypdeb/following{/other_user}", "gists_url": "https://api.github.com/users/hypdeb/gists{/gist_id}", "starred_url": "https://api.github.com/users/hypdeb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hypdeb/subscriptions", "organizations_url": "https://api.github.com/users/hypdeb/orgs", "repos_url": "https://api.github.com/users/hypdeb/repos", "events_url": "https://api.github.com/users/hypdeb/events{/privacy}", "received_events_url": "https://api.github.com/users/hypdeb/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-04T15:02:16Z", "updated_at": "2020-02-05T08:49:01Z", "closed_at": "2020-02-05T08:49:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7 64-bit\r\n- pyodbc: 4.0.28\r\n- OS: Windows 10 Pro\r\n- DB: 13.0.5081.1\r\n- driver: Multiple\r\n\r\n### Issue\r\n\r\nExpected : specifying driver version that isn't installed gives error message which suggests the driver  that is specified is not found.\r\n\r\nActual : error message says driver is not specified at all, although it is.\r\n\r\nThis error message can be very frustrating as it will lead you to believe your connection string is badly formatted (the driver part is not recognized), while it's actually caused by the driver version not being installed.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/693", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/693/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/693/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/693/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/693", "id": 556253383, "node_id": "MDU6SXNzdWU1NTYyNTMzODM=", "number": 693, "title": "pyodbc.Error: 'HY000', 'The driver did not supply an error!' while accessing Access database", "user": {"login": "Amadeus111", "id": 49221199, "node_id": "MDQ6VXNlcjQ5MjIxMTk5", "avatar_url": "https://avatars2.githubusercontent.com/u/49221199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Amadeus111", "html_url": "https://github.com/Amadeus111", "followers_url": "https://api.github.com/users/Amadeus111/followers", "following_url": "https://api.github.com/users/Amadeus111/following{/other_user}", "gists_url": "https://api.github.com/users/Amadeus111/gists{/gist_id}", "starred_url": "https://api.github.com/users/Amadeus111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Amadeus111/subscriptions", "organizations_url": "https://api.github.com/users/Amadeus111/orgs", "repos_url": "https://api.github.com/users/Amadeus111/repos", "events_url": "https://api.github.com/users/Amadeus111/events{/privacy}", "received_events_url": "https://api.github.com/users/Amadeus111/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-01-28T14:39:22Z", "updated_at": "2020-01-28T18:24:57Z", "closed_at": "2020-01-28T18:24:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n**Environment**\r\nTo diagnose, we usually need to know the following, including version numbers. On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\nPython: 2.7 32-bit\r\npyodbc: 4.0.28\r\nOS: Windows 10\r\nDB: Access (.mdb) 32-bit\r\ndriver: Driver do Microsoft Access (.mdb), Driver do Microsoft Excel(.xls)\r\n\r\n**Issue**\r\nI am running a Python script to update tables in Access (.mdb) and Excel files by using pyodbc. I did not have any problem until this week.\r\nNow I am having \" pyodbc.Error: ('HY000', 'The driver did not supply an error!') \" error.\r\n\r\nBasically the script accesses to an Excel sheet and copies everything in that sheet into an Access table. \r\n\r\n` \r\n        \r\n       pending_permits_xl = code3_prefix + '_pending_permits.xls'\r\n        if os.path.exists(pending_permits_xl):\r\n            print(pending_permits_xl)\r\n            conn1 = pyodbc.connect(\r\n                'DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};DBQ=' + pending_permits_xl,\r\n                autocommit=True)\r\n            cursor_pendings = conn1.cursor()\r\n            excel_pendings = cursor_pendings.execute(\r\n                'SELECT PERMIT_NUM, CNTY_CD, QUAD_DESC, PER_NAME, REGION_COD, DATE_RECEI, \r\n               STATUS_DAT, STATUS, '\r\n                'STATUS_DES, LAT_DEG, LAT_MIN, LAT_SEC, LNG_DEG, LNG_MIN, LNG_SEC, APP_TYPE, \r\n                ACRES_PPSD, MINE_TYPES '\r\n                'FROM [' + code3 + '_pending_permits$]').fetchall()\r\n\r\n\r\n            conn = pyodbc.connect(\r\n                r'Driver={Microsoft Access Driver (*.mdb, *.accdb)};'\r\n                r'DBQ=' + code3_path + '\\\\Mine_Histories.mdb;', autocommit=True)\r\n            mdb_cursor = conn.cursor()\r\n            if mdb_cursor.tables(table='pending', tableType='TABLE').fetchone():\r\n                mdb_cursor.execute('DROP TABLE pending')\r\n            mdb_cursor.execute('CREATE TABLE pending (PERMIT_NUM varchar(255), CNTY_CD Number, \r\n           QUAD_DESC varchar(255), '\r\n                               'PER_NAME varchar(255), REGION_COD varchar(255), DATE_RECEI datetime, '\r\n                               'STATUS_DAT datetime, STATUS varchar(255), STATUS_DES varchar(255), LAT_DEG \r\n                              Number, '\r\n                               'LAT_MIN Number, LAT_SEC Number, LNG_DEG Number, LNG_MIN Number, \r\n                                LNG_SEC Number, '\r\n                               'APP_TYPE varchar(255), ACRES_PPSD varchar(255), MINE_TYPES varchar(255));')\r\n            mdb_cursor.executemany('INSERT INTO pending (PERMIT_NUM, CNTY_CD, QUAD_DESC, \r\n                                                    PER_NAME, REGION_COD, '\r\n                                   'DATE_RECEI, STATUS_DAT, STATUS, STATUS_DES, LAT_DEG, LAT_MIN, LAT_SEC, \r\n                                      LNG_DEG, '\r\n                                   'LNG_MIN, LNG_SEC, APP_TYPE, ACRES_PPSD, MINE_TYPES) VALUES '\r\n                                   '(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)', excel_pendings)\r\n            cursor_pendings.close()\r\n            conn1.close()\r\n            mdb_cursor.close()\r\n            conn.close() `\r\n\r\nI had an update on Excel from Windows last week. Would it be related to that?\r\nI do not want to update over 600 tables manually :(\r\nAny Help appreciated, thank you!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/691", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/691/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/691/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/691/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/691", "id": 555132786, "node_id": "MDU6SXNzdWU1NTUxMzI3ODY=", "number": 691, "title": "Deprecation warning over invalid escape sequences", "user": {"login": "tirkarthi", "id": 3972343, "node_id": "MDQ6VXNlcjM5NzIzNDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/3972343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tirkarthi", "html_url": "https://github.com/tirkarthi", "followers_url": "https://api.github.com/users/tirkarthi/followers", "following_url": "https://api.github.com/users/tirkarthi/following{/other_user}", "gists_url": "https://api.github.com/users/tirkarthi/gists{/gist_id}", "starred_url": "https://api.github.com/users/tirkarthi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tirkarthi/subscriptions", "organizations_url": "https://api.github.com/users/tirkarthi/orgs", "repos_url": "https://api.github.com/users/tirkarthi/repos", "events_url": "https://api.github.com/users/tirkarthi/events{/privacy}", "received_events_url": "https://api.github.com/users/tirkarthi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-25T20:15:32Z", "updated_at": "2020-02-14T01:01:36Z", "closed_at": "2020-02-14T01:01:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using raw string or escaping it would fix it.\r\n\r\n```find . -iname '*.py'  | xargs -P 4 -I{} python3.8 -Wall -m py_compile {}\r\n\r\n./setup.py:299: DeprecationWarning: invalid escape sequence \\d\r\n  if result != 'master' and not re.match('^v\\d+$', result):\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/687", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/687/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/687/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/687/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/687", "id": 554484120, "node_id": "MDU6SXNzdWU1NTQ0ODQxMjA=", "number": 687, "title": "Long expressions without aliases crash Python with Impala", "user": {"login": "rlichtenwalter", "id": 2200662, "node_id": "MDQ6VXNlcjIyMDA2NjI=", "avatar_url": "https://avatars0.githubusercontent.com/u/2200662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rlichtenwalter", "html_url": "https://github.com/rlichtenwalter", "followers_url": "https://api.github.com/users/rlichtenwalter/followers", "following_url": "https://api.github.com/users/rlichtenwalter/following{/other_user}", "gists_url": "https://api.github.com/users/rlichtenwalter/gists{/gist_id}", "starred_url": "https://api.github.com/users/rlichtenwalter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rlichtenwalter/subscriptions", "organizations_url": "https://api.github.com/users/rlichtenwalter/orgs", "repos_url": "https://api.github.com/users/rlichtenwalter/repos", "events_url": "https://api.github.com/users/rlichtenwalter/events{/privacy}", "received_events_url": "https://api.github.com/users/rlichtenwalter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-24T00:27:12Z", "updated_at": "2020-01-24T17:39:06Z", "closed_at": "2020-01-24T17:39:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.6.9\r\n- pyodbc: 4.0.28\r\n- OS: GNU Linux (kernel 4.4.0-1073-aws)\r\n- DB: Impala/HDFS\r\n- Driver: Cloudera Impala ODBC Driver 64-bit\r\n\r\n### Issue\r\n\r\n#### Background\r\n- Using pyodbc to query Impala, but this issue may affect other database engines.\r\n- Using the latest version of pyodbc. Have tested some previous versions with the same issue.\r\n- By its nature, this error affects multiple (probably all) operating systems, python versions, drivers, and databases.\r\n- There seems to be a stack buffer overflow issue when long implicit column names get returned as a result of the query.\r\n\r\n#### Example\r\nConsider the following query, which is but one example of a class of queries that could cause this issue:\r\n\r\n    SELECT\r\n        DISTINCT\r\n            CASE\r\n                WHEN field IN ( 'string_1', 'string_2', ..., 'string_n' ) THEN NULL\r\n                ELSE field\r\n                END\r\n    FROM\r\n        table\r\n    LIMIT 1;\r\n\r\nRun this with:\r\n\r\n    cursor.execute( sql )\r\n\r\n##### Expected\r\nThe command completes successfully and the python interpreter is prepared to process additional code.\r\n\r\n##### Observed\r\nThe python interpreter crashes with `*** stack smashing detected ***`.\r\n\r\n### Workaround\r\nExecuting equivalent versions of the query that preserve the long, un-aliased SELECT expression generate the error condition. Selecting using a short expression from a CTE or subquery (i.e. effectively aliasing) does not generate the error condition. Likewise, directly selecting with an alias avoids the error condition, so the following completes successfully:\r\n\r\n    SELECT\r\n        DISTINCT\r\n            CASE\r\n                WHEN field IN ( 'string_1', 'string_2', ..., 'string_n' ) THEN NULL\r\n                ELSE field\r\n                END AS shortname\r\n    FROM\r\n        table\r\n    LIMIT 1;", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/683", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/683/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/683/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/683/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/683", "id": 551404877, "node_id": "MDU6SXNzdWU1NTE0MDQ4Nzc=", "number": 683, "title": "Log query", "user": {"login": "nmhub", "id": 1713970, "node_id": "MDQ6VXNlcjE3MTM5NzA=", "avatar_url": "https://avatars1.githubusercontent.com/u/1713970?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nmhub", "html_url": "https://github.com/nmhub", "followers_url": "https://api.github.com/users/nmhub/followers", "following_url": "https://api.github.com/users/nmhub/following{/other_user}", "gists_url": "https://api.github.com/users/nmhub/gists{/gist_id}", "starred_url": "https://api.github.com/users/nmhub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nmhub/subscriptions", "organizations_url": "https://api.github.com/users/nmhub/orgs", "repos_url": "https://api.github.com/users/nmhub/repos", "events_url": "https://api.github.com/users/nmhub/events{/privacy}", "received_events_url": "https://api.github.com/users/nmhub/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-17T13:06:40Z", "updated_at": "2020-01-21T09:03:58Z", "closed_at": "2020-01-21T09:03:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is there any way to log the query generated by execute(sql, *parameters)?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/682", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/682/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/682/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/682/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/682", "id": 549528860, "node_id": "MDU6SXNzdWU1NDk1Mjg4NjA=", "number": 682, "title": "Error pyodbc.Cursor at xxxxx", "user": {"login": "fabienarnaud", "id": 59871287, "node_id": "MDQ6VXNlcjU5ODcxMjg3", "avatar_url": "https://avatars2.githubusercontent.com/u/59871287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fabienarnaud", "html_url": "https://github.com/fabienarnaud", "followers_url": "https://api.github.com/users/fabienarnaud/followers", "following_url": "https://api.github.com/users/fabienarnaud/following{/other_user}", "gists_url": "https://api.github.com/users/fabienarnaud/gists{/gist_id}", "starred_url": "https://api.github.com/users/fabienarnaud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fabienarnaud/subscriptions", "organizations_url": "https://api.github.com/users/fabienarnaud/orgs", "repos_url": "https://api.github.com/users/fabienarnaud/repos", "events_url": "https://api.github.com/users/fabienarnaud/events{/privacy}", "received_events_url": "https://api.github.com/users/fabienarnaud/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-14T12:15:46Z", "updated_at": "2020-01-14T13:00:46Z", "closed_at": "2020-01-14T13:00:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi all,\r\n\r\nI've been trying to use pyodbc from my Azure Databricks for the first time but am struggling to use it to connect to Azure SQL DB.\r\nI installed the pyodbc package and unixodbc-dev, installed the mssqlodbc drivers.\r\nI configured the connection string in my python notebook which seems to be working because I receive an error:\r\n\r\n`ProgrammingError: ('42S02', \"[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'lnd.lnd_man_currencyxxx'. (208) (SQLExecDirectW)\")`\r\n\r\n when running a SELECT on a table that doesn't exist in my database.\r\n\r\nHowever when the SELECT points to an existing table, I receive the following error:\r\n\r\n`Out[11]: <pyodbc.Cursor at 0x7f06249e9030>`\r\n\r\nBelow is the code:\r\n\r\n```\r\nconn = pyodbc.connect( 'DRIVER={ODBC Driver 17 for SQL Server};'\r\n                       'SERVER=xxx.database.windows.net;'\r\n                       'DATABASE=xxx;UID=xxx;'\r\n                       'PWD=xxx')\r\n\r\ncursor = conn.cursor()\r\ntestSQL = \"SELECT count(*) FROM [lnd].[lnd_man_currency]\"\r\ncursor.execute(testSQL)\r\n```\r\n\r\nAny idea what the error actually means and what I could be missing?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/678", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/678/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/678/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/678/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/678", "id": 548525294, "node_id": "MDU6SXNzdWU1NDg1MjUyOTQ=", "number": 678, "title": "File not found error when connecting from RHEL 8 to SQL Server", "user": {"login": "colelloa", "id": 7152600, "node_id": "MDQ6VXNlcjcxNTI2MDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/7152600?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colelloa", "html_url": "https://github.com/colelloa", "followers_url": "https://api.github.com/users/colelloa/followers", "following_url": "https://api.github.com/users/colelloa/following{/other_user}", "gists_url": "https://api.github.com/users/colelloa/gists{/gist_id}", "starred_url": "https://api.github.com/users/colelloa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colelloa/subscriptions", "organizations_url": "https://api.github.com/users/colelloa/orgs", "repos_url": "https://api.github.com/users/colelloa/repos", "events_url": "https://api.github.com/users/colelloa/events{/privacy}", "received_events_url": "https://api.github.com/users/colelloa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-01-12T05:49:04Z", "updated_at": "2020-02-20T15:47:11Z", "closed_at": "2020-02-20T15:44:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI am using RHEL  8.1, Python 3.6.8, and pyodbc==4.0.28 - working inside a virtual environment, if that matters.\r\n\r\nWhen connecting to a SQL Server, I get the following error: \r\n```\r\npyodbc.Error: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib '<path>' : file not found (0) (SQLDriverConnect)\")\r\n````\r\n\r\nI've tried a few different things - providing absolute paths, using alias names in odbcinst, different driver versions - still get the same error:\r\n```\r\n>>> driver='/opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1'\r\n>>> pyodbc.connect('DRIVER='+driver+';SERVER='+server+';PORT=1443;DATABASE='+database+';UID='+username+';PWD='+password)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\npyodbc.Error: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib '/opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1' : file not found (0) (SQLDriverConnect)\")\r\n>>> driver='{ODBC Driver 17 for SQL Server}'\r\n>>> pyodbc.connect('DRIVER='+driver+';SERVER='+server+';PORT=1443;DATABASE='+database+';UID='+username+';PWD='+password)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\npyodbc.Error: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib '/opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1' : file not found (0) (SQLDriverConnect)\")\r\n>>> driver='{ODBC Driver 13 for SQL Server}'\r\n>>> pyodbc.connect('DRIVER='+driver+';SERVER='+server+';PORT=1443;DATABASE='+database+';UID='+username+';PWD='+password)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\npyodbc.Error: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib '/opt/microsoft/msodbcsql/lib64/libmsodbcsql-13.1.so.9.2' : file not found (0) (SQLDriverConnect)\")\r\n>>> driver='/opt/microsoft/msodbcsql/lib64/libmsodbcsql-13.1.so.9.2'\r\n>>> pyodbc.connect('DRIVER='+driver+';SERVER='+server+';PORT=1443;DATABASE='+database+';UID='+username+';PWD='+password)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\npyodbc.Error: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib '/opt/microsoft/msodbcsql/lib64/libmsodbcsql-13.1.so.9.2' : file not found (0) (SQLDriverConnect)\")\r\n```\r\nHere is my odbcinst.ini:\r\n```\r\ncat /etc/odbcinst.ini\r\n[ODBC Driver 13 for SQL Server]\r\nDescription=Microsoft ODBC Driver 13 for SQL Server\r\nDriver=/opt/microsoft/msodbcsql/lib64/libmsodbcsql-13.1.so.9.2\r\nUsageCount=1\r\n\r\n[ODBC Driver 17 for SQL Server]\r\nDescription=Microsoft ODBC Driver 17 for SQL Server\r\nDriver=/opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1\r\nUsageCount=1\r\n```\r\n\r\nI've also tried to ensure that pyodbc will be able to find my files:\r\n```\r\n$ ls -la /usr/local/etc/\r\ntotal 0\r\ndrwxr-xr-x.  2 root root  42 Jan 12 00:29 .\r\ndrwxr-xr-x. 12 root root 131 Aug 13 10:08 ..\r\nlrwxrwxrwx   1 root root  13 Jan 12 00:29 odbc.ini -> /etc/odbc.ini\r\nlrwxrwxrwx   1 root root  17 Jan 12 00:29 odbcinst.ini -> /etc/odbcinst.ini\r\n```\r\n\r\nFiles definitely exist:\r\n```\r\n$ ls -la /opt/microsoft/msodbcsql/lib64/libmsodbcsql-13.1.so.9.2\r\n-rwxr-xr-x 1 root root 16753837 Jan  4  2018 /opt/microsoft/msodbcsql/lib64/libmsodbcsql-13.1.so.9.2\r\n\r\n$ ls -la /opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1\r\n-rwxr-xr-x 1 root root 2093216 Sep 26 12:19 /opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1\r\n```\r\n\r\nldd seems to show nothing is missing:\r\n```\r\n$ ldd /opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1\r\n        linux-vdso.so.1 (0x00007ffc2f697000)\r\n        libdl.so.2 => /lib64/libdl.so.2 (0x00007f8f2c260000)\r\n        librt.so.1 => /lib64/librt.so.1 (0x00007f8f2c057000)\r\n        libodbcinst.so.2 => /opt/sqlanywhere17/lib64/libodbcinst.so.2 (0x00007f8f2bdc1000)\r\n        libkrb5.so.3 => /lib64/libkrb5.so.3 (0x00007f8f2bad1000)\r\n        libgssapi_krb5.so.2 => /lib64/libgssapi_krb5.so.2 (0x00007f8f2b881000)\r\n        libstdc++.so.6 => /lib64/libstdc++.so.6 (0x00007f8f2b4ec000)\r\n        libm.so.6 => /lib64/libm.so.6 (0x00007f8f2b16a000)\r\n        libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00007f8f2af52000)\r\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f8f2ad32000)\r\n        libc.so.6 => /lib64/libc.so.6 (0x00007f8f2a96f000)\r\n        /lib64/ld-linux-x86-64.so.2 (0x00007f8f2c877000)\r\n        libdbtasks17_r.so => /opt/sqlanywhere17/lib64/libdbtasks17_r.so (0x00007f8f2a729000)\r\n        libnsl.so.1 => /lib64/libnsl.so.1 (0x00007f8f2a50f000)\r\n        libk5crypto.so.3 => /lib64/libk5crypto.so.3 (0x00007f8f2a2f3000)\r\n        libcom_err.so.2 => /lib64/libcom_err.so.2 (0x00007f8f2a0ef000)\r\n        libkrb5support.so.0 => /lib64/libkrb5support.so.0 (0x00007f8f29ede000)\r\n        libcrypto.so.1.1 => /lib64/libcrypto.so.1.1 (0x00007f8f29a00000)\r\n        libkeyutils.so.1 => /lib64/libkeyutils.so.1 (0x00007f8f297fc000)\r\n        libresolv.so.2 => /lib64/libresolv.so.2 (0x00007f8f295e5000)\r\n        libtirpc.so.3 => /lib64/libtirpc.so.3 (0x00007f8f293b2000)\r\n        libselinux.so.1 => /lib64/libselinux.so.1 (0x00007f8f29187000)\r\n        libz.so.1 => /lib64/libz.so.1 (0x00007f8f28f70000)\r\n        libpcre2-8.so.0 => /lib64/libpcre2-8.so.0 (0x00007f8f28cec000)\r\n```\r\n\r\nand\r\n\r\n```\r\n$ ldd /opt/microsoft/msodbcsql/lib64/libmsodbcsql-13.1.so.9.2\r\n        linux-vdso.so.1 (0x00007ffe1cd8b000)\r\n        libdl.so.2 => /lib64/libdl.so.2 (0x00007f7108f9e000)\r\n        librt.so.1 => /lib64/librt.so.1 (0x00007f7108d95000)\r\n        libodbcinst.so.2 => /opt/sqlanywhere17/lib64/libodbcinst.so.2 (0x00007f7108aff000)\r\n        libcrypto.so.10 => /lib64/libcrypto.so.10 (0x00007f710869c000)\r\n        libkrb5.so.3 => /lib64/libkrb5.so.3 (0x00007f71083ac000)\r\n        libgssapi_krb5.so.2 => /lib64/libgssapi_krb5.so.2 (0x00007f710815c000)\r\n        libcurl.so.4 => /lib64/libcurl.so.4 (0x00007f7107ece000)\r\n        libssl.so.10 => /lib64/libssl.so.10 (0x00007f7107c5f000)\r\n        libuuid.so.1 => /lib64/libuuid.so.1 (0x00007f7107a57000)\r\n        libstdc++.so.6 => /lib64/libstdc++.so.6 (0x00007f71076c2000)\r\n        libm.so.6 => /lib64/libm.so.6 (0x00007f7107340000)\r\n        libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00007f7107128000)\r\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f7106f08000)\r\n        libc.so.6 => /lib64/libc.so.6 (0x00007f7106b45000)\r\n        /lib64/ld-linux-x86-64.so.2 (0x00007f710959d000)\r\n        libdbtasks17_r.so => /opt/sqlanywhere17/lib64/libdbtasks17_r.so (0x00007f71068ff000)\r\n        libnsl.so.1 => /lib64/libnsl.so.1 (0x00007f71066e5000)\r\n        libz.so.1 => /lib64/libz.so.1 (0x00007f71064ce000)\r\n        libk5crypto.so.3 => /lib64/libk5crypto.so.3 (0x00007f71062b2000)\r\n        libcom_err.so.2 => /lib64/libcom_err.so.2 (0x00007f71060ae000)\r\n        libkrb5support.so.0 => /lib64/libkrb5support.so.0 (0x00007f7105e9d000)\r\n        libcrypto.so.1.1 => /lib64/libcrypto.so.1.1 (0x00007f71059bf000)\r\n        libkeyutils.so.1 => /lib64/libkeyutils.so.1 (0x00007f71057bb000)\r\n        libresolv.so.2 => /lib64/libresolv.so.2 (0x00007f71055a4000)\r\n        libnghttp2.so.14 => /lib64/libnghttp2.so.14 (0x00007f710537e000)\r\n        libidn2.so.0 => /lib64/libidn2.so.0 (0x00007f7105160000)\r\n        libssh.so.4 => /lib64/libssh.so.4 (0x00007f7104ed5000)\r\n        libpsl.so.5 => /lib64/libpsl.so.5 (0x00007f7104cc4000)\r\n        libssl.so.1.1 => /lib64/libssl.so.1.1 (0x00007f7104a30000)\r\n        libldap-2.4.so.2 => /lib64/libldap-2.4.so.2 (0x00007f71047e2000)\r\n        liblber-2.4.so.2 => /lib64/liblber-2.4.so.2 (0x00007f71045d2000)\r\n        libbrotlidec.so.1 => /lib64/libbrotlidec.so.1 (0x00007f71043c6000)\r\n        libtirpc.so.3 => /lib64/libtirpc.so.3 (0x00007f7104193000)\r\n        libselinux.so.1 => /lib64/libselinux.so.1 (0x00007f7103f68000)\r\n        libunistring.so.2 => /lib64/libunistring.so.2 (0x00007f7103be7000)\r\n        libsasl2.so.3 => /lib64/libsasl2.so.3 (0x00007f71039c9000)\r\n        libbrotlicommon.so.1 => /lib64/libbrotlicommon.so.1 (0x00007f71037a9000)\r\n        libpcre2-8.so.0 => /lib64/libpcre2-8.so.0 (0x00007f7103525000)\r\n        libcrypt.so.1 => /lib64/libcrypt.so.1 (0x00007f71032fc000)\r\n```\r\n\r\nNot sure what to try next.\r\n\r\nThanks in advance!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/677", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/677/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/677/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/677/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/677", "id": 548337593, "node_id": "MDU6SXNzdWU1NDgzMzc1OTM=", "number": 677, "title": "DLL load failed after migrating to 4.0.28", "user": {"login": "rjanuzi", "id": 7253171, "node_id": "MDQ6VXNlcjcyNTMxNzE=", "avatar_url": "https://avatars1.githubusercontent.com/u/7253171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rjanuzi", "html_url": "https://github.com/rjanuzi", "followers_url": "https://api.github.com/users/rjanuzi/followers", "following_url": "https://api.github.com/users/rjanuzi/following{/other_user}", "gists_url": "https://api.github.com/users/rjanuzi/gists{/gist_id}", "starred_url": "https://api.github.com/users/rjanuzi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rjanuzi/subscriptions", "organizations_url": "https://api.github.com/users/rjanuzi/orgs", "repos_url": "https://api.github.com/users/rjanuzi/repos", "events_url": "https://api.github.com/users/rjanuzi/events{/privacy}", "received_events_url": "https://api.github.com/users/rjanuzi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-10T23:24:49Z", "updated_at": "2020-02-08T16:21:03Z", "closed_at": "2020-02-08T16:21:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.7.0 (64-Bit)\r\n- pyodbc: 4.0.28\r\n- OS: Windows (64-bit)\r\n- DB: MS SQL Server 2008 R2\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\n\r\nOn \"import pyodbc\" I'am getting the following message: \"ImportError: DLL load failed: N\u00e3o foi poss\u00edvel encontrar o m\u00f3dulo especificado.\". Works fine with version 4.0.27.\r\n\r\nTest code:\r\n\r\nimport pyodbc\r\n\r\nDRIVER='{ODBC Driver 17 for SQL Server}'\r\n\r\nSERVER=r'localhost\\SQLEXPRESS'\r\nDATABASE='<db>'\r\nUID='<user>'\r\nPASSWORD='<password>'\r\n\r\ndef get_connection_string():\r\n    return 'DRIVER=%s;SERVER=%s;DATABASE=%s;UID=%s;PWD=%s' % (DRIVER, SERVER, DATABASE, UID, PASSWORD)\r\n\r\ndef exec_query_raw(sql):\r\n    with pyodbc.connect(config.get_connection_string(), autocommit=True) as cnxn:\r\n        results = list(cnxn.cursor().execute(sql))\r\n        return results\r\n\r\nprint(exec_query_raw(sql='SELECT * FROM <table>'))", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/675", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/675/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/675/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/675/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/675", "id": 548156640, "node_id": "MDU6SXNzdWU1NDgxNTY2NDA=", "number": 675, "title": "Is it possible to reuse a parameter within a query?", "user": {"login": "woodlee", "id": 316636, "node_id": "MDQ6VXNlcjMxNjYzNg==", "avatar_url": "https://avatars0.githubusercontent.com/u/316636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/woodlee", "html_url": "https://github.com/woodlee", "followers_url": "https://api.github.com/users/woodlee/followers", "following_url": "https://api.github.com/users/woodlee/following{/other_user}", "gists_url": "https://api.github.com/users/woodlee/gists{/gist_id}", "starred_url": "https://api.github.com/users/woodlee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/woodlee/subscriptions", "organizations_url": "https://api.github.com/users/woodlee/orgs", "repos_url": "https://api.github.com/users/woodlee/repos", "events_url": "https://api.github.com/users/woodlee/events{/privacy}", "received_events_url": "https://api.github.com/users/woodlee/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-10T15:56:36Z", "updated_at": "2020-01-10T16:52:13Z", "closed_at": "2020-01-10T16:52:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.7.4\r\n- pyodbc: 4.0.28\r\n- OS: MacOS 10.14.6\r\n- DB: SQL Server 2017 (RTM-CU17)\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\n\r\n#### Short version\r\n\r\nIf I want to use a parameter's value more than once within a SQL query, is there any established way to do so in pyodbc without passing it multiple times in the parameter list to `execute`?\r\n\r\n#### Longer version\r\n\r\nI was recently faced with a need to write a query that does a batched read of a table in SQL Server backwards by its primary key, which happened to be a composite key formed from two columns. Something like this, where the PK is (OrderID, TagID):\r\n\r\n```\r\ncursor.execute('''\r\n\tSELECT TOP (1000) *\r\n\tFROM dbo.OrderTag\r\n\tWHERE OrderID < ? OR (OrderID = ? AND TagID < ?)\r\n\tORDER BY OrderID DESC, TagID DESC\r\n''', (last_read_order_id, last_read_order_id, last_read_tag_id))\r\n```\r\n\r\nAFAICT, pyodbc only supports positional parameters via the `?` placeholder, so the above seemed the most straightforward way to write the query even though it meant repeating the parameter. \r\n\r\nThe query executes fine, but I've found that SQL Server generates a poorly performing plan for it because it doesn't understand that the first and second parameters are \"the same\", and so has to resort to an index scan. (SQL Server seems to dislike descending reads in general, but for purposes of this issue we can set that aside!)\r\n\r\nI have managed to work around this with the following restructuring:\r\n\r\n```\r\ncursor.execute('''\r\n\tDECLARE @K0 INT = ?, @K1 INT = ?;\r\n\r\n\tSELECT TOP (1000) *\r\n\tFROM dbo.OrderTag\r\n\tWHERE OrderID < @K0 OR (OrderID = @K0 AND TagID < @K1)\r\n\tORDER BY OrderID DESC, TagID DESC\r\n''', (last_read_order_id, last_read_tag_id))\r\n```\r\n\r\n...and this indeed fixes the performance issue, but it feels hacky, and I want to ensure I'm not missing a more obvious or straightforward solution. Am I? Thank you!\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/670", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/670/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/670/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/670/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/670", "id": 545464243, "node_id": "MDU6SXNzdWU1NDU0NjQyNDM=", "number": 670, "title": "Very large integers as parameters", "user": {"login": "keitherskine", "id": 1158224, "node_id": "MDQ6VXNlcjExNTgyMjQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1158224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keitherskine", "html_url": "https://github.com/keitherskine", "followers_url": "https://api.github.com/users/keitherskine/followers", "following_url": "https://api.github.com/users/keitherskine/following{/other_user}", "gists_url": "https://api.github.com/users/keitherskine/gists{/gist_id}", "starred_url": "https://api.github.com/users/keitherskine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keitherskine/subscriptions", "organizations_url": "https://api.github.com/users/keitherskine/orgs", "repos_url": "https://api.github.com/users/keitherskine/repos", "events_url": "https://api.github.com/users/keitherskine/events{/privacy}", "received_events_url": "https://api.github.com/users/keitherskine/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-05T20:41:44Z", "updated_at": "2020-02-08T15:23:03Z", "closed_at": "2020-02-08T15:23:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7.5\r\n- pyodbc: 4.0.28\r\n- OS: Windows 10 Pro, 64-bit\r\n- DB: SQL Server 2019 Express\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\n\r\nPython allows integers of more-or-less any size.  When inserting a very large integer to a table as a parameter (a value larger than an 8 byte integer can contain), the value of -1 is inserted instead.  Oddly, an exception is also raised but not one of the standard PEP249 exceptions.  I would expect a PEP249 exception to be raised by pyodbc itself and nothing written to the database.  Here is the code that reproduces the issue:\r\n\r\n```python\r\nimport pyodbc\r\ncnxn = pyodbc.connect(dsn='<my_DSN>', autocommit=True)\r\ncrsr = cnxn.cursor()\r\n\r\ncrsr.execute(\"DROP TABLE IF EXISTS T1\")\r\ncrsr.execute(\"CREATE TABLE T1 (col1 BIGINT NULL)\")\r\n\r\ntry:\r\n    sql = \"INSERT INTO T1 (col1) VALUES (?)\"\r\n    parameters = (99999999999999999999999999999999999999999999999999,)\r\n    crsr.execute(sql, parameters)\r\nexcept Exception as err:\r\n    print('exception:', err)\r\n\r\nrows = crsr.execute(\"SELECT * FROM T1\").fetchall()\r\nprint('table records:', rows)\r\n\r\ncrsr.close()\r\ncnxn.close()\r\n```\r\n\r\nThis code outputs:\r\n```\r\nexception: <method 'execute' of 'pyodbc.Cursor' objects> returned a result with an error set\r\ntable records: [(-1, )]\r\n```\r\n\r\nMy guess is that [PyLong_AsLongLong](https://docs.python.org/3/c-api/long.html#c.PyLong_AsLongLong) is returning -1 (as expected) but then PyErr_Occurred() is not being checked somewhere.  [Here](https://github.com/mkleehammer/pyodbc/blob/master/src/params.cpp#L1469) perhaps?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/667", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/667/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/667/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/667/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/667", "id": 544684464, "node_id": "MDU6SXNzdWU1NDQ2ODQ0NjQ=", "number": 667, "title": "Support for DATABASE_URL", "user": {"login": "abitrolly", "id": 8781107, "node_id": "MDQ6VXNlcjg3ODExMDc=", "avatar_url": "https://avatars1.githubusercontent.com/u/8781107?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abitrolly", "html_url": "https://github.com/abitrolly", "followers_url": "https://api.github.com/users/abitrolly/followers", "following_url": "https://api.github.com/users/abitrolly/following{/other_user}", "gists_url": "https://api.github.com/users/abitrolly/gists{/gist_id}", "starred_url": "https://api.github.com/users/abitrolly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abitrolly/subscriptions", "organizations_url": "https://api.github.com/users/abitrolly/orgs", "repos_url": "https://api.github.com/users/abitrolly/repos", "events_url": "https://api.github.com/users/abitrolly/events{/privacy}", "received_events_url": "https://api.github.com/users/abitrolly/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-01-02T18:07:02Z", "updated_at": "2020-01-02T19:30:56Z", "closed_at": "2020-01-02T19:03:35Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "DATABASE_URL is [12factor](https://www.12factor.net/backing-services) concept that is great for apps portability.\r\n\r\n### \"expected behavior\"\r\n```\r\nconn = pyodbc.connect('mssql://user:pass@myhost/database')\r\n```\r\n\r\n### \"observed behavior\".\r\n```\r\nconn = pyodbc.connect(\r\n    'Driver={SQL Server};Server=myhost;Database=database;UID=user;PWD=pass;Trusted_Connection=yes;'\r\n)\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/663", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/663/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/663/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/663/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/663", "id": 542150079, "node_id": "MDU6SXNzdWU1NDIxNTAwNzk=", "number": 663, "title": "return __import__(\"pyodbc\") ImportError: DLL load failed: The specified module could not be found.", "user": {"login": "Elthas17", "id": 9678091, "node_id": "MDQ6VXNlcjk2NzgwOTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/9678091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Elthas17", "html_url": "https://github.com/Elthas17", "followers_url": "https://api.github.com/users/Elthas17/followers", "following_url": "https://api.github.com/users/Elthas17/following{/other_user}", "gists_url": "https://api.github.com/users/Elthas17/gists{/gist_id}", "starred_url": "https://api.github.com/users/Elthas17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Elthas17/subscriptions", "organizations_url": "https://api.github.com/users/Elthas17/orgs", "repos_url": "https://api.github.com/users/Elthas17/repos", "events_url": "https://api.github.com/users/Elthas17/events{/privacy}", "received_events_url": "https://api.github.com/users/Elthas17/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267816906, "node_id": "MDU6TGFiZWwyNjc4MTY5MDY=", "url": "https://api.github.com/repos/mkleehammer/pyodbc/labels/Investigating", "name": "Investigating", "color": "fef2c0", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 27, "created_at": "2019-12-24T14:50:27Z", "updated_at": "2020-03-25T12:56:41Z", "closed_at": "2020-02-08T17:38:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n- Python: Python 3.7.5  [MSC v.1916 64 bit (AMD64)] on win32\r\n- pyodbc:  4.0.28\r\n- OS: Microsoft Windows 10 Enterprise Version 10.0.17763 \r\n- DB: Microsoft SQL Server Enterprise (64-bit) 14\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\npackages\r\n- Flask==1.1.1\r\n- Flask-Cors==3.0.8\r\n- Flask-SQLAlchemy==2.4.1\r\n- SQLAlchemy==1.3.12\r\n- connexion==2.5.1\r\n\r\n### Issue\r\n\r\nHey, thank you for pyodbc.\r\n\r\nI upgraded from 4.0.27 (works fine)-> 4.0.28 and receive the following error / observed behaviour:\r\n\r\n> Traceback (most recent call last):\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask\\app.py\", line 2446, in wsgi_app\r\n>     response = self.full_dispatch_request()\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask\\app.py\", line 1951, in full_dispatch_request\r\n>     rv = self.handle_user_exception(e)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask_cors\\extension.py\", line 161, in wrapped_function\r\n>     return cors_after_request(app.make_response(f(*args, **kwargs)))\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask\\app.py\", line 1820, in handle_user_exception\r\n>     reraise(exc_type, exc_value, tb)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask\\_compat.py\", line 39, in reraise\r\n>     raise value\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask\\app.py\", line 1949, in full_dispatch_request\r\n>     rv = self.dispatch_request()\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask\\app.py\", line 1935, in dispatch_request\r\n>     return self.view_functions[rule.endpoint](**req.view_args)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\connexion\\decorators\\decorator.py\", line 48, in wrapper\r\n>     response = function(request)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\connexion\\decorators\\uri_parsing.py\", line 172, in wrapper\r\n>     response = function(request)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\connexion\\decorators\\parameter.py\", line 121, in wrapper\r\n>     return function(**kwargs)\r\n>   File \"[redacted]\\application\\endpoints\\redacted_my_python_file.py\", line 238, in my_redacted_function\r\n>     q_out = db.get_engine(None, 'redacted_SQL_ALCHEMY_BIND').execute(q).fetchall()\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask_sqlalchemy\\__init__.py\", line 956, in get_engine\r\n>     return connector.get_engine()\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask_sqlalchemy\\__init__.py\", line 561, in get_engine\r\n>     self._engine = rv = self._sa.create_engine(sa_url, options)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\flask_sqlalchemy\\__init__.py\", line 966, in create_engine\r\n>     return sqlalchemy.create_engine(sa_url, **engine_opts)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\sqlalchemy\\engine\\__init__.py\", line 479, in create_engine\r\n>     return strategy.create(*args, **kwargs)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\sqlalchemy\\engine\\strategies.py\", line 87, in create\r\n>     dbapi = dialect_cls.dbapi(**dbapi_args)\r\n>   File \"[redacted]\\venv\\lib\\site-packages\\sqlalchemy\\connectors\\pyodbc.py\", line 37, in dbapi\r\n>     return __import__(\"pyodbc\")\r\n> ImportError: DLL load failed: The specified module could not be found.\r\n\r\n\r\nI can replicate/remove the error by upgrading/downgrading pyodbc. \r\n\r\nexpected behaviour:\r\nno error\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/662", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/662/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/662/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/662/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/662", "id": 541414641, "node_id": "MDU6SXNzdWU1NDE0MTQ2NDE=", "number": 662, "title": "extra '<EOF>' added to SQL statements for Hive", "user": {"login": "zpz", "id": 5044408, "node_id": "MDQ6VXNlcjUwNDQ0MDg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5044408?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zpz", "html_url": "https://github.com/zpz", "followers_url": "https://api.github.com/users/zpz/followers", "following_url": "https://api.github.com/users/zpz/following{/other_user}", "gists_url": "https://api.github.com/users/zpz/gists{/gist_id}", "starred_url": "https://api.github.com/users/zpz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zpz/subscriptions", "organizations_url": "https://api.github.com/users/zpz/orgs", "repos_url": "https://api.github.com/users/zpz/repos", "events_url": "https://api.github.com/users/zpz/events{/privacy}", "received_events_url": "https://api.github.com/users/zpz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 784257622, "node_id": "MDU6TGFiZWw3ODQyNTc2MjI=", "url": "https://api.github.com/repos/mkleehammer/pyodbc/labels/Environment%20or%20Driver%20Issue", "name": "Environment or Driver Issue", "color": "46e2db", "default": false, "description": ""}, {"id": 207139526, "node_id": "MDU6TGFiZWwyMDcxMzk1MjY=", "url": "https://api.github.com/repos/mkleehammer/pyodbc/labels/Waiting%20for%20Info", "name": "Waiting for Info", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2019-12-22T06:33:52Z", "updated_at": "2020-03-04T20:10:04Z", "closed_at": "2020-03-04T20:10:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n- Python:  3.6.8\r\n- pyodbc: 4.0.27\r\n- OS:         ubuntu 18.04\r\n- DB:         Hive 0.13\r\n- driver:    Hortonworks ODBC driver for Hive downloaded at http://public-repo-1.hortonworks.com/HDP/hive-odbc/2.1.2.1002/debian/hive-odbc-native_2.1.2.1002-2_amd64.deb\r\n\r\n### Issue\r\n\r\nconnected with \r\n\r\n```\r\npyodbc.connect('host=abc', driver='...', \r\n                    HiveServerType=2,\r\n                    port=10000,,\r\n                    uid='username',\r\n                    password='password',\r\n                    AuthMech=3,\r\n                    ssl=1,\r\n                    AllowSelfSignedServerCert=1,\r\n                    AutoCommit=1,\r\n                    UseNativeQuery=1,\r\n)\r\n```\r\n\r\nObtained cursor. Then\r\n\r\n```\r\ncursor.execute('show databases')\r\n```\r\n\r\nreturns\r\n\r\n```\r\n>>> hh._cursor.execute(\"show databases\")                                                                                            \r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\npyodbc.Error: ('HY000', \"[HY000] [Hortonworks][Hardy] (80) Syntax or semantic analysis error thrown in server while execurint query. Error message from server: Error while compiling statement: FAILED: ParseException line 1:14 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' (80) (SQLExecDirectW)\")\r\n\r\n('HY000', \"[HY000] [Hortonworks][Hardy] (80) Syntax or semantic analysis error thrown in server while execurint query. Error message from server: Error while compiling statement: FAILED: ParseException line 1:14 cannot recognize input near '<EOF>' '<EOF>' '<EOF>' (80) (SQLExecDirectW)\")\r\n>>>  \r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/661", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/661/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/661/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/661/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/661", "id": 540766831, "node_id": "MDU6SXNzdWU1NDA3NjY4MzE=", "number": 661, "title": "No matching distribution found for pyobdc==virtuoso-2.1.9-beta1", "user": {"login": "donttal", "id": 30567352, "node_id": "MDQ6VXNlcjMwNTY3MzUy", "avatar_url": "https://avatars1.githubusercontent.com/u/30567352?v=4", "gravatar_id": "", "url": "https://api.github.com/users/donttal", "html_url": "https://github.com/donttal", "followers_url": "https://api.github.com/users/donttal/followers", "following_url": "https://api.github.com/users/donttal/following{/other_user}", "gists_url": "https://api.github.com/users/donttal/gists{/gist_id}", "starred_url": "https://api.github.com/users/donttal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/donttal/subscriptions", "organizations_url": "https://api.github.com/users/donttal/orgs", "repos_url": "https://api.github.com/users/donttal/repos", "events_url": "https://api.github.com/users/donttal/events{/privacy}", "received_events_url": "https://api.github.com/users/donttal/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-20T05:18:22Z", "updated_at": "2019-12-21T18:05:42Z", "closed_at": "2019-12-21T18:05:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "when I want to install virtuoso using pip\r\nthe Error is appear\uff1a\r\n`Collecting pyodbc==virtuoso-2.1.9-beta14 (from virtuoso)\r\n  Could not find a version that satisfies the requirement pyodbc==virtuoso-2.1.9-beta14 (from virtuoso) (from versions: 2.1.1, 2.1.2, 2.1.3, 2.1.4, 2.1.5, 2.1.6, 2.1.7, 2.1.8, 2.1.9, 2.1.10, 2.1.11, 3.0.3, 3.0.6, 3.0.7, 3.0.8, 3.0.9, 3.0.10, 3.1.1, 4.0.1, 4.0.2, 4.0.3, 4.0.5, 4.0.6, 4.0.7, 4.0.8, 4.0.9, 4.0.10, 4.0.11, 4.0.12, 4.0.13, 4.0.14, 4.0.15, 4.0.16, 4.0.17, 4.0.18, 4.0.19, 4.0.20, 4.0.21, 4.0.22, 4.0.23, 4.0.24, 4.0.25, 4.0.26, 4.0.27)\r\nNo matching distribution found for pyodbc==virtuoso-2.1.9-beta14 (from virtuoso)\r\n`\r\nThen pip install pyobdc==virtuoso-2.1.9-beta14\r\n\r\n**ERROR: Could not find a version that satisfies the requirement pyobdc==virtuoso-2.1.9-beta14 (from versions: none)**\r\n\r\nhow can I get this requirement version\uff1f\uff1f\uff1fOr other  method ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/660", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/660/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/660/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/660/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/660", "id": 538528208, "node_id": "MDU6SXNzdWU1Mzg1MjgyMDg=", "number": 660, "title": "4.0.28 Release Request", "user": {"login": "gordthompson", "id": 15894006, "node_id": "MDQ6VXNlcjE1ODk0MDA2", "avatar_url": "https://avatars0.githubusercontent.com/u/15894006?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gordthompson", "html_url": "https://github.com/gordthompson", "followers_url": "https://api.github.com/users/gordthompson/followers", "following_url": "https://api.github.com/users/gordthompson/following{/other_user}", "gists_url": "https://api.github.com/users/gordthompson/gists{/gist_id}", "starred_url": "https://api.github.com/users/gordthompson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gordthompson/subscriptions", "organizations_url": "https://api.github.com/users/gordthompson/orgs", "repos_url": "https://api.github.com/users/gordthompson/repos", "events_url": "https://api.github.com/users/gordthompson/events{/privacy}", "received_events_url": "https://api.github.com/users/gordthompson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-12-16T16:46:00Z", "updated_at": "2020-01-03T09:23:48Z", "closed_at": "2019-12-23T14:43:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "@mkleehammer - Please consider a 4.0.28 \"holiday release\" to provide Python 3.8 wheels (#638) and the fix for #596.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/658", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/658/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/658/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/658/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/658", "id": 537895140, "node_id": "MDU6SXNzdWU1Mzc4OTUxNDA=", "number": 658, "title": "Cannot insert datetime.date object into Sql Server", "user": {"login": "FrankMillman", "id": 8579001, "node_id": "MDQ6VXNlcjg1NzkwMDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/8579001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FrankMillman", "html_url": "https://github.com/FrankMillman", "followers_url": "https://api.github.com/users/FrankMillman/followers", "following_url": "https://api.github.com/users/FrankMillman/following{/other_user}", "gists_url": "https://api.github.com/users/FrankMillman/gists{/gist_id}", "starred_url": "https://api.github.com/users/FrankMillman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FrankMillman/subscriptions", "organizations_url": "https://api.github.com/users/FrankMillman/orgs", "repos_url": "https://api.github.com/users/FrankMillman/repos", "events_url": "https://api.github.com/users/FrankMillman/events{/privacy}", "received_events_url": "https://api.github.com/users/FrankMillman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-14T10:13:29Z", "updated_at": "2019-12-16T06:57:08Z", "closed_at": "2019-12-16T06:57:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "Python: 3.7.2\r\npyodbc: 4.0.27\r\nOS: Windows10 64 bit\r\nDB: Sql Server\r\nDriver: I installed ODBC Driver 17 for SQL Server - don't know how to check if it is using it\r\nConnection string: driver='sql server', server=r'localhost\\sqlexpress', database={db}, uid={uid}, pwd={pwd}, trusted_connection=True\r\n\r\nAs abbreviations in the following, dt refers to a python datetime.date object, dtm refers to a python datetime.datetime object.\r\n\r\nIf I create a column of type DATE and insert a dt, I get this error -\r\n\r\npyodbc.Error: ('HYC00', '[HYC00] [Microsoft][ODBC SQL Server Driver]Optional feature not implemented (0) (SQLBindParameter)')\r\n\r\nIf I create a column of type DATE and insert a dtm, it accepts it, but when I retrieve it I get a string 'yyyy-mm-dd'.\r\n\r\nIf I create a column of type DATETIME and insert a dt, I get the same error as above.\r\n\r\nIf I create a column of type DATETIME and insert a dtm, it accepts it and returns a dtm.\r\n\r\nIdeally I would like to create a column of type DATE, insert a dt, and get back a dt.\r\n\r\nAm I doing something wrong?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/655", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/655/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/655/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/655/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/655", "id": 530038656, "node_id": "MDU6SXNzdWU1MzAwMzg2NTY=", "number": 655, "title": "how to use subprocess.Popen with pyodbc?", "user": {"login": "ericwang321", "id": 25045112, "node_id": "MDQ6VXNlcjI1MDQ1MTEy", "avatar_url": "https://avatars0.githubusercontent.com/u/25045112?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ericwang321", "html_url": "https://github.com/ericwang321", "followers_url": "https://api.github.com/users/ericwang321/followers", "following_url": "https://api.github.com/users/ericwang321/following{/other_user}", "gists_url": "https://api.github.com/users/ericwang321/gists{/gist_id}", "starred_url": "https://api.github.com/users/ericwang321/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ericwang321/subscriptions", "organizations_url": "https://api.github.com/users/ericwang321/orgs", "repos_url": "https://api.github.com/users/ericwang321/repos", "events_url": "https://api.github.com/users/ericwang321/events{/privacy}", "received_events_url": "https://api.github.com/users/ericwang321/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-28T18:17:53Z", "updated_at": "2019-12-03T07:49:45Z", "closed_at": "2019-11-29T04:54:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "**1. Environment:**\r\n    Python: Python 3.6.8\r\n    pyodbc: pip3 install pyodbc #pyodbc-4.0.27\r\n    OS: ubuntu 18.04 64bit\r\n    DB:windows server 2012 R2 MSSQL 2012\r\n    driver:Driver=/opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1\r\n\r\n**2. Issue**\r\np3.py\r\n```python \r\nimport pyodbc \r\nimport random\r\nimport os\r\nimport subprocess\r\n\r\nlist1 = [\r\n    ('2019-10-14 10:48:45',3,'n12','/home/toor/1_192.168.1.2_191013104845_33.jpg'),\r\n    ('2019-10-14 10:48:45',3,'n12','/home/toor/1_192.168.1.2_191013104845_33.jpg'),\r\n    ('2019-10-14 10:48:45',3,'n12','/home/toor/1_192.168.1.2_191013104845_33.jpg'),\r\n    ]\r\ndef uploaddb(list1):\r\n  conn = pyodbc.connect('Driver={ODBC Driver 17 for SQL Server};'\r\n                    'Server=192.168.1.10;'\r\n                    'Database=tms;'\r\n                     'Trusted_Connection=no;'\r\n\t\t     'UID=tmsdb;'\r\n\t\t     'PWD=123')\r\n  cursor = conn.cursor()\r\n  sqlconn = \"INSERT into tmsdb.dbo.ip2(time,cnt,ip,path) VALUES(? ,? ,? ,?)\"\r\n  number = cursor.executemany(sqlconn,list1)\r\n  conn.commit()\r\n\r\nif __name__ == \"__main__\":\r\n  subprocess.Popen(uploaddb(list1))\r\n```\r\n\r\nwhen run python3 p3.py,the following error is displayed\r\n**_TypeError: 'NoneType' object is not iterable_**\r\n\r\nhow deal with it?\r\nThanks for any suggestion.\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/654", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/654/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/654/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/654/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/654", "id": 529985308, "node_id": "MDU6SXNzdWU1Mjk5ODUzMDg=", "number": 654, "title": "libodbc.so.2: cannot open shared object file: No such file or directory (in aws lambda)", "user": {"login": "almahmudshahjahan", "id": 58303645, "node_id": "MDQ6VXNlcjU4MzAzNjQ1", "avatar_url": "https://avatars1.githubusercontent.com/u/58303645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/almahmudshahjahan", "html_url": "https://github.com/almahmudshahjahan", "followers_url": "https://api.github.com/users/almahmudshahjahan/followers", "following_url": "https://api.github.com/users/almahmudshahjahan/following{/other_user}", "gists_url": "https://api.github.com/users/almahmudshahjahan/gists{/gist_id}", "starred_url": "https://api.github.com/users/almahmudshahjahan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/almahmudshahjahan/subscriptions", "organizations_url": "https://api.github.com/users/almahmudshahjahan/orgs", "repos_url": "https://api.github.com/users/almahmudshahjahan/repos", "events_url": "https://api.github.com/users/almahmudshahjahan/events{/privacy}", "received_events_url": "https://api.github.com/users/almahmudshahjahan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-11-28T15:51:08Z", "updated_at": "2019-12-05T21:16:12Z", "closed_at": "2019-12-05T21:16:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.6\r\n- pyodbc: 4.0.27\r\n- OS: unix\r\n- DB: ms sql server on aws rds\r\n- driver:\r\n\r\n### Issue\r\n\r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n\r\nLambda is unable to import main module using pyodbc after successful circle ci package deploy using pip and venv", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/653", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/653/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/653/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/653/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/653", "id": 529740902, "node_id": "MDU6SXNzdWU1Mjk3NDA5MDI=", "number": 653, "title": "how to insert python line to mssql ?", "user": {"login": "ericwang321", "id": 25045112, "node_id": "MDQ6VXNlcjI1MDQ1MTEy", "avatar_url": "https://avatars0.githubusercontent.com/u/25045112?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ericwang321", "html_url": "https://github.com/ericwang321", "followers_url": "https://api.github.com/users/ericwang321/followers", "following_url": "https://api.github.com/users/ericwang321/following{/other_user}", "gists_url": "https://api.github.com/users/ericwang321/gists{/gist_id}", "starred_url": "https://api.github.com/users/ericwang321/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ericwang321/subscriptions", "organizations_url": "https://api.github.com/users/ericwang321/orgs", "repos_url": "https://api.github.com/users/ericwang321/repos", "events_url": "https://api.github.com/users/ericwang321/events{/privacy}", "received_events_url": "https://api.github.com/users/ericwang321/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-11-28T07:32:59Z", "updated_at": "2019-11-28T18:18:47Z", "closed_at": "2019-11-28T13:44:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "**1. Environment:**\r\n\r\n- Python: Python 3.6.8 \r\n- pyodbc: pip3 install pyodbc   #pyodbc-4.0.27 \r\n- OS: ubuntu 18.04 64bit\r\n- DB:windows server 2012 R2 MSSQL 2012\r\n- driver:Driver=/opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.4.so.2.1\r\n\r\n**2. Issue**\r\n  p3.py\r\n```python\r\nimport pyodbc \r\n\r\nlist1 = ['2019-10-14 10:48:45,3,n12,/home/toor/1_192.168.1.2_191013104845_33.jpg',\r\n'2019-10-14 10:48:45,3,n12,/home/toor/1_192.168.1.2_191013104845_33.jpg',\r\n'2019-10-14 10:48:45,3,n12,/home/toor/1_192.168.1.2_191013104845_33.jpg']\r\n\r\nconn = pyodbc.connect('Driver={ODBC Driver 17 for SQL Server};'\r\n                    'Server=192.168.1.10;'\r\n                    'Database=tms;'\r\n                    'Trusted_Connection=no;'\r\n\t\t     'UID=tmsdb;'\r\n\t\t      'PWD=123')\r\ncursor = conn1.cursor()\r\nsqlconn = \"Insert into tmsdb.dbo.ip2(time,cnt,ip,path) VALUES(? ,? ,? ,?)\"\r\nnumber = cursor.executemany(sqlconn,list1)\r\nconn.commit()\r\n```\r\nwhen run python3 p3.py,the following error is displayed\r\n> Traceback (most recent call last):\r\n>   File \"p3.py\", line 29, in <module>\r\n>     number = cursor.executemany(sqlconn,list1)\r\n> TypeError: ('**_Params must be in a list, tuple, or Row', 'HY000'_**\r\n\r\n\r\nGoogle multiple documents, changes many times, still gives an error,how deal with it?\r\nThanks for any suggestion.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/644", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/644/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/644/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/644/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/644", "id": 517414884, "node_id": "MDU6SXNzdWU1MTc0MTQ4ODQ=", "number": 644, "title": "Installing on Dockers' Python 3.7 container fails", "user": {"login": "Carelvd", "id": 322018, "node_id": "MDQ6VXNlcjMyMjAxOA==", "avatar_url": "https://avatars3.githubusercontent.com/u/322018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Carelvd", "html_url": "https://github.com/Carelvd", "followers_url": "https://api.github.com/users/Carelvd/followers", "following_url": "https://api.github.com/users/Carelvd/following{/other_user}", "gists_url": "https://api.github.com/users/Carelvd/gists{/gist_id}", "starred_url": "https://api.github.com/users/Carelvd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Carelvd/subscriptions", "organizations_url": "https://api.github.com/users/Carelvd/orgs", "repos_url": "https://api.github.com/users/Carelvd/repos", "events_url": "https://api.github.com/users/Carelvd/events{/privacy}", "received_events_url": "https://api.github.com/users/Carelvd/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-11-04T21:29:31Z", "updated_at": "2019-11-13T00:09:08Z", "closed_at": "2019-11-13T00:09:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\nI have tried to go through the available Issues and Stack Overflow Questions but have not had any luck with an answer\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7\r\n- pyodbc: 4.0.27\r\n- OS: Python 3.7:latest docker container\r\n- DB: Microsoft SQL (Also in the mcr.microsoft.com/server/mssql:ubuntu container; not sure this is relevant though)\r\n- driver: Not Sure\r\n\r\n### Issue\r\n\r\nI was trying to pull down the PyODBC package while setting up a flask environment. I was hoping the package would install correctly but it fails with the following error message. I was hoping to be more helpful in this message but I'm not familiar with any of the components reported in the error.\r\n\r\n    ERROR: Command errored out with exit status 1:\r\n     command: /usr/local/bin/python -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/tmp/pip-install-af6iayzo/pyodbc/setup.py'\"'\"'; __file__='\"'\"'/tmp/pip-install-af6iayzo/pyodbc/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /tmp/pip-record-zdwz9cwb/install-record.txt --single-version-externally-managed --compile\r\n         cwd: /tmp/pip-install-af6iayzo/pyodbc/\r\n    Complete output (14 lines):\r\n    running install\r\n    running build\r\n    running build_ext\r\n    building 'pyodbc' extension\r\n    creating build\r\n    creating build/temp.linux-x86_64-3.7\r\n    creating build/temp.linux-x86_64-3.7/src\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -DPYODBC_VERSION=4.0.27 -I/usr/local/include/python3.7m -c src/buffer.cpp -o build/temp.linux-x86_64-3.7/src/buffer.o -Wno-write-strings\r\n    In file included from src/buffer.cpp:12:\r\n    src/pyodbc.h:56:10: fatal error: sql.h: No such file or directory\r\n     #include <sql.h>\r\n              ^~~~~~~\r\n    compilation terminated.\r\n    error: command 'gcc' failed with exit status 1\r\n    ----------------------------------------\r\n    ERROR: Command errored out with exit status 1: /usr/local/bin/python -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/tmp/pip-install-af6iayzo/pyodbc/setup.py'\"'\"'; __file__='\"'\"'/tmp/pip-install-af6iayzo/pyodbc/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /tmp/pip-record-zdwz9cwb/install-record.txt --single-version-externally-managed --compile Check the logs for full command output.\r\n\r\nIt seems that the `sql.h` file is missing, this probably this is due to me installing the package in a  container and the environment not having all of necessary the header files, \r\n\r\nIt seems that one should use the prebuilt binaries by Christophe Gholke as per issue #386. Issue #165 appears related.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/639", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/639/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/639/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/639/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/639", "id": 514587055, "node_id": "MDU6SXNzdWU1MTQ1ODcwNTU=", "number": 639, "title": "When I am installing pyodbc using command propmpt for sql server it returns following error.", "user": {"login": "niranjan0k", "id": 57178253, "node_id": "MDQ6VXNlcjU3MTc4MjUz", "avatar_url": "https://avatars3.githubusercontent.com/u/57178253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/niranjan0k", "html_url": "https://github.com/niranjan0k", "followers_url": "https://api.github.com/users/niranjan0k/followers", "following_url": "https://api.github.com/users/niranjan0k/following{/other_user}", "gists_url": "https://api.github.com/users/niranjan0k/gists{/gist_id}", "starred_url": "https://api.github.com/users/niranjan0k/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/niranjan0k/subscriptions", "organizations_url": "https://api.github.com/users/niranjan0k/orgs", "repos_url": "https://api.github.com/users/niranjan0k/repos", "events_url": "https://api.github.com/users/niranjan0k/events{/privacy}", "received_events_url": "https://api.github.com/users/niranjan0k/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-10-30T11:21:19Z", "updated_at": "2020-01-15T05:50:36Z", "closed_at": "2020-01-15T05:50:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying to install pyodbc using pip I get this error:\r\n\r\n    ERROR: Command errored out with exit status 1:\r\n     command: 'c:\\users\\pc1\\appdata\\local\\programs\\python\\python38\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\pc1\\\\AppData\\\\Local\\\\Temp\\\\pip-install-oll6gnwp\\\\pyodbc\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\pc1\\\\AppData\\\\Local\\\\Temp\\\\pip-install-oll6gnwp\\\\pyodbc\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\pc1\\AppData\\Local\\Temp\\pip-record-_plp0xxd\\install-record.txt' --single-version-externally-managed --compile\r\n         cwd: C:\\Users\\pc1\\AppData\\Local\\Temp\\pip-install-oll6gnwp\\pyodbc\\\r\n    Complete output (12 lines):\r\n    running install\r\n    running build\r\n    running build_ext\r\n    building 'pyodbc' extension\r\n    creating build\r\n    creating build\\temp.win-amd64-3.8\r\n    creating build\\temp.win-amd64-3.8\\Release\r\n    creating build\\temp.win-amd64-3.8\\Release\\src\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Enterprise\\VC\\Tools\\MSVC\\14.23.28105\\bin\\HostX86\\x64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\users\\pc1\\appdata\\local\\programs\\python\\python38\\include -Ic:\\users\\pc1\\appdata\\local\\programs\\python\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Enterprise\\VC\\Tools\\MSVC\\14.23.28105\\include\" \"-IC:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.8\\include\\um\" /EHsc /Tpsrc\\buffer.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\buffer.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    buffer.cpp\r\n    C:\\Users\\pc1\\AppData\\Local\\Temp\\pip-install-oll6gnwp\\pyodbc\\src\\pyodbc.h(19): fatal error C1083: Cannot open include file: 'windows.h': No such file or directory\r\n    error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2019\\\\Enterprise\\\\VC\\\\Tools\\\\MSVC\\\\14.23.28105\\\\bin\\\\HostX86\\\\x64\\\\cl.exe' failed with exit status 2\r\n    ----------------------------------------\r\nERROR: Command errored out with exit status 1: 'c:\\users\\pc1\\appdata\\local\\programs\\python\\python38\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\pc1\\\\AppData\\\\Local\\\\Temp\\\\pip-install-oll6gnwp\\\\pyodbc\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\pc1\\\\AppData\\\\Local\\\\Temp\\\\pip-install-oll6gnwp\\\\pyodbc\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\pc1\\AppData\\Local\\Temp\\pip-record-_plp0xxd\\install-record.txt' --single-version-externally-managed --compile Check the logs for full command output.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/638", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/638/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/638/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/638/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/638", "id": 512715080, "node_id": "MDU6SXNzdWU1MTI3MTUwODA=", "number": 638, "title": "cannot install on windows 10 python 3.8 x64 ", "user": {"login": "CRCGlobal", "id": 45767346, "node_id": "MDQ6VXNlcjQ1NzY3MzQ2", "avatar_url": "https://avatars0.githubusercontent.com/u/45767346?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CRCGlobal", "html_url": "https://github.com/CRCGlobal", "followers_url": "https://api.github.com/users/CRCGlobal/followers", "following_url": "https://api.github.com/users/CRCGlobal/following{/other_user}", "gists_url": "https://api.github.com/users/CRCGlobal/gists{/gist_id}", "starred_url": "https://api.github.com/users/CRCGlobal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CRCGlobal/subscriptions", "organizations_url": "https://api.github.com/users/CRCGlobal/orgs", "repos_url": "https://api.github.com/users/CRCGlobal/repos", "events_url": "https://api.github.com/users/CRCGlobal/events{/privacy}", "received_events_url": "https://api.github.com/users/CRCGlobal/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2019-10-25T20:50:30Z", "updated_at": "2019-12-26T21:40:15Z", "closed_at": "2019-12-26T21:40:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "C:\\Python38>pip install pyodbc\r\nCollecting pyodbc\r\n  Using cached https://files.pythonhosted.org/packages/75/29/aa190749bac37ede0f11a68a75e7055254699c11572bd94213f1163dfd8f/pyodbc-4.0.27.tar.gz\r\nInstalling collected packages: pyodbc\r\n    Running setup.py install for pyodbc ... error\r\n    ERROR: Command errored out with exit status 1:\r\n     command: 'c:\\python38\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\taskrunner\\\\AppData\\\\Local\\\\Temp\\\\pip-install-4vqdclpn\\\\pyodbc\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\taskrunner\\\\AppData\\\\Local\\\\Temp\\\\pip-install-4vqdclpn\\\\pyodbc\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\taskrunner\\AppData\\Local\\Temp\\pip-record-wcc3z0yx\\install-record.txt' --single-version-externally-managed --compile\r\n         cwd: C:\\Users\\taskrunner\\AppData\\Local\\Temp\\pip-install-4vqdclpn\\pyodbc\\\r\n    Complete output (99 lines):\r\n    running install\r\n    running build\r\n    running build_ext\r\n    building 'pyodbc' extension\r\n    creating build\r\n    creating build\\temp.win-amd64-3.8\r\n    creating build\\temp.win-amd64-3.8\\Release\r\n    creating build\\temp.win-amd64-3.8\\Release\\src\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\buffer.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\buffer.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    buffer.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\cnxninfo.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\cnxninfo.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    cnxninfo.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\connection.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\connection.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    connection.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    src\\connection.cpp(145): warning C4312: 'type cast': conversion from 'unsigned long' to 'SQLPOINTER' of greater size\r\n    src\\connection.cpp(149): warning C4312: 'type cast': conversion from 'long' to 'SQLPOINTER' of greater size\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\cursor.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\cursor.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    cursor.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\errors.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\errors.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    errors.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    src\\errors.cpp(295): warning C4365: 'argument': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    src\\errors.cpp(331): warning C4996: 'PyUnicode_GetSize': deprecated in 3.3\r\n    c:\\python38\\include\\unicodeobject.h(177): note: see declaration of 'PyUnicode_GetSize'\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\getdata.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\getdata.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    getdata.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\params.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\params.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    params.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    src\\params.cpp(86): warning C4365: '=': conversion from 'SQLULEN' to 'SQLLEN', signed/unsigned mismatch\r\n    src\\params.cpp(94): warning C4365: '=': conversion from 'SQLULEN' to 'SQLLEN', signed/unsigned mismatch\r\n    src\\params.cpp(127): warning C4365: '=': conversion from 'SQLULEN' to 'SQLLEN', signed/unsigned mismatch\r\n    src\\params.cpp(274): warning C4365: '=': conversion from 'SQLCHAR' to 'SQLSCHAR', signed/unsigned mismatch\r\n    src\\params.cpp(275): warning C4365: '=': conversion from 'bool' to 'SQLCHAR', signed/unsigned mismatch\r\n    src\\params.cpp(316): warning C4365: 'argument': conversion from 'Py_ssize_t' to 'std::size_t', signed/unsigned mismatch\r\n    src\\params.cpp(362): warning C4365: 'argument': conversion from 'Py_ssize_t' to 'std::size_t', signed/unsigned mismatch\r\n    src\\params.cpp(387): warning C4365: 'argument': conversion from 'Py_ssize_t' to 'std::size_t', signed/unsigned mismatch\r\n    src\\params.cpp(407): warning C4365: 'initializing': conversion from 'int' to 'SQLUINTEGER', signed/unsigned mismatch\r\n    src\\params.cpp(435): warning C4365: '=': conversion from 'int' to 'SQLUINTEGER', signed/unsigned mismatch\r\n    src\\params.cpp(473): warning C4365: 'argument': conversion from 'Py_ssize_t' to 'std::size_t', signed/unsigned mismatch\r\n    src\\params.cpp(538): warning C4365: '=': conversion from 'bool' to 'SQLCHAR', signed/unsigned mismatch\r\n    src\\params.cpp(556): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'long', possible loss of data\r\n    src\\params.cpp(571): warning C4365: '=': conversion from 'SQLCHAR' to 'SQLSCHAR', signed/unsigned mismatch\r\n    src\\params.cpp(1183): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLINTEGER', possible loss of data\r\n    src\\params.cpp(1183): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLSMALLINT', possible loss of data\r\n    src\\params.cpp(1193): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLUSMALLINT', possible loss of data\r\n    src\\params.cpp(1193): warning C4365: 'argument': conversion from 'Py_ssize_t' to 'SQLUSMALLINT', signed/unsigned mismatch\r\n    src\\params.cpp(1200): warning C4365: '=': conversion from 'Py_ssize_t' to 'SQLULEN', signed/unsigned mismatch\r\n    src\\params.cpp(1420): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLSMALLINT', possible loss of data\r\n    src\\params.cpp(1430): warning C4365: 'initializing': conversion from 'SQLULEN' to 'Py_ssize_t', signed/unsigned mismatch\r\n    src\\params.cpp(1458): warning C4365: 'argument': conversion from 'SQLULEN' to 'Py_ssize_t', signed/unsigned mismatch\r\n    src\\params.cpp(1696): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLUSMALLINT', possible loss of data\r\n    src\\params.cpp(1696): warning C4365: 'argument': conversion from 'Py_ssize_t' to 'SQLUSMALLINT', signed/unsigned mismatch\r\n    src\\params.cpp(1760): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLUSMALLINT', possible loss of data\r\n    src\\params.cpp(1760): warning C4365: 'argument': conversion from 'Py_ssize_t' to 'SQLUSMALLINT', signed/unsigned mismatch\r\n    src\\params.cpp(1771): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLSMALLINT', possible loss of data\r\n    src\\params.cpp(1772): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLSMALLINT', possible loss of data\r\n    src\\params.cpp(1773): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLSMALLINT', possible loss of data\r\n    src\\params.cpp(1774): warning C4244: 'argument': conversion from 'Py_ssize_t' to 'SQLSMALLINT', possible loss of data\r\n    src\\params.cpp(1783): warning C4365: 'argument': conversion from 'Py_ssize_t' to 'std::size_t', signed/unsigned mismatch\r\n    src\\params.cpp(1918): warning C4244: 'initializing': conversion from 'Py_ssize_t' to 'int', possible loss of data\r\n    src\\params.cpp(1926): warning C4996: 'PyUnicode_EncodeUTF8': deprecated in 3.3\r\n    c:\\python38\\include\\cpython/unicodeobject.h(821): note: see declaration of 'PyUnicode_EncodeUTF8'\r\n    src\\params.cpp(1929): warning C4996: 'PyUnicode_EncodeUTF16': deprecated in 3.3\r\n    c:\\python38\\include\\cpython/unicodeobject.h(863): note: see declaration of 'PyUnicode_EncodeUTF16'\r\n    src\\params.cpp(1932): warning C4996: 'PyUnicode_EncodeUTF16': deprecated in 3.3\r\n    c:\\python38\\include\\cpython/unicodeobject.h(863): note: see declaration of 'PyUnicode_EncodeUTF16'\r\n    src\\params.cpp(1935): warning C4996: 'PyUnicode_EncodeUTF16': deprecated in 3.3\r\n    c:\\python38\\include\\cpython/unicodeobject.h(863): note: see declaration of 'PyUnicode_EncodeUTF16'\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\pyodbccompat.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\pyodbccompat.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    pyodbccompat.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\pyodbcdbg.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\pyodbcdbg.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    pyodbcdbg.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\pyodbcmodule.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\pyodbcmodule.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    pyodbcmodule.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\row.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\row.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    row.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -DPYODBC_VERSION=4.0.27 -Ic:\\python38\\include -Ic:\\python38\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\INCLUDE\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.18362.0\\winrt\" /EHsc /Tpsrc\\textenc.cpp /Fobuild\\temp.win-amd64-3.8\\Release\\src\\textenc.obj /Wall /wd4514 /wd4820 /wd4668 /wd4711 /wd4100 /wd4127 /wd4191\r\n    textenc.cpp\r\n    c:\\python38\\include\\cpython/abstract.h(77): warning C4365: 'return': conversion from 'std::size_t' to 'Py_ssize_t', signed/unsigned mismatch\r\n    creating C:\\Users\\taskrunner\\AppData\\Local\\Temp\\pip-install-4vqdclpn\\pyodbc\\build\\lib.win-amd64-3.8\r\n    C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\link.exe /nologo /INCREMENTAL:NO /LTCG /DLL /MANIFEST:EMBED,ID=2 /MANIFESTUAC:NO /LIBPATH:/usr/lib:/usr/local/lib /LIBPATH:c:\\python38\\libs /LIBPATH:c:\\python38\\PCbuild\\amd64 \"/LIBPATH:C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\LIB\\amd64\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.18362.0\\ucrt\\x64\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.18362.0\\um\\x64\" odbc32.lib advapi32.lib /EXPORT:PyInit_pyodbc build\\temp.win-amd64-3.8\\Release\\src\\buffer.obj build\\temp.win-amd64-3.8\\Release\\src\\cnxninfo.obj build\\temp.win-amd64-3.8\\Release\\src\\connection.obj build\\temp.win-amd64-3.8\\Release\\src\\cursor.obj build\\temp.win-amd64-3.8\\Release\\src\\errors.obj build\\temp.win-amd64-3.8\\Release\\src\\getdata.obj build\\temp.win-amd64-3.8\\Release\\src\\params.obj build\\temp.win-amd64-3.8\\Release\\src\\pyodbccompat.obj build\\temp.win-amd64-3.8\\Release\\src\\pyodbcdbg.obj build\\temp.win-amd64-3.8\\Release\\src\\pyodbcmodule.obj build\\temp.win-amd64-3.8\\Release\\src\\row.obj build\\temp.win-amd64-3.8\\Release\\src\\textenc.obj /OUT:build\\lib.win-amd64-3.8\\pyodbc.cp38-win_amd64.pyd /IMPLIB:build\\temp.win-amd64-3.8\\Release\\src\\pyodbc.cp38-win_amd64.lib\r\n    pyodbcmodule.obj : warning LNK4197: export 'PyInit_pyodbc' specified multiple times; using first specification\r\n       Creating library build\\temp.win-amd64-3.8\\Release\\src\\pyodbc.cp38-win_amd64.lib and object build\\temp.win-amd64-3.8\\Release\\src\\pyodbc.cp38-win_amd64.exp\r\n    Generating code\r\n    c:\\users\\taskrunner\\appdata\\local\\temp\\pip-install-4vqdclpn\\pyodbc\\src\\params.cpp(1683) : warning C4706: assignment within conditional expression\r\n    c:\\users\\taskrunner\\appdata\\local\\temp\\pip-install-4vqdclpn\\pyodbc\\src\\params.cpp(1783) : warning C4706: assignment within conditional expression\r\n    Finished generating code\r\n    LINK : fatal error LNK1158: cannot run 'rc.exe'\r\n    error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 14.0\\\\VC\\\\BIN\\\\x86_amd64\\\\link.exe' failed with exit status 1158\r\n    ----------------------------------------\r\nERROR: Command errored out with exit status 1: 'c:\\python38\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'C:\\\\Users\\\\taskrunner\\\\AppData\\\\Local\\\\Temp\\\\pip-install-4vqdclpn\\\\pyodbc\\\\setup.py'\"'\"'; __file__='\"'\"'C:\\\\Users\\\\taskrunner\\\\AppData\\\\Local\\\\Temp\\\\pip-install-4vqdclpn\\\\pyodbc\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'C:\\Users\\taskrunner\\AppData\\Local\\Temp\\pip-record-wcc3z0yx\\install-record.txt' --single-version-externally-managed --compile Check the logs for full command output.\r\n\r\nC:\\Python38>\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/633", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/633/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/633/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/633/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/633", "id": 504998342, "node_id": "MDU6SXNzdWU1MDQ5OTgzNDI=", "number": 633, "title": "Python3 with FileMaker data using pyodbc not giving actual unicode value [French and Hungary character]", "user": {"login": "biswajithgopinathan", "id": 33252276, "node_id": "MDQ6VXNlcjMzMjUyMjc2", "avatar_url": "https://avatars3.githubusercontent.com/u/33252276?v=4", "gravatar_id": "", "url": "https://api.github.com/users/biswajithgopinathan", "html_url": "https://github.com/biswajithgopinathan", "followers_url": "https://api.github.com/users/biswajithgopinathan/followers", "following_url": "https://api.github.com/users/biswajithgopinathan/following{/other_user}", "gists_url": "https://api.github.com/users/biswajithgopinathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/biswajithgopinathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/biswajithgopinathan/subscriptions", "organizations_url": "https://api.github.com/users/biswajithgopinathan/orgs", "repos_url": "https://api.github.com/users/biswajithgopinathan/repos", "events_url": "https://api.github.com/users/biswajithgopinathan/events{/privacy}", "received_events_url": "https://api.github.com/users/biswajithgopinathan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 27, "created_at": "2019-10-10T02:43:09Z", "updated_at": "2019-10-21T08:10:41Z", "closed_at": "2019-10-21T08:10:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: Python 3.7\r\n- pyodbc: 4.0.27\r\n- OS: Mac\r\n- DB: FileMaker\r\n- driver: FileMaker ODBC\r\n\r\n### Issue\r\n\r\nI am using Python3 to connect with FileMaker Database. The result actually I need to get from Database is \"Pontificia Universidad Cat\u00f3lica del Per\u00fa\". But using pyodbc with unicode encoding UTF-8 is some thing like this \r\n![gXrqx](https://user-images.githubusercontent.com/33252276/66534953-386e3580-eb18-11e9-80f4-09e4f8df9937.png)\r\n. Once I tried to pass this value to html the unicode value is printing as space. I tried to encode my dbconnection object with 'UTF-8', 'LATIN1', 'iso-8859-1'. Still the result is same. Without this I am stuck for few days to continue my work. Please help to get actual value from FileMAker DB.Please help\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/630", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/630/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/630/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/630/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/630", "id": 502343773, "node_id": "MDU6SXNzdWU1MDIzNDM3NzM=", "number": 630, "title": "Emoji insert to MySQL works with parameter but fails with dynamic SQL", "user": {"login": "gordthompson", "id": 15894006, "node_id": "MDQ6VXNlcjE1ODk0MDA2", "avatar_url": "https://avatars0.githubusercontent.com/u/15894006?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gordthompson", "html_url": "https://github.com/gordthompson", "followers_url": "https://api.github.com/users/gordthompson/followers", "following_url": "https://api.github.com/users/gordthompson/following{/other_user}", "gists_url": "https://api.github.com/users/gordthompson/gists{/gist_id}", "starred_url": "https://api.github.com/users/gordthompson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gordthompson/subscriptions", "organizations_url": "https://api.github.com/users/gordthompson/orgs", "repos_url": "https://api.github.com/users/gordthompson/repos", "events_url": "https://api.github.com/users/gordthompson/events{/privacy}", "received_events_url": "https://api.github.com/users/gordthompson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-03T23:14:33Z", "updated_at": "2019-10-06T23:07:06Z", "closed_at": "2019-10-06T21:11:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Inserting a string containing an emoji into a MySQL varchar column succeeds with a parameterized query but fails if the same value is passed as a string literal (dynamic SQL).\r\n\r\n```python\r\nimport sys\r\n\r\nimport pyodbc\r\n\r\nprint(sys.version)\r\n# 3.7.4 (tags/v3.7.4:e09359112e, Jul  8 2019, 20:34:20) [MSC v.1916 64 bit (AMD64)]\r\nprint(pyodbc.version)\r\n# 4.0.27\r\n\r\nconnection_string = get_connection_string()\r\nprint(connection_string)\r\n# DRIVER=MySQL ODBC 8.0 Unicode Driver;SERVER=192.168.0.131;DATABASE=gord_sqla;charset=utf8mb4;UID=gord;\r\n\r\ncnxn = pyodbc.connect(connection_string, autocommit=True)\r\nprint(f'{cnxn.getinfo(pyodbc.SQL_DRIVER_NAME)}, version: {cnxn.getinfo(pyodbc.SQL_DRIVER_VER)}')\r\n# myodbc8w.dll, version: 08.00.0017\r\n\r\ncnxn.setdecoding(pyodbc.SQL_CHAR, encoding='utf-8')\r\ncnxn.setdecoding(pyodbc.SQL_WCHAR, encoding='utf-8')\r\ncnxn.setencoding(encoding='utf-8')\r\n\r\ncrsr = cnxn.cursor()\r\ncrsr.execute(\"CREATE TABLE IF NOT EXISTS t (x varchar(255))\")\r\n\r\ns = \"r\u00e9ve\ud83d\udc0d ill\u00e9\"\r\n\r\ncrsr.execute(\"TRUNCATE TABLE t\")\r\ncrsr.execute(f\"INSERT INTO t (x) VALUES (?)\", s)\r\nresult = crsr.execute(f\"SELECT x FROM t\").fetchval()\r\nprint(f\"  Parameter - {'(ok)' if result == s else 'FAIL'} - expected: {s} ; actual: {result}\")\r\n#   Parameter - (ok) - expected: r\u00e9ve\ud83d\udc0d ill\u00e9 ; actual: r\u00e9ve\ud83d\udc0d ill\u00e9\r\n\r\ncrsr.execute(\"TRUNCATE TABLE t\")\r\ncrsr.execute(f\"INSERT INTO t (x) VALUES ('{s}')\")\r\nresult = crsr.execute(f\"SELECT x FROM t\").fetchval()\r\nprint(f\"Dynamic SQL - {'(ok)' if result == s else 'FAIL'} - expected: {s} ; actual: {result}\")\r\n# Dynamic SQL - FAIL - expected: r\u00e9ve\ud83d\udc0d ill\u00e9 ; actual: r\u00c3\u00a9ve\u00f0\u0178\u0090\u008d ill\u00c3\u00a9\r\n```\r\n\r\nI checked the server and the value actually inserted is the mojibake one.\r\n\r\nThe ODBC log shows that `SQLExecDirect` is being called.\r\n\r\n```\r\nmain            5f0-1524\tEXIT  SQLExecDirect  with return code 0 (SQL_SUCCESS)\r\n        HSTMT               0x000000ED8E97E950\r\n        UCHAR *             0x000000ED8E952780 [      44] \"INSERT INTO t (x) VALUES ('r\\ff\\ffve\\ff\\ff\\ff\\ff ill\\ff\\ff')\"\r\n        SDWORD                    44\r\n```\r\n\r\nShouldn't pyodbc be calling `SQLExecDirectW`?\r\n\r\n[mysql.log](https://github.com/mkleehammer/pyodbc/files/3688391/mysql.log)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/629", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/629/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/629/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/629/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/629", "id": 500795904, "node_id": "MDU6SXNzdWU1MDA3OTU5MDQ=", "number": 629, "title": "pyodbc.Binary parameter is sent as text", "user": {"login": "sogartar", "id": 3050579, "node_id": "MDQ6VXNlcjMwNTA1Nzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/3050579?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sogartar", "html_url": "https://github.com/sogartar", "followers_url": "https://api.github.com/users/sogartar/followers", "following_url": "https://api.github.com/users/sogartar/following{/other_user}", "gists_url": "https://api.github.com/users/sogartar/gists{/gist_id}", "starred_url": "https://api.github.com/users/sogartar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sogartar/subscriptions", "organizations_url": "https://api.github.com/users/sogartar/orgs", "repos_url": "https://api.github.com/users/sogartar/repos", "events_url": "https://api.github.com/users/sogartar/events{/privacy}", "received_events_url": "https://api.github.com/users/sogartar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-10-01T10:08:22Z", "updated_at": "2019-10-10T21:01:16Z", "closed_at": "2019-10-10T21:01:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n\r\n    - Python: 3.7 64-bit\r\n    - pyodbc: 4.0.27\r\n    - OS: Ubuntu 16.04\r\n    - DB: Postgresql 11\r\n    - driver: PostgreSQL Unicode (psqlODBC)\r\n\r\n\r\n### Issue\r\nI have the following code\r\n```\r\nconnection.cursor().execute(\r\n        \"SELECT * FROM (VALUES (?)) t(col)\",\r\n        [pyodbc.Binary([201])]\r\n        )\r\n```\r\n\r\nExecuting this I get this error\r\n```\r\npyodbc.DataError: ('22021', '[22021] ERROR: invalid byte sequence for encoding \"UTF8\": 0xc9;\\nError while executing the query (1) (SQLExecDirectW)')\r\n```\r\n\r\nIt is expected that the parameter will not be passed as text, so no encoding/decoding should be done at all. I am not sure if this is a problem with pyodbc. How should one pass binary data as a query parameter?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/628", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/628/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/628/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/628/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/628", "id": 500280244, "node_id": "MDU6SXNzdWU1MDAyODAyNDQ=", "number": 628, "title": "UnicodeEncodeError: 'ascii' codec can't encode character u'\\u2013' in position 18: ordinal not in range(128)", "user": {"login": "dbrennand", "id": 52419383, "node_id": "MDQ6VXNlcjUyNDE5Mzgz", "avatar_url": "https://avatars3.githubusercontent.com/u/52419383?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbrennand", "html_url": "https://github.com/dbrennand", "followers_url": "https://api.github.com/users/dbrennand/followers", "following_url": "https://api.github.com/users/dbrennand/following{/other_user}", "gists_url": "https://api.github.com/users/dbrennand/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbrennand/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbrennand/subscriptions", "organizations_url": "https://api.github.com/users/dbrennand/orgs", "repos_url": "https://api.github.com/users/dbrennand/repos", "events_url": "https://api.github.com/users/dbrennand/events{/privacy}", "received_events_url": "https://api.github.com/users/dbrennand/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-09-30T13:32:38Z", "updated_at": "2020-05-20T15:52:20Z", "closed_at": "2019-10-01T07:45:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 2.7.5 and 3.6.8\r\n- pyodbc: 4.0.27\r\n- OS: Red Hat 4.8.5 - CentOS\r\n- DB: SQL Server.\r\n- driver: ODBC Driver 17 for SQL Server\r\n\r\n### Issue\r\nI am receiving the following error:\r\n```UnicodeEncodeError: 'ascii' codec can't encode character u'\\u2013' in position 18: ordinal not in range(128)```\r\n\r\nI have tried:\r\n```\r\ncnxn.setencoding(str, 'utf-8')\r\ncnxn.setencoding(unicode, 'utf-8')\r\n# and\r\ncnxn.setdecoding(pyodbc.SQL_CHAR, encoding='latin1', to=str)\r\ncnxn.setencoding(str, encoding='latin1')\r\n# also\r\ncnxn.setdecoding(pyodbc.SQL_CHAR, encoding='utf-8')\r\ncnxn.setdecoding(pyodbc.SQL_WCHAR, encoding='utf-8')\r\ncnxn.setdecoding(pyodbc.SQL_WMETADATA, encoding='utf-8')\r\ncnxn.setencoding(str, encoding='utf-8')\r\ncnxn.setencoding(unicode, encoding='utf-8')\r\n```\r\n\r\nWith no luck. Any advice on how to proceed?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/627", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/627/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/627/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/627/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/627", "id": 500183741, "node_id": "MDU6SXNzdWU1MDAxODM3NDE=", "number": 627, "title": "lost synchronization with server on query with many parameters", "user": {"login": "sogartar", "id": 3050579, "node_id": "MDQ6VXNlcjMwNTA1Nzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/3050579?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sogartar", "html_url": "https://github.com/sogartar", "followers_url": "https://api.github.com/users/sogartar/followers", "following_url": "https://api.github.com/users/sogartar/following{/other_user}", "gists_url": "https://api.github.com/users/sogartar/gists{/gist_id}", "starred_url": "https://api.github.com/users/sogartar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sogartar/subscriptions", "organizations_url": "https://api.github.com/users/sogartar/orgs", "repos_url": "https://api.github.com/users/sogartar/repos", "events_url": "https://api.github.com/users/sogartar/events{/privacy}", "received_events_url": "https://api.github.com/users/sogartar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-30T10:18:13Z", "updated_at": "2019-10-10T20:46:39Z", "closed_at": "2019-10-10T20:46:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7 64-bit\r\n- pyodbc: 4.0.27\r\n- OS: Ubuntu 16.04\r\n- DB: Postgresql 11\r\n- driver: PostgreSQL Unicode (psqlODBC)\r\n\r\n### Issue\r\n\r\nI have the following query\r\n```\r\nSELECT * FROM (VALUES (?),(?)...) t(val)\r\n```\r\nThen execute with\r\n```\r\ncursor.execute(query, params)\r\n```\r\n\r\nIf the number of query parameters is large ~2^14, this query fails with\r\n```\r\npyodbc.Error: ('HY000', '[HY000] lost synchronization with server: got message type \"t\", length 65542\\n;\\nError while preparing parameters (1) (SQLExecDirectW)')\r\n```\r\n\r\nThe query should complete without errors.\r\n\r\nI tried the same query with psycopg2. There even with 2^24 parameters the query is executed successfully.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/626", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/626/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/626/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/626/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/626", "id": 499409184, "node_id": "MDU6SXNzdWU0OTk0MDkxODQ=", "number": 626, "title": "pyodbc.connect fails with: No message found for message number 2 of module 'Operating System'", "user": {"login": "villekr", "id": 26829960, "node_id": "MDQ6VXNlcjI2ODI5OTYw", "avatar_url": "https://avatars3.githubusercontent.com/u/26829960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/villekr", "html_url": "https://github.com/villekr", "followers_url": "https://api.github.com/users/villekr/followers", "following_url": "https://api.github.com/users/villekr/following{/other_user}", "gists_url": "https://api.github.com/users/villekr/gists{/gist_id}", "starred_url": "https://api.github.com/users/villekr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/villekr/subscriptions", "organizations_url": "https://api.github.com/users/villekr/orgs", "repos_url": "https://api.github.com/users/villekr/repos", "events_url": "https://api.github.com/users/villekr/events{/privacy}", "received_events_url": "https://api.github.com/users/villekr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-27T12:10:50Z", "updated_at": "2019-09-28T14:20:26Z", "closed_at": "2019-09-28T14:20:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.7\r\n- pyodbc: 4.0.27\r\n- OS: Debian GNU/Linux 9 (stretch) in Docker for macOS 2.1.0.0\r\n- DB: Netsuite (Some Oracle flavour?)\r\n- driver: Netsuite ODBC Linux64bit: Release 8.1.0.0089, March 2019\r\n\r\n### Issue\r\n\r\nODBC connection fails with below message.\r\n```\r\nconn_str = DRIVER={NetSuite ODBC Drivers 8.1};Host=odbcserver.eu2.netsuite.com;Port=1708;Encrypted=1;Truststore=/opt/netsuite/odbcclient/cert/ca.cer, /opt/netsuite/odbcclient/cert/ca2.cer, /opt/netsuite/odbcclient/cert/ca3.cer;SDSN=NetSuite.com;UID=***;PWD=***;CustomProperties=AccountID=***;RoleID=***\r\n\r\npyodbc.connect(conn_str, timeout=10),\r\n--> pyodbc.Error  ('HY000', \"[HY000] [NetSuite][ODBC 64 bit driver][64 bit Client]No message found for message number 2 of module 'Operating System'. (0) (SQLDriverConnect)\")\r\n```\r\n\r\nODBC connection has been working with older Netsuite odbc version, where only differences to current configuration were:\r\n- driver: Netsuite ODBC Linux64bit: Release 7.2, Build Number 7.2.0.0050, September 2015\r\n- conn_str = DRIVER={NetSuite ODBC Drivers 7.2};...\r\nI'm trying to update to newer driver to find a fix for another problem where query fails with odbc error.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/624", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/624/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/624/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/624/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/624", "id": 496713047, "node_id": "MDU6SXNzdWU0OTY3MTMwNDc=", "number": 624, "title": "MS Access: \"SELECT ? AS ...\" returns incorrect value for Decimal parameter", "user": {"login": "gordthompson", "id": 15894006, "node_id": "MDQ6VXNlcjE1ODk0MDA2", "avatar_url": "https://avatars0.githubusercontent.com/u/15894006?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gordthompson", "html_url": "https://github.com/gordthompson", "followers_url": "https://api.github.com/users/gordthompson/followers", "following_url": "https://api.github.com/users/gordthompson/following{/other_user}", "gists_url": "https://api.github.com/users/gordthompson/gists{/gist_id}", "starred_url": "https://api.github.com/users/gordthompson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gordthompson/subscriptions", "organizations_url": "https://api.github.com/users/gordthompson/orgs", "repos_url": "https://api.github.com/users/gordthompson/repos", "events_url": "https://api.github.com/users/gordthompson/events{/privacy}", "received_events_url": "https://api.github.com/users/gordthompson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-21T23:30:49Z", "updated_at": "2019-09-24T22:07:44Z", "closed_at": "2019-09-24T22:07:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I suspect that this may be a bug in the Access ODBC driver, but because it involves a Python `decimal.Decimal` parameter value I can't try the usual trick of doing the same thing from VBScript, C#, or whatever. I'm hoping that someone with a better understanding of pyodbc internals might see something in the ODBC trace to support or refute my suspicion.\r\n\r\nMy `decimal.Decimal` parameter works fine for inserting a value into a `DECIMAL` column, but using that same parameter value in `SELECT ? AS ...` yields an incorrect (and very small) Decimal result.\r\n\r\nRepro code:\r\n\r\n```python\r\nprint(sys.version)\r\n# 3.7.4 (tags/v3.7.4:e09359112e, Jul  8 2019, 20:34:20) [MSC v.1916 64 bit (AMD64)]\r\nprint(pyodbc.version)\r\n# 4.0.27\r\n\r\nprint(connection_string)\r\n# DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=C:\\__tmp\\gord_test.accdb;ExtendedAnsiSQL=1;\r\n\r\ncnxn = pyodbc.connect(connection_string, autocommit=True)\r\nprint(f'{cnxn.getinfo(pyodbc.SQL_DRIVER_NAME)}, version: {cnxn.getinfo(pyodbc.SQL_DRIVER_VER)}')\r\n# ACEODBC.DLL, version: Microsoft Access database engine\r\n\r\ncrsr = cnxn.cursor()\r\n\r\ntable_name = \"decimal_table\"\r\ntry:\r\n    crsr.execute(f\"DROP TABLE {table_name}\")\r\nexcept:\r\n    pass\r\ncrsr.execute(f\"CREATE TABLE {table_name} (decimal_field DECIMAL(18, 4))\")\r\nsql = f\"INSERT INTO {table_name} (decimal_field) VALUES (?)\"\r\ndecimal_pi = Decimal('3.14')\r\ncrsr.execute(sql, decimal_pi)\r\nsql = f\"SELECT decimal_field AS from_table, ? AS from_param FROM {table_name}\"\r\nrow = crsr.execute(sql, decimal_pi).fetchone()\r\nprint(f\"from_table: {repr(row.from_table)}\")\r\n# from_table: Decimal('3.1400')\r\nprint(f\"from_param: {repr(row.from_param)}\")\r\n# from_param: Decimal('6.2865046510420328852781736E-21')\r\n```\r\n\r\nODBC trace: \r\n[SQL.LOG](https://github.com/mkleehammer/pyodbc/files/3639174/SQL.LOG)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/622", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/622/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/622/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/622/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/622", "id": 494305754, "node_id": "MDU6SXNzdWU0OTQzMDU3NTQ=", "number": 622, "title": "Correct parameter of setinputsizes: pyodbc.SQL_TIMESTAMP ", "user": {"login": "washolive", "id": 36579559, "node_id": "MDQ6VXNlcjM2NTc5NTU5", "avatar_url": "https://avatars0.githubusercontent.com/u/36579559?v=4", "gravatar_id": "", "url": "https://api.github.com/users/washolive", "html_url": "https://github.com/washolive", "followers_url": "https://api.github.com/users/washolive/followers", "following_url": "https://api.github.com/users/washolive/following{/other_user}", "gists_url": "https://api.github.com/users/washolive/gists{/gist_id}", "starred_url": "https://api.github.com/users/washolive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/washolive/subscriptions", "organizations_url": "https://api.github.com/users/washolive/orgs", "repos_url": "https://api.github.com/users/washolive/repos", "events_url": "https://api.github.com/users/washolive/events{/privacy}", "received_events_url": "https://api.github.com/users/washolive/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-09-16T22:24:06Z", "updated_at": "2019-10-11T15:44:41Z", "closed_at": "2019-10-10T20:44:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "The pyodbc returned a error when I tried to use the literal \"SQL_TIMESTAMP\" as parameter for setinputsizes(list_of_value_tuples). Eg: setinputsizes([pyodbc.SQL_TIMESTAMP]).\r\n\r\nThis is the syntax according to wiki Data Types: \r\nhttps://github.com/mkleehammer/pyodbc/wiki/Data-Types\r\n\r\nLuckly, I changed to \"pyodbc.**SQL_TYPE_TIMESTAMP**\" and it worked !\r\nMay review the wiki ?\r\nThanks.\r\n\r\n### Environment\r\n- Python: 3.7\r\n- pyodbc: 4.0.27\r\n- OS: Windows 10\r\n- DB: Microsoft SQL Server\r\n- driver: Microsoft SQL Server 13\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/620", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/620/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/620/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/620/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/620", "id": 493351676, "node_id": "MDU6SXNzdWU0OTMzNTE2NzY=", "number": 620, "title": "Azure SQL DW chokes on long string parameters passed as ntext", "user": {"login": "gordthompson", "id": 15894006, "node_id": "MDQ6VXNlcjE1ODk0MDA2", "avatar_url": "https://avatars0.githubusercontent.com/u/15894006?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gordthompson", "html_url": "https://github.com/gordthompson", "followers_url": "https://api.github.com/users/gordthompson/followers", "following_url": "https://api.github.com/users/gordthompson/following{/other_user}", "gists_url": "https://api.github.com/users/gordthompson/gists{/gist_id}", "starred_url": "https://api.github.com/users/gordthompson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gordthompson/subscriptions", "organizations_url": "https://api.github.com/users/gordthompson/orgs", "repos_url": "https://api.github.com/users/gordthompson/repos", "events_url": "https://api.github.com/users/gordthompson/events{/privacy}", "received_events_url": "https://api.github.com/users/gordthompson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-13T14:19:32Z", "updated_at": "2019-09-13T18:37:59Z", "closed_at": "2019-09-13T18:37:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "(As reported in [this Stack Overflow question](https://stackoverflow.com/q/57917296/2144390).)\r\n\r\nThe following code works as expected ...\r\n\r\n```python\r\nprint(f\"Python version {sys.version}\")\r\n# Python version 3.7.4 (tags/v3.7.4:e09359112e, Jul  8 2019, 20:34:20) [MSC v.1916 64 bit (AMD64)]\r\n\r\nprint(f\"pyodbc version {pyodbc.version}\")\r\n# pyodbc version 4.0.27\r\n\r\nprint(f'{cnxn.getinfo(pyodbc.SQL_DRIVER_NAME)} version {cnxn.getinfo(pyodbc.SQL_DRIVER_VER)}')\r\n# msodbcsql17.dll version 17.04.0001\r\n\r\ncrsr.execute(\"CREATE TABLE ##test (id int PRIMARY KEY, [desc] nvarchar(max))\")\r\nid = 1\r\ncrsr.execute(\"INSERT INTO ##test (id, [desc]) VALUES (?, ?)\", id, 'foo')\r\ndesc = ' '.join(['abcde' for x in range(2)])\r\ncrsr.execute(\"UPDATE ##test SET [desc]=? WHERE id=?\", desc, id)\r\n```\r\n\r\n... with SQL Profiler showing\r\n\r\n```\r\ndeclare @p1 int\r\nset @p1=2\r\nexec sp_prepexec @p1 output,N'@P1 nvarchar(22),@P2 int',N'UPDATE ##test SET [desc]=@P1 WHERE id=@P2',N'abcde abcde',1\r\nselect @p1\r\n```\r\n\r\nHowever, after changing `['abcde' for x in range(2)]` to `['abcde' for x in range(2000)]` SQL Profiler shows\r\n\r\n```\r\ndeclare @p1 int\r\nset @p1=2\r\nexec sp_prepare @p1 output,N'@P1 ntext,@P2 int',N'UPDATE ##test SET [desc]=@P1 WHERE id=@P2',1\r\nselect @p1\r\n\r\nexec sp_execute 2,N'abcde abcde abcde ... (many repetitions omitted) ... abcde',1\r\n```\r\n\r\nNow my SQL Server 2014 instance is okay with that, but apparently Azure SQL DW chokes with\r\n\r\n```\r\npyodbc.ProgrammingError: ('42000', \"[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]104220;\r\nCannot find data type 'ntext'. (100000) (SQLExecDirectW)\")\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/618", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/618/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/618/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/618/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/618", "id": 489065111, "node_id": "MDU6SXNzdWU0ODkwNjUxMTE=", "number": 618, "title": "pyodbc Calling Stored Procedures with SQL Server 2008 ", "user": {"login": "iacob28", "id": 16120714, "node_id": "MDQ6VXNlcjE2MTIwNzE0", "avatar_url": "https://avatars3.githubusercontent.com/u/16120714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iacob28", "html_url": "https://github.com/iacob28", "followers_url": "https://api.github.com/users/iacob28/followers", "following_url": "https://api.github.com/users/iacob28/following{/other_user}", "gists_url": "https://api.github.com/users/iacob28/gists{/gist_id}", "starred_url": "https://api.github.com/users/iacob28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iacob28/subscriptions", "organizations_url": "https://api.github.com/users/iacob28/orgs", "repos_url": "https://api.github.com/users/iacob28/repos", "events_url": "https://api.github.com/users/iacob28/events{/privacy}", "received_events_url": "https://api.github.com/users/iacob28/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-04T10:05:31Z", "updated_at": "2019-09-04T13:09:44Z", "closed_at": "2019-09-04T13:09:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI have a question/issue with a stored procedure in `SQL Server 2008`. I'm using python v3 with latest `pyodbc` version and `ODBC Driver 17 for SQL Server`. I follow the wiki documentation on Calling Stored Procedures. I want to call a stored procedure that takes only input parameters like in the examples on the wiki page \r\n\r\n`params = (14, \"Dinsdale\")\r\n crsr.execute(\"{CALL usp_UpdateFirstName (?,?)}\", params)`\r\n\r\nI have no luck calling the procedure like this. I get no error, but the procedure is not executing. I have grant all the rights for the SQL user that I'm using in my python script. If anyone have any suggestion on this issue, it would be nice.\r\n\r\nThanks\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/617", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/617/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/617/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/617/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/617", "id": 488281463, "node_id": "MDU6SXNzdWU0ODgyODE0NjM=", "number": 617, "title": "Unable to insert UTF-8 character with fast_executemany option", "user": {"login": "maimat1", "id": 47862707, "node_id": "MDQ6VXNlcjQ3ODYyNzA3", "avatar_url": "https://avatars1.githubusercontent.com/u/47862707?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maimat1", "html_url": "https://github.com/maimat1", "followers_url": "https://api.github.com/users/maimat1/followers", "following_url": "https://api.github.com/users/maimat1/following{/other_user}", "gists_url": "https://api.github.com/users/maimat1/gists{/gist_id}", "starred_url": "https://api.github.com/users/maimat1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maimat1/subscriptions", "organizations_url": "https://api.github.com/users/maimat1/orgs", "repos_url": "https://api.github.com/users/maimat1/repos", "events_url": "https://api.github.com/users/maimat1/events{/privacy}", "received_events_url": "https://api.github.com/users/maimat1/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2019-09-02T17:54:35Z", "updated_at": "2020-02-09T20:34:23Z", "closed_at": "2020-02-09T20:34:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to copy data from one SQL Server instance to another using pyODBC package and I encountered an error while handling UTF-8 characters on Windows.\r\n\r\nI have narrowed it down to this snippet, which fails for me:\r\n```python\r\nimport pyodbc\r\nimport sys\r\nprint('system:' + str(sys.getwindowsversion()))\r\nprint('python:' + sys.version)\r\nprint('pyodbc:' + pyodbc.version)\r\ncnxn = pyodbc.connect(\r\n    r'''Driver=ODBC Driver 17 for SQL Server;Server=localhost;'''\r\n    r'''Database=DB_Pros;port=1433;Trusted_Connection=yes'''\r\n    )\r\ncrsr = cnxn.cursor()\r\ncrsr.fast_executemany=True\r\n\r\ncrsr.execute(\"\"\"DROP TABLE IF EXISTS dbo.testing_table\"\"\")\r\ncrsr.execute(\"\"\"CREATE TABLE dbo.testing_table (col1 nvarchar(max) null)\"\"\")\r\ncrsr.executemany(\"\"\"INSERT INTO dbo.testing_table (col1) VALUES (?)\"\"\", [[' \ud83c\udfa5 ',]])\r\n\r\nreturn_value = crsr.execute(\"SELECT * FROM dbo.testing_table\").fetchone()\r\n\r\nprint(return_value )\r\n\r\ncrsr.close()\r\ncnxn.close()\r\n```\r\n\r\nI get the following error:\r\n```\r\nsystem:sys.getwindowsversion(major=10, minor=0, build=18362, platform=2, service_pack='')\r\npython:3.7.1 (default, Oct 28 2018, 08:39:03) [MSC v.1912 64 bit (AMD64)]\r\npyodbc:4.0.27\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 15, in <module>\r\n    crsr.executemany(\"\"\"INSERT INTO dbo.testing_table (col1) VALUES (?)\"\"\", [[' \ud83c\udfa5 ',]])\r\npyodbc.DataError: ('22026', '[22026] [Microsoft][ODBC Driver 17 for SQL Server]String data, length mismatch (0) (SQLParamData)')\r\n```\r\nEverything works fine when I set the `crsr.fast_executemany=False`.\r\n\r\nThis seems to be somewhat related to #246 , but this happens on Windows system.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/616", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/616/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/616/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/616/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/616", "id": 486894695, "node_id": "MDU6SXNzdWU0ODY4OTQ2OTU=", "number": 616, "title": "pyodbc.Error: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server Native Client 11.0' : file not found (0) (SQLDriverConnect)\")", "user": {"login": "Chenhonli", "id": 40781993, "node_id": "MDQ6VXNlcjQwNzgxOTkz", "avatar_url": "https://avatars3.githubusercontent.com/u/40781993?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Chenhonli", "html_url": "https://github.com/Chenhonli", "followers_url": "https://api.github.com/users/Chenhonli/followers", "following_url": "https://api.github.com/users/Chenhonli/following{/other_user}", "gists_url": "https://api.github.com/users/Chenhonli/gists{/gist_id}", "starred_url": "https://api.github.com/users/Chenhonli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Chenhonli/subscriptions", "organizations_url": "https://api.github.com/users/Chenhonli/orgs", "repos_url": "https://api.github.com/users/Chenhonli/repos", "events_url": "https://api.github.com/users/Chenhonli/events{/privacy}", "received_events_url": "https://api.github.com/users/Chenhonli/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-29T11:13:03Z", "updated_at": "2020-03-02T07:35:34Z", "closed_at": "2019-10-10T20:37:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: python3.6.0\r\n- pyodbc: 4.0.27\r\n- OS: centos7\r\n- DB: sqlserver\r\n- driver: SQL Server Native Client 11.0\r\n\r\n### Issue\r\n\r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/615", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/615/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/615/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/615/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/615", "id": 486810020, "node_id": "MDU6SXNzdWU0ODY4MTAwMjA=", "number": 615, "title": "select from multiple tables with same column name", "user": {"login": "sogartar", "id": 3050579, "node_id": "MDQ6VXNlcjMwNTA1Nzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/3050579?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sogartar", "html_url": "https://github.com/sogartar", "followers_url": "https://api.github.com/users/sogartar/followers", "following_url": "https://api.github.com/users/sogartar/following{/other_user}", "gists_url": "https://api.github.com/users/sogartar/gists{/gist_id}", "starred_url": "https://api.github.com/users/sogartar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sogartar/subscriptions", "organizations_url": "https://api.github.com/users/sogartar/orgs", "repos_url": "https://api.github.com/users/sogartar/repos", "events_url": "https://api.github.com/users/sogartar/events{/privacy}", "received_events_url": "https://api.github.com/users/sogartar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-29T08:20:53Z", "updated_at": "2019-10-10T20:36:49Z", "closed_at": "2019-10-10T20:36:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "It seems that pyodbc strips the table prefix in Row if you do for example.\r\n\r\n```\r\nSELECT\r\n  table1.a,\r\n  table2.a\r\nFROM\r\n  table1\r\n  INNER JOIN table2\r\n```\r\n\r\nYou can do `row.a` to access a column, but this returns only one of the columns. It should be possible to do something like `row.table1.a` or `row[\"table1.a\"]`.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/614", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/614/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/614/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/614/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/614", "id": 484952366, "node_id": "MDU6SXNzdWU0ODQ5NTIzNjY=", "number": 614, "title": "pyodbc segfaults", "user": {"login": "piskvorky", "id": 610412, "node_id": "MDQ6VXNlcjYxMDQxMg==", "avatar_url": "https://avatars1.githubusercontent.com/u/610412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/piskvorky", "html_url": "https://github.com/piskvorky", "followers_url": "https://api.github.com/users/piskvorky/followers", "following_url": "https://api.github.com/users/piskvorky/following{/other_user}", "gists_url": "https://api.github.com/users/piskvorky/gists{/gist_id}", "starred_url": "https://api.github.com/users/piskvorky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/piskvorky/subscriptions", "organizations_url": "https://api.github.com/users/piskvorky/orgs", "repos_url": "https://api.github.com/users/piskvorky/repos", "events_url": "https://api.github.com/users/piskvorky/events{/privacy}", "received_events_url": "https://api.github.com/users/piskvorky/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-25T16:57:41Z", "updated_at": "2019-08-25T21:38:10Z", "closed_at": "2019-08-25T21:37:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python:\r\n  - `sys.version` on machine without segfault: `3.7.3 (default, Jun  3 2019, 17:11:16) \\n[GCC 5.4.0 20160609]`\r\n  - segfaulting `sys.version` `3.7.3 (default, Jul  6 2019, 01:31:21) \\n[GCC 7.2.0]`\r\n  - both installed via virtualenv, standard cpython\r\n- pyodbc: `pyodbc==4.0.26`\r\n- OS:\r\n  - OK: `4.4.0-96-generic #119-Ubuntu SMP Tue Sep 12 14:59:54 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux`\r\n  - segfaulting: `4.13.0-46-generic #51-Ubuntu SMP Tue Jun 12 12:36:29 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux`\r\n- DB: `Oracle Database 12c Standard Edition Release 12.2.0.1.0 - 64bit Production`\r\n- driver: Oracle InstantClient 19.3\r\n\r\n### Issue\r\n\r\nRunning the following script works on one machine but segfaults on another. Both use the exact same script, same Python version and connect to the same DB (Oracle 12c).\r\n\r\n```python\r\nimport pyodbc\r\nconn12 = pyodbc.connect(**{'dbq': '111.222.111.222:1521/ORCLPDB1', 'uid': 'system', 'pwd': 'my_pwd', 'driver': \"Oracle 19 ODBC driver\"})\r\nprint(len(list(conn12.cursor().execute(\"\"\"SELECT * FROM DBA_TABLES;\"\"\"))))\r\n```\r\n\r\nOn the OK machine, this prints:\r\n```\r\n2105\r\n```\r\n\r\nOn the segfauting machine, `gdb` shows this trace:\r\n\r\n```\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n0x00007ffff57f4555 in new_date_ex (year=2019, month=8, day=25, type=0xd) at /tmp/Python-3.7.3/Modules/_datetimemodule.c:848\r\n848         self = (PyDateTime_Date *)(type->tp_alloc(type, 0));\r\n(gdb) bt\r\n#0  0x00007ffff57f4555 in new_date_ex (year=2019, month=8, day=25, type=0xd) at /tmp/Python-3.7.3/Modules/_datetimemodule.c:848\r\n#1  0x00007ffff6682742 in GetDataTimestamp (iCol=0, cur=0x7ffff68c4468) at src/getdata.cpp:642\r\n#2  GetData (cur=cur@entry=0x7ffff68c4468, iCol=iCol@entry=32) at src/getdata.cpp:840\r\n#3  0x00007ffff667e239 in Cursor_fetch (cur=0x7ffff68c4468) at src/cursor.cpp:1100\r\n#4  0x00005555555e0ebe in list_extend (self=0x7ffff4d57508, iterable=<optimized out>) at Objects/listobject.c:897\r\n#5  0x00005555555e1364 in list___init___impl (iterable=0x7ffff68c4468, self=0x7ffff4d57508) at Objects/listobject.c:2654\r\n#6  list___init__ (self=0x7ffff4d57508, args=<optimized out>, kwargs=<optimized out>) at Objects/clinic/listobject.c.h:247\r\n#7  0x000055555562ea67 in type_call (type=<optimized out>, type@entry=0x555555a445a0 <PyList_Type>, args=args@entry=0x7ffff7f90198, kwds=kwds@entry=0x0)\r\n    at Objects/typeobject.c:949\r\n#8  0x00005555555cb7ff in _PyObject_FastCallKeywords (callable=callable@entry=0x555555a445a0 <PyList_Type>, stack=<optimized out>, nargs=nargs@entry=1,\r\n    kwnames=kwnames@entry=0x0) at Objects/call.c:199\r\n#9  0x00005555555b13b5 in call_function (kwnames=0x0, oparg=<optimized out>, pp_stack=<synthetic pointer>) at Python/ceval.c:4619\r\n#10 _PyEval_EvalFrameDefault (f=<optimized out>, throwflag=<optimized out>) at Python/ceval.c:3124\r\n#11 0x0000555555687b40 in PyEval_EvalFrameEx (throwflag=0, f=0x7ffff7f969f8) at Python/ceval.c:547\r\n#12 _PyEval_EvalCodeWithName (_co=_co@entry=0x7ffff7f23d20, globals=globals@entry=0x7ffff7f23d20, locals=locals@entry=0x7ffff7fe40a8, args=args@entry=0x0,\r\n    argcount=argcount@entry=0, kwnames=kwnames@entry=0x0, kwargs=0x0, kwcount=0, kwstep=2, defs=0x0, defcount=0, kwdefs=0x0, closure=0x0, name=0x0,\r\n    qualname=0x0) at Python/ceval.c:3930\r\n#13 0x0000555555687c03 in PyEval_EvalCodeEx (closure=0x0, kwdefs=0x0, defcount=0, defs=0x0, kwcount=0, kws=0x0, argcount=0, args=0x0,\r\n    locals=locals@entry=0x7ffff7fe40a8, globals=globals@entry=0x7ffff7f23d20, _co=_co@entry=0x7ffff7f23d20) at Python/ceval.c:3959\r\n#14 PyEval_EvalCode (co=co@entry=0x7ffff7f23d20, globals=globals@entry=0x7ffff7eea288, locals=locals@entry=0x7ffff7eea288) at Python/ceval.c:524\r\n#15 0x00005555556c2f8b in run_mod (arena=0x7ffff7fe40a8, flags=0x7fffffffdb60, locals=0x7ffff7eea288, globals=0x7ffff7eea288, filename=0x7ffff7f1a378,\r\n    mod=0x555555b2d510) at Python/pythonrun.c:1035\r\n#16 PyRun_FileExFlags (fp=0x555555b09180, filename_str=<optimized out>, start=<optimized out>, globals=0x7ffff7eea288, locals=0x7ffff7eea288, closeit=1,\r\n    flags=0x7fffffffdb60) at Python/pythonrun.c:988\r\n#17 0x00005555556c317f in PyRun_SimpleFileExFlags (fp=0x555555b09180, filename=<optimized out>, closeit=1, flags=0x7fffffffdb60) at Python/pythonrun.c:429\r\n#18 0x00005555555be695 in pymain_run_file (p_cf=0x7fffffffdb60, filename=<optimized out>, fp=0x555555b09180) at Modules/main.c:427\r\n#19 pymain_run_filename (cf=0x7fffffffdb60, pymain=0x7fffffffdc70) at Modules/main.c:1627\r\n#20 pymain_run_python (pymain=0x7fffffffdc70) at Modules/main.c:2877\r\n#21 pymain_main (pymain=pymain@entry=0x7fffffffdc70) at Modules/main.c:3038\r\n#22 0x00005555555be909 in _Py_UnixMain (argc=<optimized out>, argv=<optimized out>) at Modules/main.c:3073\r\n#23 0x00007ffff70991c1 in __libc_start_main (main=0x5555555ae7b0 <main>, argc=2, argv=0x7fffffffddc8, init=<optimized out>, fini=<optimized out>,\r\n    rtld_fini=<optimized out>, stack_end=0x7fffffffddb8) at ../csu/libc-start.c:308\r\n#24 0x00005555555b87ea in _start ()\r\n```\r\n\r\nAny idea what's wrong?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/613", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/613/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/613/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/613/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/613", "id": 484869195, "node_id": "MDU6SXNzdWU0ODQ4NjkxOTU=", "number": 613, "title": "pyodbc arabic text coming as illegal characters", "user": {"login": "ziaul-haque", "id": 1625747, "node_id": "MDQ6VXNlcjE2MjU3NDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1625747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ziaul-haque", "html_url": "https://github.com/ziaul-haque", "followers_url": "https://api.github.com/users/ziaul-haque/followers", "following_url": "https://api.github.com/users/ziaul-haque/following{/other_user}", "gists_url": "https://api.github.com/users/ziaul-haque/gists{/gist_id}", "starred_url": "https://api.github.com/users/ziaul-haque/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ziaul-haque/subscriptions", "organizations_url": "https://api.github.com/users/ziaul-haque/orgs", "repos_url": "https://api.github.com/users/ziaul-haque/repos", "events_url": "https://api.github.com/users/ziaul-haque/events{/privacy}", "received_events_url": "https://api.github.com/users/ziaul-haque/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-24T22:38:25Z", "updated_at": "2019-10-10T20:34:06Z", "closed_at": "2019-10-10T20:34:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "- Python: Python 3.5.2\r\n- pyodbc: 4.0.26\r\n- OS: ubuntu 16.04\r\n- DB:mssql server\r\n- driver:FreeTDS \r\n\r\n### Issue\r\narabic text coming as illegal characters\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/612", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/612/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/612/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/612/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/612", "id": 483114893, "node_id": "MDU6SXNzdWU0ODMxMTQ4OTM=", "number": 612, "title": "Oracle: Error: ('IM004', \"[IM004] [unixODBC][Driver Manager]Driver's SQLAllocHandle on SQL_HANDLE_HENV failed (0) (SQLDriverConnect)\")", "user": {"login": "piskvorky", "id": 610412, "node_id": "MDQ6VXNlcjYxMDQxMg==", "avatar_url": "https://avatars1.githubusercontent.com/u/610412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/piskvorky", "html_url": "https://github.com/piskvorky", "followers_url": "https://api.github.com/users/piskvorky/followers", "following_url": "https://api.github.com/users/piskvorky/following{/other_user}", "gists_url": "https://api.github.com/users/piskvorky/gists{/gist_id}", "starred_url": "https://api.github.com/users/piskvorky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/piskvorky/subscriptions", "organizations_url": "https://api.github.com/users/piskvorky/orgs", "repos_url": "https://api.github.com/users/piskvorky/repos", "events_url": "https://api.github.com/users/piskvorky/events{/privacy}", "received_events_url": "https://api.github.com/users/piskvorky/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-08-20T22:37:16Z", "updated_at": "2019-11-13T02:52:42Z", "closed_at": "2019-08-21T12:51:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.7\r\n- pyodbc: 4.0.26\r\n- OS: x86_64 Linux (both the remote DB machine and `pyodbc` machine)\r\n- DB: Oracle 12.2.01 SE2, running from its [official Docker image](https://github.com/oracle/docker-images/tree/master/OracleDatabase/SingleInstance).\r\n- driver: ODBC 19.3 (official Oracle Instant Client, all default settings)\r\n\r\n### Issue\r\n\r\nThis works:\r\n\r\n```python\r\nimport cx_Oracle\r\nconnection = cx_Oracle.connect(\"system\", \"my_pwd\", \"175.201.160.29/ORCLPDB1\")\r\n# \u2026connection cursors work as expected, all good\r\n```\r\n\r\nBut none of this works:\r\n\r\n```python\r\nimport pyodbc  # version 4.0.26\r\nconn_params = [\r\n    {'server': '175.201.160.29:1521', 'uid': 'system', 'pwd': 'my_pwd', 'driver': \"Oracle 19 ODBC driver\"},\r\n    {'server': '175.201.160.29:1521/ORCLCDB', 'uid': 'system', 'pwd': 'my_pwd', 'driver': \"Oracle 19 ODBC driver\"},\r\n    {'server': '175.201.160.29:1521/ORCLPDB1', 'uid': 'system', 'pwd': 'my_pwd', 'driver': \"Oracle 19 ODBC driver\"},\r\n    {'dbq': '175.201.160.29:1521', 'uid': 'system', 'pwd': 'my_pwd', 'driver': \"Oracle 19 ODBC driver\"},\r\n    {'dbq': '175.201.160.29:1521/ORCLCDB', 'uid': 'system', 'pwd': 'my_pwd', 'driver': \"Oracle 19 ODBC driver\"},\r\n    {'dbq': '175.201.160.29:1521/ORCLPDB1', 'uid': 'system', 'pwd': 'my_pwd', 'driver': \"Oracle 19 ODBC driver\"},\r\n    {'server': '175.201.160.29', 'sid': 'ORCLPDB1',  'uid': 'system', 'pwd': 'my_pwd', 'driver': \"Oracle 19 ODBC driver\"},\r\n]\r\nfor attempt in conn_params:\r\n    try:\r\n        conn = pyodbc.connect(**attempt)\r\n        print('SUCCESS!')\r\n    except Exception:\r\n        print('failed with', attempt)\r\n```\r\n\r\nThe error is always `Error: ('IM004', \"[IM004] [unixODBC][Driver Manager]Driver's SQLAllocHandle on SQL_HANDLE_HENV failed (0) (SQLDriverConnect)\")`.\r\n\r\nWhat's the correct way to use `pyodbc` with Oracle ODBC?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/608", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/608/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/608/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/608/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/608", "id": 480216151, "node_id": "MDU6SXNzdWU0ODAyMTYxNTE=", "number": 608, "title": "No Error Message - using pyodbc.connect() on an Access DB Linked to a SharePoint List", "user": {"login": "Bigbigyoshi", "id": 54072959, "node_id": "MDQ6VXNlcjU0MDcyOTU5", "avatar_url": "https://avatars3.githubusercontent.com/u/54072959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bigbigyoshi", "html_url": "https://github.com/Bigbigyoshi", "followers_url": "https://api.github.com/users/Bigbigyoshi/followers", "following_url": "https://api.github.com/users/Bigbigyoshi/following{/other_user}", "gists_url": "https://api.github.com/users/Bigbigyoshi/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bigbigyoshi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bigbigyoshi/subscriptions", "organizations_url": "https://api.github.com/users/Bigbigyoshi/orgs", "repos_url": "https://api.github.com/users/Bigbigyoshi/repos", "events_url": "https://api.github.com/users/Bigbigyoshi/events{/privacy}", "received_events_url": "https://api.github.com/users/Bigbigyoshi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 31, "created_at": "2019-08-13T15:16:44Z", "updated_at": "2019-10-10T20:32:42Z", "closed_at": "2019-10-10T20:32:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n- Python: 3.6.6 64bit\r\n- pyodbc: 4.0.27\r\n- OS:  Windows 10 Enterprise\r\n- DB: Microsoft Access DB Linked to Sharepoint 2016 List\r\n- driver: Not sure how to check this. Please advise if this info is important.\r\n\r\n### Issue\r\nI have two .accdb files. One is called Test.accdb, the other is called Test2.accdb.\r\n\r\nTest.accdb is **linked to a Sharepoint 2016 List.**\r\nTest2.accdb is **not linked to anything**.\r\n\r\nI am having issues setting up a `conn` variable. \r\n\r\nI am assigning `conn` as follows:\r\n```\r\nconn = pyodbc.connect(r'Driver={Microsoft Access Driver (*.mdb, *.accdb)}; DBQ=C:\\\\Users\\\\userName\\\\Desktop\\\\Project Folders\\\\sharepointList\\\\test.accdb;')\r\n```\r\n\r\nWhen I run that line of code with test2.accdb as the file to connect to I have no issues. The line completes and I can run the rest of my code.\r\n\r\nWhen I run the line of code with test.accdb, the one **linked to Sharepoint,** I can not get past it. \r\nI wrote a small amount of code to test a theory. It is shown below:\r\n```\r\nprint(\"Before\")\r\nconn = pyodbc.connect(r'Driver={Microsoft Access Driver (*.mdb, *.accdb)}; DBQ=C:\\\\Users\\\\userName\\\\Desktop\\\\Project Folders\\\\sharepointList\\\\test.accdb;')\r\nprint(\"After\")\r\n```\r\n\r\nI also tried the following, using try/except:\r\n```\r\ntry:\r\n    print(\"Before\")\r\n    conn = pyodbc.connect(r'Driver={Microsoft Access Driver (*.mdb, *.accdb)}; DBQ=C:\\\\Users\\\\userName\\\\Desktop\\\\Project Folders\\\\sharepointList\\\\test.accdb;')\r\nexcept:\r\n    print(\"Something Crashed\")\r\nprint(\"After\")\r\n```\r\nThe new print statement was never executed. This leads me to believe that the code never really crashed, It just sort of stopped. \r\n\r\nWhen I run this code with test2.accdb both print lines are executed.\r\nWhen I run this code with test.accdb, the one **linked to sharepoint**, only the \"Before\" print line is executed. \r\nI would expect the `conn` assignment to execute completely and allow me to execute the rest of my code. Instead, the code stops running at some point within the .connect() function.\r\n**I get no error message when I run the code. The code simply stops.**\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/607", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/607/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/607/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/607/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/607", "id": 480185383, "node_id": "MDU6SXNzdWU0ODAxODUzODM=", "number": 607, "title": "Documentation issue - Unicode page", "user": {"login": "blackgis", "id": 7139491, "node_id": "MDQ6VXNlcjcxMzk0OTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/7139491?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blackgis", "html_url": "https://github.com/blackgis", "followers_url": "https://api.github.com/users/blackgis/followers", "following_url": "https://api.github.com/users/blackgis/following{/other_user}", "gists_url": "https://api.github.com/users/blackgis/gists{/gist_id}", "starred_url": "https://api.github.com/users/blackgis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blackgis/subscriptions", "organizations_url": "https://api.github.com/users/blackgis/orgs", "repos_url": "https://api.github.com/users/blackgis/repos", "events_url": "https://api.github.com/users/blackgis/events{/privacy}", "received_events_url": "https://api.github.com/users/blackgis/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-13T14:21:19Z", "updated_at": "2019-08-14T07:10:44Z", "closed_at": "2019-08-14T07:10:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7.4/64bit\r\n- pyodbc: 4.0.27\r\n- OS: Win10\r\n- DB: SQL SERVER\r\n- driver: 10.00.18362\r\n\r\npyodbc.connect('Driver={SQL Server};'\r\n\r\n### Issue\r\nSource: https://github.com/mkleehammer/pyodbc/wiki/Unicode\r\n\r\nMy collation is \"SQL_Latin1_General_CP1_CI_AS\", and when i add \r\n\r\n`cnxn.setdecoding(pyodbc.SQL_CHAR, encoding='latin1', to=str) \r\ncnxn.setencoding(str, encoding='latin1')`\r\n\r\nI always get the error\r\n\r\n> TypeError: 'to' is an invalid keyword argument for this function\r\n\r\nRemoving **to=str** just leads to\r\n\r\n> TypeError: argument 1 must be str, not type\r\n\r\nSo far I could execute all the select statements without an issue, but today i looked something up and found that and tried it out and failed.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/603", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/603/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/603/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/603/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/603", "id": 478549566, "node_id": "MDU6SXNzdWU0Nzg1NDk1NjY=", "number": 603, "title": "Issues with binding parameters for large SQL Server queries", "user": {"login": "KYDronePilot", "id": 33381603, "node_id": "MDQ6VXNlcjMzMzgxNjAz", "avatar_url": "https://avatars2.githubusercontent.com/u/33381603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KYDronePilot", "html_url": "https://github.com/KYDronePilot", "followers_url": "https://api.github.com/users/KYDronePilot/followers", "following_url": "https://api.github.com/users/KYDronePilot/following{/other_user}", "gists_url": "https://api.github.com/users/KYDronePilot/gists{/gist_id}", "starred_url": "https://api.github.com/users/KYDronePilot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KYDronePilot/subscriptions", "organizations_url": "https://api.github.com/users/KYDronePilot/orgs", "repos_url": "https://api.github.com/users/KYDronePilot/repos", "events_url": "https://api.github.com/users/KYDronePilot/events{/privacy}", "received_events_url": "https://api.github.com/users/KYDronePilot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2019-08-08T15:42:05Z", "updated_at": "2019-08-14T17:41:11Z", "closed_at": "2019-08-14T17:41:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n#### Old\r\n- Python: 2.7.2 (32 bit)\r\n- pyodbc: 3.0.5\r\n\r\n#### New\r\n- Python: 3.7.4 (64 bit)\r\n- pyodbc: 4.0.27\r\n\r\n#### Same\r\n- OS: Windows 10 1903\r\n- DB: SQL Server 13.0.5216.0\r\n- driver: SQL Server Native Client 11.0 (2011.110.6540.00)\r\n\r\n### Issue\r\n\r\nI am upgrading some old Python 2.7 code to Python 3.7 and ran into a very large query that is run\r\nusing pyodbc. It binds 28 parameters.\r\n\r\nIn the version of pyodbc I am running in Python 2.7, the query would take a little over a minute to\r\nrun, but in the latest version of pyodbc, I am unable to successfully run the query, as the tempdb\r\nruns out of space before it can  complete. The longest it was able to run before the database\r\nerrored out was approximately 20 minutes.\r\n\r\nI read the article in the wiki about difficulties binding parameters using SQLBindParameter, but am\r\nconfused as to why the query used to work in the older version of pyodbc. Did parameters used to be\r\nformatted directly into the query or handled in some other way in that version?\r\n\r\nAs a side note, if I manually insert the parameters and run the query with pyodbc, it completes in\r\nthe normal amount of time (little over a minute). To further verify the issue had to do with\r\nvariable binding, I tried adding the variables back into the query a few at a time and the execution\r\ntime increased with each addition.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/602", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/602/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/602/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/602/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/602", "id": 478252981, "node_id": "MDU6SXNzdWU0NzgyNTI5ODE=", "number": 602, "title": "ODBC API to Python Method mapping ", "user": {"login": "rooparam", "id": 13015913, "node_id": "MDQ6VXNlcjEzMDE1OTEz", "avatar_url": "https://avatars3.githubusercontent.com/u/13015913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rooparam", "html_url": "https://github.com/rooparam", "followers_url": "https://api.github.com/users/rooparam/followers", "following_url": "https://api.github.com/users/rooparam/following{/other_user}", "gists_url": "https://api.github.com/users/rooparam/gists{/gist_id}", "starred_url": "https://api.github.com/users/rooparam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rooparam/subscriptions", "organizations_url": "https://api.github.com/users/rooparam/orgs", "repos_url": "https://api.github.com/users/rooparam/repos", "events_url": "https://api.github.com/users/rooparam/events{/privacy}", "received_events_url": "https://api.github.com/users/rooparam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-08T05:06:41Z", "updated_at": "2019-10-10T20:28:51Z", "closed_at": "2019-10-10T20:28:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi ,\r\n\r\nI was  looking for a mapping list of Supported Python Methods to corresponding ODBC API .\r\n\r\nhttps://github.com/mkleehammer/pyodbc/wiki/Features-beyond-the-DB-API\r\n\r\nIn this link we have a table under Miscellaneous ODBC Functions. I was looking for other ODBC API also .\r\n\r\nI went to the wiki page but couldn't get any . Can you please help me with this. \r\n\r\nRegards\r\nRoopa\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/601", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/601/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/601/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/601/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/601", "id": 477410169, "node_id": "MDU6SXNzdWU0Nzc0MTAxNjk=", "number": 601, "title": "Table-Valued Parameters (TVPs) with fast_executemany", "user": {"login": "gordthompson", "id": 15894006, "node_id": "MDQ6VXNlcjE1ODk0MDA2", "avatar_url": "https://avatars0.githubusercontent.com/u/15894006?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gordthompson", "html_url": "https://github.com/gordthompson", "followers_url": "https://api.github.com/users/gordthompson/followers", "following_url": "https://api.github.com/users/gordthompson/following{/other_user}", "gists_url": "https://api.github.com/users/gordthompson/gists{/gist_id}", "starred_url": "https://api.github.com/users/gordthompson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gordthompson/subscriptions", "organizations_url": "https://api.github.com/users/gordthompson/orgs", "repos_url": "https://api.github.com/users/gordthompson/repos", "events_url": "https://api.github.com/users/gordthompson/events{/privacy}", "received_events_url": "https://api.github.com/users/gordthompson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-08-06T14:19:57Z", "updated_at": "2019-08-17T17:11:58Z", "closed_at": "2019-08-17T17:11:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Python version 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 21:26:53) [MSC v.1916 32 bit (Intel)]  \r\npyodbc version 4.0.27  \r\nmsodbcsql17.dll version 17.03.0001  \r\n\r\nGiven the following database objects ...\r\n\r\n```sql\r\n/****** Object:  UserDefinedTableType [dbo].[intTable]    Script Date: 2019-08-06 08:04:34 ******/\r\nCREATE TYPE [dbo].[intTable] AS TABLE(\r\n    [c1] [int] NOT NULL,\r\n    PRIMARY KEY CLUSTERED \r\n(\r\n    [c1] ASC\r\n)WITH (IGNORE_DUP_KEY = OFF)\r\n)\r\nGO\r\n```\r\n\r\n```sql\r\n/****** Object:  StoredProcedure [dbo].[tvpTestProc]    Script Date: 2019-08-06 08:05:39 ******/\r\nSET ANSI_NULLS ON\r\nGO\r\n\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROCEDURE [dbo].[tvpTestProc] \r\n    @tbl intTable READONLY\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    INSERT INTO tvpTestTable (c1) SELECT c1 FROM @tbl;\r\nEND\r\n\r\nGO\r\n```\r\n\r\n... the following code works fine:\r\n\r\n```python\r\ncrsr.execute(\"TRUNCATE TABLE tvpTestTable\")\r\ndata = [[[[1],[2]]] for i in range(3)]\r\nsql = \"{CALL tvpTestProc(?)}\"\r\ncrsr.fast_executemany = False\r\ncrsr.executemany(sql, data)\r\nprint(crsr.execute(\"SELECT * FROM tvpTestTable\").fetchall())\r\n# [(1, 1), (2, 2), (3, 1), (4, 2), (5, 1), (6, 2)]\r\n```\r\n\r\nHowever, when I change `fast_executemany` to `True` then I get\r\n\r\n> pyodbc.ProgrammingError: ('Unknown object type list during describe', 'HY000')\r\n\r\nI tried using both `UseFMTONLY=Yes` and `UseFMTONLY=No` and I got the same result.\r\n\r\nSQL.LOG shows that SQLDescribeParam is successful ...\r\n\r\n```\r\nmain            170c-1288\tEXIT  SQLDescribeParam  with return code 0 (SQL_SUCCESS)\r\n        HSTMT               0x006CAAB8\r\n        UWORD                        1 \r\n        SWORD *             0x020DDB4A (-153)\r\n        SQLULEN *           0x020DDB4C (0)\r\n        SWORD *             0x020DDB50 (0)\r\n        SWORD *             0x0031F8F0 (1)\r\n```\r\n\r\n... but pyodbc appears to be unhappy with what it got back.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/600", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/600/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/600/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/600/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/600", "id": 477252620, "node_id": "MDU6SXNzdWU0NzcyNTI2MjA=", "number": 600, "title": "Fails on Azure Notebook 'pyodbc.Cursor' object has no attribute 'fast_executemany'", "user": {"login": "moeenuddin", "id": 2076100, "node_id": "MDQ6VXNlcjIwNzYxMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/2076100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/moeenuddin", "html_url": "https://github.com/moeenuddin", "followers_url": "https://api.github.com/users/moeenuddin/followers", "following_url": "https://api.github.com/users/moeenuddin/following{/other_user}", "gists_url": "https://api.github.com/users/moeenuddin/gists{/gist_id}", "starred_url": "https://api.github.com/users/moeenuddin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/moeenuddin/subscriptions", "organizations_url": "https://api.github.com/users/moeenuddin/orgs", "repos_url": "https://api.github.com/users/moeenuddin/repos", "events_url": "https://api.github.com/users/moeenuddin/events{/privacy}", "received_events_url": "https://api.github.com/users/moeenuddin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-06T08:53:11Z", "updated_at": "2019-10-10T20:27:58Z", "closed_at": "2019-10-10T20:27:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nOn Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python:  3.6\r\n- pyodbc: 4.0.22, 26, 27\r\n- OS: Linux\r\n- DB: SQL SERVER\r\n- driver: pyodbc\r\n\r\n### Issue\r\n\r\nExpected Behavior:\r\nThe same code works on Mac OS using Anacoda pyodbc: 2.0.27, python 3.6\r\n\r\nObserved behavior:\r\n\r\n'pyodbc.Cursor' object has no attribute 'fast_executemany'\r\n\r\n-- Note: there was a typo in writing pyodbc version i wrote 2.0.22... instead of 4.0.22", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/599", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/599/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/599/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/599/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/599", "id": 476564682, "node_id": "MDU6SXNzdWU0NzY1NjQ2ODI=", "number": 599, "title": "AWS Lambda PYODBC no module named ", "user": {"login": "aarontanzk", "id": 19486238, "node_id": "MDQ6VXNlcjE5NDg2MjM4", "avatar_url": "https://avatars1.githubusercontent.com/u/19486238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aarontanzk", "html_url": "https://github.com/aarontanzk", "followers_url": "https://api.github.com/users/aarontanzk/followers", "following_url": "https://api.github.com/users/aarontanzk/following{/other_user}", "gists_url": "https://api.github.com/users/aarontanzk/gists{/gist_id}", "starred_url": "https://api.github.com/users/aarontanzk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aarontanzk/subscriptions", "organizations_url": "https://api.github.com/users/aarontanzk/orgs", "repos_url": "https://api.github.com/users/aarontanzk/repos", "events_url": "https://api.github.com/users/aarontanzk/events{/privacy}", "received_events_url": "https://api.github.com/users/aarontanzk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-08-04T15:24:53Z", "updated_at": "2019-10-10T20:25:33Z", "closed_at": "2019-10-10T20:25:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7\r\n- pyodbc: 4.0.27\r\n- OS: WINDOWS\r\n- DB: MS SQL SERVER \r\n- driver: SQL SERVER\r\n\r\n### Issue\r\n\r\nOften it is easiest to describe your issue as \"expected behavior\" and \"observed behavior\".\r\n\r\nExpected behavior:\r\nI have a working python script with pyodbc installed via pip which executes the sql well.\r\nI am trying to move this script to be executed via AWS Lambda.\r\n\r\nExpected behavior is to execute successfully as per my local machine.\r\n\r\nObserved behavior:\r\nTo package it as a zip file to send to AWS, I have done pip install pyodbc -t . , which creates a pyodbc-4.0.27.dist-info and pyodbc.cp37-win32.pyd.\r\n\r\nUnlike other packages, it does not come with a pyodbc folder.\r\n\r\nWhen executed on AWS, I'm getting the error:\r\n\r\n[ERROR] Runtime.ImportModuleError: Unable to import module 'main': No module named 'pyodbc'\r\n\r\nwhich means that there is no readable py files from pyodbc.\r\n\r\n======================================================\r\n\r\nAny idea how to resolve?\r\n\r\nThanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/598", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/598/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/598/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/598/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/598", "id": 476333971, "node_id": "MDU6SXNzdWU0NzYzMzM5NzE=", "number": 598, "title": "Debugging pyodbc from within Visual Studio IDE", "user": {"login": "gordthompson", "id": 15894006, "node_id": "MDQ6VXNlcjE1ODk0MDA2", "avatar_url": "https://avatars0.githubusercontent.com/u/15894006?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gordthompson", "html_url": "https://github.com/gordthompson", "followers_url": "https://api.github.com/users/gordthompson/followers", "following_url": "https://api.github.com/users/gordthompson/following{/other_user}", "gists_url": "https://api.github.com/users/gordthompson/gists{/gist_id}", "starred_url": "https://api.github.com/users/gordthompson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gordthompson/subscriptions", "organizations_url": "https://api.github.com/users/gordthompson/orgs", "repos_url": "https://api.github.com/users/gordthompson/repos", "events_url": "https://api.github.com/users/gordthompson/events{/privacy}", "received_events_url": "https://api.github.com/users/gordthompson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-02T19:57:30Z", "updated_at": "2019-08-05T19:57:08Z", "closed_at": "2019-08-05T19:57:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In the hope of better understanding the inner workings of pyodbc I'm trying to set up a Visual Studio 2015 project where I can trace through the execution of pyodbc calls using the Visual Studio debugger. I followed the steps in [this video](https://youtu.be/D9RlT06a1EI), substituting the pyodbc code for the sample code in the video. Now I am facing two issues:\r\n\r\n(1) The pyodbc code includes a lot of conditional compilation directives for handling Python_2 and Python_3. I haven't yet found a way to tell Visual Studio that, for example, `PY_MAJOR_VERSION` is `3`.\r\n\r\n(2) Even after adding (what I believe to be) the appropriate folders for *both* Python_3 and Python_2 to \"Additional Include Directories\" and \"Additional Library Directories\" I'm still seeing a lot of errors like \r\n\r\n - identifier \"PyUnicode_FromUnicode\" is undefined\r\n - identifier \"PyUnicode_GET_SIZE\" is undefined\r\n - inline specifier allowed on function declarations only\r\n - and so on.\r\n\r\nI'd appreciate any suggestions from folks who may have already been down this road.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/597", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/597/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/597/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/597/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/597", "id": 476288250, "node_id": "MDU6SXNzdWU0NzYyODgyNTA=", "number": 597, "title": "Get table structure for duplicating to local database purpose", "user": {"login": "Freizello", "id": 12061206, "node_id": "MDQ6VXNlcjEyMDYxMjA2", "avatar_url": "https://avatars3.githubusercontent.com/u/12061206?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Freizello", "html_url": "https://github.com/Freizello", "followers_url": "https://api.github.com/users/Freizello/followers", "following_url": "https://api.github.com/users/Freizello/following{/other_user}", "gists_url": "https://api.github.com/users/Freizello/gists{/gist_id}", "starred_url": "https://api.github.com/users/Freizello/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Freizello/subscriptions", "organizations_url": "https://api.github.com/users/Freizello/orgs", "repos_url": "https://api.github.com/users/Freizello/repos", "events_url": "https://api.github.com/users/Freizello/events{/privacy}", "received_events_url": "https://api.github.com/users/Freizello/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-02T17:43:52Z", "updated_at": "2019-10-10T20:25:14Z", "closed_at": "2019-10-10T20:25:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n- Python: 3.6.* 64-bit\r\n- pyodbc: 4.0.26\r\n- OS: Windows 10\r\n- DB:  Hadoop with HiveQL\r\n- driver: DSN Cloudera Hive Driver\r\n\r\n### Question\r\n\r\nHi, i need to duplicate hive database structure to local mariadb/mysql database with this code to get column name and data type:\r\n`for row in cursor.columns(schema='schemaname, table='tablename'):`\r\n`    print([row.column_name, row.data_type])`\r\n\r\nand the result is :\r\n`['col1', 12]\r\n['col2', 12]\r\n['col3', 91]\r\n['col4', 91]\r\n['col5', 91]\r\n['col6', 4]\r\n...\r\n['col_n', 12]`\r\n\r\nmy expectation is, to get at least column name and datatype for inserting to sql query something like this:\r\n`CREATE TABLE IF NOT EXISTS tasks (\r\ntask_id INT AUTO_INCREMENT,\r\ntitle VARCHAR(255) NOT NULL,\r\nstart_date DATE,\r\ndue_date DATE,\r\nstatus TINYINT NOT NULL,\r\npriority TINYINT NOT NULL,\r\ndescription TEXT,\r\nPRIMARY KEY (task_id)\r\n) ENGINE=INNODB; `\r\n\r\nmay you explain how make it works? or there are another method that i didn't know yet?\r\n\r\nI appreciate your help. \ud83d\ude04 ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/596", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/596/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/596/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/596/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/596", "id": 473593638, "node_id": "MDU6SXNzdWU0NzM1OTM2Mzg=", "number": 596, "title": "Type mismatch for None/NULL value in a cell in a table-valued parameter.", "user": {"login": "mhmurray", "id": 2307763, "node_id": "MDQ6VXNlcjIzMDc3NjM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2307763?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mhmurray", "html_url": "https://github.com/mhmurray", "followers_url": "https://api.github.com/users/mhmurray/followers", "following_url": "https://api.github.com/users/mhmurray/following{/other_user}", "gists_url": "https://api.github.com/users/mhmurray/gists{/gist_id}", "starred_url": "https://api.github.com/users/mhmurray/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mhmurray/subscriptions", "organizations_url": "https://api.github.com/users/mhmurray/orgs", "repos_url": "https://api.github.com/users/mhmurray/repos", "events_url": "https://api.github.com/users/mhmurray/events{/privacy}", "received_events_url": "https://api.github.com/users/mhmurray/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-07-27T03:32:23Z", "updated_at": "2019-12-21T18:54:20Z", "closed_at": "2019-12-21T18:54:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "# Sys info\r\n- python:  3.6.1 |Anaconda custom (64-bit)| (default, May 11 2017, 13:09:58)\r\n[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]\r\n- pyodbc:  4.0.26 [...]/lib/python3.6/site-packages/pyodbc.cpython-36m-x86_64-linux-gnu.so\r\n- odbc:    03.52\r\n\r\n\r\n- driver:  libmsodbcsql-17.3.so.1.1 17.03.0001\r\n         supports ODBC version 03.52\r\n- os:      Ubuntu 16.04\r\n- DB: Azure SQL Server\r\n\r\n\r\n# Issue\r\nWhen using a table-valued parameter (TVP) for a simple stored procedure that echos the input, `None` values in the TVP cells cause a pyodbc error because of a type mismatch with the parameter in the previous row.\r\n\r\nStored procedure:\r\n`CREATE PROCEDURE TestSelectTVP @TVP TVPType READONLY AS SELECT * FROM @TVP;`\r\n\r\nTVP Type:\r\n`CREATE TYPE TVPType AS TABLE(c01 BIGINT, c02 BIGINT)`\r\n\r\nCall the SP:\r\n```\r\nparam_array = [\r\n        [1, 0],\r\n        [None, 1],\r\n        ]\r\ncursor.execute(\"EXEC TestSelectTVP ?\", [param_array])\r\n```\r\n\r\n## Expected\r\nReturned values:\r\n```\r\nc0   | c1\r\n-----|-----\r\n1    | 0\r\nNULL | 1\r\n```\r\n\r\n## Observed\r\nException raised:\r\n```\r\nTraceback (most recent call last):\r\n  File \"test_pyodbc.py\", line 144, in <module>\r\n    main()\r\n  File \"test_pyodbc.py\", line 139, in main\r\n    run_tvp(conn)\r\n  File \"test_pyodbc.py\", line 103, in run_tvp\r\n    cursor.execute(\"EXEC TestSelectTVP ?\", [param_array])\r\npyodbc.ProgrammingError: ('Type mismatch between TVP row values', 'HY000')\r\n```\r\nIf None/NULL is in the first row, there is a different exception:\r\n`pyodbc.Error: ('HY090', '[HY090] [unixODBC][Driver Manager]Invalid string or buffer length (0) (SQLBindParameter)')`\r\n\r\n\r\n## Other info\r\n\r\nThe exception is raised here:\r\nhttps://github.com/mkleehammer/pyodbc/blob/4.0.26/src/cursor.cpp#L766\r\n\r\nDoesn't this type check require non-NULL data, since it's testing strict type equality?\r\n\r\n\r\n# Script to reproduce:\r\n```\r\nimport pyodbc\r\nimport sys\r\nimport os\r\nimport platform\r\n\r\n\r\nCONNECTION_STR=''\r\n\r\ndef reset_tvp(conn):\r\n    \"\"\"\r\n    Reset stored procedures and table types associated with the TVP method.\r\n    \"\"\"\r\n    try:\r\n        conn.execute(\"DROP PROCEDURE TestSelectTVP\")\r\n    except:\r\n        pass\r\n\r\n    try:\r\n        conn.execute(\"DROP TYPE TVPType\")\r\n    except:\r\n        pass\r\n\r\n\r\n\r\ndef run_tvp(conn):\r\n    conn.execute(\"DROP TYPE IF EXISTS TVPType\")\r\n    cursor = conn.cursor()\r\n\r\n    query = (\r\n            \"CREATE TYPE TVPType AS TABLE(\"\r\n            \"c01 BIGINT,\"\r\n            \"c02 BIGINT)\"\r\n            )\r\n\r\n    conn.execute(query)\r\n    conn.commit()\r\n    conn.execute(\"CREATE PROCEDURE TestSelectTVP @TVP TVPType READONLY AS SELECT * FROM @TVP;\")\r\n    conn.commit()\r\n\r\n    # NULL doesn't match parameter type or value type of previous row.\r\n    param_array = [\r\n            [1, 0],\r\n            [None, 1],\r\n            ]\r\n\r\n    # Initial NULL causes \"Invalid string or buffer length (0) (SQLBindParameter)\"\r\n    param_array_initial_null = [\r\n            [None, 1],\r\n            ]\r\n\r\n    cursor.execute(\"EXEC TestSelectTVP ?\", [param_array])\r\n    # cursor.execute(\"EXEC TestSelectTVP ?\", [param_array_initial_null])\r\n    conn.commit()\r\n\r\n\r\ndef print_library_info(cnxn):\r\n    # from pyodbc.tests2.testutils.py\r\n    print('python:  %s' % sys.version)\r\n    print('pyodbc:  %s %s' % (pyodbc.version, os.path.abspath(pyodbc.__file__)))\r\n    print('odbc:    %s' % cnxn.getinfo(pyodbc.SQL_ODBC_VER))\r\n    print('driver:  %s %s' % (cnxn.getinfo(pyodbc.SQL_DRIVER_NAME), cnxn.getinfo(pyodbc.SQL_DRIVER_VER)))\r\n    print('         supports ODBC version %s' % cnxn.getinfo(pyodbc.SQL_DRIVER_ODBC_VER))\r\n    print('os:      %s' % platform.system())\r\n    print('unicode: Py_Unicode=%s SQLWCHAR=%s' % (pyodbc.UNICODE_SIZE, pyodbc.SQLWCHAR_SIZE))\r\n\r\n    cursor = cnxn.cursor()\r\n    for typename in ['VARCHAR', 'WVARCHAR', 'BINARY']:\r\n        t = getattr(pyodbc, 'SQL_' + typename)\r\n        cursor.getTypeInfo(t)\r\n        row = cursor.fetchone()\r\n        print('Max %s = %s' % (typename, row and row[2] or '(not supported)'))\r\n\r\n    if platform.system() == 'Windows':\r\n        print('         %s' % ' '.join([s for s in platform.win32_ver() if s]))\r\n\r\n\r\ndef main():\r\n    conn = pyodbc.connect(CONNECTION_STR)\r\n    print_library_info(conn)\r\n    conn.close()\r\n\r\n    conn = pyodbc.connect(CONNECTION_STR)\r\n    \r\n    reset_tvp(conn)\r\n    run_tvp(conn)\r\n\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/594", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/594/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/594/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/594/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/594", "id": 472264793, "node_id": "MDU6SXNzdWU0NzIyNjQ3OTM=", "number": 594, "title": "pyodbc.Error mangled with unicode characters", "user": {"login": "p-vernaeckt", "id": 4655239, "node_id": "MDQ6VXNlcjQ2NTUyMzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4655239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-vernaeckt", "html_url": "https://github.com/p-vernaeckt", "followers_url": "https://api.github.com/users/p-vernaeckt/followers", "following_url": "https://api.github.com/users/p-vernaeckt/following{/other_user}", "gists_url": "https://api.github.com/users/p-vernaeckt/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-vernaeckt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-vernaeckt/subscriptions", "organizations_url": "https://api.github.com/users/p-vernaeckt/orgs", "repos_url": "https://api.github.com/users/p-vernaeckt/repos", "events_url": "https://api.github.com/users/p-vernaeckt/events{/privacy}", "received_events_url": "https://api.github.com/users/p-vernaeckt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-07-24T12:49:37Z", "updated_at": "2019-07-25T07:24:07Z", "closed_at": "2019-07-25T07:24:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "environment:\r\n- Windows 10\r\n- Python 3.7.3\r\n- Database: Filemaker\r\n- Driver: Filemaker ODBC driver\r\n\r\nHere is the piece of code that causes the issue:\r\n```\r\n    try:\r\n        fmsConnector = pyodbc.connect(fmsConnectionString)\r\n    except pyodbc.Error as e:\r\n        error = str(e)\r\n        print (error)\r\n```\r\n\r\nThe the connect fails, it returns a string completely mangled with unicode characters, UTF16 I guess:\r\n\r\n```\r\npyodbc.InterfaceError: ('28000', '[28000] [FileMaker][FileMaker]  (212): Invalid account/password\\x00\\u75c0*\\u75c0*\\u33e4*\\x1f\\x00\\u6029\\u4ed6\\uf278\\u011e\\u65aa\\u669b\\u4ae0+\\u75c0*\\u6029\\u4ed6\\uf270\\u011e\\x00\\x00\\x00\\x00\\u36a8\\x1b\\x00\\x00\\x01\\x00\\x1f\\x00\\x01\\x00\\uf28c\\u011e\\uf290\\u011e\\u351a\\u669e\\x06\\x00\\ub0201\\uf2b8\\u011e\\ua975\\u66a0\\x00\\x00\\x1f\\x00 (212) (SQLDriverConnect); [28000] [FileMaker][FileMaker]  (212): Invalid account/password\\x00\\u75c0*\\u75c0*\\u33e4*\\x1f\\x00\\u6029\\u4ed6\\uf278\\u011e\\u65aa\\u669b\\u4ae0+\\u75c0*\\u6029\\u4ed6\\uf270\\u011e\\x00\\x00\\x00\\x00\\u36a8\\x1b\\x00\\x00\\x01\\x00\\x1f\\x00\\x01\\x00\\uf28c\\u011e\\uf290\\u011e\\u351a\\u669e\\x06\\x00\\ub0201\\uf2b8\\u011e\\ua975\\u66a0\\x00\\x00\\x1f\\x00 (212)')\r\n``` \r\n\r\nNote: I use\r\n```\r\n        fmsConnector.setdecoding(pyodbc.SQL_CHAR, encoding='utf-8')\r\n        fmsConnector.setdecoding(pyodbc.SQL_WCHAR, encoding='utf-8')\r\n        fmsConnector.setdecoding(pyodbc.SQL_WMETADATA, encoding='utf-16')\r\n        fmsConnector.setencoding(encoding='utf-8')\r\n```\r\n\r\nbut right after that, no luck :(", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/593", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/593/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/593/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/593/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/593", "id": 471745567, "node_id": "MDU6SXNzdWU0NzE3NDU1Njc=", "number": 593, "title": "pip install errrors out on ld_so_aix", "user": {"login": "Justin-E-Taylor", "id": 23110763, "node_id": "MDQ6VXNlcjIzMTEwNzYz", "avatar_url": "https://avatars0.githubusercontent.com/u/23110763?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Justin-E-Taylor", "html_url": "https://github.com/Justin-E-Taylor", "followers_url": "https://api.github.com/users/Justin-E-Taylor/followers", "following_url": "https://api.github.com/users/Justin-E-Taylor/following{/other_user}", "gists_url": "https://api.github.com/users/Justin-E-Taylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/Justin-E-Taylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Justin-E-Taylor/subscriptions", "organizations_url": "https://api.github.com/users/Justin-E-Taylor/orgs", "repos_url": "https://api.github.com/users/Justin-E-Taylor/repos", "events_url": "https://api.github.com/users/Justin-E-Taylor/events{/privacy}", "received_events_url": "https://api.github.com/users/Justin-E-Taylor/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-07-23T14:53:04Z", "updated_at": "2020-06-19T12:54:05Z", "closed_at": "2019-07-23T20:50:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\nAIX\r\nPython 3.6\r\ngcc.bin (GCC) 6.3.0\r\n\r\n### Issue\r\nI'm trying to do a pip install, but it fails with \"error: command '/QOpenSys/pkgs/lib/python3.6/config-3.6m/ld_so_aix' failed with exit status 1\".  \r\n\r\nHere's the entire output:\r\n```\r\nCollecting pyodbc\r\n  Using cached https://files.pythonhosted.org/packages/b4/41/f3eb5e56af207a8fcc02f1f84cc3fed9fcf315565e65f418ae815e399929/pyodbc-4.0.26.tar.gz\r\nBuilding wheels for collected packages: pyodbc\r\n  Building wheel for pyodbc (setup.py): started\r\n  Building wheel for pyodbc (setup.py): finished with status 'error'\r\n  ERROR: Complete output from command /home/JUSTIN/src/Python3/env/bin/python3 -u -c 'import setuptools, tokenize;__file__='\"'\"'/tmp/pip-install-je5vz5si/pyodbc/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' bdist_wheel -d /tmp/pip-wheel-l2n03hym --python-tag cp36:\r\n  ERROR: running bdist_wheel\r\n  running build\r\n  running build_ext\r\n  building 'pyodbc' extension\r\n  creating build\r\n  creating build/temp.os400-powerpc64-3.6\r\n  creating build/temp.os400-powerpc64-3.6/src\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/buffer.cpp -o build/temp.os400-powerpc64-3.6/src/buffer.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/cnxninfo.cpp -o build/temp.os400-powerpc64-3.6/src/cnxninfo.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/connection.cpp -o build/temp.os400-powerpc64-3.6/src/connection.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  src/connection.cpp: In function 'PyObject* Connection_getinfo(PyObject*, PyObject*)':\r\n  src/connection.cpp:835:40: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]\r\n           SQLUINTEGER n = *(SQLUINTEGER*)szBuffer; // Does this work on PPC or do we need a union?\r\n                                          ^~~~~~~~\r\n  src/connection.cpp:848:49: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]\r\n           result = PyInt_FromLong(*(SQLUSMALLINT*)szBuffer);\r\n                                                   ^~~~~~~~\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/cursor.cpp -o build/temp.os400-powerpc64-3.6/src/cursor.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/errors.cpp -o build/temp.os400-powerpc64-3.6/src/errors.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/getdata.cpp -o build/temp.os400-powerpc64-3.6/src/getdata.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/params.cpp -o build/temp.os400-powerpc64-3.6/src/params.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/pyodbccompat.cpp -o build/temp.os400-powerpc64-3.6/src/pyodbccompat.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/pyodbcdbg.cpp -o build/temp.os400-powerpc64-3.6/src/pyodbcdbg.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/pyodbcmodule.cpp -o build/temp.os400-powerpc64-3.6/src/pyodbcmodule.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/row.cpp -o build/temp.os400-powerpc64-3.6/src/row.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/textenc.cpp -o build/temp.os400-powerpc64-3.6/src/textenc.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n  creating build/lib.os400-powerpc64-3.6\r\n  /QOpenSys/pkgs/lib/python3.6/config-3.6m/ld_so_aix g++ -pthread -pthread -bI:/QOpenSys/pkgs/lib/python3.6/config-3.6m/python.exp -Wl,-blibpath:/QOpenSys/pkgs/lib:/QOpenSys/usr/lib build/temp.os400-powerpc64-3.6/src/buffer.o build/temp.os400-powerpc64-3.6/src/cnxninfo.o build/temp.os400-powerpc64-3.6/src/connection.o build/temp.os400-powerpc64-3.6/src/cursor.o build/temp.os400-powerpc64-3.6/src/errors.o build/temp.os400-powerpc64-3.6/src/getdata.o build/temp.os400-powerpc64-3.6/src/params.o build/temp.os400-powerpc64-3.6/src/pyodbccompat.o build/temp.os400-powerpc64-3.6/src/pyodbcdbg.o build/temp.os400-powerpc64-3.6/src/pyodbcmodule.o build/temp.os400-powerpc64-3.6/src/row.o build/temp.os400-powerpc64-3.6/src/textenc.o -L/usr/lib -L/usr/local/lib -L/QOpenSys/pkgs/lib -lodbc -o build/lib.os400-powerpc64-3.6/pyodbc.so -L/QOpenSys/pkgs/lib -lodbc\r\n  ld: 0711-317 ERROR: Undefined symbol: __gxx_personality_v0\r\n  ld: 0711-317 ERROR: Undefined symbol: ._Unwind_Resume\r\n  ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more information.\r\n  collect2: error: ld returned 8 exit status\r\n  error: command '/QOpenSys/pkgs/lib/python3.6/config-3.6m/ld_so_aix' failed with exit status 1\r\n  ----------------------------------------\r\n  ERROR: Failed building wheel for pyodbc\r\n  Running setup.py clean for pyodbc\r\nFailed to build pyodbc\r\nInstalling collected packages: pyodbc\r\n  Running setup.py install for pyodbc: started\r\n    Running setup.py install for pyodbc: finished with status 'error'\r\n    ERROR: Complete output from command /home/JUSTIN/src/Python3/env/bin/python3 -u -c 'import setuptools, tokenize;__file__='\"'\"'/tmp/pip-install-je5vz5si/pyodbc/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /tmp/pip-record-5ovlan8u/install-record.txt --single-version-externally-managed --compile --install-headers /home/JUSTIN/src/Python3/env/include/site/python3.6/pyodbc:\r\n    ERROR: running install\r\n    running build\r\n    running build_ext\r\n    building 'pyodbc' extension\r\n    creating build\r\n    creating build/temp.os400-powerpc64-3.6\r\n    creating build/temp.os400-powerpc64-3.6/src\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/buffer.cpp -o build/temp.os400-powerpc64-3.6/src/buffer.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/cnxninfo.cpp -o build/temp.os400-powerpc64-3.6/src/cnxninfo.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/connection.cpp -o build/temp.os400-powerpc64-3.6/src/connection.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    src/connection.cpp: In function 'PyObject* Connection_getinfo(PyObject*, PyObject*)':\r\n    src/connection.cpp:835:40: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]\r\n             SQLUINTEGER n = *(SQLUINTEGER*)szBuffer; // Does this work on PPC or do we need a union?\r\n                                            ^~~~~~~~\r\n    src/connection.cpp:848:49: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]\r\n             result = PyInt_FromLong(*(SQLUSMALLINT*)szBuffer);\r\n                                                     ^~~~~~~~\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/cursor.cpp -o build/temp.os400-powerpc64-3.6/src/cursor.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/errors.cpp -o build/temp.os400-powerpc64-3.6/src/errors.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/getdata.cpp -o build/temp.os400-powerpc64-3.6/src/getdata.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/params.cpp -o build/temp.os400-powerpc64-3.6/src/params.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/pyodbccompat.cpp -o build/temp.os400-powerpc64-3.6/src/pyodbccompat.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/pyodbcdbg.cpp -o build/temp.os400-powerpc64-3.6/src/pyodbcdbg.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/pyodbcmodule.cpp -o build/temp.os400-powerpc64-3.6/src/pyodbcmodule.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/row.cpp -o build/temp.os400-powerpc64-3.6/src/row.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -O2 -g -maix64 -O2 -g -maix64 -DPYODBC_VERSION=4.0.26 -I/QOpenSys/pkgs/include/python3.6m -c src/textenc.cpp -o build/temp.os400-powerpc64-3.6/src/textenc.o -Wno-write-strings -DHAVE_UNISTD_H -DHAVE_PWD_H -DHAVE_SYS_TYPES_H -DHAVE_LONG_LONG -DSIZEOF_LONG_INT=8 -I/QOpenSys/pkgs/include\r\n    creating build/lib.os400-powerpc64-3.6\r\n    /QOpenSys/pkgs/lib/python3.6/config-3.6m/ld_so_aix g++ -pthread -pthread -bI:/QOpenSys/pkgs/lib/python3.6/config-3.6m/python.exp -Wl,-blibpath:/QOpenSys/pkgs/lib:/QOpenSys/usr/lib build/temp.os400-powerpc64-3.6/src/buffer.o build/temp.os400-powerpc64-3.6/src/cnxninfo.o build/temp.os400-powerpc64-3.6/src/connection.o build/temp.os400-powerpc64-3.6/src/cursor.o build/temp.os400-powerpc64-3.6/src/errors.o build/temp.os400-powerpc64-3.6/src/getdata.o build/temp.os400-powerpc64-3.6/src/params.o build/temp.os400-powerpc64-3.6/src/pyodbccompat.o build/temp.os400-powerpc64-3.6/src/pyodbcdbg.o build/temp.os400-powerpc64-3.6/src/pyodbcmodule.o build/temp.os400-powerpc64-3.6/src/row.o build/temp.os400-powerpc64-3.6/src/textenc.o -L/usr/lib -L/usr/local/lib -L/QOpenSys/pkgs/lib -lodbc -o build/lib.os400-powerpc64-3.6/pyodbc.so -L/QOpenSys/pkgs/lib -lodbc\r\n    ld: 0711-317 ERROR: Undefined symbol: __gxx_personality_v0\r\n    ld: 0711-317 ERROR: Undefined symbol: ._Unwind_Resume\r\n    ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more information.\r\n    collect2: error: ld returned 8 exit status\r\n    error: command '/QOpenSys/pkgs/lib/python3.6/config-3.6m/ld_so_aix' failed with exit status 1\r\n    ----------------------------------------\r\nERROR: Command \"/home/JUSTIN/src/Python3/env/bin/python3 -u -c 'import setuptools, tokenize;__file__='\"'\"'/tmp/pip-install-je5vz5si/pyodbc/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record /tmp/pip-record-5ovlan8u/install-record.txt --single-version-externally-managed --compile --install-headers /home/JUSTIN/src/Python3/env/include/site/python3.6/pyodbc\" failed with error code 1 in /tmp/pip-install-je5vz5si/pyodbc/\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/592", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/592/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/592/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/592/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/592", "id": 471258126, "node_id": "MDU6SXNzdWU0NzEyNTgxMjY=", "number": 592, "title": "ImportError: DLL load failed: The specified module could not be found.", "user": {"login": "sameer-kumar", "id": 3660733, "node_id": "MDQ6VXNlcjM2NjA3MzM=", "avatar_url": "https://avatars3.githubusercontent.com/u/3660733?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sameer-kumar", "html_url": "https://github.com/sameer-kumar", "followers_url": "https://api.github.com/users/sameer-kumar/followers", "following_url": "https://api.github.com/users/sameer-kumar/following{/other_user}", "gists_url": "https://api.github.com/users/sameer-kumar/gists{/gist_id}", "starred_url": "https://api.github.com/users/sameer-kumar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sameer-kumar/subscriptions", "organizations_url": "https://api.github.com/users/sameer-kumar/orgs", "repos_url": "https://api.github.com/users/sameer-kumar/repos", "events_url": "https://api.github.com/users/sameer-kumar/events{/privacy}", "received_events_url": "https://api.github.com/users/sameer-kumar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2019-07-22T18:54:34Z", "updated_at": "2019-07-31T02:31:51Z", "closed_at": "2019-07-31T02:31:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm getting this error when I try to run a MSsql query in my python file:\r\n**_ImportError: DLL load failed: The specified module could not be found._**\r\n\r\nI'm running a python file in a windows nano 2019 docker container. \r\nI've pip installed pyodbc and SQLAlchemy in my docker image.\r\nThis is complete trace:\r\n\r\n> Traceback (most recent call last):\r\n>   File \"./getSqlData.py\", line 16, in <module>\r\n>     db = create_engine('mssql+pyodbc:///?odbc_connect=%s' % params, fast_executemany=True)\r\n>   File \"c:\\Python\\AppPackages\\sqlalchemy\\engine\\__init__.py\", line 435, in create_engine\r\n>     return strategy.create(*args, **kwargs)\r\n>   File \"c:\\Python\\AppPackages\\sqlalchemy\\engine\\strategies.py\", line 87, in create\r\n>     dbapi = dialect_cls.dbapi(**dbapi_args)\r\n>   File \"c:\\Python\\AppPackages\\sqlalchemy\\connectors\\pyodbc.py\", line 37, in dbapi\r\n>     return __import__(\"pyodbc\")\r\n> ImportError: DLL load failed: The specified module could not be found.\r\n\r\nEnvironment:\r\nWindows Nano 2019 docker container.\r\nPython: 3.6.8\r\nPyOdbc: 4.0.26\r\nSqlAlchemy: 1.3.6\r\n\r\n\r\nAm I the only one getting this?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/591", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/591/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/591/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/591/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/591", "id": 469929019, "node_id": "MDU6SXNzdWU0Njk5MjkwMTk=", "number": 591, "title": "pyodbc using stored procedure + result not binding", "user": {"login": "jaganrajagopalme", "id": 10576681, "node_id": "MDQ6VXNlcjEwNTc2Njgx", "avatar_url": "https://avatars2.githubusercontent.com/u/10576681?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaganrajagopalme", "html_url": "https://github.com/jaganrajagopalme", "followers_url": "https://api.github.com/users/jaganrajagopalme/followers", "following_url": "https://api.github.com/users/jaganrajagopalme/following{/other_user}", "gists_url": "https://api.github.com/users/jaganrajagopalme/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaganrajagopalme/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaganrajagopalme/subscriptions", "organizations_url": "https://api.github.com/users/jaganrajagopalme/orgs", "repos_url": "https://api.github.com/users/jaganrajagopalme/repos", "events_url": "https://api.github.com/users/jaganrajagopalme/events{/privacy}", "received_events_url": "https://api.github.com/users/jaganrajagopalme/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-18T18:42:00Z", "updated_at": "2019-07-31T02:32:03Z", "closed_at": "2019-07-31T02:32:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.6\r\n- pyodbc: latest version\r\n- OS: window 10\r\n- DB:MS-Sql server 2017\r\n- driver:\r\n\r\n### Issue\r\n\r\nPlease find my sample code as attachment and throwing error at \r\n\r\ncursor = conn.cursor()\r\nparam=(myfile)\r\ncursor.execute(\"{CALL dbo.test_for_pyodbc(?)}\", param)\r\nrows = cursor.fetchall() - > at this point ->throwing error message as \r\nTraceback (most recent call last):\r\n  File \"D:/Projects/Python POC code/working_PythonPOC.py\", line 33, in <module>\r\n    rows = cursor.fetchall()\r\npyodbc.ProgrammingError: No results.  Previous SQL was not a query.\r\n\r\nCould please help out it \r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/590", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/590/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/590/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/590/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/590", "id": 469770226, "node_id": "MDU6SXNzdWU0Njk3NzAyMjY=", "number": 590, "title": "Inserting into SQL server fast_executemany = false works and inserts data, with it as true it returns an error code: ", "user": {"login": "jwhaley5", "id": 8749844, "node_id": "MDQ6VXNlcjg3NDk4NDQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/8749844?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwhaley5", "html_url": "https://github.com/jwhaley5", "followers_url": "https://api.github.com/users/jwhaley5/followers", "following_url": "https://api.github.com/users/jwhaley5/following{/other_user}", "gists_url": "https://api.github.com/users/jwhaley5/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwhaley5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwhaley5/subscriptions", "organizations_url": "https://api.github.com/users/jwhaley5/orgs", "repos_url": "https://api.github.com/users/jwhaley5/repos", "events_url": "https://api.github.com/users/jwhaley5/events{/privacy}", "received_events_url": "https://api.github.com/users/jwhaley5/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-07-18T13:29:01Z", "updated_at": "2019-07-24T18:35:04Z", "closed_at": "2019-07-24T18:35:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "I Looked through the other issues and mine seems to be unique enough to start another issue.\r\n \r\n##Environment\r\n\r\n- Python: 64-bit \r\n- pyodbc: 4.0.26\r\n- OS: Windows\r\n- DB: MS SQL Server Studio 17\r\n- driver: SQL Server\r\n\r\n*As a precursor, my project has 216 columns and roughly 1.8 Million rows. I have been building and testing my information table with a subset of 2000 rows.\r\n\r\nIn my program everything works fine with fast_executemany = False except for the fact that it is really slow to the point of being unusable. I was hoping to try fast_executemany = True to see if that greatly improved the speed of the upload. However I can't get around this error message because I'm not entirely sure what it means or which value it is complaining about so it is hard to debug.\r\n\r\nIs there an easy fix or reason behind why fast_executemany = True won't work for my program. For example I saw some issues people with empty strings being passed and None values. Are these allowed if fast_executemany = False but not if its true?\r\n\r\nHere is my Error:\r\npyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC SQL Server Driver]Invalid character value for cast specification (0) (SQLExecute)')\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/589", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/589/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/589/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/589/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/589", "id": 469651659, "node_id": "MDU6SXNzdWU0Njk2NTE2NTk=", "number": 589, "title": "cur.execute(\"insert into {} SELECT * FROM{}\") python, sql", "user": {"login": "hengorin", "id": 33528545, "node_id": "MDQ6VXNlcjMzNTI4NTQ1", "avatar_url": "https://avatars3.githubusercontent.com/u/33528545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hengorin", "html_url": "https://github.com/hengorin", "followers_url": "https://api.github.com/users/hengorin/followers", "following_url": "https://api.github.com/users/hengorin/following{/other_user}", "gists_url": "https://api.github.com/users/hengorin/gists{/gist_id}", "starred_url": "https://api.github.com/users/hengorin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hengorin/subscriptions", "organizations_url": "https://api.github.com/users/hengorin/orgs", "repos_url": "https://api.github.com/users/hengorin/repos", "events_url": "https://api.github.com/users/hengorin/events{/privacy}", "received_events_url": "https://api.github.com/users/hengorin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-07-18T09:01:29Z", "updated_at": "2019-07-31T02:32:46Z", "closed_at": "2019-07-31T02:32:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nI am trying to run cur.execute(\"insert into {} SELECT * FROM{}\") \r\nbut it is not insert any data\r\ndo you now how should I fix it?\r\nthanks\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/588", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/588/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/588/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/588/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/588", "id": 469647184, "node_id": "MDU6SXNzdWU0Njk2NDcxODQ=", "number": 588, "title": "Insert statement in PYODBC that contains semi-colon mistakenly throws programming error", "user": {"login": "PaulRedmond94", "id": 15419998, "node_id": "MDQ6VXNlcjE1NDE5OTk4", "avatar_url": "https://avatars1.githubusercontent.com/u/15419998?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PaulRedmond94", "html_url": "https://github.com/PaulRedmond94", "followers_url": "https://api.github.com/users/PaulRedmond94/followers", "following_url": "https://api.github.com/users/PaulRedmond94/following{/other_user}", "gists_url": "https://api.github.com/users/PaulRedmond94/gists{/gist_id}", "starred_url": "https://api.github.com/users/PaulRedmond94/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PaulRedmond94/subscriptions", "organizations_url": "https://api.github.com/users/PaulRedmond94/orgs", "repos_url": "https://api.github.com/users/PaulRedmond94/repos", "events_url": "https://api.github.com/users/PaulRedmond94/events{/privacy}", "received_events_url": "https://api.github.com/users/PaulRedmond94/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-18T08:52:06Z", "updated_at": "2019-07-19T08:47:55Z", "closed_at": "2019-07-19T08:40:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7.3 (64 bit)\r\n- pyodbc: 4.0.26\r\n- OS: Windows\r\n- DB: MS Sql Server\r\n- Driver: ODBC Driver 13 for SQL Server\r\n\r\n\r\n### Issue\r\n\r\nExpected Behaviour:\r\nInserting row with a varchar string that contains a semi colon should insert normally\r\n\r\nObserved Behaviour:\r\nRow that is being inserted terminates when it encounters a semi colon even if it is inside a string\r\n\r\nExample of insert statement;\r\nINSERT INTO [MyDb].[MyTable] ([id], [name], [errorexample]) VALUES('1', 'Rest-Test', 'kjkjsdfsd;asdasjk');\r\n\r\nI have error handling in my python code to catch Programming and Integrity errors if they occur and this particular line is throwing a programming error. When I copy the problematic line and run it directly into SSMS it runs fine. When Pyodbc gets to the problematic line, it reads up to the first semi colon, crashes, then tries to read the remaining value as its own command (\"asdasjk');\" in this particular case. \r\n\r\nOutside of this particular error, the script seems to run fine for the few hundred thousand records that I have in my .sql files\r\n\r\nSpecifically, when I print the error to my log file it says:\r\n\"Unclosed quotation mark after the character string 'kjkjsdfsd'. (105) (SQLExecDirectW); [42000] [Microsoft] [ODBC Driver 13 for SQL Server] [SQL Server] Incorrect Syntax near 'kjkjsdfsd;. (102)\r\n\r\nPython code that executes line;\r\n\r\nfor line in sql_inserts:\r\n&nbsp;&nbsp;&nbsp;&nbsp;if line != \"\":\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(\"Executing {0}\".format(line))\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sql_cursor = sql_serv_connection.cursor()\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sql_cursor.execute(line)\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/587", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/587/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/587/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/587/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/587", "id": 469561058, "node_id": "MDU6SXNzdWU0Njk1NjEwNTg=", "number": 587, "title": "Pyodbc is not working with stored procedure via Mssql server", "user": {"login": "jaganrajagopalme", "id": 10576681, "node_id": "MDQ6VXNlcjEwNTc2Njgx", "avatar_url": "https://avatars2.githubusercontent.com/u/10576681?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaganrajagopalme", "html_url": "https://github.com/jaganrajagopalme", "followers_url": "https://api.github.com/users/jaganrajagopalme/followers", "following_url": "https://api.github.com/users/jaganrajagopalme/following{/other_user}", "gists_url": "https://api.github.com/users/jaganrajagopalme/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaganrajagopalme/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaganrajagopalme/subscriptions", "organizations_url": "https://api.github.com/users/jaganrajagopalme/orgs", "repos_url": "https://api.github.com/users/jaganrajagopalme/repos", "events_url": "https://api.github.com/users/jaganrajagopalme/events{/privacy}", "received_events_url": "https://api.github.com/users/jaganrajagopalme/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-07-18T04:06:51Z", "updated_at": "2019-07-31T02:33:54Z", "closed_at": "2019-07-31T02:33:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: Python 3.7.4 \r\n- pyodbc: pyodbc 4.0.26\r\n- OS: Window 10\r\n- DB: Sql server 2016\r\n- driver:\r\n\r\n### Issue\r\n\r\nPlease first make sure you have looked at:\r\n\r\n* Documentation: https://github.com/mkleehammer/pyodbc/wiki\r\n* Other issues\r\n\r\n### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: Python 3.7.4 \r\n- pyodbc: pyodbc 4.0.26\r\n- OS: Window 10\r\n- DB: Sql server 2016\r\n- driver:\r\n\r\n### Issue\r\n\r\nBasically, i am fetching the data from ms-sql via pyodc by using stored procedure with passing input parameter , but the record count always show as -1.\r\nPlease find the code as mention in below\r\n\r\nimport os.path\r\nimport pathlib\r\nimport pyodbc as db\r\nfolder=os.listdir(r'D:\\\\Projects\\\\rop source')\r\n#\\\\tlstack\\ALCSReports\\Ajay\\rops jagan\r\n#db connection string -MICRASQL01 - Production\r\nconn = db.connect(\"Driver={SQL Server Native Client 11.0};\"\r\n                     \"Server=DEV-SERVER;\"\r\n                     \"Database=DBApps;\"\r\n                    \"Trusted_Connection=yes;\")\r\n\r\n\r\n \r\nfor myfile in folder:\r\n    extension=myfile.split(\".\")[-1]\r\n    empno=myfile.split(\"-\")[0]\r\n    documentName=myfile.split(\"-\")[-1]\r\n    filename=myfile.split(\".\")[0]\r\n    #show the file name \r\n    #print(myfile)\r\n    #show the file name without extension\r\n    print (myfile)\r\n    #show the file extension\r\n    #print (extension)\r\n    #call the stored prcodure https://github.com/mkleehammer/pyodbc/wiki/Calling-Stored-Procedures\r\n    #params = (filename)\r\n    #fileList.append(filename)\r\n    cursor = conn.cursor()\r\n    param=(myfile)\r\n    \r\n    \r\n    cursor.execute(\"{CALL get_employee(?)}\", param)\r\n    cursor.commit()\r\n    ##print (sql)\r\n    \r\n    #cursor.execute(sql)\r\n   # print (cursor.fetchval())\r\n    print (cursor.rowcount)\r\n\r\n    for row in cursor.fetchall():\r\n         print (\"row:\", row[0])\r\n         print (\"rowcount:\", cursor.rowcount)\r\n\r\n         \r\ncursor.close()\r\nconn.close()\r\n\r\nRegards\r\nJagan\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/584", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/584/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/584/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/584/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/584", "id": 467766193, "node_id": "MDU6SXNzdWU0Njc3NjYxOTM=", "number": 584, "title": "PyODBC Driver Not working on MacOS", "user": {"login": "ss3456", "id": 23143397, "node_id": "MDQ6VXNlcjIzMTQzMzk3", "avatar_url": "https://avatars2.githubusercontent.com/u/23143397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ss3456", "html_url": "https://github.com/ss3456", "followers_url": "https://api.github.com/users/ss3456/followers", "following_url": "https://api.github.com/users/ss3456/following{/other_user}", "gists_url": "https://api.github.com/users/ss3456/gists{/gist_id}", "starred_url": "https://api.github.com/users/ss3456/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ss3456/subscriptions", "organizations_url": "https://api.github.com/users/ss3456/orgs", "repos_url": "https://api.github.com/users/ss3456/repos", "events_url": "https://api.github.com/users/ss3456/events{/privacy}", "received_events_url": "https://api.github.com/users/ss3456/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-13T21:04:14Z", "updated_at": "2019-07-31T03:13:40Z", "closed_at": "2019-07-31T03:13:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI managed to install pyodbc by doing a pip install, and am trying to use it with a MySQL server, but I think I need to install the driver first.\r\n\r\nI've downloaded the MacOS DMG file from https://dev.mysql.com/downloads/connector/odbc/ \r\n\r\nEvery time I run a pyodbc.connect command in python, I get this error:\r\nError: ('01000', \"[01000] [unixODBC][Driver Manager]Can't open lib 'MySQL ODBC 8.0 Driver' : file not found (0) (SQLDriverConnect)\")\r\n\r\nThe driver won't install properly either. I have tried using the compress tar files and this doesn't work either\r\n<img width=\"617\" alt=\"Screen Shot 2019-07-13 at 22 01 53\" src=\"https://user-images.githubusercontent.com/23143397/61176510-005b6300-a5ba-11e9-8a16-be961b41f614.png\">\r\n\r\nPlease can someone recommend what to do about this, and if I need the driver or not? Any help is much appreciated. I'm very new to MySQL and Pyodbc \ud83d\ude00", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/582", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/582/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/582/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/582/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/582", "id": 465922889, "node_id": "MDU6SXNzdWU0NjU5MjI4ODk=", "number": 582, "title": "Column names (sometimes) improperly decoded from Db2 for i Access Client Solutions", "user": {"login": "soundstripe", "id": 1015332, "node_id": "MDQ6VXNlcjEwMTUzMzI=", "avatar_url": "https://avatars3.githubusercontent.com/u/1015332?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soundstripe", "html_url": "https://github.com/soundstripe", "followers_url": "https://api.github.com/users/soundstripe/followers", "following_url": "https://api.github.com/users/soundstripe/following{/other_user}", "gists_url": "https://api.github.com/users/soundstripe/gists{/gist_id}", "starred_url": "https://api.github.com/users/soundstripe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soundstripe/subscriptions", "organizations_url": "https://api.github.com/users/soundstripe/orgs", "repos_url": "https://api.github.com/users/soundstripe/repos", "events_url": "https://api.github.com/users/soundstripe/events{/privacy}", "received_events_url": "https://api.github.com/users/soundstripe/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-07-09T18:25:40Z", "updated_at": "2019-10-01T23:31:21Z", "closed_at": "2019-10-01T23:31:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\nTo diagnose, we usually need to know the following, including version numbers.  On Windows, be\r\nsure to specify 32-bit Python or 64-bit:\r\n\r\n- Python: 3.7.3\r\n- pyodbc: 4.0.26\r\n- OS: Debian 9.9 (docker python:3.7-slim-stretch)\r\n- DB: Db2 for i 7.2\r\n- driver: Db2 for i Access Client Solutions ODBC 64-bit (1.1.0.12-1.0.amd64.deb)\r\n- unixodbc 2.3.7 (from source)\r\n\r\n### Issue\r\n\r\nFrom the following code:\r\n    \r\n    db2_sys = 'SYSTEM=*.*.*.*;UID=*****;PWD=*****;DRIVER={iSeries Access ODBC Driver}'\r\n    q = \"SELECT 1  AS this_is_a_really_long_column_name_more_than_30_chars FROM sysibm.SYSDUMMY1\"\r\n    for _ in range(2):\r\n        with pyodbc.connect(db2_sys) as conn:\r\n            print(conn.getinfo(pyodbc.SQL_MAX_COLUMN_NAME_LEN))\r\n            c = conn.cursor()\r\n            c.execute(q)\r\n            print(list(c.description))\r\n\r\nI expected to see\r\n```\r\n    128\r\n    [('THIS_IS_A_REALLY_LONG_COLUMN_NAME_MORE_THAN_30_CHARS', <class 'int'>, None, 10, 10, 0, False)]\r\n    128\r\n    [('THIS_IS_A_REALLY_LONG_COLUMN_NAME_MORE_THAN_30_CHARS', <class 'int'>, None, 10, 10, 0, False)]\r\n```\r\n\r\nbut actually I see:\r\n```\r\n    128\r\n    [('THIS_IS_A_REALLY_LONG_COLUMN_N\\x00\\x00\u5153\u5f4c\u4544\u4353\u555f\u534e\u4749\u454eD]\\x00\\x00\u5da0\u9db4\u5605\\x00\u5db0\u9db4\u5605\\x00', <class 'int'>, None, 10, 10, 0, False)]\r\n    128\r\n    [('THIS_IS_A_REALLY_LONG_COLUMN_NAME_MORE_THAN_30_CHARS', <class 'int'>, None, 10, 10, 0, False)]\r\n```\r\n\r\n(the garbage data varies and sometimes cannot be decoded and throws an exception).\r\n\r\nThe data on the wire is encoded in EBCDIC, but the data being passed to pyodbc is UTF-16le (I've experimented with setdecoding).\r\n\r\nThe first connection always shows garbage data after 30 characters and all subsequent connections work fine. IBM documentation as well as the SQLGetInfo() call states that 128 characters should be supported.\r\n\r\nThe unixodbc trace (attached) seems to show that SQLDescribeCol is being called the first time, instead of SQLDescribeColW (although I am not an expert at reading odbc logs).\r\n\r\n[odbc.log](https://github.com/mkleehammer/pyodbc/files/3374370/odbc.log)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/581", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/581/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/581/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/581/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/581", "id": 464720518, "node_id": "MDU6SXNzdWU0NjQ3MjA1MTg=", "number": 581, "title": "UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 4: invalid start byte", "user": {"login": "ravi9884", "id": 6249312, "node_id": "MDQ6VXNlcjYyNDkzMTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/6249312?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ravi9884", "html_url": "https://github.com/ravi9884", "followers_url": "https://api.github.com/users/ravi9884/followers", "following_url": "https://api.github.com/users/ravi9884/following{/other_user}", "gists_url": "https://api.github.com/users/ravi9884/gists{/gist_id}", "starred_url": "https://api.github.com/users/ravi9884/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ravi9884/subscriptions", "organizations_url": "https://api.github.com/users/ravi9884/orgs", "repos_url": "https://api.github.com/users/ravi9884/repos", "events_url": "https://api.github.com/users/ravi9884/events{/privacy}", "received_events_url": "https://api.github.com/users/ravi9884/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-07-05T17:17:28Z", "updated_at": "2020-05-07T22:14:48Z", "closed_at": "2019-07-06T01:49:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n- Python: 3.6 64 bit\r\n- pyodbc: 4.0.26\r\n- OS: \"Debian GNU/Linux\"\r\n- DB: Hive with Knox\r\n- driver: clouderahiveodbc_2.6.4.1004-2_amd64.deb\r\n\r\n### Issue\r\nI'm able to connect to the server using isql. But not able to connect through pyodbc. I looked at the other issues, they deal with running sql statements. But I get error even when connecting.\r\n\r\n```\r\n\r\nRUN isql hive_knox -v\r\n+---------------------------------------+\r\n| Connected!                            |\r\n|                                       |\r\n| sql-statement                         |\r\n| help [tablename]                      |\r\n| quit                                  |\r\n|                                       |\r\n+---------------------------------------+\r\n```\r\n\r\nBut when I try to connect from pyodbc, I get error\r\n```\r\nimport pyodbc\r\npyodbc.pooling = False\r\ncnxn = pyodbc.connect(DSN='hive_knox')\r\npd.read_sql(sql=\"show tables\",con=cnxn)\r\n```\r\nError\r\n```\r\n---------------------------------------------------------------------------\r\nUnicodeDecodeError                        Traceback (most recent call last)\r\n<ipython-input-9-57255d5c3b22> in <module>\r\n      1 import pyodbc\r\n      2 pyodbc.pooling = False\r\n----> 3 cnxn = pyodbc.connect(DSN='hive_knox')\r\n      4 pd.read_sql(sql=\"show tables\",con=cnxn)\r\n\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 4: invalid start byte\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/580", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/580/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/580/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/580/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/580", "id": 463101111, "node_id": "MDU6SXNzdWU0NjMxMDExMTE=", "number": 580, "title": "Python3 mysql+pyodbc fails to send query (works on python 2)", "user": {"login": "blha303", "id": 1192885, "node_id": "MDQ6VXNlcjExOTI4ODU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1192885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blha303", "html_url": "https://github.com/blha303", "followers_url": "https://api.github.com/users/blha303/followers", "following_url": "https://api.github.com/users/blha303/following{/other_user}", "gists_url": "https://api.github.com/users/blha303/gists{/gist_id}", "starred_url": "https://api.github.com/users/blha303/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blha303/subscriptions", "organizations_url": "https://api.github.com/users/blha303/orgs", "repos_url": "https://api.github.com/users/blha303/repos", "events_url": "https://api.github.com/users/blha303/events{/privacy}", "received_events_url": "https://api.github.com/users/blha303/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 784257622, "node_id": "MDU6TGFiZWw3ODQyNTc2MjI=", "url": "https://api.github.com/repos/mkleehammer/pyodbc/labels/Environment%20or%20Driver%20Issue", "name": "Environment or Driver Issue", "color": "46e2db", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-07-02T08:48:03Z", "updated_at": "2019-07-03T02:30:05Z", "closed_at": "2019-07-03T02:30:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Issue\r\n\r\nWhen attempting to use pyodbc on python 3.5.2, it appears a string check fails to pick up that bytes is a valid string type (problem initially found when attempting mysql+pyodbc sqlalchemy connection, after investigation i tracked the problem down to pyodbc). Identical query in python 2 and isql below.\r\n\r\n### Environment\r\n\r\nPython: 3.5.2 [GCC 5.4.0 20160609] on linux 64 bit\r\npyodbc: 4.0.26\r\nOS: ubuntu 16.04\r\nDB: mysql 4.0.24_Debian\r\ndriver: libmyodbc3_r-3.51.30\r\n\r\n### Console output:\r\n\r\n```\r\nuser@xxx:~$ isql -v faxmail\r\n+---------------------------------------+\r\n| Connected!                            |\r\n|                                       |\r\n| sql-statement                         |\r\n| help [tablename]                      |\r\n| quit                                  |\r\n|                                       |\r\n+---------------------------------------+\r\nSQL> select * from servers limit 1;\r\n+----------------+-----------+-------------------------------+------+\r\n:snip\r\nuser@xxx:~$ python3\r\nPython 3.5.2 (default, Nov 12 2018, 13:43:14)\r\n[GCC 5.4.0 20160609] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import pyodbc\r\n>>> cxn = pyodbc.connect(\"DSN=internaldb\")\r\n>>> c = cxn.cursor()\r\n>>> c.execute(\"select * from servers limit 1\").fetchall()\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\npyodbc.Error: ('07006', '[07006] [MySQL][ODBC 3.51 Driver][mysqld-4.0.24_Debian-10-log]Restricted data type attribute violation (508) (SQLGetData)')\r\n>>> c.execute(b\"select * from servers limit 1\").fetchall()\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nTypeError: The first argument to execute must be a string or unicode query.\r\n>>>\r\nuser@xxx:~$ python2\r\nPython 2.7.12 (default, Nov 12 2018, 14:36:49)\r\n[GCC 5.4.0 20160609] on linux2\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import pyodbc\r\n>>> cxn = pyodbc.connect(\"DSN=internaldb\")\r\n>>> c = cxn.cursor()\r\n>>> c.execute(\"select * from servers limit 1\").fetchall()\r\n[('xxx', 'xxx', 'xxx', 'xxx')]\r\n>>>\r\n\r\n```\r\n\r\n### ODBC trace:\r\n\r\n```\r\n[ODBC][31921][1562056579.399454][__handles.c][460]\r\n                Exit:[SQL_SUCCESS]\r\n                        Environment = 0x2b596c0\r\n[ODBC][31921][1562056579.399505][SQLSetEnvAttr.c][189]\r\n                Entry:\r\n                        Environment = 0x2b596c0\r\n                        Attribute = SQL_ATTR_ODBC_VERSION\r\n                        Value = 0x3\r\n                        StrLen = 4\r\n[ODBC][31921][1562056579.399525][SQLSetEnvAttr.c][363]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.399544][SQLAllocHandle.c][375]\r\n                Entry:\r\n                        Handle Type = 2\r\n                        Input Handle = 0x2b596c0\r\n[ODBC][31921][1562056579.399563][SQLAllocHandle.c][493]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x2b81700\r\n[ODBC][31921][1562056579.400066][SQLDriverConnectW.c][290]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n                        Window Hdl = (nil)\r\n                        Str In = [DSN=internaldb][length = 11 (SQL_NTS)]\r\n                        Str Out = (nil)\r\n                        Str Out Max = 0\r\n                        Str Out Ptr = (nil)\r\n                        Completion = 0\r\n                UNICODE Using encoding ASCII 'ISO8859-1' and UNICODE 'UCS-2LE'\r\n\r\n[ODBC][31921][1562056579.409504][SQLDriverConnectW.c][910]\r\n                Exit:[SQL_SUCCESS]\r\n                        Connection Out [[NULL]]\r\n[ODBC][31921][1562056579.409539][SQLSetConnectAttr.c][396]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n                        Attribute = SQL_ATTR_AUTOCOMMIT\r\n                        Value = (nil)\r\n                        StrLen = -5\r\n[ODBC][31921][1562056579.410667][SQLSetConnectAttr.c][852]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.410727][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n                        Info Type = SQL_DRIVER_ODBC_VER (77)\r\n                        Info Value = 0x7ffcc0870bb0\r\n                        Buffer Length = 20\r\n                        StrLen = 0x7ffcc0870b6e\r\n[ODBC][31921][1562056579.410750][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.410769][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n                        Info Type = SQL_DESCRIBE_PARAMETER (10002)\r\n                        Info Value = 0x7ffcc0870ba0\r\n                        Buffer Length = 2\r\n                        StrLen = 0x7ffcc0870b6e\r\n[ODBC][31921][1562056579.410788][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS_WITH_INFO]\r\n[ODBC][31921][1562056579.410810][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n                        Info Type = SQL_NEED_LONG_DATA_LEN (111)\r\n                        Info Value = 0x7ffcc0870ba0\r\n                        Buffer Length = 2\r\n                        StrLen = 0x7ffcc0870b6e\r\n[ODBC][31921][1562056579.410828][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS_WITH_INFO]\r\n[ODBC][31921][1562056579.410847][SQLAllocHandle.c][540]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2b81700\r\n[ODBC][31921][1562056579.410902][SQLAllocHandle.c][1081]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x2bb8660\r\n[ODBC][31921][1562056579.410934][SQLGetTypeInfo.c][168]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Data Type = SQL_VARCHAR\r\n[ODBC][31921][1562056579.410968][SQLGetTypeInfo.c][318]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411003][SQLFetch.c][162]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n[ODBC][31921][1562056579.411032][SQLFetch.c][348]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411053][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 3\r\n                        Target Type = 4 SQL_INTEGER\r\n                        Buffer Length = 4\r\n                        Target Value = 0x7ffcc0870b70\r\n                        StrLen Or Ind = (nil)\r\n[ODBC][31921][1562056579.411076][SQLGetData.c][501]\r\n                Exit:[SQL_SUCCESS]\r\n                        Buffer = [255]\r\n                        Strlen Or Ind = NULLPTR\r\n[ODBC][31921][1562056579.411095][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Option = 0\r\n[ODBC][31921][1562056579.411115][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411134][SQLFreeHandle.c][381]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2bb8660\r\n[ODBC][31921][1562056579.411155][SQLFreeHandle.c][491]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411173][SQLAllocHandle.c][540]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2b81700\r\n[ODBC][31921][1562056579.411194][SQLAllocHandle.c][1081]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x2bb8660\r\n[ODBC][31921][1562056579.411213][SQLGetTypeInfo.c][168]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Data Type = Unknown(-9)\r\n[ODBC][31921][1562056579.411235][SQLGetTypeInfo.c][318]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411253][SQLFetch.c][162]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n[ODBC][31921][1562056579.411271][SQLFetch.c][348]\r\n                Exit:[SQL_NO_DATA]\r\n[ODBC][31921][1562056579.411289][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Option = 0\r\n[ODBC][31921][1562056579.411308][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411343][SQLFreeHandle.c][381]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2bb8660\r\n[ODBC][31921][1562056579.411363][SQLFreeHandle.c][491]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411382][SQLAllocHandle.c][540]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2b81700\r\n[ODBC][31921][1562056579.411402][SQLAllocHandle.c][1081]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x2bb8660\r\n[ODBC][31921][1562056579.411421][SQLGetTypeInfo.c][168]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Data Type = SQL_VARBINARY\r\n[ODBC][31921][1562056579.411443][SQLGetTypeInfo.c][318]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411461][SQLFetch.c][162]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n[ODBC][31921][1562056579.411480][SQLFetch.c][348]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411499][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 3\r\n                        Target Type = 4 SQL_INTEGER\r\n                        Buffer Length = 4\r\n                        Target Value = 0x7ffcc0870b78\r\n                        StrLen Or Ind = (nil)\r\n[ODBC][31921][1562056579.411519][SQLGetData.c][501]\r\n                Exit:[SQL_SUCCESS]\r\n                        Buffer = [255]\r\n                        Strlen Or Ind = NULLPTR\r\n[ODBC][31921][1562056579.411537][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Option = 0\r\n[ODBC][31921][1562056579.411555][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411573][SQLFreeHandle.c][381]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2bb8660\r\n[ODBC][31921][1562056579.411592][SQLFreeHandle.c][491]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411610][SQLAllocHandle.c][540]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2b81700\r\n[ODBC][31921][1562056579.411630][SQLAllocHandle.c][1081]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x2bb8660\r\n[ODBC][31921][1562056579.411648][SQLGetTypeInfo.c][168]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Data Type = SQL_TYPE_TIMESTAMP\r\n[ODBC][31921][1562056579.411671][SQLGetTypeInfo.c][318]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411689][SQLFetch.c][162]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n[ODBC][31921][1562056579.411708][SQLFetch.c][348]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411727][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 3\r\n                        Target Type = 4 SQL_INTEGER\r\n                        Buffer Length = 4\r\n                        Target Value = 0x7ffcc0870b7c\r\n                        StrLen Or Ind = (nil)\r\n[ODBC][31921][1562056579.411746][SQLGetData.c][501]\r\n                Exit:[SQL_SUCCESS]\r\n                        Buffer = [21]\r\n                        Strlen Or Ind = NULLPTR\r\n[ODBC][31921][1562056579.411764][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Option = 0\r\n[ODBC][31921][1562056579.411782][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056579.411800][SQLFreeHandle.c][381]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2bb8660\r\n[ODBC][31921][1562056579.411818][SQLFreeHandle.c][491]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056581.573989][SQLAllocHandle.c][540]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2b81700\r\n[ODBC][31921][1562056581.574066][SQLAllocHandle.c][1081]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x2bb8660\r\n[ODBC][31921][1562056603.326753][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Option = 0\r\n[ODBC][31921][1562056603.326814][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056603.326858][SQLExecDirectW.c][177]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        SQL = [select * from servers limit 1][length = 29]\r\n[ODBC][31921][1562056603.329472][SQLExecDirectW.c][436]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056603.329498][SQLRowCount.c][173]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Row Count = 0x7ffcc0870d50\r\n[ODBC][31921][1562056603.329521][SQLRowCount.c][244]\r\n                Exit:[SQL_SUCCESS]\r\n                        Row Count = 0x7ffcc0870d50 -> 1\r\n[ODBC][31921][1562056603.329541][SQLNumResultCols.c][156]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Count = 0x7ffcc0870d48\r\n[ODBC][31921][1562056603.329571][SQLNumResultCols.c][248]\r\n                Exit:[SQL_SUCCESS]\r\n                        Count = 0x7ffcc0870d48 -> 4\r\n[ODBC][31921][1562056603.329599][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 1\r\n                        Column Name = 0x7ffcc0870be0\r\n                        Buffer Length = 200\r\n                        Name Length = 0x7ffcc0870bc8\r\n                        Data Type = 0x7ffcc0870bca\r\n                        Column Size = 0x7ffcc0870bd0\r\n                        Decimal Digits = 0x7ffcc0870bcc\r\n                        Nullable = 0x7ffcc0870bce\r\n[ODBC][31921][1562056603.329653][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7ffcc0870bca -> 12\r\n                        Column Size = 0x7ffcc0870bd0 -> 15\r\n                        Decimal Digits = 0x7ffcc0870bcc -> 0\r\n                        Nullable = 0x7ffcc0870bce -> 0\r\n[ODBC][31921][1562056603.329677][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 2\r\n                        Column Name = 0x7ffcc0870be0\r\n                        Buffer Length = 200\r\n                        Name Length = 0x7ffcc0870bc8\r\n                        Data Type = 0x7ffcc0870bca\r\n                        Column Size = 0x7ffcc0870bd0\r\n                        Decimal Digits = 0x7ffcc0870bcc\r\n                        Nullable = 0x7ffcc0870bce\r\n[ODBC][31921][1562056603.329699][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7ffcc0870bca -> 12\r\n                        Column Size = 0x7ffcc0870bd0 -> 10\r\n                        Decimal Digits = 0x7ffcc0870bcc -> 0\r\n                        Nullable = 0x7ffcc0870bce -> 0\r\n[ODBC][31921][1562056603.329725][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 3\r\n                        Column Name = 0x7ffcc0870be0\r\n                        Buffer Length = 200\r\n                        Name Length = 0x7ffcc0870bc8\r\n                        Data Type = 0x7ffcc0870bca\r\n                        Column Size = 0x7ffcc0870bd0\r\n                        Decimal Digits = 0x7ffcc0870bcc\r\n                        Nullable = 0x7ffcc0870bce\r\n[ODBC][31921][1562056603.329748][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7ffcc0870bca -> 12\r\n                        Column Size = 0x7ffcc0870bd0 -> 30\r\n                        Decimal Digits = 0x7ffcc0870bcc -> 0\r\n                        Nullable = 0x7ffcc0870bce -> 0\r\n[ODBC][31921][1562056603.329774][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 4\r\n                        Column Name = 0x7ffcc0870be0\r\n                        Buffer Length = 200\r\n                        Name Length = 0x7ffcc0870bc8\r\n                        Data Type = 0x7ffcc0870bca\r\n                        Column Size = 0x7ffcc0870bd0\r\n                        Decimal Digits = 0x7ffcc0870bcc\r\n                        Nullable = 0x7ffcc0870bce\r\n[ODBC][31921][1562056603.329796][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7ffcc0870bca -> 1\r\n                        Column Size = 0x7ffcc0870bd0 -> 3\r\n                        Decimal Digits = 0x7ffcc0870bcc -> 0\r\n                        Nullable = 0x7ffcc0870bce -> 0\r\n[ODBC][31921][1562056603.329838][SQLDescribeColW.c][209]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 1\r\n                        Column Name = 0x7ffcc0870a80\r\n                        Buffer Length = 300\r\n                        Name Length = 0x7ffcc0870a70\r\n                        Data Type = 0x7ffcc0870a72\r\n                        Column Size = 0x7ffcc0870a78\r\n                        Decimal Digits = 0x7ffcc0870a74\r\n                        Nullable = 0x7ffcc0870a76\r\n[ODBC][31921][1562056603.329876][SQLDescribeColW.c][460]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [i]\r\n                        Data Type = 0x7ffcc0870a72 -> 12\r\n                        Column Size = 0x7ffcc0870a78 -> 15\r\n                        Decimal Digits = 0x7ffcc0870a74 -> 0\r\n                        Nullable = 0x7ffcc0870a76 -> 0\r\n[ODBC][31921][1562056603.329908][SQLDescribeColW.c][209]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 2\r\n                        Column Name = 0x7ffcc0870a80\r\n                        Buffer Length = 300\r\n                        Name Length = 0x7ffcc0870a70\r\n                        Data Type = 0x7ffcc0870a72\r\n                        Column Size = 0x7ffcc0870a78\r\n                        Decimal Digits = 0x7ffcc0870a74\r\n                        Nullable = 0x7ffcc0870a76\r\n[ODBC][31921][1562056603.329933][SQLDescribeColW.c][460]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [n]\r\n                        Data Type = 0x7ffcc0870a72 -> 12\r\n                        Column Size = 0x7ffcc0870a78 -> 10\r\n                        Decimal Digits = 0x7ffcc0870a74 -> 0\r\n                        Nullable = 0x7ffcc0870a76 -> 0\r\n[ODBC][31921][1562056603.329956][SQLDescribeColW.c][209]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 3\r\n                        Column Name = 0x7ffcc0870a80\r\n                        Buffer Length = 300\r\n                        Name Length = 0x7ffcc0870a70\r\n                        Data Type = 0x7ffcc0870a72\r\n                        Column Size = 0x7ffcc0870a78\r\n                        Decimal Digits = 0x7ffcc0870a74\r\n                        Nullable = 0x7ffcc0870a76\r\n[ODBC][31921][1562056603.329985][SQLDescribeColW.c][460]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [s]\r\n                        Data Type = 0x7ffcc0870a72 -> 12\r\n                        Column Size = 0x7ffcc0870a78 -> 30\r\n                        Decimal Digits = 0x7ffcc0870a74 -> 0\r\n                        Nullable = 0x7ffcc0870a76 -> 0\r\n[ODBC][31921][1562056603.330064][SQLDescribeColW.c][209]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 4\r\n                        Column Name = 0x7ffcc0870a80\r\n                        Buffer Length = 300\r\n                        Name Length = 0x7ffcc0870a70\r\n                        Data Type = 0x7ffcc0870a72\r\n                        Column Size = 0x7ffcc0870a78\r\n                        Decimal Digits = 0x7ffcc0870a74\r\n                        Nullable = 0x7ffcc0870a76\r\n[ODBC][31921][1562056603.330101][SQLDescribeColW.c][460]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [S]\r\n                        Data Type = 0x7ffcc0870a72 -> 1\r\n                        Column Size = 0x7ffcc0870a78 -> 3\r\n                        Decimal Digits = 0x7ffcc0870a74 -> 0\r\n                        Nullable = 0x7ffcc0870a76 -> 0\r\n[ODBC][31921][1562056603.330128][SQLFetch.c][162]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n[ODBC][31921][1562056603.330156][SQLFetch.c][348]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056603.330197][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Column Number = 1\r\n                        Target Type = -8 SQL_WCHAR\r\n                        Buffer Length = 4096\r\n                        Target Value = 0x2bbca80\r\n                        StrLen Or Ind = 0x7ffcc0870c80\r\n[ODBC][31921][1562056603.330235][SQLGetData.c][501]\r\n                Exit:[SQL_ERROR]\r\n                        Buffer = [\u2592ip](unicode)\r\n                        Strlen Or Ind = 0x7ffcc0870c80 -> 0\r\n                DIAG [07006] [MySQL][ODBC 3.51 Driver][mysqld-4.0.24_Debian-10-log]Restricted data type attribute violation\r\n\r\n[ODBC][31921][1562056603.330281][SQLGetDiagRecW.c][631]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Rec Number = 1\r\n                        SQLState = 0x7ffcc08703d0\r\n                        Native = 0x7ffcc08703cc\r\n                        Message Text = 0x7ffcc08703e0\r\n                        Buffer Length = 1023\r\n                        Text Len Ptr = 0x7ffcc08703ca\r\n[ODBC][31921][1562056603.330315][SQLGetDiagRecW.c][673]\r\n                Exit:[SQL_SUCCESS]\r\n                        SQLState = 07006\r\n                        Native = 0x7ffcc08703cc -> 508\r\n                        Message Text = [[MySQL][ODBC 3.51 Driver][mysqld-4.0.24_Debian-10-log]Restricted data type attribute violation]\r\n[ODBC][31921][1562056609.262650][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x2bb8660\r\n                        Option = 0\r\n[ODBC][31921][1562056609.262689][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056609.262713][SQLFreeHandle.c][381]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2bb8660\r\n[ODBC][31921][1562056609.262735][SQLFreeHandle.c][491]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056609.262757][SQLEndTran.c][421]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n                        Completion Type = 1\r\n[ODBC][31921][1562056609.264171][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n                        Info Type = SQL_CURSOR_COMMIT_BEHAVIOR (23)\r\n                        Info Value = 0x2b82b70\r\n                        Buffer Length = 2\r\n                        StrLen = 0x7ffcc0870e3e\r\n[ODBC][31921][1562056609.264196][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056609.264216][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n                        Info Type = SQL_CURSOR_ROLLBACK_BEHAVIOR (24)\r\n                        Info Value = 0x2b82b72\r\n                        Buffer Length = 2\r\n                        StrLen = 0x7ffcc0870e3e\r\n[ODBC][31921][1562056609.264235][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056609.264253][SQLEndTran.c][574]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056609.264272][SQLDisconnect.c][208]\r\n                Entry:\r\n                        Connection = 0x2b81700\r\n[ODBC][31921][1562056609.264413][SQLDisconnect.c][364]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31921][1562056609.264437][SQLFreeHandle.c][284]\r\n                Entry:\r\n                        Handle Type = 2\r\n                        Input Handle = 0x2b81700\r\n[ODBC][31921][1562056609.264457][SQLFreeHandle.c][333]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056620.847582][__handles.c][460]\r\n                Exit:[SQL_SUCCESS]\r\n                        Environment = 0x27cdb70\r\n[ODBC][31954][1562056620.847623][SQLSetEnvAttr.c][189]\r\n                Entry:\r\n                        Environment = 0x27cdb70\r\n                        Attribute = SQL_ATTR_ODBC_VERSION\r\n                        Value = 0x3\r\n                        StrLen = 4\r\n[ODBC][31954][1562056620.847642][SQLSetEnvAttr.c][363]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056620.847662][SQLAllocHandle.c][375]\r\n                Entry:\r\n                        Handle Type = 2\r\n                        Input Handle = 0x27cdb70\r\n[ODBC][31954][1562056620.847682][SQLAllocHandle.c][493]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x2764270\r\n[ODBC][31954][1562056620.847716][SQLDriverConnectW.c][290]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n                        Window Hdl = (nil)\r\n                        Str In = [DSN=internaldb][length = 11]\r\n                        Str Out = (nil)\r\n                        Str Out Max = 0\r\n                        Str Out Ptr = (nil)\r\n                        Completion = 0\r\n                UNICODE Using encoding ASCII 'ISO8859-1' and UNICODE 'UCS-2LE'\r\n\r\n[ODBC][31954][1562056620.856640][SQLDriverConnectW.c][910]\r\n                Exit:[SQL_SUCCESS]\r\n                        Connection Out [[NULL]]\r\n[ODBC][31954][1562056620.856676][SQLSetConnectAttr.c][396]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n                        Attribute = SQL_ATTR_AUTOCOMMIT\r\n                        Value = (nil)\r\n                        StrLen = -5\r\n[ODBC][31954][1562056620.857745][SQLSetConnectAttr.c][852]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056620.857809][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n                        Info Type = SQL_DRIVER_ODBC_VER (77)\r\n                        Info Value = 0x7fffff5b9fb0\r\n                        Buffer Length = 20\r\n                        StrLen = 0x7fffff5b9f92\r\n[ODBC][31954][1562056620.857832][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056620.857852][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n                        Info Type = SQL_DESCRIBE_PARAMETER (10002)\r\n                        Info Value = 0x7fffff5b9fa0\r\n                        Buffer Length = 2\r\n                        StrLen = 0x7fffff5b9f92\r\n[ODBC][31954][1562056620.857871][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS_WITH_INFO]\r\n[ODBC][31954][1562056620.857893][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n                        Info Type = SQL_NEED_LONG_DATA_LEN (111)\r\n                        Info Value = 0x7fffff5b9fa0\r\n                        Buffer Length = 2\r\n                        StrLen = 0x7fffff5b9f92\r\n[ODBC][31954][1562056620.857912][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS_WITH_INFO]\r\n[ODBC][31954][1562056620.857931][SQLAllocHandle.c][540]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2764270\r\n[ODBC][31954][1562056620.857971][SQLAllocHandle.c][1081]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x27480e0\r\n[ODBC][31954][1562056620.857996][SQLGetTypeInfo.c][168]\r\n                Entry:\r\n                        Statement = 0x27480e0\r\n                        Data Type = SQL_TYPE_TIMESTAMP\r\n[ODBC][31954][1562056620.858075][SQLGetTypeInfo.c][318]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056620.858106][SQLFetch.c][162]\r\n                Entry:\r\n                        Statement = 0x27480e0\r\n[ODBC][31954][1562056620.858131][SQLFetch.c][348]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056620.858151][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x27480e0\r\n                        Column Number = 3\r\n                        Target Type = 4 SQL_INTEGER\r\n                        Buffer Length = 4\r\n                        Target Value = 0x7fffff5b9f94\r\n                        StrLen Or Ind = (nil)\r\n[ODBC][31954][1562056620.858175][SQLGetData.c][501]\r\n                Exit:[SQL_SUCCESS]\r\n                        Buffer = [21]\r\n                        Strlen Or Ind = NULLPTR\r\n[ODBC][31954][1562056620.858195][SQLGetTypeInfo.c][168]\r\n                Entry:\r\n                        Statement = 0x27480e0\r\n                        Data Type = SQL_VARCHAR\r\n[ODBC][31954][1562056620.858212][SQLGetTypeInfo.c][190]Error: 24000\r\n[ODBC][31954][1562056620.858240][SQLGetTypeInfo.c][168]\r\n                Entry:\r\n                        Statement = 0x27480e0\r\n                        Data Type = Unknown(-9)\r\n[ODBC][31954][1562056620.858258][SQLGetTypeInfo.c][190]Error: 24000\r\n[ODBC][31954][1562056620.858281][SQLGetTypeInfo.c][168]\r\n                Entry:\r\n                        Statement = 0x27480e0\r\n                        Data Type = SQL_BINARY\r\n[ODBC][31954][1562056620.858308][SQLGetTypeInfo.c][190]Error: 24000\r\n[ODBC][31954][1562056620.858333][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x27480e0\r\n                        Option = 0\r\n[ODBC][31954][1562056620.858354][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056625.199570][SQLAllocHandle.c][540]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x2764270\r\n[ODBC][31954][1562056625.199640][SQLAllocHandle.c][1081]\r\n                Exit:[SQL_SUCCESS]\r\n                        Output Handle = 0x28213e0\r\n[ODBC][31954][1562056630.231400][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Option = 0\r\n[ODBC][31954][1562056630.231445][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056630.231467][SQLExecDirect.c][240]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        SQL = [select * from servers limit 1][length = 29 (SQL_NTS)]\r\n[ODBC][31954][1562056630.234075][SQLExecDirect.c][503]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056630.234107][SQLRowCount.c][173]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Row Count = 0x7fffff5ba0d0\r\n[ODBC][31954][1562056630.234128][SQLRowCount.c][244]\r\n                Exit:[SQL_SUCCESS]\r\n                        Row Count = 0x7fffff5ba0d0 -> 1\r\n[ODBC][31954][1562056630.234158][SQLNumResultCols.c][156]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Count = 0x7fffff5ba0c8\r\n[ODBC][31954][1562056630.234178][SQLNumResultCols.c][248]\r\n                Exit:[SQL_SUCCESS]\r\n                        Count = 0x7fffff5ba0c8 -> 4\r\n[ODBC][31954][1562056630.234200][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 1\r\n                        Column Name = 0x7fffff5b9f60\r\n                        Buffer Length = 200\r\n                        Name Length = 0x7fffff5b9f48\r\n                        Data Type = 0x7fffff5b9f4a\r\n                        Column Size = 0x7fffff5b9f50\r\n                        Decimal Digits = 0x7fffff5b9f4c\r\n                        Nullable = 0x7fffff5b9f4e\r\n[ODBC][31954][1562056630.234230][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7fffff5b9f4a -> 12\r\n                        Column Size = 0x7fffff5b9f50 -> 15\r\n                        Decimal Digits = 0x7fffff5b9f4c -> 0\r\n                        Nullable = 0x7fffff5b9f4e -> 0\r\n[ODBC][31954][1562056630.234251][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 2\r\n                        Column Name = 0x7fffff5b9f60\r\n                        Buffer Length = 200\r\n                        Name Length = 0x7fffff5b9f48\r\n                        Data Type = 0x7fffff5b9f4a\r\n                        Column Size = 0x7fffff5b9f50\r\n                        Decimal Digits = 0x7fffff5b9f4c\r\n                        Nullable = 0x7fffff5b9f4e\r\n[ODBC][31954][1562056630.234272][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7fffff5b9f4a -> 12\r\n                        Column Size = 0x7fffff5b9f50 -> 10\r\n                        Decimal Digits = 0x7fffff5b9f4c -> 0\r\n                        Nullable = 0x7fffff5b9f4e -> 0\r\n[ODBC][31954][1562056630.234292][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 3\r\n                        Column Name = 0x7fffff5b9f60\r\n                        Buffer Length = 200\r\n                        Name Length = 0x7fffff5b9f48\r\n                        Data Type = 0x7fffff5b9f4a\r\n                        Column Size = 0x7fffff5b9f50\r\n                        Decimal Digits = 0x7fffff5b9f4c\r\n                        Nullable = 0x7fffff5b9f4e\r\n[ODBC][31954][1562056630.234313][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7fffff5b9f4a -> 12\r\n                        Column Size = 0x7fffff5b9f50 -> 30\r\n                        Decimal Digits = 0x7fffff5b9f4c -> 0\r\n                        Nullable = 0x7fffff5b9f4e -> 0\r\n[ODBC][31954][1562056630.234332][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 4\r\n                        Column Name = 0x7fffff5b9f60\r\n                        Buffer Length = 200\r\n                        Name Length = 0x7fffff5b9f48\r\n                        Data Type = 0x7fffff5b9f4a\r\n                        Column Size = 0x7fffff5b9f50\r\n                        Decimal Digits = 0x7fffff5b9f4c\r\n                        Nullable = 0x7fffff5b9f4e\r\n[ODBC][31954][1562056630.234353][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7fffff5b9f4a -> 1\r\n                        Column Size = 0x7fffff5b9f50 -> 3\r\n                        Decimal Digits = 0x7fffff5b9f4c -> 0\r\n                        Nullable = 0x7fffff5b9f4e -> 0\r\n[ODBC][31954][1562056630.234378][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 1\r\n                        Column Name = 0x7fffff5b9f20\r\n                        Buffer Length = 300\r\n                        Name Length = (nil)\r\n                        Data Type = 0x7fffff5b9f12\r\n                        Column Size = 0x7fffff5b9f18\r\n                        Decimal Digits = 0x7fffff5b9f14\r\n                        Nullable = 0x7fffff5b9f16\r\n[ODBC][31954][1562056630.234400][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7fffff5b9f12 -> 12\r\n                        Column Size = 0x7fffff5b9f18 -> 15\r\n                        Decimal Digits = 0x7fffff5b9f14 -> 0\r\n                        Nullable = 0x7fffff5b9f16 -> 0\r\n[ODBC][31954][1562056630.234424][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 2\r\n                        Column Name = 0x7fffff5b9f20\r\n                        Buffer Length = 300\r\n                        Name Length = (nil)\r\n                        Data Type = 0x7fffff5b9f12\r\n                        Column Size = 0x7fffff5b9f18\r\n                        Decimal Digits = 0x7fffff5b9f14\r\n                        Nullable = 0x7fffff5b9f16\r\n[ODBC][31954][1562056630.234445][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7fffff5b9f12 -> 12\r\n                        Column Size = 0x7fffff5b9f18 -> 10\r\n                        Decimal Digits = 0x7fffff5b9f14 -> 0\r\n                        Nullable = 0x7fffff5b9f16 -> 0\r\n[ODBC][31954][1562056630.234474][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 3\r\n                        Column Name = 0x7fffff5b9f20\r\n                        Buffer Length = 300\r\n                        Name Length = (nil)\r\n                        Data Type = 0x7fffff5b9f12\r\n                        Column Size = 0x7fffff5b9f18\r\n                        Decimal Digits = 0x7fffff5b9f14\r\n                        Nullable = 0x7fffff5b9f16\r\n[ODBC][31954][1562056630.234496][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7fffff5b9f12 -> 12\r\n                        Column Size = 0x7fffff5b9f18 -> 30\r\n                        Decimal Digits = 0x7fffff5b9f14 -> 0\r\n                        Nullable = 0x7fffff5b9f16 -> 0\r\n[ODBC][31954][1562056630.234518][SQLDescribeCol.c][247]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 4\r\n                        Column Name = 0x7fffff5b9f20\r\n                        Buffer Length = 300\r\n                        Name Length = (nil)\r\n                        Data Type = 0x7fffff5b9f12\r\n                        Column Size = 0x7fffff5b9f18\r\n                        Decimal Digits = 0x7fffff5b9f14\r\n                        Nullable = 0x7fffff5b9f16\r\n[ODBC][31954][1562056630.234540][SQLDescribeCol.c][497]\r\n                Exit:[SQL_SUCCESS]\r\n                        Column Name = [xxx]\r\n                        Data Type = 0x7fffff5b9f12 -> 1\r\n                        Column Size = 0x7fffff5b9f18 -> 3\r\n                        Decimal Digits = 0x7fffff5b9f14 -> 0\r\n                        Nullable = 0x7fffff5b9f16 -> 0\r\n[ODBC][31954][1562056630.234564][SQLFetch.c][162]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n[ODBC][31954][1562056630.234590][SQLFetch.c][348]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056630.234612][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 1\r\n                        Target Type = 1 SQL_CHAR\r\n                        Buffer Length = 1024\r\n                        Target Value = 0x7fffff5b9b50\r\n                        StrLen Or Ind = 0x7fffff5b9b08\r\n[ODBC][31954][1562056630.234636][SQLGetData.c][501]\r\n                Exit:[SQL_SUCCESS]\r\n                        Buffer = [xxx]\r\n                        Strlen Or Ind = 0x7fffff5b9b08 -> 12\r\n[ODBC][31954][1562056630.234657][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 2\r\n                        Target Type = 1 SQL_CHAR\r\n                        Buffer Length = 1024\r\n                        Target Value = 0x7fffff5b9b50\r\n                        StrLen Or Ind = 0x7fffff5b9b08\r\n[ODBC][31954][1562056630.234678][SQLGetData.c][501]\r\n                Exit:[SQL_SUCCESS]\r\n                        Buffer = [xxx]\r\n                        Strlen Or Ind = 0x7fffff5b9b08 -> 5\r\n[ODBC][31954][1562056630.234699][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 3\r\n                        Target Type = 1 SQL_CHAR\r\n                        Buffer Length = 1024\r\n                        Target Value = 0x7fffff5b9b50\r\n                        StrLen Or Ind = 0x7fffff5b9b08\r\n[ODBC][31954][1562056630.234719][SQLGetData.c][501]\r\n                Exit:[SQL_SUCCESS]\r\n                        Buffer = [xxx]\r\n                        Strlen Or Ind = 0x7fffff5b9b08 -> 25\r\n[ODBC][31954][1562056630.234739][SQLGetData.c][237]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Column Number = 4\r\n                        Target Type = 1 SQL_CHAR\r\n                        Buffer Length = 1024\r\n                        Target Value = 0x7fffff5b9b50\r\n                        StrLen Or Ind = 0x7fffff5b9b08\r\n[ODBC][31954][1562056630.234759][SQLGetData.c][501]\r\n                Exit:[SQL_SUCCESS]\r\n                        Buffer = [xxx]\r\n                        Strlen Or Ind = 0x7fffff5b9b08 -> 2\r\n[ODBC][31954][1562056630.234779][SQLFetch.c][162]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n[ODBC][31954][1562056630.234798][SQLFetch.c][348]\r\n                Exit:[SQL_NO_DATA]\r\n[ODBC][31954][1562056637.640561][SQLFreeStmt.c][144]\r\n                Entry:\r\n                        Statement = 0x28213e0\r\n                        Option = 0\r\n[ODBC][31954][1562056637.640623][SQLFreeStmt.c][263]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056637.640647][SQLFreeHandle.c][381]\r\n                Entry:\r\n                        Handle Type = 3\r\n                        Input Handle = 0x28213e0\r\n[ODBC][31954][1562056637.640673][SQLFreeHandle.c][491]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056637.640695][SQLEndTran.c][421]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n                        Completion Type = 1\r\n[ODBC][31954][1562056637.641928][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n                        Info Type = SQL_CURSOR_COMMIT_BEHAVIOR (23)\r\n                        Info Value = 0x27656e0\r\n                        Buffer Length = 2\r\n                        StrLen = 0x7fffff5ba20e\r\n[ODBC][31954][1562056637.641952][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056637.641972][SQLGetInfo.c][554]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n                        Info Type = SQL_CURSOR_ROLLBACK_BEHAVIOR (24)\r\n                        Info Value = 0x27656e2\r\n                        Buffer Length = 2\r\n                        StrLen = 0x7fffff5ba20e\r\n[ODBC][31954][1562056637.642001][SQLGetInfo.c][617]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056637.642021][SQLEndTran.c][574]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056637.642068][SQLDisconnect.c][208]\r\n                Entry:\r\n                        Connection = 0x2764270\r\n[ODBC][31954][1562056637.642204][SQLDisconnect.c][364]\r\n                Exit:[SQL_SUCCESS]\r\n[ODBC][31954][1562056637.642229][SQLFreeHandle.c][284]\r\n                Entry:\r\n                        Handle Type = 2\r\n                        Input Handle = 0x2764270\r\n[ODBC][31954][1562056637.642248][SQLFreeHandle.c][333]\r\n                Exit:[SQL_SUCCESS]\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/579", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/579/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/579/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/579/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/579", "id": 462203336, "node_id": "MDU6SXNzdWU0NjIyMDMzMzY=", "number": 579, "title": "Insert result set resulting in \"pyodbc.ProgrammingError: ('String data, right truncation: length 8 buffer 4', 'HY000')\" error.", "user": {"login": "dvarna", "id": 52333506, "node_id": "MDQ6VXNlcjUyMzMzNTA2", "avatar_url": "https://avatars3.githubusercontent.com/u/52333506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvarna", "html_url": "https://github.com/dvarna", "followers_url": "https://api.github.com/users/dvarna/followers", "following_url": "https://api.github.com/users/dvarna/following{/other_user}", "gists_url": "https://api.github.com/users/dvarna/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvarna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvarna/subscriptions", "organizations_url": "https://api.github.com/users/dvarna/orgs", "repos_url": "https://api.github.com/users/dvarna/repos", "events_url": "https://api.github.com/users/dvarna/events{/privacy}", "received_events_url": "https://api.github.com/users/dvarna/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-06-28T20:52:24Z", "updated_at": "2019-07-10T19:59:34Z", "closed_at": "2019-07-10T19:59:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using pyodbc 4.0.26 version. Inserting result-set (containing a decimal result) with \"fastexecutemany\" set to TRUE results in \"pyodbc.ProgrammingError: ('String data, right truncation: length 8 buffer 4', 'HY000')\" error. \r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/578", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/578/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/578/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/578/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/578", "id": 460571455, "node_id": "MDU6SXNzdWU0NjA1NzE0NTU=", "number": 578, "title": "Bind Parameter in Subquery", "user": {"login": "mjack24", "id": 46972028, "node_id": "MDQ6VXNlcjQ2OTcyMDI4", "avatar_url": "https://avatars0.githubusercontent.com/u/46972028?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mjack24", "html_url": "https://github.com/mjack24", "followers_url": "https://api.github.com/users/mjack24/followers", "following_url": "https://api.github.com/users/mjack24/following{/other_user}", "gists_url": "https://api.github.com/users/mjack24/gists{/gist_id}", "starred_url": "https://api.github.com/users/mjack24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mjack24/subscriptions", "organizations_url": "https://api.github.com/users/mjack24/orgs", "repos_url": "https://api.github.com/users/mjack24/repos", "events_url": "https://api.github.com/users/mjack24/events{/privacy}", "received_events_url": "https://api.github.com/users/mjack24/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-06-25T18:20:36Z", "updated_at": "2019-07-03T02:25:20Z", "closed_at": "2019-07-03T02:25:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is it possible to pass a parameter to a subquery in PYODBC?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/577", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/577/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/577/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/577/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/577", "id": 459394820, "node_id": "MDU6SXNzdWU0NTkzOTQ4MjA=", "number": 577, "title": "Memory Leak encountered with fast_executemany on insertion into a wide table", "user": {"login": "yamen321", "id": 10390129, "node_id": "MDQ6VXNlcjEwMzkwMTI5", "avatar_url": "https://avatars1.githubusercontent.com/u/10390129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yamen321", "html_url": "https://github.com/yamen321", "followers_url": "https://api.github.com/users/yamen321/followers", "following_url": "https://api.github.com/users/yamen321/following{/other_user}", "gists_url": "https://api.github.com/users/yamen321/gists{/gist_id}", "starred_url": "https://api.github.com/users/yamen321/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yamen321/subscriptions", "organizations_url": "https://api.github.com/users/yamen321/orgs", "repos_url": "https://api.github.com/users/yamen321/repos", "events_url": "https://api.github.com/users/yamen321/events{/privacy}", "received_events_url": "https://api.github.com/users/yamen321/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-06-21T22:33:27Z", "updated_at": "2019-06-25T01:26:26Z", "closed_at": "2019-06-25T01:26:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Environment\r\n\r\n- Python: 3.7 (64-bit)\r\n- pyodbc: 4.0.26\r\n- OS: Windows 10 (64-bit)\r\n- DB: SQL Server 2014\r\n- driver: ODBC Driver 17 for SQL Server\r\n- Total RAM: 32GB\r\n\r\n### Issue\r\n\r\nHello,\r\n\r\nI've created this build that extracts large amounts of data from an API and inserts it into my database. I keep running into a pyodbc MemoryError when inserting the data into my database. I've done some tests to find out why inserting into my database causes such a surge in memory usage, and it turns out that this issue is the result of running cursor.executemany() with the fast_executemany set to True.\r\n\r\nThis occurs when I attempt to insert 300,000 rows of data at a time into a table that is 155 columns wide. The memory spike is about 10GB for the duration of the executemany and does get recycled before the next batch of 300,000 rows. I have tested out reducing the number of rows inserted at once, and it seems to reduce the memory usage almost proportionally. I have no issues whenever I set fast_executemany to False; however, that greatly affects my performance so I'd prefer not to.\r\n\r\nI did look into issue #299, although I assume my version of pyodbc should already have that fix right? Also, I understand that executemany will allocate the parameter array, but is the parameter array supposed to use up this much memory for what is around 300 MB of raw data being inserted?\r\n\r\nSince reducing the number of rows being inserted at once will reduce the spike in memory at any one time, I will be doing so to workaround the issue, but I'd appreciate any insight since I'd prefer not to reduce my batch size.\r\n\r\nI've attached a portion of the trace containing the data insertion into my db. Please let me know if I can clarify anything, or provide any extra details! I really appreciate the help!\r\n\r\n[ExecuteTrace.txt](https://github.com/mkleehammer/pyodbc/files/3316201/ExecuteTrace.txt)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/576", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/576/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/576/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/576/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/576", "id": 457605004, "node_id": "MDU6SXNzdWU0NTc2MDUwMDQ=", "number": 576, "title": "Question - maximum limit of the parameters that can be bound to a query", "user": {"login": "kabirbaidhya", "id": 3315763, "node_id": "MDQ6VXNlcjMzMTU3NjM=", "avatar_url": "https://avatars1.githubusercontent.com/u/3315763?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kabirbaidhya", "html_url": "https://github.com/kabirbaidhya", "followers_url": "https://api.github.com/users/kabirbaidhya/followers", "following_url": "https://api.github.com/users/kabirbaidhya/following{/other_user}", "gists_url": "https://api.github.com/users/kabirbaidhya/gists{/gist_id}", "starred_url": "https://api.github.com/users/kabirbaidhya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kabirbaidhya/subscriptions", "organizations_url": "https://api.github.com/users/kabirbaidhya/orgs", "repos_url": "https://api.github.com/users/kabirbaidhya/repos", "events_url": "https://api.github.com/users/kabirbaidhya/events{/privacy}", "received_events_url": "https://api.github.com/users/kabirbaidhya/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-06-18T17:25:10Z", "updated_at": "2019-06-19T15:22:01Z", "closed_at": "2019-06-19T15:22:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "I want to know, let's say for MS SQL Server 2017, is there a limit of how many parameters you can bind into a prepared query that you execute with pyodbc?\r\n \r\nAlso, is this something specific to every vendor? \r\n\r\nI tried to search through the wiki and also through MS SQL docs but couldn't get any idea in this. \r\n\r\nIn a query like this - what would be the max number of params I can bind:\r\n```sql\r\ncursor.execute(\"insert into products(id, name) values (?, ?)\", 'pyodbc', 'awesome library')\r\n```\r\n\r\nPS - have already gone through these:\r\n- https://github.com/mkleehammer/pyodbc/wiki/Binding-Parameters\r\n- https://github.com/mkleehammer/pyodbc/wiki/Getting-started\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/575", "repository_url": "https://api.github.com/repos/mkleehammer/pyodbc", "labels_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/575/labels{/name}", "comments_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/575/comments", "events_url": "https://api.github.com/repos/mkleehammer/pyodbc/issues/575/events", "html_url": "https://github.com/mkleehammer/pyodbc/issues/575", "id": 456657642, "node_id": "MDU6SXNzdWU0NTY2NTc2NDI=", "number": 575, "title": "sql.h not found when trying to build setup.py", "user": {"login": "Oratronic", "id": 39025648, "node_id": "MDQ6VXNlcjM5MDI1NjQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/39025648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Oratronic", "html_url": "https://github.com/Oratronic", "followers_url": "https://api.github.com/users/Oratronic/followers", "following_url": "https://api.github.com/users/Oratronic/following{/other_user}", "gists_url": "https://api.github.com/users/Oratronic/gists{/gist_id}", "starred_url": "https://api.github.com/users/Oratronic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Oratronic/subscriptions", "organizations_url": "https://api.github.com/users/Oratronic/orgs", "repos_url": "https://api.github.com/users/Oratronic/repos", "events_url": "https://api.github.com/users/Oratronic/events{/privacy}", "received_events_url": "https://api.github.com/users/Oratronic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-06-16T16:17:47Z", "updated_at": "2019-07-03T02:26:00Z", "closed_at": "2019-07-03T02:26:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "OS: macOS Sierra 10.12.6\r\nPyCharm Community 2019.1.3\r\n\r\nI tried to install the module in pycharm and got the error \"Module not found\", so I tried to install it manually via Terminal and as I ran \"python setup.py build\" I recieved the error, that sql.h that is referenced in src/pyodbc.h was not found.", "performed_via_github_app": null, "score": 1.0}]}