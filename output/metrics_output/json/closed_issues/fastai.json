{"total_count": 1071, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/fastai/fastai/issues/2639", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2639/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2639/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2639/events", "html_url": "https://github.com/fastai/fastai/issues/2639", "id": 681984180, "node_id": "MDU6SXNzdWU2ODE5ODQxODA=", "number": 2639, "title": "`Learner.summary` resets the `logger` from `print` to `fastai2.imports.noop` ", "user": {"login": "butchland", "id": 70889, "node_id": "MDQ6VXNlcjcwODg5", "avatar_url": "https://avatars0.githubusercontent.com/u/70889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/butchland", "html_url": "https://github.com/butchland", "followers_url": "https://api.github.com/users/butchland/followers", "following_url": "https://api.github.com/users/butchland/following{/other_user}", "gists_url": "https://api.github.com/users/butchland/gists{/gist_id}", "starred_url": "https://api.github.com/users/butchland/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/butchland/subscriptions", "organizations_url": "https://api.github.com/users/butchland/orgs", "repos_url": "https://api.github.com/users/butchland/repos", "events_url": "https://api.github.com/users/butchland/events{/privacy}", "received_events_url": "https://api.github.com/users/butchland/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-08-19T16:37:25Z", "updated_at": "2020-08-21T00:12:34Z", "closed_at": "2020-08-21T00:12:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nPlease confirm you have the latest versions of fastai, fastcore, fastscript, and nbdev prior to reporting a bug (delete one): YES \r\n\r\n**Describe the bug**\r\nCalling  `learner.summary()`  sets the `learner.logger` to `fastai2.imports.noop`.\r\nCalling `fit` methods no longer display the log.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\nsee the following [notebook gist ](https://gist.github.com/butchland/3ae1611f9d22c82878ccd8f853387102)([run in colab](https://colab.research.google.com/gist/butchland/3ae1611f9d22c82878ccd8f853387102/learner-logger-bug-demo-20200819.ipynb))\r\n\r\n**Expected behavior**\r\n\r\nCalling `summary` should not reset the `logger` to `noop` after being called. \r\nCalling `fit` should always display the log.\r\n\r\n**Error with full stack trace**\r\nN/A \r\n**Additional context**\r\nTried to figure out where in the callbacks (`ProgressCallback` is the most obvious suspect due to it \r\nsetting `learner.logger` back to `ProgressCallback.old_logger`) but couldn't find a fix myself.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2634", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2634/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2634/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2634/events", "html_url": "https://github.com/fastai/fastai/issues/2634", "id": 681489159, "node_id": "MDU6SXNzdWU2ODE0ODkxNTk=", "number": 2634, "title": "why all the tag/release is removed?", "user": {"login": "hubutui", "id": 2948593, "node_id": "MDQ6VXNlcjI5NDg1OTM=", "avatar_url": "https://avatars2.githubusercontent.com/u/2948593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hubutui", "html_url": "https://github.com/hubutui", "followers_url": "https://api.github.com/users/hubutui/followers", "following_url": "https://api.github.com/users/hubutui/following{/other_user}", "gists_url": "https://api.github.com/users/hubutui/gists{/gist_id}", "starred_url": "https://api.github.com/users/hubutui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hubutui/subscriptions", "organizations_url": "https://api.github.com/users/hubutui/orgs", "repos_url": "https://api.github.com/users/hubutui/repos", "events_url": "https://api.github.com/users/hubutui/events{/privacy}", "received_events_url": "https://api.github.com/users/hubutui/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-19T01:56:23Z", "updated_at": "2020-08-19T16:23:47Z", "closed_at": "2020-08-19T16:23:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is this project down?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2633", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2633/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2633/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2633/events", "html_url": "https://github.com/fastai/fastai/issues/2633", "id": 681246125, "node_id": "MDU6SXNzdWU2ODEyNDYxMjU=", "number": 2633, "title": "add_datepart() fails if there are NaT rows in a datetime column", "user": {"login": "kevinbird15", "id": 7451178, "node_id": "MDQ6VXNlcjc0NTExNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7451178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevinbird15", "html_url": "https://github.com/kevinbird15", "followers_url": "https://api.github.com/users/kevinbird15/followers", "following_url": "https://api.github.com/users/kevinbird15/following{/other_user}", "gists_url": "https://api.github.com/users/kevinbird15/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevinbird15/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevinbird15/subscriptions", "organizations_url": "https://api.github.com/users/kevinbird15/orgs", "repos_url": "https://api.github.com/users/kevinbird15/repos", "events_url": "https://api.github.com/users/kevinbird15/events{/privacy}", "received_events_url": "https://api.github.com/users/kevinbird15/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-18T18:29:45Z", "updated_at": "2020-08-20T03:33:33Z", "closed_at": "2020-08-20T03:33:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Please confirm you have the latest versions of fastai, fastcore, fastscript, and nbdev prior to reporting a bug (delete one): YES\r\nfastai2 0.0.30\r\nfastcore 0.1.38\r\nfastscript 0.1.13\r\nnbdev 0.2.40\r\n\r\n**Describe the bug**\r\nIf a datetime column has any null rows, the add_datepart function will fail.  \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. See code:\r\n```\r\nimport pandas as pd\r\nimport numpy as np\r\nfrom fastai2.tabular.all import *\r\n\r\ntmp_df = pd.DataFrame([['8/17/2020'],[np.nan],['8/18/2020']], columns=[\"datefield\"])\r\nadd_datepart(tmp_df, 'datefield')\r\n```\r\n**Expected behavior**\r\nI would expect everything to populate with None values but maybe other people would expect different behavior. \r\n\r\n**Error with full stack trace**\r\n\r\nPlace between these lines with triple backticks:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-1-b327ea20eb9a> in <module>\r\n      4 \r\n      5 tmp_df = pd.DataFrame([['8/17/2020'],[np.nan],['8/18/2020']], columns=[\"datefield\"])\r\n----> 6 add_datepart(tmp_df, 'datefield')\r\n\r\n/home/kevin/fastai/fastai2/tabular/core.py in add_datepart(df, field_name, prefix, drop, time)\r\n     32     if time: attr = attr + ['Hour', 'Minute', 'Second']\r\n     33     for n in attr: df[prefix + n] = getattr(field.dt, n.lower())\r\n---> 34     df[prefix + 'Elapsed'] = field.astype(np.int64) // 10 ** 9\r\n     35     if drop: df.drop(field_name, axis=1, inplace=True)\r\n     36     return df\r\n\r\n/opt/anaconda3/envs/fastai2/lib/python3.8/site-packages/pandas/core/generic.py in astype(self, dtype, copy, errors)\r\n   5535         else:\r\n   5536             # else, only a single dtype is given\r\n-> 5537             new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors,)\r\n   5538             return self._constructor(new_data).__finalize__(self, method=\"astype\")\r\n   5539 \r\n\r\n/opt/anaconda3/envs/fastai2/lib/python3.8/site-packages/pandas/core/internals/managers.py in astype(self, dtype, copy, errors)\r\n    565         self, dtype, copy: bool = False, errors: str = \"raise\"\r\n    566     ) -> \"BlockManager\":\r\n--> 567         return self.apply(\"astype\", dtype=dtype, copy=copy, errors=errors)\r\n    568 \r\n    569     def convert(\r\n\r\n/opt/anaconda3/envs/fastai2/lib/python3.8/site-packages/pandas/core/internals/managers.py in apply(self, f, align_keys, **kwargs)\r\n    394                 applied = b.apply(f, **kwargs)\r\n    395             else:\r\n--> 396                 applied = getattr(b, f)(**kwargs)\r\n    397             result_blocks = _extend_blocks(applied, result_blocks)\r\n    398 \r\n\r\n/opt/anaconda3/envs/fastai2/lib/python3.8/site-packages/pandas/core/internals/blocks.py in astype(self, dtype, copy, errors)\r\n   2092 \r\n   2093         # delegate\r\n-> 2094         return super().astype(dtype=dtype, copy=copy, errors=errors)\r\n   2095 \r\n   2096     def _can_hold_element(self, element: Any) -> bool:\r\n\r\n/opt/anaconda3/envs/fastai2/lib/python3.8/site-packages/pandas/core/internals/blocks.py in astype(self, dtype, copy, errors)\r\n    588             vals1d = values.ravel()\r\n    589             try:\r\n--> 590                 values = astype_nansafe(vals1d, dtype, copy=True)\r\n    591             except (ValueError, TypeError):\r\n    592                 # e.g. astype_nansafe can fail on object-dtype of strings\r\n\r\n/opt/anaconda3/envs/fastai2/lib/python3.8/site-packages/pandas/core/dtypes/cast.py in astype_nansafe(arr, dtype, copy, skipna)\r\n    924         elif dtype == np.int64:\r\n    925             if isna(arr).any():\r\n--> 926                 raise ValueError(\"Cannot convert NaT values to integer\")\r\n    927             return arr.view(dtype)\r\n    928 \r\n\r\nValueError: Cannot convert NaT values to integer\r\n```\r\n\r\n**Additional context**\r\nThis may be something that has been talked about, but I wasn't able to find any conversations about it.  To me, it would make sense if the datetime column is null, that it would be filled out with null values as well.  My proposal is to possibly change the line that is failing to check for NaT and if it is NaT, it would populate with None.  \r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2631", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2631/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2631/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2631/events", "html_url": "https://github.com/fastai/fastai/issues/2631", "id": 680831820, "node_id": "MDU6SXNzdWU2ODA4MzE4MjA=", "number": 2631, "title": "NameError: name 'get_ipython' is not defined``` by importing fastai2 command line", "user": {"login": "antorsae", "id": 1516746, "node_id": "MDQ6VXNlcjE1MTY3NDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1516746?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antorsae", "html_url": "https://github.com/antorsae", "followers_url": "https://api.github.com/users/antorsae/followers", "following_url": "https://api.github.com/users/antorsae/following{/other_user}", "gists_url": "https://api.github.com/users/antorsae/gists{/gist_id}", "starred_url": "https://api.github.com/users/antorsae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antorsae/subscriptions", "organizations_url": "https://api.github.com/users/antorsae/orgs", "repos_url": "https://api.github.com/users/antorsae/repos", "events_url": "https://api.github.com/users/antorsae/events{/privacy}", "received_events_url": "https://api.github.com/users/antorsae/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-18T09:10:30Z", "updated_at": "2020-08-19T19:14:33Z", "closed_at": "2020-08-19T19:14:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. `python -c 'import fastai2;import fastcore;print(fastai2.__version__);print(fastcore.__version__);from\r\nfastai2.basics import *'`\r\n\r\n**Expected behavior**\r\nNot crash\r\n\r\n**Error with full stack trace**\r\n\r\n```\r\n0.0.30\r\n0.1.35\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/home/antor/fastai2/fastai2/basics.py\", line 1, in <module>\r\n    from .data.all import *\r\n  File \"/home/antor/fastai2/fastai2/data/all.py\", line 1, in <module>\r\n    from ..torch_basics import *\r\n  File \"/home/antor/fastai2/fastai2/torch_basics.py\", line 2, in <module>\r\n    from .imports import *\r\n  File \"/home/antor/fastai2/fastai2/imports.py\", line 29, in <module>\r\n    from fastcore.all import *\r\n  File \"/home/antor/fastcore/fastcore/all.py\", line 3, in <module>\r\n    from .dispatch import *\r\n  File \"/home/antor/fastcore/fastcore/dispatch.py\", line 9, in <module>\r\n    from .utils import *\r\n  File \"/home/antor/fastcore/fastcore/utils.py\", line 782, in <module>\r\n    IN_IPYTHON,IN_JUPYTER,IN_COLAB,IN_NOTEBOOK = in_ipython(),in_jupyter(),in_colab(),in_notebook()\r\n  File \"/home/antor/fastcore/fastcore/utils.py\", line 774, in in_jupyter\r\n    return get_ipython().__class__.__name__ == 'ZMQInteractiveShell'\r\nNameError: name 'get_ipython' is not defined```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2628", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2628/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2628/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2628/events", "html_url": "https://github.com/fastai/fastai/issues/2628", "id": 680587265, "node_id": "MDU6SXNzdWU2ODA1ODcyNjU=", "number": 2628, "title": "Major bug regarding Augmentation and TensorPoint", "user": {"login": "muellerzr", "id": 7831895, "node_id": "MDQ6VXNlcjc4MzE4OTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/7831895?v=4", "gravatar_id": "", "url": "https://api.github.com/users/muellerzr", "html_url": "https://github.com/muellerzr", "followers_url": "https://api.github.com/users/muellerzr/followers", "following_url": "https://api.github.com/users/muellerzr/following{/other_user}", "gists_url": "https://api.github.com/users/muellerzr/gists{/gist_id}", "starred_url": "https://api.github.com/users/muellerzr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/muellerzr/subscriptions", "organizations_url": "https://api.github.com/users/muellerzr/orgs", "repos_url": "https://api.github.com/users/muellerzr/repos", "events_url": "https://api.github.com/users/muellerzr/events{/privacy}", "received_events_url": "https://api.github.com/users/muellerzr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-17T23:36:36Z", "updated_at": "2020-08-18T03:33:04Z", "closed_at": "2020-08-18T03:33:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In fastai2 v 0.0.17, the following would work as expected:\r\n```python\r\nitem_tfms = [Resize(448, method='squish')]\r\nbatch_tfms = [Flip(), Rotate(), Zoom(), Warp()]\r\n```\r\nWhere the outputted transformed image would have every point on the screen:\r\n\r\n![image](https://user-images.githubusercontent.com/7831895/90449211-f6f1d380-e0b4-11ea-8be6-df5e2160ec9e.png)\r\n\r\nHowever in the latest version, this fails, showing points off the screen. See two examples in the below batch:\r\n\r\n![image](https://user-images.githubusercontent.com/7831895/90449171-e93c4e00-e0b4-11ea-84e4-762ef186acca.png)\r\n\r\nWas there a major change that happened between the two? Why this becomes a problem from stemming such a little change is post fitting you run into a clumping issue. *Originally* when I found this bug it was due to resize not having \"squish\" along with the dataset being unclean, however extensive pre-processing was done to clean it. The notebook is available here (note this was run on 0.0.17):\r\n\r\n\r\nhttps://github.com/muellerzr/Practical-Deep-Learning-for-Coders-2.0/blob/master/Computer%20Vision/06_Keypoint_Regression.ipynb\r\n\r\n\r\nTwo examples, the first being expected (0.0.17), the latter being current, this is made extremely visible:\r\n\r\n![image](https://user-images.githubusercontent.com/7831895/90449345-3c160580-e0b5-11ea-998f-e602e3289e82.png)\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/7831895/90449353-40422300-e0b5-11ea-953c-59a156a8cd7e.png)\r\n\r\n\r\nI'll start looking into other possibilities if nothing is extremely obvious, but may take me a bit as I am back at work again.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2627", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2627/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2627/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2627/events", "html_url": "https://github.com/fastai/fastai/issues/2627", "id": 679662023, "node_id": "MDU6SXNzdWU2Nzk2NjIwMjM=", "number": 2627, "title": "Expected object of scalar type Float but got scalar type Long when plotting confusion matrix", "user": {"login": "vladimirkovacevic", "id": 16796045, "node_id": "MDQ6VXNlcjE2Nzk2MDQ1", "avatar_url": "https://avatars3.githubusercontent.com/u/16796045?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vladimirkovacevic", "html_url": "https://github.com/vladimirkovacevic", "followers_url": "https://api.github.com/users/vladimirkovacevic/followers", "following_url": "https://api.github.com/users/vladimirkovacevic/following{/other_user}", "gists_url": "https://api.github.com/users/vladimirkovacevic/gists{/gist_id}", "starred_url": "https://api.github.com/users/vladimirkovacevic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vladimirkovacevic/subscriptions", "organizations_url": "https://api.github.com/users/vladimirkovacevic/orgs", "repos_url": "https://api.github.com/users/vladimirkovacevic/repos", "events_url": "https://api.github.com/users/vladimirkovacevic/events{/privacy}", "received_events_url": "https://api.github.com/users/vladimirkovacevic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-16T00:06:45Z", "updated_at": "2020-08-17T23:04:18Z", "closed_at": "2020-08-17T23:04:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "When runing [data tutorial](https://github.com/fastai/fastai/blob/master/docs_src/tutorial.data.ipynb) for part with multilable classification of planet data after executing all the cells from this part I wanted to see the confussion matrix so I've added new cell:\r\n`interp = ClassificationInterpretation.from_learner(learn)'\r\n'interp.plot_confusion_matrix()`\r\nwhich gave me an error:\r\nExpected object of scalar type Float but got scalar type Long for argument #2 'other'\r\n\r\nI've found the issue regarding it on [fastai Github](https://github.com/fastai/fastai/issues/1801) saying there it should be fixed in the latest version, but I have fastai-1.0.61 and still getting the error. Does someone know the reason for this and is there a workaround?  ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2624", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2624/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2624/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2624/events", "html_url": "https://github.com/fastai/fastai/issues/2624", "id": 677673571, "node_id": "MDU6SXNzdWU2Nzc2NzM1NzE=", "number": 2624, "title": "ImageDataBunch.from_name_re issues a warning: \"The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0\"", "user": {"login": "chekhovana", "id": 6779698, "node_id": "MDQ6VXNlcjY3Nzk2OTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/6779698?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chekhovana", "html_url": "https://github.com/chekhovana", "followers_url": "https://api.github.com/users/chekhovana/followers", "following_url": "https://api.github.com/users/chekhovana/following{/other_user}", "gists_url": "https://api.github.com/users/chekhovana/gists{/gist_id}", "starred_url": "https://api.github.com/users/chekhovana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chekhovana/subscriptions", "organizations_url": "https://api.github.com/users/chekhovana/orgs", "repos_url": "https://api.github.com/users/chekhovana/repos", "events_url": "https://api.github.com/users/chekhovana/events{/privacy}", "received_events_url": "https://api.github.com/users/chekhovana/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-08-12T12:58:15Z", "updated_at": "2020-08-17T23:01:50Z", "closed_at": "2020-08-17T23:01:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n**Describe the bug**\r\n\r\nWhen executing [lesson 1 from fastai course](https://github.com/fastai/course-v3/blob/master/nbs/dl1/lesson1-pets.ipynb), statement:\r\n\r\n`data = ImageDataBunch.from_name_re(path_img, fnames, pat, ds_tfms=get_transforms(), size=224, bs=bs\r\n                                  ).normalize(imagenet_stats)`\r\n\r\nissues the following warning multiple times:\r\n\r\n`/usr/local/lib/python3.6/dist-packages/torch/nn/functional.py:3000: UserWarning: The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0 to align with other frameworks/libraries, and uses scale_factor directly, instead of relying on the computed output size. If you wish to keep the old behavior, please set recompute_scale_factor=True. See the documentation of nn.Upsample for details.`\r\n\r\n**Provide your installation details**\r\n\r\nI am using Google Colab.\r\n\r\npython        : 3.6.9\r\nfastai        : 1.0.61\r\nfastprogress  : 0.2.5\r\ntorch         : 1.6.0+cu101\r\nnvidia driver : 418.67\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\ngpu0      : 11441MB | Tesla K80\r\n\r\n=== Environment === \r\nplatform      : Linux-4.19.112+-x86_64-with-Ubuntu-18.04-bionic\r\ndistro        : #1 SMP Thu Jul 23 08:00:38 PDT 2020\r\nconda env     : Unknown\r\npython        : /usr/bin/python3\r\nsys.path      : \r\n/env/python\r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/usr/local/lib/python3.6/dist-packages\r\n/usr/lib/python3/dist-packages\r\n/usr/local/lib/python3.6/dist-packages/IPython/extensions\r\n/root/.ipython\r\n\r\n**To Reproduce**\r\n\r\nLaunch [lesson 1 from fastai course](https://github.com/fastai/course-v3/blob/master/nbs/dl1/lesson1-pets.ipynb) in Colab.\r\n\r\n**Expected behavior**\r\n\r\nWarning should be eliminated.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2622", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2622/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2622/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2622/events", "html_url": "https://github.com/fastai/fastai/issues/2622", "id": 676143031, "node_id": "MDU6SXNzdWU2NzYxNDMwMzE=", "number": 2622, "title": "RNNLearner get_preds does not work with training set", "user": {"login": "ishitatsuyuki", "id": 12389383, "node_id": "MDQ6VXNlcjEyMzg5Mzgz", "avatar_url": "https://avatars2.githubusercontent.com/u/12389383?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ishitatsuyuki", "html_url": "https://github.com/ishitatsuyuki", "followers_url": "https://api.github.com/users/ishitatsuyuki/followers", "following_url": "https://api.github.com/users/ishitatsuyuki/following{/other_user}", "gists_url": "https://api.github.com/users/ishitatsuyuki/gists{/gist_id}", "starred_url": "https://api.github.com/users/ishitatsuyuki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ishitatsuyuki/subscriptions", "organizations_url": "https://api.github.com/users/ishitatsuyuki/orgs", "repos_url": "https://api.github.com/users/ishitatsuyuki/repos", "events_url": "https://api.github.com/users/ishitatsuyuki/events{/privacy}", "received_events_url": "https://api.github.com/users/ishitatsuyuki/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-10T13:37:11Z", "updated_at": "2020-08-18T03:37:58Z", "closed_at": "2020-08-18T03:37:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n`RNNLearner.get_preds` fails with out-of-bound access. It doesn't seem to like the `drop_last` behavior of `train_dl`.\r\n\r\n```\r\n---------------------------------------------------------------------------\r\n\r\nIndexError                                Traceback (most recent call last)\r\n\r\n<ipython-input-6-2519d537b472> in <module>()\r\n----> 1 learn.get_preds(DatasetType.Train)\r\n\r\n1 frames\r\n\r\n/usr/local/lib/python3.6/dist-packages/fastai/text/learner.py in <listcomp>(.0)\r\n     93             sampler = [i for i in self.dl(ds_type).sampler]\r\n     94             reverse_sampler = np.argsort(sampler)\r\n---> 95             preds = [p[reverse_sampler] for p in preds]\r\n     96         return preds\r\n     97 \r\n\r\nIndexError: index 777 is out of bounds for dimension 0 with size 768\r\n```\r\n\r\n**Installation details**\r\nColab\r\n\r\n```text\r\n=== Software === \r\npython        : 3.6.9\r\nfastai        : 1.0.61\r\nfastprogress  : 0.2.4\r\ntorch         : 1.6.0+cu101\r\nnvidia driver : 418.67\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 11441MB | Tesla K80\r\n\r\n=== Environment === \r\nplatform      : Linux-4.19.112+-x86_64-with-Ubuntu-18.04-bionic\r\ndistro        : #1 SMP Thu Jul 23 08:00:38 PDT 2020\r\nconda env     : Unknown\r\npython        : /usr/bin/python3\r\nsys.path      : \r\n/env/python\r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/usr/local/lib/python3.6/dist-packages\r\n/usr/lib/python3/dist-packages\r\n/usr/local/lib/python3.6/dist-packages/IPython/extensions\r\n/root/.ipython\r\n```\r\n\r\n**Reproduction notebook**\r\nhttps://colab.research.google.com/drive/1evQCTzpQpBic8pqSIGx17RGp6vVq8vGk?usp=sharing\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2621", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2621/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2621/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2621/events", "html_url": "https://github.com/fastai/fastai/issues/2621", "id": 675630515, "node_id": "MDU6SXNzdWU2NzU2MzA1MTU=", "number": 2621, "title": "BrokenProcessPool: A process in the process pool was terminated abruptly while the future was running or pending.", "user": {"login": "jameswangcnbj", "id": 20034996, "node_id": "MDQ6VXNlcjIwMDM0OTk2", "avatar_url": "https://avatars3.githubusercontent.com/u/20034996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jameswangcnbj", "html_url": "https://github.com/jameswangcnbj", "followers_url": "https://api.github.com/users/jameswangcnbj/followers", "following_url": "https://api.github.com/users/jameswangcnbj/following{/other_user}", "gists_url": "https://api.github.com/users/jameswangcnbj/gists{/gist_id}", "starred_url": "https://api.github.com/users/jameswangcnbj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jameswangcnbj/subscriptions", "organizations_url": "https://api.github.com/users/jameswangcnbj/orgs", "repos_url": "https://api.github.com/users/jameswangcnbj/repos", "events_url": "https://api.github.com/users/jameswangcnbj/events{/privacy}", "received_events_url": "https://api.github.com/users/jameswangcnbj/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-09T03:51:56Z", "updated_at": "2020-08-17T23:04:52Z", "closed_at": "2020-08-17T23:04:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "=== Software ===\r\npython       : 3.8.4\r\nfastai       : 1.0.61\r\nfastprogress : 0.2.5\r\ntorch        : 1.5.1\r\ntorch cuda   : None / is **Not available**\r\n\r\n=== Hardware ===\r\nNo GPUs available\r\n\r\n=== Environment ===\r\nplatform     : macOS-10.13.6-x86_64-i386-64bit\r\nconda env    : torch\r\npython       : /Users/edz/Documents/anaconda/anaconda3/envs/torch/bin/python\r\nsys.path     :\r\n/Users/edz/Documents/anaconda/anaconda3/envs/torch/lib/python38.zip\r\n/Users/edz/Documents/anaconda/anaconda3/envs/torch/lib/python3.8\r\n/Users/edz/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/lib-dynload\r\n/Users/edz/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/site-packages\r\n\r\n\r\nwhen i run databunch = TextClasDataBunch.from_df(path, train, valid, test,\r\n                                      tokenizer=bert_fastai_tokenizer,\r\n                                      vocab=bert_vocab,\r\n                                      include_bos=False,\r\n                                      include_eos=False,\r\n                                      text_cols=\"comment\",\r\n                                      label_cols='sentiment',\r\n                                      bs=batch_size,\r\n                                      collate_fn=partial(pad_collate, pad_first=False, pad_idx=0),\r\n                                     )\r\nthen the error is blow:\r\n\r\n\r\n 0.00% [0/1 00:00<00:00]\r\n---------------------------------------------------------------------------\r\nBrokenProcessPool                         Traceback (most recent call last)\r\n<ipython-input-60-e12047de4d6b> in <module>\r\n----> 1 databunch = TextClasDataBunch.from_df(path, train, valid, test,\r\n      2                                       tokenizer=bert_fastai_tokenizer,\r\n      3                                       vocab=bert_vocab,\r\n      4                                       include_bos=False,\r\n      5                                       include_eos=False,\r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/site-packages/fastai/text/data.py in from_df(cls, path, train_df, valid_df, test_df, tokenizer, vocab, classes, text_cols, label_cols, label_delim, chunksize, max_vocab, min_freq, mark_fields, include_bos, include_eos, **kwargs)\r\n    203         else:\r\n    204             if label_delim is not None: src = src.label_from_df(cols=label_cols, classes=classes, label_delim=label_delim)\r\n--> 205             else: src = src.label_from_df(cols=label_cols, classes=classes)\r\n    206         if test_df is not None: src.add_test(TextList.from_df(test_df, path, cols=text_cols))\r\n    207         return src.databunch(**kwargs)\r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/site-packages/fastai/data_block.py in _inner(*args, **kwargs)\r\n    482             self.valid = fv(*args, from_item_lists=True, **kwargs)\r\n    483             self.__class__ = LabelLists\r\n--> 484             self.process()\r\n    485             return self\r\n    486         return _inner\r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/site-packages/fastai/data_block.py in process(self)\r\n    536         \"Process the inner datasets.\"\r\n    537         xp,yp = self.get_processors()\r\n--> 538         for ds,n in zip(self.lists, ['train','valid','test']): ds.process(xp, yp, name=n)\r\n    539         #progress_bar clear the outputs so in some case warnings issued during processing disappear.\r\n    540         for ds in self.lists:\r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/site-packages/fastai/data_block.py in process(self, xp, yp, name, max_warn_items)\r\n    716                     p.warns = []\r\n    717                 self.x,self.y = self.x[~filt],self.y[~filt]\r\n--> 718         self.x.process(xp)\r\n    719         return self\r\n    720 \r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/site-packages/fastai/data_block.py in process(self, processor)\r\n     82         if processor is not None: self.processor = processor\r\n     83         self.processor = listify(self.processor)\r\n---> 84         for p in self.processor: p.process(self)\r\n     85         return self\r\n     86 \r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/site-packages/fastai/text/data.py in process(self, ds)\r\n    295         tokens = []\r\n    296         for i in progress_bar(range(0,len(ds),self.chunksize), leave=False):\r\n--> 297             tokens += self.tokenizer.process_all(ds.items[i:i+self.chunksize])\r\n    298         ds.items = tokens\r\n    299 \r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/site-packages/fastai/text/transform.py in process_all(self, texts)\r\n    118         if self.n_cpus <= 1: return self._process_all_1(texts)\r\n    119         with ProcessPoolExecutor(self.n_cpus) as e:\r\n--> 120             return sum(e.map(self._process_all_1, partition_by_cores(texts, self.n_cpus)), [])\r\n    121 \r\n    122 class Vocab():\r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/concurrent/futures/process.py in _chain_from_iterable_of_lists(iterable)\r\n    482     careful not to keep references to yielded objects.\r\n    483     \"\"\"\r\n--> 484     for element in iterable:\r\n    485         element.reverse()\r\n    486         while element:\r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/concurrent/futures/_base.py in result_iterator()\r\n    609                     # Careful not to keep a reference to the popped future\r\n    610                     if timeout is None:\r\n--> 611                         yield fs.pop().result()\r\n    612                     else:\r\n    613                         yield fs.pop().result(end_time - time.monotonic())\r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/concurrent/futures/_base.py in result(self, timeout)\r\n    437                 raise CancelledError()\r\n    438             elif self._state == FINISHED:\r\n--> 439                 return self.__get_result()\r\n    440             else:\r\n    441                 raise TimeoutError()\r\n\r\n~/Documents/anaconda/anaconda3/envs/torch/lib/python3.8/concurrent/futures/_base.py in __get_result(self)\r\n    386     def __get_result(self):\r\n    387         if self._exception:\r\n--> 388             raise self._exception\r\n    389         else:\r\n    390             return self._result\r\n\r\nBrokenProcessPool: A process in the process pool was terminated abruptly while the future was running or pending.\r\n\r\nmy all code is:\r\nfrom fastai.text import *\r\nimport pandas as pd\r\ndf = pd.read_csv(\"Documents/pythonprj/torch_test/fastai/jupter/dianping.csv\")\r\nfrom sklearn.model_selection import train_test_split\r\ntrain, test = train_test_split(df, test_size=.2, random_state=2)\r\ntrain, valid = train_test_split(train, test_size=.2, random_state=2)\r\nfrom pytorch_transformers import BertTokenizer, BertForSequenceClassification\r\nbert_model = \"bert-base-chinese\"\r\nmax_seq_len = 128\r\nbatch_size = 32\r\nbert_tokenizer = BertTokenizer.from_pretrained(bert_model)\r\nbert_vocab = Vocab(list(bert_tokenizer.vocab.keys()))\r\nclass BertFastaiTokenizer(BaseTokenizer):\r\n    def __init__(self, tokenizer, max_seq_len=128, **kwargs):\r\n        self.pretrained_tokenizer = tokenizer\r\n        self.max_seq_len = max_seq_len\r\n\r\n    def __call__(self, *args, **kwargs):\r\n        return self\r\n\r\n    def tokenizer(self, t):\r\n        return [\"[CLS]\"] + self.pretrained_tokenizer.tokenize(t)[:self.max_seq_len - 2] + [\"[SEP]\"]\r\ntok_func = BertFastaiTokenizer(bert_tokenizer, max_seq_len=max_seq_len)\r\nbert_fastai_tokenizer = Tokenizer(\r\n    tok_func=tok_func,\r\n    pre_rules = [],\r\n    post_rules = []\r\n)\r\ndatabunch = TextClasDataBunch.from_df(path, train, valid, test,\r\n                                      tokenizer=bert_fastai_tokenizer,\r\n                                      vocab=bert_vocab,\r\n                                      include_bos=False,\r\n                                      include_eos=False,\r\n                                      text_cols=\"comment\",\r\n                                      label_cols='sentiment',\r\n                                      bs=batch_size,\r\n                                      collate_fn=partial(pad_collate, pad_first=False, pad_idx=0),\r\n                                     )\r\nwhen i run here,the error happen,my machine is mac on jupter notebook\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2619", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2619/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2619/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2619/events", "html_url": "https://github.com/fastai/fastai/issues/2619", "id": 673139112, "node_id": "MDU6SXNzdWU2NzMxMzkxMTI=", "number": 2619, "title": "metrics.accuracy_thresh() returns incorrect results", "user": {"login": "goerlitz", "id": 2389436, "node_id": "MDQ6VXNlcjIzODk0MzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/2389436?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goerlitz", "html_url": "https://github.com/goerlitz", "followers_url": "https://api.github.com/users/goerlitz/followers", "following_url": "https://api.github.com/users/goerlitz/following{/other_user}", "gists_url": "https://api.github.com/users/goerlitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/goerlitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goerlitz/subscriptions", "organizations_url": "https://api.github.com/users/goerlitz/orgs", "repos_url": "https://api.github.com/users/goerlitz/repos", "events_url": "https://api.github.com/users/goerlitz/events{/privacy}", "received_events_url": "https://api.github.com/users/goerlitz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-04T23:09:52Z", "updated_at": "2020-08-08T10:25:55Z", "closed_at": "2020-08-07T14:20:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n`metrics.accuracy_thresh()` does not return the correct accuracy - the calculated values seem to be too high (at least for the examples I checked). This accuracy metric is used in the [Planet Amazon Dataset](https://github.com/fastai/course-v3/blob/master/nbs/dl1/lesson3-planet.ipynb) notebook and I have used it for my own multi-label problem where I double checked the accuracy of the results returned by `get_preds()`. The [metric documentation](https://docs.fast.ai/metrics.html#accuracy_thresh) mentions *one-hot-encoded targets* and *multiclassification problem* but the examples and tests do not included any real multi-class or multi-label examples. It seems to me that `metrics.accuracy_thresh()` has been broken since the beginning.\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n```text\r\n=== Software === \r\npython       : 3.6.9\r\nfastai       : 1.0.61\r\nfastprogress : 0.2.3\r\ntorch        : 1.5.1\r\ntorch cuda   : 10.2 / is **Not available** \r\n\r\n=== Hardware === \r\nNo GPUs available \r\n\r\n=== Environment === \r\nplatform     : Linux-4.15.0-112-generic-x86_64-with-LinuxMint-19-tara\r\ndistro       : #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020\r\nconda env    : Unknown\r\npython       : /home/***/venv/bin/python3\r\nsys.path     : /usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n\r\n/home/***/venv/lib/python3.6/site-packages\r\n/home/***/venv/lib/python3.6/site-packages/IPython/extensions\r\n/home/goerlitz/.ipython\r\nno supported gpus found on this system\r\n```\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\nThis gist includes a reproducible example: https://gist.github.com/goerlitz/fb1230ee820406c5a9681249345fce3f\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\ncomputed accuracy should be correct.\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n\r\nFor multi-label predictions there are different possible ways how to compute the accuracy because a prediction may only match partially the target. I've included the computation of the accuracy for exact match and partial match in the gist. The way to calculate it is based on https://stats.stackexchange.com/questions/12702/what-are-the-measure-for-accuracy-of-multilabel-data", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2618", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2618/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2618/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2618/events", "html_url": "https://github.com/fastai/fastai/issues/2618", "id": 672018395, "node_id": "MDU6SXNzdWU2NzIwMTgzOTU=", "number": 2618, "title": "export() pickle filetype changed", "user": {"login": "delbarital", "id": 4951888, "node_id": "MDQ6VXNlcjQ5NTE4ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/4951888?v=4", "gravatar_id": "", "url": "https://api.github.com/users/delbarital", "html_url": "https://github.com/delbarital", "followers_url": "https://api.github.com/users/delbarital/followers", "following_url": "https://api.github.com/users/delbarital/following{/other_user}", "gists_url": "https://api.github.com/users/delbarital/gists{/gist_id}", "starred_url": "https://api.github.com/users/delbarital/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/delbarital/subscriptions", "organizations_url": "https://api.github.com/users/delbarital/orgs", "repos_url": "https://api.github.com/users/delbarital/repos", "events_url": "https://api.github.com/users/delbarital/events{/privacy}", "received_events_url": "https://api.github.com/users/delbarital/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-03T11:47:53Z", "updated_at": "2020-08-07T18:38:01Z", "closed_at": "2020-08-07T18:38:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Yesterday I tried to export a new version of my model and load it to production, but the load function failed.\r\nI noticed that the file icon on Google drive is different, but I couldn't understand what is going on. After reading the [release notes of Pytorch 1.6](https://github.com/pytorch/pytorch/releases) I realized that they changed the behavior of the torch.save() function. The pickle object is now saved in a new format. Basically they changed the pickle format to a zip file-based format.\r\n\r\nThere is an optional flag that you can pass to save it using the old format,  _use_new_zipfile_serialization=False, but fastai doesn't support it.\r\nTo overcome this problem I copied the relevant functions from the fastai library, export() and try_save() to my code and edited them to include this flag, but I'm pretty sure there is a better way to solve this.\r\n\r\nI guess this will be solved on fastai2, but I think this is an important enough issue to solve it for this version as well.\r\n\r\n\r\n    def export_fix(self, file:PathLikeOrBinaryStream='export.pkl', destroy=False):\r\n        \"Export the state of the `Learner` in `self.path/file`. `file` can be file-like (file or buffer)\"\r\n        if rank_distrib(): return # don't save if slave proc\r\n        args = ['opt_func', 'loss_func', 'metrics', 'true_wd', 'bn_wd', 'wd', 'train_bn', 'model_dir', 'callback_fns']\r\n        state = {a:getattr(self,a) for a in args}\r\n        state['cb_state'] = {cb.__class__:cb.get_state() for cb in self.callbacks}\r\n        #layer_groups -> need to find a way\r\n        #TO SEE: do we save model structure and weights separately?\r\n        with ModelOnCPU(self.model) as m:\r\n            state['model'] = m\r\n            xtra = dict(normalize=self.data.norm.keywords) if getattr(self.data, 'norm', False) else {}\r\n            state['data'] = self.data.valid_ds.get_state(**xtra)\r\n            state['cls'] = self.__class__\r\n            try_save_fix(state, self.path, file)\r\n        if destroy: self.destroy()\r\n\r\n    def try_save_fix(state:Dict, path:Path=None, file:PathLikeOrBinaryStream=None):\r\n        target = open(path/file, 'wb') if is_pathlike(file) else file\r\n        try: \r\n            with warnings.catch_warnings():\r\n                #To avoid the warning that come from PyTorch about model not being checked\r\n                warnings.simplefilter(\"ignore\")\r\n                torch.save(state, target,  _use_new_zipfile_serialization=False)\r\n        except OSError as e:\r\n            raise Exception(f\"{e}\\n Can't write {path/file}. Pass an absolute writable pathlib obj `fname`.\")\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2617", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2617/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2617/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2617/events", "html_url": "https://github.com/fastai/fastai/issues/2617", "id": 668638781, "node_id": "MDU6SXNzdWU2Njg2Mzg3ODE=", "number": 2617, "title": "learn_lm.save doesnt save current state", "user": {"login": "semaraugusto", "id": 21228764, "node_id": "MDQ6VXNlcjIxMjI4NzY0", "avatar_url": "https://avatars2.githubusercontent.com/u/21228764?v=4", "gravatar_id": "", "url": "https://api.github.com/users/semaraugusto", "html_url": "https://github.com/semaraugusto", "followers_url": "https://api.github.com/users/semaraugusto/followers", "following_url": "https://api.github.com/users/semaraugusto/following{/other_user}", "gists_url": "https://api.github.com/users/semaraugusto/gists{/gist_id}", "starred_url": "https://api.github.com/users/semaraugusto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/semaraugusto/subscriptions", "organizations_url": "https://api.github.com/users/semaraugusto/orgs", "repos_url": "https://api.github.com/users/semaraugusto/repos", "events_url": "https://api.github.com/users/semaraugusto/events{/privacy}", "received_events_url": "https://api.github.com/users/semaraugusto/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-30T11:41:07Z", "updated_at": "2020-08-02T23:20:00Z", "closed_at": "2020-08-02T23:19:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nI was training a language model and as it got to a certain loss I decided it was enough to train my classification model.\r\nDecided to learn_lm.save() and learn_lm.save_encoder(). \r\nHowever, the classification model was not performing well. I then decided to check the embeddings again just in case.\r\n\r\nI created the learn_lm learner again and did a learn_lm.load(). To check the metrics I ran learn_lm.validate().\r\nThe metrics were as if I had not trained the model at all.\r\n\r\nAlso, I think the learn_one_cycle() method is not saving intermediate states, check how much the loss went up as the cell 20 began to run. This seems to happen many times here.\r\n\r\n**Provide your installation details**\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n\r\n```text\r\n=== Software === \r\npython        : 3.8.0\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 440.33\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 3\r\ntorch devices : 3\r\n  - gpu0      : 12196MB | TITAN Xp\r\n  - gpu1      : 12196MB | TITAN Xp\r\n  - gpu2      : 12194MB | TITAN Xp\r\n\r\n=== Environment === \r\nplatform      : Linux-4.4.0-170-generic-x86_64-with-glibc2.17\r\ndistro        : #199-Ubuntu SMP Thu Nov 14 01:45:04 UTC 2019\r\nconda env     : base\r\npython        : /home/semar/.pyenv/versions/3.8.0/bin/python3.8\r\nsys.path      : /home/semar/embeddings-leis/notebooks\r\n/home/semar/.pyenv/versions/3.8.0/lib/python38.zip\r\n/home/semar/.pyenv/versions/3.8.0/lib/python3.8\r\n/home/semar/.pyenv/versions/3.8.0/lib/python3.8/lib-dynload\r\n\r\n/home/semar/.pyenv/versions/3.8.0/lib/python3.8/site-packages\r\n/home/semar/.pyenv/versions/3.8.0/lib/python3.8/site-packages/pycocotools-2.0-py3.8-linux-x86_64.egg\r\n/home/semar/.pyenv/versions/3.8.0/lib/python3.8/site-packages/IPython/extensions\r\n/home/semar/.ipython\r\n```\r\n\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2616", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2616/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2616/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2616/events", "html_url": "https://github.com/fastai/fastai/issues/2616", "id": 667155499, "node_id": "MDU6SXNzdWU2NjcxNTU0OTk=", "number": 2616, "title": "Updates for changes in PyTorch master Tensor subclassing behavior", "user": {"login": "ezyang", "id": 13564, "node_id": "MDQ6VXNlcjEzNTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/13564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezyang", "html_url": "https://github.com/ezyang", "followers_url": "https://api.github.com/users/ezyang/followers", "following_url": "https://api.github.com/users/ezyang/following{/other_user}", "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions", "organizations_url": "https://api.github.com/users/ezyang/orgs", "repos_url": "https://api.github.com/users/ezyang/repos", "events_url": "https://api.github.com/users/ezyang/events{/privacy}", "received_events_url": "https://api.github.com/users/ezyang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-07-28T15:14:13Z", "updated_at": "2020-08-07T14:17:35Z", "closed_at": "2020-08-07T14:17:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hey peeps,\r\n\r\nWe're going to be landing https://github.com/pytorch/pytorch/pull/37091 soon to master, which changes the default behavior of subclasses of Tensor. Previously, if you ran an operation on a tensor subclass, you'd get out a Tensor, rather than the subclass. With this PR, the default behavior changes, and you'll get back the subclass in the end.\r\n\r\nI heard that fastai uses `make_subclass` on Tensor, which is why I figured y'all might be affected. (Though I'm not exactly sure how it is being used.) Let me know if you have any questions.\r\n\r\ncc @hameerabbasi", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2615", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2615/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2615/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2615/events", "html_url": "https://github.com/fastai/fastai/issues/2615", "id": 665705140, "node_id": "MDU6SXNzdWU2NjU3MDUxNDA=", "number": 2615, "title": "TabularPandas (fastai v2) not setting self.loss_func for Regression", "user": {"login": "Dmayblom", "id": 45408696, "node_id": "MDQ6VXNlcjQ1NDA4Njk2", "avatar_url": "https://avatars0.githubusercontent.com/u/45408696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dmayblom", "html_url": "https://github.com/Dmayblom", "followers_url": "https://api.github.com/users/Dmayblom/followers", "following_url": "https://api.github.com/users/Dmayblom/following{/other_user}", "gists_url": "https://api.github.com/users/Dmayblom/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dmayblom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dmayblom/subscriptions", "organizations_url": "https://api.github.com/users/Dmayblom/orgs", "repos_url": "https://api.github.com/users/Dmayblom/repos", "events_url": "https://api.github.com/users/Dmayblom/events{/privacy}", "received_events_url": "https://api.github.com/users/Dmayblom/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-26T04:16:37Z", "updated_at": "2020-08-07T18:38:30Z", "closed_at": "2020-08-07T18:38:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "First time here so doing my best. Tried to simplify it as much as possible.\r\n\r\nOS : Windows 10 show_install() didn't work\r\n\r\nTabularPandas will set self.loss_func for a category y_name but not for regression. I tracked it down to Pipeline() at line 124 in core.py, then I got lost. Work around was to set it in the learner and everything worked.\r\n\r\n'''\r\n/fastai2/tabular/core.py \r\n\r\nline 124\r\n\r\n#       self.cat_names,self.cont_names,self.procs = L(cat_names),L(cont_names),Pipeline(procs)\r\n# expanded line to\r\n\r\n        self.cat_names = L(cat_names) \r\n        self.cont_names = L(cont_names)\r\n        \r\n        print('y_block : ', y_block)\r\n        print('procs : ', procs)\r\n\r\n        print('loss_func BEFORE PIPELINE()',hasattr( self, 'loss_func'))\r\n        \r\n        self.procs = Pipeline(procs)\r\n        \r\n        print('loss_func AFTER_PIPELINE()',hasattr( self, 'loss_func'))\r\n\r\n'''\r\n#IN\r\n\r\nCATEGORY_FIELD = ai.dep_vars[0]\r\nREGRESSION_FIELD = ai.dep_vars[1]\r\nprint('CATEGORY')\r\nTabularPandas(test_df, y_names=CATEGORY_FIELD, cat_names=ai.cat_names(), cont_names=ai.cont_names(),procs=[Categorify, FillMissing, Normalize])\r\n\r\nprint('\\nREGRESSION')\r\nTabularPandas(test_df, y_names=REGRESSION_FIELD, cat_names=ai.cat_names(), cont_names=ai.cont_names(),procs=[Categorify, FillMissing, Normalize])\r\n\r\nprint('\\nFINISHED')\r\n\r\n#OUT\r\n\r\nCATEGORY\r\ny_block :  <fastai2.data.block.TransformBlock object at 0x000001FE02A92DC8>\r\nprocs :  (#4) [<class 'fastai2.tabular.core.Categorify'>,<class 'fastai2.tabular.core.FillMissing'>,<class 'fastai2.data.transforms.Normalize'>,Categorize: (Tabular,object) -> encodes\r\n(object,object) -> encodes (Tabular,object) -> decodes\r\n(object,object) -> decodes]\r\nloss_func BEFORE PIPELINE() False\r\nloss_func AFTER_PIPELINE() True\r\n\r\nREGRESSION\r\ny_block :  <fastai2.data.block.TransformBlock object at 0x000001FE02A00C88>\r\nprocs :  (#4) [<class 'fastai2.tabular.core.Categorify'>,<class 'fastai2.tabular.core.FillMissing'>,<class 'fastai2.data.transforms.Normalize'>,RegressionSetup: (Tabular,object) -> encodes\r\n(object,object) -> encodes (Tabular,object) -> decodes\r\n(object,object) -> decodes]\r\nloss_func BEFORE PIPELINE() False\r\nloss_func AFTER_PIPELINE() False\r\n\r\nFINISHED\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2614", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2614/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2614/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2614/events", "html_url": "https://github.com/fastai/fastai/issues/2614", "id": 665572448, "node_id": "MDU6SXNzdWU2NjU1NzI0NDg=", "number": 2614, "title": "Fastai load runner taking CPU utilization high", "user": {"login": "nbhupendra", "id": 49706661, "node_id": "MDQ6VXNlcjQ5NzA2NjYx", "avatar_url": "https://avatars3.githubusercontent.com/u/49706661?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbhupendra", "html_url": "https://github.com/nbhupendra", "followers_url": "https://api.github.com/users/nbhupendra/followers", "following_url": "https://api.github.com/users/nbhupendra/following{/other_user}", "gists_url": "https://api.github.com/users/nbhupendra/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbhupendra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbhupendra/subscriptions", "organizations_url": "https://api.github.com/users/nbhupendra/orgs", "repos_url": "https://api.github.com/users/nbhupendra/repos", "events_url": "https://api.github.com/users/nbhupendra/events{/privacy}", "received_events_url": "https://api.github.com/users/nbhupendra/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-25T11:55:41Z", "updated_at": "2020-08-07T14:22:23Z", "closed_at": "2020-08-07T14:22:22Z", "author_association": "NONE", "active_lock_reason": null, "body": " Hi, I am the new user for fastai. I have trained model on GPU and now planning to deploy on CPU/VM. However on CPU, utilization go up to 350% every predict request i make. And if i open multiple process using gunicorn its just unmanageable. Kindly help.\r\n\r\npred_class, pred_idx, outputs = fastai_learner.predict(img_fastai). --- 3.5 Sec and 350% CPU on every request.\r\n\r\nAm i doing anything wrong?\r\n\r\nTrain on GPU-\r\nlearner= cnn_learner(data, models.resnet101, metrics=[accuracy, error_rate])\r\nlearner.fit_one_cycle(30)\r\nlearner.save('save_model')\r\nlearner.export('export.pkl')\r\n\r\nCPU-\r\nlearner = load_learner(model_fastai_path,model_fastai)\r\npred_class, pred_idx, outputs = fastai_learner.predict(img_fastai) - 3.5 Sec and 350% CPU on every request.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2613", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2613/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2613/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2613/events", "html_url": "https://github.com/fastai/fastai/issues/2613", "id": 665535912, "node_id": "MDU6SXNzdWU2NjU1MzU5MTI=", "number": 2613, "title": "word embedding dimension", "user": {"login": "dineshggaonkar", "id": 52095176, "node_id": "MDQ6VXNlcjUyMDk1MTc2", "avatar_url": "https://avatars2.githubusercontent.com/u/52095176?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dineshggaonkar", "html_url": "https://github.com/dineshggaonkar", "followers_url": "https://api.github.com/users/dineshggaonkar/followers", "following_url": "https://api.github.com/users/dineshggaonkar/following{/other_user}", "gists_url": "https://api.github.com/users/dineshggaonkar/gists{/gist_id}", "starred_url": "https://api.github.com/users/dineshggaonkar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dineshggaonkar/subscriptions", "organizations_url": "https://api.github.com/users/dineshggaonkar/orgs", "repos_url": "https://api.github.com/users/dineshggaonkar/repos", "events_url": "https://api.github.com/users/dineshggaonkar/events{/privacy}", "received_events_url": "https://api.github.com/users/dineshggaonkar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-25T07:29:18Z", "updated_at": "2020-08-07T14:22:36Z", "closed_at": "2020-08-07T14:22:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "if i wish to reduce word embedding dimension , do i also have to reduce number of hidden units? and by what factor?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2610", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2610/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2610/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2610/events", "html_url": "https://github.com/fastai/fastai/issues/2610", "id": 655410133, "node_id": "MDU6SXNzdWU2NTU0MTAxMzM=", "number": 2610, "title": "IndexError: list index out of range for `get_pred`", "user": {"login": "puraminy", "id": 5293185, "node_id": "MDQ6VXNlcjUyOTMxODU=", "avatar_url": "https://avatars1.githubusercontent.com/u/5293185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/puraminy", "html_url": "https://github.com/puraminy", "followers_url": "https://api.github.com/users/puraminy/followers", "following_url": "https://api.github.com/users/puraminy/following{/other_user}", "gists_url": "https://api.github.com/users/puraminy/gists{/gist_id}", "starred_url": "https://api.github.com/users/puraminy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/puraminy/subscriptions", "organizations_url": "https://api.github.com/users/puraminy/orgs", "repos_url": "https://api.github.com/users/puraminy/repos", "events_url": "https://api.github.com/users/puraminy/events{/privacy}", "received_events_url": "https://api.github.com/users/puraminy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-12T14:24:15Z", "updated_at": "2020-08-07T14:24:11Z", "closed_at": "2020-08-07T14:24:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "I loaded two learners saved by export function\r\n\r\n```\r\nlearn_fwd = load_learner(path + '/fwd_learn_c')\r\nlearn_bwd = load_learner(path + '/bwd_learn_c')\r\n\r\n```\r\nWhen I tried to call predict on them \r\n\r\n`pred_fwd,lbl_fwd = learn_fwd.get_preds(ordered=True)`\r\n\r\nI recieve the following error:\r\n\r\n\r\n\r\n\r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n<ipython-input-7-a8344f66cf4b> in <module>\r\n----> 1 pred_fwd,lbl_fwd = learn_fwd.get_preds(ordered=True)\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/text/learner.py in get_preds(self, ds_type, activ, with_loss, n_batch, pbar, ordered)\r\n     88         self.model.reset()\r\n     89         if ordered: np.random.seed(42)\r\n---> 90         preds = super().get_preds(ds_type=ds_type, activ=activ, with_loss=with_loss, n_batch=n_batch, pbar=pbar)\r\n     91         if ordered and hasattr(self.dl(ds_type), 'sampler'):\r\n     92             np.random.seed(42)\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/basic_train.py in get_preds(self, ds_type, activ, with_loss, n_batch, pbar)\r\n    339         callbacks = [cb(self) for cb in self.callback_fns + listify(defaults.extra_callback_fns)] + listify(self.callbacks)\r\n    340         return get_preds(self.model, self.dl(ds_type), cb_handler=CallbackHandler(callbacks),\r\n--> 341                          activ=activ, loss_func=lf, n_batch=n_batch, pbar=pbar)\r\n    342 \r\n    343     def pred_batch(self, ds_type:DatasetType=DatasetType.Valid, batch:Tuple=None, reconstruct:bool=False,\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/basic_train.py in get_preds(model, dl, pbar, cb_handler, activ, loss_func, n_batch)\r\n     42     \"Tuple of predictions and targets, and optional losses (if `loss_func`) using `dl`, max batches `n_batch`.\"\r\n     43     res = [to_float(torch.cat(o).cpu()) for o in\r\n---> 44            zip(*validate(model, dl, cb_handler=cb_handler, pbar=pbar, average=False, n_batch=n_batch))]\r\n     45     if loss_func is not None:\r\n     46         with NoneReduceOnCPU(loss_func) as lf: res.append(lf(res[0], res[1]))\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/basic_train.py in validate(model, dl, loss_func, cb_handler, pbar, average, n_batch)\r\n     55         val_losses,nums = [],[]\r\n     56         if cb_handler: cb_handler.set_dl(dl)\r\n---> 57         for xb,yb in progress_bar(dl, parent=pbar, leave=(pbar is not None)):\r\n     58             if cb_handler: xb, yb = cb_handler.on_batch_begin(xb, yb, train=False)\r\n     59             val_loss = loss_batch(model, xb, yb, loss_func, cb_handler=cb_handler)\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastprogress/fastprogress.py in __iter__(self)\r\n     45         except Exception as e:\r\n     46             self.on_interrupt()\r\n---> 47             raise e\r\n     48 \r\n     49     def update(self, val):\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastprogress/fastprogress.py in __iter__(self)\r\n     39         if self.total != 0: self.update(0)\r\n     40         try:\r\n---> 41             for i,o in enumerate(self.gen):\r\n     42                 if i >= self.total: break\r\n     43                 yield o\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/basic_data.py in __iter__(self)\r\n     73     def __iter__(self):\r\n     74         \"Process and returns items from `DataLoader`.\"\r\n---> 75         for b in self.dl: yield self.proc_batch(b)\r\n     76 \r\n     77     @classmethod\r\n\r\n~/miniconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py in __iter__(self)\r\n    277             return _SingleProcessDataLoaderIter(self)\r\n    278         else:\r\n--> 279             return _MultiProcessingDataLoaderIter(self)\r\n    280 \r\n    281     @property\r\n\r\n~/miniconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py in __init__(self, loader)\r\n    744         # prime the prefetch loop\r\n    745         for _ in range(2 * self._num_workers):\r\n--> 746             self._try_put_index()\r\n    747 \r\n    748     def _try_get_data(self, timeout=_utils.MP_STATUS_CHECK_INTERVAL):\r\n\r\n~/miniconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py in _try_put_index(self)\r\n    859         assert self._tasks_outstanding < 2 * self._num_workers\r\n    860         try:\r\n--> 861             index = self._next_index()\r\n    862         except StopIteration:\r\n    863             return\r\n\r\n~/miniconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py in _next_index(self)\r\n    337 \r\n    338     def _next_index(self):\r\n--> 339         return next(self._sampler_iter)  # may raise StopIteration\r\n    340 \r\n    341     def _next_data(self):\r\n\r\n~/miniconda3/lib/python3.7/site-packages/torch/utils/data/sampler.py in __iter__(self)\r\n    198     def __iter__(self):\r\n    199         batch = []\r\n--> 200         for idx in self.sampler:\r\n    201             batch.append(idx)\r\n    202             if len(batch) == self.batch_size:\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/text/data.py in __iter__(self)\r\n    103     def __len__(self) -> int: return len(self.data_source)\r\n    104     def __iter__(self):\r\n--> 105         return iter(sorted(range_of(self.data_source), key=self.key, reverse=True))\r\n    106 \r\n    107 class SortishSampler(Sampler):\r\n\r\nIndexError: list index out of range", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2609", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2609/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2609/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2609/events", "html_url": "https://github.com/fastai/fastai/issues/2609", "id": 655286217, "node_id": "MDU6SXNzdWU2NTUyODYyMTc=", "number": 2609, "title": "[Bug] ModuleNotFoundError: No module named fastai.structured", "user": {"login": "Priyansi", "id": 13217677, "node_id": "MDQ6VXNlcjEzMjE3Njc3", "avatar_url": "https://avatars3.githubusercontent.com/u/13217677?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Priyansi", "html_url": "https://github.com/Priyansi", "followers_url": "https://api.github.com/users/Priyansi/followers", "following_url": "https://api.github.com/users/Priyansi/following{/other_user}", "gists_url": "https://api.github.com/users/Priyansi/gists{/gist_id}", "starred_url": "https://api.github.com/users/Priyansi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Priyansi/subscriptions", "organizations_url": "https://api.github.com/users/Priyansi/orgs", "repos_url": "https://api.github.com/users/Priyansi/repos", "events_url": "https://api.github.com/users/Priyansi/events{/privacy}", "received_events_url": "https://api.github.com/users/Priyansi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-11T21:56:11Z", "updated_at": "2020-08-07T14:24:41Z", "closed_at": "2020-08-07T14:24:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nfastai cannot import structured.py because it has been discontinued from after fastai-1.0.x. But even after installing fastai-0.7, the error prevails because the `fastai.structured` code tries importing `Imputer` from `sklearn.impute`\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython        : 3.6.9\r\nfastai        : 1.0.61\r\nfastprogress  : 0.2.3\r\ntorch         : 1.5.1+cu101\r\nnvidia driver : 418.67\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 16280MB | Tesla P100-PCIE-16GB\r\n\r\n=== Environment === \r\nplatform      : Linux-4.19.104+-x86_64-with-Ubuntu-18.04-bionic\r\ndistro        : #1 SMP Wed Feb 19 05:26:34 PST 2020\r\nconda env     : Unknown\r\npython        : /usr/bin/python3\r\nsys.path      : \r\n/env/python\r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/usr/local/lib/python3.6/dist-packages\r\n/usr/lib/python3/dist-packages\r\n/usr/local/lib/python3.6/dist-packages/IPython/extensions\r\n/root/.ipython\r\n```\r\n\r\n**To Reproduce**\r\n1. Run the notebook [lesson-1-rf.ipynb](https://github.com/fastai/fastai/blob/master/courses/ml1/lesson1-rf.ipynb) in fastai/courses/ml1 in Google Colab.\r\n2. An error occurs on in the code block -\r\n```python\r\nfrom fastai.imports import *\r\nfrom fastai.structured import *\r\n\r\nfrom pandas_summary import DataFrameSummary\r\nfrom sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\r\nfrom IPython.display import display\r\n\r\nfrom sklearn import metrics\r\n```\r\nlike this -\r\n\r\nModuleNotFoundError                       Traceback (most recent call last)\r\n<ipython-input-1-713ddf51e021> in <module>()\r\n      1 from fastai.imports import *\r\n----> 2 from fastai.structured import *\r\n      3 \r\n      4 from pandas_summary import DataFrameSummary\r\n      5 from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\r\n\r\nModuleNotFoundError: No module named 'fastai.structured'\r\n\r\n**Expected behavior**\r\nExpected it to import all the modules without any error.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2606", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2606/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2606/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2606/events", "html_url": "https://github.com/fastai/fastai/issues/2606", "id": 652204344, "node_id": "MDU6SXNzdWU2NTIyMDQzNDQ=", "number": 2606, "title": "LearnerTensorboardWriter logs wrong train_loss numbers", "user": {"login": "TomConstru", "id": 56670806, "node_id": "MDQ6VXNlcjU2NjcwODA2", "avatar_url": "https://avatars2.githubusercontent.com/u/56670806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TomConstru", "html_url": "https://github.com/TomConstru", "followers_url": "https://api.github.com/users/TomConstru/followers", "following_url": "https://api.github.com/users/TomConstru/following{/other_user}", "gists_url": "https://api.github.com/users/TomConstru/gists{/gist_id}", "starred_url": "https://api.github.com/users/TomConstru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TomConstru/subscriptions", "organizations_url": "https://api.github.com/users/TomConstru/orgs", "repos_url": "https://api.github.com/users/TomConstru/repos", "events_url": "https://api.github.com/users/TomConstru/events{/privacy}", "received_events_url": "https://api.github.com/users/TomConstru/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-07T10:24:54Z", "updated_at": "2020-08-07T14:25:20Z", "closed_at": "2020-08-07T14:25:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi great Fastai team! first, great work on your amazing tool! it's a delight to use!\r\n\r\nI've recently started using the callback for tensorboard with fastai as shown in the docs: https://docs.fast.ai/callbacks.tensorboard.html\r\n\r\nI'm using cnn_learner with resnet 34 and learn.fit_one_cycle() (instead of learn.fit() which is in the doc), and I'm also using metrics accuracy_thresh in my learner. \r\n` \r\n\r\n    arch = models.resnet34\r\n    learn = cnn_learner(data, arch, metrics=accuracy_thresh)\r\n    learn.to_fp16()\r\n    # Tensorboard init line:\r\n    tboard_path = Path('/home/ubuntu/MultiClassLabeling/Tensorboard Data/' + projectName)\r\n    learn.callback_fns.append(partial(LearnerTensorboardWriter, base_dir=tboard_path, name=taskName))\r\n`\r\n\r\nTensorboard results of valid_loss and accuracy_thresh show correctly, however train_loss is completely wrong. \r\nvalid_loss:\r\n![image](https://user-images.githubusercontent.com/56670806/86767075-1fb59080-c054-11ea-901d-b9727cc3e48c.png)\r\n\r\ntrain_loss:\r\n![image](https://user-images.githubusercontent.com/56670806/86767113-2ba15280-c054-11ea-9dd7-7b398e21b757.png)\r\n\r\nI haven't changed anything in the fastai tensorboard.py file, so it shouldn't be the issue. \r\nHere is the terminal view of train_loss, valid_loss, accuracy_thresh:\r\n![image](https://user-images.githubusercontent.com/56670806/86767231-58ee0080-c054-11ea-98a5-79478b818673.png)\r\n\r\nwhat could be causing this?\r\n\r\ninformation about my installation:\r\n```text\r\n=== Software === \r\npython        : 3.6.9\r\nfastai        : 1.0.61\r\nfastprogress  : 0.2.3\r\ntorch         : 1.4.0\r\nnvidia driver : 440.33\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 4\r\ntorch devices : 4\r\n  - gpu0      : 16160MB | Tesla V100-SXM2-16GB\r\n  - gpu1      : 16160MB | Tesla V100-SXM2-16GB\r\n  - gpu2      : 16160MB | Tesla V100-SXM2-16GB\r\n  - gpu3      : 16160MB | Tesla V100-SXM2-16GB\r\n\r\n=== Environment === \r\nplatform      : Linux-5.3.0-1030-aws-x86_64-with-Ubuntu-18.04-bionic\r\ndistro        : #32~18.04.1-Ubuntu SMP Tue Jun 30 23:04:16 UTC 2020\r\nconda env     : Unknown\r\npython        : /home/ubuntu/MultiClassLabeling/myenv/bin/python\r\nsys.path      : \r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/home/ubuntu/MultiClassLabeling/myenv/lib/python3.6/site-packages\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2605", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2605/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2605/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2605/events", "html_url": "https://github.com/fastai/fastai/issues/2605", "id": 649814233, "node_id": "MDU6SXNzdWU2NDk4MTQyMzM=", "number": 2605, "title": "ValueError: __len__() should return >= 0,while using nlp", "user": {"login": "swetha303112", "id": 63325721, "node_id": "MDQ6VXNlcjYzMzI1NzIx", "avatar_url": "https://avatars1.githubusercontent.com/u/63325721?v=4", "gravatar_id": "", "url": "https://api.github.com/users/swetha303112", "html_url": "https://github.com/swetha303112", "followers_url": "https://api.github.com/users/swetha303112/followers", "following_url": "https://api.github.com/users/swetha303112/following{/other_user}", "gists_url": "https://api.github.com/users/swetha303112/gists{/gist_id}", "starred_url": "https://api.github.com/users/swetha303112/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/swetha303112/subscriptions", "organizations_url": "https://api.github.com/users/swetha303112/orgs", "repos_url": "https://api.github.com/users/swetha303112/repos", "events_url": "https://api.github.com/users/swetha303112/events{/privacy}", "received_events_url": "https://api.github.com/users/swetha303112/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-02T10:18:27Z", "updated_at": "2020-08-07T14:25:34Z", "closed_at": "2020-08-07T14:25:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2604", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2604/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2604/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2604/events", "html_url": "https://github.com/fastai/fastai/issues/2604", "id": 649792661, "node_id": "MDU6SXNzdWU2NDk3OTI2NjE=", "number": 2604, "title": "save model structure", "user": {"login": "leeqiaogithub", "id": 14501793, "node_id": "MDQ6VXNlcjE0NTAxNzkz", "avatar_url": "https://avatars1.githubusercontent.com/u/14501793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leeqiaogithub", "html_url": "https://github.com/leeqiaogithub", "followers_url": "https://api.github.com/users/leeqiaogithub/followers", "following_url": "https://api.github.com/users/leeqiaogithub/following{/other_user}", "gists_url": "https://api.github.com/users/leeqiaogithub/gists{/gist_id}", "starred_url": "https://api.github.com/users/leeqiaogithub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leeqiaogithub/subscriptions", "organizations_url": "https://api.github.com/users/leeqiaogithub/orgs", "repos_url": "https://api.github.com/users/leeqiaogithub/repos", "events_url": "https://api.github.com/users/leeqiaogithub/events{/privacy}", "received_events_url": "https://api.github.com/users/leeqiaogithub/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-02T09:44:36Z", "updated_at": "2020-08-07T14:25:44Z", "closed_at": "2020-08-07T14:25:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "How do I save the model structure?any suggestion will be helpful.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2603", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2603/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2603/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2603/events", "html_url": "https://github.com/fastai/fastai/issues/2603", "id": 648345853, "node_id": "MDU6SXNzdWU2NDgzNDU4NTM=", "number": 2603, "title": "apply_tfms(resize_method=ResizeMethod.PAD) does not add padding", "user": {"login": "micimize", "id": 8343799, "node_id": "MDQ6VXNlcjgzNDM3OTk=", "avatar_url": "https://avatars1.githubusercontent.com/u/8343799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/micimize", "html_url": "https://github.com/micimize", "followers_url": "https://api.github.com/users/micimize/followers", "following_url": "https://api.github.com/users/micimize/following{/other_user}", "gists_url": "https://api.github.com/users/micimize/gists{/gist_id}", "starred_url": "https://api.github.com/users/micimize/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/micimize/subscriptions", "organizations_url": "https://api.github.com/users/micimize/orgs", "repos_url": "https://api.github.com/users/micimize/repos", "events_url": "https://api.github.com/users/micimize/events{/privacy}", "received_events_url": "https://api.github.com/users/micimize/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-30T17:06:16Z", "updated_at": "2020-08-07T15:14:58Z", "closed_at": "2020-08-07T14:26:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "It does not appear to be possible to pad images with `apply_tfms` (and thus `.transform`). Here is a minimum reproduction:\r\n```python\r\nfrom fastai.vision import *\r\n\r\npath = untar_data(URLs.MNIST)\r\nil = ImageList.from_folder(path, convert_mode='L')\r\ndefaults.cmap='binary'\r\nll = il.split_by_folder(train='training', valid='testing').label_from_folder()\r\nx = ll.train[0][0]\r\n\r\nx.show() # x.shape is 1x28x28\r\n\r\ncrop_pad(x.clone(), padding_mode='zeros', size=int(16 * 28)).show() # pads correctly\r\n\r\nx.clone().apply_tfms(\r\n    [crop_pad(padding_mode='zeros')],\r\n    size=int(16 * 28), \r\n    resize_method=ResizeMethod.PAD,\r\n    padding_mode='zeros'\r\n).show() # resizes without padding\r\n```\r\n\r\nwhich yields: \r\n![image](https://user-images.githubusercontent.com/8343799/86155003-6d1c8580-bac9-11ea-908d-61c328175122.png)\r\n\r\nThis is because before applying any transforms, `x.resize(target)` is called, which scales the image up:\r\nhttps://github.com/fastai/fastai/blob/8be0c6f707808c23374c478313e7aed645871a05/fastai/vision/image.py#L110-L114\r\n\r\nCommenting out the resize in an extracted version yields expected results", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2601", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2601/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2601/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2601/events", "html_url": "https://github.com/fastai/fastai/issues/2601", "id": 647256967, "node_id": "MDU6SXNzdWU2NDcyNTY5Njc=", "number": 2601, "title": "gpt predict", "user": {"login": "Ontheroad123", "id": 31181026, "node_id": "MDQ6VXNlcjMxMTgxMDI2", "avatar_url": "https://avatars3.githubusercontent.com/u/31181026?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ontheroad123", "html_url": "https://github.com/Ontheroad123", "followers_url": "https://api.github.com/users/Ontheroad123/followers", "following_url": "https://api.github.com/users/Ontheroad123/following{/other_user}", "gists_url": "https://api.github.com/users/Ontheroad123/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ontheroad123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ontheroad123/subscriptions", "organizations_url": "https://api.github.com/users/Ontheroad123/orgs", "repos_url": "https://api.github.com/users/Ontheroad123/repos", "events_url": "https://api.github.com/users/Ontheroad123/events{/privacy}", "received_events_url": "https://api.github.com/users/Ontheroad123/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-29T10:11:56Z", "updated_at": "2020-07-02T00:33:31Z", "closed_at": "2020-07-02T00:33:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "i have train a classify model,when i predit a img like Official website:\r\n```\r\ndata = ImageDataBunch.from_folder(path_img, valid_pct=0.2)\r\nlearn = cnn_learner(data, models.resnet18, metrics=[accuracy])\r\n...\r\n...\r\nimg = data.train_ds[0][0]\r\nprint(img.shape)\r\n#print(img.type)\r\nlearn = load_learner('./classify_dataset')\r\npre = learn.predict(img)\r\nprint(pre) \r\n```\r\noutput:\r\ntorch.Size([3, 512, 512])\r\n(Category 0, tensor(0), tensor([9.9997e-01, 1.2070e-07, 2.6853e-05]))\r\n\r\nbut when i use gpu predict:\r\n\r\n```\r\nfastai_model = load_learner(path=\"./\", file=fastai_path).model\r\nimg = np.array(Image.open('./pingsao/1.png'))\r\nimg = img / 255\r\ntensor_img = torch.zeros((1, 3, 512, 512))\r\nfor i in range(3):\r\n     tensor_img[:, i, :, :] = torch.from_numpy(img)\r\n tensor_img = tensor_img.float()\r\n tensor_img = tensor_img.cuda()\r\n print(tensor_img.shape)\r\n res_liver = fastai_model(tensor_img)\r\n print(res_liver)    \r\n```\r\n\r\n output:\r\nFile \"pre.py\", line 37, in <module>\r\n    res_liver = fastai_model(tensor_img)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/torch/nn/modules/container.py\", line 100, in forward\r\n    input = module(input)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/torch/nn/modules/container.py\", line 100, in forward\r\n    input = module(input)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 532, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/torch/nn/modules/batchnorm.py\", line 107, in forward\r\n    exponential_average_factor, self.eps)\r\n  File \"/usr/local/anaconda3/lib/python3.6/site-packages/torch/nn/functional.py\", line 1666, in batch_norm\r\n    raise ValueError('Expected more than 1 value per channel when training, got input size {}'.format(size))\r\nValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 1024])\r\n\r\nit seems like the first channel not enough, but the first channel is batch_size,it is random,anyone can give me some advice?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2600", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2600/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2600/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2600/events", "html_url": "https://github.com/fastai/fastai/issues/2600", "id": 645836238, "node_id": "MDU6SXNzdWU2NDU4MzYyMzg=", "number": 2600, "title": "RuntimeError: Only tensors or tuples of tensors can be output from traced functions", "user": {"login": "luminousmen", "id": 9168534, "node_id": "MDQ6VXNlcjkxNjg1MzQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/9168534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luminousmen", "html_url": "https://github.com/luminousmen", "followers_url": "https://api.github.com/users/luminousmen/followers", "following_url": "https://api.github.com/users/luminousmen/following{/other_user}", "gists_url": "https://api.github.com/users/luminousmen/gists{/gist_id}", "starred_url": "https://api.github.com/users/luminousmen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luminousmen/subscriptions", "organizations_url": "https://api.github.com/users/luminousmen/orgs", "repos_url": "https://api.github.com/users/luminousmen/repos", "events_url": "https://api.github.com/users/luminousmen/events{/privacy}", "received_events_url": "https://api.github.com/users/luminousmen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-25T20:37:47Z", "updated_at": "2020-08-07T14:26:27Z", "closed_at": "2020-08-07T14:26:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have been trying to convert fast.ai default AWD_LSTM model to TorchScript format and got the following error:\r\n\r\n```RuntimeError: Only tensors or tuples of tensors can be output from traced functions (getOutput at /opt/conda/conda-bld/pytorch_1579022060824/work/torch/csrc/jit/tracer.cpp:212)```\r\n\r\nOutput of the show_install:\r\n\r\n```text\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 450.36\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 16278MB | Quadro P5000\r\n\r\n=== Environment === \r\nplatform      : Linux-4.15.0-72-generic-x86_64-with-debian-stretch-sid\r\ndistro        : #81~16.04.1-Ubuntu SMP Tue Nov 26 16:34:21 UTC 2019\r\nconda env     : fastai\r\npython        : /opt/conda/envs/fastai/bin/python\r\nsys.path      : /notebooks\r\n/opt/conda/envs/fastai/lib/python37.zip\r\n/opt/conda/envs/fastai/lib/python3.7\r\n/opt/conda/envs/fastai/lib/python3.7/lib-dynload\r\n\r\n/opt/conda/envs/fastai/lib/python3.7/site-packages\r\n/opt/conda/envs/fastai/lib/python3.7/site-packages/IPython/extensions\r\n/root/.ipython\r\n```\r\n\r\nThe whole code with the full stack trace can be found here https://gist.github.com/luminousmen/c891af01748fcf62ec46ff6d9e2fa4dc ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2597", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2597/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2597/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2597/events", "html_url": "https://github.com/fastai/fastai/issues/2597", "id": 643639472, "node_id": "MDU6SXNzdWU2NDM2Mzk0NzI=", "number": 2597, "title": "Error importing fastai.vision", "user": {"login": "rtapan25", "id": 61557088, "node_id": "MDQ6VXNlcjYxNTU3MDg4", "avatar_url": "https://avatars2.githubusercontent.com/u/61557088?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rtapan25", "html_url": "https://github.com/rtapan25", "followers_url": "https://api.github.com/users/rtapan25/followers", "following_url": "https://api.github.com/users/rtapan25/following{/other_user}", "gists_url": "https://api.github.com/users/rtapan25/gists{/gist_id}", "starred_url": "https://api.github.com/users/rtapan25/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rtapan25/subscriptions", "organizations_url": "https://api.github.com/users/rtapan25/orgs", "repos_url": "https://api.github.com/users/rtapan25/repos", "events_url": "https://api.github.com/users/rtapan25/events{/privacy}", "received_events_url": "https://api.github.com/users/rtapan25/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-23T08:30:00Z", "updated_at": "2020-08-07T14:26:38Z", "closed_at": "2020-08-07T14:26:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have been trying to import fastai.vision but am greeted by the following error:\r\nImportError: cannot import name 'master_bar' from 'fastprogress'\r\n\r\nTraceback:\r\nImportError                               Traceback (most recent call last)\r\n<ipython-input-14-63b1e6c600e9> in <module>\r\n      2 import numpy as np\r\n      3 from fastprogress.fastprogress import master_bar, progress_bar\r\n----> 4 from fastai.vision import *\r\n      5 import matplotlib.pyplot as plt\r\n      6 pd.set_option('display.max_columns', 500)\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\torc\\lib\\site-packages\\fastai\\__init__.py in <module>\r\n----> 1 from .basic_train import *\r\n      2 from .callback import *\r\n      3 #from .callbacks import *\r\n      4 from .core import *\r\n      5 from .basic_data import *\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\torc\\lib\\site-packages\\fastai\\basic_train.py in <module>\r\n      1 \"Provides basic training and validation with `Learner`\"\r\n----> 2 from .torch_core import *\r\n      3 from .basic_data import *\r\n      4 from .callback import *\r\n      5 \r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\torc\\lib\\site-packages\\fastai\\torch_core.py in <module>\r\n      1 \"Utility functions to help deal with tensors\"\r\n----> 2 from .imports.torch import *\r\n      3 from .core import *\r\n      4 \r\n      5 AffineMatrix = Tensor\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\torc\\lib\\site-packages\\fastai\\imports\\__init__.py in <module>\r\n----> 1 from .core import *\r\n      2 from .torch import *\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\torc\\lib\\site-packages\\fastai\\imports\\core.py in <module>\r\n     13 from dataclasses import dataclass, field\r\n     14 from enum import Enum, IntEnum\r\n---> 15 from fastprogress import master_bar, progress_bar\r\n     16 from functools import partial, reduce, singledispatch\r\n     17 from pdb import set_trace\r\n\r\nImportError: cannot import name 'master_bar' from 'fastprogress' (~AppData\\Local\\Continuum\\anaconda3\\envs\\torc\\lib\\site-packages\\fastprogress\\__init__.py)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2595", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2595/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2595/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2595/events", "html_url": "https://github.com/fastai/fastai/issues/2595", "id": 639906571, "node_id": "MDU6SXNzdWU2Mzk5MDY1NzE=", "number": 2595, "title": "OSError: [WinError 126] The specified module could not be found", "user": {"login": "gjurcin", "id": 29597874, "node_id": "MDQ6VXNlcjI5NTk3ODc0", "avatar_url": "https://avatars3.githubusercontent.com/u/29597874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gjurcin", "html_url": "https://github.com/gjurcin", "followers_url": "https://api.github.com/users/gjurcin/followers", "following_url": "https://api.github.com/users/gjurcin/following{/other_user}", "gists_url": "https://api.github.com/users/gjurcin/gists{/gist_id}", "starred_url": "https://api.github.com/users/gjurcin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gjurcin/subscriptions", "organizations_url": "https://api.github.com/users/gjurcin/orgs", "repos_url": "https://api.github.com/users/gjurcin/repos", "events_url": "https://api.github.com/users/gjurcin/events{/privacy}", "received_events_url": "https://api.github.com/users/gjurcin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-16T19:05:48Z", "updated_at": "2020-06-16T20:09:35Z", "closed_at": "2020-06-16T20:09:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "i am trying to import fastai packages and i am getting this issue, OSError: [WinError 126] The specified module could not be found. I have tried to install openslide but again i have the same problem\r\n\r\n---------------------------------------------------------------------------\r\nOSError                                   Traceback (most recent call last)\r\n<ipython-input-2-713ddf51e021> in <module>\r\n----> 1 from fastai.imports import *\r\n      2 from fastai.structured import *\r\n      3 \r\n      4 from pandas_summary import DataFrameSummary\r\n      5 from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\r\n\r\n~\\Anaconda3\\envs\\fastai\\lib\\site-packages\\fastai\\imports\\__init__.py in <module>\r\n      1 from .core import *\r\n----> 2 from .torch import *\r\n\r\n~\\Anaconda3\\envs\\fastai\\lib\\site-packages\\fastai\\imports\\torch.py in <module>\r\n----> 1 import torch, torch.nn.functional as F\r\n      2 from torch import ByteTensor, DoubleTensor, FloatTensor, HalfTensor, LongTensor, ShortTensor, Tensor\r\n      3 from torch import nn, optim, as_tensor\r\n      4 from torch.utils.data import BatchSampler, DataLoader, Dataset, Sampler, TensorDataset\r\n      5 from torch.nn.utils import weight_norm, spectral_norm\r\n\r\n~\\Anaconda3\\envs\\fastai\\lib\\site-packages\\torch\\__init__.py in <module>\r\n     79     dlls = glob.glob(os.path.join(th_dll_path, '*.dll'))\r\n     80     for dll in dlls:\r\n---> 81         ctypes.CDLL(dll)\r\n     82 \r\n     83 \r\n\r\n~\\Anaconda3\\envs\\fastai\\lib\\ctypes\\__init__.py in __init__(self, name, mode, handle, use_errno, use_last_error)\r\n    362 \r\n    363         if handle is None:\r\n--> 364             self._handle = _dlopen(self._name, mode)\r\n    365         else:\r\n    366             self._handle = handle\r\n\r\nOSError: [WinError 126] The specified module could not be found ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2593", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2593/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2593/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2593/events", "html_url": "https://github.com/fastai/fastai/issues/2593", "id": 639024994, "node_id": "MDU6SXNzdWU2MzkwMjQ5OTQ=", "number": 2593, "title": "Tokenizer is applied to labels instead of text for multifit  classifier", "user": {"login": "suryapa1", "id": 6042186, "node_id": "MDQ6VXNlcjYwNDIxODY=", "avatar_url": "https://avatars0.githubusercontent.com/u/6042186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suryapa1", "html_url": "https://github.com/suryapa1", "followers_url": "https://api.github.com/users/suryapa1/followers", "following_url": "https://api.github.com/users/suryapa1/following{/other_user}", "gists_url": "https://api.github.com/users/suryapa1/gists{/gist_id}", "starred_url": "https://api.github.com/users/suryapa1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suryapa1/subscriptions", "organizations_url": "https://api.github.com/users/suryapa1/orgs", "repos_url": "https://api.github.com/users/suryapa1/repos", "events_url": "https://api.github.com/users/suryapa1/events{/privacy}", "received_events_url": "https://api.github.com/users/suryapa1/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-15T17:40:16Z", "updated_at": "2020-08-07T14:27:02Z", "closed_at": "2020-08-07T14:27:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<img width=\"1013\" alt=\"Screenshot 2020-06-15 at 11 02 29 PM\" src=\"https://user-images.githubusercontent.com/6042186/84688489-0c376e00-af5d-11ea-885c-fa99e760db90.png\">\r\n\r\n\r\n1) How to put text to be tokenized in abve screesnshot?\r\n2)Any specifc structure is expected for multifit , though am maintaining train.csv/test.csv under data/sentimental/ folder path as per above screenshot.\r\n3) Though i have shuffled train.csv( label & text ), why it is not applied in run time, is there any cache needs to be handled here ??", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2591", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2591/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2591/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2591/events", "html_url": "https://github.com/fastai/fastai/issues/2591", "id": 638116857, "node_id": "MDU6SXNzdWU2MzgxMTY4NTc=", "number": 2591, "title": "AWD LSTM dropout makes 'weight_hh_l0' a leaf Parameter rather a non-leaf Tensor", "user": {"login": "Zhong-Zhang", "id": 42954562, "node_id": "MDQ6VXNlcjQyOTU0NTYy", "avatar_url": "https://avatars3.githubusercontent.com/u/42954562?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zhong-Zhang", "html_url": "https://github.com/Zhong-Zhang", "followers_url": "https://api.github.com/users/Zhong-Zhang/followers", "following_url": "https://api.github.com/users/Zhong-Zhang/following{/other_user}", "gists_url": "https://api.github.com/users/Zhong-Zhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zhong-Zhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zhong-Zhang/subscriptions", "organizations_url": "https://api.github.com/users/Zhong-Zhang/orgs", "repos_url": "https://api.github.com/users/Zhong-Zhang/repos", "events_url": "https://api.github.com/users/Zhong-Zhang/events{/privacy}", "received_events_url": "https://api.github.com/users/Zhong-Zhang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "jph00", "id": 346999, "node_id": "MDQ6VXNlcjM0Njk5OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/346999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jph00", "html_url": "https://github.com/jph00", "followers_url": "https://api.github.com/users/jph00/followers", "following_url": "https://api.github.com/users/jph00/following{/other_user}", "gists_url": "https://api.github.com/users/jph00/gists{/gist_id}", "starred_url": "https://api.github.com/users/jph00/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jph00/subscriptions", "organizations_url": "https://api.github.com/users/jph00/orgs", "repos_url": "https://api.github.com/users/jph00/repos", "events_url": "https://api.github.com/users/jph00/events{/privacy}", "received_events_url": "https://api.github.com/users/jph00/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jph00", "id": 346999, "node_id": "MDQ6VXNlcjM0Njk5OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/346999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jph00", "html_url": "https://github.com/jph00", "followers_url": "https://api.github.com/users/jph00/followers", "following_url": "https://api.github.com/users/jph00/following{/other_user}", "gists_url": "https://api.github.com/users/jph00/gists{/gist_id}", "starred_url": "https://api.github.com/users/jph00/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jph00/subscriptions", "organizations_url": "https://api.github.com/users/jph00/orgs", "repos_url": "https://api.github.com/users/jph00/repos", "events_url": "https://api.github.com/users/jph00/events{/privacy}", "received_events_url": "https://api.github.com/users/jph00/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-06-13T07:49:36Z", "updated_at": "2020-08-09T17:15:37Z", "closed_at": "2020-08-07T18:42:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "In file **awd_lstm.py**, at class **WeightDropout**, there is a code in functions **__init__** and **reset**:\r\n`\r\nself.module._parameters[layer] = F.dropout(raw_w, p=self.weight_p, training=False)\r\n`\r\n\r\nThe 'self.module._parameters[layer]' here is typically LSTM's Parameter 'weight_hh_l0'.\r\n\r\nWith training=False, F.dropout doesn't do anything, which makes the output identical to 'raw_w', i.e., a shallow copy. The problem is, raw_w is a Parameter (leaf), but from my understanding, 'weight_hh_l0' should be an intermediate Tensor (non-leaf) which is computed from 'raw_w'.\r\n\r\nThis could cause side effects, e.g., one might accidentally put non-leaf variables if calling model.parameters() into the optimizer or get error from function clip_grad_norm_.\r\n\r\nHere is my patch for this issue, I'm willing to do a PR if I'm correct.\r\n\r\n`def __init__`\r\n```\r\n            # self.module._parameters[layer] = F.dropout(w, p=self.weight_p, training=False)\r\n            del self.module._parameters[layer]\r\n            setattr(self.module, layer, self._mask_dropout(w, self.weight_p, training=False)) # make it a tensor not parameter\r\n```\r\n\r\n`def _setweights`\r\n```\r\n            # self.module._parameters[layer] = F.dropout(raw_w, p=self.weight_p, training=self.training)\r\n            # if self.idxs is not None: self.module._flat_weights[self.idxs[i]] = self.module._parameters[layer]\r\n            setattr(self.module, layer, self._mask_dropout(raw_w, self.weight_p, training=self.training))\r\n            if self.idxs is not None: self.module._flat_weights[self.idxs[i]] = getattr(self.module, layer)\r\n```\r\n\r\n`def reset`\r\n```\r\n            # self.module._parameters[layer] = F.dropout(raw_w, p=self.weight_p, training=False)\r\n            setattr(self.module, layer, self._mask_dropout(raw_w, self.weight_p, training=False))\r\n```\r\n\r\n`def _mask_dropout`\r\n```\r\n    @staticmethod\r\n    def _mask_dropout(x, drop_p, training=True):\r\n        mask = x.new_ones(x.size())\r\n        mask = F.dropout(mask, p=drop_p, training=training)\r\n        x = x * mask\r\n        return x\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2586", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2586/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2586/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2586/events", "html_url": "https://github.com/fastai/fastai/issues/2586", "id": 631055181, "node_id": "MDU6SXNzdWU2MzEwNTUxODE=", "number": 2586, "title": "Wrong images in validation set in custom itemlist", "user": {"login": "abhinavtripathi95", "id": 19730981, "node_id": "MDQ6VXNlcjE5NzMwOTgx", "avatar_url": "https://avatars0.githubusercontent.com/u/19730981?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhinavtripathi95", "html_url": "https://github.com/abhinavtripathi95", "followers_url": "https://api.github.com/users/abhinavtripathi95/followers", "following_url": "https://api.github.com/users/abhinavtripathi95/following{/other_user}", "gists_url": "https://api.github.com/users/abhinavtripathi95/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhinavtripathi95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhinavtripathi95/subscriptions", "organizations_url": "https://api.github.com/users/abhinavtripathi95/orgs", "repos_url": "https://api.github.com/users/abhinavtripathi95/repos", "events_url": "https://api.github.com/users/abhinavtripathi95/events{/privacy}", "received_events_url": "https://api.github.com/users/abhinavtripathi95/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-04T18:27:03Z", "updated_at": "2020-08-07T14:27:37Z", "closed_at": "2020-08-07T14:27:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nWhile trying to use a custom itemlist using [this tutorial](https://docs.fast.ai/tutorial.itemlist.html), `data.show_batch(rows, DatasetType.Train)` shows the right pair of images. However, `data.show_batch(rows, DatasetType.Valid)` shows wrong image pairs.\r\n\r\n**Provide your installation details**\r\n=== Software === \r\npython        : 3.6.9\r\nfastai        : 1.0.61\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 410.78\r\ntorch cuda    : 10.0 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n\r\n**To Reproduce**\r\nCreate a dataframe which looks like this. We use this to create our dataset.\r\n```python\r\ndf.head()\r\n```\r\n|   |                                    uav |                                       sat | label | is_valid |\r\n|--:|---------------------------------------:|------------------------------------------:|------:|---------:|\r\n| 0 | train/atlanta/atlanta_uav/uav/uav0.png | train/atlanta/atlanta_sat/sat300/sat0.png |     1 |    False |\r\n| 1 | train/atlanta/atlanta_uav/uav/uav1.png | train/atlanta/atlanta_sat/sat300/sat1.png |     1 |    False |\r\n| 2 | train/atlanta/atlanta_uav/uav/uav2.png | train/atlanta/atlanta_sat/sat300/sat2.png |     1 |    False |\r\n| 3 | train/atlanta/atlanta_uav/uav/uav3.png | train/atlanta/atlanta_sat/sat300/sat3.png |     1 |    False |\r\n| 4 | train/atlanta/atlanta_uav/uav/uav4.png | train/atlanta/atlanta_sat/sat300/sat4.png |     1 |    False |\r\n```python\r\nmean, std = torch.tensor(imagenet_stats)\r\n# for 3 channels\r\nmean = mean[...,None,None]\r\nstd = std[...,None,None]\r\n\r\n# Create a custom itemlist\r\n# The primary difference from the tutorial is with how normalization is being done here\r\nclass ImageTuple(ItemBase):\r\n    def __init__(self, img1, img2):\r\n        self.img1,self.img2 = img1,img2\r\n        self.obj = (img1,img2)\r\n        self.data = [(img1.data-mean)/std, (img2.data-mean)/std]\r\n    def apply_tfms(self, tfms_list, **kwargs):\r\n        self.img1 = self.img1.apply_tfms(tfms_list[0], **kwargs)\r\n        self.img2 = self.img2.apply_tfms(tfms_list[1], **kwargs)\r\n        self.data = [(self.img1.data-mean)/std, (self.img2.data-mean)/std]\r\n        return self    \r\n    def to_one(self): return Image(mean+torch.cat(self.data,2)*std)\r\n    def __repr__(self): return f'{self.__class__.__name__} {self.img1.shape, self.img2.shape}'\r\ndef _maybe_squeeze(arr): return arr if is1d(arr) else (np.array(arr).ravel() if np.array(arr).shape == () else np.squeeze(arr))\r\n\r\nclass ImageTupleList(ImageList):\r\n    def __init__(self, items, itemsB=None, **kwargs):\r\n        super().__init__(items, **kwargs)\r\n        self.itemsB = itemsB\r\n        self.copy_new.append('itemsB')\r\n    def get(self, i):\r\n        img1 = super().get(i)\r\n        fn = self.itemsB[i]\r\n        return ImageTuple(img1, open_image(fn))\r\n    \r\n    @classmethod\r\n    def from_dfs(cls, df:DataFrame, path='.', cols=0, colsB=1, **kwargs):\r\n        \"Create an `ItemList` in `path` from the inputs in the `cols` of `df`.\"\r\n        itemsB = ImageList.from_df(df, path, colsB).items\r\n        res = super().from_df(df,path,cols, itemsB=itemsB, **kwargs)\r\n        res.path = path\r\n        return res\r\n\r\n    def reconstruct(self, t:Tensor): \r\n        return ImageTuple(Image(t[0]*std+mean),Image(t[1]*std+mean))\r\n    def show_xys(self, xs, ys, figsize:Tuple[int,int]=(12,6), **kwargs):\r\n        rows = int(math.sqrt(len(xs)))\r\n        fig, axs = plt.subplots(rows,rows,figsize=figsize)\r\n        for i, ax in enumerate(axs.flatten() if rows > 1 else [axs]):\r\n            xs[i].to_one().show(ax=ax, y=ys[i], **kwargs)\r\n        plt.tight_layout()\r\n\r\n    def show_xyzs(self, xs, ys, zs, figsize:Tuple[int,int]=None, **kwargs):\r\n        \"\"\"Show `xs` (inputs), `ys` (targets) and `zs` (predictions) on a figure of `figsize`.\r\n        `kwargs` are passed to the show method.\"\"\"\r\n        figsize = ifnone(figsize, (12,3*len(xs)))\r\n        fig,axs = plt.subplots(len(xs), 2, figsize=figsize)\r\n        fig.suptitle('Ground truth / Predictions', weight='bold', size=14)\r\n        for i,(x,z) in enumerate(zip(xs,zs)):\r\n            x.to_one().show(ax=axs[i,0], **kwargs)\r\n            z.to_one().show(ax=axs[i,1], **kwargs)\r\n\r\n\r\ntarget_col = 2\r\nis_valid_col = 3\r\nbs = 64\r\ndata = (ImageTupleList.from_dfs(df[:-10], path='.', cols=0, colsB=1)\r\n         .split_from_df(is_valid_col)\r\n         .label_from_df(cols=target_col, label_cls=FloatList)\r\n         .databunch(bs=bs))\r\n```\r\nSo far everything works fine. If I use `show_batch` for training set, I see the correct pair of images.\r\n```python\r\ndata.show_batch(2, DatasetType.Train)\r\n```\r\nHowever, when I use \r\n```python\r\ndata.show_batch(2, DatasetType.Valid)\r\n```\r\nit shows wrong pair of images.\r\n\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n`data.show_batch(2, DatasetType.Valid)` should show pair of images in bold below\r\n|      |                                           uav |                                              sat | label | is_valid |\r\n|-----:|----------------------------------------------:|-------------------------------------------------:|------:|---------:|\r\n| 1855 |     train/atlanta/atlanta_uav/uav/uav1855.png |     train/atlanta/atlanta_sat/sat300/sat1865.png |     1 |    False |\r\n| 1856 |     train/atlanta/atlanta_uav/uav/uav1856.png |     train/atlanta/atlanta_sat/sat300/sat1856.png |     1 |    False |\r\n| 1857 | **train/atlanta/atlanta_uav/uav/uav1857.png** | **train/atlanta/atlanta_sat/sat300/sat1857.png** |     1 |     True |\r\n| 1858 | **train/atlanta/atlanta_uav/uav/uav1858.png** | **train/atlanta/atlanta_sat/sat300/sat1858.png** |     1 |     True |\r\n| 1859 | **train/atlanta/atlanta_uav/uav/uav1859.png** | **train/atlanta/atlanta_sat/sat300/sat1859.png** |     1 |     True |\r\n| 1860 | **train/atlanta/atlanta_uav/uav/uav1860.png** | **train/atlanta/atlanta_sat/sat300/sat1860.png** |     1 |     True |\r\n| 1861 | **train/atlanta/atlanta_uav/uav/uav1861.png** | **train/atlanta/atlanta_sat/sat300/sat1861.png** |     1 |     True |\r\n\r\n**Actual behavior**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\nInstead, it shows the pair of images in bold below\r\n| uav                                           | sat                                           |\r\n|-----------------------------------------------|-----------------------------------------------|\r\n| **train/atlanta/atlanta_uav/uav/uav1857.png** | **train/atlanta/atlanta_sat/sat300/sat0.png** |\r\n| **train/atlanta/atlanta_uav/uav/uav1858.png** | **train/atlanta/atlanta_sat/sat300/sat1.png** |\r\n| **train/atlanta/atlanta_uav/uav/uav1859.png** | **train/atlanta/atlanta_sat/sat300/sat2.png** |\r\n| **train/atlanta/atlanta_uav/uav/uav1860.png** | **train/atlanta/atlanta_sat/sat300/sat3.png** |\r\n| **train/atlanta/atlanta_uav/uav/uav1861.png** | **train/atlanta/atlanta_sat/sat300/sat4.png** |\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2584", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2584/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2584/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2584/events", "html_url": "https://github.com/fastai/fastai/issues/2584", "id": 627414681, "node_id": "MDU6SXNzdWU2Mjc0MTQ2ODE=", "number": 2584, "title": "TypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'", "user": {"login": "nickcorona", "id": 7490453, "node_id": "MDQ6VXNlcjc0OTA0NTM=", "avatar_url": "https://avatars1.githubusercontent.com/u/7490453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nickcorona", "html_url": "https://github.com/nickcorona", "followers_url": "https://api.github.com/users/nickcorona/followers", "following_url": "https://api.github.com/users/nickcorona/following{/other_user}", "gists_url": "https://api.github.com/users/nickcorona/gists{/gist_id}", "starred_url": "https://api.github.com/users/nickcorona/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nickcorona/subscriptions", "organizations_url": "https://api.github.com/users/nickcorona/orgs", "repos_url": "https://api.github.com/users/nickcorona/repos", "events_url": "https://api.github.com/users/nickcorona/events{/privacy}", "received_events_url": "https://api.github.com/users/nickcorona/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-29T17:10:59Z", "updated_at": "2020-08-07T14:27:53Z", "closed_at": "2020-08-07T14:27:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/fastai/fastai/blob/54a9e3cf4fd0fa11fc2453a5389cc9263f6f0d77/fastai/tabular/data.py#L85\r\n\r\nI run this code on bluebook data from the fastai course. However, it doesn't work in filling in applying the processors. I get this error. Any idea why?\r\n```\r\nprocs = [FillMissing, Categorify]\r\ndata = TabularDataBunch.from_df('data', df, 'SalePrice', valid_idx=valid_idx, procs=procs, cat_names=cat_list)`\r\n```\r\n\r\nTypeError: int() argument must be a string, a bytes-like object or a number, not 'NoneType'\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2583", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2583/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2583/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2583/events", "html_url": "https://github.com/fastai/fastai/issues/2583", "id": 626942507, "node_id": "MDU6SXNzdWU2MjY5NDI1MDc=", "number": 2583, "title": "cont_cat_split doesn't correctly identify numeric variables", "user": {"login": "nickcorona", "id": 7490453, "node_id": "MDQ6VXNlcjc0OTA0NTM=", "avatar_url": "https://avatars1.githubusercontent.com/u/7490453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nickcorona", "html_url": "https://github.com/nickcorona", "followers_url": "https://api.github.com/users/nickcorona/followers", "following_url": "https://api.github.com/users/nickcorona/following{/other_user}", "gists_url": "https://api.github.com/users/nickcorona/gists{/gist_id}", "starred_url": "https://api.github.com/users/nickcorona/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nickcorona/subscriptions", "organizations_url": "https://api.github.com/users/nickcorona/orgs", "repos_url": "https://api.github.com/users/nickcorona/repos", "events_url": "https://api.github.com/users/nickcorona/events{/privacy}", "received_events_url": "https://api.github.com/users/nickcorona/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-29T01:56:18Z", "updated_at": "2020-08-07T14:34:40Z", "closed_at": "2020-08-07T14:34:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Should include int64 data type to correctly identify all numeric variables.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2582", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2582/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2582/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2582/events", "html_url": "https://github.com/fastai/fastai/issues/2582", "id": 623688808, "node_id": "MDU6SXNzdWU2MjM2ODg4MDg=", "number": 2582, "title": "ObjectItemList error when there is no bounding box in the first item", "user": {"login": "yindavidyang", "id": 19674938, "node_id": "MDQ6VXNlcjE5Njc0OTM4", "avatar_url": "https://avatars2.githubusercontent.com/u/19674938?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yindavidyang", "html_url": "https://github.com/yindavidyang", "followers_url": "https://api.github.com/users/yindavidyang/followers", "following_url": "https://api.github.com/users/yindavidyang/following{/other_user}", "gists_url": "https://api.github.com/users/yindavidyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yindavidyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yindavidyang/subscriptions", "organizations_url": "https://api.github.com/users/yindavidyang/orgs", "repos_url": "https://api.github.com/users/yindavidyang/repos", "events_url": "https://api.github.com/users/yindavidyang/events{/privacy}", "received_events_url": "https://api.github.com/users/yindavidyang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-23T15:58:34Z", "updated_at": "2020-08-07T14:34:57Z", "closed_at": "2020-08-07T14:34:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was building a databunch for object detection:\r\n\r\n-----\r\nx= (ObjectItemList.from_folder(data_dir / 'train')\r\n        .split_by_rand_pct()\r\n        .label_from_func(get_y_func)\r\n        .transform(tfms, tfm_y=True, size=sz)\r\n     )\r\n-----\r\n\r\nMy first item in the list has no bounding box or label, so it's `y` is simply `[[], []]`. This led to an error in `ImageBBox.create`:\r\n\r\n-----\r\n~/miniconda3/lib/python3.7/site-packages/fastai/data_block.py in _check_kwargs(ds, tfms, **kwargs)\r\n    595     if (tfms is None or len(tfms) == 0) and len(kwargs) == 0: return\r\n    596     if len(ds.items) >= 1:\r\n--> 597         x = ds[0]\r\n    598         try: x.apply_tfms(tfms, **kwargs)\r\n    599         except Exception as e:\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/data_block.py in __getitem__(self, idxs)\r\n    118         \"returns a single item based if `idxs` is an integer or a new `ItemList` object if `idxs` is a range.\"\r\n    119         idxs = try_int(idxs)\r\n--> 120         if isinstance(idxs, Integral): return self.get(idxs)\r\n    121         else: return self.new(self.items[idxs], inner_df=index_row(self.inner_df, idxs))\r\n    122 \r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/vision/data.py in get(self, i)\r\n    353 \r\n    354     def get(self, i):\r\n--> 355         return ImageBBox.create(*_get_size(self.x,i), *self.items[i], classes=self.classes, pad_idx=self.pad_idx)\r\n    356 \r\n    357     def analyze_pred(self, pred): return pred\r\n\r\n~/miniconda3/lib/python3.7/site-packages/fastai/vision/image.py in create(cls, h, w, bboxes, labels, classes, pad_idx, scale)\r\n    357         if isinstance(bboxes, np.ndarray) and bboxes.dtype == np.object: bboxes = np.array([bb for bb in bboxes])\r\n    358         bboxes = tensor(bboxes).float()\r\n--> 359         tr_corners = torch.cat([bboxes[:,0][:,None], bboxes[:,3][:,None]], 1)\r\n    360         bl_corners = bboxes[:,1:3].flip(1)\r\n    361         bboxes = torch.cat([bboxes[:,:2], tr_corners, bl_corners, bboxes[:,2:]], 1)\r\n\r\nIndexError: too many indices for tensor of dimension 0\r\n------\r\n\r\nThe error was caused because `bboxes` here is an empty list `[]`, and the above code is trying to access `bboxes[:, 0]`.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2581", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2581/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2581/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2581/events", "html_url": "https://github.com/fastai/fastai/issues/2581", "id": 622883841, "node_id": "MDU6SXNzdWU2MjI4ODM4NDE=", "number": 2581, "title": "'NoneType' object is not subscriptable in interp.GradCAM(idx)", "user": {"login": "Alymostafa", "id": 34445689, "node_id": "MDQ6VXNlcjM0NDQ1Njg5", "avatar_url": "https://avatars2.githubusercontent.com/u/34445689?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alymostafa", "html_url": "https://github.com/Alymostafa", "followers_url": "https://api.github.com/users/Alymostafa/followers", "following_url": "https://api.github.com/users/Alymostafa/following{/other_user}", "gists_url": "https://api.github.com/users/Alymostafa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alymostafa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alymostafa/subscriptions", "organizations_url": "https://api.github.com/users/Alymostafa/orgs", "repos_url": "https://api.github.com/users/Alymostafa/repos", "events_url": "https://api.github.com/users/Alymostafa/events{/privacy}", "received_events_url": "https://api.github.com/users/Alymostafa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-22T01:19:28Z", "updated_at": "2020-08-07T14:35:35Z", "closed_at": "2020-08-07T14:35:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I use ```vgg19``` from ```torchvision```  when i use gradcam it gives me that :\r\n```\r\nlearn = cnn_learner(data, models.vgg19, metrics=[accuracy,error_rate])\r\ninterp = ClassificationInterpretation.from_learner(learn)\r\ninterp.GradCAM(1)\r\n```\r\n```\r\n/usr/local/lib/python3.6/dist-packages/fastai/vision/learner.py in _cl_int_gradcam(self, idx, ds_type, heatmap_thresh, image)\r\n    155 \r\n    156     if (acts.shape[-1]*acts.shape[-2]) >= heatmap_thresh:\r\n--> 157         grad = hook_g.stored[0][0].cpu()\r\n    158         grad_chan = grad.mean(1).mean(1)\r\n    159         mult = F.relu(((acts*grad_chan[...,None,None])).sum(0))\r\n\r\nTypeError: 'NoneType' object is not subscriptable\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2580", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2580/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2580/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2580/events", "html_url": "https://github.com/fastai/fastai/issues/2580", "id": 622824323, "node_id": "MDU6SXNzdWU2MjI4MjQzMjM=", "number": 2580, "title": "learn.predict() runs into an Exception Value error", "user": {"login": "harshikanu", "id": 50932623, "node_id": "MDQ6VXNlcjUwOTMyNjIz", "avatar_url": "https://avatars3.githubusercontent.com/u/50932623?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshikanu", "html_url": "https://github.com/harshikanu", "followers_url": "https://api.github.com/users/harshikanu/followers", "following_url": "https://api.github.com/users/harshikanu/following{/other_user}", "gists_url": "https://api.github.com/users/harshikanu/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshikanu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshikanu/subscriptions", "organizations_url": "https://api.github.com/users/harshikanu/orgs", "repos_url": "https://api.github.com/users/harshikanu/repos", "events_url": "https://api.github.com/users/harshikanu/events{/privacy}", "received_events_url": "https://api.github.com/users/harshikanu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-21T22:17:08Z", "updated_at": "2020-05-22T11:47:46Z", "closed_at": "2020-05-22T11:47:45Z", "author_association": "NONE", "active_lock_reason": null, "body": " am trying to predict the sentiment of a sentence by using learn.predict(message). I am loading a pretrained Databunch and model files. \r\nBut I am getting the following error -\r\n\r\nCode - \r\n   `final_result = []`\r\n   `data = load_data(_path,\r\n                     '/home/data_save.pkl')`\r\n    `roberta_model = CustomRobertaModel()`\r\n    `learn = Learner(data, roberta_model, metrics=[accuracy])`\r\n    `st2 = torch.load(\"/home/final_model_base.pth\",\r\n                     map_location=torch.device('cpu')\r\n                     )`\r\n    `learn.model.load_state_dict(st2)`\r\n    `learn.model.roberta.eval()`\r\n    \r\n\r\nERROR -\r\n\r\nFile \u201c/usr/local/lib/python3.7/site-packages/fastai/basic_train.py\u201d in predict\r\n382. y = ds.y.reconstruct(pred, x) if has_arg(ds.y.reconstruct, \u2018x\u2019) else ds.y.reconstruct(pred)\r\n\r\nFile \u201c/usr/local/lib/python3.7/site-packages/fastai/text/data.py\u201d in reconstruct\r\n341. return Text(t[idx_min:idx_max+1], self.vocab.textify(t[idx_min:idx_max+1]))\r\n\r\nFile \u201c/usr/local/lib/python3.7/site-packages/fastai/text/transform.py\u201d in textify\r\n134. return sep.join([self.itos[i] for i in nums]) if sep is not None else [self.itos[i] for i in nums]\r\n\r\nFile \u201c/usr/local/lib/python3.7/site-packages/fastai/text/transform.py\u201d in\r\n134. return sep.join([self.itos[i] for i in nums]) if sep is not None else [self.itos[i] for i in nums]\r\n\r\nException Type: TypeError at /test_sent/\r\nException Value: only integer tensors of a single element can be converted to an index\r\n\r\nRunning pred_batch or get_preds works. But I want to run it with .predict since it is more efficient. \r\n\r\nPlease help me with this.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2578", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2578/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2578/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2578/events", "html_url": "https://github.com/fastai/fastai/issues/2578", "id": 621762668, "node_id": "MDU6SXNzdWU2MjE3NjI2Njg=", "number": 2578, "title": "Prediction Mismatch for RnnLearner", "user": {"login": "kdmcdrm", "id": 5034163, "node_id": "MDQ6VXNlcjUwMzQxNjM=", "avatar_url": "https://avatars3.githubusercontent.com/u/5034163?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kdmcdrm", "html_url": "https://github.com/kdmcdrm", "followers_url": "https://api.github.com/users/kdmcdrm/followers", "following_url": "https://api.github.com/users/kdmcdrm/following{/other_user}", "gists_url": "https://api.github.com/users/kdmcdrm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kdmcdrm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kdmcdrm/subscriptions", "organizations_url": "https://api.github.com/users/kdmcdrm/orgs", "repos_url": "https://api.github.com/users/kdmcdrm/repos", "events_url": "https://api.github.com/users/kdmcdrm/events{/privacy}", "received_events_url": "https://api.github.com/users/kdmcdrm/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-20T13:27:40Z", "updated_at": "2020-05-22T11:48:57Z", "closed_at": "2020-05-22T11:48:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "Excuse me if this is known behaviour, I took a look on the forum and couldn't find any reason that this should be the case. What I noticed is that the predictions between two learner objects, after loading the same weights, differ.\r\n\r\nHere's the example:\r\n``` python\r\nlearn1 = text_classifier_learner(\r\n    data_clas,\r\n    AWD_LSTM,\r\n    drop_mult=0.5\r\n)\r\nlearn1.model_dir = MODEL_DIR\r\nlearn1.load_encoder(\"lm_encoder\")\r\nlearn1 = learn1.load(TEST_MODEL_PREFIX + \"_fine2\")\r\nlearn1.predict(\"Some short test text\", with_dropout=False)\r\n\r\nlearn2 = text_classifier_learner(\r\n    data_clas,\r\n    AWD_LSTM,\r\n    drop_mult=0.5\r\n)\r\nlearn2.model_dir = MODEL_DIR\r\nlearn2.load_encoder(\"lm_encoder\")\r\nlearn2 = learn2.load(TEST_MODEL_PREFIX + \"_fine2\")\r\nlearn2.predict(\"Some short test text\", with_dropout=False)\r\n```\r\nAnd the output shows that they predict the same class, but not with quite the same probabilities.\r\n\r\n> (Category return_quick_reply,\r\n>  tensor(2),\r\n>  tensor([0.2519, 0.2333, 0.3683, 0.1464]))\r\n \r\n> (Category return_quick_reply,\r\n> tensor(2),\r\n> tensor([0.2386, 0.2403, 0.3632, 0.1579]))\r\n\r\nIs this expected for some reason? I do get consistent results for learners loaded after exporting, so I can use that for the live model.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2577", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2577/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2577/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2577/events", "html_url": "https://github.com/fastai/fastai/issues/2577", "id": 621668054, "node_id": "MDU6SXNzdWU2MjE2NjgwNTQ=", "number": 2577, "title": "POOL Attention Size miss match", "user": {"login": "jaideep11061982", "id": 38164196, "node_id": "MDQ6VXNlcjM4MTY0MTk2", "avatar_url": "https://avatars3.githubusercontent.com/u/38164196?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaideep11061982", "html_url": "https://github.com/jaideep11061982", "followers_url": "https://api.github.com/users/jaideep11061982/followers", "following_url": "https://api.github.com/users/jaideep11061982/following{/other_user}", "gists_url": "https://api.github.com/users/jaideep11061982/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaideep11061982/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaideep11061982/subscriptions", "organizations_url": "https://api.github.com/users/jaideep11061982/orgs", "repos_url": "https://api.github.com/users/jaideep11061982/repos", "events_url": "https://api.github.com/users/jaideep11061982/events{/privacy}", "received_events_url": "https://api.github.com/users/jaideep11061982/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-20T10:58:49Z", "updated_at": "2020-08-07T14:42:03Z", "closed_at": "2020-08-07T14:42:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nI find possible bug in PoolAttention block in layers.py \r\n\r\nsize phi and g may not match  in case of odd feature map size say 42*7   . \r\nso i made a correction to make it work for all sizes. let me know if his works\r\n```\r\nclass PooledSelfAttention2d1(Module):\r\n    \"Pooled self attention layer for 2d.\"\r\n    def __init__(self, n_channels:int):\r\n        self.n_channels = n_channels\r\n        self.theta = spectral_norm(conv2d(n_channels, n_channels//8, 1)) # query\r\n        self.phi   = spectral_norm(conv2d(n_channels, n_channels//8, 1)) # key\r\n        self.g     = spectral_norm(conv2d(n_channels, n_channels//2, 1)) # value\r\n        self.o     = spectral_norm(conv2d(n_channels//2, n_channels, 1))\r\n        self.gamma = nn.Parameter(tensor([0.]))\r\n\r\n    def forward(self, x):\r\n        # code borrowed from https://github.com/ajbrock/BigGAN-PyTorch/blob/7b65e82d058bfe035fc4e299f322a1f83993e04c/layers.py#L156\r\n        theta = self.theta(x)\r\n      \r\n        phi = F.max_pool2d(self.phi(x), [2,2])\r\n        \r\n        g = F.max_pool2d(self.g(x), [2,2])    \r\n        theta = theta.view(-1, self.n_channels // 8, x.shape[2] * x.shape[3])\r\n      \r\n        #phi = phi.view(-1, self.n_channels // 8, x.shape[2] * x.shape[3] // 4) #original\r\n        phi = phi.view(-1, self.n_channels // 8, phi.shape[2] * phi.shape[3] ) #correction\r\n        #g = g.view(-1, self.n_channels // 2, x.shape[2] * x.shape[3] // 4) #original\r\n        g = g.view(-1, self.n_channels // 2, g.shape[2] * g.shape[3] ) #correction\r\n        beta = F.softmax(torch.bmm(theta.transpose(1, 2), phi), -1)\r\n        o = self.o(torch.bmm(g, beta.transpose(1,2)).view(-1, self.n_channels // 2, x.shape[2], x.shape[3]))\r\n        return self.gamma * o + x\r\n\r\n```\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2576", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2576/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2576/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2576/events", "html_url": "https://github.com/fastai/fastai/issues/2576", "id": 619459207, "node_id": "MDU6SXNzdWU2MTk0NTkyMDc=", "number": 2576, "title": "setup.py  deps generates invalid spec", "user": {"login": "itsallonetome", "id": 16046350, "node_id": "MDQ6VXNlcjE2MDQ2MzUw", "avatar_url": "https://avatars1.githubusercontent.com/u/16046350?v=4", "gravatar_id": "", "url": "https://api.github.com/users/itsallonetome", "html_url": "https://github.com/itsallonetome", "followers_url": "https://api.github.com/users/itsallonetome/followers", "following_url": "https://api.github.com/users/itsallonetome/following{/other_user}", "gists_url": "https://api.github.com/users/itsallonetome/gists{/gist_id}", "starred_url": "https://api.github.com/users/itsallonetome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/itsallonetome/subscriptions", "organizations_url": "https://api.github.com/users/itsallonetome/orgs", "repos_url": "https://api.github.com/users/itsallonetome/repos", "events_url": "https://api.github.com/users/itsallonetome/events{/privacy}", "received_events_url": "https://api.github.com/users/itsallonetome/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-16T12:13:52Z", "updated_at": "2020-08-07T14:43:41Z", "closed_at": "2020-08-07T14:43:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n`$ python setup.py -q deps --dep-groups=core,text`\r\nin a linux x86-64 minirconda environment with python 3.7 generates invalid spec:\r\n`Pillow beautifulsoup4 bottleneck dataclasses;python_version<'3.7' fastprogress>=0.2.1 matplotlib numexpr numpy>=1.15 nvidia-ml-py3 packaging pandas pynvx>=1.0.0;platform_system==\"Darwin\" pyyaml requests scipy spacy>=2.0.18;python_version<'3.8' torch>=1.0.0`\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n$ python -m fastai.utils.show_install\r\n\r\n```text\r\n=== Software ===\r\npython       : 3.7.6\r\nfastai       : 1.0.62.dev0\r\nfastprogress : 0.2.2\r\ntorch        : 1.1.0\r\ntorch cuda   : None / is **Not available**\r\n\r\n=== Hardware ===\r\nNo GPUs available\r\n\r\n=== Environment ===\r\nplatform     : Linux-3.10.0-1127.el7.x86_64-x86_64-with-redhat-7.6-Maipo\r\ndistro       : Red Hat Enterprise Linux Server 7.6 Maipo\r\nconda env    : fastai\r\npython       : /home/conda/miniconda3/envs/fastai/bin/python\r\nsys.path     : /home/conda/fastai\r\n/home/conda/miniconda3/envs/fastai/lib/python37.zip\r\n/home/conda/miniconda3/envs/fastai/lib/python3.7\r\n/home/conda/miniconda3/envs/fastai/lib/python3.7/lib-dynload\r\n/home/conda/.local/lib/python3.7/site-packages\r\n/home/conda/miniconda3/envs/fastai/lib/python3.7/site-packages\r\nno supported gpus found on this system\r\n```\r\n$ `uname -a`\r\n`Linux vm012370 3.10.0-1127.el7.x86_64 #1 SMP Tue Feb 18 16:39:12 EST 2020 x86_64 x86_64 x86_64 GNU/Linux`\r\n\r\n\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\ncreate conda env with python 3.7\r\n$ `conda config --env --add channels conda-forge`\r\n$ `conda config --env --add channels fastai`\r\n$ `conda config --env --add channels pytorch`\r\n\r\nthen\r\n$ `conda install scikit-learn pandas numpy scipy mkl`\r\n$ `conda install pytorch-cpu torchvision-cpu cpuonly mkl`\r\n\r\nthen\r\n```\r\ngit clone https://github.com/fastai/fastai\r\ncd fastai/\r\ntools/run-after-git-clone\r\n```\r\nthen\r\n$ `python setup.py -q deps --dep-groups=core,text`\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\nThe generated dependencies will include only package specs which are compatible with the environment.\r\n`dataclasses;python_version<'3.7'` is not compatible with python 3.7.6\r\n`pynvx>=1.0.0;platform_system==\"Darwin\"` is not compatible with x86_64\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2575", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2575/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2575/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2575/events", "html_url": "https://github.com/fastai/fastai/issues/2575", "id": 617225617, "node_id": "MDU6SXNzdWU2MTcyMjU2MTc=", "number": 2575, "title": "Load learner cannot find models when not running in pythons __main__", "user": {"login": "Baukebrenninkmeijer", "id": 9077462, "node_id": "MDQ6VXNlcjkwNzc0NjI=", "avatar_url": "https://avatars0.githubusercontent.com/u/9077462?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Baukebrenninkmeijer", "html_url": "https://github.com/Baukebrenninkmeijer", "followers_url": "https://api.github.com/users/Baukebrenninkmeijer/followers", "following_url": "https://api.github.com/users/Baukebrenninkmeijer/following{/other_user}", "gists_url": "https://api.github.com/users/Baukebrenninkmeijer/gists{/gist_id}", "starred_url": "https://api.github.com/users/Baukebrenninkmeijer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Baukebrenninkmeijer/subscriptions", "organizations_url": "https://api.github.com/users/Baukebrenninkmeijer/orgs", "repos_url": "https://api.github.com/users/Baukebrenninkmeijer/repos", "events_url": "https://api.github.com/users/Baukebrenninkmeijer/events{/privacy}", "received_events_url": "https://api.github.com/users/Baukebrenninkmeijer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-13T07:49:46Z", "updated_at": "2020-05-13T17:03:58Z", "closed_at": "2020-05-13T11:51:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\nI'm trying to run a model using flask. Initially I had the flask setup as follows:\r\n```\r\n\u251c\u2500\u2500 src\r\n\u2502    \u251c\u2500\u2500 __init__.py\r\n\u2502    \u251c\u2500\u2500 models.py\r\n\u2502    \u2514\u2500\u2500 utils.py\r\n\u251c\u2500\u2500 app\r\n\u2502    \u251c\u2500\u2500 __init__.py  # instantiates flask app\r\n\u2502    \u2514\u2500\u2500 routes.py  # imports the models from src.models\r\n\u251c\u2500\u2500 main.py -> Runs the flask app\r\n```\r\nNow, as far as I know, this is a fairly standard flask setup, used in many tutorials as well. But no matter where I put my model definition, it always gives the error \r\n```\r\nAttributeError: Can't get attribute 'ModelResnetClassifier' on <module '__main__' from 'main.py'\r\n````\r\nTo fix this issue, I expected putting everything in `main.py` would fix it, looking at issues like #2436 where this was mentioned as a possible reason. But the issue goes a bit deeper than just being in the same script, because that is what I'm doing now. The issue persists almost anytime that `load_learner` is not being called in '__main__'. \r\n\r\nI am now trying to run this a bit faster using gunicorn. Since now the '__main__' is changed again to gunicorns wrapper, the same error is occuring.\r\n```\r\nAttributeError: Can't get attribute 'ModelResnetClassifier' on <module '__main__' from '/usr/local/bin/gunicorn'>\r\n```\r\nI've spent countless hours by now trying to fix the issue, with moving the model definition, changing names, setting the model as attribute of '__main__', and more. But so far, the only way to save things is and load them without this issue is to use predefined models from libraries, that have their model definition there. \r\n\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.3.1\r\nnvidia driver : 445.75\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7501 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 6144MB | GeForce GTX 980 Ti\r\n\r\n=== Environment === \r\nplatform      : Windows-10-10.0.18362-SP0\r\nconda env     : Unknown\r\npython        : C:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\python.exe\r\nsys.path      : C:\\Users\\BaukeBrenninkmeijer\\Projects\\OneTwoModel\\nbs\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\python37.zip\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\DLLs\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\lib\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\r\n\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\lib\\site-packages\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\lib\\site-packages\\win32\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\lib\\site-packages\\win32\\lib\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\lib\\site-packages\\Pythonwin\r\nC:\\Users\\BaukeBrenninkmeijer\\Anaconda3\\envs\\otm\\lib\\site-packages\\IPython\\extensions\r\nC:\\Users\\BaukeBrenninkmeijer\\.ipython\r\n```\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n1. Create folder structure like described:\r\n```\r\n\u251c\u2500\u2500 src\r\n\u2502    \u2514\u2500\u2500 models.py\r\n\u251c\u2500\u2500 app\r\n\u2502    \u251c\u2500\u2500 __init__.py  # instantiates flask app\r\n\u2502    \u2514\u2500\u2500 routes.py  # imports the models from src.models\r\n\u251c\u2500\u2500 main.py -> Runs the flask app\r\n```\r\n2. Try to run a custom model (either defined in routes or src.models), loaded with `load_learner` from `routes.py`. \r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\nThat `load_learner` is able to import the model if it is anywhere in the available namespace or an easy way to match the requirements that `load_learner` has for these models. \r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n![image](https://user-images.githubusercontent.com/9077462/81785768-fe766f00-94fe-11ea-8d5d-0bc3822bfea4.png)\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2574", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2574/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2574/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2574/events", "html_url": "https://github.com/fastai/fastai/issues/2574", "id": 617175342, "node_id": "MDU6SXNzdWU2MTcxNzUzNDI=", "number": 2574, "title": "ImageSegment::show always uses 'tab20' Colormap", "user": {"login": "ahuarte47", "id": 5576272, "node_id": "MDQ6VXNlcjU1NzYyNzI=", "avatar_url": "https://avatars2.githubusercontent.com/u/5576272?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ahuarte47", "html_url": "https://github.com/ahuarte47", "followers_url": "https://api.github.com/users/ahuarte47/followers", "following_url": "https://api.github.com/users/ahuarte47/following{/other_user}", "gists_url": "https://api.github.com/users/ahuarte47/gists{/gist_id}", "starred_url": "https://api.github.com/users/ahuarte47/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ahuarte47/subscriptions", "organizations_url": "https://api.github.com/users/ahuarte47/orgs", "repos_url": "https://api.github.com/users/ahuarte47/repos", "events_url": "https://api.github.com/users/ahuarte47/events{/privacy}", "received_events_url": "https://api.github.com/users/ahuarte47/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-13T06:21:02Z", "updated_at": "2020-08-07T14:44:02Z", "closed_at": "2020-08-07T14:44:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, congratulations for this amazing software!\r\nI would like to show the masks of a SegmentationLabelList using my own Colormap.\r\n\r\n```\r\n# Create the Matplotlib Colormap of this DataBunch.\r\ncmap = mpl.colors.ListedColormap([(rgb[0]/255, rgb[1]/255, rgb[2]/255) for rgb in rgb_list])\r\nbounds = range(0, len(rgb_list) + 1)\r\nnorm = mpl.colors.BoundaryNorm(bounds, cmap.N)\r\nmpl.cm.register_cmap(name='my_cmap', cmap=cmap)\r\n\r\n# Create DataBunch.\r\nsrc = (SegmentationItemList.from_folder(...)...)\r\ndata = (src.transform(...).databunch(bs=...).normalize(imagenet_stats))\r\n\r\n# Show Images, why is 'tab20' Colormap used?.\r\ndata.show_batch(2, figsize=(10,10), alpha=1, cmap='my_cmap', norm=norm)\r\n```\r\n\r\nBut it seems that they are always showed with 'tab20' Colormap ([code](https://github.com/fastai/fastai/blob/master/fastai/vision/image.py#L237)).\r\n\r\nIf I temporally override this Colormap it works as expected:\r\n\r\n```\r\ntemp_cmap = mpl.cm.get_cmap('tab20')\r\nmpl.cm.register_cmap(name='tab20', cmap=cmap)\r\ndata.show_batch(3, figsize=(10,10), alpha=1, cmap='my_cmap', norm=norm)\r\nmpl.cm.register_cmap(name='tab20', cmap=temp_cmap)\r\n```\r\n\r\nWhat am I doing wrong? Is this a bug?\r\nThank you very much\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2572", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2572/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2572/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2572/events", "html_url": "https://github.com/fastai/fastai/issues/2572", "id": 615515373, "node_id": "MDU6SXNzdWU2MTU1MTUzNzM=", "number": 2572, "title": "SentencePieceTrainer OSError: Not found", "user": {"login": "verissimomanoel", "id": 13052774, "node_id": "MDQ6VXNlcjEzMDUyNzc0", "avatar_url": "https://avatars2.githubusercontent.com/u/13052774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/verissimomanoel", "html_url": "https://github.com/verissimomanoel", "followers_url": "https://api.github.com/users/verissimomanoel/followers", "following_url": "https://api.github.com/users/verissimomanoel/following{/other_user}", "gists_url": "https://api.github.com/users/verissimomanoel/gists{/gist_id}", "starred_url": "https://api.github.com/users/verissimomanoel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/verissimomanoel/subscriptions", "organizations_url": "https://api.github.com/users/verissimomanoel/orgs", "repos_url": "https://api.github.com/users/verissimomanoel/repos", "events_url": "https://api.github.com/users/verissimomanoel/events{/privacy}", "received_events_url": "https://api.github.com/users/verissimomanoel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-11T00:47:58Z", "updated_at": "2020-08-07T14:46:33Z", "closed_at": "2020-08-07T14:46:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "When we try training a language model using MultFiT, the first phase is to load the unsup data with the code below:\r\n\r\ndata = (TextList.from_folder(dest, processor=[OpenFileProcessor(), SPProcessor(max_vocab_sz=15000)])\r\n        .split_by_rand_pct(0.1, seed=42)\r\n        .label_for_lm()\r\n        .databunch(bs=bs, num_workers=8))\r\n\r\nBut we have the error OSError: Not found.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2571", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2571/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2571/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2571/events", "html_url": "https://github.com/fastai/fastai/issues/2571", "id": 615269079, "node_id": "MDU6SXNzdWU2MTUyNjkwNzk=", "number": 2571, "title": "from_similars() always shows the \"Computing similarities...\" phase", "user": {"login": "Huud", "id": 22608697, "node_id": "MDQ6VXNlcjIyNjA4Njk3", "avatar_url": "https://avatars2.githubusercontent.com/u/22608697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Huud", "html_url": "https://github.com/Huud", "followers_url": "https://api.github.com/users/Huud/followers", "following_url": "https://api.github.com/users/Huud/following{/other_user}", "gists_url": "https://api.github.com/users/Huud/gists{/gist_id}", "starred_url": "https://api.github.com/users/Huud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Huud/subscriptions", "organizations_url": "https://api.github.com/users/Huud/orgs", "repos_url": "https://api.github.com/users/Huud/repos", "events_url": "https://api.github.com/users/Huud/events{/privacy}", "received_events_url": "https://api.github.com/users/Huud/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-09T22:06:27Z", "updated_at": "2020-05-11T11:41:43Z", "closed_at": "2020-05-11T11:41:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is a minor oversight - I assume -, but running \"from_similars()\" from the image_cleaner widget always shows \"Computing similarities...\" even after the computation is done and returned, I spent an hour like an idiot waiting for this surprisingly long \"Computing similarities...\" part to end, just to realize it already did ages ago.\r\n\r\nI though I missed something, but apparently this is how the function behaves since it is present even the example notebook:\r\n\r\nhttps://github.com/fastai/fastai/blob/f2163fb547d3d68b5a609d39806245d121dc2d4e/docs_src/widgets.image_cleaner.ipynb", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2564", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2564/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2564/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2564/events", "html_url": "https://github.com/fastai/fastai/issues/2564", "id": 613988507, "node_id": "MDU6SXNzdWU2MTM5ODg1MDc=", "number": 2564, "title": "dropout for continues variables", "user": {"login": "MorPeled", "id": 48720490, "node_id": "MDQ6VXNlcjQ4NzIwNDkw", "avatar_url": "https://avatars2.githubusercontent.com/u/48720490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MorPeled", "html_url": "https://github.com/MorPeled", "followers_url": "https://api.github.com/users/MorPeled/followers", "following_url": "https://api.github.com/users/MorPeled/following{/other_user}", "gists_url": "https://api.github.com/users/MorPeled/gists{/gist_id}", "starred_url": "https://api.github.com/users/MorPeled/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MorPeled/subscriptions", "organizations_url": "https://api.github.com/users/MorPeled/orgs", "repos_url": "https://api.github.com/users/MorPeled/repos", "events_url": "https://api.github.com/users/MorPeled/events{/privacy}", "received_events_url": "https://api.github.com/users/MorPeled/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-07T11:39:08Z", "updated_at": "2020-05-07T11:49:42Z", "closed_at": "2020-05-07T11:49:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/fastai/fastai/blob/564896d7b84b59bee40db19ee298a1028235442b/fastai/tabular/models.py#L21\r\n\r\nHi,\r\n\r\nIf I got it right from this line, in the input layer there is no option to perform dropout on continues variables, right? (since the first droppout rate in the 'ps' list will always be 0.0)\r\n\r\nThanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2563", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2563/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2563/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2563/events", "html_url": "https://github.com/fastai/fastai/issues/2563", "id": 613886496, "node_id": "MDU6SXNzdWU2MTM4ODY0OTY=", "number": 2563, "title": "Pytorch 1.5 warning during to_fp16 fit", "user": {"login": "ProustIdee", "id": 15386719, "node_id": "MDQ6VXNlcjE1Mzg2NzE5", "avatar_url": "https://avatars3.githubusercontent.com/u/15386719?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ProustIdee", "html_url": "https://github.com/ProustIdee", "followers_url": "https://api.github.com/users/ProustIdee/followers", "following_url": "https://api.github.com/users/ProustIdee/following{/other_user}", "gists_url": "https://api.github.com/users/ProustIdee/gists{/gist_id}", "starred_url": "https://api.github.com/users/ProustIdee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ProustIdee/subscriptions", "organizations_url": "https://api.github.com/users/ProustIdee/orgs", "repos_url": "https://api.github.com/users/ProustIdee/repos", "events_url": "https://api.github.com/users/ProustIdee/events{/privacy}", "received_events_url": "https://api.github.com/users/ProustIdee/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-07T08:52:21Z", "updated_at": "2020-08-07T14:47:17Z", "closed_at": "2020-08-07T14:47:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nlearn=language_model_learner(data_lm, pretrained=False, arch=AWD_LSTM, config=config).to_fp16()\r\nlearn.lr_find()\r\n```\r\n\r\nProduces the warning\r\n\r\n`UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.`\r\n\r\nLooks like it landed end of January, between pytorch 1.4 and 1.5: https://github.com/pytorch/pytorch/pull/30531\r\n\r\n`learn.fit_one_cycle(1, max_lr=1e-2, callbacks=[callbacks.SaveModelCallback(learn, every='epoch', monitor='accuracy', name='model')])`\r\n\r\nProduces warnings that go on forever. Not sure if it actually is causing an issue with the training.\r\n\r\n```text\r\n=== Software ===\r\npython        : 3.7.3\r\nfastai        : 1.0.61\r\nfastprogress  : 0.2.3\r\ntorch         : 1.5.0\r\ntorch cuda    : 10.2 / is available\r\ntorch cudnn   : 7605 / is enabled\r\n\r\n=== Hardware ===\r\ntorch devices : 8\r\n  - gpu0      : Tesla V100-SXM2-16GB\r\n  - gpu1      : Tesla V100-SXM2-16GB\r\n  - gpu2      : Tesla V100-SXM2-16GB\r\n  - gpu3      : Tesla V100-SXM2-16GB\r\n  - gpu4      : Tesla V100-SXM2-16GB\r\n  - gpu5      : Tesla V100-SXM2-16GB\r\n  - gpu6      : Tesla V100-SXM2-16GB\r\n  - gpu7      : Tesla V100-SXM2-16GB\r\n\r\n=== Environment ===\r\nplatform      : Linux-4.4.0-1075-aws-x86_64-with-debian-buster-sid\r\ndistro        : Ubuntu 18.04 bionic\r\nconda env     : Unknown\r\npython        : /usr/local/bin/python\r\nsys.path      :\r\n/usr/local/anaconda/lib/python37.zip\r\n/usr/local/anaconda/lib/python3.7\r\n/usr/local/anaconda/lib/python3.7/lib-dynload\r\n/usr/local/anaconda/lib/python3.7/site-packages\r\n/usr/local/anaconda/lib/python3.7/site-packages/IPython/extensions\r\nno nvidia-smi is found\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2561", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2561/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2561/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2561/events", "html_url": "https://github.com/fastai/fastai/issues/2561", "id": 613477892, "node_id": "MDU6SXNzdWU2MTM0Nzc4OTI=", "number": 2561, "title": "Issue in running the Roberta Model using FastAI", "user": {"login": "shravankoninti", "id": 6191291, "node_id": "MDQ6VXNlcjYxOTEyOTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/6191291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shravankoninti", "html_url": "https://github.com/shravankoninti", "followers_url": "https://api.github.com/users/shravankoninti/followers", "following_url": "https://api.github.com/users/shravankoninti/following{/other_user}", "gists_url": "https://api.github.com/users/shravankoninti/gists{/gist_id}", "starred_url": "https://api.github.com/users/shravankoninti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shravankoninti/subscriptions", "organizations_url": "https://api.github.com/users/shravankoninti/orgs", "repos_url": "https://api.github.com/users/shravankoninti/repos", "events_url": "https://api.github.com/users/shravankoninti/events{/privacy}", "received_events_url": "https://api.github.com/users/shravankoninti/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-06T17:10:54Z", "updated_at": "2020-05-07T11:47:41Z", "closed_at": "2020-05-07T11:47:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi All,\r\n\r\nI am running a Roberta Model for predicting the sentence classification task. I am using Fastai implementation of it. I get a similar error as mentioned below. Please help me resolve this.\r\n\r\n![fast_er_1](https://user-images.githubusercontent.com/6191291/81207069-a1545800-8fea-11ea-81e2-cdb572b324a7.JPG)\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2560", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2560/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2560/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2560/events", "html_url": "https://github.com/fastai/fastai/issues/2560", "id": 613398287, "node_id": "MDU6SXNzdWU2MTMzOTgyODc=", "number": 2560, "title": "ds_type does not apply for TextClassificationInterpretation.from_learner", "user": {"login": "kdmcdrm", "id": 5034163, "node_id": "MDQ6VXNlcjUwMzQxNjM=", "avatar_url": "https://avatars3.githubusercontent.com/u/5034163?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kdmcdrm", "html_url": "https://github.com/kdmcdrm", "followers_url": "https://api.github.com/users/kdmcdrm/followers", "following_url": "https://api.github.com/users/kdmcdrm/following{/other_user}", "gists_url": "https://api.github.com/users/kdmcdrm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kdmcdrm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kdmcdrm/subscriptions", "organizations_url": "https://api.github.com/users/kdmcdrm/orgs", "repos_url": "https://api.github.com/users/kdmcdrm/repos", "events_url": "https://api.github.com/users/kdmcdrm/events{/privacy}", "received_events_url": "https://api.github.com/users/kdmcdrm/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-06T15:12:37Z", "updated_at": "2020-05-07T12:03:50Z", "closed_at": "2020-05-07T12:03:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "It looks to me like it is not possible to set the ds_type when using TextClassificationInterpretation.from_learner. The issue is that the constructor fills arguments with the output of the learner object, which causes the default argument to get used for ds_type.\r\n\r\nHere's the relevant snippet in fastai.text.interpret.py\r\n``` python\r\nclass TextClassificationInterpretation(ClassificationInterpretation):\r\n    \"\"\"Provides an interpretation of classification based on input sensitivity.\r\n    This was designed for AWD-LSTM only for the moment, because Transformer already has its own attentional model.\r\n    \"\"\"\r\n\r\n    def __init__(self, learn: Learner, preds: Tensor, y_true: Tensor, losses: Tensor, ds_type: DatasetType = DatasetType.Valid):\r\n        super().__init__(learn,preds,y_true,losses,ds_type)\r\n        self.model = learn.model\r\n\r\n    @classmethod\r\n    def from_learner(cls, learn: Learner,  ds_type:DatasetType=DatasetType.Valid, activ:nn.Module=None):\r\n        \"Gets preds, y_true, losses to construct base class from a learner\"\r\n        return cls(learn, *learn.get_preds(ds_type=ds_type, activ=activ, with_loss=True, ordered=True))\r\n```\r\n\r\nYou can reproduce by doing\r\n```python\r\ninterp = TextClassificationInterpretation.from_learner(learn, ds_type=DatasetType.Test)\r\nprint(interp.ds_type)\r\n```\r\nwhere you'll find it's DatasetType.Valid.\r\n\r\nThis was very confusing for me as my validation and test sets are the same size so it would provide the losses associated with the incorrect text!\r\n\r\nI am seeing this with version 1.0.60, but I took a look at the code in master and it doesn't appear to have been fixed.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2559", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2559/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2559/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2559/events", "html_url": "https://github.com/fastai/fastai/issues/2559", "id": 613355198, "node_id": "MDU6SXNzdWU2MTMzNTUxOTg=", "number": 2559, "title": "emb_szs", "user": {"login": "MorPeled", "id": 48720490, "node_id": "MDQ6VXNlcjQ4NzIwNDkw", "avatar_url": "https://avatars2.githubusercontent.com/u/48720490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MorPeled", "html_url": "https://github.com/MorPeled", "followers_url": "https://api.github.com/users/MorPeled/followers", "following_url": "https://api.github.com/users/MorPeled/following{/other_user}", "gists_url": "https://api.github.com/users/MorPeled/gists{/gist_id}", "starred_url": "https://api.github.com/users/MorPeled/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MorPeled/subscriptions", "organizations_url": "https://api.github.com/users/MorPeled/orgs", "repos_url": "https://api.github.com/users/MorPeled/repos", "events_url": "https://api.github.com/users/MorPeled/events{/privacy}", "received_events_url": "https://api.github.com/users/MorPeled/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-06T14:15:51Z", "updated_at": "2020-05-07T11:53:00Z", "closed_at": "2020-05-07T11:53:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/fastai/fastai/blob/564896d7b84b59bee40db19ee298a1028235442b/fastai/tabular/models.py#L8\r\n\r\nHi,\r\n\r\nOn [documentation ](https://docs.fast.ai/tabular.learner.html) it said that emb_szs is a dictionary of string & int - if I got it right the string is the categorical variable name. I see here that it's not a dict but something else?\r\n\r\nThanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2555", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2555/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2555/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2555/events", "html_url": "https://github.com/fastai/fastai/issues/2555", "id": 608944036, "node_id": "MDU6SXNzdWU2MDg5NDQwMzY=", "number": 2555, "title": "ImageList.from_df fails for data frame with one row", "user": {"login": "JiahuaWU", "id": 44506368, "node_id": "MDQ6VXNlcjQ0NTA2MzY4", "avatar_url": "https://avatars3.githubusercontent.com/u/44506368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JiahuaWU", "html_url": "https://github.com/JiahuaWU", "followers_url": "https://api.github.com/users/JiahuaWU/followers", "following_url": "https://api.github.com/users/JiahuaWU/following{/other_user}", "gists_url": "https://api.github.com/users/JiahuaWU/gists{/gist_id}", "starred_url": "https://api.github.com/users/JiahuaWU/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JiahuaWU/subscriptions", "organizations_url": "https://api.github.com/users/JiahuaWU/orgs", "repos_url": "https://api.github.com/users/JiahuaWU/repos", "events_url": "https://api.github.com/users/JiahuaWU/events{/privacy}", "received_events_url": "https://api.github.com/users/JiahuaWU/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-04-29T10:26:31Z", "updated_at": "2020-04-30T12:20:53Z", "closed_at": "2020-04-30T12:20:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n`ImageList.from_df` fails for data frame with one single row before checking if the file path is valid.\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython       : 3.7.4\r\nfastai       : 1.0.60\r\nfastprogress : 0.2.2\r\ntorch        : 1.4.0\r\ntorch cuda   : None / is **Not available** \r\n\r\n=== Hardware === \r\nNo GPUs available \r\n\r\n=== Environment === \r\nplatform     : Darwin-19.4.0-x86_64-i386-64bit\r\nconda env    : base\r\npython       : /Users/jiahuawu/opt/anaconda3/bin/python3\r\nsys.path     : \r\n/Users/jiahuawu/opt/anaconda3/lib/python37.zip\r\n/Users/jiahuawu/opt/anaconda3/lib/python3.7\r\n/Users/jiahuawu/opt/anaconda3/lib/python3.7/lib-dynload\r\n/Users/jiahuawu/opt/anaconda3/lib/python3.7/site-packages\r\n/Users/jiahuawu/opt/anaconda3/lib/python3.7/site-packages/aeosa\r\n/Users/jiahuawu/opt/anaconda3/lib/python3.7/site-packages/IPython/extensions\r\nno supported gpus found on this system\r\n```\r\n**To Reproduce**\r\n```\r\n>>> from fastai.vision import *\r\n>>> df = pd.DataFrame([\"123.png\"], columns=[\"names\"])\r\n>>> ImageList.from_df(path=\".\", df=df)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/Users/jiahuawu/opt/anaconda3/lib/python3.7/site-packages/fastai/data_block.py\", line 77, in __repr__\r\n    items = [self[i] for i in range(min(5,len(self.items)))]\r\nTypeError: len() of unsized object\r\n```\r\n\r\n**Expected behavior**\r\nAn ImageList with one item should be created if the path is valid.\r\n\r\n**Additional context**\r\nBased on my investigation in the code base, the problem is that [`_maybe_squeeze`](https://github.com/fastai/fastai/blob/master/fastai/data_block.py#L13) returns a 0d array for data frame with one single row while 1d array for dataframe with multiple rows.\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2553", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2553/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2553/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2553/events", "html_url": "https://github.com/fastai/fastai/issues/2553", "id": 608349492, "node_id": "MDU6SXNzdWU2MDgzNDk0OTI=", "number": 2553, "title": "Deprecation warnings in Python 3.8", "user": {"login": "tirkarthi", "id": 3972343, "node_id": "MDQ6VXNlcjM5NzIzNDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/3972343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tirkarthi", "html_url": "https://github.com/tirkarthi", "followers_url": "https://api.github.com/users/tirkarthi/followers", "following_url": "https://api.github.com/users/tirkarthi/following{/other_user}", "gists_url": "https://api.github.com/users/tirkarthi/gists{/gist_id}", "starred_url": "https://api.github.com/users/tirkarthi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tirkarthi/subscriptions", "organizations_url": "https://api.github.com/users/tirkarthi/orgs", "repos_url": "https://api.github.com/users/tirkarthi/repos", "events_url": "https://api.github.com/users/tirkarthi/events{/privacy}", "received_events_url": "https://api.github.com/users/tirkarthi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-28T14:09:46Z", "updated_at": "2020-04-28T17:32:34Z", "closed_at": "2020-04-28T17:32:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\n* Deprecation warning due to invalid escape sequences. Using raw strings or escaping them again helps in resolving this. Check https://github.com/asottile/pyupgrade/ for automatic fix of this.\r\n* Syntax warning due to comparison of literals using is\r\n\r\n**To Reproduce**\r\n\r\n```\r\nfind . -iname '*.py' | grep -Ev 'rdf4|tool|doc|old|courses' | xargs -P4 -I{} python3.8 -Wall -m py_compile {}\r\n./tests/test_utils_links.py:29: DeprecationWarning: invalid escape sequence \\[\r\n  docstr   = \"- `LayerFunc` = `Callable`\\[`nn.Module`],`None`]\"\r\n./tests/test_utils_links.py:30: DeprecationWarning: invalid escape sequence \\[\r\n  expected = \"- `LayerFunc` = `Callable`\\[[`nn.Module`](https://pytorch.org/docs/stable/nn.html#torch.nn.Module)],`None`]\"\r\n./tests/test_utils_links.py:35: DeprecationWarning: invalid escape sequence \\[\r\n  docstr   = \"- `ParamList` = `Collection`\\[`nn`.`Parameter`]\"\r\n./tests/test_utils_links.py:36: DeprecationWarning: invalid escape sequence \\[\r\n  expected = \"- `ParamList` = `Collection`\\[[`nn`](https://pytorch.org/docs/stable/nn.html#torch-nn).`Parameter`]\"\r\n./tests/test_vision_data.py:63: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n  if func is 'from_df': data = ImageDataBunch.from_df(path, df=pd.read_csv(path/'labels.csv'), size=28)\r\n./tests/test_core.py:84: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n  assert noop(1) is 1\r\n./tests/test_vision_gan.py:43: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n  assert f\"{item}\" is \"\"\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2552", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2552/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2552/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2552/events", "html_url": "https://github.com/fastai/fastai/issues/2552", "id": 608347838, "node_id": "MDU6SXNzdWU2MDgzNDc4Mzg=", "number": 2552, "title": "Importing ABC from collections has been deprecated and will be removed in Python 3.10", "user": {"login": "tirkarthi", "id": 3972343, "node_id": "MDQ6VXNlcjM5NzIzNDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/3972343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tirkarthi", "html_url": "https://github.com/tirkarthi", "followers_url": "https://api.github.com/users/tirkarthi/followers", "following_url": "https://api.github.com/users/tirkarthi/following{/other_user}", "gists_url": "https://api.github.com/users/tirkarthi/gists{/gist_id}", "starred_url": "https://api.github.com/users/tirkarthi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tirkarthi/subscriptions", "organizations_url": "https://api.github.com/users/tirkarthi/orgs", "repos_url": "https://api.github.com/users/tirkarthi/repos", "events_url": "https://api.github.com/users/tirkarthi/events{/privacy}", "received_events_url": "https://api.github.com/users/tirkarthi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-28T14:07:20Z", "updated_at": "2020-04-28T17:32:34Z", "closed_at": "2020-04-28T17:32:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n\r\nImporting ABC from collections has been deprecated and will be removed in Python 3.10\r\n\r\n**To Reproduce**\r\n\r\n```\r\nfastai/torch_core.py:    if isinstance(o, collections.Sized) or getattr(o,'__array_interface__',False): return o\r\nfastai/core.py:    if not isinstance(a, collections.Sized) and not getattr(a,'__array_interface__',False):\r\n```\r\n\r\n**Expected behavior**\r\n\r\nuse collections.abc instead.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2551", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2551/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2551/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2551/events", "html_url": "https://github.com/fastai/fastai/issues/2551", "id": 607899566, "node_id": "MDU6SXNzdWU2MDc4OTk1NjY=", "number": 2551, "title": "Feature Fusion", "user": {"login": "ghasemabdi", "id": 52261703, "node_id": "MDQ6VXNlcjUyMjYxNzAz", "avatar_url": "https://avatars2.githubusercontent.com/u/52261703?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghasemabdi", "html_url": "https://github.com/ghasemabdi", "followers_url": "https://api.github.com/users/ghasemabdi/followers", "following_url": "https://api.github.com/users/ghasemabdi/following{/other_user}", "gists_url": "https://api.github.com/users/ghasemabdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghasemabdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghasemabdi/subscriptions", "organizations_url": "https://api.github.com/users/ghasemabdi/orgs", "repos_url": "https://api.github.com/users/ghasemabdi/repos", "events_url": "https://api.github.com/users/ghasemabdi/events{/privacy}", "received_events_url": "https://api.github.com/users/ghasemabdi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-27T22:37:44Z", "updated_at": "2020-04-28T17:26:18Z", "closed_at": "2020-04-28T11:56:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi folks,\r\nI have two different image data-set but related to a same class. I am going to use pre-trained net like alexnet for both to detect features and then, concatenate those features into a classifier. I would appreciate if you can help me within fastai platform.\r\n\r\nIn pytorch, we use this for dataloaders, while in fastai, I do not have any idea:\r\n\r\n```\r\nclass DoubleSource(torch.utils.data.Dataset):\r\n  def __init__(self, img_i , img_ii, transform=None):\r\n    self.img_i = img_i\r\n    self.img_ii = img_ii\r\n    \r\n    if transform is None:\r\n      self.transform = transforms.ToTensor()\r\n    else:\r\n      self.transform = transform\r\n  \r\n  def __getitem__(self, idx):\r\n    names_i, labels = self.img_i[idx]\r\n    names_ii, labels = self.img_ii[idx]\r\n    input_i = Image.open(names_i).convert('RGB')\r\n    input_ii = Image.open(names_ii).convert('RGB')\r\n    input_i = self.transform(input_i)\r\n    input_ii = self.transform(input_ii)\r\n    return input_i, input_ii, labels, names_i, names_ii\r\n  \r\n  def __len__(self):\r\n    return len(self.img_i)\r\n```\r\n\r\nIn pytorch, we use this for pre-trained model, while in fastai, I do not have any idea:\r\n\r\n```\r\nclass initialize_model(nn.Module):\r\n  def __init__(self, num_classes=10, feature_extract=True, use_pretrained=True):\r\n    super(initialize_model, self).__init__()\r\n\r\n    model_ft = models.alexnet(pretrained=use_pretrained)\r\n    set_parameter_requires_grad(model_ft, feature_extract)\r\n\r\n    self.features_i = model_ft.features\r\n    self.features_ii = model_ft.features\r\n\r\n    self.classifier = model_ft.classifier\r\n    self.classifier[1] = nn.Linear(2 * model_ft.classifier[1].in_features, model_ft.classifier[1].out_features)\r\n    self.classifier[6] = nn.Linear(model_ft.classifier[6].in_features, num_classes)\r\n  \r\n  def forward(self, input_i, input_ii):\r\n    output_i = self.features_i(input_i)\r\n    output_i = output_i.view(output_i.size(0), -1)\r\n    output_ii = self.features_ii(input_ii)\r\n    output_ii = output_ii.view(output_ii.size(0), -1)\r\n    \r\n    output = torch.cat((output_i, output_ii), dim=1)\r\n    output = self.classifier(output)\r\n    return output\r\n```\r\nThanks in advance,", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2550", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2550/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2550/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2550/events", "html_url": "https://github.com/fastai/fastai/issues/2550", "id": 605813316, "node_id": "MDU6SXNzdWU2MDU4MTMzMTY=", "number": 2550, "title": "n_classes not defined error in fastai.metrics file", "user": {"login": "Yue1Harriet1Huang", "id": 5599444, "node_id": "MDQ6VXNlcjU1OTk0NDQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/5599444?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Yue1Harriet1Huang", "html_url": "https://github.com/Yue1Harriet1Huang", "followers_url": "https://api.github.com/users/Yue1Harriet1Huang/followers", "following_url": "https://api.github.com/users/Yue1Harriet1Huang/following{/other_user}", "gists_url": "https://api.github.com/users/Yue1Harriet1Huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/Yue1Harriet1Huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Yue1Harriet1Huang/subscriptions", "organizations_url": "https://api.github.com/users/Yue1Harriet1Huang/orgs", "repos_url": "https://api.github.com/users/Yue1Harriet1Huang/repos", "events_url": "https://api.github.com/users/Yue1Harriet1Huang/events{/privacy}", "received_events_url": "https://api.github.com/users/Yue1Harriet1Huang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-23T19:41:09Z", "updated_at": "2020-04-24T11:50:18Z", "closed_at": "2020-04-24T11:49:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n\r\nline 158 in fastai.metrics file, n_classes is used without pre-defining, hence generating not defined error , unless it meant self.n_classes just like how it is being used anywhere else in the same file.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2549", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2549/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2549/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2549/events", "html_url": "https://github.com/fastai/fastai/issues/2549", "id": 605666227, "node_id": "MDU6SXNzdWU2MDU2NjYyMjc=", "number": 2549, "title": "How do we get support for this library?", "user": {"login": "tchaffee", "id": 148813, "node_id": "MDQ6VXNlcjE0ODgxMw==", "avatar_url": "https://avatars2.githubusercontent.com/u/148813?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tchaffee", "html_url": "https://github.com/tchaffee", "followers_url": "https://api.github.com/users/tchaffee/followers", "following_url": "https://api.github.com/users/tchaffee/following{/other_user}", "gists_url": "https://api.github.com/users/tchaffee/gists{/gist_id}", "starred_url": "https://api.github.com/users/tchaffee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tchaffee/subscriptions", "organizations_url": "https://api.github.com/users/tchaffee/orgs", "repos_url": "https://api.github.com/users/tchaffee/repos", "events_url": "https://api.github.com/users/tchaffee/events{/privacy}", "received_events_url": "https://api.github.com/users/tchaffee/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-23T16:15:12Z", "updated_at": "2020-04-24T11:47:53Z", "closed_at": "2020-04-24T11:47:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "No one is responding to my questions on the forum even after waiting days and I don't see any other options for getting support. I didn't want to open an issue, but I don't see how I can consider using this library in a professional setting if I cannot get support. The library seems very promising and I think the courses are excellent. But I would really like to consider using it beyond the courses.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2547", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2547/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2547/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2547/events", "html_url": "https://github.com/fastai/fastai/issues/2547", "id": 603366289, "node_id": "MDU6SXNzdWU2MDMzNjYyODk=", "number": 2547, "title": "test_vision_data broken on PyTorch 1.5+", "user": {"login": "gchanan", "id": 3768583, "node_id": "MDQ6VXNlcjM3Njg1ODM=", "avatar_url": "https://avatars2.githubusercontent.com/u/3768583?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gchanan", "html_url": "https://github.com/gchanan", "followers_url": "https://api.github.com/users/gchanan/followers", "following_url": "https://api.github.com/users/gchanan/following{/other_user}", "gists_url": "https://api.github.com/users/gchanan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gchanan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gchanan/subscriptions", "organizations_url": "https://api.github.com/users/gchanan/orgs", "repos_url": "https://api.github.com/users/gchanan/repos", "events_url": "https://api.github.com/users/gchanan/events{/privacy}", "received_events_url": "https://api.github.com/users/gchanan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-04-20T16:25:00Z", "updated_at": "2020-05-01T21:07:31Z", "closed_at": "2020-04-22T15:07:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nThe following invocation (among others) fails if I install PyTorch 1.5+:\r\n```\r\npytest tests/test_vision_data.py -k test_camvid\r\nE               Exception: It's not possible to apply those transforms to your dataset:\r\nE                Expected object of scalar type Float but got scalar type Double for argument #3 'mat2' in call to _th_addmm_out\r\n```\r\n\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n```text\r\n=== Software ===\r\npython        : 3.7.4\r\nfastai        : 1.0.61.dev0\r\nfastprogress  : 0.2.3\r\ntorch         : 1.5.0a0+c164fbc\r\nnvidia driver : 396.69\r\ntorch cuda    : None / is **Not available**\r\n\r\n=== Hardware ===\r\nnvidia gpus   : 2\r\nHave 2 GPU(s), but torch can't use them (check nvidia driver)\r\n\r\n=== Environment ===\r\nplatform      : Linux-4.16.18-210_fbk23_5358_gf2838c074351-x86_64-with-centos-7.6.1810-Core\r\ndistro        : CentOS Linux 7 Core\r\nconda env     : __py37g11\r\npython        : /data/users/gchanan/anaconda3/envs/__py37g11/bin/python\r\nsys.path      : /data/users/gchanan/fastai\r\n/data/users/gchanan/anaconda3/envs/__py37g11/lib/python37.zip\r\n/data/users/gchanan/anaconda3/envs/__py37g11/lib/python3.7\r\n/data/users/gchanan/anaconda3/envs/__py37g11/lib/python3.7/lib-dynload\r\n/data/users/gchanan/anaconda3/envs/__py37g11/lib/python3.7/site-packages\r\n/data/users/gchanan/_pytorch11\r\n/data/users/gchanan/anaconda3/envs/__py37g11/lib/python3.7/site-packages/future-0.18.2-py3.7.egg\r\n/data/users/gchanan/fastai\r\n/data/users/gchanan/anaconda3/envs/__py37g11/lib/python3.7/site-packages/IPython/extensions\r\n```\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\nSee above\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\nTests should pass\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\nThe issue appears to be caused by this: https://github.com/pytorch/pytorch/pull/30486\r\nBasically, this changed how the dtype inference worked for the `torch.tensor` constructor wrt NumPy scalars (like `np.float_`).  Previously, inference treated these as (basically) `float32` and now it matches the \"dtype\" of the NumPy scalar.  The previous behavior was definitely wrong for integral types, and it also changed how floating-point types are inferred, because `np.float_` would previously have been inferred as `float32` and now it is being inferred as `float64`.  This eventually causes the error in the test: the tensor type is created a `float64` tensor and is `matmul`-ed against a `float32` tensor, and `matmul` doesn't support type promotion.\r\n\r\nI checked and adding:\r\n```\r\nif res.dtype == torch.float64:\r\n        res = res.to(torch.torch.float32)\r\n```\r\nbelow https://github.com/fastai/fastai/blob/98b0ebb404aca768817675565933c72e2ca5ff1f/fastai/torch_core.py#L81 fixes the test.  There are probably better ways of solving though, like ensuring you are using `np.float32` instead of `np.float_`.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2545", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2545/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2545/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2545/events", "html_url": "https://github.com/fastai/fastai/issues/2545", "id": 602654525, "node_id": "MDU6SXNzdWU2MDI2NTQ1MjU=", "number": 2545, "title": "Regarding TPU details on colab", "user": {"login": "vainaijr", "id": 43755000, "node_id": "MDQ6VXNlcjQzNzU1MDAw", "avatar_url": "https://avatars0.githubusercontent.com/u/43755000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vainaijr", "html_url": "https://github.com/vainaijr", "followers_url": "https://api.github.com/users/vainaijr/followers", "following_url": "https://api.github.com/users/vainaijr/following{/other_user}", "gists_url": "https://api.github.com/users/vainaijr/gists{/gist_id}", "starred_url": "https://api.github.com/users/vainaijr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vainaijr/subscriptions", "organizations_url": "https://api.github.com/users/vainaijr/orgs", "repos_url": "https://api.github.com/users/vainaijr/repos", "events_url": "https://api.github.com/users/vainaijr/events{/privacy}", "received_events_url": "https://api.github.com/users/vainaijr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-19T08:19:04Z", "updated_at": "2020-04-19T14:05:10Z", "closed_at": "2020-04-19T14:05:10Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "hello,\r\n\r\nwhen I do \r\n```\r\npip install distro\r\nimport fastai.utils.collect_env;\r\nfastai.utils.collect_env.show_install(1)\r\n```\r\nthen it show GPU detail, but when I use TPU on colab, then it not show TPU detail,\r\ncould something be done to show TPU detail also.\r\n\r\nthanks", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2543", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2543/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2543/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2543/events", "html_url": "https://github.com/fastai/fastai/issues/2543", "id": 597216305, "node_id": "MDU6SXNzdWU1OTcyMTYzMDU=", "number": 2543, "title": "predict kills kernel with np.array image, but not with open_image", "user": {"login": "LeKristapino", "id": 5788556, "node_id": "MDQ6VXNlcjU3ODg1NTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5788556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeKristapino", "html_url": "https://github.com/LeKristapino", "followers_url": "https://api.github.com/users/LeKristapino/followers", "following_url": "https://api.github.com/users/LeKristapino/following{/other_user}", "gists_url": "https://api.github.com/users/LeKristapino/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeKristapino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeKristapino/subscriptions", "organizations_url": "https://api.github.com/users/LeKristapino/orgs", "repos_url": "https://api.github.com/users/LeKristapino/repos", "events_url": "https://api.github.com/users/LeKristapino/events{/privacy}", "received_events_url": "https://api.github.com/users/LeKristapino/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-04-09T11:28:15Z", "updated_at": "2020-04-09T12:27:51Z", "closed_at": "2020-04-09T12:11:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "When running the `predict` method on trained model, I do some pre-processing, to correct the image size. As a result of the pre-processing I get a numpy array that I use to run the prediction.\r\n\r\n```\r\nr_img, h, w = resize_image(images[1]) \r\nsim =r_img.astype(np.float32) \r\nim = Image(torch.from_numpy(sim))\r\nresult = learner.predict(im)\r\n```\r\n\r\nThe predict method runs for a bit and then kills and restarts the jupyter notebook kernel. I have tried this both with and without `fp16` and on both - CPU and GPU.\r\n\r\nThe method works fine, however, when running the prediction on a normal image\r\n\r\n```\r\nim = open_image(images[1])\r\nresult = learner.predict(im)\r\n```\r\n\r\nAs far as I've debugged, there doesn't seem to be an issue in pre-processing itself as everything up to running `predict` works just fine. I also don't get any pytorch errors or anything that could be of more use for debugging - the kernel just dies. \r\n\r\nI'm running on GeForce RTX 2070\r\n\r\nThis is the resize_image method\r\n\r\n```\r\nRESULT_SIZE=512\r\nPADDING_COLOR = (255,255,255)\r\n# resize image and put padding on bottom/right side when necessarry\r\ndef resize_image(image_path):\r\n    # Get file name and extension\r\n    parts = str(image_path).split(\"/\")\r\n    fname = parts[len(parts)-1]\r\n    fname_parts = fname.split(\".\")\r\n    ext = fname_parts[1]\r\n    fname = fname_parts[0]\r\n\r\n    image = cv2.imread(str(image_path))\r\n    height, width, channels = image.shape\r\n    ratio = height / width\r\n\r\n    if height > width:\r\n        new_height = RESULT_SIZE\r\n        new_width = int(RESULT_SIZE / ratio)\r\n    elif width > height:\r\n        new_height = int(RESULT_SIZE * ratio)\r\n        new_width = RESULT_SIZE\r\n    else:\r\n        new_height = RESULT_SIZE\r\n        new_width = RESULT_SIZE\r\n\r\n    # dimensions\r\n    #resize the longest dimension, keeping aspect ratio\r\n\r\n    resized = cv2.resize(image, (new_width, new_height))\r\n\r\n    padded = np.full((RESULT_SIZE,RESULT_SIZE,channels), PADDING_COLOR, dtype=np.uint8)\r\n\r\n    # # copy img image into top-left corner\r\n    padded[0:new_height, 0:new_width] = resized\r\n\r\n    return [padded, height, width]\r\n\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2542", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2542/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2542/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2542/events", "html_url": "https://github.com/fastai/fastai/issues/2542", "id": 597122579, "node_id": "MDU6SXNzdWU1OTcxMjI1Nzk=", "number": 2542, "title": "TabularProc constructors cause error", "user": {"login": "andycraig", "id": 23294156, "node_id": "MDQ6VXNlcjIzMjk0MTU2", "avatar_url": "https://avatars1.githubusercontent.com/u/23294156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andycraig", "html_url": "https://github.com/andycraig", "followers_url": "https://api.github.com/users/andycraig/followers", "following_url": "https://api.github.com/users/andycraig/following{/other_user}", "gists_url": "https://api.github.com/users/andycraig/gists{/gist_id}", "starred_url": "https://api.github.com/users/andycraig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andycraig/subscriptions", "organizations_url": "https://api.github.com/users/andycraig/orgs", "repos_url": "https://api.github.com/users/andycraig/repos", "events_url": "https://api.github.com/users/andycraig/events{/privacy}", "received_events_url": "https://api.github.com/users/andycraig/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-09T08:43:55Z", "updated_at": "2020-04-10T08:24:35Z", "closed_at": "2020-04-09T12:06:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n`TabularProc` subclasses cannot be used via their constructors. E.g., `FillMissing` is okay, but `FillMissing(cat_names, cont_names, fill_strategy=FillStrategy.CONSTANT)` will cause an error.\r\n\r\nThe same applies for `Categorify` and `Normalize`, but they don't have any additional constructor arguments so there's no reason to ever create them via the constructor.\r\n\r\nI asked a question about this on the forum: https://forums.fast.ai/t/errors-using-tabularproc-constructors/67975 but looking at the fastai code I'm pretty sure this is a bug. The only other thread I could find on the forum about `TabularProc` constructors was this one: https://forums.fast.ai/t/how-to-change-fillmissing-to-a-constant-in-procs-for-tabular-data/32616 The answer suggests that the `FillMissing`'s `fill_strategy` values etc. be set by subclassing it, rather than using the constructor.\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n```text\r\n=== Software === \r\npython        : 3.6.8\r\nfastai        : 1.0.61.dev0\r\nfastprogress  : 0.2.3\r\ntorch         : 1.4.0\r\nnvidia driver : 390.116\r\ntorch cuda    : 10.1 / is **Not available** \r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\nHave 1 GPU(s), but torch can't use them (check nvidia driver) \r\n\r\n=== Environment === \r\nplatform      : Linux-4.15.0-96-generic-x86_64-with-Ubuntu-18.04-bionic\r\ndistro        : #97-Ubuntu SMP Wed Apr 1 03:25:46 UTC 2020\r\nconda env     : Unknown\r\npython        : /home/ac/projects/python/fastaigit/env/bin/python\r\nsys.path      : \r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages\r\n```\r\n\r\nUsing fastai installed with `pip install git+https://github.com/fastai/fastai/` d1551ab3221812bd47e704fc4f5e59e2b6938216\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\nHere is an example using `FillMissing` with and without its constructor:\r\n\r\n```\r\nfrom fastai.tabular import *\r\n\r\npath = untar_data(URLs.ADULT_SAMPLE)\r\n\r\ncat_names = ['workclass', 'education', 'marital-status', 'occupation', 'relationship', 'race', 'sex', 'native-country']\r\ncont_names = ['age', 'fnlwgt', 'education-num']\r\n\r\n# Modified version of learn() from:\r\n# https://github.com/fastai/fastai/blob/1a914b365720aa216a4a377705fe11707a665fe9/tests/test_tabular_train.py\r\ndef preprocess(procs=[FillMissing, Categorify, Normalize]):\r\n    df = pd.read_csv(path/'adult.csv')\r\n    dep_var = 'salary'\r\n    test = TabularList.from_df(df.iloc[800:1000].copy(), path=path, cat_names=cat_names, cont_names=cont_names)\r\n    data = (TabularList.from_df(df, path=path, cat_names=cat_names, cont_names=cont_names, procs=procs)\r\n        .split_by_idx(list(range(800,1000)))\r\n        .label_from_df(cols=dep_var)\r\n        .add_test(test)\r\n        .databunch(num_workers=1))\r\n\r\n# Succeeds\r\npreprocess([FillMissing, Categorify, Normalize])\r\n\r\n# Fails\r\npreprocess([FillMissing(cat_names=cat_names, cont_names=cont_names, fill_strategy=FillStrategy.CONSTANT), Categorify, Normalize])\r\n```\r\n\r\nStack trace:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 2, in <module>\r\n  File \"<stdin>\", line 9, in preprocess\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/data_block.py\", line 483, in _inner\r\n    self.process()\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/data_block.py\", line 537, in process\r\n    for ds,n in zip(self.lists, ['train','valid','test']): ds.process(xp, yp, name=n)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/data_block.py\", line 717, in process\r\n    self.x.process(xp)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/data_block.py\", line 84, in process\r\n    for p in self.processor: p.process(self)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/tabular/data.py\", line 62, in process\r\n    if isinstance(proc, TabularProc): proc(ds.inner_df, test=True)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/tabular/transform.py\", line 124, in __call__\r\n    func(df)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/tabular/transform.py\", line 172, in apply_test\r\n    if name in self.na_dict:\r\nAttributeError: 'FillMissing' object has no attribute 'na_dict'\r\n```\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\nRuns without raising an error.\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n\r\nI believe the reason for this error is that `apply_test` is being called before `apply_train` has been called. We can check with this `TabularProc` subclass. (Run this code after running the code above.)\r\n\r\n```\r\nclass TrainBeforeTest(TabularProc):\r\n    trained = False\r\n    def apply_train(self, df:DataFrame):\r\n        self.trained = True\r\n    def apply_test(self, df:DataFrame):\r\n        if not self.trained:\r\n            raise Exception(\"apply_test called before apply_train\")\r\n\r\n# Succeeds\r\npreprocess([TrainBeforeTest, FillMissing, Categorify, Normalize])\r\n\r\n# Fails\r\npreprocess([TrainBeforeTest(cat_names=cat_names, cont_names=cont_names), FillMissing, Categorify, Normalize])\r\n```\r\n\r\nStack trace:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 2, in <module>\r\n  File \"<stdin>\", line 9, in preprocess\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/data_block.py\", line 483, in _inner\r\n    self.process()\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/data_block.py\", line 537, in process\r\n    for ds,n in zip(self.lists, ['train','valid','test']): ds.process(xp, yp, name=n)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/data_block.py\", line 717, in process\r\n    self.x.process(xp)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/data_block.py\", line 84, in process\r\n    for p in self.processor: p.process(self)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/tabular/data.py\", line 62, in process\r\n    if isinstance(proc, TabularProc): proc(ds.inner_df, test=True)\r\n  File \"/home/ac/projects/python/fastaigit/env/lib/python3.6/site-packages/fastai/tabular/transform.py\", line 124, in __call__\r\n    func(df)\r\n  File \"<stdin>\", line 7, in apply_test\r\nException: apply_test called before apply_train\r\n```\r\n\r\nI think the underlying reason is this line: https://github.com/fastai/fastai/blob/d1551ab3221812bd47e704fc4f5e59e2b6938216/fastai/tabular/data.py#L62\r\n\r\nIf `proc` has already been initialised via its constructor, `isinstance(proc, TabularProc)` will be `True` and so `proc()` will always be called with `test=True`.\r\n\r\n**Suggested fix**\r\n\r\nAdd a property `trained:bool` to `TabularProc`. Then that could be used in `TabularPreprocessor.process()`,  instead of using `isinstance(proc, TabularProc)` as the condition.\r\n\r\n**Side note: `cat_names` and `cont_names`**\r\n\r\nFrom these lines it looks like perhaps it is intended that `cat_names` and `cont_names` should always be set internally: https://github.com/fastai/fastai/blob/d1551ab3221812bd47e704fc4f5e59e2b6938216/fastai/tabular/data.py#L64-L65 But these are the first two arguments to the constructors of `FillMissing`, `Categorify` etc.\r\n\r\nOptions I can think of:\r\n\r\n1. Overwrite `cat_names` and `cont_names` in `TabularPreprocessor.process()` (in which case the user-provided arguments are ignored)\r\n2. Remove them as constructor parameters (API change)\r\n\r\nThank you!\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2541", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2541/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2541/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2541/events", "html_url": "https://github.com/fastai/fastai/issues/2541", "id": 597075294, "node_id": "MDU6SXNzdWU1OTcwNzUyOTQ=", "number": 2541, "title": "ModelOnCPU() has destructive side effects?", "user": {"login": "kennysong", "id": 2199875, "node_id": "MDQ6VXNlcjIxOTk4NzU=", "avatar_url": "https://avatars3.githubusercontent.com/u/2199875?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennysong", "html_url": "https://github.com/kennysong", "followers_url": "https://api.github.com/users/kennysong/followers", "following_url": "https://api.github.com/users/kennysong/following{/other_user}", "gists_url": "https://api.github.com/users/kennysong/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennysong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennysong/subscriptions", "organizations_url": "https://api.github.com/users/kennysong/orgs", "repos_url": "https://api.github.com/users/kennysong/repos", "events_url": "https://api.github.com/users/kennysong/events{/privacy}", "received_events_url": "https://api.github.com/users/kennysong/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-04-09T07:19:06Z", "updated_at": "2020-04-14T07:10:24Z", "closed_at": "2020-04-13T17:21:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nI'm training a `language_model_learner` to generate company names. \r\n\r\nSurprisingly, I noticed that calling `learn.export()` mutates `learn` in some way that significantly drops the quality of the model.\r\n\r\nI manually called each line of `learn.export()` to identify where this was going wrong, and found that the model quality drops when entering the `with ModelOnCPU(learn.model) as m:` context.\r\n\r\nYou can see what happens here:\r\n\r\n<img width=\"571\" alt=\"Screen Shot 2020-04-09 at 4 07 25 PM\" src=\"https://user-images.githubusercontent.com/2199875/78867540-3a3f9400-7a7c-11ea-8d77-feac6fa14ebb.png\">\r\n\r\n(FYI,  loading the exported model with `load_learner` also gives the same garbage predictions.)\r\n\r\n**Provide your installation details**\r\n\r\n```text\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 418.87\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 15079MB | Tesla T4\r\n\r\n=== Environment === \r\nplatform      : Linux-4.9.0-12-amd64-x86_64-with-debian-9.12\r\ndistro        : #1 SMP Debian 4.9.210-1 (2020-01-20)\r\nconda env     : base\r\npython        : /opt/conda/bin/python\r\nsys.path      : /home/jupyter/data/models\r\n/opt/conda/lib/python37.zip\r\n/opt/conda/lib/python3.7\r\n/opt/conda/lib/python3.7/lib-dynload\r\n/opt/conda/lib/python3.7/site-packages\r\n/opt/conda/lib/python3.7/site-packages/IPython/extensions\r\n```\r\n\r\n**To Reproduce**\r\n\r\nPerhaps you can reproduce with a smaller example? (It takes a few hours to train the model.)\r\n\r\nIf not, here is my code:\r\n\r\n1. To download the dataset: https://gist.github.com/kennysong/daf7b77a5f42860059b312dd57968512\r\n2. To train the language model and generate predictions: https://gist.github.com/kennysong/9572da21461e10c9c6e7d7c8f6902ab4\r\n\r\n**Expected behavior**\r\n\r\n`learn.export()` should not alter `learn` at all.\r\n\r\n**Screenshots**\r\n\r\nSee above.\r\n\r\n**Additional context**\r\n\r\nAlso, a similar drop in performance happens if I do `learn.save()` and `learn2.load()`. `learn2` will generate the same garbage predictions. `learn` is unmodified.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2537", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2537/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2537/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2537/events", "html_url": "https://github.com/fastai/fastai/issues/2537", "id": 595738198, "node_id": "MDU6SXNzdWU1OTU3MzgxOTg=", "number": 2537, "title": "Importing from basic_train raises error", "user": {"login": "andycraig", "id": 23294156, "node_id": "MDQ6VXNlcjIzMjk0MTU2", "avatar_url": "https://avatars1.githubusercontent.com/u/23294156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andycraig", "html_url": "https://github.com/andycraig", "followers_url": "https://api.github.com/users/andycraig/followers", "following_url": "https://api.github.com/users/andycraig/following{/other_user}", "gists_url": "https://api.github.com/users/andycraig/gists{/gist_id}", "starred_url": "https://api.github.com/users/andycraig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andycraig/subscriptions", "organizations_url": "https://api.github.com/users/andycraig/orgs", "repos_url": "https://api.github.com/users/andycraig/repos", "events_url": "https://api.github.com/users/andycraig/events{/privacy}", "received_events_url": "https://api.github.com/users/andycraig/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-07T09:47:53Z", "updated_at": "2020-04-07T12:55:30Z", "closed_at": "2020-04-07T12:45:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\nTrying to import from `fastai.basic_train` causes a `KeyError` when using the current `master` version.\r\n\r\n**Provide your installation details**\r\n\r\n```text\r\n=== Software === \r\npython        : 3.6.8\r\nfastai        : 1.0.61.dev0\r\nfastprogress  : 0.2.3\r\ntorch         : 1.4.0\r\nnvidia driver : 390.116\r\ntorch cuda    : 10.1 / is **Not available** \r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\nHave 1 GPU(s), but torch can't use them (check nvidia driver) \r\n\r\n=== Environment === \r\nplatform      : Linux-4.15.0-88-generic-x86_64-with-Ubuntu-18.04-bionic\r\ndistro        : #88-Ubuntu SMP Tue Feb 11 20:11:34 UTC 2020\r\nconda env     : Unknown\r\npython        : /home/ac/projects/python/fastaibug/env/bin/python\r\nsys.path      : \r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/home/ac/projects/python/fastaibug/env/lib/python3.6/site-packages\r\n/home/ac/projects/python/fastaibug/env/lib/python3.6/site-packages/IPython/extensions\r\n```\r\n\r\nThis is using the latest version, installed with `pip install git+https://github.com/fastai/fastai/`.\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n```\r\nfrom fastai.basic_train import *\r\n```\r\n\r\nResult:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/ac/projects/python/fastaibug/env/lib/python3.6/site-packages/fastai/basic_train.py\", line 454, in <module>\r\n    class Recorder(LearnerCallback):\r\n  File \"/home/ac/projects/python/fastaibug/env/lib/python3.6/site-packages/fastai/basic_train.py\", line 541, in Recorder\r\n    **kwargs)->Optional[plt.Figure]:\r\nNameError: name 'kwargs' is not defined\r\n```\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\nNothing (imports successfully).\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n\r\nThere does seem to be a missing comma at the end of this line, which is probably causing a syntax error: https://github.com/fastai/fastai/blob/ee3d75c35f730f63f13f6cbbf88d61343a43b201/fastai/basic_train.py#L540\r\n\r\nThank you.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2535", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2535/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2535/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2535/events", "html_url": "https://github.com/fastai/fastai/issues/2535", "id": 594467816, "node_id": "MDU6SXNzdWU1OTQ0Njc4MTY=", "number": 2535, "title": "code redundency", "user": {"login": "amigd23", "id": 42904787, "node_id": "MDQ6VXNlcjQyOTA0Nzg3", "avatar_url": "https://avatars1.githubusercontent.com/u/42904787?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amigd23", "html_url": "https://github.com/amigd23", "followers_url": "https://api.github.com/users/amigd23/followers", "following_url": "https://api.github.com/users/amigd23/following{/other_user}", "gists_url": "https://api.github.com/users/amigd23/gists{/gist_id}", "starred_url": "https://api.github.com/users/amigd23/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amigd23/subscriptions", "organizations_url": "https://api.github.com/users/amigd23/orgs", "repos_url": "https://api.github.com/users/amigd23/repos", "events_url": "https://api.github.com/users/amigd23/events{/privacy}", "received_events_url": "https://api.github.com/users/amigd23/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-05T13:54:45Z", "updated_at": "2020-04-05T14:07:24Z", "closed_at": "2020-04-05T14:07:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "```a = np.transpose(a, (1, 0, 2))```\r\n```a = np.transpose(a, (2, 1, 0))```\r\n\r\n[see here in vision/image.py](https://github.com/fastai/fastai/blob/3b7c453cfa3845c6ffc496dd4043c07f3919270e/fastai/vision/image.py#L18-L19)\r\n\r\nNot a bug, but wonder isn't this the same with ```a = np.transpose(a, (2, 0, 1))```?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2533", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2533/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2533/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2533/events", "html_url": "https://github.com/fastai/fastai/issues/2533", "id": 593661068, "node_id": "MDU6SXNzdWU1OTM2NjEwNjg=", "number": 2533, "title": "Native automatic mixed precision for fastai", "user": {"login": "mcarilli", "id": 7799218, "node_id": "MDQ6VXNlcjc3OTkyMTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/7799218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcarilli", "html_url": "https://github.com/mcarilli", "followers_url": "https://api.github.com/users/mcarilli/followers", "following_url": "https://api.github.com/users/mcarilli/following{/other_user}", "gists_url": "https://api.github.com/users/mcarilli/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcarilli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcarilli/subscriptions", "organizations_url": "https://api.github.com/users/mcarilli/orgs", "repos_url": "https://api.github.com/users/mcarilli/repos", "events_url": "https://api.github.com/users/mcarilli/events{/privacy}", "received_events_url": "https://api.github.com/users/mcarilli/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-03T21:54:11Z", "updated_at": "2020-04-03T22:43:44Z", "closed_at": "2020-04-03T22:43:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Native automatic mixed precision support (`torch.cuda.amp`) is finally merged:\r\nhttps://pytorch.org/docs/master/amp.html\r\nhttps://pytorch.org/docs/master/notes/amp_examples.html\r\n\r\nApex Amp has many known pain points (extension builds, forward/backward compatibilty, DataParallel support, flaky checkpointing, i don\u2019t even know if it can be hacked to handle double backward/gradient penalty, others\u2026). `torch.cuda.amp` fixes all these, the interface is more flexible and intuitive, and the tighter integration with pytorch brings more future optimizations into scope.\r\n\r\nI think the `torch.cuda.amp` API is a good fit for a higher-level library like fastai because its style is more functional (as in, it doesn't statefully alter anything outside itself). The necessary `torch.cuda.amp` calls don't have silent/weird effects elsewhere.\r\n\r\nIf you want to talk about adding `torch.cuda.amp` to fastai, with an eye towards it becoming the future-proof source of mixed precision, message me on Pytorch slack anytime. I pinged you there as well but I\u2019m not sure if you monitor it habitually.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2532", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2532/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2532/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2532/events", "html_url": "https://github.com/fastai/fastai/issues/2532", "id": 592382475, "node_id": "MDU6SXNzdWU1OTIzODI0NzU=", "number": 2532, "title": "Please follow the XDG Base Directory Specification", "user": {"login": "bjourne", "id": 142475, "node_id": "MDQ6VXNlcjE0MjQ3NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/142475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjourne", "html_url": "https://github.com/bjourne", "followers_url": "https://api.github.com/users/bjourne/followers", "following_url": "https://api.github.com/users/bjourne/following{/other_user}", "gists_url": "https://api.github.com/users/bjourne/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjourne/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjourne/subscriptions", "organizations_url": "https://api.github.com/users/bjourne/orgs", "repos_url": "https://api.github.com/users/bjourne/repos", "events_url": "https://api.github.com/users/bjourne/events{/privacy}", "received_events_url": "https://api.github.com/users/bjourne/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-02T06:10:13Z", "updated_at": "2020-04-02T11:49:18Z", "closed_at": "2020-04-02T11:49:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "On Linux, the XDG Base Directory Specification should be followed: https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\r\n\r\nIn practice, that means putting user specific files in `~/.local/share/fastai` and `~/.config/fastai` instead of in `~/.fastai`.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2529", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2529/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2529/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2529/events", "html_url": "https://github.com/fastai/fastai/issues/2529", "id": 589758762, "node_id": "MDU6SXNzdWU1ODk3NTg3NjI=", "number": 2529, "title": "Default argument of purge in learn.load", "user": {"login": "rdutta1999", "id": 40257378, "node_id": "MDQ6VXNlcjQwMjU3Mzc4", "avatar_url": "https://avatars0.githubusercontent.com/u/40257378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rdutta1999", "html_url": "https://github.com/rdutta1999", "followers_url": "https://api.github.com/users/rdutta1999/followers", "following_url": "https://api.github.com/users/rdutta1999/following{/other_user}", "gists_url": "https://api.github.com/users/rdutta1999/gists{/gist_id}", "starred_url": "https://api.github.com/users/rdutta1999/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rdutta1999/subscriptions", "organizations_url": "https://api.github.com/users/rdutta1999/orgs", "repos_url": "https://api.github.com/users/rdutta1999/repos", "events_url": "https://api.github.com/users/rdutta1999/events{/privacy}", "received_events_url": "https://api.github.com/users/rdutta1999/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-03-29T10:07:33Z", "updated_at": "2020-03-29T20:42:24Z", "closed_at": "2020-03-29T15:15:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://github.com/fastai/fastai/blob/3b54ef1575f941721c7d5ec4011ebaf51cd06eeb/fastai/basic_train.py#L261\r\n\r\nIt is mentioned in the [docs](https://docs.fast.ai/basic_train.html#Learner.load) that `learn.load()` should call `learn.purge` since the default argument for purge is `True`, but the source code says otherwise.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2527", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2527/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2527/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2527/events", "html_url": "https://github.com/fastai/fastai/issues/2527", "id": 589205796, "node_id": "MDU6SXNzdWU1ODkyMDU3OTY=", "number": 2527, "title": "sklearn.preprocessing does not have Imputer. Thus throws NoModuleError", "user": {"login": "aayushagrawal135", "id": 16146872, "node_id": "MDQ6VXNlcjE2MTQ2ODcy", "avatar_url": "https://avatars2.githubusercontent.com/u/16146872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aayushagrawal135", "html_url": "https://github.com/aayushagrawal135", "followers_url": "https://api.github.com/users/aayushagrawal135/followers", "following_url": "https://api.github.com/users/aayushagrawal135/following{/other_user}", "gists_url": "https://api.github.com/users/aayushagrawal135/gists{/gist_id}", "starred_url": "https://api.github.com/users/aayushagrawal135/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aayushagrawal135/subscriptions", "organizations_url": "https://api.github.com/users/aayushagrawal135/orgs", "repos_url": "https://api.github.com/users/aayushagrawal135/repos", "events_url": "https://api.github.com/users/aayushagrawal135/events{/privacy}", "received_events_url": "https://api.github.com/users/aayushagrawal135/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-27T15:17:34Z", "updated_at": "2020-03-28T13:40:54Z", "closed_at": "2020-03-28T13:40:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The import `from sklearn.preprocessing import Imputer` fails in `fastai/old/fastai/structured.py` since `Imputer` in `sklearn` is moved to `sklearn/impute` ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2526", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2526/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2526/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2526/events", "html_url": "https://github.com/fastai/fastai/issues/2526", "id": 586950399, "node_id": "MDU6SXNzdWU1ODY5NTAzOTk=", "number": 2526, "title": "OptimWrapper does not work with pytorch Optimizers without momentum or betas", "user": {"login": "FangShancheng", "id": 18243865, "node_id": "MDQ6VXNlcjE4MjQzODY1", "avatar_url": "https://avatars2.githubusercontent.com/u/18243865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FangShancheng", "html_url": "https://github.com/FangShancheng", "followers_url": "https://api.github.com/users/FangShancheng/followers", "following_url": "https://api.github.com/users/FangShancheng/following{/other_user}", "gists_url": "https://api.github.com/users/FangShancheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/FangShancheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FangShancheng/subscriptions", "organizations_url": "https://api.github.com/users/FangShancheng/orgs", "repos_url": "https://api.github.com/users/FangShancheng/repos", "events_url": "https://api.github.com/users/FangShancheng/events{/privacy}", "received_events_url": "https://api.github.com/users/FangShancheng/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-24T13:14:13Z", "updated_at": "2020-03-25T13:43:59Z", "closed_at": "2020-03-25T13:43:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\nOptimizers such as Adadelta, Adagrad.. which without the parameters momentum or betas.\r\n\r\n\r\n**Provide your installation details**\r\n\r\n\r\n\r\n```text\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.0.0\r\nnvidia driver : 384.81\r\ntorch cuda    : 9.0.176 / is available\r\ntorch cudnn   : 7401 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 2\r\ntorch devices : 2\r\n  - gpu0      : 11439MB | Tesla K80\r\n  - gpu1      : 11439MB | Tesla K80\r\n\r\n=== Environment === \r\nplatform      : Linux-4.8.0-36-generic-x86_64-with-debian-stretch-sid\r\ndistro        : #36~16.04.1-Ubuntu SMP Sun Feb 5 09:39:57 UTC 2017\r\nconda env     : py36\r\npython        : /home/user/miniconda/envs/py36/bin/python\r\nsys.path      : /app/tmp\r\n/home/user/miniconda/envs/py36/lib/python37.zip\r\n/home/user/miniconda/envs/py36/lib/python3.7\r\n/home/user/miniconda/envs/py36/lib/python3.7/lib-dynload\r\n/home/user/miniconda/envs/py36/lib/python3.7/site-packages\r\n```\r\n\r\n\r\n\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n\r\n-->\r\n\r\n**To Reproduce**\r\n```\r\nfrom fastai.vision import *\r\npath = untar_data(URLs.MNIST_SAMPLE)\r\ndata = ImageDataBunch.from_folder(path)\r\nlearner = cnn_learner(data, models.resnet18, metrics=[accuracy], opt_func=torch.optim.Adadelta). # or Adagrad...\r\nlearner.fit(1,1e-3)\r\n```\r\n\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n```\r\nepoch     train_loss  valid_loss  accuracy  time    \r\nTraceback (most recent call last):-------------------------------------------------------------------------------| 0.00% [0/193 00:00<00:00]\r\n  File \"test.py\", line 7, in <module>\r\n    learner.fit(1,1e-3)\r\n  File \"/home/user/miniconda/envs/py36/lib/python3.7/site-packages/fastai/basic_train.py\", line 200, in fit\r\n    fit(epochs, self, metrics=self.metrics, callbacks=self.callbacks+callbacks)\r\n  File \"/home/user/miniconda/envs/py36/lib/python3.7/site-packages/fastai/basic_train.py\", line 100, in fit\r\n    xb, yb = cb_handler.on_batch_begin(xb, yb)\r\n  File \"/home/user/miniconda/envs/py36/lib/python3.7/site-packages/fastai/callback.py\", line 279, in on_batch_begin\r\n    self('batch_begin', call_mets = not self.state_dict['train'])\r\n  File \"/home/user/miniconda/envs/py36/lib/python3.7/site-packages/fastai/callback.py\", line 251, in __call__\r\n    for cb in self.callbacks: self._call_and_update(cb, cb_name, **kwargs)\r\n  File \"/home/user/miniconda/envs/py36/lib/python3.7/site-packages/fastai/callback.py\", line 241, in _call_and_update\r\n    new = ifnone(getattr(cb, f'on_{cb_name}')(**self.state_dict, **kwargs), dict())\r\n  File \"/home/user/miniconda/envs/py36/lib/python3.7/site-packages/fastai/basic_train.py\", line 482, in on_batch_begin\r\n    self.moms.append(self.opt.mom)\r\n  File \"/home/user/miniconda/envs/py36/lib/python3.7/site-packages/fastai/callback.py\", line 84, in mom\r\n    def mom(self)->float:return self._mom[-1]\r\nTypeError: 'NoneType' object is not subscriptable\r\n```\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2524", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2524/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2524/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2524/events", "html_url": "https://github.com/fastai/fastai/issues/2524", "id": 586637157, "node_id": "MDU6SXNzdWU1ODY2MzcxNTc=", "number": 2524, "title": "GANTrainer doesn't denormalize the image shown at the end of each epoch", "user": {"login": "davidleonfdez", "id": 45669232, "node_id": "MDQ6VXNlcjQ1NjY5MjMy", "avatar_url": "https://avatars0.githubusercontent.com/u/45669232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidleonfdez", "html_url": "https://github.com/davidleonfdez", "followers_url": "https://api.github.com/users/davidleonfdez/followers", "following_url": "https://api.github.com/users/davidleonfdez/following{/other_user}", "gists_url": "https://api.github.com/users/davidleonfdez/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidleonfdez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidleonfdez/subscriptions", "organizations_url": "https://api.github.com/users/davidleonfdez/orgs", "repos_url": "https://api.github.com/users/davidleonfdez/repos", "events_url": "https://api.github.com/users/davidleonfdez/events{/privacy}", "received_events_url": "https://api.github.com/users/davidleonfdez/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-24T02:08:55Z", "updated_at": "2020-03-24T12:38:43Z", "closed_at": "2020-03-24T12:38:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nThe images shown by GANTrainer at the end of each epoch are darker than the images actually generated. \r\n\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n```\r\n=== Software === \r\npython       : 3.6.9\r\nfastai       : 1.0.61.dev0\r\nfastprogress : 0.2.2\r\ntorch        : 1.4.0\r\ntorch cuda   : 10.1 / is **Not available** \r\n\r\n=== Hardware === \r\nNo GPUs available \r\n\r\n=== Environment === \r\nplatform     : Linux-5.3.0-42-generic-x86_64-with-Ubuntu-18.04-bionic\r\ndistro       : #34~18.04.1-Ubuntu SMP Fri Feb 28 13:42:26 UTC 2020\r\nconda env    : Unknown\r\npython       : /home/david/Envs/tmpfastai/bin/python\r\nsys.path     : \r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/home/david/Envs/tmpfastai/lib/python3.6/site-packages\r\n/home/david/Envs/tmpfastai/lib/python3.6/site-packages/IPython/extensions\r\nno supported gpus found on this system\r\n```\r\n\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n1. Train a GANLearner with a **normalized** databunch. For example,\r\n\r\n```\r\nbs, n_channels, img_size = 128, 3, 16\r\npath = untar_data(\"http://vis-www.cs.umass.edu/lfw/lfw\")\r\ndata = (GANItemList.from_folder(path)\r\n               .split_none()\r\n               .label_from_func(noop)\r\n               .transform(tfms=[[crop_pad(size=img_size, row_pct=(0,1), col_pct=(0,1))], []], size=img_size, tfm_y=True)\r\n               .databunch(bs=bs)\r\n               .normalize(stats = [torch.tensor([0.5,0.5,0.5]), torch.tensor([0.5,0.5,0.5])], do_x=False, do_y=True))\r\ncritic = basic_critic(img_size, n_channels, n_extra_layers=1)\r\ngenerator = basic_generator(img_size, n_channels, n_extra_layers=1)\r\nlearner = GANLearner.wgan(data, generator, critic, switch_eval=False, \r\n                          opt_func = partial(optim.Adam, betas = (0.,0.99)), wd=0.)\r\nlearner.fit(1, 5e-4)\r\n```\r\n\r\n2. Show results:\r\n\r\n`learner.show_results(ds_type=DatasetType.Train)`\r\n\r\nThe images shown now seem brighter that the one(s) shown during training, at the end of each epoch. It's doesn't seem a casual difference between specific images, the images shown during training are always darker.\r\n\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n#\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\nThe images shown during training should have similar brightness to those ouput by `learner.show_results()`.\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\nI think any RGB value between 0 and 127 (or -1. and 0. for tensors) is being displayed as 0.\r\nIf I'm not wrong the reason is the **image isn't properly denormalized** in `GANTrainer.on_epoch_end`, so when the weights are clamped (from [-1, 1] to [0, 1]) by calling `data.train_ds.y.reconstruct()` (which is `ImageList.reconstruct()`), the darker values are lost and mapped to just black (0) for its channel.\r\n\r\nI guess `do_x=True` needs to be enforced only for this particular call to `data.denorm` as in the case of GAN data the input images aren't stored as `x`, which is the input noise, but `y`.\r\n\r\nI've made a (dirty) gist too: https://gist.github.com/davidleonfdez/8ff8e2ecc746c085f173debb2e114f85\r\n\r\nI've submitted a PR. (#2525)\r\n\r\nThanks in advance.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2523", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2523/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2523/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2523/events", "html_url": "https://github.com/fastai/fastai/issues/2523", "id": 586314865, "node_id": "MDU6SXNzdWU1ODYzMTQ4NjU=", "number": 2523, "title": "states=pd.get_dummies(X['Geography'], drop_first=True) gender=pd.get_dummies(X['Gender'], drop_first=True)", "user": {"login": "ritikaraaj", "id": 48616808, "node_id": "MDQ6VXNlcjQ4NjE2ODA4", "avatar_url": "https://avatars3.githubusercontent.com/u/48616808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ritikaraaj", "html_url": "https://github.com/ritikaraaj", "followers_url": "https://api.github.com/users/ritikaraaj/followers", "following_url": "https://api.github.com/users/ritikaraaj/following{/other_user}", "gists_url": "https://api.github.com/users/ritikaraaj/gists{/gist_id}", "starred_url": "https://api.github.com/users/ritikaraaj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ritikaraaj/subscriptions", "organizations_url": "https://api.github.com/users/ritikaraaj/orgs", "repos_url": "https://api.github.com/users/ritikaraaj/repos", "events_url": "https://api.github.com/users/ritikaraaj/events{/privacy}", "received_events_url": "https://api.github.com/users/ritikaraaj/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-23T15:53:29Z", "updated_at": "2020-03-24T12:36:28Z", "closed_at": "2020-03-24T12:36:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2522", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2522/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2522/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2522/events", "html_url": "https://github.com/fastai/fastai/issues/2522", "id": 581972720, "node_id": "MDU6SXNzdWU1ODE5NzI3MjA=", "number": 2522, "title": "Cannot display images with data containing 0 or 1 in the jupyter notebook after resize", "user": {"login": "wptoux", "id": 6761483, "node_id": "MDQ6VXNlcjY3NjE0ODM=", "avatar_url": "https://avatars3.githubusercontent.com/u/6761483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wptoux", "html_url": "https://github.com/wptoux", "followers_url": "https://api.github.com/users/wptoux/followers", "following_url": "https://api.github.com/users/wptoux/following{/other_user}", "gists_url": "https://api.github.com/users/wptoux/gists{/gist_id}", "starred_url": "https://api.github.com/users/wptoux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wptoux/subscriptions", "organizations_url": "https://api.github.com/users/wptoux/orgs", "repos_url": "https://api.github.com/users/wptoux/repos", "events_url": "https://api.github.com/users/wptoux/events{/privacy}", "received_events_url": "https://api.github.com/users/wptoux/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-16T03:27:37Z", "updated_at": "2020-03-16T08:57:26Z", "closed_at": "2020-03-16T08:57:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nCannot display pictures with data containing 0 or 1 in the notebook after resize\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython        : 3.6.9\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0a0+a5b4d78\r\nnvidia driver : 410.72\r\ntorch cuda    : 10.2 / is available\r\ntorch cudnn   : 7605 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 8\r\ntorch devices : 2\r\n  - gpu0      : 16280MB | Tesla P100-PCIE-16GB\r\n  - gpu1      : 16280MB | Tesla P100-PCIE-16GB\r\n\r\n=== Environment === \r\nplatform      : Linux-3.10.0-862.el7.x86_64-x86_64-with-debian-buster-sid\r\ndistro        : #1 SMP Fri Apr 20 16:44:24 UTC 2018\r\nconda env     : Unknown\r\npython        : /opt/conda/bin/python\r\nsys.path      : /opt/conda/lib/python36.zip\r\n/opt/conda/lib/python3.6\r\n/opt/conda/lib/python3.6/lib-dynload\r\n\r\n/opt/conda/lib/python3.6/site-packages\r\n/opt/conda/lib/python3.6/site-packages/IPython/extensions\r\n/root/.ipython\r\n```\r\n\r\n**To Reproduce**\r\n```\r\nimg = open_img(img_file)\r\nimg\r\n#  everything ok\r\n\r\nimg.resize(256)\r\nimg\r\n# error stackTrace:\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n/opt/conda/lib/python3.6/site-packages/IPython/core/formatters.py in __call__(self, obj)\r\n    343             method = get_real_method(obj, self.print_method)\r\n    344             if method is not None:\r\n--> 345                 return method()\r\n    346             return None\r\n    347         else:\r\n\r\n/opt/conda/lib/python3.6/site-packages/fastai/vision/image.py in _repr_png_(self)\r\n     86 \r\n     87     def __repr__(self): return f'{self.__class__.__name__} {tuple(self.shape)}'\r\n---> 88     def _repr_png_(self): return self._repr_image_format('png')\r\n     89     def _repr_jpeg_(self): return self._repr_image_format('jpeg')\r\n     90 \r\n\r\n/opt/conda/lib/python3.6/site-packages/fastai/vision/image.py in _repr_image_format(self, format_str)\r\n     91     def _repr_image_format(self, format_str):\r\n     92         with BytesIO() as str_buffer:\r\n---> 93             plt.imsave(str_buffer, image2np(self.px), format=format_str)\r\n     94             return str_buffer.getvalue()\r\n     95 \r\n\r\n/opt/conda/lib/python3.6/site-packages/matplotlib/pyplot.py in imsave(fname, arr, **kwargs)\r\n   2131 @docstring.copy(matplotlib.image.imsave)\r\n   2132 def imsave(fname, arr, **kwargs):\r\n-> 2133     return matplotlib.image.imsave(fname, arr, **kwargs)\r\n   2134 \r\n   2135 \r\n\r\n/opt/conda/lib/python3.6/site-packages/matplotlib/image.py in imsave(fname, arr, vmin, vmax, cmap, format, origin, dpi)\r\n   1494         if origin == \"lower\":\r\n   1495             arr = arr[::-1]\r\n-> 1496         rgba = sm.to_rgba(arr, bytes=True)\r\n   1497         if format == \"png\":\r\n   1498             _png.write_png(rgba, fname, dpi=dpi)\r\n\r\n/opt/conda/lib/python3.6/site-packages/matplotlib/cm.py in to_rgba(self, x, alpha, bytes, norm)\r\n    269                 if xx.dtype.kind == 'f':\r\n    270                     if norm and (xx.max() > 1 or xx.min() < 0):\r\n--> 271                         raise ValueError(\"Floating point image RGB values \"\r\n    272                                          \"must be in the 0..1 range.\")\r\n    273                     if bytes:\r\n\r\nValueError: Floating point image RGB values must be in the 0..1 range.\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n/opt/conda/lib/python3.6/site-packages/IPython/core/formatters.py in __call__(self, obj)\r\n    343             method = get_real_method(obj, self.print_method)\r\n    344             if method is not None:\r\n--> 345                 return method()\r\n    346             return None\r\n    347         else:\r\n\r\n/opt/conda/lib/python3.6/site-packages/fastai/vision/image.py in _repr_jpeg_(self)\r\n     87     def __repr__(self): return f'{self.__class__.__name__} {tuple(self.shape)}'\r\n     88     def _repr_png_(self): return self._repr_image_format('png')\r\n---> 89     def _repr_jpeg_(self): return self._repr_image_format('jpeg')\r\n     90 \r\n     91     def _repr_image_format(self, format_str):\r\n\r\n/opt/conda/lib/python3.6/site-packages/fastai/vision/image.py in _repr_image_format(self, format_str)\r\n     91     def _repr_image_format(self, format_str):\r\n     92         with BytesIO() as str_buffer:\r\n---> 93             plt.imsave(str_buffer, image2np(self.px), format=format_str)\r\n     94             return str_buffer.getvalue()\r\n     95 \r\n\r\n/opt/conda/lib/python3.6/site-packages/matplotlib/pyplot.py in imsave(fname, arr, **kwargs)\r\n   2131 @docstring.copy(matplotlib.image.imsave)\r\n   2132 def imsave(fname, arr, **kwargs):\r\n-> 2133     return matplotlib.image.imsave(fname, arr, **kwargs)\r\n   2134 \r\n   2135 \r\n\r\n/opt/conda/lib/python3.6/site-packages/matplotlib/image.py in imsave(fname, arr, vmin, vmax, cmap, format, origin, dpi)\r\n   1494         if origin == \"lower\":\r\n   1495             arr = arr[::-1]\r\n-> 1496         rgba = sm.to_rgba(arr, bytes=True)\r\n   1497         if format == \"png\":\r\n   1498             _png.write_png(rgba, fname, dpi=dpi)\r\n\r\n/opt/conda/lib/python3.6/site-packages/matplotlib/cm.py in to_rgba(self, x, alpha, bytes, norm)\r\n    269                 if xx.dtype.kind == 'f':\r\n    270                     if norm and (xx.max() > 1 or xx.min() < 0):\r\n--> 271                         raise ValueError(\"Floating point image RGB values \"\r\n    272                                          \"must be in the 0..1 range.\")\r\n    273                     if bytes:\r\n\r\nValueError: Floating point image RGB values must be in the 0..1 range.\r\n\r\n%debug\r\nipdb> xx.max()\r\n1.0000001\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2520", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2520/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2520/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2520/events", "html_url": "https://github.com/fastai/fastai/issues/2520", "id": 580799220, "node_id": "MDU6SXNzdWU1ODA3OTkyMjA=", "number": 2520, "title": "Fastai v0.7 lesson1-rf graphviz executable not found", "user": {"login": "aminvakil", "id": 12948692, "node_id": "MDQ6VXNlcjEyOTQ4Njky", "avatar_url": "https://avatars3.githubusercontent.com/u/12948692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aminvakil", "html_url": "https://github.com/aminvakil", "followers_url": "https://api.github.com/users/aminvakil/followers", "following_url": "https://api.github.com/users/aminvakil/following{/other_user}", "gists_url": "https://api.github.com/users/aminvakil/gists{/gist_id}", "starred_url": "https://api.github.com/users/aminvakil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aminvakil/subscriptions", "organizations_url": "https://api.github.com/users/aminvakil/orgs", "repos_url": "https://api.github.com/users/aminvakil/repos", "events_url": "https://api.github.com/users/aminvakil/events{/privacy}", "received_events_url": "https://api.github.com/users/aminvakil/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-13T19:32:22Z", "updated_at": "2020-03-14T14:51:19Z", "closed_at": "2020-03-14T14:51:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I've installed fastai from this link:\r\nhttps://forums.fast.ai/t/fastai-v0-7-install-issues-thread/24652\r\n\r\n```\r\nconda update conda\r\ngit clone https://github.com/fastai/fastai.git\r\ncd fastai\r\nconda env create -f environment.yml\r\nconda activate fastai\r\njupyter notebook\r\n```\r\nThen I went to lesson1-rf notebook and execute until this line:\r\n`draw_tree(m.estimators_[0], df_trn, precision=3)`\r\nwhich gives me this error:\r\n```\r\n---------------------------------------------------------------------------\r\nFileNotFoundError                         Traceback (most recent call last)\r\n~/.conda/envs/fastai/lib/python3.6/site-packages/graphviz/backend.py in run(cmd, input, capture_output, check, quiet, **kwargs)\r\n    158     try:\r\n--> 159         proc = subprocess.Popen(cmd, startupinfo=get_startupinfo(), **kwargs)\r\n    160     except OSError as e:\r\n\r\n~/.conda/envs/fastai/lib/python3.6/subprocess.py in __init__(self, args, bufsize, executable, stdin, stdout, stderr, preexec_fn, close_fds, shell, cwd, env, universal_newlines, startupinfo, creationflags, restore_signals, start_new_session, pass_fds, encoding, errors)\r\n    728                                 errread, errwrite,\r\n--> 729                                 restore_signals, start_new_session)\r\n    730         except:\r\n\r\n~/.conda/envs/fastai/lib/python3.6/subprocess.py in _execute_child(self, args, executable, preexec_fn, close_fds, pass_fds, cwd, env, startupinfo, creationflags, shell, p2cread, p2cwrite, c2pread, c2pwrite, errread, errwrite, restore_signals, start_new_session)\r\n   1363                             err_msg += ': ' + repr(err_filename)\r\n-> 1364                     raise child_exception_type(errno_num, err_msg, err_filename)\r\n   1365                 raise child_exception_type(err_msg)\r\n\r\nFileNotFoundError: [Errno 2] No such file or directory: 'dot': 'dot'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nExecutableNotFound                        Traceback (most recent call last)\r\n~/.conda/envs/fastai/lib/python3.6/site-packages/IPython/core/formatters.py in __call__(self, obj)\r\n    343             method = get_real_method(obj, self.print_method)\r\n    344             if method is not None:\r\n--> 345                 return method()\r\n    346             return None\r\n    347         else:\r\n\r\n~/.conda/envs/fastai/lib/python3.6/site-packages/graphviz/files.py in _repr_svg_(self)\r\n    111 \r\n    112     def _repr_svg_(self):\r\n--> 113         return self.pipe(format='svg').decode(self._encoding)\r\n    114 \r\n    115     def pipe(self, format=None, renderer=None, formatter=None, quiet=False):\r\n\r\n~/.conda/envs/fastai/lib/python3.6/site-packages/graphviz/files.py in pipe(self, format, renderer, formatter, quiet)\r\n    136         out = backend.pipe(self._engine, format, data,\r\n    137                            renderer=renderer, formatter=formatter,\r\n--> 138                            quiet=quiet)\r\n    139 \r\n    140         return out\r\n\r\n~/.conda/envs/fastai/lib/python3.6/site-packages/graphviz/backend.py in pipe(engine, format, data, renderer, formatter, quiet)\r\n    227     \"\"\"\r\n    228     cmd, _ = command(engine, format, None, renderer, formatter)\r\n--> 229     out, _ = run(cmd, input=data, capture_output=True, check=True, quiet=quiet)\r\n    230     return out\r\n    231 \r\n\r\n~/.conda/envs/fastai/lib/python3.6/site-packages/graphviz/backend.py in run(cmd, input, capture_output, check, quiet, **kwargs)\r\n    160     except OSError as e:\r\n    161         if e.errno == errno.ENOENT:\r\n--> 162             raise ExecutableNotFound(cmd)\r\n    163         else:\r\n    164             raise\r\n\r\nExecutableNotFound: failed to execute ['dot', '-Tsvg'], make sure the Graphviz executables are on your systems' PATH\r\n\r\n<graphviz.files.Source at 0x65c7edb01e48>\r\n```\r\nIt's because graphviz is installed only using pip in environment.yml.\r\nIf I execute `conda install graphviz` after activating fastai environment, it is OK and I can use draw_tree function without a problem.\r\n\r\nThe reason I'm opening an issue is if I've tested and if I remove fastai environment completely using `conda env remove -y -n fastai` and installing it again with graphviz in environment.yml it works fine, therefore I'm opening a pull request too, adding graphviz on both environment.yml and environment-cpu.yml, if it doesn't break existing installations you can accept it otherwise future people who face this error can use this issue.\r\n\r\nThanks for your project!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2519", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2519/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2519/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2519/events", "html_url": "https://github.com/fastai/fastai/issues/2519", "id": 580388687, "node_id": "MDU6SXNzdWU1ODAzODg2ODc=", "number": 2519, "title": "FastaiV1\uff1aLesson1-pets\uff1alearn.fit_one_cycle(4)", "user": {"login": "xiaosuzhang", "id": 34598992, "node_id": "MDQ6VXNlcjM0NTk4OTky", "avatar_url": "https://avatars3.githubusercontent.com/u/34598992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiaosuzhang", "html_url": "https://github.com/xiaosuzhang", "followers_url": "https://api.github.com/users/xiaosuzhang/followers", "following_url": "https://api.github.com/users/xiaosuzhang/following{/other_user}", "gists_url": "https://api.github.com/users/xiaosuzhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiaosuzhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiaosuzhang/subscriptions", "organizations_url": "https://api.github.com/users/xiaosuzhang/orgs", "repos_url": "https://api.github.com/users/xiaosuzhang/repos", "events_url": "https://api.github.com/users/xiaosuzhang/events{/privacy}", "received_events_url": "https://api.github.com/users/xiaosuzhang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-13T05:57:16Z", "updated_at": "2020-03-13T13:16:17Z", "closed_at": "2020-03-13T13:16:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nWhen i run :learn.fit_one_cycle(4)\r\nthe erros occus:\r\nBrokenPipeError                           Traceback (most recent call last)\r\n<ipython-input-14-495233eaf2b4> in <module>\r\n----> 1 learn.fit_one_cycle(4)\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\fastai\\train.py in fit_one_cycle(learn, cyc_len, max_lr, moms, div_factor, pct_start, final_div, wd, callbacks, tot_epochs, start_epoch)\r\n     21     callbacks.append(OneCycleScheduler(learn, max_lr, moms=moms, div_factor=div_factor, pct_start=pct_start,\r\n     22                                        final_div=final_div, tot_epochs=tot_epochs, start_epoch=start_epoch))\r\n---> 23     learn.fit(cyc_len, max_lr, wd=wd, callbacks=callbacks)\r\n     24 \r\n     25 def fit_fc(learn:Learner, tot_epochs:int=1, lr:float=defaults.lr,  moms:Tuple[float,float]=(0.95,0.85), start_pct:float=0.72,\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\fastai\\basic_train.py in fit(self, epochs, lr, wd, callbacks)\r\n    198         else: self.opt.lr,self.opt.wd = lr,wd\r\n    199         callbacks = [cb(self) for cb in self.callback_fns + listify(defaults.extra_callback_fns)] + listify(callbacks)\r\n--> 200         fit(epochs, self, metrics=self.metrics, callbacks=self.callbacks+callbacks)\r\n    201 \r\n    202     def create_opt(self, lr:Floats, wd:Floats=0.)->None:\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\fastai\\basic_train.py in fit(epochs, learn, callbacks, metrics)\r\n     97             cb_handler.set_dl(learn.data.train_dl)\r\n     98             cb_handler.on_epoch_begin()\r\n---> 99             for xb,yb in progress_bar(learn.data.train_dl, parent=pbar):\r\n    100                 xb, yb = cb_handler.on_batch_begin(xb, yb)\r\n    101                 loss = loss_batch(learn.model, xb, yb, learn.loss_func, learn.opt, cb_handler)\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\fastprogress\\fastprogress.py in __iter__(self)\r\n     45         except Exception as e:\r\n     46             self.on_interrupt()\r\n---> 47             raise e\r\n     48 \r\n     49     def update(self, val):\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\fastprogress\\fastprogress.py in __iter__(self)\r\n     39         if self.total != 0: self.update(0)\r\n     40         try:\r\n---> 41             for i,o in enumerate(self.gen):\r\n     42                 if i >= self.total: break\r\n     43                 yield o\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\fastai\\basic_data.py in __iter__(self)\r\n     73     def __iter__(self):\r\n     74         \"Process and returns items from `DataLoader`.\"\r\n---> 75         for b in self.dl: yield self.proc_batch(b)\r\n     76 \r\n     77     @classmethod\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\torch\\utils\\data\\dataloader.py in __iter__(self)\r\n    277             return _SingleProcessDataLoaderIter(self)\r\n    278         else:\r\n--> 279             return _MultiProcessingDataLoaderIter(self)\r\n    280 \r\n    281     @property\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\torch\\utils\\data\\dataloader.py in __init__(self, loader)\r\n    717             #     before it starts, and __del__ tries to join but will get:\r\n    718             #     AssertionError: can only join a started process.\r\n--> 719             w.start()\r\n    720             self._index_queues.append(index_queue)\r\n    721             self._workers.append(w)\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\multiprocessing\\process.py in start(self)\r\n    103                'daemonic processes are not allowed to have children'\r\n    104         _cleanup()\r\n--> 105         self._popen = self._Popen(self)\r\n    106         self._sentinel = self._popen.sentinel\r\n    107         # Avoid a refcycle if the target function holds an indirect\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\multiprocessing\\context.py in _Popen(process_obj)\r\n    221     @staticmethod\r\n    222     def _Popen(process_obj):\r\n--> 223         return _default_context.get_context().Process._Popen(process_obj)\r\n    224 \r\n    225 class DefaultContext(BaseContext):\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\multiprocessing\\context.py in _Popen(process_obj)\r\n    320         def _Popen(process_obj):\r\n    321             from .popen_spawn_win32 import Popen\r\n--> 322             return Popen(process_obj)\r\n    323 \r\n    324     class SpawnContext(BaseContext):\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\multiprocessing\\popen_spawn_win32.py in __init__(self, process_obj)\r\n     63             try:\r\n     64                 reduction.dump(prep_data, to_child)\r\n---> 65                 reduction.dump(process_obj, to_child)\r\n     66             finally:\r\n     67                 set_spawning_popen(None)\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\multiprocessing\\reduction.py in dump(obj, file, protocol)\r\n     58 def dump(obj, file, protocol=None):\r\n     59     '''Replacement for pickle.dump() using ForkingPickler.'''\r\n---> 60     ForkingPickler(file, protocol).dump(obj)\r\n     61 \r\n     62 #\r\n\r\nBrokenPipeError: [Errno 32] Broken pipe\r\n\r\n\r\n**Provide your installation details**\r\n\r\n=== Software === \r\npython        : 3.6.10\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7501 / is enabled\r\n\r\n=== Hardware === \r\ntorch devices : 1\r\n  - gpu0      : GeForce GTX 1060 with Max-Q Design\r\n\r\n=== Environment === \r\nplatform      : Windows-10-10.0.18362-SP0\r\nconda env     : fastai\r\npython        : E:\\Anaconda\\envs\\fastai\\python.exe\r\nsys.path      : E:\\Anaconda\\envs\\fastai\\python36.zip\r\nE:\\Anaconda\\envs\\fastai\\DLLs\r\nE:\\Anaconda\\envs\\fastai\\lib\r\nE:\\Anaconda\\envs\\fastai\r\n\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\win32\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\win32\\lib\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\Pythonwin\r\nE:\\Anaconda\\envs\\fastai\\lib\\site-packages\\IPython\\extensions\r\nC:\\Users\\jwxxz\\.ipython\r\nno nvidia-smi is found\r\n\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2518", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2518/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2518/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2518/events", "html_url": "https://github.com/fastai/fastai/issues/2518", "id": 579904613, "node_id": "MDU6SXNzdWU1Nzk5MDQ2MTM=", "number": 2518, "title": "Cmap cannot be changed for segmentation masks using show_batch/show_result", "user": {"login": "Samcro5C", "id": 18573641, "node_id": "MDQ6VXNlcjE4NTczNjQx", "avatar_url": "https://avatars0.githubusercontent.com/u/18573641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Samcro5C", "html_url": "https://github.com/Samcro5C", "followers_url": "https://api.github.com/users/Samcro5C/followers", "following_url": "https://api.github.com/users/Samcro5C/following{/other_user}", "gists_url": "https://api.github.com/users/Samcro5C/gists{/gist_id}", "starred_url": "https://api.github.com/users/Samcro5C/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Samcro5C/subscriptions", "organizations_url": "https://api.github.com/users/Samcro5C/orgs", "repos_url": "https://api.github.com/users/Samcro5C/repos", "events_url": "https://api.github.com/users/Samcro5C/events{/privacy}", "received_events_url": "https://api.github.com/users/Samcro5C/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-12T12:28:00Z", "updated_at": "2020-03-12T14:05:05Z", "closed_at": "2020-03-12T14:05:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nWhen creating a custom colormap which should be applied to the segmentation mask using *data.show_batch()* , or *learn.show_result()*, the default colormap 'tab20' is used instead.\r\nFor example, if there are three labels and you want to have each label showing the same color over all samples, independet of the amount of labels in a single sample, you could create a custom Matplotlib colormap and a normalization to ensure the same color for a specific value over all samples.\r\n```\r\nfrom Matplotlib import colors\r\ncustom_cmap = colors.ListedColormap([\"red\", \"green\", \"blue\"])\r\ncustom_norm = colors.Normalize(vmin=0, vmax=2)\r\ndata.show_batch(2, figsize=(10,10), cmap=custom_map, norm=custom_norm)\r\n```\r\nHowever, when passing two extra arguments *cmap* and *norm* to *data.show_batch()*, only the latter is passed to the actual matplotlib *imshow()* function. So now the color stays the same for a specific label over all samples, but unfortunately it is not the intended color.\r\nIt seems that when *show_xyzy()* and later *x.show()* (with x being an ImageSegment object) is called, the *cmap* argument previously defined and part of *\\*\\*kwargs* is neglected, as the ImageSegment.show() method has its own *cmap* argument which defaults to 'tab20'.\r\nMaybe it would be better to check if *cmap* is already defined within *\\*\\*kwargs* and if not set it to 'tab20'?\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 440.59\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 7982MB | GeForce RTX 2080 SUPER\r\n\r\n=== Environment === \r\nplatform      : Linux-5.3.0-40-generic-x86_64-with-debian-buster-sid\r\ndistro        : #32~18.04.1-Ubuntu SMP Mon Feb 3 14:05:59 UTC 2020\r\nconda env     : pytorch_env\r\npython        : /home/cloudator/anaconda3/envs/pytorch_env/bin/python\r\nsys.path      : /home/cloudator/git/sfmt_meteo_nowcasting/CloudCamPrograms/Source/CloudSegmentation/DeepNet/visualization\r\n/home/cloudator/git/sfmt_meteo_nowcasting/CloudCamPrograms/Source/CloudSegmentation/DeepNet/models\r\n/home/cloudator/git/sfmt_meteo_nowcasting/CloudCamPrograms/Source/CloudSegmentation/DeepNet/data\r\n/home/cloudator/git/sfmt_meteo_nowcasting/CloudCamPrograms/Source/CloudSegmentation/DeepNet/notebooks\r\n/home/cloudator/anaconda3/envs/pytorch_env/lib/python37.zip\r\n/home/cloudator/anaconda3/envs/pytorch_env/lib/python3.7\r\n/home/cloudator/anaconda3/envs/pytorch_env/lib/python3.7/lib-dynload\r\n\r\n/home/cloudator/anaconda3/envs/pytorch_env/lib/python3.7/site-packages\r\n/home/cloudator/anaconda3/envs/pytorch_env/lib/python3.7/site-packages/IPython/extensions\r\n/home/cloudator/.ipython\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2515", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2515/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2515/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2515/events", "html_url": "https://github.com/fastai/fastai/issues/2515", "id": 577946075, "node_id": "MDU6SXNzdWU1Nzc5NDYwNzU=", "number": 2515, "title": "importerror cannot import name 'imputer' fastai", "user": {"login": "physedo", "id": 12207002, "node_id": "MDQ6VXNlcjEyMjA3MDAy", "avatar_url": "https://avatars2.githubusercontent.com/u/12207002?v=4", "gravatar_id": "", "url": "https://api.github.com/users/physedo", "html_url": "https://github.com/physedo", "followers_url": "https://api.github.com/users/physedo/followers", "following_url": "https://api.github.com/users/physedo/following{/other_user}", "gists_url": "https://api.github.com/users/physedo/gists{/gist_id}", "starred_url": "https://api.github.com/users/physedo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/physedo/subscriptions", "organizations_url": "https://api.github.com/users/physedo/orgs", "repos_url": "https://api.github.com/users/physedo/repos", "events_url": "https://api.github.com/users/physedo/events{/privacy}", "received_events_url": "https://api.github.com/users/physedo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-03-09T14:23:29Z", "updated_at": "2020-03-09T14:28:06Z", "closed_at": "2020-03-09T14:28:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "importerror cannot import name 'imputer' fastai\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2514", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2514/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2514/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2514/events", "html_url": "https://github.com/fastai/fastai/issues/2514", "id": 577539746, "node_id": "MDU6SXNzdWU1Nzc1Mzk3NDY=", "number": 2514, "title": "Lesson 2 sgd gets \"can't call numpy\" error when drawing plot", "user": {"login": "tchaffee", "id": 148813, "node_id": "MDQ6VXNlcjE0ODgxMw==", "avatar_url": "https://avatars2.githubusercontent.com/u/148813?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tchaffee", "html_url": "https://github.com/tchaffee", "followers_url": "https://api.github.com/users/tchaffee/followers", "following_url": "https://api.github.com/users/tchaffee/following{/other_user}", "gists_url": "https://api.github.com/users/tchaffee/gists{/gist_id}", "starred_url": "https://api.github.com/users/tchaffee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tchaffee/subscriptions", "organizations_url": "https://api.github.com/users/tchaffee/orgs", "repos_url": "https://api.github.com/users/tchaffee/repos", "events_url": "https://api.github.com/users/tchaffee/events{/privacy}", "received_events_url": "https://api.github.com/users/tchaffee/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-03-08T18:01:48Z", "updated_at": "2020-04-14T00:30:51Z", "closed_at": "2020-03-09T00:57:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\nlesson2-sgd notebook gets an error for the following cell:\r\n\r\n```\r\nplt.scatter(x[:,0],y)\r\nplt.scatter(x[:,0],x@a);\r\n```\r\n\r\nThe last line of the long traceback says:\r\n\r\n```\r\nRuntimeError: Can't call numpy() on Variable that requires grad. Use var.detach().numpy() instead.\r\n```\r\n\r\nThe same error happens for the animation cell.\r\n\r\nI can submit a PR to fix this, but I cannot find the lesson2-sgd notebook in this repo.\r\n\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n\r\n```text\r\n=== Software ===\r\npython        : 3.6.7\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 418.67\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware ===\r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 8126MB | Quadro M4000\r\n\r\n=== Environment ===\r\nplatform      : Linux-4.15.0-72-generic-x86_64-with-debian-stretch-sid\r\ndistro        : #81~16.04.1-Ubuntu SMP Tue Nov 26 16:34:21 UTC 2019\r\nconda env     : fastai\r\npython        : /opt/conda/envs/fastai/bin/python\r\nsys.path      :\r\n/opt/conda/envs/fastai/lib/python36.zip\r\n/opt/conda/envs/fastai/lib/python3.6\r\n/opt/conda/envs/fastai/lib/python3.6/lib-dynload\r\n/opt/conda/envs/fastai/lib/python3.6/site-packages\r\n/opt/conda/envs/fastai/lib/python3.6/site-packages/IPython/extensions\r\n```\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\nJust run that cell.\r\n\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\nThe plot will be drawn instead of getting an error.\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2512", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2512/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2512/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2512/events", "html_url": "https://github.com/fastai/fastai/issues/2512", "id": 576794088, "node_id": "MDU6SXNzdWU1NzY3OTQwODg=", "number": 2512, "title": "repeat epoch", "user": {"login": "Ontheroad123", "id": 31181026, "node_id": "MDQ6VXNlcjMxMTgxMDI2", "avatar_url": "https://avatars3.githubusercontent.com/u/31181026?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ontheroad123", "html_url": "https://github.com/Ontheroad123", "followers_url": "https://api.github.com/users/Ontheroad123/followers", "following_url": "https://api.github.com/users/Ontheroad123/following{/other_user}", "gists_url": "https://api.github.com/users/Ontheroad123/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ontheroad123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ontheroad123/subscriptions", "organizations_url": "https://api.github.com/users/Ontheroad123/orgs", "repos_url": "https://api.github.com/users/Ontheroad123/repos", "events_url": "https://api.github.com/users/Ontheroad123/events{/privacy}", "received_events_url": "https://api.github.com/users/Ontheroad123/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-06T09:10:24Z", "updated_at": "2020-03-07T20:22:08Z", "closed_at": "2020-03-07T20:22:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "there are my code\uff1a\r\nlearn = cnn_learner(data,models.resnet101,metrics=error_rate, wd= wd)\r\nplt.switch_backend('Agg')\r\n\r\ndef newtrain():\r\n        lr = 1e-1\r\n        learn.fit_one_cycle(10, slice(lr), pct_start=0.8, callbacks=[SaveModelCallback(learn, every='epoch', name = 'stage1')])\r\n        learn.recorder.plot_lr()\r\n        learn.save('stage-1')\r\n        lr_find(learn)\r\n        plt.savefig(\"liver_stage1.png\")\r\nnewtrain()\r\nbut i find it run repeat:\r\nepoch     train_loss  valid_loss  error_rate  time    \r\nepoch     train_loss  valid_loss  error_rate  time    <00:00]\r\n0         0.801805    0.629043    0.199278    03:57                     \r\n0         0.828107    0.611591    0.199278    03:57              \r\n1         0.645031    0.502624    0.179503    03:51                     \r\n1         0.621404    0.509897    0.179503    03:51              \r\n2         0.562800    0.447399    0.160953    03:52                     \r\n2         0.562270    0.445950    0.160953    03:52              \r\n3         0.496844    0.421863    0.151341    03:52                     \r\n3         0.515444    0.422395    0.151341    03:53 \r\ni have test the code, the problem in this code:\r\nlearn.fit_one_cycle(10, slice(lr), pct_start=0.8, callbacks=[SaveModelCallback(learn, every='epoch', name = 'stage1')]),but i don't how to solve it", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2511", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2511/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2511/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2511/events", "html_url": "https://github.com/fastai/fastai/issues/2511", "id": 576121537, "node_id": "MDU6SXNzdWU1NzYxMjE1Mzc=", "number": 2511, "title": "Error(s) in loading state_dict for AWD_LSTM", "user": {"login": "tsoernes", "id": 6782404, "node_id": "MDQ6VXNlcjY3ODI0MDQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/6782404?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tsoernes", "html_url": "https://github.com/tsoernes", "followers_url": "https://api.github.com/users/tsoernes/followers", "following_url": "https://api.github.com/users/tsoernes/following{/other_user}", "gists_url": "https://api.github.com/users/tsoernes/gists{/gist_id}", "starred_url": "https://api.github.com/users/tsoernes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tsoernes/subscriptions", "organizations_url": "https://api.github.com/users/tsoernes/orgs", "repos_url": "https://api.github.com/users/tsoernes/repos", "events_url": "https://api.github.com/users/tsoernes/events{/privacy}", "received_events_url": "https://api.github.com/users/tsoernes/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-05T09:46:04Z", "updated_at": "2020-03-05T15:11:56Z", "closed_at": "2020-03-05T14:40:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython        : 3.7.4\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 418.40\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 11441MB | Tesla K80\r\n\r\n=== Environment === \r\nplatform      : Linux-4.4.0-1102-aws-x86_64-with-debian-stretch-sid\r\ndistro        : #113-Ubuntu SMP Wed Jan 29 14:54:54 UTC 2020\r\nconda env     : nlp\r\npython        : /home/ubuntu/anaconda3/envs/nlp/bin/python\r\nsys.path      : /home/ubuntu/code/fintechdb/CatML/catml\r\n/home/ubuntu/src/cntk/bindings/python\r\n/home/ubuntu/anaconda3/envs/nlp/lib/python37.zip\r\n/home/ubuntu/anaconda3/envs/nlp/lib/python3.7\r\n/home/ubuntu/anaconda3/envs/nlp/lib/python3.7/lib-dynload\r\n/home/ubuntu/.local/lib/python3.7/site-packages\r\n/home/ubuntu/anaconda3/envs/nlp/lib/python3.7/site-packages\r\n/home/ubuntu/code/fintechdb/Ftools\r\n/home/ubuntu/code/fintechdb/RSSPull\r\n/home/ubuntu/code/fintechdb/CatML\r\n/home/ubuntu/code/fintechdb/Sheets\r\n/home/ubuntu/anaconda3/envs/nlp/lib/python3.7/site-packages/IPython/extensions\r\n```\r\n\r\n\r\n**To Reproduce**\r\n```\r\n(Pdb) model_name\r\n'awd_lstm_fwd_enc_SVNA'\r\n(Pdb) learn.load_encoder(model_name)\r\n*** RuntimeError: Error(s) in loading state_dict for AWD_LSTM:\r\n\tMissing key(s) in state_dict: \"encoder.weight\", \"encoder_dp.emb.weight\", \"rnns.0.weight_hh_l0_raw\", \"rnns.0.module.weight_ih_l0\", \"rnns.0.module.weight_hh_l0\", \"rnns.0.module.bias_ih_l0\", \"rnns.0.module.bias_hh_l0\", \"rnns.1.weight_hh_l0_raw\", \"rnns.1.module.weight_ih_l0\", \"rnns.1.module.weight_hh_l0\", \"rnns.1.module.bias_ih_l0\", \"rnns.1.module.bias_hh_l0\", \"rnns.2.weight_hh_l0_raw\", \"rnns.2.module.weight_ih_l0\", \"rnns.2.module.weight_hh_l0\", \"rnns.2.module.bias_ih_l0\", \"rnns.2.module.bias_hh_l0\". \r\n\tUnexpected key(s) in state_dict: \"model\", \"opt\".\r\n(Pdb) learn.load_encoder(model_name+'.pth')\r\n*** FileNotFoundError: [Errno 2] No such file or directory: '/home/ubuntu/code/fintechdb/CatML/catml/model_ulmfit/awd_lstm_fwd_enc_SVNA.pth.pth'\r\n(Pdb) learn.load(model_name)\r\n*** RuntimeError: Error(s) in loading state_dict for SequentialRNN:\r\n\tMissing key(s) in state_dict: \"0.module.encoder.weight\", \"0.module.encoder_dp.emb.weight\", \"0.module.rnns.0.weight_hh_l0_raw\", \"0.module.rnns.0.module.weight_ih_l0\", \"0.module.rnns.0.module.weight_hh_l0\", \"0.module.rnns.0.module.bias_ih_l0\", \"0.module.rnns.0.module.bias_hh_l0\", \"0.module.rnns.1.weight_hh_l0_raw\", \"0.module.rnns.1.module.weight_ih_l0\", \"0.module.rnns.1.module.weight_hh_l0\", \"0.module.rnns.1.module.bias_ih_l0\", \"0.module.rnns.1.module.bias_hh_l0\", \"0.module.rnns.2.weight_hh_l0_raw\", \"0.module.rnns.2.module.weight_ih_l0\", \"0.module.rnns.2.module.weight_hh_l0\", \"0.module.rnns.2.module.bias_ih_l0\", \"0.module.rnns.2.module.bias_hh_l0\", \"1.layers.0.weight\", \"1.layers.0.bias\", \"1.layers.0.running_mean\", \"1.layers.0.running_var\", \"1.layers.2.weight\", \"1.layers.2.bias\", \"1.layers.4.weight\", \"1.layers.4.bias\", \"1.layers.4.running_mean\", \"1.layers.4.running_var\", \"1.layers.6.weight\", \"1.layers.6.bias\". \r\n\tUnexpected key(s) in state_dict: \"0.encoder.weight\", \"0.encoder_dp.emb.weight\", \"0.rnns.0.weight_hh_l0_raw\", \"0.rnns.0.module.weight_ih_l0\", \"0.rnns.0.module.weight_hh_l0\", \"0.rnns.0.module.bias_ih_l0\", \"0.rnns.0.module.bias_hh_l0\", \"0.rnns.1.weight_hh_l0_raw\", \"0.rnns.1.module.weight_ih_l0\", \"0.rnns.1.module.weight_hh_l0\", \"0.rnns.1.module.bias_ih_l0\", \"0.rnns.1.module.bias_hh_l0\", \"0.rnns.2.weight_hh_l0_raw\", \"0.rnns.2.module.weight_ih_l0\", \"0.rnns.2.module.weight_hh_l0\", \"0.rnns.2.module.bias_ih_l0\", \"0.rnns.2.module.bias_hh_l0\", \"1.decoder.weight\", \"1.decoder.bias\".\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2510", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2510/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2510/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2510/events", "html_url": "https://github.com/fastai/fastai/issues/2510", "id": 575264618, "node_id": "MDU6SXNzdWU1NzUyNjQ2MTg=", "number": 2510, "title": "Module not found error:", "user": {"login": "srp6996", "id": 47658911, "node_id": "MDQ6VXNlcjQ3NjU4OTEx", "avatar_url": "https://avatars3.githubusercontent.com/u/47658911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srp6996", "html_url": "https://github.com/srp6996", "followers_url": "https://api.github.com/users/srp6996/followers", "following_url": "https://api.github.com/users/srp6996/following{/other_user}", "gists_url": "https://api.github.com/users/srp6996/gists{/gist_id}", "starred_url": "https://api.github.com/users/srp6996/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srp6996/subscriptions", "organizations_url": "https://api.github.com/users/srp6996/orgs", "repos_url": "https://api.github.com/users/srp6996/repos", "events_url": "https://api.github.com/users/srp6996/events{/privacy}", "received_events_url": "https://api.github.com/users/srp6996/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-04T09:45:56Z", "updated_at": "2020-03-05T14:38:21Z", "closed_at": "2020-03-05T14:38:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2509", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2509/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2509/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2509/events", "html_url": "https://github.com/fastai/fastai/issues/2509", "id": 574355032, "node_id": "MDU6SXNzdWU1NzQzNTUwMzI=", "number": 2509, "title": "XDG Base Directory Support", "user": {"login": "billop", "id": 12755239, "node_id": "MDQ6VXNlcjEyNzU1MjM5", "avatar_url": "https://avatars2.githubusercontent.com/u/12755239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/billop", "html_url": "https://github.com/billop", "followers_url": "https://api.github.com/users/billop/followers", "following_url": "https://api.github.com/users/billop/following{/other_user}", "gists_url": "https://api.github.com/users/billop/gists{/gist_id}", "starred_url": "https://api.github.com/users/billop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/billop/subscriptions", "organizations_url": "https://api.github.com/users/billop/orgs", "repos_url": "https://api.github.com/users/billop/repos", "events_url": "https://api.github.com/users/billop/events{/privacy}", "received_events_url": "https://api.github.com/users/billop/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-03T01:24:30Z", "updated_at": "2020-03-03T21:40:51Z", "closed_at": "2020-03-03T14:28:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nFastai does not respect the XDG base directory specifications.\r\n\r\n**Expected behavior**\r\nConfiguration and data should not be in the same folder. Configuration should be in `$XDG_CONFIG_HOME`, and fall back to `.config/fastai/`. Data should be in `$XDG_DATA_HOME` and fallback to `.local/share/fastai/`.\r\nThis is a breaking change so I hope at least fastai2 respects the spec in the future.\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\nhttps://wiki.archlinux.org/index.php/XDG_Base_Directory\r\nhttps://wiki.gnome.org/Initiatives/GnomeGoals/XDGConfigFolders\r\nhttps://web.archive.org/web/20180827160401/plus.google.com/+RobPikeTheHuman/posts/R58WgWwN9jp", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2508", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2508/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2508/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2508/events", "html_url": "https://github.com/fastai/fastai/issues/2508", "id": 573730876, "node_id": "MDU6SXNzdWU1NzM3MzA4NzY=", "number": 2508, "title": "cannot import from fastai.conv_learner import * ", "user": {"login": "SlowMonk", "id": 33189954, "node_id": "MDQ6VXNlcjMzMTg5OTU0", "avatar_url": "https://avatars0.githubusercontent.com/u/33189954?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SlowMonk", "html_url": "https://github.com/SlowMonk", "followers_url": "https://api.github.com/users/SlowMonk/followers", "following_url": "https://api.github.com/users/SlowMonk/following{/other_user}", "gists_url": "https://api.github.com/users/SlowMonk/gists{/gist_id}", "starred_url": "https://api.github.com/users/SlowMonk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SlowMonk/subscriptions", "organizations_url": "https://api.github.com/users/SlowMonk/orgs", "repos_url": "https://api.github.com/users/SlowMonk/repos", "events_url": "https://api.github.com/users/SlowMonk/events{/privacy}", "received_events_url": "https://api.github.com/users/SlowMonk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-02T05:36:23Z", "updated_at": "2020-03-02T15:21:28Z", "closed_at": "2020-03-02T15:21:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "using python 3.7 \r\nfastai = 1.0.60 \r\n\r\nfrom fastai.conv_learner import *\r\nfrom fastai.dataset import *\r\n\r\nthis two line casue the import error ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2502", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2502/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2502/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2502/events", "html_url": "https://github.com/fastai/fastai/issues/2502", "id": 567406480, "node_id": "MDU6SXNzdWU1Njc0MDY0ODA=", "number": 2502, "title": "How to enable TPU support", "user": {"login": "gumowangfei", "id": 25955151, "node_id": "MDQ6VXNlcjI1OTU1MTUx", "avatar_url": "https://avatars3.githubusercontent.com/u/25955151?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gumowangfei", "html_url": "https://github.com/gumowangfei", "followers_url": "https://api.github.com/users/gumowangfei/followers", "following_url": "https://api.github.com/users/gumowangfei/following{/other_user}", "gists_url": "https://api.github.com/users/gumowangfei/gists{/gist_id}", "starred_url": "https://api.github.com/users/gumowangfei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gumowangfei/subscriptions", "organizations_url": "https://api.github.com/users/gumowangfei/orgs", "repos_url": "https://api.github.com/users/gumowangfei/repos", "events_url": "https://api.github.com/users/gumowangfei/events{/privacy}", "received_events_url": "https://api.github.com/users/gumowangfei/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-19T08:45:26Z", "updated_at": "2020-02-19T15:03:06Z", "closed_at": "2020-02-19T15:03:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2501", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2501/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2501/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2501/events", "html_url": "https://github.com/fastai/fastai/issues/2501", "id": 567306356, "node_id": "MDU6SXNzdWU1NjczMDYzNTY=", "number": 2501, "title": "Text Classification training accuracy problem in distributed training due to not shuffling samples", "user": {"login": "philtrade", "id": 19887230, "node_id": "MDQ6VXNlcjE5ODg3MjMw", "avatar_url": "https://avatars0.githubusercontent.com/u/19887230?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philtrade", "html_url": "https://github.com/philtrade", "followers_url": "https://api.github.com/users/philtrade/followers", "following_url": "https://api.github.com/users/philtrade/following{/other_user}", "gists_url": "https://api.github.com/users/philtrade/gists{/gist_id}", "starred_url": "https://api.github.com/users/philtrade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philtrade/subscriptions", "organizations_url": "https://api.github.com/users/philtrade/orgs", "repos_url": "https://api.github.com/users/philtrade/repos", "events_url": "https://api.github.com/users/philtrade/events{/privacy}", "received_events_url": "https://api.github.com/users/philtrade/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-02-19T04:22:59Z", "updated_at": "2020-02-19T21:25:06Z", "closed_at": "2020-02-19T21:25:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen running imdb text classification (second part of lesson3-imdb)  in distributed mode, accuracy dropped to 0.5 on `fit_one_cycle()`, not the 0.92xx in non-distributed mode.\r\n\r\n**Provide your installation details**\r\n```\r\nfastai v1, python 3.7, PyTorch v1.2 and v1.4, 3 cuda GPUs (gtx 1080 ti)\r\nplatform      : Linux-4.15.0-62-generic-x86_64-with-Ubuntu-18.04-bionic\r\n```\r\n\r\n**To Reproduce**\r\n1. Make sure the imdb classification data, and the fine_tuned encoder are already produced.  This can be done by running `lesson3-imdb` notebook up to the \"Classifier\" section.\r\n```\r\n~/.fastai/data/imdb/data_clas.pkl\r\n~/.fastai/data/imdb/models/fine_tuned_enc.pth\r\n```\r\n\r\n2. Run the following gist:\r\nhttps://gist.github.com/philtrade/33d3982a8cc0f827b1b4e3d1304a08b9:\r\n`python -m torch.distributed.launch --nproc_per_node=3 ./imdb_classifier_ddp.py`\r\n(note: change `--nproc_per_node=3` to the number of GPUs to use)\r\n\r\nOutput indicates curiously low accuracy and high validation loss:\r\n```\r\nepoch     train_loss  valid_loss  accuracy  time    \r\n0         0.128430    2.518312    0.499960  03:10     \r\n```\r\n\r\n**Expected behavior**\r\nWhen running the `lesson3-imdb` notebook's classifier section, or the above gist in non-distributed single GPU mode:\r\n`./imdb_classifier_ddp.py`, it should achieve accuracy around 0.92-0.93:\r\n\r\n```\r\n$ ./imdb_classifier_ddp.py\r\nlocal_rank: None\r\nepoch     train_loss  valid_loss  accuracy  time\r\n0         0.260723    0.185862    0.928560  02:19                                                                    \r\n```\r\n\r\n**Context, and Triage**\r\nThe problem seems to be with `fastai.distributed.OurDistributedSampler` is initialized with `shuffle=False` inherited from the `data.train_dl.init_kwargs['shuffle']`.  For Language Modeling training where `data` is a `TextLMDataBunch` object, `False` is quite suitable, see PR #1934.\r\n\r\nBut  for text classification learner, `data` is  `TextClasDataBunch` object and it randomizes and shuffles data in `SortishSampler.__iter__()`, despite its `train_dl.init_kwargs['shuffle']` is also `False`.  This randomness/shuffling gives great accuracy improvement in training, as the randomizing `SortishSampler` takes over.  So far so good, until `DistributedTrainer` comes into the picture.\r\n \r\nIn `DistributedTrainer.on_train_being()`, the `SortishSampler` is replaced by `fastai.distributed.OurDistributedSampler`, which was initialized with the `data.train_dl.init_kwargs['shuffle'] == False` value:\r\nhttps://github.com/fastai/fastai/blob/6f3fec2efaa22c67ad2aabba2ecd09814e448842/fastai/distributed.py#L25-L34\r\n\r\nThis creates a `OurDistributedSampler` that **does not shuffle in `__iter__()`** and yields poor accuracy (consistent over many epochs).\r\n\r\n**Proposed Solution**\r\nInstead of [line 34](https://github.com/fastai/fastai/blob/6f3fec2efaa22c67ad2aabba2ecd09814e448842/fastai/distributed.py#L34) above, create OurDistributedSampler with `shuffle=True`, if the data is a text classification data bunch.\r\n\r\n```\r\n        shuffle_train = True if isinstance(self.data,TextClasDataBunch) else shuffle\r\n        self.old_train_dl,self.data.train_dl,self.train_sampler = self._change_dl(self.data.train_dl, shuffle_train)\r\n```\r\nWith this, distributed training of imdb classifier achieves accuracy of 0.92xx:\r\n```\r\npython -m torch.distributed.launch --nproc_per_node=3 ./imdb_classifier_ddp.py\r\n...\r\nepoch     train_loss  valid_loss  accuracy  time    \r\n0         0.282722    0.188272    0.930526  03:09     \r\n```\r\n (*Caveat: 2 GPUs trains 2X slower, and 3 GPUs regain some speedup but still slower than 1 GPU.  I feel that's a different performance issue to be investigated separately.*)\r\n\r\nA little monkey-ish, but gives the desirable accuracy.  I'll be happy to whip up a PR for this, if it's an acceptable solution for now. Thanks.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2500", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2500/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2500/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2500/events", "html_url": "https://github.com/fastai/fastai/issues/2500", "id": 567199051, "node_id": "MDU6SXNzdWU1NjcxOTkwNTE=", "number": 2500, "title": "Optimization for Large Scale Training on SUMMIT", "user": {"login": "agemagician", "id": 6087313, "node_id": "MDQ6VXNlcjYwODczMTM=", "avatar_url": "https://avatars1.githubusercontent.com/u/6087313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agemagician", "html_url": "https://github.com/agemagician", "followers_url": "https://api.github.com/users/agemagician/followers", "following_url": "https://api.github.com/users/agemagician/following{/other_user}", "gists_url": "https://api.github.com/users/agemagician/gists{/gist_id}", "starred_url": "https://api.github.com/users/agemagician/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agemagician/subscriptions", "organizations_url": "https://api.github.com/users/agemagician/orgs", "repos_url": "https://api.github.com/users/agemagician/repos", "events_url": "https://api.github.com/users/agemagician/events{/privacy}", "received_events_url": "https://api.github.com/users/agemagician/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-18T22:31:29Z", "updated_at": "2020-02-19T15:02:01Z", "closed_at": "2020-02-19T15:02:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am trying to train a language model on 0.75 terabytes of textual data on SUMMIT.\r\nI am currently testing the training on 5 nodes, each with 6 V100 GPUs.\r\nThe problems are:\r\n1. The data loading is extremely slow and it causes a bottleneck on the training.\r\n2. After 2 iterations the training hangs.\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.61.dev0\r\nfastprogress  : 0.2.2\r\ntorch         : 1.2.0\r\nnvidia driver : 418.67\r\ntorch cuda    : 10.1.243 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 16130MB | Tesla V100-SXM2-16GB\r\n\r\n=== Environment === \r\nplatform      : Linux-4.14.0-115.8.1.el7a.ppc64le-ppc64le-with-redhat-7.6-Maipo\r\ndistro        : #1 SMP Thu May 9 14:45:13 UTC 2019\r\nconda env     : /ccs/proj/bif120/deepforce/virtualenvs/fastai\r\npython        : /ccs/proj/bif120/deepforce/virtualenvs/fastai/bin/python\r\nsys.path      : \r\n/sw/summit/xalt/1.2.0/site\r\n/sw/summit/xalt/1.2.0/libexec\r\n/ccs/proj/bif120/deepforce/virtualenvs/fastai/lib/python37.zip\r\n/ccs/proj/bif120/deepforce/virtualenvs/fastai/lib/python3.7\r\n/ccs/proj/bif120/deepforce/virtualenvs/fastai/lib/python3.7/lib-dynload\r\n/ccs/home/deepforce/.local/lib/python3.7/site-packages\r\n/ccs/proj/bif120/deepforce/virtualenvs/fastai/lib/python3.7/site-packages\r\n```\r\n\r\n\r\n**To Reproduce**\r\n```\r\nfrom fastai.text import *\r\nfrom fastai.callbacks.tracker import *\r\n#from fastai.callbacks.tensorboard import *\r\nfrom pytorch_lamb import Lamb\r\nimport os\r\nimport glob\r\nfrom fastai.distributed import *\r\nimport argparse\r\n\r\nvocabFilePath = 'vocab.txt'\r\ntrainFolderPath = '/fastai/train/'\r\ntrainFilesGlob = 'train*'\r\nvalidFilePath =  'valid.txt'\r\ntrainFiles = [os.path.basename(x) for x in glob.glob(trainFolderPath+trainFilesGlob )]\r\nnumberOfTrainingFiles = len(trainFiles)\r\nsaveEncoderFilePath = 'lm_encoder'\r\nSaveModelFilePath = 'model'\r\nproject_id = 'rnn_lm'\r\ntboard_path = Path('data/tensorboard/' + project_id)\r\n\r\n#print(trainFiles)\r\n\r\nbatchSize = 128\r\nmaxSequenceLength = 100\r\ndrop_mult = 0.1\r\nqrnn = False\r\nbidir = True\r\n\r\nepochs = 300\r\nlr = 1e-3\r\nrun = 1\r\n\r\nworld_size = int(os.environ['OMPI_COMM_WORLD_SIZE'])\r\nworld_rank = int(os.environ['OMPI_COMM_WORLD_RANK'])\r\nlocal_rank = int(os.environ['OMPI_COMM_WORLD_LOCAL_RANK'])\r\n\r\nparser = argparse.ArgumentParser()\r\nparser.add_argument('--backend', default='nccl', type=str,\r\n                    help='pytorch dist backend')\r\nparser.add_argument('--sharedfile', default=None, type=str,\r\n                    help='sharedfile for nccl init')\r\nargs = parser.parse_args()\r\n#torch.cuda.set_device(args.local_rank)\r\ntorch.cuda.set_device(local_rank)\r\n\r\n#torch.distributed.init_process_group(backend='nccl', init_method='env://')\r\nsharedfile='file://%s'%(args.sharedfile)\r\nif args.backend == 'ddl':\r\n    torch.distributed.init_process_group(backend=args.dist_backend)\r\n    world_size = dist.get_world_size()\r\n    world_rank = dist.get_rank()\r\nelse:\r\n    torch.distributed.init_process_group(args.backend, init_method=sharedfile,\r\n                            rank=world_rank, world_size=world_size)\r\n\r\n# Reading vocab file\r\nwith open(vocabFilePath, 'r') as file:\r\n    tokens = file.read().replace('\\n', '')\r\n    \r\n# Generate vocab class\r\nbfdVocab = text.transform.Vocab.create(tokens, max_vocab=1000, min_freq=1)\r\n\r\n# Print vocab size\r\nprint('Vocab size is ' + str(len(bfdVocab.itos)))\r\n\r\n# Generate tokinizer\r\ntok = Tokenizer(\r\n    pre_rules = [fix_html, rm_useless_spaces],\r\n    post_rules = [])\r\n\r\ndef modelConfig(qrnn:bool=False,bidir:bool=False):\r\n    config = awd_lstm_lm_config.copy()\r\n    config['emb_sz'] = 100\r\n    config['n_hid'] = 4096\r\n    config['n_layers'] = 4\r\n    config['qrnn'] = qrnn\r\n    config['bidir'] = bidir\r\n    return config\r\n\r\n\r\nfor epoch in range(0,epochs):\r\n  print('Epoch: ' + str(epoch))\r\n  for i, trainFile in enumerate(trainFiles):\r\n\r\n    data_lm = TextLMDataBunch.from_csv(trainFolderPath, \r\n                                       csv_name=trainFile,\r\n                                       test = validFilePath,\r\n                                       text_cols=0,\r\n                                       bs=batchSize,\r\n                                       vocab=bfdVocab,\r\n                                       tokenizer=tok, \r\n                                       include_eos=True,\r\n                                       bptt=maxSequenceLength)\r\n\r\n    if epoch == 0 and i == 0:\r\n      learn = language_model_learner(data_lm, \r\n                              arch=AWD_LSTM, \r\n                              pretrained=False,\r\n                              drop_mult=drop_mult,\r\n                              config=modelConfig(qrnn=qrnn,bidir=bidir),\r\n                              opt_func=Lamb,\r\n                              metrics=[accuracy, Perplexity()]).to_fp16().to_distributed(local_rank)\r\n      #learn.callback_fns.append(partial(LearnerTensorboardWriter, \r\n      #                              base_dir=tboard_path, \r\n      #                              name='lstm_4_layers'))\r\n    else:\r\n      learn.data = data_lm\r\n    \r\n    #if os.path.exists(saveEncoderFilePath):\r\n    #  learner.load_encoder(saveEncoderFilePath)               \r\n    \r\n    learn.fit_one_cycle(1, lr)\r\n\r\n    if i % 500 == 0:\r\n        learn.save_encoder(saveEncoderFilePath + \r\n                       '-' + str(run) +\r\n                       '-' + str(epoch) +\r\n                       '-' + str(i))\r\n        learn.save(SaveModelFilePath +\r\n               '-' + str(run) +\r\n                '-' + str(epoch) +\r\n                '-' + str(i))\r\n```\r\n\r\n**Expected behavior**\r\nThe data loader should be much faster giving the training is running on SUMMIT and both CPU and Storage are very fast.\r\nThe training should not hang after the second iteration.\r\n\r\n**Screenshots**\r\n```\r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\n0         3.239555    3.205903    0.119488  24.680622   01:05     \r\n0         3.240237    3.203186    0.119950  24.614567   01:05     \r\n0         3.240328    3.205652    0.117258  24.674215   01:05     \r\n0         3.239616    3.203046    0.119889  24.610619   01:05     \r\n0         3.239094    3.205772    0.118627  24.676868   01:05     \r\n0         3.240321    3.205272    0.118575  24.664776   01:05     \r\n0         3.237993    3.207576    0.116067  24.722513   01:05     \r\n0         3.239378    3.205586    0.118983  24.670874   01:05     \r\n0         3.238245    3.207097    0.117609  24.712124   01:05     \r\n0         3.239268    3.206927    0.117366  24.708406   01:05     \r\n0         3.239594    3.205502    0.118755  24.668655   01:05     \r\n0         3.239410    3.206629    0.116688  24.697659   01:05     \r\n0         3.238886    3.209370    0.116738  24.765827   01:05     \r\n0         3.240734    3.204649    0.119039  24.648527   01:05     \r\n0         3.238798    3.204288    0.118935  24.640699   01:05     \r\n0         3.238420    3.205179    0.119977  24.662729   01:05     \r\n0         3.240560    3.205656    0.119262  24.674534   01:05     \r\n0         3.240218    3.204483    0.118148  24.644825   01:05     \r\n0         3.238463    3.205331    0.118598  24.666594   01:05     \r\n0         3.238334    3.205641    0.118703  24.673073   01:05     \r\n0         3.239755    3.205750    0.117604  24.674603   01:05     \r\n0         3.240667    3.204138    0.120210  24.637939   01:05     \r\n0         3.239536    3.206484    0.117453  24.690327   01:05     \r\n0         3.239801    3.204713    0.118774  24.649620   01:05     \r\n0         3.239740    3.205905    0.119575  24.684502   01:05     \r\n0         3.238021    3.203583    0.121156  24.626558   01:05     \r\n0         3.240385    3.204848    0.118958  24.652266   01:05     \r\n0         3.240538    3.207170    0.118560  24.711653   01:05     \r\n0         3.239162    3.206001    0.120063  24.682611   01:05     \r\n0         3.238398    3.205659    0.118414  24.671091   01:05     \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\n0         3.114744    3.090914    0.169898  22.002508   02:56     \r\n0         3.113806    3.089125    0.172214  21.965504   01:30     \r\n0         3.113744    3.089062    0.170311  21.964420   03:05     \r\n0         3.116306    3.090165    0.169788  21.987658   01:31     \r\n0         3.114070    3.086357    0.174237  21.903101   02:50     \r\n0         3.111435    3.088697    0.170088  21.959728   04:17     \r\n0         3.113238    3.087936    0.171124  21.938978   04:00     \r\n0         3.114816    3.089198    0.170982  21.964544   01:34     \r\n0         3.113761    3.088950    0.172207  21.958708   02:57     \r\n0         3.112733    3.091432    0.170414  22.009134   04:06     \r\n0         3.114073    3.091156    0.170937  22.015932   03:12     \r\n0         3.113014    3.093812    0.169968  22.062860   02:46     \r\n0         3.113208    3.090292    0.169798  21.987900   01:38     \r\n0         3.114506    3.089864    0.170009  21.981178   02:51     \r\n0         3.112215    3.093698    0.169970  22.063303   02:52     \r\n0         3.112037    3.090659    0.170136  21.994404   02:52     \r\n0         3.113697    3.091396    0.170572  22.010441   03:51     \r\n0         3.113314    3.088907    0.171084  21.963490   02:09     \r\n0         3.112040    3.089100    0.171264  21.963717   02:47     \r\n0         3.113475    3.090971    0.168818  21.999561   01:26     \r\n0         3.112656    3.089425    0.169486  21.966820   03:08     \r\n0         3.113193    3.091487    0.170454  22.017002   01:55     \r\n0         3.113288    3.090837    0.169993  21.996765   01:25     \r\n0         3.113066    3.091994    0.168317  22.026627   01:01     \r\n0         3.113886    3.089051    0.170502  21.959461   04:13     \r\n0         3.114272    3.091522    0.170404  22.011028   04:18     \r\n0         3.113822    3.089810    0.170077  21.977430   02:53     \r\n0         3.112060    3.091597    0.169627  22.012960   01:42     \r\n0         3.114772    3.089714    0.171231  21.976494   03:56     \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time    \r\nepoch     train_loss  valid_loss  accuracy  perplexity  time  \r\n```\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\nThe data is divided into 6000 files and each file is approximately 126 MB with 353715 lines.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2499", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2499/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2499/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2499/events", "html_url": "https://github.com/fastai/fastai/issues/2499", "id": 567088069, "node_id": "MDU6SXNzdWU1NjcwODgwNjk=", "number": 2499, "title": "Invalid __repr__ on ItemBase", "user": {"login": "dataframing", "id": 8692129, "node_id": "MDQ6VXNlcjg2OTIxMjk=", "avatar_url": "https://avatars1.githubusercontent.com/u/8692129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dataframing", "html_url": "https://github.com/dataframing", "followers_url": "https://api.github.com/users/dataframing/followers", "following_url": "https://api.github.com/users/dataframing/following{/other_user}", "gists_url": "https://api.github.com/users/dataframing/gists{/gist_id}", "starred_url": "https://api.github.com/users/dataframing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dataframing/subscriptions", "organizations_url": "https://api.github.com/users/dataframing/orgs", "repos_url": "https://api.github.com/users/dataframing/repos", "events_url": "https://api.github.com/users/dataframing/events{/privacy}", "received_events_url": "https://api.github.com/users/dataframing/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-18T18:48:04Z", "updated_at": "2020-02-19T16:03:24Z", "closed_at": "2020-02-19T16:03:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nThe `ItemBase` class has an invalid string representation via `__repr__`. The class defines its string representation as:\r\n\r\nhttps://github.com/fastai/fastai/blob/6f3fec2efaa22c67ad2aabba2ecd09814e448842/fastai/core.py#L182\r\n\r\nThis is problematic because `str(self)` re-calls `__repr__`, which results in an unbounded recursive call. Specifically, this gives us a `RecursionError`:\r\n\r\n```pytb\r\n---------------------------------------------------------------------------\r\nRecursionError                            Traceback (most recent call last)\r\n<timed eval> in <module>\r\n\r\n<ipython-input-107-528052d4fa70> in build_predictions(text, model, verbose)\r\n      7     verbose: bool = True\r\n      8 ) -> Dict[str, float]:\r\n----> 9     x, _, _, probas = model.predict(item=text, return_x=True)\r\n     10     if verbose:\r\n     11         pass\r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/basic_train.py in predict(self, item, return_x, batch_first, with_dropout, **kwargs)\r\n    370     def predict(self, item:ItemBase, return_x:bool=False, batch_first:bool=True, with_dropout:bool=False, **kwargs):\r\n    371         \"Return predicted class, label and probabilities for `item`.\"\r\n--> 372         batch = self.data.one_item(item)\r\n    373         res = self.pred_batch(batch=batch, with_dropout=with_dropout)\r\n    374         raw_pred,x = grab_idx(res,0,batch_first=batch_first),batch[0]\r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/basic_data.py in one_item(self, item, detach, denorm, cpu)\r\n    179         \"Get `item` into a batch. Optionally `detach` and `denorm`.\"\r\n    180         ds = self.single_ds\r\n--> 181         with ds.set_item(item):\r\n    182             return self.one_batch(ds_type=DatasetType.Single, detach=detach, denorm=denorm, cpu=cpu)\r\n    183 \r\n\r\n~/anaconda3/envs/srs/lib/python3.7/contextlib.py in __enter__(self)\r\n    110         del self.args, self.kwds, self.func\r\n    111         try:\r\n--> 112             return next(self.gen)\r\n    113         except StopIteration:\r\n    114             raise RuntimeError(\"generator didn't yield\") from None\r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/data_block.py in set_item(self, item)\r\n    609     def set_item(self,item):\r\n    610         \"For inference, will briefly replace the dataset with one that only contains `item`.\"\r\n--> 611         self.item = self.x.process_one(item)\r\n    612         yield None\r\n    613         self.item = None\r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/data_block.py in process_one(self, item, processor)\r\n     89         if processor is not None: self.processor = processor\r\n     90         self.processor = listify(self.processor)\r\n---> 91         for p in self.processor: item = p.process_one(item)\r\n     92         return item\r\n     93 \r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/text/data.py in process_one(self, item)\r\n    289 \r\n    290     def process_one(self, item):\r\n--> 291         return self.tokenizer._process_all_1(_join_texts([item], self.mark_fields, self.include_bos, self.include_eos))[0]\r\n    292 \r\n    293     def process(self, ds):\r\n\r\n<<<... Skipped a few lines ...>>>\r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/core.py in __repr__(self)\r\n    180     \"Base item type in the fastai library.\"\r\n    181     def __init__(self, data:Any): self.data=self.obj=data\r\n--> 182     def __repr__(self)->str: return f'{self.__class__.__name__} {str(self)}'\r\n    183     def show(self, ax:plt.Axes, **kwargs):\r\n    184         \"Subclass this method if you want to customize the way this `ItemBase` is shown on `ax`.\"\r\n\r\n... last 1 frames repeated, from the frame below ...\r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/core.py in __repr__(self)\r\n    180     \"Base item type in the fastai library.\"\r\n    181     def __init__(self, data:Any): self.data=self.obj=data\r\n--> 182     def __repr__(self)->str: return f'{self.__class__.__name__} {str(self)}'\r\n    183     def show(self, ax:plt.Axes, **kwargs):\r\n    184         \"Subclass this method if you want to customize the way this `ItemBase` is shown on `ax`.\"\r\n\r\nRecursionError: maximum recursion depth exceeded while getting the str of an object\r\n```\r\n\r\nThat said, perhaps we're not meant to directly initialize the `ItemBase` class? I was aiming to have `mypy` be happy when I call `model.predict(item=some_string)` \u2013 which works because it's cast as an item \u2013 but I'd rather not silence `mypy` if I can help it.\r\n\r\nOtherwise, I suspect the fix for this is just changing the `__repr__` to invoke the `__repr__` on the attributes wrapped by the `ItemBase`: \r\n\r\n```python\r\ndef __repr__(self)->str: return f'{self.__class__.__name__} {str(self.data)}' \r\n```\r\n\r\nI can confirm that the following works:\r\n\r\n```python\r\nclass MyItemBase(ItemBase):\r\n    \r\n    def __repr__(self)->str: return f'{self.__class__.__name__} {str(self.data)}' \r\n```\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 418.87\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 16130MB | Tesla V100-SXM2-16GB\r\n\r\n=== Environment === \r\nplatform      : Linux-4.4.0-1101-aws-x86_64-with-debian-stretch-sid\r\ndistro        : #112-Ubuntu SMP Thu Jan 9 11:27:02 UTC 2020\r\nconda env     : srs\r\npython        : /home/ubuntu/.local/share/virtualenvs/srs-DkOf0qi1/bin/python\r\nsys.path      : /home/ubuntu/srs/notebooks\r\n/home/ubuntu/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/_pdbpp_path_hack\r\n/home/ubuntu/src/cntk/bindings/python\r\n/home/ubuntu/anaconda3/envs/srs/lib/python37.zip\r\n/home/ubuntu/anaconda3/envs/srs/lib/python3.7\r\n/home/ubuntu/anaconda3/envs/srs/lib/python3.7/lib-dynload\r\n\r\n/home/ubuntu/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages\r\n/home/ubuntu/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/IPython/extensions\r\n/home/ubuntu/.ipython\r\n```\r\n\r\n**To Reproduce**\r\nOn any platform:\r\n\r\n```python\r\nimport fastai\r\nitem = fastai.core.ItemBase(data=\"test\")\r\nprint(item) # Raises RecursionError.\r\n```\r\n\r\n**Expected behavior**\r\nI would expect to be able to see the value within an item without raising an error.\r\n\r\n**Screenshots**\r\nN/A.\r\n\r\n**Additional context**\r\nI've reproduced this bug both on Ubuntu (logs above) and macOS (locally). Apologies if this is a false error!\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2497", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2497/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2497/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2497/events", "html_url": "https://github.com/fastai/fastai/issues/2497", "id": 566190719, "node_id": "MDU6SXNzdWU1NjYxOTA3MTk=", "number": 2497, "title": "Error assigning Loss Function to learner", "user": {"login": "rpdunne", "id": 52535839, "node_id": "MDQ6VXNlcjUyNTM1ODM5", "avatar_url": "https://avatars0.githubusercontent.com/u/52535839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rpdunne", "html_url": "https://github.com/rpdunne", "followers_url": "https://api.github.com/users/rpdunne/followers", "following_url": "https://api.github.com/users/rpdunne/following{/other_user}", "gists_url": "https://api.github.com/users/rpdunne/gists{/gist_id}", "starred_url": "https://api.github.com/users/rpdunne/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rpdunne/subscriptions", "organizations_url": "https://api.github.com/users/rpdunne/orgs", "repos_url": "https://api.github.com/users/rpdunne/repos", "events_url": "https://api.github.com/users/rpdunne/events{/privacy}", "received_events_url": "https://api.github.com/users/rpdunne/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-17T10:10:10Z", "updated_at": "2020-02-17T15:20:44Z", "closed_at": "2020-02-17T15:20:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\n\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n```\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.57\r\nfastprogress  : 0.1.21\r\ntorch         : 1.4.0\r\nnvidia driver : 441.22\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7501 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 2\r\ntorch devices : 2\r\n  - gpu0      : 8129MB | Tesla M60\r\n  - gpu1      : 8129MB | Tesla M60\r\n\r\n=== Environment === \r\nplatform      : Windows-10-10.0.14393-SP0\r\nconda env     : ml\r\npython        : C:\\Users\\-sysop-dur7an-z\\.conda\\envs\\ml\\python.exe\r\n```\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\nWhen I train a learner `learn = unet_learner(data ,models.resnet50, metrics=metrics)`  with the default Loss function (FlattenedLoss), I have no error and the model trains fine. However, when I try to use another loss function, (e.g. `learn.loss_func = nn.BCEWithLogitsLoss()` ), I get the following error:\r\n\r\n`ValueError: Target size (torch.Size([2, 1, 64, 128])) must be the same as input size (torch.Size([2, 2, 64, 128]))`\r\n\r\nDo you know why this is?\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n\r\n```\r\nlearn = unet_learner(data ,models.resnet50, metrics=metrics)\r\nlearn.loss_fn = nn.BCEWithLogitsLoss()\r\n```\r\n\r\n`lr_find(learn)`\r\n\r\n`ValueError: Target size (torch.Size([2, 1, 64, 128])) must be the same as input size (torch.Size([2, 2, 64, 128]))`\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2496", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2496/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2496/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2496/events", "html_url": "https://github.com/fastai/fastai/issues/2496", "id": 566048379, "node_id": "MDU6SXNzdWU1NjYwNDgzNzk=", "number": 2496, "title": "DistributedDataParallel trainer interferes with GANTrainer.switch()", "user": {"login": "philtrade", "id": 19887230, "node_id": "MDQ6VXNlcjE5ODg3MjMw", "avatar_url": "https://avatars0.githubusercontent.com/u/19887230?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philtrade", "html_url": "https://github.com/philtrade", "followers_url": "https://api.github.com/users/philtrade/followers", "following_url": "https://api.github.com/users/philtrade/following{/other_user}", "gists_url": "https://api.github.com/users/philtrade/gists{/gist_id}", "starred_url": "https://api.github.com/users/philtrade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philtrade/subscriptions", "organizations_url": "https://api.github.com/users/philtrade/orgs", "repos_url": "https://api.github.com/users/philtrade/repos", "events_url": "https://api.github.com/users/philtrade/events{/privacy}", "received_events_url": "https://api.github.com/users/philtrade/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-17T04:27:32Z", "updated_at": "2020-02-18T14:48:23Z", "closed_at": "2020-02-18T14:48:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nTraining wgan in Distributed Data Parallel mode would crash, because it cannot find the `switch()` method in the `DistributedDataParallel` object.\r\n\r\n**Provide your installation details**\r\n```\r\nfastai v1, python 3.7, PyTorch v1.2 and v1.4, 3 cuda GPUs (gtx 1080 ti)\r\nplatform      : Linux-4.15.0-62-generic-x86_64-with-Ubuntu-18.04-bionic\r\n```\r\n\r\n**To Reproduce**\r\nRun the scripted version of `lesson7-wgan` notebook in DDP mode, even with only 1 GPU:  https://gist.github.com/philtrade/cb9953079a99afc522fa777574f2549d\r\nby `python -m torch.distributed.launch --nproc_per_node=1 wgan_ddp.py`\r\nwill produce:\r\n```text\r\n  File \"/home/ndim1/Dropbox/fastai/fastai/basic_train.py\", line 98, in fit\r\n    cb_handler.on_epoch_begin()\r\n  File \"/home/ndim1/Dropbox/fastai/fastai/callback.py\", line 273, in on_epoch_begin\r\n    self('epoch_begin')\r\n  File \"/home/ndim1/Dropbox/fastai/fastai/callback.py\", line 251, in __call__\r\n    for cb in self.callbacks: self._call_and_update(cb, cb_name, **kwargs)\r\n  File \"/home/ndim1/Dropbox/fastai/fastai/callback.py\", line 241, in _call_and_update\r\n    new = ifnone(getattr(cb, f'on_{cb_name}')(**self.state_dict, **kwargs), dict())\r\n  File \"/home/ndim1/Dropbox/fastai/fastai/vision/gan.py\", line 134, in on_epoch_begin\r\n    self.switch(self.gen_mode)\r\n  File \"/home/ndim1/Dropbox/fastai/fastai/vision/gan.py\", line 154, in switch\r\n    self.model.switch(gen_mode)\r\n  File \"/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py\", line 576, in __getattr__\r\n    type(self).__name__, name))\r\nAttributeError: 'DistributedDataParallel' object has no attribute 'switch'\r\n```\r\n\r\n**Expected behavior**\r\nTraining should proceed, e.g.:\r\n```\r\nepoch     train_loss  valid_loss  gen_loss  disc_loss  time    \r\nEpoch 1/3 : |\u2588\u2588\u2588---------------------------------------------------------------| 5.92% [10/169 00:26<07:00 -0.1393\r\n```\r\n\r\n**Triage**\r\nThe primary problem is fairly straight-forward.  `GANTrainer.switch()` attempts to call the `switch()` method on the `GANModule`, its `self.model`, in this line: \r\n https://github.com/fastai/fastai/blob/4e630af8b416e8ea1553f12f3d0dcd4a7fd7ea86/fastai/vision/gan.py#L153\r\n`self.model` points to `self.learn.model` when `GANTrainer` was constructed.\r\n\r\nBut in DDP mode upon `DistributedTrainer.on_train_begin()`,`self.learn.model` becomes  PyTorch's `DistributedDataParallel` object, which hides the original `GANModule` inside its `.module` member, therefore the above call cannot reach the intended `GANModule` object.\r\n\r\n**Proposed Fix**\r\nSimilar to how `GANTrainer` remembers the `generator` and `critic` in the constructor:\r\nhttps://github.com/fastai/fastai/blob/4e630af8b416e8ea1553f12f3d0dcd4a7fd7ea86/fastai/vision/gan.py#L78\r\nRemember the original `switch` method as well:\r\n```\r\n        self.generator,self.critic = self.model.generator,self.model.critic\r\n+       self.switch_model = self.model.switch\r\n```\r\nthen change https://github.com/fastai/fastai/blob/4e630af8b416e8ea1553f12f3d0dcd4a7fd7ea86/fastai/vision/gan.py#L153\r\nto `self.switch_model(gen_mode)`\r\n\r\nI have tested this in PyTorch v1.4, and I'll be happy to draft a PR for this.\r\n\r\n--\r\nNote 1: PyTorch v1.2 has a bug [(issue 19840)](https://github.com/pytorch/pytorch/issues/19840) that further requires `DistributedDataParallel()` be called with `...,find_unused_parameters=True` in `fastai.distributed.DistributedTrainer.on_train_begin()`.   [PyTorch v1.4 fixed it](https://github.com/pytorch/pytorch/pull/19901) though.\r\n\r\nNote 2: With the above machinery fixed, training `wgan` in DDP has other problems.  In short, the losses (train, gen, disc) don't seem to drop from epoch to epoch, and training doesn't speed up despite use of multiple GPUs.  I'm investigating, and will raise as separate issues if warranted.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2495", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2495/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2495/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2495/events", "html_url": "https://github.com/fastai/fastai/issues/2495", "id": 566016851, "node_id": "MDU6SXNzdWU1NjYwMTY4NTE=", "number": 2495, "title": "tabular get_preds outputs zero category for all items in Test dataset (individual predict is ok)", "user": {"login": "cluePrints", "id": 432728, "node_id": "MDQ6VXNlcjQzMjcyOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/432728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cluePrints", "html_url": "https://github.com/cluePrints", "followers_url": "https://api.github.com/users/cluePrints/followers", "following_url": "https://api.github.com/users/cluePrints/following{/other_user}", "gists_url": "https://api.github.com/users/cluePrints/gists{/gist_id}", "starred_url": "https://api.github.com/users/cluePrints/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cluePrints/subscriptions", "organizations_url": "https://api.github.com/users/cluePrints/orgs", "repos_url": "https://api.github.com/users/cluePrints/repos", "events_url": "https://api.github.com/users/cluePrints/events{/privacy}", "received_events_url": "https://api.github.com/users/cluePrints/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-02-17T02:11:25Z", "updated_at": "2020-05-19T01:32:14Z", "closed_at": "2020-02-17T15:17:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n`get_preds(Test)` outputs zero category for all the items in the dataset. Individual `predict()` is ok.\r\n\r\nProbabilities returned by both do match.\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython       : 3.6.9\r\nfastai       : 1.0.60\r\nfastprogress : 0.2.2\r\ntorch        : 1.4.0\r\ntorch cuda   : 10.1 / is **Not available** \r\n\r\n=== Hardware === \r\nNo GPUs available \r\n\r\n=== Environment === \r\nplatform     : Linux-4.14.137+-x86_64-with-Ubuntu-18.04-bionic\r\ndistro       : #1 SMP Thu Aug 8 02:47:02 PDT 2019\r\nconda env    : Unknown\r\npython       : /usr/bin/python3\r\nsys.path     : \r\n/env/python\r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/usr/local/lib/python3.6/dist-packages\r\n/usr/lib/python3/dist-packages\r\n/usr/local/lib/python3.6/dist-packages/IPython/extensions\r\n/root/.ipython\r\nno supported gpus found on this system\r\n```\r\n\r\n**To Reproduce**\r\n- CPU: [google colab](https://colab.research.google.com/drive/1G3u48O04qGXnvY0s6Uv-u8bnbcqakzQT#scrollTo=f-ve5m3X3bMX)\r\n- GPU: [google colab](https://colab.research.google.com/drive/1jteB3yXlV9PYnAVCsNjBP8H0ysfuF7o1#scrollTo=CzfweWla3fTL)\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n```\r\n> learn.predict(df_test[feature_names].iloc[1])\r\n(Category 1, tensor(1), tensor([0.2549, 0.7451]))\r\n\r\n> preds, y = learn.get_preds(DatasetType.Test)\r\n> y[1], preds[1]\r\n(tensor(0), tensor([0.2549, 0.7451]))                       # tensor(0) should be tensor(1) here\r\n```\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2494", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2494/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2494/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2494/events", "html_url": "https://github.com/fastai/fastai/issues/2494", "id": 565982813, "node_id": "MDU6SXNzdWU1NjU5ODI4MTM=", "number": 2494, "title": "Invalid __repr__ on MultiLabelFbeta", "user": {"login": "dataframing", "id": 8692129, "node_id": "MDQ6VXNlcjg2OTIxMjk=", "avatar_url": "https://avatars1.githubusercontent.com/u/8692129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dataframing", "html_url": "https://github.com/dataframing", "followers_url": "https://api.github.com/users/dataframing/followers", "following_url": "https://api.github.com/users/dataframing/following{/other_user}", "gists_url": "https://api.github.com/users/dataframing/gists{/gist_id}", "starred_url": "https://api.github.com/users/dataframing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dataframing/subscriptions", "organizations_url": "https://api.github.com/users/dataframing/orgs", "repos_url": "https://api.github.com/users/dataframing/repos", "events_url": "https://api.github.com/users/dataframing/events{/privacy}", "received_events_url": "https://api.github.com/users/dataframing/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-16T22:36:27Z", "updated_at": "2020-02-17T15:39:15Z", "closed_at": "2020-02-17T15:38:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\nThe `MultiLabelFbeta` metric (callback) has an invalid string representation `__repr__`. The `Callback` superclass defines the `__repr__` by inspecting the callback's initialization keywords and removing any attributes specified for removal from the string representation (see https://github.com/fastai/fastai/blob/master/fastai/callback.py#L202-L206):\r\n\r\n```python\r\n    def  __repr__(self):\r\n        attrs = func_args(self.__init__)\r\n        to_remove = getattr(self, 'exclude', [])\r\n        list_repr = [self.__class__.__name__] + [f'{k}: {getattr(self, k)}' for k in attrs if k != 'self' and k not in to_remove]\r\n        return '\\n'.join(list_repr)\r\n```\r\n\r\nThis introspection fails on the `MultiLabelFbeta` metric (callback) because although it takes `beta` as an initialization argument, it doesn't save `beta` as an instance attribute \u2014 it instead computes and saves the square (under `beta2`; see https://github.com/fastai/fastai/blob/master/fastai/metrics.py#L322-L323):\r\n\r\n```python\r\n    def __init__(self, beta=2, eps=1e-15, thresh=0.3, sigmoid=True, average=\"micro\"):\r\n        self.eps,self.thresh,self.sigmoid,self.average,self.beta2 = eps,thresh,sigmoid,average,beta**2\r\n```\r\n\r\nThe specific traceback is as follows:\r\n\r\n```pytb\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-3-ec0b0ec30755> in <module>\r\n----> 1 print(MultiLabelFbeta())\r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/callback.py in __repr__(self)\r\n    203         attrs = func_args(self.__init__)\r\n    204         to_remove = getattr(self, 'exclude', [])\r\n--> 205         list_repr = [self.__class__.__name__] + [f'{k}: {getattr(self, k)}' for k in attrs if k != 'self' and k not in to_remove]\r\n    206         return '\\n'.join(list_repr)\r\n    207 \r\n\r\n~/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/fastai/callback.py in <listcomp>(.0)\r\n    203         attrs = func_args(self.__init__)\r\n    204         to_remove = getattr(self, 'exclude', [])\r\n--> 205         list_repr = [self.__class__.__name__] + [f'{k}: {getattr(self, k)}' for k in attrs if k != 'self' and k not in to_remove]\r\n    206         return '\\n'.join(list_repr)\r\n    207 \r\n\r\nAttributeError: 'MultiLabelFbeta' object has no attribute 'beta'\r\n```\r\n\r\nI think there are a few ways forward:\r\n\r\n1. Register `beta` under the `exclude` class attribute on `MultiLabelFbeta` (e.g., `MultiLabelFbeta.exclude = ['beta']`.\r\n\r\n    ```python\r\n    class MultiLabelFbeta(Callback):\r\n        ...\r\n        exclude = ['beta']\r\n        ...\r\n    ```\r\n\r\n1. Update the superclass `__repr__` by also checking that the instance has the actual attribute:\r\n\r\n    ```python\r\n    def  __repr__(self):\r\n        ...\r\n        list_repr = [self.__class__.__name__] + [f'{k}: {getattr(self, k)}' for k in attrs if k != 'self' and k not in to_remove and hasattr(self, k)]\r\n        ...\r\n    ```\r\n\r\n1. Save `beta` on the callback, like we do with `beta2`. Though this seems unnecessary and seems like a code smell.\r\n\r\nRegardless, I'm happy to open a PR that fixes this; let me know what you all think works best. Thanks!\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython        : 3.7.6\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 418.87\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 16130MB | Tesla V100-SXM2-16GB\r\n\r\n=== Environment === \r\nplatform      : Linux-4.4.0-1101-aws-x86_64-with-debian-stretch-sid\r\ndistro        : #112-Ubuntu SMP Thu Jan 9 11:27:02 UTC 2020\r\nconda env     : srs\r\npython        : /home/ubuntu/.local/share/virtualenvs/srs-DkOf0qi1/bin/python\r\nsys.path      : /home/ubuntu/srs/notebooks/models\r\n/home/ubuntu/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/_pdbpp_path_hack\r\n/home/ubuntu/src/cntk/bindings/python\r\n/home/ubuntu/anaconda3/envs/srs/lib/python37.zip\r\n/home/ubuntu/anaconda3/envs/srs/lib/python3.7\r\n/home/ubuntu/anaconda3/envs/srs/lib/python3.7/lib-dynload\r\n\r\n/home/ubuntu/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages\r\n/home/ubuntu/.local/share/virtualenvs/srs-DkOf0qi1/lib/python3.7/site-packages/IPython/extensions\r\n/home/ubuntu/.ipython\r\n```\r\n\r\n**To Reproduce**\r\nIn any environment:\r\n\r\n```python\r\nimport fastai.metrics as fmet\r\nprint(fmet.MultiLabelFbeta())\r\n```\r\n\r\nI think we could add a test that simply tests each callback's string representation is valid (i.e., does not raise an `AttributeError`).\r\n\r\n**Expected behavior**\r\nI expect callbacks to have a standard string representation. This bug was initially raised after fitting a model, which was unfortunate.\r\n\r\n**Screenshots**\r\nN/A.\r\n\r\n**Additional context**\r\nI've reproduced this bug both on Ubuntu (logs above) and macOS (locally).", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2493", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2493/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2493/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2493/events", "html_url": "https://github.com/fastai/fastai/issues/2493", "id": 565860582, "node_id": "MDU6SXNzdWU1NjU4NjA1ODI=", "number": 2493, "title": "Load DataSet Slow GTX1050Ti", "user": {"login": "Suaig", "id": 24272990, "node_id": "MDQ6VXNlcjI0MjcyOTkw", "avatar_url": "https://avatars3.githubusercontent.com/u/24272990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Suaig", "html_url": "https://github.com/Suaig", "followers_url": "https://api.github.com/users/Suaig/followers", "following_url": "https://api.github.com/users/Suaig/following{/other_user}", "gists_url": "https://api.github.com/users/Suaig/gists{/gist_id}", "starred_url": "https://api.github.com/users/Suaig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Suaig/subscriptions", "organizations_url": "https://api.github.com/users/Suaig/orgs", "repos_url": "https://api.github.com/users/Suaig/repos", "events_url": "https://api.github.com/users/Suaig/events{/privacy}", "received_events_url": "https://api.github.com/users/Suaig/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-16T06:41:16Z", "updated_at": "2020-02-16T14:34:25Z", "closed_at": "2020-02-16T14:34:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nBUG is about train when program load data.\r\nload data is very slow.I say that training is divided into three parts.\r\npart1:LoadData is use 50 sec\r\npart2:GPU train model,use about 55 sec\r\npart3:vaild (Load,and predic) LoadData slow too\r\n\r\nwhen i use 'paperspace'(a ML service https://www.paperspace.com/) .it work well.\r\nKeras is work too(USE GPU)\r\n\r\nquestion:why loaded dataset cost too many time in my PC.\r\n\r\nthinks FastAI team!\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\nInfo:\r\n```text\r\n=== Software === \r\npython        : 3.6.7\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 442.19\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7501 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 4096MB | GeForce GTX 1050 Ti\r\n\r\n=== Environment === \r\nplatform      : Windows-10-10.0.18362-SP0\r\nconda env     : pytroch_py36_env\r\npython        : C:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\python.exe\r\nsys.path      : C:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\python36.zip\r\nC:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\DLLs\r\nC:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\lib\r\nC:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\r\n\r\nC:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\lib\\site-packages\r\nC:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\lib\\site-packages\\win32\r\nC:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\lib\\site-packages\\win32\\lib\r\nC:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\lib\\site-packages\\Pythonwin\r\nC:\\ProgramData\\Anaconda3\\envs\\pytroch_py36_env\\lib\\site-packages\\IPython\\extensions\r\nC:\\Users\\MY\\.ipython\r\n```\r\n\r\nPlease make sure to include opening/closing ``` when you paste into forums/github to make the reports appear formatted as code sections.\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\nUSE GTX1050TI when Train.\r\nWin10 1909 workstation\r\nPython 3.6.5 CUDATOOL 10.2 \r\n<!-- A gist to reproduce it is even better!-->\r\n\r\n\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n![pg1](https://user-images.githubusercontent.com/24272990/74600278-f65a8f00-50c9-11ea-96fa-8ff3af6990da.jpg)\r\n![pg2](https://user-images.githubusercontent.com/24272990/74600280-f9ee1600-50c9-11ea-91d9-bb9d2417e24e.jpg)\r\nIt use 50S to loaddata Then train\r\n![p3](https://user-images.githubusercontent.com/24272990/74600289-433e6580-50ca-11ea-8cf7-8a70b073f39a.jpg)\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2491", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2491/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2491/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2491/events", "html_url": "https://github.com/fastai/fastai/issues/2491", "id": 565150092, "node_id": "MDU6SXNzdWU1NjUxNTAwOTI=", "number": 2491, "title": "Different order of Items for data.test_dl.items in Linux and Windows Environment", "user": {"login": "rdutta1999", "id": 40257378, "node_id": "MDQ6VXNlcjQwMjU3Mzc4", "avatar_url": "https://avatars0.githubusercontent.com/u/40257378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rdutta1999", "html_url": "https://github.com/rdutta1999", "followers_url": "https://api.github.com/users/rdutta1999/followers", "following_url": "https://api.github.com/users/rdutta1999/following{/other_user}", "gists_url": "https://api.github.com/users/rdutta1999/gists{/gist_id}", "starred_url": "https://api.github.com/users/rdutta1999/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rdutta1999/subscriptions", "organizations_url": "https://api.github.com/users/rdutta1999/orgs", "repos_url": "https://api.github.com/users/rdutta1999/repos", "events_url": "https://api.github.com/users/rdutta1999/events{/privacy}", "received_events_url": "https://api.github.com/users/rdutta1999/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-14T07:19:49Z", "updated_at": "2020-02-14T14:07:02Z", "closed_at": "2020-02-14T14:07:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n```data.test_dl.items``` returns the items in different order when tested in both Linux and Windows environments.\r\n[```data``` is an ```ImageDataBunch```,  Fastai version = ```1.0.60``` ]\r\n\r\n**Provide your installation details**\r\nFor Windows: \r\n```text\r\n=== Software === \r\npython        : 3.7.4\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 442.19\r\ntorch cuda    : 10.1 / is available\r\ntorch cudnn   : 7501 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 8192MB | GeForce RTX 2060 SUPER\r\n\r\n=== Environment === \r\nplatform      : Windows-10-10.0.18362-SP0\r\nconda env     : fastaienv\r\npython        : C:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\python.exe\r\nsys.path      : D:\\cactus\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\python37.zip\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\DLLs\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\lib\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\r\n\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\lib\\site-packages\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\lib\\site-packages\\win32\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\lib\\site-packages\\win32\\lib\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\lib\\site-packages\\Pythonwin\r\nC:\\Users\\RAJDEEP\\Anaconda\\Anaconda3\\envs\\fastaienv\\lib\\site-packages\\IPython\\extensions\r\nC:\\Users\\RAJDEEP\\.ipython\r\n```\r\nFor Linux (Kaggle Kernel)\r\n```text\r\n=== Software === \r\npython        : 3.6.6\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\ntorch cuda    : 10.0 / is available\r\ntorch cudnn   : 7603 / is enabled\r\n\r\n=== Hardware === \r\ntorch devices : 1\r\n  - gpu0      : Tesla P100-PCIE-16GB\r\n\r\n=== Environment === \r\nplatform      : Linux-4.19.87+-x86_64-with-debian-9.9\r\ndistro        : #1 SMP Mon Feb 10 22:35:42 PST 2020\r\nconda env     : Unknown\r\npython        : /opt/conda/bin/python\r\nsys.path      : /kaggle/lib/kagglegym\r\n/kaggle/lib\r\n/kaggle/input/aerial-cactus-identification\r\n/opt/conda/lib/python36.zip\r\n/opt/conda/lib/python3.6\r\n/opt/conda/lib/python3.6/lib-dynload\r\n\r\n/root/.local/lib/python3.6/site-packages\r\n/opt/conda/lib/python3.6/site-packages\r\n/opt/conda/lib/python3.6/site-packages/nolearn-0.6.2.dev0-py3.6.egg\r\n/opt/conda/lib/python3.6/site-packages/tabulate-0.8.6-py3.6.egg\r\n/opt/conda/lib/python3.6/site-packages/PyBrain-0.3.3-py3.6.egg\r\n/opt/conda/lib/python3.6/site-packages/python_Levenshtein-0.12.0-py3.6-linux-x86_64.egg\r\n/opt/conda/lib/python3.6/site-packages/pyeconometrics-1.0.2-py3.6.egg\r\n/src/bq-helper\r\n/opt/conda/lib/python3.6/site-packages/IPython/extensions\r\n/root/.ipython\r\nno nvidia-smi is found\r\n```\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n```\r\ndata = ImageDataBunch.from_csv(path = \".\",\r\n                               folder = \"train/train/\",\r\n                               csv_labels = \"train.csv\",\r\n                               seed = 42,\r\n                               test = \"test/test/\",\r\n                               bs = 512,\r\n                               ds_tfms = get_transforms(),\r\n                               size = 32,\r\n                               num_workers = 6).normalize(imagenet_stats)\r\n```\r\nThen we train and finetune the model, followed by predicting the Test Data.\r\n```\r\ntest_preds, _ = learn.get_preds(DatasetType.Test)\r\n```\r\nIn order to get the Filenames, \r\n```\r\ntest_files = data.test_dl.items\r\ntest_files\r\n```\r\n\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\nIt seems that the ```test_files``` for Windows are sorted by the alphabetical order, whereas for Linux, they are random. Performing inference on test_data should take batches of test_data randomly, and I feel that the Linux version is correct while the Windows one isn't.\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\nFor Windows,\r\n![image](https://user-images.githubusercontent.com/40257378/74509585-e4d98180-4f27-11ea-9500-bea0c400295a.png)\r\n\r\nFor Linux,\r\n![image](https://user-images.githubusercontent.com/40257378/74509616-f9b61500-4f27-11ea-8121-e4012d5d7c27.png)\r\n\r\n\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2490", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2490/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2490/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2490/events", "html_url": "https://github.com/fastai/fastai/issues/2490", "id": 564872886, "node_id": "MDU6SXNzdWU1NjQ4NzI4ODY=", "number": 2490, "title": "download_images does not filter empty strings", "user": {"login": "ozgurshn", "id": 2404074, "node_id": "MDQ6VXNlcjI0MDQwNzQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/2404074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ozgurshn", "html_url": "https://github.com/ozgurshn", "followers_url": "https://api.github.com/users/ozgurshn/followers", "following_url": "https://api.github.com/users/ozgurshn/following{/other_user}", "gists_url": "https://api.github.com/users/ozgurshn/gists{/gist_id}", "starred_url": "https://api.github.com/users/ozgurshn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ozgurshn/subscriptions", "organizations_url": "https://api.github.com/users/ozgurshn/orgs", "repos_url": "https://api.github.com/users/ozgurshn/repos", "events_url": "https://api.github.com/users/ozgurshn/events{/privacy}", "received_events_url": "https://api.github.com/users/ozgurshn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-02-13T18:32:33Z", "updated_at": "2020-02-15T15:07:35Z", "closed_at": "2020-02-15T15:07:35Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\ndownload_images method does not filter the empty strings after reading the CSV file and splitting into lines array. I don't know whether it should be solved when creating CSV but I fixed it by filtering the string array in my fork https://github.com/ozgurshn/fastai/commits/master. Should I send a PR for this fix?\r\n\r\nit originates from this line \r\nhttps://github.com/fastai/fastai/blob/ac46636d156639716b2f88feb21c31aac8be6695/fastai/vision/data.py#L194\r\n\r\nChanging this to filtering as below will fix this issue.\r\nurls = list(filter(None, open(urls).read().strip().split(\"\\n\")))[:max_pics]\r\n\r\n**Provide your installation details**\r\n```text\r\n=== Software === \r\npython       : 3.6.9\r\nfastai       : 1.0.60\r\nfastprogress : 0.2.2\r\ntorch        : 1.4.0\r\ntorch cuda   : 10.1 / is **Not available** \r\n\r\n=== Hardware === \r\nNo GPUs available \r\n\r\n=== Environment === \r\nplatform     : Linux-4.14.137+-x86_64-with-Ubuntu-18.04-bionic\r\ndistro       : #1 SMP Thu Aug 8 02:47:02 PDT 2019\r\nconda env    : Unknown\r\npython       : /usr/bin/python3\r\nsys.path     : \r\n/env/python\r\n/usr/lib/python36.zip\r\n/usr/lib/python3.6\r\n/usr/lib/python3.6/lib-dynload\r\n/usr/local/lib/python3.6/dist-packages\r\n/usr/lib/python3/dist-packages\r\n/usr/local/lib/python3.6/dist-packages/IPython/extensions\r\n/root/.ipython\r\nno supported gpus found on this system\r\n```\r\n\r\n**To Reproduce**\r\n1) Create CSV file of Google images that contain at leasn one empty link ('').\r\n2) use download_images for your CSV \r\n`download_images('download (8).csv',dest='images2',max_workers=0)\r\n`\r\n**Expected behavior**\r\nDownloading without showing any error\r\n\r\n**Screenshots**\r\n<img width=\"736\" alt=\"Screen Shot 2020-02-13 at 21 30 19\" src=\"https://user-images.githubusercontent.com/2404074/74466330-05fa8d80-4ea8-11ea-9931-b79ee4747f79.png\">\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2489", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2489/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2489/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2489/events", "html_url": "https://github.com/fastai/fastai/issues/2489", "id": 564456918, "node_id": "MDU6SXNzdWU1NjQ0NTY5MTg=", "number": 2489, "title": "Tokenizer Multiprocessing Hang", "user": {"login": "rothn", "id": 4665783, "node_id": "MDQ6VXNlcjQ2NjU3ODM=", "avatar_url": "https://avatars3.githubusercontent.com/u/4665783?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rothn", "html_url": "https://github.com/rothn", "followers_url": "https://api.github.com/users/rothn/followers", "following_url": "https://api.github.com/users/rothn/following{/other_user}", "gists_url": "https://api.github.com/users/rothn/gists{/gist_id}", "starred_url": "https://api.github.com/users/rothn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rothn/subscriptions", "organizations_url": "https://api.github.com/users/rothn/orgs", "repos_url": "https://api.github.com/users/rothn/repos", "events_url": "https://api.github.com/users/rothn/events{/privacy}", "received_events_url": "https://api.github.com/users/rothn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-13T05:52:57Z", "updated_at": "2020-02-13T17:26:49Z", "closed_at": "2020-02-13T14:57:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\nFastAI's multiprocessing Tokenizer hangs when tokenizing a text corpus (982619 documents with an average length of just over 100 tokens, counted by my own single-process tokenizer.\r\n\r\n**Provide your installation details**\r\n```\r\n=== Software ===\r\npython       : 3.7.3\r\nfastai       : 1.0.60\r\nfastprogress : 0.2.2\r\ntorch        : 1.3.0\r\ntorch cuda   : 10.1.243 / is **Not available**\r\n\r\n=== Hardware ===\r\nNo GPUs available\r\n\r\n=== Environment ===\r\nplatform     : Linux-4.4.0-17763-Microsoft-x86_64-with-Ubuntu-18.04-bionic\r\ndistro       : #864-Microsoft Thu Nov 07 15:22:00 PST 2019\r\nconda env    : Unknown\r\npython       : /home/nroth/ml_python/bin/python\r\nsys.path     : /home/nroth\r\n/usr/lib/python37.zip\r\n/usr/lib/python3.7\r\n/usr/lib/python3.7/lib-dynload\r\n/home/nroth/ml_python/lib/python3.7/site-packages\r\nno supported gpus found on this system\r\n```\r\n\r\nI looked through the commits since the last release and none of them seemed relevant to this issue.\r\n\r\n**To Reproduce**\r\n\r\n1. Load a text corpus like my proprietary one (982619 documents with an average length of just over 100 tokens) in Ubuntu on Windows\r\n2. Run `[Tokenizer(n_cpus=8).process_all(review_class) for review_class in reviews_by_class]`\r\n3. Observe the hang\r\n\r\n**Expected behavior**\r\nThis should not hang. It should complete eventually, ideally faster than a single-process tokenizer.\r\n\r\n**Screenshots**\r\nThe tokenizer hangs...\r\n![hung_tokenizer](https://user-images.githubusercontent.com/4665783/74405301-a0dc6480-4de1-11ea-85b6-ee488bfc7452.png)\r\n\r\nThe one active process appears merely to be waiting on workers...\r\n![running_proc_stack](https://user-images.githubusercontent.com/4665783/74405423-e0a34c00-4de1-11ea-84d4-9a82abacb808.png)\r\n\r\n**Additional context**\r\nThis was observed using Ubuntu on Windows, but I have a good reason for using it.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2488", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2488/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2488/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2488/events", "html_url": "https://github.com/fastai/fastai/issues/2488", "id": 563018522, "node_id": "MDU6SXNzdWU1NjMwMTg1MjI=", "number": 2488, "title": "not able to import * from fastai.vision in Google collab", "user": {"login": "akashkumar398", "id": 24894328, "node_id": "MDQ6VXNlcjI0ODk0MzI4", "avatar_url": "https://avatars3.githubusercontent.com/u/24894328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akashkumar398", "html_url": "https://github.com/akashkumar398", "followers_url": "https://api.github.com/users/akashkumar398/followers", "following_url": "https://api.github.com/users/akashkumar398/following{/other_user}", "gists_url": "https://api.github.com/users/akashkumar398/gists{/gist_id}", "starred_url": "https://api.github.com/users/akashkumar398/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akashkumar398/subscriptions", "organizations_url": "https://api.github.com/users/akashkumar398/orgs", "repos_url": "https://api.github.com/users/akashkumar398/repos", "events_url": "https://api.github.com/users/akashkumar398/events{/privacy}", "received_events_url": "https://api.github.com/users/akashkumar398/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-11T07:20:37Z", "updated_at": "2020-02-11T18:26:11Z", "closed_at": "2020-02-11T18:26:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\n**Describe the bug**\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n**Provide your installation details**\r\n<!-- We need to have some background to know how to fix your bug. -->\r\n<!-- Copy-n-paste the output of `show_install`, by either running this cell in jupyter notebook:\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\nor via your shell:\r\n```\r\npython -m fastai.utils.show_install\r\n```\r\nDouble-check you use the latest version which you can find here: https://github.com/fastai/fastai/releases.\r\n\r\nIt's also possible that the issue has already been fixed in git master, but hasn't been released yet, so if possible please try to see whether git master has it resolved. To install the git master do: `pip install git+https://github.com/fastai/fastai/`\r\n-->\r\n\r\n**To Reproduce**\r\n<!-- Steps to reproduce the behavior. Please give us a reproducible example so we can fix your bug.-->\r\n<!-- A gist to reproduce it is even better!-->\r\n<!-- If possible please add a new test for https://github.com/fastai/fastai/tree/master/tests/ that helps us reproduce the problem and will help with future regression testing. See https://docs.fast.ai/dev/test.html for details on how to run/write tests. -->\r\n\r\n**Expected behavior**\r\n<!-- A clear and concise description of what you expected to happen. -->\r\n\r\n**Screenshots**\r\n<!-- If applicable, add screenshots to help demonstrate your problem. -->\r\n\r\n**Additional context**\r\n<!-- Add any other context about the problem here. -->\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2485", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2485/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2485/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2485/events", "html_url": "https://github.com/fastai/fastai/issues/2485", "id": 559709665, "node_id": "MDU6SXNzdWU1NTk3MDk2NjU=", "number": 2485, "title": "Make lr_find() usable in a distributed data parallel mode, a  step towards enabling notebook to run distributed training.", "user": {"login": "philtrade", "id": 19887230, "node_id": "MDQ6VXNlcjE5ODg3MjMw", "avatar_url": "https://avatars0.githubusercontent.com/u/19887230?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philtrade", "html_url": "https://github.com/philtrade", "followers_url": "https://api.github.com/users/philtrade/followers", "following_url": "https://api.github.com/users/philtrade/following{/other_user}", "gists_url": "https://api.github.com/users/philtrade/gists{/gist_id}", "starred_url": "https://api.github.com/users/philtrade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philtrade/subscriptions", "organizations_url": "https://api.github.com/users/philtrade/orgs", "repos_url": "https://api.github.com/users/philtrade/repos", "events_url": "https://api.github.com/users/philtrade/events{/privacy}", "received_events_url": "https://api.github.com/users/philtrade/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-04T13:10:23Z", "updated_at": "2020-02-12T14:32:07Z", "closed_at": "2020-02-12T14:32:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In the process of building a tool to facilitate distributed training + `fastai v1` in Jupyter notebook, I realized `lr_find()` doesn't work in distributed mode, and it doesn't need a distributed learner to work either.\r\n\r\nAlthough I got it to work by dynamically intercepting`Learner.lr_find()`, I have distilled that monkey wrench/patch down to a backward compatible, fairly simple change.  I'd like to submit it here for your consideration.\r\n\r\nThe net outcome is that: one can use a Learner which had been `to_distributed()`,  and run `lr_find()` on it without any complication.  It is a beneficial feature to fastai's Jupyter notebook users, IMHO.\r\n\r\nIf it pleases you, I'll be happy to submit a PR, and help porting it over to `fastai v2` as well, so that `fastai v2` lesson notebooks will be *distributed-training ready* early on, a feature that was asked and answered \"no\" many times for `fastai v1`.\r\n\r\nThe change takes 2 steps:\r\n\r\n1. Only allows the master proc (rank 0) to run `lr_find()`, like how `basic_train.save()` does it, other GPUs aren't helpful anyway to this training run, are they?\r\n\r\n2. Temporarily take the `learner` out of the distributed mode, do the usual `lr_find()` dance, and restore it back to the distributed condition afterwards.\r\n\r\nBelow is the diff, I have tested it *with and without distributed training, with one GPU or multiple GPUs DDP*.  Comments are welcome!  I'll be formalize it into a PR if it's acceptable to you. \r\n\r\n* [\"The diff for *Temporarily suspend distributed mode when doing lr_find*\"](https://github.com/fastai/fastai/compare/master...philtrade:master?diff=split)\r\n\r\nThank you.\r\n\r\nNote: [1]. the reason DDP doesn't play well for `lr_find()` is that, the multiple GPUs each trains on its own and may early-stop at different batches, causing spurious deadlocks, as the earlier quitters and late comers wait for each other at different rendezvous points.  Hence the above solution.\r\n[2]  The tool I built, [The iPython extension `Ddip`](https://github.com/philtrade/Ddip), which I intend to add support to `fastai v2` soon, and would love to contribute it to  the evolving `fastai` code base.\r\n\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2481", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2481/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2481/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2481/events", "html_url": "https://github.com/fastai/fastai/issues/2481", "id": 558297438, "node_id": "MDU6SXNzdWU1NTgyOTc0Mzg=", "number": 2481, "title": "Minor documentation update (performance.md)", "user": {"login": "celynwalters", "id": 3299161, "node_id": "MDQ6VXNlcjMyOTkxNjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/3299161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/celynwalters", "html_url": "https://github.com/celynwalters", "followers_url": "https://api.github.com/users/celynwalters/followers", "following_url": "https://api.github.com/users/celynwalters/following{/other_user}", "gists_url": "https://api.github.com/users/celynwalters/gists{/gist_id}", "starred_url": "https://api.github.com/users/celynwalters/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/celynwalters/subscriptions", "organizations_url": "https://api.github.com/users/celynwalters/orgs", "repos_url": "https://api.github.com/users/celynwalters/repos", "events_url": "https://api.github.com/users/celynwalters/events{/privacy}", "received_events_url": "https://api.github.com/users/celynwalters/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-31T18:27:27Z", "updated_at": "2020-02-03T14:43:00Z", "closed_at": "2020-02-03T14:43:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "This relates to [docs/performance.md](https://github.com/fastai/fastai/blob/ed3635d17a52af7ead2805b802f20b99fa7a7b28/docs/performance.md) (and I hope this affects the [documentation webpage](https://docs.fast.ai/performance.html))\r\n\r\nSince (I believe) version 7.0.0, Pillow has a different command.\r\n\r\n```bash\r\npython -c \"from PIL import Image; print(Image.PILLOW_VERSION)\"\r\n3.2.0.post3\r\n```\r\n\r\nis now:\r\n\r\n```bash\r\npython -c \"from PIL import Image; print(Image.__version__)\"\r\n7.0.0.post3\r\n```\r\n\r\nThe rest of the `Pillow-SIMD` instructions seem to be correct.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2480", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2480/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2480/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2480/events", "html_url": "https://github.com/fastai/fastai/issues/2480", "id": 557341397, "node_id": "MDU6SXNzdWU1NTczNDEzOTc=", "number": 2480, "title": "Fastai and Pytorch 1.4.0 incompatibility when using `load learner`", "user": {"login": "Ari-Ramkilowan", "id": 33620500, "node_id": "MDQ6VXNlcjMzNjIwNTAw", "avatar_url": "https://avatars3.githubusercontent.com/u/33620500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ari-Ramkilowan", "html_url": "https://github.com/Ari-Ramkilowan", "followers_url": "https://api.github.com/users/Ari-Ramkilowan/followers", "following_url": "https://api.github.com/users/Ari-Ramkilowan/following{/other_user}", "gists_url": "https://api.github.com/users/Ari-Ramkilowan/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ari-Ramkilowan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ari-Ramkilowan/subscriptions", "organizations_url": "https://api.github.com/users/Ari-Ramkilowan/orgs", "repos_url": "https://api.github.com/users/Ari-Ramkilowan/repos", "events_url": "https://api.github.com/users/Ari-Ramkilowan/events{/privacy}", "received_events_url": "https://api.github.com/users/Ari-Ramkilowan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-30T08:38:09Z", "updated_at": "2020-01-30T15:34:32Z", "closed_at": "2020-01-30T15:34:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nHi there. I've read through the relevant portion of the docs and I have searched through the forums but haven't been able to find a solution to the error I'm getting.\r\n\r\n**Bug Description**\r\n\r\n\r\nI get `AttributeError: 'LSTM' object has no attribute '_flat_weights_names'` when loading a pretrained language model/fine tuned classifier using `load_learner`\r\n\r\nInstallation details provided below\r\n\r\n\r\n**Installation deets**\r\n```text\r\n=== Software === \r\npython        : 3.6.9\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.4.0\r\nnvidia driver : 440.48\r\ntorch cuda    : 10.1 / is **Not available** \r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\nHave 1 GPU(s), but torch can't use them (check nvidia driver) \r\n\r\n=== Environment === \r\nplatform      : Linux-5.3.0-26-generic-x86_64-with-debian-buster-sid\r\ndistro        : #28~18.04.1-Ubuntu SMP Wed Dec 18 16:40:14 UTC 2019\r\nconda env     : feersum_nlu\r\npython        : /home/ari/anaconda3/envs/feersum_nlu/bin/python\r\nsys.path      : \r\n/home/ari/anaconda3/envs/feersum_nlu/lib/python36.zip\r\n/home/ari/anaconda3/envs/feersum_nlu/lib/python3.6\r\n/home/ari/anaconda3/envs/feersum_nlu/lib/python3.6/lib-dynload\r\n/home/ari/.local/lib/python3.6/site-packages\r\n/home/ari/anaconda3/envs/feersum_nlu/lib/python3.6/site-packages\r\n/home/ari/.local/lib/python3.6/site-packages/IPython/extensions\r\n```\r\n\r\n**To Reproduce**\r\nI believe the error to be an incompatability with fastai and pytorch 1.4.0 so loading a pretrained LM or classifier with these versions will reproduce the error.\r\n\r\n**Screenshots**\r\nRelevant portion of stack trace given below\r\n\r\n![Screenshot from 2020-01-30 10-34-02](https://user-images.githubusercontent.com/33620500/73432923-64722880-434c-11ea-9e0e-bdc3a7745623.png)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2479", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2479/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2479/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2479/events", "html_url": "https://github.com/fastai/fastai/issues/2479", "id": 556938218, "node_id": "MDU6SXNzdWU1NTY5MzgyMTg=", "number": 2479, "title": "Documentation of ImageList.from_csv is missing", "user": {"login": "wAuner", "id": 18383180, "node_id": "MDQ6VXNlcjE4MzgzMTgw", "avatar_url": "https://avatars3.githubusercontent.com/u/18383180?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wAuner", "html_url": "https://github.com/wAuner", "followers_url": "https://api.github.com/users/wAuner/followers", "following_url": "https://api.github.com/users/wAuner/following{/other_user}", "gists_url": "https://api.github.com/users/wAuner/gists{/gist_id}", "starred_url": "https://api.github.com/users/wAuner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wAuner/subscriptions", "organizations_url": "https://api.github.com/users/wAuner/orgs", "repos_url": "https://api.github.com/users/wAuner/repos", "events_url": "https://api.github.com/users/wAuner/events{/privacy}", "received_events_url": "https://api.github.com/users/wAuner/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-29T15:30:08Z", "updated_at": "2020-02-03T14:40:26Z", "closed_at": "2020-02-03T14:40:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "The [documentation of ImageList](https://docs.fast.ai/vision.data.html#ImageList) does not list the method `from_csv`. It's used in the notebooks and it still is in the sourcecode:\r\n\r\nhttps://github.com/fastai/fastai/blob/ed3635d17a52af7ead2805b802f20b99fa7a7b28/fastai/vision/data.py#L292\r\n\r\nIs this an error in the documenation build process?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2477", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2477/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2477/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2477/events", "html_url": "https://github.com/fastai/fastai/issues/2477", "id": 556318631, "node_id": "MDU6SXNzdWU1NTYzMTg2MzE=", "number": 2477, "title": "Add skin cancer dataset", "user": {"login": "arp95", "id": 8268392, "node_id": "MDQ6VXNlcjgyNjgzOTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/8268392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arp95", "html_url": "https://github.com/arp95", "followers_url": "https://api.github.com/users/arp95/followers", "following_url": "https://api.github.com/users/arp95/following{/other_user}", "gists_url": "https://api.github.com/users/arp95/gists{/gist_id}", "starred_url": "https://api.github.com/users/arp95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arp95/subscriptions", "organizations_url": "https://api.github.com/users/arp95/orgs", "repos_url": "https://api.github.com/users/arp95/repos", "events_url": "https://api.github.com/users/arp95/events{/privacy}", "received_events_url": "https://api.github.com/users/arp95/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-28T16:19:24Z", "updated_at": "2020-02-11T19:34:26Z", "closed_at": "2020-02-11T19:34:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Please check the dataset here. \r\nTraining data: https://s3-us-west-1.amazonaws.com/udacity-dlnfd/datasets/skin-cancer/train.zip\r\nValidation data: https://s3-us-west-1.amazonaws.com/udacity-dlnfd/datasets/skin-cancer/valid.zip\r\n\r\nThe data is publicly available and this repo explains how to get the data:\r\nhttps://github.com/udacity/dermatologist-ai\r\n\r\nShould we add the skin cancer dataset in the URLs class of fastai? @sgugger please check.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2476", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2476/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2476/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2476/events", "html_url": "https://github.com/fastai/fastai/issues/2476", "id": 556315687, "node_id": "MDU6SXNzdWU1NTYzMTU2ODc=", "number": 2476, "title": "interp.plot_top_losses Attribute Error", "user": {"login": "LarsMS97", "id": 34573997, "node_id": "MDQ6VXNlcjM0NTczOTk3", "avatar_url": "https://avatars3.githubusercontent.com/u/34573997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LarsMS97", "html_url": "https://github.com/LarsMS97", "followers_url": "https://api.github.com/users/LarsMS97/followers", "following_url": "https://api.github.com/users/LarsMS97/following{/other_user}", "gists_url": "https://api.github.com/users/LarsMS97/gists{/gist_id}", "starred_url": "https://api.github.com/users/LarsMS97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LarsMS97/subscriptions", "organizations_url": "https://api.github.com/users/LarsMS97/orgs", "repos_url": "https://api.github.com/users/LarsMS97/repos", "events_url": "https://api.github.com/users/LarsMS97/events{/privacy}", "received_events_url": "https://api.github.com/users/LarsMS97/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-28T16:14:37Z", "updated_at": "2020-01-29T05:54:06Z", "closed_at": "2020-01-29T05:53:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\nIm currently on Lesson 1 of the fast.ai course, and the line \r\n\r\n`interp.plot_top_losses(9, figsize=(15,11))`\r\n\r\nis giving me the following error:\r\n\r\n```AttributeError                            Traceback (most recent call last)\r\n<ipython-input-44-34fc804e24e7> in <module>\r\n----> 1 interp.plot_top_losses(9, figsize=(15,11))\r\n\r\n/opt/conda/envs/fastai/lib/python3.6/site-packages/fastai/vision/learner.py in _cl_int_plot_top_losses(self, k, largest, figsize, heatmap, heatmap_thresh, alpha, cmap, show_text, return_fig)\r\n    174     if show_text: fig.suptitle('Prediction/Actual/Loss/Probability', weight='bold', size=14)\r\n    175     for i,idx in enumerate(tl_idx):\r\n--> 176         im,cl = self.data.dl(self.ds_type).dataset[idx]\r\n    177         cl = int(cl)\r\n    178         title = f'{classes[self.pred_class[idx]]}/{classes[cl]} / {self.losses[idx]:.2f} / {self.preds[idx][cl]:.2f}' if show_text else None\r\n\r\n/opt/conda/envs/fastai/lib/python3.6/site-packages/fastai/data_block.py in __getitem__(self, idxs)\r\n    647     def __getitem__(self,idxs:Union[int,np.ndarray])->'LabelList':\r\n    648         \"return a single (x, y) if `idxs` is an integer or a new `LabelList` object if `idxs` is a range.\"\r\n--> 649         idxs = try_int(idxs)\r\n    650         if isinstance(idxs, Integral):\r\n    651             if self.item is None: x,y = self.x[idxs],self.y[idxs]\r\n\r\n/opt/conda/envs/fastai/lib/python3.6/site-packages/fastai/torch_core.py in try_int(o)\r\n    365     \"Try to convert `o` to int, default to `o` if not possible.\"\r\n    366     # NB: single-item rank-1 array/tensor can be converted to int, but we don't want to do this\r\n--> 367     if isinstance(o, (np.ndarray,Tensor)): return o if o.ndim else int(o)\r\n    368     if isinstance(o, collections.Sized) or getattr(o,'__array_interface__',False): return o\r\n    369     try: return int(o)\r\n\r\nAttributeError: 'Tensor' object has no attribute 'ndim'\r\n```\r\n\r\nI made sure that I've run every previous cell by running the \"Run All\" command. \r\nI found a [related post](https://forums.fast.ai/t/lesson1-interp-plot-top-losses-attribute-error/62066) on the fast.ai forums to which no one has replied yet. The post also contains a screenshot.\r\n\r\nIm completely new to python so I don't know how to fix this yet. If this is easy to fix the lessons notebook should be changed accordingly.\r\n\r\n```\r\nfrom fastai.utils.show_install import *\r\nshow_install()\r\n```\r\n\r\noutputs this:\r\n\r\n```text\r\n=== Software === \r\npython        : 3.6.7\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.0.0\r\nnvidia driver : 418.67\r\ntorch cuda    : 9.0.176 / is available\r\ntorch cudnn   : 7401 / is enabled\r\n\r\n=== Hardware === \r\nnvidia gpus   : 1\r\ntorch devices : 1\r\n  - gpu0      : 8126MB | Quadro M4000\r\n\r\n=== Environment === \r\nplatform      : Linux-4.15.0-72-generic-x86_64-with-debian-stretch-sid\r\ndistro        : #81~16.04.1-Ubuntu SMP Tue Nov 26 16:34:21 UTC 2019\r\nconda env     : fastai\r\npython        : /opt/conda/envs/fastai/bin/python\r\nsys.path      : /opt/conda/envs/fastai/lib/python36.zip\r\n/opt/conda/envs/fastai/lib/python3.6\r\n/opt/conda/envs/fastai/lib/python3.6/lib-dynload\r\n\r\n/opt/conda/envs/fastai/lib/python3.6/site-packages\r\n/opt/conda/envs/fastai/lib/python3.6/site-packages/IPython/extensions\r\n/root/.ipython\r\n```\r\n\r\nThe jupyter notebook is running on a free Paperspace Account that was created this morning, so the fast.ai version is up-to-date.\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2474", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2474/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2474/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2474/events", "html_url": "https://github.com/fastai/fastai/issues/2474", "id": 555878768, "node_id": "MDU6SXNzdWU1NTU4Nzg3Njg=", "number": 2474, "title": "Adding signature to datapath4file method ", "user": {"login": "arp95", "id": 8268392, "node_id": "MDQ6VXNlcjgyNjgzOTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/8268392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arp95", "html_url": "https://github.com/arp95", "followers_url": "https://api.github.com/users/arp95/followers", "following_url": "https://api.github.com/users/arp95/following{/other_user}", "gists_url": "https://api.github.com/users/arp95/gists{/gist_id}", "starred_url": "https://api.github.com/users/arp95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arp95/subscriptions", "organizations_url": "https://api.github.com/users/arp95/orgs", "repos_url": "https://api.github.com/users/arp95/repos", "events_url": "https://api.github.com/users/arp95/events{/privacy}", "received_events_url": "https://api.github.com/users/arp95/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-27T22:45:09Z", "updated_at": "2020-01-28T15:12:59Z", "closed_at": "2020-01-28T15:12:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "As seen in the screenshot:\r\n![fastai2](https://user-images.githubusercontent.com/8268392/73220469-79707100-412c-11ea-9960-efa13d6b78ba.png)\r\n\r\nThe signature of filename is \"filename:str\" which I understood after going through the url2path and url2name functions. Should I change the signature and add \"filename:str\" in the code also?\r\nThe reason is while debugging I had to see the fastai documentation and understand the type of filename before I could debug the entire untar_data function.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2471", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2471/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2471/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2471/events", "html_url": "https://github.com/fastai/fastai/issues/2471", "id": 555300019, "node_id": "MDU6SXNzdWU1NTUzMDAwMTk=", "number": 2471, "title": "Bug in tutorial.data.html in docs folder", "user": {"login": "arp95", "id": 8268392, "node_id": "MDQ6VXNlcjgyNjgzOTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/8268392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arp95", "html_url": "https://github.com/arp95", "followers_url": "https://api.github.com/users/arp95/followers", "following_url": "https://api.github.com/users/arp95/following{/other_user}", "gists_url": "https://api.github.com/users/arp95/gists{/gist_id}", "starred_url": "https://api.github.com/users/arp95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arp95/subscriptions", "organizations_url": "https://api.github.com/users/arp95/orgs", "repos_url": "https://api.github.com/users/arp95/repos", "events_url": "https://api.github.com/users/arp95/events{/privacy}", "received_events_url": "https://api.github.com/users/arp95/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-26T22:50:28Z", "updated_at": "2020-01-27T22:34:14Z", "closed_at": "2020-01-27T22:34:14Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nAs shown in the screenshot, the accuracy obtained with resnet18 was around 91% but written as 74%.\r\n\r\n**Expected behavior**\r\nUpdate the accuracy number in the html file from 74% to 91%.\r\n\r\n**Screenshots**\r\n![fastai](https://user-images.githubusercontent.com/8268392/73143124-4ebae580-4064-11ea-82c1-9b77ac6fcdec.png)\r\n\r\nCan I submit a pr concerning this?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2468", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2468/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2468/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2468/events", "html_url": "https://github.com/fastai/fastai/issues/2468", "id": 554298489, "node_id": "MDU6SXNzdWU1NTQyOTg0ODk=", "number": 2468, "title": "tabular_learner when using TabularList produces ZeroDivisionError", "user": {"login": "maxmatical", "id": 8890262, "node_id": "MDQ6VXNlcjg4OTAyNjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/8890262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maxmatical", "html_url": "https://github.com/maxmatical", "followers_url": "https://api.github.com/users/maxmatical/followers", "following_url": "https://api.github.com/users/maxmatical/following{/other_user}", "gists_url": "https://api.github.com/users/maxmatical/gists{/gist_id}", "starred_url": "https://api.github.com/users/maxmatical/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maxmatical/subscriptions", "organizations_url": "https://api.github.com/users/maxmatical/orgs", "repos_url": "https://api.github.com/users/maxmatical/repos", "events_url": "https://api.github.com/users/maxmatical/events{/privacy}", "received_events_url": "https://api.github.com/users/maxmatical/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-23T17:25:57Z", "updated_at": "2020-01-23T20:22:07Z", "closed_at": "2020-01-23T20:22:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Installation **\r\n```\r\n=== Software === \r\npython        : 3.6.9\r\nfastai        : 1.0.60\r\nfastprogress  : 0.2.2\r\ntorch         : 1.3.1\r\n```\r\n\r\nWhen using\r\n```\r\ndata = (TabularList.from_df(df, path=path, procs=[FillMissing, Normalize],)\r\n                .split_by_idx(valid_idx)\r\n                .label_from_df(cols=dep_var) \r\n                .databunch(bs = 64))\r\n\r\nlearn = tabular_learner(data, layers=[200,100], metrics=accuracy)\r\n\r\n```\r\n\r\nReturns the following error\r\n```\r\n---------------------------------------------------------------------------\r\n\r\nZeroDivisionError                         Traceback (most recent call last)\r\n\r\n<ipython-input-11-667cf4ba6383> in <module>()\r\n----> 1 learn = tabular_learner(data, layers=[200,100])\r\n      2 # learn.fit_one_cycle(1, 1e-2)\r\n\r\n6 frames\r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/init.py in kaiming_uniform_(tensor, a, mode, nonlinearity)\r\n    314     fan = _calculate_correct_fan(tensor, mode)\r\n    315     gain = calculate_gain(nonlinearity, a)\r\n--> 316     std = gain / math.sqrt(fan)\r\n    317     bound = math.sqrt(3.0) * std  # Calculate uniform bounds from standard deviation\r\n    318     with torch.no_grad():\r\n\r\nZeroDivisionError: float division by zero\r\n```\r\n\r\nHowever this issue doesn't arise if using \r\n```\r\ndata = TabularDataBunch.from_df(path, df, dep_var, valid_idx=valid_idx, procs=procs, cat_names=cat_names)\r\n```\r\n\r\n**To Reproduce**\r\nI was able to reproduce the error with the example in the tabular data overview\r\n\r\n```\r\nfrom fastai.tabular import * \r\nfrom fastai import *\r\n\r\npath = untar_data(URLs.ADULT_SAMPLE)\r\ndf = pd.read_csv(path/'adult.csv')\r\n\r\nprocs = [FillMissing, Categorify, Normalize]\r\nvalid_idx = range(len(df)-2000, len(df))\r\n\r\ndep_var = 'salary'\r\ncat_names = ['workclass', 'education', 'marital-status', 'occupation', 'relationship', 'race', 'sex', 'native-country']\r\n\r\ndata = (TabularList.from_df(df, path=path, procs=procs,)\r\n                .split_by_idx(valid_idx)\r\n                .label_from_df(cols='salary') \r\n                .databunch(bs = 64))\r\n\r\n# data = TabularDataBunch.from_df(path, df, dep_var, valid_idx=valid_idx, procs=procs, cat_names=cat_names)\r\n\r\nlearn = tabular_learner(data, layers=[200,100])\r\n\r\n```\r\n\r\nWhere the error only occurs when I use the datablock method instead of the `TabularDataBunch`\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/fastai/fastai/issues/2467", "repository_url": "https://api.github.com/repos/fastai/fastai", "labels_url": "https://api.github.com/repos/fastai/fastai/issues/2467/labels{/name}", "comments_url": "https://api.github.com/repos/fastai/fastai/issues/2467/comments", "events_url": "https://api.github.com/repos/fastai/fastai/issues/2467/events", "html_url": "https://github.com/fastai/fastai/issues/2467", "id": 554261498, "node_id": "MDU6SXNzdWU1NTQyNjE0OTg=", "number": 2467, "title": "Default norm_type in unet_learner", "user": {"login": "omriKramer", "id": 19272425, "node_id": "MDQ6VXNlcjE5MjcyNDI1", "avatar_url": "https://avatars3.githubusercontent.com/u/19272425?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omriKramer", "html_url": "https://github.com/omriKramer", "followers_url": "https://api.github.com/users/omriKramer/followers", "following_url": "https://api.github.com/users/omriKramer/following{/other_user}", "gists_url": "https://api.github.com/users/omriKramer/gists{/gist_id}", "starred_url": "https://api.github.com/users/omriKramer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omriKramer/subscriptions", "organizations_url": "https://api.github.com/users/omriKramer/orgs", "repos_url": "https://api.github.com/users/omriKramer/repos", "events_url": "https://api.github.com/users/omriKramer/events{/privacy}", "received_events_url": "https://api.github.com/users/omriKramer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-23T16:20:15Z", "updated_at": "2020-01-23T17:30:56Z", "closed_at": "2020-01-23T17:30:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- BEFORE POSTING AN ISSUE PLEASE MAKE SURE TO READ: https://docs.fast.ai/support.html -->\r\n\r\n<!-- **Important:** We try our best to fix all reported issue. The main difficulty we have is not being able to read your mind. If you don't follow the steps below, we have to follow up asking you to supply the required information, but we have already asked you to do so, so please don't waste our time and yours and supply it in first place. If you don't, your issue will be closed. You are free to resubmit this time with the required information. Thank you for helping us help you. -->\r\n\r\n<!-- **Please note**:\r\n- Installation issues should be reported here:\r\n\r\nfastai-1.0.x: http://forums.fast.ai/t/fastai-v1-install-issues-thread/24111\r\nfastai-0.7.x: http://forums.fast.ai/t/fastai-v0-install-issues-thread/24652\r\n\r\n- fastai github Issues are only for bugs in the library. If you want to suggest a new feature please use https://forums.fast.ai/t/fastai-v1-adding-features/23041. If you're unsure whether your bug comes from your code or the library, please use the forums to discuss your code first, then file an issue if needed.\r\n-->\r\n\r\nHi,\r\n\r\nI noticed that the default value of `norm_type` in the signature of `unet_learner` is `NormType`.\r\nShouldn't it be `NormType.Batch` or `None` or maybe one of the other options?", "performed_via_github_app": null, "score": 1.0}]}