{"total_count": 12, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/glenfant/stopit/issues/19", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/19/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/19/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/19/events", "html_url": "https://github.com/glenfant/stopit/issues/19", "id": 403575923, "node_id": "MDU6SXNzdWU0MDM1NzU5MjM=", "number": 19, "title": "Block does not stop after timeout", "user": {"login": "nmagerko", "id": 3152067, "node_id": "MDQ6VXNlcjMxNTIwNjc=", "avatar_url": "https://avatars3.githubusercontent.com/u/3152067?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nmagerko", "html_url": "https://github.com/nmagerko", "followers_url": "https://api.github.com/users/nmagerko/followers", "following_url": "https://api.github.com/users/nmagerko/following{/other_user}", "gists_url": "https://api.github.com/users/nmagerko/gists{/gist_id}", "starred_url": "https://api.github.com/users/nmagerko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nmagerko/subscriptions", "organizations_url": "https://api.github.com/users/nmagerko/orgs", "repos_url": "https://api.github.com/users/nmagerko/repos", "events_url": "https://api.github.com/users/nmagerko/events{/privacy}", "received_events_url": "https://api.github.com/users/nmagerko/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-27T17:41:57Z", "updated_at": "2019-02-04T10:38:20Z", "closed_at": "2019-02-04T10:38:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using version 1.1.2 with Python 3.7. \r\n\r\nMy goal is to use this module to wrap a call to the Python Docker SDK's `wait` function so that I can determine whether a container finishes executing within a timeout, and kill the container if it continues executing beyond that timeout. \r\n\r\nI have code that looks like this:\r\n\r\n```python\r\ncontainer =  # ... a detached docker container\r\nwith stopit.ThreadingTimeout(10) as timeout_ctx:\r\n    assert timeout_ctx.state == timeout_ctx.EXECUTING\r\n    container.wait()  # blocking call\r\n\r\nif timeout_ctx.state == timeout_ctx.EXECUTED:\r\n  print(\"Executed within timeout\")\r\nelif timeout_ctx.state == timeout_ctx.TIMED_OUT:\r\n  print(\"Executed beyond timeout\")\r\n```\r\n\r\nFor containers that run beyond the (10 second) timeout above, I see `Executed beyond timeout` as I'd expect. However, the `wait()` call continues blocking until the container finishes (which could be much more time than 10 seconds).\r\n\r\nIs this expected behavior? ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/18", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/18/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/18/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/18/events", "html_url": "https://github.com/glenfant/stopit/issues/18", "id": 377366739, "node_id": "MDU6SXNzdWUzNzczNjY3Mzk=", "number": 18, "title": "Question: stopit uses user time or wall time?", "user": {"login": "chengdi123000", "id": 10754664, "node_id": "MDQ6VXNlcjEwNzU0NjY0", "avatar_url": "https://avatars0.githubusercontent.com/u/10754664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chengdi123000", "html_url": "https://github.com/chengdi123000", "followers_url": "https://api.github.com/users/chengdi123000/followers", "following_url": "https://api.github.com/users/chengdi123000/following{/other_user}", "gists_url": "https://api.github.com/users/chengdi123000/gists{/gist_id}", "starred_url": "https://api.github.com/users/chengdi123000/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chengdi123000/subscriptions", "organizations_url": "https://api.github.com/users/chengdi123000/orgs", "repos_url": "https://api.github.com/users/chengdi123000/repos", "events_url": "https://api.github.com/users/chengdi123000/events{/privacy}", "received_events_url": "https://api.github.com/users/chengdi123000/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-05T11:52:27Z", "updated_at": "2018-11-08T12:27:08Z", "closed_at": "2018-11-08T12:27:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am wondering if the ThreadingTimeout a proper CPU resource cost measure. I want to control the timeout of a numerical simulation which should be regarded as wrong if it costs too much time. Normally it should be completed in less than one second. If the running time exceed 1 second, the parameter set might be wrong and it will never stop.\r\n\r\nHowever, AFAIK user time is used in thread rather than wall time. I am not sure what `stopit` is using to measure the timeout.\r\n\r\nAdditionally, part of CPU consuming algorithm of my simulation is written in cython. Will it be a problem if it do not release GIL?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/16", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/16/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/16/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/16/events", "html_url": "https://github.com/glenfant/stopit/issues/16", "id": 299638348, "node_id": "MDU6SXNzdWUyOTk2MzgzNDg=", "number": 16, "title": "TimeoutException is not raised if using subprocess", "user": {"login": "zastupailo", "id": 6131645, "node_id": "MDQ6VXNlcjYxMzE2NDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/6131645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zastupailo", "html_url": "https://github.com/zastupailo", "followers_url": "https://api.github.com/users/zastupailo/followers", "following_url": "https://api.github.com/users/zastupailo/following{/other_user}", "gists_url": "https://api.github.com/users/zastupailo/gists{/gist_id}", "starred_url": "https://api.github.com/users/zastupailo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zastupailo/subscriptions", "organizations_url": "https://api.github.com/users/zastupailo/orgs", "repos_url": "https://api.github.com/users/zastupailo/repos", "events_url": "https://api.github.com/users/zastupailo/events{/privacy}", "received_events_url": "https://api.github.com/users/zastupailo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-02-23T08:50:12Z", "updated_at": "2018-03-01T13:34:51Z", "closed_at": "2018-03-01T13:34:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using Tesseract as OCR engine to process some documents. However, I would like to restrict the time of execution for tesseract process max to 5 mins. \r\n\r\nThe problem is that the code below sometimes kills the process properly after 5 mins, but sometimes I see a slowdown in the system due to tesseract process running for much longer.\r\nFor example, today I've noticed in logs that it took 37 minutes between `Will run OCR...` and `Tesseract timed out. Killing the ocr process ...`  (`Code block execution exceeded 300 seconds timeout` internal `stopit` log message).\r\n\r\n```python\r\ntry:\r\n    with stopit.ThreadingTimeout(300, swallow_exc=False):\r\n        logger.info('Will run OCR...')\r\n\r\n        command = 'tesseract {} {} --psm 1 -l eng hocr'.format(image_path, hocr_file_path).split()\r\n        ocr_process = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\r\n        # Wait for the tesseract process to finish and fetch stdout/stderr\r\n        stdout, stderr = self.ocr_process.communicate()\r\n\r\n        # ...\r\n        # Do some processing of results\r\nexcept stopit.utils.TimeoutException:\r\n    logger.exception('Tesseract timed out. Killing the ocr process ...')\r\n    ocr_process.kill()\r\n    # ...\r\n```\r\n\r\nCan you help me please to understand if I'm using `stopit` for the wrong scenario or what can be the problem?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/14", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/14/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/14/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/14/events", "html_url": "https://github.com/glenfant/stopit/issues/14", "id": 266121693, "node_id": "MDU6SXNzdWUyNjYxMjE2OTM=", "number": 14, "title": "MIT license?", "user": {"login": "frol", "id": 304265, "node_id": "MDQ6VXNlcjMwNDI2NQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/304265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frol", "html_url": "https://github.com/frol", "followers_url": "https://api.github.com/users/frol/followers", "following_url": "https://api.github.com/users/frol/following{/other_user}", "gists_url": "https://api.github.com/users/frol/gists{/gist_id}", "starred_url": "https://api.github.com/users/frol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frol/subscriptions", "organizations_url": "https://api.github.com/users/frol/orgs", "repos_url": "https://api.github.com/users/frol/repos", "events_url": "https://api.github.com/users/frol/events{/privacy}", "received_events_url": "https://api.github.com/users/frol/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-10-17T13:20:30Z", "updated_at": "2017-10-19T16:44:13Z", "closed_at": "2017-10-19T16:44:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "Could you, please, consider using a less restrictive license, e.g. MIT?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/13", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/13/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/13/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/13/events", "html_url": "https://github.com/glenfant/stopit/issues/13", "id": 245075488, "node_id": "MDU6SXNzdWUyNDUwNzU0ODg=", "number": 13, "title": "Not working with gunicorn + gevent workers", "user": {"login": "anshulk", "id": 3637620, "node_id": "MDQ6VXNlcjM2Mzc2MjA=", "avatar_url": "https://avatars0.githubusercontent.com/u/3637620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anshulk", "html_url": "https://github.com/anshulk", "followers_url": "https://api.github.com/users/anshulk/followers", "following_url": "https://api.github.com/users/anshulk/following{/other_user}", "gists_url": "https://api.github.com/users/anshulk/gists{/gist_id}", "starred_url": "https://api.github.com/users/anshulk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anshulk/subscriptions", "organizations_url": "https://api.github.com/users/anshulk/orgs", "repos_url": "https://api.github.com/users/anshulk/repos", "events_url": "https://api.github.com/users/anshulk/events{/privacy}", "received_events_url": "https://api.github.com/users/anshulk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-07-24T13:12:59Z", "updated_at": "2018-07-25T14:16:45Z", "closed_at": "2017-12-31T11:14:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to use the threading_timeoutable decorator on a function. \r\nIt works if I run the script directly, but doesn't work when running via gunicorn using gevent workers. \r\n\r\nAny ideas on making it work?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/11", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/11/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/11/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/11/events", "html_url": "https://github.com/glenfant/stopit/issues/11", "id": 158945534, "node_id": "MDU6SXNzdWUxNTg5NDU1MzQ=", "number": 11, "title": "pybuild is failing", "user": {"login": "alvesadrian", "id": 1500347, "node_id": "MDQ6VXNlcjE1MDAzNDc=", "avatar_url": "https://avatars0.githubusercontent.com/u/1500347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alvesadrian", "html_url": "https://github.com/alvesadrian", "followers_url": "https://api.github.com/users/alvesadrian/followers", "following_url": "https://api.github.com/users/alvesadrian/following{/other_user}", "gists_url": "https://api.github.com/users/alvesadrian/gists{/gist_id}", "starred_url": "https://api.github.com/users/alvesadrian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alvesadrian/subscriptions", "organizations_url": "https://api.github.com/users/alvesadrian/orgs", "repos_url": "https://api.github.com/users/alvesadrian/repos", "events_url": "https://api.github.com/users/alvesadrian/events{/privacy}", "received_events_url": "https://api.github.com/users/alvesadrian/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-06-07T15:00:07Z", "updated_at": "2017-04-16T11:08:30Z", "closed_at": "2017-04-16T11:08:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I: pybuild base:184: /usr/bin/python3 setup.py build \nrunning build\nrunning build_py\ncreating /tmp/b/a/stopit/.pybuild/pythonX.Y_3.5/build/stopit\ncopying src/stopit/**init**.py -> /tmp/b/a/stopit/.pybuild/pythonX.Y_3.5/build/stopit\ncopying src/stopit/signalstop.py -> /tmp/b/a/stopit/.pybuild/pythonX.Y_3.5/build/stopit\ncopying src/stopit/utils.py -> /tmp/b/a/stopit/.pybuild/pythonX.Y_3.5/build/stopit\ncopying src/stopit/threadstop.py -> /tmp/b/a/stopit/.pybuild/pythonX.Y_3.5/build/stopit\n   dh_auto_test -O--buildsystem=pybuild\nI: pybuild base:184: cd /tmp/b/a/stopit/.pybuild/pythonX.Y_2.7/build; python2.7 -m pytest \n============================= test session starts ==============================\nplatform linux2 -- Python 2.7.11+, pytest-2.9.2, py-1.4.31, pluggy-0.3.1\nrootdir: /tmp/b/a/stopit, inifile: \ncollected 0 items\n\n========================= no tests ran in 0.00 seconds =========================\nE: pybuild pybuild:274: test: plugin distutils failed with: exit code=5: cd /tmp/b/a/stopit/.pybuild/pythonX.Y_2.7/build; python2.7 -m pytest \ndh_auto_test: pybuild --test --test-pytest -i python{version} -p 2.7 --dir . returned exit code 13\ndebian/rules:4: recipe for target 'build' failed\nmake: **\\* [build] Error 25\ndpkg-buildpackage: error: debian/rules build gave error exit status 2\ndebuild: fatal error at line 1376:\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/7", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/7/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/7/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/7/events", "html_url": "https://github.com/glenfant/stopit/issues/7", "id": 93953484, "node_id": "MDU6SXNzdWU5Mzk1MzQ4NA==", "number": 7, "title": "Why does this stopit code fail?", "user": {"login": "VeereshElango", "id": 9779035, "node_id": "MDQ6VXNlcjk3NzkwMzU=", "avatar_url": "https://avatars3.githubusercontent.com/u/9779035?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VeereshElango", "html_url": "https://github.com/VeereshElango", "followers_url": "https://api.github.com/users/VeereshElango/followers", "following_url": "https://api.github.com/users/VeereshElango/following{/other_user}", "gists_url": "https://api.github.com/users/VeereshElango/gists{/gist_id}", "starred_url": "https://api.github.com/users/VeereshElango/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VeereshElango/subscriptions", "organizations_url": "https://api.github.com/users/VeereshElango/orgs", "repos_url": "https://api.github.com/users/VeereshElango/repos", "events_url": "https://api.github.com/users/VeereshElango/events{/privacy}", "received_events_url": "https://api.github.com/users/VeereshElango/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2015-07-09T04:39:38Z", "updated_at": "2015-07-15T09:36:44Z", "closed_at": "2015-07-10T17:05:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am facing a strange issue with the stopit module. The below code works fine:\n\n```\nimport stopit\n\ndef check(num):\n    with stopit.ThreadingTimeout(3) as to_ctx_mrg:\n        count = 0\n        while(True):\n\n            if False:\n                continue    \n\n    if to_ctx_mrg.state == to_ctx_mrg.TIMED_OUT:\n            print(to_ctx_mrg.state)\n            print(\"Time out\")\n            raise TimeoutError\n\ntry:\n    check(1)\nexcept TimeoutError:\n    print(\"Caught the timeout\")\n```\n\nBut, when I change the if condition slightly, stopit is not able to recognize this infinite loop and the program does not stop. Take a look at the modified code:\n\n```\nimport stopit\n\ndef check(num):\n    with stopit.ThreadingTimeout(3) as to_ctx_mrg:\n        count = 0\n        while(True):\n\n            if num>31:\n                continue    \n\n    if to_ctx_mrg.state == to_ctx_mrg.TIMED_OUT:\n            print(to_ctx_mrg.state)\n            print(\"Time out\")\n            raise TimeoutError\n\ntry:\n    check(1)\nexcept TimeoutError:\n    print(\"Caught the timeout\")\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/6", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/6/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/6/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/6/events", "html_url": "https://github.com/glenfant/stopit/issues/6", "id": 53434271, "node_id": "MDU6SXNzdWU1MzQzNDI3MQ==", "number": 6, "title": "threading locks and stopit", "user": {"login": "andresriancho", "id": 865200, "node_id": "MDQ6VXNlcjg2NTIwMA==", "avatar_url": "https://avatars0.githubusercontent.com/u/865200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andresriancho", "html_url": "https://github.com/andresriancho", "followers_url": "https://api.github.com/users/andresriancho/followers", "following_url": "https://api.github.com/users/andresriancho/following{/other_user}", "gists_url": "https://api.github.com/users/andresriancho/gists{/gist_id}", "starred_url": "https://api.github.com/users/andresriancho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andresriancho/subscriptions", "organizations_url": "https://api.github.com/users/andresriancho/orgs", "repos_url": "https://api.github.com/users/andresriancho/repos", "events_url": "https://api.github.com/users/andresriancho/events{/privacy}", "received_events_url": "https://api.github.com/users/andresriancho/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "glenfant", "id": 703389, "node_id": "MDQ6VXNlcjcwMzM4OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/703389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glenfant", "html_url": "https://github.com/glenfant", "followers_url": "https://api.github.com/users/glenfant/followers", "following_url": "https://api.github.com/users/glenfant/following{/other_user}", "gists_url": "https://api.github.com/users/glenfant/gists{/gist_id}", "starred_url": "https://api.github.com/users/glenfant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glenfant/subscriptions", "organizations_url": "https://api.github.com/users/glenfant/orgs", "repos_url": "https://api.github.com/users/glenfant/repos", "events_url": "https://api.github.com/users/glenfant/events{/privacy}", "received_events_url": "https://api.github.com/users/glenfant/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "glenfant", "id": 703389, "node_id": "MDQ6VXNlcjcwMzM4OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/703389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glenfant", "html_url": "https://github.com/glenfant", "followers_url": "https://api.github.com/users/glenfant/followers", "following_url": "https://api.github.com/users/glenfant/following{/other_user}", "gists_url": "https://api.github.com/users/glenfant/gists{/gist_id}", "starred_url": "https://api.github.com/users/glenfant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glenfant/subscriptions", "organizations_url": "https://api.github.com/users/glenfant/orgs", "repos_url": "https://api.github.com/users/glenfant/repos", "events_url": "https://api.github.com/users/glenfant/events{/privacy}", "received_events_url": "https://api.github.com/users/glenfant/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2015-01-05T19:40:43Z", "updated_at": "2017-04-16T13:13:05Z", "closed_at": "2017-04-16T11:13:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've added stopit to the [w3af](https://github.com/andresriancho/w3af/tree/feature/stopit) framework with the objective of killing document parsers (w3af is a crawler with security features) which take more than N seconds to parse an HTTP response body.\n\nWhile running some test scans I've noticed (but not yet confirmed 100%) that in some cases all the threads are dead-locked waiting for a threading.RLock to be released:\n\n```\nw3af-10287-2015-05-01-05_26.threads:        \"  File \\\"parser_cache.py\\\", line 84, in get_document_parser_for\\n    with self._LRULock:\\n\", \nw3af-10287-2015-05-01-05_26.threads:        \"  File \\\"parser_cache.py\\\", line 84, in get_document_parser_for\\n    with self._LRULock:\\n\", \n...\nw3af-10287-2015-05-01-05_26.threads:        \"  File \\\"parser_cache.py\\\", line 84, in get_document_parser_for\\n    with self._LRULock:\\n\", \n```\n\nThis output is generated by [this thread traceback dump script](https://github.com/andresriancho/w3af/blob/feature/stopit/w3af/core/controllers/profiling/thread_activity.py) which hasn't failed for me in the past. When the framework parser cache is working as expected the output looks like:\n\n```\nw3af-10287-2015-05-01-05_19.threads:        \"  File \\\"parser_cache.py\\\", line 84, in get_document_parser_for\\n    with self._LRULock:\\n\", \nw3af-10287-2015-05-01-05_19.threads:        \"  File \\\"parser_cache.py\\\", line 90, in get_document_parser_for\\n    res = DocumentParser.DocumentParser(http_response)\\n\", \nw3af-10287-2015-05-01-05_19.threads:        \"  File \\\"parser_cache.py\\\", line 84, in get_document_parser_for\\n    with self._LRULock:\\n\", \n```\n\nThe pseudo-code for the code I'm having problems with is:\n\n``` python\nwith self._LRULock:\n    try:\n        with ThreadingTimeout(self.PARSER_TIMEOUT, swallow_exc=False):\n            self._parser = parser(http_resp)\n    except TimeoutException:\n        logging.debug(...)\n```\n\nI know that the timeout is being triggered because the debug message appears in the logs.\n\nThe question is... is there any known bug with `stopit` , `PyThreadState_SetAsyncExc` and threading locks?\n\nI've tried to reproduce this issue in [this commit](https://github.com/andresriancho/w3af/commit/46623043c1288963835a8f5bc83f9d366e1e9f19) but all seems to be working as expected.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/5", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/5/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/5/events", "html_url": "https://github.com/glenfant/stopit/issues/5", "id": 52366208, "node_id": "MDU6SXNzdWU1MjM2NjIwOA==", "number": 5, "title": "Typographical errors in example", "user": {"login": "jsf80238", "id": 2550783, "node_id": "MDQ6VXNlcjI1NTA3ODM=", "avatar_url": "https://avatars2.githubusercontent.com/u/2550783?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsf80238", "html_url": "https://github.com/jsf80238", "followers_url": "https://api.github.com/users/jsf80238/followers", "following_url": "https://api.github.com/users/jsf80238/following{/other_user}", "gists_url": "https://api.github.com/users/jsf80238/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsf80238/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsf80238/subscriptions", "organizations_url": "https://api.github.com/users/jsf80238/orgs", "repos_url": "https://api.github.com/users/jsf80238/repos", "events_url": "https://api.github.com/users/jsf80238/events{/privacy}", "received_events_url": "https://api.github.com/users/jsf80238/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-12-18T13:57:39Z", "updated_at": "2015-01-01T18:58:52Z", "closed_at": "2015-01-01T18:58:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, on https://pypi.python.org/pypi/stopit the example shows \"status\" but I believe \"state\" is desired.  Also, \"mgr\" is sometimes spelled \"mrg\".  The example that worked for me:\n\nimport stopit\nimport time\n# ...\n\nwith stopit.ThreadingTimeout(3) as to_ctx_mgr:\n    assert to_ctx_mgr.state == to_ctx_mgr.EXECUTING\n    # Something potentially very long but which\n    time.sleep(2)\n# OK, let's check what happened\n\nif to_ctx_mgr.state == to_ctx_mgr.EXECUTED:\n    # All's fine, everything was executed within 10 seconds\n    print(\"good\")\nelif to_ctx_mgr.state == to_ctx_mgr.EXECUTING:\n    # Hmm, that's not possible outside the block\n    print(\"not possible\")\nelif to_ctx_mgr.state == to_ctx_mgr.TIMED_OUT:\n    # Eeek the 10 seconds timeout occurred while executing the block\n    print(\"timeout\")\nelif to_ctx_mgr.state == to_ctx_mgr.INTERRUPTED:\n    # Oh you raised specifically the TimeoutException in the block\n    print(\"timeout exception raised\")\nelif to_ctx_mgr.state == to_ctx_mgr.CANCELED:\n    # Oh you called to_ctx_mgr.cancel() method within the block but it\n    # executed till the end\n    print(\"canceled\")\nelse:\n    # That's not possible\n    pass\n\nThank you for providing this software to the world!  I appreciate it.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/4", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/4/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/4/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/4/events", "html_url": "https://github.com/glenfant/stopit/issues/4", "id": 49482183, "node_id": "MDU6SXNzdWU0OTQ4MjE4Mw==", "number": 4, "title": "Cleaning file descriptors?", "user": {"login": "unhashable", "id": 263587, "node_id": "MDQ6VXNlcjI2MzU4Nw==", "avatar_url": "https://avatars1.githubusercontent.com/u/263587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/unhashable", "html_url": "https://github.com/unhashable", "followers_url": "https://api.github.com/users/unhashable/followers", "following_url": "https://api.github.com/users/unhashable/following{/other_user}", "gists_url": "https://api.github.com/users/unhashable/gists{/gist_id}", "starred_url": "https://api.github.com/users/unhashable/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/unhashable/subscriptions", "organizations_url": "https://api.github.com/users/unhashable/orgs", "repos_url": "https://api.github.com/users/unhashable/repos", "events_url": "https://api.github.com/users/unhashable/events{/privacy}", "received_events_url": "https://api.github.com/users/unhashable/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2014-11-20T02:19:27Z", "updated_at": "2015-04-04T08:35:06Z", "closed_at": "2014-11-21T00:58:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Does stopit ensure that the gc cleans up file descriptors?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/3", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/3/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/3/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/3/events", "html_url": "https://github.com/glenfant/stopit/issues/3", "id": 32691615, "node_id": "MDU6SXNzdWUzMjY5MTYxNQ==", "number": 3, "title": "Add a check_interval parameter to the decorators and context managers", "user": {"login": "glenfant", "id": 703389, "node_id": "MDQ6VXNlcjcwMzM4OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/703389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glenfant", "html_url": "https://github.com/glenfant", "followers_url": "https://api.github.com/users/glenfant/followers", "following_url": "https://api.github.com/users/glenfant/following{/other_user}", "gists_url": "https://api.github.com/users/glenfant/gists{/gist_id}", "starred_url": "https://api.github.com/users/glenfant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glenfant/subscriptions", "organizations_url": "https://api.github.com/users/glenfant/orgs", "repos_url": "https://api.github.com/users/glenfant/repos", "events_url": "https://api.github.com/users/glenfant/events{/privacy}", "received_events_url": "https://api.github.com/users/glenfant/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 79565052, "node_id": "MDU6TGFiZWw3OTU2NTA1Mg==", "url": "https://api.github.com/repos/glenfant/stopit/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2014-05-02T13:14:31Z", "updated_at": "2017-04-16T11:16:08Z", "closed_at": "2017-04-16T11:16:08Z", "author_association": "OWNER", "active_lock_reason": null, "body": "Read https://github.com/glenfant/stopit/issues/2#issuecomment-42029222 for more background about this future change.\n\nAdd a `check_interval=None` parameter to the context manager constructors and the decorators to give a chance to the programmer to improve timeout accuracy at the expense of the performances of the decorated function or context manager inner block.\n\nSee https://docs.python.org/2.7/library/sys.html#sys.setcheckinterval about the check interval.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/glenfant/stopit/issues/2", "repository_url": "https://api.github.com/repos/glenfant/stopit", "labels_url": "https://api.github.com/repos/glenfant/stopit/issues/2/labels{/name}", "comments_url": "https://api.github.com/repos/glenfant/stopit/issues/2/comments", "events_url": "https://api.github.com/repos/glenfant/stopit/issues/2/events", "html_url": "https://github.com/glenfant/stopit/issues/2", "id": 27230098, "node_id": "MDU6SXNzdWUyNzIzMDA5OA==", "number": 2, "title": "Inconsistent failing on testing on Python 2", "user": {"login": "livibetter", "id": 30909, "node_id": "MDQ6VXNlcjMwOTA5", "avatar_url": "https://avatars1.githubusercontent.com/u/30909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/livibetter", "html_url": "https://github.com/livibetter", "followers_url": "https://api.github.com/users/livibetter/followers", "following_url": "https://api.github.com/users/livibetter/following{/other_user}", "gists_url": "https://api.github.com/users/livibetter/gists{/gist_id}", "starred_url": "https://api.github.com/users/livibetter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/livibetter/subscriptions", "organizations_url": "https://api.github.com/users/livibetter/orgs", "repos_url": "https://api.github.com/users/livibetter/repos", "events_url": "https://api.github.com/users/livibetter/events{/privacy}", "received_events_url": "https://api.github.com/users/livibetter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2014-02-09T20:18:10Z", "updated_at": "2014-05-02T13:14:31Z", "closed_at": "2014-05-02T13:05:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "I don't know how `stopit` does behind the scene, but just want to give some feedback.\n\nThe following command doesn't give same test results every time I ran it:\n\n```\n$ python2 setup.py test\n[snip]\nDoctest: README.rst ... FAIL\n======================================================================\nFAIL: /home/livibetter/p/stopit/README.rst\nDoctest: README.rst\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/usr/lib64/python2.7/doctest.py\", line 2201, in runTest\n    raise self.failureException(self.format_failure(new.getvalue()))\nAssertionError: Failed doctest test for README.rst\n  File \"/home/livibetter/p/stopit/README.rst\", line 0\n\n----------------------------------------------------------------------\nFile \"/home/livibetter/p/stopit/README.rst\", line 174, in README.rst\nFailed example:\n    time.time() - start_time < 2.1\nExpected:\n    True\nGot:\n    False\n----------------------------------------------------------------------\nFile \"/home/livibetter/p/stopit/README.rst\", line 204, in README.rst\nFailed example:\n    time.time() - start_time < 2.1\nExpected:\n    True\nGot:\n    False\n\n\n----------------------------------------------------------------------\nRan 1 test in 8.948s\n\nFAILED (failures=1)\n```\n\nThe result above has two failures, but sometimes both pass, sometimes only one of them fails. The testing should be have same results every time, maybe there is something with Python 2?\n\nI tried with Python 3 a few times, it seems all passed, which is consistent.\n\n```\n ~/p/stopit [git:master] $ python2 --version\nPython 2.7.5\n ~/p/stopit [git:master] $ python3 --version\nPython 3.3.3\n ~/p/stopit [git:master] $ uname -a\nLinux dfed 3.10.25-gentoo-1 #1 SMP PREEMPT Tue Jan 21 03:19:58 CST 2014 x86_64 Intel(R) Core(TM)2 CPU T5600 @ 1.83GHz GenuineIntel GNU/Linux\n```\n\nAs I said in beginning, I don't know anything about `stopit`, but I can help with information from my system if that helps.\n", "performed_via_github_app": null, "score": 1.0}]}