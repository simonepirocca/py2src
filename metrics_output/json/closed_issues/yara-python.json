{"total_count": 74, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/149", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/149/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/149/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/149/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/149", "id": 637721519, "node_id": "MDU6SXNzdWU2Mzc3MjE1MTk=", "number": 149, "title": "Segmentation fault iterating over a rule with non-ascii chars in meta", "user": {"login": "joseotoro", "id": 2981066, "node_id": "MDQ6VXNlcjI5ODEwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/2981066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joseotoro", "html_url": "https://github.com/joseotoro", "followers_url": "https://api.github.com/users/joseotoro/followers", "following_url": "https://api.github.com/users/joseotoro/following{/other_user}", "gists_url": "https://api.github.com/users/joseotoro/gists{/gist_id}", "starred_url": "https://api.github.com/users/joseotoro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joseotoro/subscriptions", "organizations_url": "https://api.github.com/users/joseotoro/orgs", "repos_url": "https://api.github.com/users/joseotoro/repos", "events_url": "https://api.github.com/users/joseotoro/events{/privacy}", "received_events_url": "https://api.github.com/users/joseotoro/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-12T12:39:46Z", "updated_at": "2020-06-12T15:58:56Z", "closed_at": "2020-06-12T15:58:56Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "yar.yar file:\r\n```yara\r\nrule Test {\r\n  meta:\r\n      author = \"\u00f1\"\r\n  strings:\r\n      $foo1 = \"foo1\"\r\n  condition:\r\n      $foo1\r\n}\r\n```\r\n\r\n```python\r\n>>> import yara\r\n>>> f = yara.compile('yar.yar')\r\n>>> f.next()\r\n[1]    12175 segmentation fault  python\r\n```\r\n\r\nTried running the rule with Yara:\r\n```\r\n\u279c yara -m yar.yar .\r\nTest [description=\"\\303\\261\"] ./yar.yar\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/146", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/146/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/146/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/146/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/146", "id": 623693144, "node_id": "MDU6SXNzdWU2MjM2OTMxNDQ=", "number": 146, "title": "Got an error in Windows 10", "user": {"login": "490694561", "id": 30389809, "node_id": "MDQ6VXNlcjMwMzg5ODA5", "avatar_url": "https://avatars2.githubusercontent.com/u/30389809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/490694561", "html_url": "https://github.com/490694561", "followers_url": "https://api.github.com/users/490694561/followers", "following_url": "https://api.github.com/users/490694561/following{/other_user}", "gists_url": "https://api.github.com/users/490694561/gists{/gist_id}", "starred_url": "https://api.github.com/users/490694561/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/490694561/subscriptions", "organizations_url": "https://api.github.com/users/490694561/orgs", "repos_url": "https://api.github.com/users/490694561/repos", "events_url": "https://api.github.com/users/490694561/events{/privacy}", "received_events_url": "https://api.github.com/users/490694561/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 259101744, "node_id": "MDU6TGFiZWwyNTkxMDE3NDQ=", "url": "https://api.github.com/repos/VirusTotal/yara-python/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-23T16:21:18Z", "updated_at": "2020-06-11T09:54:52Z", "closed_at": "2020-06-11T09:54:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nE:\\Cheat\r\n\u03bb pip install yara-python\r\nDEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support for Python 2.7 in January 2021. More details about Python 2 support in pip, can be found at https://pip.pypa.io/en/latest/development/release-process/#python-2-support\r\nLooking in indexes: http://mirrors.aliyun.com/pypi/simple/\r\nCollecting yara-python\r\n  Downloading http://mirrors.aliyun.com/pypi/packages/c6/a3/f21aeebe85bbe3f2e089324663ea206fa1fc3f4196815b30b752f2e93e67/yara-python-4.0.1.tar.gz (405 kB)\r\n     |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 405 kB 541 kB/s\r\nBuilding wheels for collected packages: yara-python\r\n  Building wheel for yara-python (setup.py) ... error\r\n  ERROR: Command errored out with exit status 1:\r\n   command: 'e:\\program files\\python27\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'c:\\\\users\\\\0xpoker\\\\appdata\\\\local\\\\temp\\\\pip-install-vboyd0\\\\yara-python\\\\setup.py'\"'\"'; __file__='\"'\"'c:\\\\users\\\\0xpoker\\\\appdata\\\\local\\\\temp\\\\pip-install-vboyd0\\\\yara-python\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' bdist_wheel -d 'c:\\users\\0xpoker\\appdata\\local\\temp\\pip-wheel-lflz66'\r\n       cwd: c:\\users\\0xpoker\\appdata\\local\\temp\\pip-install-vboyd0\\yara-python\\\r\n  Complete output (66 lines):\r\n  running bdist_wheel\r\n  running build\r\n  running build_ext\r\n  building 'yara' extension\r\n  creating build\r\n  creating build\\temp.win-amd64-2.7\r\n  creating build\\temp.win-amd64-2.7\\Release\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\demo\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\elf\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\math\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\pe\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\tests\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\time\r\n  creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\proc\r\n  C:\\Users\\0xpoker\\AppData\\Local\\Programs\\Common\\Microsoft\\Visual C++ for Python\\9.0\\VC\\Bin\\amd64\\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DUSE_WINDOWS_PROC=1 -D_CRT_SECURE_NO_WARNINGS=1 -Iyara/libyara/include -Iyara/libyara/ -I. \"-Ie:\\program files\\python27\\include\" \"-Ie:\\program files\\python27\\PC\" /Tcyara-python.c /Fobuild\\temp.win-amd64-2.7\\Release\\yara-python.obj\r\n  yara-python.c\r\n  yara/libyara/include\\yara/stream.h(35) : error C2054: expected '(' to follow '_Bool'\r\n  yara/libyara/include\\yara/stream.h(35) : error C2143: syntax error : missing ';' before 'type'\r\n  yara/libyara/include\\yara/stream.h(39) : error C2085: 'YR_STREAM_READ_FUNC' : not in formal parameter list\r\n  yara/libyara/include\\yara/stream.h(46) : error C2085: 'YR_STREAM_WRITE_FUNC' : not in formal parameter list\r\n  yara/libyara/include\\yara/stream.h(53) : error C2061: syntax error : identifier 'YR_STREAM_READ_FUNC'\r\n  yara/libyara/include\\yara/stream.h(54) : error C2061: syntax error : identifier 'write'\r\n  yara/libyara/include\\yara/stream.h(54) : error C2059: syntax error : ';'\r\n  yara/libyara/include\\yara/stream.h(56) : error C2059: syntax error : '}'\r\n  yara/libyara/include\\yara/stream.h(63) : error C2143: syntax error : missing ')' before '*'\r\n  yara/libyara/include\\yara/stream.h(63) : error C2081: 'YR_STREAM' : name in formal parameter list illegal\r\n  yara/libyara/include\\yara/stream.h(63) : error C2143: syntax error : missing '{' before '*'\r\n  yara/libyara/include\\yara/stream.h(63) : error C2059: syntax error : ')'\r\n  yara/libyara/include\\yara/stream.h(70) : error C2143: syntax error : missing ')' before '*'\r\n  yara/libyara/include\\yara/stream.h(70) : error C2081: 'YR_STREAM' : name in formal parameter list illegal\r\n  yara/libyara/include\\yara/stream.h(70) : error C2143: syntax error : missing '{' before '*'\r\n  yara/libyara/include\\yara/stream.h(70) : error C2059: syntax error : ')'\r\n  yara/libyara/include\\yara/arena.h(272) : error C2143: syntax error : missing ')' before '*'\r\n  yara/libyara/include\\yara/arena.h(272) : error C2143: syntax error : missing '{' before '*'\r\n  yara/libyara/include\\yara/arena.h(273) : error C2371: 'YR_ARENA' : redefinition; different basic types\r\n          yara/libyara/include\\yara/arena.h(50) : see declaration of 'YR_ARENA'\r\n  yara/libyara/include\\yara/arena.h(273) : error C2143: syntax error : missing ';' before '*'\r\n  yara/libyara/include\\yara/arena.h(273) : error C2059: syntax error : ')'\r\n  yara/libyara/include\\yara/arena.h(278) : error C2143: syntax error : missing ')' before '*'\r\n  yara/libyara/include\\yara/arena.h(278) : error C2081: 'YR_STREAM' : name in formal parameter list illegal\r\n  yara/libyara/include\\yara/arena.h(278) : error C2143: syntax error : missing '{' before '*'\r\n  yara/libyara/include\\yara/arena.h(278) : error C2059: syntax error : ')'\r\n  yara/libyara/include\\yara/rules.h(133) : error C2143: syntax error : missing ')' before '*'\r\n  yara/libyara/include\\yara/rules.h(133) : error C2081: 'YR_STREAM' : name in formal parameter list illegal\r\n  yara/libyara/include\\yara/rules.h(133) : error C2143: syntax error : missing '{' before '*'\r\n  yara/libyara/include\\yara/rules.h(133) : error C2059: syntax error : ')'\r\n  yara/libyara/include\\yara/rules.h(142) : error C2143: syntax error : missing ')' before '*'\r\n  yara/libyara/include\\yara/rules.h(142) : error C2143: syntax error : missing '{' before '*'\r\n  yara/libyara/include\\yara/rules.h(143) : error C2371: 'YR_RULES' : redefinition; different basic types\r\n          yara/libyara/include\\yara/types.h(209) : see declaration of 'YR_RULES'\r\n  yara/libyara/include\\yara/rules.h(143) : error C2143: syntax error : missing ';' before '*'\r\n  yara/libyara/include\\yara/rules.h(143) : error C2059: syntax error : ')'\r\n  yara-python.c(1612) : error C2065: 'YR_STREAM' : undeclared identifier\r\n  yara-python.c(1612) : error C2146: syntax error : missing ';' before identifier 'stream'\r\n  yara-python.c(1614) : error C2224: left of '.user_data' must have struct/union type\r\n  yara-python.c(1615) : error C2224: left of '.write' must have struct/union type\r\n  yara-python.c(1618) : warning C4013: 'yr_rules_save_stream' undefined; assuming extern returning int\r\n  yara-python.c(2254) : error C2065: 'YR_STREAM' : undeclared identifier\r\n  yara-python.c(2254) : error C2146: syntax error : missing ';' before identifier 'stream'\r\n  yara-python.c(2256) : error C2224: left of '.user_data' must have struct/union type\r\n  yara-python.c(2257) : error C2224: left of '.read' must have struct/union type\r\n  yara-python.c(2265) : warning C4013: 'yr_rules_load_stream' undefined; assuming extern returning int\r\n  error: command 'C:\\\\Users\\\\0xpoker\\\\AppData\\\\Local\\\\Programs\\\\Common\\\\Microsoft\\\\Visual C++ for Python\\\\9.0\\\\VC\\\\Bin\\\\amd64\\\\cl.exe' failed with exit status 2\r\n  ----------------------------------------\r\n  ERROR: Failed building wheel for yara-python\r\n  Running setup.py clean for yara-python\r\nFailed to build yara-python\r\nInstalling collected packages: yara-python\r\n    Running setup.py install for yara-python ... error\r\n    ERROR: Command errored out with exit status 1:\r\n     command: 'e:\\program files\\python27\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'c:\\\\users\\\\0xpoker\\\\appdata\\\\local\\\\temp\\\\pip-install-vboyd0\\\\yara-python\\\\setup.py'\"'\"'; __file__='\"'\"'c:\\\\users\\\\0xpoker\\\\appdata\\\\local\\\\temp\\\\pip-install-vboyd0\\\\yara-python\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'c:\\users\\0xpoker\\appdata\\local\\temp\\pip-record-el2lci\\install-record.txt' --single-version-externally-managed --compile --install-headers 'e:\\program files\\python27\\Include\\yara-python'\r\n         cwd: c:\\users\\0xpoker\\appdata\\local\\temp\\pip-install-vboyd0\\yara-python\\\r\n    Complete output (66 lines):\r\n    running install\r\n    running build\r\n    running build_ext\r\n    building 'yara' extension\r\n    creating build\r\n    creating build\\temp.win-amd64-2.7\r\n    creating build\\temp.win-amd64-2.7\\Release\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\demo\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\elf\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\math\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\pe\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\tests\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\modules\\time\r\n    creating build\\temp.win-amd64-2.7\\Release\\yara\\libyara\\proc\r\n    C:\\Users\\0xpoker\\AppData\\Local\\Programs\\Common\\Microsoft\\Visual C++ for Python\\9.0\\VC\\Bin\\amd64\\cl.exe /c /nologo /Ox /MD /W3 /GS- /DNDEBUG -DUSE_WINDOWS_PROC=1 -D_CRT_SECURE_NO_WARNINGS=1 -Iyara/libyara/include -Iyara/libyara/ -I. \"-Ie:\\program files\\python27\\include\" \"-Ie:\\program files\\python27\\PC\" /Tcyara-python.c /Fobuild\\temp.win-amd64-2.7\\Release\\yara-python.obj\r\n    yara-python.c\r\n    yara/libyara/include\\yara/stream.h(35) : error C2054: expected '(' to follow '_Bool'\r\n    yara/libyara/include\\yara/stream.h(35) : error C2143: syntax error : missing ';' before 'type'\r\n    yara/libyara/include\\yara/stream.h(39) : error C2085: 'YR_STREAM_READ_FUNC' : not in formal parameter list\r\n    yara/libyara/include\\yara/stream.h(46) : error C2085: 'YR_STREAM_WRITE_FUNC' : not in formal parameter list\r\n    yara/libyara/include\\yara/stream.h(53) : error C2061: syntax error : identifier 'YR_STREAM_READ_FUNC'\r\n    yara/libyara/include\\yara/stream.h(54) : error C2061: syntax error : identifier 'write'\r\n    yara/libyara/include\\yara/stream.h(54) : error C2059: syntax error : ';'\r\n    yara/libyara/include\\yara/stream.h(56) : error C2059: syntax error : '}'\r\n    yara/libyara/include\\yara/stream.h(63) : error C2143: syntax error : missing ')' before '*'\r\n    yara/libyara/include\\yara/stream.h(63) : error C2081: 'YR_STREAM' : name in formal parameter list illegal\r\n    yara/libyara/include\\yara/stream.h(63) : error C2143: syntax error : missing '{' before '*'\r\n    yara/libyara/include\\yara/stream.h(63) : error C2059: syntax error : ')'\r\n    yara/libyara/include\\yara/stream.h(70) : error C2143: syntax error : missing ')' before '*'\r\n    yara/libyara/include\\yara/stream.h(70) : error C2081: 'YR_STREAM' : name in formal parameter list illegal\r\n    yara/libyara/include\\yara/stream.h(70) : error C2143: syntax error : missing '{' before '*'\r\n    yara/libyara/include\\yara/stream.h(70) : error C2059: syntax error : ')'\r\n    yara/libyara/include\\yara/arena.h(272) : error C2143: syntax error : missing ')' before '*'\r\n    yara/libyara/include\\yara/arena.h(272) : error C2143: syntax error : missing '{' before '*'\r\n    yara/libyara/include\\yara/arena.h(273) : error C2371: 'YR_ARENA' : redefinition; different basic types\r\n            yara/libyara/include\\yara/arena.h(50) : see declaration of 'YR_ARENA'\r\n    yara/libyara/include\\yara/arena.h(273) : error C2143: syntax error : missing ';' before '*'\r\n    yara/libyara/include\\yara/arena.h(273) : error C2059: syntax error : ')'\r\n    yara/libyara/include\\yara/arena.h(278) : error C2143: syntax error : missing ')' before '*'\r\n    yara/libyara/include\\yara/arena.h(278) : error C2081: 'YR_STREAM' : name in formal parameter list illegal\r\n    yara/libyara/include\\yara/arena.h(278) : error C2143: syntax error : missing '{' before '*'\r\n    yara/libyara/include\\yara/arena.h(278) : error C2059: syntax error : ')'\r\n    yara/libyara/include\\yara/rules.h(133) : error C2143: syntax error : missing ')' before '*'\r\n    yara/libyara/include\\yara/rules.h(133) : error C2081: 'YR_STREAM' : name in formal parameter list illegal\r\n    yara/libyara/include\\yara/rules.h(133) : error C2143: syntax error : missing '{' before '*'\r\n    yara/libyara/include\\yara/rules.h(133) : error C2059: syntax error : ')'\r\n    yara/libyara/include\\yara/rules.h(142) : error C2143: syntax error : missing ')' before '*'\r\n    yara/libyara/include\\yara/rules.h(142) : error C2143: syntax error : missing '{' before '*'\r\n    yara/libyara/include\\yara/rules.h(143) : error C2371: 'YR_RULES' : redefinition; different basic types\r\n            yara/libyara/include\\yara/types.h(209) : see declaration of 'YR_RULES'\r\n    yara/libyara/include\\yara/rules.h(143) : error C2143: syntax error : missing ';' before '*'\r\n    yara/libyara/include\\yara/rules.h(143) : error C2059: syntax error : ')'\r\n    yara-python.c(1612) : error C2065: 'YR_STREAM' : undeclared identifier\r\n    yara-python.c(1612) : error C2146: syntax error : missing ';' before identifier 'stream'\r\n    yara-python.c(1614) : error C2224: left of '.user_data' must have struct/union type\r\n    yara-python.c(1615) : error C2224: left of '.write' must have struct/union type\r\n    yara-python.c(1618) : warning C4013: 'yr_rules_save_stream' undefined; assuming extern returning int\r\n    yara-python.c(2254) : error C2065: 'YR_STREAM' : undeclared identifier\r\n    yara-python.c(2254) : error C2146: syntax error : missing ';' before identifier 'stream'\r\n    yara-python.c(2256) : error C2224: left of '.user_data' must have struct/union type\r\n    yara-python.c(2257) : error C2224: left of '.read' must have struct/union type\r\n    yara-python.c(2265) : warning C4013: 'yr_rules_load_stream' undefined; assuming extern returning int\r\n    error: command 'C:\\\\Users\\\\0xpoker\\\\AppData\\\\Local\\\\Programs\\\\Common\\\\Microsoft\\\\Visual C++ for Python\\\\9.0\\\\VC\\\\Bin\\\\amd64\\\\cl.exe' failed with exit status 2\r\n    ----------------------------------------\r\nERROR: Command errored out with exit status 1: 'e:\\program files\\python27\\python.exe' -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'c:\\\\users\\\\0xpoker\\\\appdata\\\\local\\\\temp\\\\pip-install-vboyd0\\\\yara-python\\\\setup.py'\"'\"'; __file__='\"'\"'c:\\\\users\\\\0xpoker\\\\appdata\\\\local\\\\temp\\\\pip-install-vboyd0\\\\yara-python\\\\setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' install --record 'c:\\users\\0xpoker\\appdata\\local\\temp\\pip-record-el2lci\\install-record.txt' --single-version-externally-managed --compile --install-headers 'e:\\program files\\python27\\Include\\yara-python' Check the logs for full command output.\r\n```\r\n\r\nI cannot find how to fix it.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/144", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/144/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/144/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/144/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/144", "id": 613277717, "node_id": "MDU6SXNzdWU2MTMyNzc3MTc=", "number": 144, "title": "Facing error while compiling the code on windows", "user": {"login": "roopeshiitd", "id": 8878690, "node_id": "MDQ6VXNlcjg4Nzg2OTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/8878690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/roopeshiitd", "html_url": "https://github.com/roopeshiitd", "followers_url": "https://api.github.com/users/roopeshiitd/followers", "following_url": "https://api.github.com/users/roopeshiitd/following{/other_user}", "gists_url": "https://api.github.com/users/roopeshiitd/gists{/gist_id}", "starred_url": "https://api.github.com/users/roopeshiitd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/roopeshiitd/subscriptions", "organizations_url": "https://api.github.com/users/roopeshiitd/orgs", "repos_url": "https://api.github.com/users/roopeshiitd/repos", "events_url": "https://api.github.com/users/roopeshiitd/events{/privacy}", "received_events_url": "https://api.github.com/users/roopeshiitd/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-06T12:22:27Z", "updated_at": "2020-05-07T12:18:38Z", "closed_at": "2020-05-07T12:18:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "I just did\r\ngit clone --recursive https://github.com/VirusTotal/yara-python\r\ncd yara-python\r\npython setup.py build\r\n\r\nand I get the following error.\r\nrunning build\r\nrunning build_ext\r\ncreating Users\r\nerror: [WinError 6] The handle is invalid\r\n\r\nActually I wanted to use androguard module in yara-python on windows and just tried to check the repository and I came up with this issue. I this the right way to install on windows? ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/138", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/138/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/138/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/138/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/138", "id": 602716650, "node_id": "MDU6SXNzdWU2MDI3MTY2NTA=", "number": 138, "title": "Deprecation warning due to invalid escape sequences in Python 3.7", "user": {"login": "tirkarthi", "id": 3972343, "node_id": "MDQ6VXNlcjM5NzIzNDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/3972343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tirkarthi", "html_url": "https://github.com/tirkarthi", "followers_url": "https://api.github.com/users/tirkarthi/followers", "following_url": "https://api.github.com/users/tirkarthi/following{/other_user}", "gists_url": "https://api.github.com/users/tirkarthi/gists{/gist_id}", "starred_url": "https://api.github.com/users/tirkarthi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tirkarthi/subscriptions", "organizations_url": "https://api.github.com/users/tirkarthi/orgs", "repos_url": "https://api.github.com/users/tirkarthi/repos", "events_url": "https://api.github.com/users/tirkarthi/events{/privacy}", "received_events_url": "https://api.github.com/users/tirkarthi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-19T13:36:02Z", "updated_at": "2020-04-21T08:01:29Z", "closed_at": "2020-04-21T08:01:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Deprecation warning due to invalid escape sequences in Python 3.7. These can be resolved using raw strings or escaping the sequences again. Also helpful fpr automated fixes : https://github.com/asottile/pyupgrade/\r\n\r\nThe command uses Python 3.8 but the deprecation warnings are present in Python 3.7 also.\r\n\r\n```\r\nfind . -iname '*py' | grep -Ev 'setup|rdf4' | xargs -P4 -I{} python3.8 -Wall -m py_compile {}\r\n./tests.py:143: DeprecationWarning: invalid escape sequence \\s\r\n  ('a[\\s\\S]b', 'a b', SUCCEED, 'a b'),\r\n./tests.py:144: DeprecationWarning: invalid escape sequence \\d\r\n  ('a[\\d\\D]b', 'a1b', SUCCEED, 'a1b'),\r\n./tests.py:164: DeprecationWarning: invalid escape sequence \\]\r\n  ('a[\\]]b', 'a]b', SUCCEED, 'a]b'),\r\n./tests.py:195: DeprecationWarning: invalid escape sequence \\w\r\n  ('a\\wc', 'abc', SUCCEED, 'abc'),\r\n./tests.py:196: DeprecationWarning: invalid escape sequence \\w\r\n  ('a\\wc', 'a_c', SUCCEED, 'a_c'),\r\n./tests.py:197: DeprecationWarning: invalid escape sequence \\w\r\n  ('a\\wc', 'a0c', SUCCEED, 'a0c'),\r\n./tests.py:198: DeprecationWarning: invalid escape sequence \\w\r\n  ('a\\wc', 'a*c', FAIL),\r\n./tests.py:199: DeprecationWarning: invalid escape sequence \\w\r\n  ('\\w+', '--ab_cd0123--', SUCCEED, 'ab_cd0123'),\r\n./tests.py:200: DeprecationWarning: invalid escape sequence \\w\r\n  ('[\\w]+', '--ab_cd0123--', SUCCEED, 'ab_cd0123'),\r\n./tests.py:201: DeprecationWarning: invalid escape sequence \\D\r\n  ('\\D+', '1234abc5678', SUCCEED, 'abc'),\r\n./tests.py:202: DeprecationWarning: invalid escape sequence \\d\r\n  ('[\\d]+', '0123456789', SUCCEED, '0123456789'),\r\n./tests.py:203: DeprecationWarning: invalid escape sequence \\D\r\n  ('[\\D]+', '1234abc5678', SUCCEED, 'abc'),\r\n./tests.py:204: DeprecationWarning: invalid escape sequence \\d\r\n  ('[\\da-fA-F]+', '123abc', SUCCEED, '123abc'),\r\n./tests.py:363: DeprecationWarning: invalid escape sequence \\ \r\n  'rule test { condition: (1 + 1) * 2 == (9 - 1) \\ 2 }',\r\n./tests.py:366: DeprecationWarning: invalid escape sequence \\ \r\n  'rule test { condition: 3 \\ 2 == 1}',\r\n./tests.py:367: DeprecationWarning: invalid escape sequence \\ \r\n  'rule test { condition: 3.0 \\ 2 == 1.5}',\r\n./tests.py:658: DeprecationWarning: invalid escape sequence \\.\r\n  'rule test { strings: $a = /ppi\\.mi/ condition: $a }',\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/137", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/137/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/137/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/137/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/137", "id": 601080570, "node_id": "MDU6SXNzdWU2MDEwODA1NzA=", "number": 137, "title": "Add feature parity with plyara for yara.Rule object", "user": {"login": "tlansec", "id": 5901749, "node_id": "MDQ6VXNlcjU5MDE3NDk=", "avatar_url": "https://avatars0.githubusercontent.com/u/5901749?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tlansec", "html_url": "https://github.com/tlansec", "followers_url": "https://api.github.com/users/tlansec/followers", "following_url": "https://api.github.com/users/tlansec/following{/other_user}", "gists_url": "https://api.github.com/users/tlansec/gists{/gist_id}", "starred_url": "https://api.github.com/users/tlansec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tlansec/subscriptions", "organizations_url": "https://api.github.com/users/tlansec/orgs", "repos_url": "https://api.github.com/users/tlansec/repos", "events_url": "https://api.github.com/users/tlansec/events{/privacy}", "received_events_url": "https://api.github.com/users/tlansec/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-04-16T14:00:55Z", "updated_at": "2020-04-21T08:23:22Z", "closed_at": "2020-04-21T08:10:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hey,\r\n\r\nI have historically been a plyara user for parsing // ensuring certain things about rules:\r\n\r\nhttps://github.com/plyara/plyara\r\n\r\nHowever there would be almost no need for this extra project if there were a few extra fields in the yara.Rule object:\r\n\r\n1) Imports - a imports field indicating which imports a rule relies on.\r\n2) A function to rebuild the rule as a string.\r\n\r\nInterested to know whether these would be difficult to implement, or whether there is interest from others in these changes.\r\n\r\nThanks,\r\nTom", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/135", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/135/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/135/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/135/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/135", "id": 596526354, "node_id": "MDU6SXNzdWU1OTY1MjYzNTQ=", "number": 135, "title": "Unescaped Metadata Crashes Python", "user": {"login": "malvidin", "id": 24500615, "node_id": "MDQ6VXNlcjI0NTAwNjE1", "avatar_url": "https://avatars2.githubusercontent.com/u/24500615?v=4", "gravatar_id": "", "url": "https://api.github.com/users/malvidin", "html_url": "https://github.com/malvidin", "followers_url": "https://api.github.com/users/malvidin/followers", "following_url": "https://api.github.com/users/malvidin/following{/other_user}", "gists_url": "https://api.github.com/users/malvidin/gists{/gist_id}", "starred_url": "https://api.github.com/users/malvidin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/malvidin/subscriptions", "organizations_url": "https://api.github.com/users/malvidin/orgs", "repos_url": "https://api.github.com/users/malvidin/repos", "events_url": "https://api.github.com/users/malvidin/events{/privacy}", "received_events_url": "https://api.github.com/users/malvidin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-08T12:04:03Z", "updated_at": "2020-04-23T08:29:44Z", "closed_at": "2020-04-23T08:29:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This issue doesn't impact YARA significantly, but this rule crashes the Python interpeter. Any rule that contains metadata values that can be unescaped to `[\\x80-\\xFF]` can be used to crash any yara-python based system that doesn't specifically check for this. The rule compiles with no errors, but if the rule is run against anything, Python crashes. This was tested with yara-python 3.11.0 with Python 3.8 on Windows 10 and Ubuntu 16.04.1.\r\n\r\nhttps://github.com/VirusTotal/yara/issues/1242\r\n\r\n```\r\nimport yara\r\npython_killer = yara.compile(source=r'rule test_rule { meta: kill_python = \"\\x80\" condition: false }')\r\nmatch= python_killer.match(data='')\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/129", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/129/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/129/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/129/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/129", "id": 567191267, "node_id": "MDU6SXNzdWU1NjcxOTEyNjc=", "number": 129, "title": "meta in results do not mirror those in the command line tool or C API", "user": {"login": "Northern-Lights", "id": 8585441, "node_id": "MDQ6VXNlcjg1ODU0NDE=", "avatar_url": "https://avatars3.githubusercontent.com/u/8585441?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Northern-Lights", "html_url": "https://github.com/Northern-Lights", "followers_url": "https://api.github.com/users/Northern-Lights/followers", "following_url": "https://api.github.com/users/Northern-Lights/following{/other_user}", "gists_url": "https://api.github.com/users/Northern-Lights/gists{/gist_id}", "starred_url": "https://api.github.com/users/Northern-Lights/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Northern-Lights/subscriptions", "organizations_url": "https://api.github.com/users/Northern-Lights/orgs", "repos_url": "https://api.github.com/users/Northern-Lights/repos", "events_url": "https://api.github.com/users/Northern-Lights/events{/privacy}", "received_events_url": "https://api.github.com/users/Northern-Lights/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-18T22:14:01Z", "updated_at": "2020-02-25T00:43:37Z", "closed_at": "2020-02-25T00:43:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "Here I have a rule with a repeated meta field \"key\". In the results, only the latest one is shown because the meta field is returned as a dictionary.\r\n\r\n```python\r\n\r\nimport yara\r\n\r\nif __name__ == '__main__':\r\n    rs = yara.compile(source='rule test {meta: key = \"val1\" key=\"val2\" condition: true}')\r\n    m = rs.match(data=\"abc\")\r\n    print(m[0].meta) # {'key': 'val2'}\r\n```\r\n\r\nHere, I have the same yara rule.\r\n\r\n```\r\nrule test {\r\nmeta:\r\n\tkey = \"val1\"\r\n\tkey = \"val2\"\r\ncondition:\r\n\ttrue\r\n}\r\n```\r\n\r\nWhen I run it on the CLI with the `-m` flag, I get the following results:\r\n\r\n```\r\n> yara -m multiple_meta.yar multiple_meta.yar\r\ntest [key=\"val1\",key=\"val2\"] multiple_meta.yar\r\n```\r\n\r\nI haven't seen it discussed in the issues section as of yet, but it looks like yara-python should be returning the metadata results as a list of lists like `[ [\"key\", \"val1\"], [\"key\", \"val2\"] ]` so that keys can be repeated as in libyara", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/125", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/125/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/125/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/125/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/125", "id": 540956369, "node_id": "MDU6SXNzdWU1NDA5NTYzNjk=", "number": 125, "title": "Overflow error when using externals with large integers", "user": {"login": "tlansec", "id": 5901749, "node_id": "MDQ6VXNlcjU5MDE3NDk=", "avatar_url": "https://avatars0.githubusercontent.com/u/5901749?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tlansec", "html_url": "https://github.com/tlansec", "followers_url": "https://api.github.com/users/tlansec/followers", "following_url": "https://api.github.com/users/tlansec/following{/other_user}", "gists_url": "https://api.github.com/users/tlansec/gists{/gist_id}", "starred_url": "https://api.github.com/users/tlansec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tlansec/subscriptions", "organizations_url": "https://api.github.com/users/tlansec/orgs", "repos_url": "https://api.github.com/users/tlansec/repos", "events_url": "https://api.github.com/users/tlansec/events{/privacy}", "received_events_url": "https://api.github.com/users/tlansec/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-12-20T11:49:28Z", "updated_at": "2020-01-07T15:47:09Z", "closed_at": "2020-01-07T15:47:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hey,\r\n\r\nI recently started using yara-python with some custom externals, one of which is the size of a file which can frequently be quite large.\r\n\r\nWhen the size of the file is really large, YARA fails to evaluate this condition, here's some code and a rule to illustrate:\r\n\r\n**Rule - tmp.yar**\r\n```\r\nrule tmp\r\n{\r\n    condition:\r\n        size > 100000\r\n}\r\n```\r\n\r\n**Python - note that tmp.txt can be an empty file for the purposes of this test**\r\n```\r\nimport yara, sys \r\n\r\nsys.maxsize\r\n\r\nexternals = {\r\n    'size' : 3352428544\r\n}\r\n\r\nrules = yara.compile(\"tmp.yar\", externals=externals)\r\n\r\nmatches = rules.match(\"tmp.txt\")\r\n```\r\n\r\n**Results**\r\n```\r\n\u03bb python poc.py\r\nTraceback (most recent call last):\r\n  File \"poc.py\", line 9, in <module>\r\n    rules = yara.compile(\"tmp.yar\", externals=externals)\r\nOverflowError: Python int too large to convert to C long\r\n```\r\n\r\nTo verify, the same external when passed to the binary will work as expected.\r\n\r\nThis bug occurs on Win10x64, Python 3.6.8.\r\n\r\nCheers,\r\nTom", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/123", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/123/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/123/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/123/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/123", "id": 534138999, "node_id": "MDU6SXNzdWU1MzQxMzg5OTk=", "number": 123, "title": "yara.Match strings is not a dictionary ", "user": {"login": "wesinator", "id": 5124946, "node_id": "MDQ6VXNlcjUxMjQ5NDY=", "avatar_url": "https://avatars2.githubusercontent.com/u/5124946?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wesinator", "html_url": "https://github.com/wesinator", "followers_url": "https://api.github.com/users/wesinator/followers", "following_url": "https://api.github.com/users/wesinator/following{/other_user}", "gists_url": "https://api.github.com/users/wesinator/gists{/gist_id}", "starred_url": "https://api.github.com/users/wesinator/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wesinator/subscriptions", "organizations_url": "https://api.github.com/users/wesinator/orgs", "repos_url": "https://api.github.com/users/wesinator/repos", "events_url": "https://api.github.com/users/wesinator/events{/privacy}", "received_events_url": "https://api.github.com/users/wesinator/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-06T16:52:33Z", "updated_at": "2019-12-09T09:11:30Z", "closed_at": "2019-12-09T09:11:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://github.com/VirusTotal/yara-python/blob/df5ea5b800af1365d3988e13a37488ac344018f5/yara-python.c#L124 \r\n\r\n`strings` is a tuple, not a dict - https://yara.readthedocs.io/en/latest/yarapython.html#yara.Match.strings ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/120", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/120/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/120/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/120/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/120", "id": 524662496, "node_id": "MDU6SXNzdWU1MjQ2NjI0OTY=", "number": 120, "title": "set_config function needs to support YR_CONFIG_MAX_MATCH_DATA", "user": {"login": "kevin-haynie", "id": 4258624, "node_id": "MDQ6VXNlcjQyNTg2MjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/4258624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevin-haynie", "html_url": "https://github.com/kevin-haynie", "followers_url": "https://api.github.com/users/kevin-haynie/followers", "following_url": "https://api.github.com/users/kevin-haynie/following{/other_user}", "gists_url": "https://api.github.com/users/kevin-haynie/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevin-haynie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevin-haynie/subscriptions", "organizations_url": "https://api.github.com/users/kevin-haynie/orgs", "repos_url": "https://api.github.com/users/kevin-haynie/repos", "events_url": "https://api.github.com/users/kevin-haynie/events{/privacy}", "received_events_url": "https://api.github.com/users/kevin-haynie/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-18T22:40:56Z", "updated_at": "2020-04-23T10:08:57Z", "closed_at": "2020-04-23T10:08:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Please update set_config function to include the ability to set YR_CONFIG_MAX_MATCH_DATA.  Looks like this configuration option was added to the YARA project but not to the Python project.  \r\n\r\nIt's important to be able to change the maximum string match size even from Python.\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/119", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/119/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/119/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/119/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/119", "id": 521685088, "node_id": "MDU6SXNzdWU1MjE2ODUwODg=", "number": 119, "title": "Invalid Field Name \"imphash\" with 3.11.0", "user": {"login": "brianwarehime", "id": 403903, "node_id": "MDQ6VXNlcjQwMzkwMw==", "avatar_url": "https://avatars1.githubusercontent.com/u/403903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianwarehime", "html_url": "https://github.com/brianwarehime", "followers_url": "https://api.github.com/users/brianwarehime/followers", "following_url": "https://api.github.com/users/brianwarehime/following{/other_user}", "gists_url": "https://api.github.com/users/brianwarehime/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianwarehime/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianwarehime/subscriptions", "organizations_url": "https://api.github.com/users/brianwarehime/orgs", "repos_url": "https://api.github.com/users/brianwarehime/repos", "events_url": "https://api.github.com/users/brianwarehime/events{/privacy}", "received_events_url": "https://api.github.com/users/brianwarehime/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-11-12T17:14:40Z", "updated_at": "2019-11-14T16:08:17Z", "closed_at": "2019-11-14T15:56:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to compile a bunch of rules, however, when compiling, I get the error `invalid field name \"imphash\"`\r\n\r\nBelow is information which I think would be relevant:\r\n\r\n```(env) \u203a python3\r\nPython 3.7.5 (default, Nov  1 2019, 02:16:32)\r\n[Clang 11.0.0 (clang-1100.0.33.8)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import yara\r\n>>> yara.compile('/Users/bwarehime/repos/email-binaryalert/rules/github.com/Neo23x0/signature-base.git/yara/apt_oilrig.yar')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nyara.SyntaxError: /Users/bwarehime/repos/email-binaryalert/rules/github.com/Neo23x0/signature-base.git/yara/apt_oilrig.yar(194): invalid field name \"imphash\"\r\n\r\n\r\n(env) \u203a pip freeze | grep yara-python\r\nyara-python==3.11.0\r\n\r\n(env) \u203a yara --version\r\n3.11.0\r\n\r\n(env) \u203a brew info yara\r\nyara: stable 3.11.0 (bottled), HEAD\r\nMalware identification and classification tool\r\nhttps://github.com/VirusTotal/yara/\r\n/usr/local/Cellar/yara/3.11.0 (44 files, 1.4MB) *\r\n  Poured from bottle on 2019-11-11 at 15:19:37\r\nFrom: https://github.com/Homebrew/homebrew-core/blob/master/Formula/yara.rb\r\n==> Dependencies\r\nBuild: autoconf \u2718, automake \u2718, libtool \u2718\r\nRequired: jansson \u2714, libmagic \u2714, openssl@1.1 \u2714\r\n==> Options\r\n--HEAD\r\n\tInstall HEAD version\r\n==> Analytics\r\ninstall: 5,092 (30 days), 9,192 (90 days), 38,259 (365 days)\r\ninstall_on_request: 784 (30 days), 1,399 (90 days), 5,727 (365 days)\r\nbuild_error: 0 (30 days)```\r\n\r\nAny idea on what may be wrong? I just installed yara through brew this week, and updated yara-python today.\r\n\r\nLet me know what other information I can provide please!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/118", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/118/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/118/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/118/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/118", "id": 508189401, "node_id": "MDU6SXNzdWU1MDgxODk0MDE=", "number": 118, "title": "yara.so: undefined symbol: sk_free", "user": {"login": "careyyoung", "id": 9160429, "node_id": "MDQ6VXNlcjkxNjA0Mjk=", "avatar_url": "https://avatars3.githubusercontent.com/u/9160429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/careyyoung", "html_url": "https://github.com/careyyoung", "followers_url": "https://api.github.com/users/careyyoung/followers", "following_url": "https://api.github.com/users/careyyoung/following{/other_user}", "gists_url": "https://api.github.com/users/careyyoung/gists{/gist_id}", "starred_url": "https://api.github.com/users/careyyoung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/careyyoung/subscriptions", "organizations_url": "https://api.github.com/users/careyyoung/orgs", "repos_url": "https://api.github.com/users/careyyoung/repos", "events_url": "https://api.github.com/users/careyyoung/events{/privacy}", "received_events_url": "https://api.github.com/users/careyyoung/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-17T02:08:34Z", "updated_at": "2019-10-29T09:02:23Z", "closed_at": "2019-10-29T09:02:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "hi\r\nmy env is:\r\n    python2.7.16 miniconda\r\n    install yara by yum, yum install yara, yara-3.10.0-3.el7.x86_64\r\n    install yara-python by pip, pip install yara-python3.10.0\r\n\r\nbut, when i run in python using: import yara, it raise exception:\r\n    ImportError: /root/miniconda2/lib/python2.7/site-packages/yara.so: undefined symbol: sk_free\r\n\r\ni donot know what lib version is wrong, can you help me?\r\n\r\nthanks for you attention.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/115", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/115/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/115/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/115/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/115", "id": 489432958, "node_id": "MDU6SXNzdWU0ODk0MzI5NTg=", "number": 115, "title": "trove classifiers", "user": {"login": "rundongliu", "id": 10470019, "node_id": "MDQ6VXNlcjEwNDcwMDE5", "avatar_url": "https://avatars0.githubusercontent.com/u/10470019?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rundongliu", "html_url": "https://github.com/rundongliu", "followers_url": "https://api.github.com/users/rundongliu/followers", "following_url": "https://api.github.com/users/rundongliu/following{/other_user}", "gists_url": "https://api.github.com/users/rundongliu/gists{/gist_id}", "starred_url": "https://api.github.com/users/rundongliu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rundongliu/subscriptions", "organizations_url": "https://api.github.com/users/rundongliu/orgs", "repos_url": "https://api.github.com/users/rundongliu/repos", "events_url": "https://api.github.com/users/rundongliu/events{/privacy}", "received_events_url": "https://api.github.com/users/rundongliu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-04T22:24:16Z", "updated_at": "2019-09-24T13:15:48Z", "closed_at": "2019-09-24T13:15:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Need a trove classifier. https://pypi.org/classifiers/", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/114", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/114/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/114/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/114/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/114", "id": 486066192, "node_id": "MDU6SXNzdWU0ODYwNjYxOTI=", "number": 114, "title": "v3.10.0 - \"nocase\" setting does not produce a match, possibly due to incorrect case folding of unicode characters", "user": {"login": "ardtex", "id": 54604420, "node_id": "MDQ6VXNlcjU0NjA0NDIw", "avatar_url": "https://avatars3.githubusercontent.com/u/54604420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ardtex", "html_url": "https://github.com/ardtex", "followers_url": "https://api.github.com/users/ardtex/followers", "following_url": "https://api.github.com/users/ardtex/following{/other_user}", "gists_url": "https://api.github.com/users/ardtex/gists{/gist_id}", "starred_url": "https://api.github.com/users/ardtex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ardtex/subscriptions", "organizations_url": "https://api.github.com/users/ardtex/orgs", "repos_url": "https://api.github.com/users/ardtex/repos", "events_url": "https://api.github.com/users/ardtex/events{/privacy}", "received_events_url": "https://api.github.com/users/ardtex/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-27T22:32:02Z", "updated_at": "2019-08-30T09:10:19Z", "closed_at": "2019-08-30T08:45:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Adding \"nocase\" to a condition does not produce a match when unicode characters(in non-bmp range) are involved. This seems to be a regression from yara-python v3.6.3.\r\n\r\nCommand to run test -\r\n1. Install yara-python v3.6.3\r\n2. Extract attached zip file, cd into the folder\r\n3. Run - python yara_unicode_test.py sample_data.txt sample_rule.txt\r\n4. Check output (both rules produce a match)\r\n5. Install yara-python v3.10.0\r\n7. Run - python yara_unicode_test.py sample_data.txt sample_rule.txt\r\n8. Check output (rule with nocase condition does not produce a match)\r\n\r\n[Test.zip](https://github.com/VirusTotal/yara-python/files/3548328/Test.zip)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/107", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/107/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/107/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/107/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/107", "id": 426320033, "node_id": "MDU6SXNzdWU0MjYzMjAwMzM=", "number": 107, "title": "Error: could not map file \"<data>\" into memory", "user": {"login": "magickli", "id": 18288690, "node_id": "MDQ6VXNlcjE4Mjg4Njkw", "avatar_url": "https://avatars0.githubusercontent.com/u/18288690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/magickli", "html_url": "https://github.com/magickli", "followers_url": "https://api.github.com/users/magickli/followers", "following_url": "https://api.github.com/users/magickli/following{/other_user}", "gists_url": "https://api.github.com/users/magickli/gists{/gist_id}", "starred_url": "https://api.github.com/users/magickli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/magickli/subscriptions", "organizations_url": "https://api.github.com/users/magickli/orgs", "repos_url": "https://api.github.com/users/magickli/repos", "events_url": "https://api.github.com/users/magickli/events{/privacy}", "received_events_url": "https://api.github.com/users/magickli/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-03-28T06:26:34Z", "updated_at": "2019-03-28T06:31:14Z", "closed_at": "2019-03-28T06:31:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/105", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/105/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/105/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/105/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/105", "id": 420297550, "node_id": "MDU6SXNzdWU0MjAyOTc1NTA=", "number": 105, "title": "Permission denied", "user": {"login": "cssxn", "id": 11917920, "node_id": "MDQ6VXNlcjExOTE3OTIw", "avatar_url": "https://avatars3.githubusercontent.com/u/11917920?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cssxn", "html_url": "https://github.com/cssxn", "followers_url": "https://api.github.com/users/cssxn/followers", "following_url": "https://api.github.com/users/cssxn/following{/other_user}", "gists_url": "https://api.github.com/users/cssxn/gists{/gist_id}", "starred_url": "https://api.github.com/users/cssxn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cssxn/subscriptions", "organizations_url": "https://api.github.com/users/cssxn/orgs", "repos_url": "https://api.github.com/users/cssxn/repos", "events_url": "https://api.github.com/users/cssxn/events{/privacy}", "received_events_url": "https://api.github.com/users/cssxn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-13T03:14:14Z", "updated_at": "2019-03-13T06:24:38Z", "closed_at": "2019-03-13T06:24:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "Run the code below with PyCharm\r\n```\r\nimport yara\r\nprint yara.compile(\"rules\")\r\n```\r\n\r\nI got an error. I tried restart PyCharm with Administrator, It also doesn't work\r\n```\r\nTraceback (most recent call last):\r\n  File \"C:/Users/user/PycharmProjects/console/yara_console.py\", line 3, in <module>\r\n    print yara.compile(\"rules\")\r\nyara.Error: (13, 'Permission denied')\r\n\r\nProcess finished with exit code 1\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/101", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/101/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/101/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/101/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/101", "id": 408688078, "node_id": "MDU6SXNzdWU0MDg2ODgwNzg=", "number": 101, "title": "Load multiple? ", "user": {"login": "Tigzy", "id": 9531438, "node_id": "MDQ6VXNlcjk1MzE0Mzg=", "avatar_url": "https://avatars1.githubusercontent.com/u/9531438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Tigzy", "html_url": "https://github.com/Tigzy", "followers_url": "https://api.github.com/users/Tigzy/followers", "following_url": "https://api.github.com/users/Tigzy/following{/other_user}", "gists_url": "https://api.github.com/users/Tigzy/gists{/gist_id}", "starred_url": "https://api.github.com/users/Tigzy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Tigzy/subscriptions", "organizations_url": "https://api.github.com/users/Tigzy/orgs", "repos_url": "https://api.github.com/users/Tigzy/repos", "events_url": "https://api.github.com/users/Tigzy/events{/privacy}", "received_events_url": "https://api.github.com/users/Tigzy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-02-11T09:11:17Z", "updated_at": "2019-02-13T10:47:05Z", "closed_at": "2019-02-13T10:46:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hey, I'm looking for a way to load multiple compiled files into the same rules, is that possible?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/100", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/100/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/100/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/100/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/100", "id": 394761293, "node_id": "MDU6SXNzdWUzOTQ3NjEyOTM=", "number": 100, "title": "Handle pathlib Input", "user": {"login": "utkonos", "id": 2775739, "node_id": "MDQ6VXNlcjI3NzU3Mzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/2775739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/utkonos", "html_url": "https://github.com/utkonos", "followers_url": "https://api.github.com/users/utkonos/followers", "following_url": "https://api.github.com/users/utkonos/following{/other_user}", "gists_url": "https://api.github.com/users/utkonos/gists{/gist_id}", "starred_url": "https://api.github.com/users/utkonos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/utkonos/subscriptions", "organizations_url": "https://api.github.com/users/utkonos/orgs", "repos_url": "https://api.github.com/users/utkonos/repos", "events_url": "https://api.github.com/users/utkonos/events{/privacy}", "received_events_url": "https://api.github.com/users/utkonos/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-12-29T04:54:44Z", "updated_at": "2019-05-02T10:17:23Z", "closed_at": "2019-05-02T10:17:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using a pathlib object for the file location, the `match` method throws an exception:\r\n\r\n```\r\nimport pathlib\r\ntarget = pathlib.Path().home().joinpath('Desktop').joinpath('sample.exe')\r\nmatches = rules.match(target)\r\n\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-6-176665853c8b> in <module>\r\n----> 1 matches = rules.match(target)\r\n\r\nTypeError: argument 1 must be str, not PosixPath\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/98", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/98/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/98/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/98/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/98", "id": 370631521, "node_id": "MDU6SXNzdWUzNzA2MzE1MjE=", "number": 98, "title": "Seg fault on unicode external of string type", "user": {"login": "emiloo", "id": 15956027, "node_id": "MDQ6VXNlcjE1OTU2MDI3", "avatar_url": "https://avatars0.githubusercontent.com/u/15956027?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emiloo", "html_url": "https://github.com/emiloo", "followers_url": "https://api.github.com/users/emiloo/followers", "following_url": "https://api.github.com/users/emiloo/following{/other_user}", "gists_url": "https://api.github.com/users/emiloo/gists{/gist_id}", "starred_url": "https://api.github.com/users/emiloo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emiloo/subscriptions", "organizations_url": "https://api.github.com/users/emiloo/orgs", "repos_url": "https://api.github.com/users/emiloo/repos", "events_url": "https://api.github.com/users/emiloo/events{/privacy}", "received_events_url": "https://api.github.com/users/emiloo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-16T14:08:52Z", "updated_at": "2020-04-23T10:05:24Z", "closed_at": "2020-04-23T10:05:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "When we compile a match object with a string external, and then give that external a unicode value on match, we cause a seg fault.\r\n\r\nTested with:\r\nyara-python==3.8.1\r\nPython 2.7.15 (default, Jun 7 2018, 14:26:47)\r\n[GCC 4.8.5 20150623 (Red Hat 4.8.5-28)] on linux2\r\n\r\nSample code from ipython:\r\nIn [1]: import yara\r\n...: rule = yara.compile(source='rule foo: bar {condition: cat contains \"abc\"\r\n...: }', externals={'cat': 'abc'})\r\n...: rule.match(data='abcdefgjiklmnoprstuvwxyz', externals={'cat': u'A unicode \\u018e string \\xf1'})\r\n\r\nSegmentation fault (core dumped)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/97", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/97/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/97/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/97/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/97", "id": 370122174, "node_id": "MDU6SXNzdWUzNzAxMjIxNzQ=", "number": 97, "title": "Invalid field name \"imphash\" on 3.8.1", "user": {"login": "hxnoyd", "id": 2536497, "node_id": "MDQ6VXNlcjI1MzY0OTc=", "avatar_url": "https://avatars3.githubusercontent.com/u/2536497?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hxnoyd", "html_url": "https://github.com/hxnoyd", "followers_url": "https://api.github.com/users/hxnoyd/followers", "following_url": "https://api.github.com/users/hxnoyd/following{/other_user}", "gists_url": "https://api.github.com/users/hxnoyd/gists{/gist_id}", "starred_url": "https://api.github.com/users/hxnoyd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hxnoyd/subscriptions", "organizations_url": "https://api.github.com/users/hxnoyd/orgs", "repos_url": "https://api.github.com/users/hxnoyd/repos", "events_url": "https://api.github.com/users/hxnoyd/events{/privacy}", "received_events_url": "https://api.github.com/users/hxnoyd/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-10-15T11:38:33Z", "updated_at": "2018-11-03T23:44:26Z", "closed_at": "2018-11-03T23:44:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "The latest version of yara-python is unable to compile rules with the pe.imphash():\r\n\r\n>>> yara.YARA_VERSION\r\n'3.8.1'\r\n>>> rule = yara.compile(source='import \"pe\" rule my_imphash {condition: pe.imphash()==\"eecc824da5b175f530705611127a6b41\"}')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nyara.SyntaxError: line 1: invalid field name \"imphash\"\r\n\r\nThe same rule is parsed without problems by the yara binary of the same version.\r\n\r\nThanks in advance.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/93", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/93/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/93/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/93/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/93", "id": 349526629, "node_id": "MDU6SXNzdWUzNDk1MjY2Mjk=", "number": 93, "title": "using empty string for namespace causes segfault", "user": {"login": "unixfreak0037", "id": 372023, "node_id": "MDQ6VXNlcjM3MjAyMw==", "avatar_url": "https://avatars3.githubusercontent.com/u/372023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/unixfreak0037", "html_url": "https://github.com/unixfreak0037", "followers_url": "https://api.github.com/users/unixfreak0037/followers", "following_url": "https://api.github.com/users/unixfreak0037/following{/other_user}", "gists_url": "https://api.github.com/users/unixfreak0037/gists{/gist_id}", "starred_url": "https://api.github.com/users/unixfreak0037/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/unixfreak0037/subscriptions", "organizations_url": "https://api.github.com/users/unixfreak0037/orgs", "repos_url": "https://api.github.com/users/unixfreak0037/repos", "events_url": "https://api.github.com/users/unixfreak0037/events{/privacy}", "received_events_url": "https://api.github.com/users/unixfreak0037/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-10T13:59:22Z", "updated_at": "2018-08-14T09:57:42Z", "closed_at": "2018-08-14T09:57:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "This simple example:\r\n\r\n```\r\nimport yara\r\nyara.compile(sources={'': 'rule foo: bar {strings: $a = \"lmn\" condition: $a}'})\r\n```\r\n\r\ncauses a segfault. \r\n\r\n```\r\nCore was generated by python3 empty_namespace.py'.\r\nProgram terminated with signal SIGSEGV, Segmentation fault.\r\n#0  yr_hash (seed=seed@entry=1797928809, buffer=buffer@entry=0x23bab60, len=0) at yara/libyara/hash.c:105\r\n105         result ^= ROTATE_INT32(byte_to_int32[*b], i);\r\n(gdb) backtrace\r\n#0  yr_hash (seed=seed@entry=1797928809, buffer=buffer@entry=0x23bab60, len=0) at yara/libyara/hash.c:105\r\n#1  0x00007f786c3c6264 in _yr_hash_table_lookup (table=0x23939c0, key=key@entry=0x22ca3f0, key_length=3, ns=0x23bab60 \"\", remove=remove@entry=0) at yara/libyara/hash.c:134\r\n#2  0x00007f786c3c6498 in yr_hash_table_lookup_raw_key (table=<optimized out>, key=key@entry=0x22ca3f0, key_length=<optimized out>, ns=<optimized out>) at yara/libyara/hash.c:255\r\n#3  0x00007f786c3c660a in yr_hash_table_lookup (table=<optimized out>, key=key@entry=0x22ca3f0 \"foo\", ns=<optimized out>) at yara/libyara/hash.c:333\r\n#4  0x00007f786c3bc3e7 in yr_parser_reduce_rule_declaration_phase_1 (yyscanner=yyscanner@entry=0x2300fd0, flags=0, identifier=0x22ca3f0 \"foo\", rule=rule@entry=0x7fff1c1f1290) at yara/libyara/parser.c:725\r\n#5  0x00007f786c3ccde9 in yara_yyparse (yyscanner=0x2300fd0, compiler=compiler@entry=0x2391210) at grammar.y:256\r\n#6  0x00007f786c3bb356 in yr_lex_parse_rules_string (rules_string=0x7f786c604d60 \"rule foo: bar {strings: $a = \\\"lmn\\\" condition: $a}\", compiler=0x2391210) at lexer.l:867\r\n#7  0x00007f786c3b69a1 in yr_compiler_add_string (compiler=<optimized out>, rules_string=<optimized out>, namespace_=<optimized out>) at yara/libyara/compiler.c:636\r\n#8  0x00007f786c3b556a in yara_compile (self=<optimized out>, args=<optimized out>, keywords=<optimized out>) at yara-python.c:2054\r\n#9  0x00000000004c549b in _PyCFunction_FastCallKeywords ()\r\n#10 0x000000000054ffe4 in ?? ()\r\n#11 0x0000000000552b00 in _PyEval_EvalFrameDefault ()\r\n#12 0x000000000054fbe1 in ?? ()\r\n#13 0x0000000000550b93 in PyEval_EvalCode ()\r\n#14 0x000000000042b519 in PyRun_FileExFlags ()\r\n#15 0x000000000042b705 in PyRun_SimpleFileExFlags ()\r\n#16 0x0000000000441fcb in Py_Main ()\r\n#17 0x0000000000421ff4 in main ()\r\n(gdb) p i\r\n$1 = 18446744073708763999\r\n(gdb) x b\r\n0x247b000:      Cannot access memory at address 0x247b000\r\n(gdb) info locals\r\nb = 0x247b000 <error: Cannot access memory at address 0x247b000>\r\nresult = 2549625522\r\ni = 18446744073708763999\r\n```\r\n\r\nThe issue seems to be that `assert(len >0)` in hash.c (line 101) doesn't seem to be doing anything, maybe it's optimized out?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/92", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/92/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/92/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/92/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/92", "id": 349038571, "node_id": "MDU6SXNzdWUzNDkwMzg1NzE=", "number": 92, "title": "git tag 3.8.0 is missing on github", "user": {"login": "anthraxx", "id": 203012, "node_id": "MDQ6VXNlcjIwMzAxMg==", "avatar_url": "https://avatars0.githubusercontent.com/u/203012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anthraxx", "html_url": "https://github.com/anthraxx", "followers_url": "https://api.github.com/users/anthraxx/followers", "following_url": "https://api.github.com/users/anthraxx/following{/other_user}", "gists_url": "https://api.github.com/users/anthraxx/gists{/gist_id}", "starred_url": "https://api.github.com/users/anthraxx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anthraxx/subscriptions", "organizations_url": "https://api.github.com/users/anthraxx/orgs", "repos_url": "https://api.github.com/users/anthraxx/repos", "events_url": "https://api.github.com/users/anthraxx/events{/privacy}", "received_events_url": "https://api.github.com/users/anthraxx/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-09T09:00:33Z", "updated_at": "2018-08-09T09:50:42Z", "closed_at": "2018-08-09T09:50:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hey,\r\n\r\nlooks like someone forgot to tag and push the 3.8.0 tag as published on pypi.\r\nPlease push the corresponding tag to have a matching commit for that version on pypi.\r\n\r\ncheers and thanks a lot for the work", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/90", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/90/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/90/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/90/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/90", "id": 345826120, "node_id": "MDU6SXNzdWUzNDU4MjYxMjA=", "number": 90, "title": "Pre-built wheels for python 3.6 (and 3.7) on windows on Pypi", "user": {"login": "mephos", "id": 1419774, "node_id": "MDQ6VXNlcjE0MTk3NzQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1419774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mephos", "html_url": "https://github.com/mephos", "followers_url": "https://api.github.com/users/mephos/followers", "following_url": "https://api.github.com/users/mephos/following{/other_user}", "gists_url": "https://api.github.com/users/mephos/gists{/gist_id}", "starred_url": "https://api.github.com/users/mephos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mephos/subscriptions", "organizations_url": "https://api.github.com/users/mephos/orgs", "repos_url": "https://api.github.com/users/mephos/repos", "events_url": "https://api.github.com/users/mephos/events{/privacy}", "received_events_url": "https://api.github.com/users/mephos/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-30T16:08:00Z", "updated_at": "2018-08-03T13:41:23Z", "closed_at": "2018-08-03T13:41:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "Pre-built wheels for yara-python on windows are available on Pypi for python 2.7 to 3.5  (https://pypi.org/project/yara-python/#files)\r\n\r\nWould it be possible to build and push wheels for 3.6 and 3.7 as well?\r\n\r\nIn appveyor.yml, would it suffice to add ? :\r\n(as the following python versions are already installed on the VMs per https://www.appveyor.com/docs/build-environment/#python )\r\n\r\n```\r\n- PYTHON: \"C:\\\\Python36\"\r\n      PYTHON_VERSION: \"3.6.x\" # currently 3.6.6\r\n      PYTHON_ARCH: \"32\"\r\n      OPENSSL_LIB: \"openssl-1.1.0e-vs2015\"\r\n      VS: \"Visual Studio 14 2015\"\r\n\r\n - PYTHON: \"C:\\\\Python36-x64\"\r\n      PYTHON_VERSION: \"3.6.x\" # currently 3.6.6\r\n      PYTHON_ARCH: \"64\"\r\n      OPENSSL_LIB: \"openssl-1.1.0e-vs2015\"\r\n      VS: \"Visual Studio 14 2015 Win64\"\r\n\r\n- PYTHON: \"C:\\\\Python37\"\r\n      PYTHON_VERSION: \"3.7.x\" # currently 3.7.0\r\n      PYTHON_ARCH: \"32\"\r\n      OPENSSL_LIB: \"openssl-1.1.0e-vs2015\"\r\n      VS: \"Visual Studio 14 2015\"\r\n\r\n - PYTHON: \"C:\\\\Python37-x64\"\r\n      PYTHON_VERSION: \"3.7.x\" # currently 3.7.0\r\n      PYTHON_ARCH: \"64\"\r\n      OPENSSL_LIB: \"openssl-1.1.0e-vs2015\"\r\n      VS: \"Visual Studio 14 2015 Win64\"\r\n```\r\nThanks in advance", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/87", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/87/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/87/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/87/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/87", "id": 322467929, "node_id": "MDU6SXNzdWUzMjI0Njc5Mjk=", "number": 87, "title": "3.7.1 release", "user": {"login": "austinbyers", "id": 3608925, "node_id": "MDQ6VXNlcjM2MDg5MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/3608925?v=4", "gravatar_id": "", "url": "https://api.github.com/users/austinbyers", "html_url": "https://github.com/austinbyers", "followers_url": "https://api.github.com/users/austinbyers/followers", "following_url": "https://api.github.com/users/austinbyers/following{/other_user}", "gists_url": "https://api.github.com/users/austinbyers/gists{/gist_id}", "starred_url": "https://api.github.com/users/austinbyers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/austinbyers/subscriptions", "organizations_url": "https://api.github.com/users/austinbyers/orgs", "repos_url": "https://api.github.com/users/austinbyers/repos", "events_url": "https://api.github.com/users/austinbyers/events{/privacy}", "received_events_url": "https://api.github.com/users/austinbyers/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-12T00:33:25Z", "updated_at": "2018-08-06T15:44:01Z", "closed_at": "2018-08-06T15:44:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Can we get v3.7.1 of `yara-python` released to match the version of YARA? The commit is already in master, we just need a release.\r\n\r\nI think I'm running into problems because my version of YARA is 3.7.1, but when I `pip install yara-python` in different environments, `yara-python` builds an older version of YARA. ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/86", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/86/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/86/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/86/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/86", "id": 319408007, "node_id": "MDU6SXNzdWUzMTk0MDgwMDc=", "number": 86, "title": "Failed to import yara module.", "user": {"login": "rbshadow", "id": 12114842, "node_id": "MDQ6VXNlcjEyMTE0ODQy", "avatar_url": "https://avatars0.githubusercontent.com/u/12114842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rbshadow", "html_url": "https://github.com/rbshadow", "followers_url": "https://api.github.com/users/rbshadow/followers", "following_url": "https://api.github.com/users/rbshadow/following{/other_user}", "gists_url": "https://api.github.com/users/rbshadow/gists{/gist_id}", "starred_url": "https://api.github.com/users/rbshadow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rbshadow/subscriptions", "organizations_url": "https://api.github.com/users/rbshadow/orgs", "repos_url": "https://api.github.com/users/rbshadow/repos", "events_url": "https://api.github.com/users/rbshadow/events{/privacy}", "received_events_url": "https://api.github.com/users/rbshadow/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-05-02T04:42:08Z", "updated_at": "2018-05-20T23:02:58Z", "closed_at": "2018-05-20T23:02:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "Whenever I try to import yara module it comes from the mentioned location. And I failed to access compile function. Where is the problem?\r\n\r\n![oo](https://user-images.githubusercontent.com/12114842/39505604-42b3d372-4df5-11e8-8c7b-0e99d9e184d5.png)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/84", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/84/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/84/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/84/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/84", "id": 315706807, "node_id": "MDU6SXNzdWUzMTU3MDY4MDc=", "number": 84, "title": "yara.Rules object cannot be pickled", "user": {"login": "pwnr3", "id": 12430920, "node_id": "MDQ6VXNlcjEyNDMwOTIw", "avatar_url": "https://avatars1.githubusercontent.com/u/12430920?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pwnr3", "html_url": "https://github.com/pwnr3", "followers_url": "https://api.github.com/users/pwnr3/followers", "following_url": "https://api.github.com/users/pwnr3/following{/other_user}", "gists_url": "https://api.github.com/users/pwnr3/gists{/gist_id}", "starred_url": "https://api.github.com/users/pwnr3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pwnr3/subscriptions", "organizations_url": "https://api.github.com/users/pwnr3/orgs", "repos_url": "https://api.github.com/users/pwnr3/repos", "events_url": "https://api.github.com/users/pwnr3/events{/privacy}", "received_events_url": "https://api.github.com/users/pwnr3/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-04-19T02:36:10Z", "updated_at": "2019-12-05T23:06:06Z", "closed_at": "2018-07-30T07:11:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tried to use multiprocessing in automatic yara analysis, but the problem happens\r\n--------------------------------Trace Log----------------------\r\n```python\r\nTraceback (most recent call last):\r\n  File \"file.py\", line 139, in scan_path\r\n    pool.apply(func=worker, args=(path, filePath, rule_sets, num_first_bytes,))\r\n  File \"/usr/lib/python2.7/multiprocessing/pool.py\", line 244, in apply\r\n    return self.apply_async(func, args, kwds).get()\r\n  File \"/usr/lib/python2.7/multiprocessing/pool.py\", line 567, in get\r\n    raise self._value\r\nTypeError: can't pickle yara.Rules objects\r\n```\r\nrule_sets is a list which contain yara.Rules object(yara.compile('rule_path') result)\r\nAnother problem is that:\r\nwhen I call pool.apply_async(func=work, args=(path, filePath, rule_sets, num_first_bytes,)) rather than pool.apply way\r\ni find that function **[worker]** doesn't execute at all(I tried to print a string in func **[worker]** but nothing printed)\r\n<br />\r\nAlso tested that module **[dill]** can not handle yara.Rules object neither\r\n<br /><br />\r\n\r\nThe only way I can think up is rewriting them in C/C++\r\n Any advice to solve this problem? THX", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/83", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/83/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/83/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/83/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/83", "id": 311074015, "node_id": "MDU6SXNzdWUzMTEwNzQwMTU=", "number": 83, "title": "Trouble getting yara-python with androguard to detect", "user": {"login": "marvinsun09", "id": 23222550, "node_id": "MDQ6VXNlcjIzMjIyNTUw", "avatar_url": "https://avatars0.githubusercontent.com/u/23222550?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marvinsun09", "html_url": "https://github.com/marvinsun09", "followers_url": "https://api.github.com/users/marvinsun09/followers", "following_url": "https://api.github.com/users/marvinsun09/following{/other_user}", "gists_url": "https://api.github.com/users/marvinsun09/gists{/gist_id}", "starred_url": "https://api.github.com/users/marvinsun09/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marvinsun09/subscriptions", "organizations_url": "https://api.github.com/users/marvinsun09/orgs", "repos_url": "https://api.github.com/users/marvinsun09/repos", "events_url": "https://api.github.com/users/marvinsun09/events{/privacy}", "received_events_url": "https://api.github.com/users/marvinsun09/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-04-04T03:36:54Z", "updated_at": "2020-05-06T12:18:02Z", "closed_at": "2018-07-11T17:34:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Assuming I installed everything correctly. I am having problems triggering the yara rule with androguard and I'm not seeing errors.\r\n\r\n```\r\n<python script>\r\nimport yara\r\nimport json\r\n\r\njsonFile = open(\"yara_report.json\")\r\njsonData = jsonFile.read()\r\nJSON = json.loads(jsonData)\r\nrules = yara.compile(\"rule.yar\")\r\nmatches = rules.match(\"yara_report.json\", modules_data=JSON)\r\nprint(matches)\r\n\r\n<rule.yar>\r\nimport \"androguard\" \r\n\r\nrule byAndroguard { \r\n\tcondition: \r\n\t\tandroguard.package_name(\"com.palasandoreki.hsa2\")\r\n}\r\n\r\nrule byFile \r\n{\r\n\tstrings:\r\n\t\t$str = \"com.palasandoreki.hsa2\" nocase\t\r\n\r\n\tcondition:\r\n\t\t$str\r\n}\r\n```\r\nThe yara_report is downloaded from Koodous. I'm assuming the report JSON is loaded via modules_data? I also loaded the JSON as a file for testing purposes. \r\n\r\nAfter testing, the byFile rule triggers since the string was found in the JSON, but the byAndroguard rule didn't trigger. Not sure if I'm doing this properly. Thanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/82", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/82/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/82/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/82/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/82", "id": 309540188, "node_id": "MDU6SXNzdWUzMDk1NDAxODg=", "number": 82, "title": "Segfault reporting invalid rule string", "user": {"login": "jimrthy", "id": 481537, "node_id": "MDQ6VXNlcjQ4MTUzNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/481537?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimrthy", "html_url": "https://github.com/jimrthy", "followers_url": "https://api.github.com/users/jimrthy/followers", "following_url": "https://api.github.com/users/jimrthy/following{/other_user}", "gists_url": "https://api.github.com/users/jimrthy/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimrthy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimrthy/subscriptions", "organizations_url": "https://api.github.com/users/jimrthy/orgs", "repos_url": "https://api.github.com/users/jimrthy/repos", "events_url": "https://api.github.com/users/jimrthy/events{/privacy}", "received_events_url": "https://api.github.com/users/jimrthy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-28T21:34:09Z", "updated_at": "2018-07-30T08:30:32Z", "closed_at": "2018-07-30T08:30:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to get yara-python 3.7.0 working with the cuckoo module.\r\n\r\nI followed the instructions to clone the repo recursively, run `python setup.py build --enable-cuckoo` and `python setup.py install`.\r\n\r\nNow I'm trying to get some basic tests running.\r\n\r\nI'm setting up a string with a simple condition, calling `yara.compile(source=foo)`, setting up a dict with my cuckoo report, and then calling `rule.match(data='MALWARE', module_data=modules_dict)`\r\n\r\nyr_rules_scan_mem returns error code 6. That part shouldn't matter much.\r\n\r\nLine 1517 calls `handle_error(error, filepath)`\r\n\r\nThat takes us down to the call to PyErr_Format on line 934, which causes a segfault because the parameter `extra` is NULL.\r\n\r\nI'm not sure what the proper fix would be here. Switching to `handle_error(error, filepath || data)` seems like the quickest/easiest.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/80", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/80/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/80/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/80/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/80", "id": 307399957, "node_id": "MDU6SXNzdWUzMDczOTk5NTc=", "number": 80, "title": "OverflowError when trying to call match on big data", "user": {"login": "BartholomewPanda", "id": 3521859, "node_id": "MDQ6VXNlcjM1MjE4NTk=", "avatar_url": "https://avatars3.githubusercontent.com/u/3521859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BartholomewPanda", "html_url": "https://github.com/BartholomewPanda", "followers_url": "https://api.github.com/users/BartholomewPanda/followers", "following_url": "https://api.github.com/users/BartholomewPanda/following{/other_user}", "gists_url": "https://api.github.com/users/BartholomewPanda/gists{/gist_id}", "starred_url": "https://api.github.com/users/BartholomewPanda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BartholomewPanda/subscriptions", "organizations_url": "https://api.github.com/users/BartholomewPanda/orgs", "repos_url": "https://api.github.com/users/BartholomewPanda/repos", "events_url": "https://api.github.com/users/BartholomewPanda/events{/privacy}", "received_events_url": "https://api.github.com/users/BartholomewPanda/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-03-21T20:09:09Z", "updated_at": "2018-07-30T08:33:06Z", "closed_at": "2018-07-30T08:33:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When I try to call the `match` method on large data, an `OverflowException` occurs. Here is a simple example : \r\n\r\n```python\r\nimport yara\r\n\r\n# the capture size is 2.3G\r\nwith open('../captures/bg1.pcap', 'rb') as f:\r\n    data = f.read()\r\n\r\nrule = yara.compile(source='rule foo: bar {strings: $a = \"lmn\" condition: $a}')\r\nmatchs = rule.match(data=data)\r\n```\r\n\r\nHere is the result :\r\n\r\n```bash\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 10, in <module>\r\n    matchs = rule.match(data=data)\r\nOverflowError: size does not fit in an int\r\n```\r\n\r\nAfter reading the file `yara-python.c`, I saw that the problem comes from the call to the function `PyArg_ParseTupleAndKeywords` (line 1372) and more specifically from the format chunk `s#`. Indeed, as specified in the Python documentation (https://docs.python.org/3/c-api/arg.html) :\r\n\r\n>  For all # variants of formats (s#, y#, etc.), the type of the length argument (int or Py_ssize_t) is controlled by defining the macro PY_SSIZE_T_CLEAN before including Python.h. If the macro was defined, length is a Py_ssize_t rather than an int. This behavior will change in a future Python version to only support Py_ssize_t and drop int support. It is best to always define PY_SSIZE_T_CLEAN.\r\n\r\nIn order to fix this problem, I'll propose a simple pull request (just define the macro).    ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/79", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/79/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/79/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/79/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/79", "id": 306900299, "node_id": "MDU6SXNzdWUzMDY5MDAyOTk=", "number": 79, "title": "Memory leak", "user": {"login": "JScharloo", "id": 7700008, "node_id": "MDQ6VXNlcjc3MDAwMDg=", "avatar_url": "https://avatars0.githubusercontent.com/u/7700008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JScharloo", "html_url": "https://github.com/JScharloo", "followers_url": "https://api.github.com/users/JScharloo/followers", "following_url": "https://api.github.com/users/JScharloo/following{/other_user}", "gists_url": "https://api.github.com/users/JScharloo/gists{/gist_id}", "starred_url": "https://api.github.com/users/JScharloo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JScharloo/subscriptions", "organizations_url": "https://api.github.com/users/JScharloo/orgs", "repos_url": "https://api.github.com/users/JScharloo/repos", "events_url": "https://api.github.com/users/JScharloo/events{/privacy}", "received_events_url": "https://api.github.com/users/JScharloo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-03-20T14:52:39Z", "updated_at": "2018-08-27T06:53:39Z", "closed_at": "2018-08-27T06:53:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using this library for fast multi-threaded file analysis, some internal datastructures in the match functionality are not garbage collected properly. Weak references remain in system memory. I have not yet found the source of this issue within the module source code itself, but when running the library over several thousand files you can see that the memory builds up. I have eliminated every other possible cause.\r\n\r\nWhen I find more I will let you know and/or make a pull request. Until then please be notified.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/78", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/78/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/78/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/78/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/78", "id": 297815219, "node_id": "MDU6SXNzdWUyOTc4MTUyMTk=", "number": 78, "title": "\"includes are disabled\" when includes=True", "user": {"login": "gregcopenhaver", "id": 66283, "node_id": "MDQ6VXNlcjY2Mjgz", "avatar_url": "https://avatars3.githubusercontent.com/u/66283?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gregcopenhaver", "html_url": "https://github.com/gregcopenhaver", "followers_url": "https://api.github.com/users/gregcopenhaver/followers", "following_url": "https://api.github.com/users/gregcopenhaver/following{/other_user}", "gists_url": "https://api.github.com/users/gregcopenhaver/gists{/gist_id}", "starred_url": "https://api.github.com/users/gregcopenhaver/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gregcopenhaver/subscriptions", "organizations_url": "https://api.github.com/users/gregcopenhaver/orgs", "repos_url": "https://api.github.com/users/gregcopenhaver/repos", "events_url": "https://api.github.com/users/gregcopenhaver/events{/privacy}", "received_events_url": "https://api.github.com/users/gregcopenhaver/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-02-16T15:07:30Z", "updated_at": "2018-08-01T08:01:06Z", "closed_at": "2018-08-01T08:01:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using yara.compile, and specifying includes=True, I get an exception that says \"includes are disabled\". This is the opposite behavior compared to past versions such as 3.4 and 3.5, and contradicts the documentation at http://yara.readthedocs.io/en/v3.7.0/yarapython.html\r\n```\r\n$ cat /tmp/test1.yara\r\ninclude \"test2.yara\"\r\n```\r\n```\r\n>>> yara.compile(filepath=\"/tmp/test1.yara\")\r\n<yara.Rules object at 0x7f91a27e1ad0>\r\n\r\n>>> yara.compile(filepath=\"/tmp/test1.yara\", includes=True)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nyara.SyntaxError: /tmp/test1.yara(1): includes are disabled\r\n\r\n>>> yara.compile(filepath=\"/tmp/test1.yara\", includes=False)\r\n<yara.Rules object at 0x7f91a27e1b48>\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/77", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/77/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/77/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/77/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/77", "id": 294978682, "node_id": "MDU6SXNzdWUyOTQ5Nzg2ODI=", "number": 77, "title": "have problem in yara.CALLBACK_MATCHES", "user": {"login": "nanshihui", "id": 6913510, "node_id": "MDQ6VXNlcjY5MTM1MTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6913510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nanshihui", "html_url": "https://github.com/nanshihui", "followers_url": "https://api.github.com/users/nanshihui/followers", "following_url": "https://api.github.com/users/nanshihui/following{/other_user}", "gists_url": "https://api.github.com/users/nanshihui/gists{/gist_id}", "starred_url": "https://api.github.com/users/nanshihui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nanshihui/subscriptions", "organizations_url": "https://api.github.com/users/nanshihui/orgs", "repos_url": "https://api.github.com/users/nanshihui/repos", "events_url": "https://api.github.com/users/nanshihui/events{/privacy}", "received_events_url": "https://api.github.com/users/nanshihui/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2018-02-07T01:51:56Z", "updated_at": "2018-08-01T08:09:09Z", "closed_at": "2018-08-01T08:09:09Z", "author_association": "NONE", "active_lock_reason": null, "body": " I installed  yara-python and the version is 3.7.\r\n However ,i used yara.CALLBACK_MATCHES it showed \r\n'module' object has no attribute 'CALLBACK_MATCHES'", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/76", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/76/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/76/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/76/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/76", "id": 294093753, "node_id": "MDU6SXNzdWUyOTQwOTM3NTM=", "number": 76, "title": "do not work with --dynamic-linking", "user": {"login": "nanshihui", "id": 6913510, "node_id": "MDQ6VXNlcjY5MTM1MTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6913510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nanshihui", "html_url": "https://github.com/nanshihui", "followers_url": "https://api.github.com/users/nanshihui/followers", "following_url": "https://api.github.com/users/nanshihui/following{/other_user}", "gists_url": "https://api.github.com/users/nanshihui/gists{/gist_id}", "starred_url": "https://api.github.com/users/nanshihui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nanshihui/subscriptions", "organizations_url": "https://api.github.com/users/nanshihui/orgs", "repos_url": "https://api.github.com/users/nanshihui/repos", "events_url": "https://api.github.com/users/nanshihui/events{/privacy}", "received_events_url": "https://api.github.com/users/nanshihui/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-02-03T08:11:55Z", "updated_at": "2018-07-30T09:14:41Z", "closed_at": "2018-07-30T09:14:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "when i typed with 'sudo python setup.py install --dynamic-linking'.\r\nit return 'error: option --dynamic-linking not recognized'", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/75", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/75/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/75/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/75/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/75", "id": 292353371, "node_id": "MDU6SXNzdWUyOTIzNTMzNzE=", "number": 75, "title": "SyntaxError when use import module such as cuckoo, androguard", "user": {"login": "cmderpt", "id": 35682640, "node_id": "MDQ6VXNlcjM1NjgyNjQw", "avatar_url": "https://avatars0.githubusercontent.com/u/35682640?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cmderpt", "html_url": "https://github.com/cmderpt", "followers_url": "https://api.github.com/users/cmderpt/followers", "following_url": "https://api.github.com/users/cmderpt/following{/other_user}", "gists_url": "https://api.github.com/users/cmderpt/gists{/gist_id}", "starred_url": "https://api.github.com/users/cmderpt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cmderpt/subscriptions", "organizations_url": "https://api.github.com/users/cmderpt/orgs", "repos_url": "https://api.github.com/users/cmderpt/repos", "events_url": "https://api.github.com/users/cmderpt/events{/privacy}", "received_events_url": "https://api.github.com/users/cmderpt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-01-29T10:24:07Z", "updated_at": "2018-02-06T08:18:59Z", "closed_at": "2018-02-06T08:08:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nWhen I try to run yara on commandline, everything is ok but when I use `yara-python`, I recieved errors:\r\n```python\r\n>>> import yara\r\n>>> rules = yara.compile('Android_ASSDdeveloper.yar')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nyara.SyntaxError: Android_ASSDdeveloper.yar(22): invalid field name \"certificate\"\r\n```\r\nAndroid_ASSDdeveloper.yar use [androguard-yara](https://github.com/Koodous/androguard-yara). And I had copy androguard.c into libyara/modules then do follow guide.\r\n\r\nAnother yara rule use cuckoo module throw error when I run by `yara-python`\r\n```python\r\n>>> import yara\r\n>>> rules = yara.compile('MALW_AZORULT.yar')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nyara.SyntaxError: MALW_AZORULT.yar(23): invalid field name \"sync\"\r\n```\r\nI had run `./configure --enable-cuckoo --enable-magic --enable-dotnet` when compile yara.\r\n\r\nThose rules are taken from https://github.com/Yara-Rules/rules\r\n\r\nI don't know where was I wrong? :(", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/70", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/70/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/70/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/70/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/70", "id": 278276955, "node_id": "MDU6SXNzdWUyNzgyNzY5NTU=", "number": 70, "title": "No Modules named 'yara'", "user": {"login": "adam-greer", "id": 18645597, "node_id": "MDQ6VXNlcjE4NjQ1NTk3", "avatar_url": "https://avatars2.githubusercontent.com/u/18645597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adam-greer", "html_url": "https://github.com/adam-greer", "followers_url": "https://api.github.com/users/adam-greer/followers", "following_url": "https://api.github.com/users/adam-greer/following{/other_user}", "gists_url": "https://api.github.com/users/adam-greer/gists{/gist_id}", "starred_url": "https://api.github.com/users/adam-greer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adam-greer/subscriptions", "organizations_url": "https://api.github.com/users/adam-greer/orgs", "repos_url": "https://api.github.com/users/adam-greer/repos", "events_url": "https://api.github.com/users/adam-greer/events{/privacy}", "received_events_url": "https://api.github.com/users/adam-greer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-11-30T21:32:13Z", "updated_at": "2018-08-01T08:12:30Z", "closed_at": "2018-08-01T08:12:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Trying to install yara-python on deb.  No install issues using \r\npython setup.py\r\npython setup.py build\r\nsudo python setup.py install\r\n\r\nHowever when I run my .py to import yara I get:\r\npython3 1129.py\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/scripts/script1/1129.py\", line 3, in <module>\r\n    import yara\r\nImportError: No module named 'yara'\r\n---------------------\r\n\r\n>>> help('modules')\r\n\r\nPlease wait a moment while I gather a list of all available modules...\r\n\r\nFailed to connect to Mir: Failed to connect to server socket: No such file or directory\r\nUnable to init server: Could not connect: Connection refused\r\nFailed to connect to Mir: Failed to connect to server socket: No such file or directory\r\nUnable to init server: Could not connect: Connection refused\r\n/usr/lib/python3/dist-packages/UpdateManager/Dialogs.py:25: PyGIWarning: Gtk was imported without specifying a version first. Use gi.require_version('Gtk', '3.0') before import to ensure that the right version gets loaded.\r\n  from gi.repository import Gtk\r\n/usr/lib/python3/dist-packages/pyatspi/__init__.py:17: PyGIWarning: Atspi was imported without specifying a version first. Use gi.require_version('Atspi', '2.0') before import to ensure that the right version gets loaded.\r\n  from gi.repository import Atspi\r\n/usr/lib/python3/dist-packages/usbcreator/backends/udisks/backend.py:4: PyGIWarning: UDisks was imported without specifying a version first. Use gi.require_version('UDisks', '2.0') before import to ensure that the right version gets loaded.\r\n  from gi.repository import Gio, GLib, UDisks\r\n/usr/lib/python3/dist-packages/usbcreator/frontends/gtk/unitysupport.py:27: PyGIWarning: Unity was imported without specifying a version first. Use gi.require_version('Unity', '7.0') before import to ensure that the right version gets loaded.\r\n  from gi.repository import Unity\r\nAptUrl              apport_python_hook  hmac                resource\r\nCDROM               apt                 hpmudext            rlcompleter\r\nCommandNotFound     apt_inst            html                runpy\r\nDLFCN               apt_pkg             html5lib            scanext\r\nDistUpgrade         aptdaemon           http                sched\r\nIN                  aptsources          httplib2            select\r\nLanguageSelector    argparse            idlelib             selectors\r\nNvidiaDetector      array               idna                sessioninstaller\r\nOnboard             ast                 imaplib             setup\r\nPIL                 asynchat            imghdr              setuptools\r\nQuirks              asyncio             imp                 shelve\r\nTYPES               asyncore            importlib           shlex\r\nUbuntuDrivers       atexit              inspect             shutil\r\nUbuntuSystemService audioop             io                  signal\r\nUpdateManager       base64              ipaddress           site\r\n__future__          bdb                 itertools           sitecustomize\r\n_ast                binascii            janitor             six\r\n_bisect             binhex              jinja2              smtpd\r\n_bootlocale         bisect              json                smtplib\r\n_bz2                blinker             jwt                 sndhdr\r\n_cffi_backend       brlapi              keyword             socket\r\n_codecs             bs4                 language_support_pkgs socketserver\r\n_codecs_cn          builtins            lib2to3             softwareproperties\r\n_codecs_hk          bz2                 linecache           speechd\r\n_codecs_iso2022     cProfile            locale              speechd_config\r\n_codecs_jp          cairo               logging             spwd\r\n_codecs_kr          calendar            louis               sqlite3\r\n_codecs_tw          cgi                 lsb_release         sre_compile\r\n_collections        cgitb               lxml                sre_constants\r\n_collections_abc    chardet             lzma                sre_parse\r\n_compat_pickle      checkbox_support    macpath             ssh_import_id\r\n_compression        chunk               macurl2path         ssl\r\n_crypt              cmath               mailbox             stat\r\n_csv                cmd                 mailcap             statistics\r\n_ctypes             code                mako                string\r\n_ctypes_test        codecs              markupsafe          stringprep\r\n_curses             codeop              marshal             struct\r\n_curses_panel       collections         math                subprocess\r\n_datetime           colorsys            mimetypes           sunau\r\n_dbm                compileall          mmap                symbol\r\n_dbus_bindings      concurrent          modulefinder        symtable\r\n_dbus_glib_bindings configparser        multiprocessing     sys\r\n_decimal            contextlib          netrc               sysconfig\r\n_dummy_thread       copy                nis                 syslog\r\n_elementtree        copyreg             nntplib             systemd\r\n_functools          crypt               ntpath              tabnanny\r\n_gdbm               cryptography        nturl2path          tarfile\r\n_hashlib            csv                 numbers             telnetlib\r\n_heapq              ctypes              oauthlib            tempfile\r\n_imp                cups                opcode              termios\r\n_io                 cupsext             operator            test\r\n_json               cupshelpers         optparse            tests\r\n_locale             curl                orca                textwrap\r\n_lsprof             curses              os                  this\r\n_lzma               datetime            ossaudiodev         threading\r\n_markupbase         dbm                 padme               time\r\n_md5                dbus                parser              timeit\r\n_multibytecodec     deb822              pathlib             tkinter\r\n_multiprocessing    debconf             pcardext            token\r\n_opcode             debian              pdb                 tokenize\r\n_operator           debian_bundle       pexpect             trace\r\n_osx_support        decimal             pickle              traceback\r\n_pickle             defer               pickletools         tracemalloc\r\n_posixsubprocess    difflib             pipes               tty\r\n_pydecimal          dis                 pkg_resources       turtle\r\n_pyio               distutils           pkgutil             types\r\n_random             doctest             plainbox            typing\r\n_sha1               dummy_threading     platform            ufw\r\n_sha256             easy_install        plistlib            unicodedata\r\n_sha512             email               poplib              unittest\r\n_signal             encodings           posix               uno\r\n_sitebuiltins       enum                posixpath           unohelper\r\n_socket             errno               pprint              urllib\r\n_sqlite3            faulthandler        problem_report      urllib3\r\n_sre                fcntl               profile             usbcreator\r\n_ssl                feedparser          pstats              uu\r\n_stat               feedparser_sgmllib3 pty                 uuid\r\n_string             filecmp             ptyprocess          venv\r\n_strptime           fileinput           pwd                 warnings\r\n_struct             fnmatch             py_compile          wave\r\n_symtable           formatter           pyasn1              weakref\r\n_sysconfigdata      fpectl              pyatspi             webbrowser\r\n_sysconfigdata_m    fractions           pyclbr              wsgiref\r\n_testbuffer         ftplib              pycurl              xdg\r\n_testcapi           functools           pydoc               xdiagnose\r\n_testimportmultiple gc                  pydoc_data          xdrlib\r\n_testmultiphase     genericpath         pyexpat             xkit\r\n_thread             getopt              pygtkcompat         xlsxwriter\r\n_threading_local    getpass             pyparsing           xml\r\n_tracemalloc        gettext             queue               xmlrpc\r\n_warnings           gi                  quopri              xxlimited\r\n_weakref            glob                random              xxsubtype\r\n_weakrefset         grp                 re                  zipapp\r\nabc                 guacamole           readline            zipfile\r\naifc                gzip                reportlab           zipimport\r\nantigravity         hashlib             reprlib             zlib\r\napport              heapq               requests\r\n\r\nEnter any module name to get more help.  Or, type \"modules spam\" to search\r\nfor modules whose name or summary contain the string \"spam\".\r\n\r\n>>>\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/57", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/57/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/57/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/57/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/57", "id": 253166422, "node_id": "MDU6SXNzdWUyNTMxNjY0MjI=", "number": 57, "title": "Fails to build (YR_OBJECT {aka struct _YR_OBJECT}\u2019 has no member named \u2018value\u2019)", "user": {"login": "DigiAngel", "id": 947191, "node_id": "MDQ6VXNlcjk0NzE5MQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/947191?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DigiAngel", "html_url": "https://github.com/DigiAngel", "followers_url": "https://api.github.com/users/DigiAngel/followers", "following_url": "https://api.github.com/users/DigiAngel/following{/other_user}", "gists_url": "https://api.github.com/users/DigiAngel/gists{/gist_id}", "starred_url": "https://api.github.com/users/DigiAngel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DigiAngel/subscriptions", "organizations_url": "https://api.github.com/users/DigiAngel/orgs", "repos_url": "https://api.github.com/users/DigiAngel/repos", "events_url": "https://api.github.com/users/DigiAngel/events{/privacy}", "received_events_url": "https://api.github.com/users/DigiAngel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-08-27T14:15:01Z", "updated_at": "2017-08-29T11:03:28Z", "closed_at": "2017-08-29T11:03:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Latest git as of a few minutes ago gives me:\r\n~~~\r\nx86_64-linux-gnu-gcc -pthread -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fno-strict-aliasing -Wdate-time -D_FORTIFY_SOURCE=2 -g -fstack-protector-strong -Wformat -Werror=format-security -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -DHAVE_LIBCRYPTO=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara-python.c -o build/temp.linux-x86_64-2.7/yara-python.o\r\nyara-python.c: In function \u2018convert_object_to_python\u2019:\r\nyara-python.c:420:17: error: \u2018YR_OBJECT {aka struct _YR_OBJECT}\u2019 has no member named \u2018value\u2019\r\n       if (object->value.i != UNDEFINED)\r\n                 ^\r\nyara-python.c:421:43: error: \u2018YR_OBJECT {aka struct _YR_OBJECT}\u2019 has no member named \u2018value\u2019\r\n         result = Py_BuildValue(\"i\", object->value.i);\r\n                                           ^\r\nyara-python.c:425:17: error: \u2018YR_OBJECT {aka struct _YR_OBJECT}\u2019 has no member named \u2018value\u2019\r\n       if (object->value.ss != NULL)\r\n                 ^\r\nyara-python.c:427:19: error: \u2018YR_OBJECT {aka struct _YR_OBJECT}\u2019 has no member named \u2018value\u2019\r\n             object->value.ss->c_string,\r\n                   ^\r\nyara-python.c:428:19: error: \u2018YR_OBJECT {aka struct _YR_OBJECT}\u2019 has no member named \u2018value\u2019\r\n             object->value.ss->length);\r\n                   ^\r\nyara-python.c:432:44: warning: implicit declaration of function \u2018object_as_structure\u2019 [-Wimplicit-function-declaration]\r\n       result = convert_structure_to_python(object_as_structure(object));\r\n                                            ^\r\nyara-python.c:432:44: warning: passing argument 1 of \u2018convert_structure_to_python\u2019 makes pointer from integer without a cast [-Wint-conversion]\r\nyara-python.c:397:11: note: expected \u2018YR_OBJECT_STRUCTURE * {aka struct _YR_OBJECT_STRUCTURE *}\u2019 but argument is of type \u2018int\u2019\r\n PyObject* convert_structure_to_python(\r\n           ^\r\nyara-python.c:436:40: warning: implicit declaration of function \u2018object_as_array\u2019 [-Wimplicit-function-declaration]\r\n       result = convert_array_to_python(object_as_array(object));\r\n                                        ^\r\nyara-python.c:436:40: warning: passing argument 1 of \u2018convert_array_to_python\u2019 makes pointer from integer without a cast [-Wint-conversion]\r\nyara-python.c:401:11: note: expected \u2018YR_OBJECT_ARRAY * {aka struct _YR_OBJECT_ARRAY *}\u2019 but argument is of type \u2018int\u2019\r\n PyObject* convert_array_to_python(\r\n           ^\r\nyara-python.c:444:45: warning: implicit declaration of function \u2018object_as_dictionary\u2019 [-Wimplicit-function-declaration]\r\n       result = convert_dictionary_to_python(object_as_dictionary(object));\r\n                                             ^\r\nyara-python.c:444:45: warning: passing argument 1 of \u2018convert_dictionary_to_python\u2019 makes pointer from integer without a cast [-Wint-conversion]\r\nyara-python.c:405:11: note: expected \u2018YR_OBJECT_DICTIONARY * {aka struct _YR_OBJECT_DICTIONARY *}\u2019 but argument is of type \u2018int\u2019\r\n PyObject* convert_dictionary_to_python(\r\n           ^\r\nIn file included from /usr/include/python2.7/pyport.h:325:0,\r\n                 from /usr/include/python2.7/Python.h:58,\r\n                 from yara-python.c:18:\r\nyara-python.c:448:24: error: \u2018YR_OBJECT {aka struct _YR_OBJECT}\u2019 has no member named \u2018value\u2019\r\n       if (!isnan(object->value.d))\r\n                        ^\r\nyara-python.c:449:43: error: \u2018YR_OBJECT {aka struct _YR_OBJECT}\u2019 has no member named \u2018value\u2019\r\n         result = Py_BuildValue(\"d\", object->value.d);\r\n                                           ^\r\nyara-python.c: In function \u2018yara_callback\u2019:\r\nyara-python.c:638:9: warning: passing argument 1 of \u2018convert_structure_to_python\u2019 makes pointer from integer without a cast [-Wint-conversion]\r\n         object_as_structure(message_data));\r\n         ^\r\nyara-python.c:460:11: note: expected \u2018YR_OBJECT_STRUCTURE * {aka struct _YR_OBJECT_STRUCTURE *}\u2019 but argument is of type \u2018int\u2019\r\n PyObject* convert_structure_to_python(\r\n           ^\r\nyara-python.c:643:57: error: invalid type argument of \u2018->\u2019 (have \u2018int\u2019)\r\n     object = PY_STRING(object_as_structure(message_data)->identifier);\r\n                                                         ^\r\nyara-python.c:52:42: note: in definition of macro \u2018PY_STRING\u2019\r\n #define PY_STRING(x) PyString_FromString(x)\r\n                                          ^\r\nyara-python.c:721:60: error: \u2018YR_MATCH {aka struct _YR_MATCH}\u2019 has no member named \u2018data_length\u2019\r\n       object = PyBytes_FromStringAndSize((char*) m->data, m->data_length);\r\n                                                            ^\r\nyara-python.c: In function \u2018handle_error\u2019:\r\nyara-python.c:908:10: error: \u2018ERROR_INSUFFICIENT_MEMORY\u2019 undeclared (first use in this function)\r\n     case ERROR_INSUFFICIENT_MEMORY:\r\n          ^\r\nyara-python.c:908:10: note: each undeclared identifier is reported only once for each function it appears in\r\nyara-python.c:934:10: error: \u2018ERROR_INVALID_EXTERNAL_VARIABLE_TYPE\u2019 undeclared (first use in this function)\r\n     case ERROR_INVALID_EXTERNAL_VARIABLE_TYPE:\r\n          ^\r\nyara-python.c: In function \u2018yara_compile\u2019:\r\nyara-python.c:1957:31: error: \u2018ERROR_INSUFFICIENT_MEMORY\u2019 undeclared (first use in this function)\r\n         result = handle_error(ERROR_INSUFFICIENT_MEMORY, NULL);\r\n                               ^\r\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n~~~\r\n\r\nI saw the previous closed ERROR_INSUFFICIENT_MEMORY, but I thought that was fixed.  Thank you.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/54", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/54/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/54/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/54/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/54", "id": 243706779, "node_id": "MDU6SXNzdWUyNDM3MDY3Nzk=", "number": 54, "title": "With 3.6.3 the test testCompileFile throws segmentation fault on s390x architecture", "user": {"login": "xambroz", "id": 723625, "node_id": "MDQ6VXNlcjcyMzYyNQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/723625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xambroz", "html_url": "https://github.com/xambroz", "followers_url": "https://api.github.com/users/xambroz/followers", "following_url": "https://api.github.com/users/xambroz/following{/other_user}", "gists_url": "https://api.github.com/users/xambroz/gists{/gist_id}", "starred_url": "https://api.github.com/users/xambroz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xambroz/subscriptions", "organizations_url": "https://api.github.com/users/xambroz/orgs", "repos_url": "https://api.github.com/users/xambroz/repos", "events_url": "https://api.github.com/users/xambroz/events{/privacy}", "received_events_url": "https://api.github.com/users/xambroz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-07-18T12:58:21Z", "updated_at": "2019-03-18T23:44:40Z", "closed_at": "2019-03-18T23:44:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nwith the version 3.6.x (3.6.3 to be precise) the test testCompileFile throws segmentation fault on the s390x architecture.\r\nThis might or might not be related to issues with tests failing randomly on ppc and s390x architecture as reported in the issue https://github.com/VirusTotal/yara-python/issues/25 \r\n\r\nhttps://kojipkgs.fedoraproject.org//work/tasks/9619/20589619/build.log\r\nThis test testCompileFile was working fine with the version 3.5.0 on s390x platform.\r\n\r\n```\r\nExecuting(%check): /bin/sh -e /var/tmp/rpm-tmp.VEYfW8\r\n+ umask 022\r\n+ cd /builddir/build/BUILD\r\n+ cd yara-python-3.6.3\r\n+ EXCLUDE=\r\n+ EXCLUDE='--exclude=^testModuleData$|^testEntrypoint$|^testIn$|^testIntegerFunctions$'\r\n++ ls /usr/bin/nosetests-2.7\r\n+ NOSETESTS2=/usr/bin/nosetests-2.7\r\n+ PYTHONPATH=/builddir/build/BUILDROOT/python-yara-3.6.3-2.fc27.s390x//usr/lib64/python2.7/site-packages/\r\n+ /usr/bin/nosetests-2.7 -v '--exclude=^testModuleData$|^testEntrypoint$|^testIn$|^testIntegerFunctions$'\r\ntestAnonymousStrings (tests.TestYara) ... ok\r\ntestArithmeticOperators (tests.TestYara) ... ok\r\ntestAt (tests.TestYara) ... ok\r\ntestBitwiseOperators (tests.TestYara) ... ok\r\ntestBooleanOperators (tests.TestYara) ... ok\r\ntestCallback (tests.TestYara) ... ok\r\ntestComments (tests.TestYara) ... ok\r\ntestCompare (tests.TestYara) ... ok\r\ntestComparisonOperators (tests.TestYara) ... ok\r\ntestCompileFile (tests.TestYara) ... /var/tmp/rpm-tmp.VEYfW8: line 43: 21200 Segmentation fault      (core dumped) PYTHONPATH=/builddir/build/BUILDROOT/python-yara-3.6.3-2.fc27.s390x//usr/lib64/python2.7/site-packages/ \"$NOSETESTS2\" -v \"$EXCLUDE\"\r\nerror: Bad exit status from /var/tmp/rpm-tmp.VEYfW8 (%check)\r\n\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/52", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/52/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/52/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/52/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/52", "id": 241972974, "node_id": "MDU6SXNzdWUyNDE5NzI5NzQ=", "number": 52, "title": "Cannot use yara-python to compile rules when adding new modules(Androguard or cuckoo) in yara", "user": {"login": "maoqyhz", "id": 20581706, "node_id": "MDQ6VXNlcjIwNTgxNzA2", "avatar_url": "https://avatars3.githubusercontent.com/u/20581706?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maoqyhz", "html_url": "https://github.com/maoqyhz", "followers_url": "https://api.github.com/users/maoqyhz/followers", "following_url": "https://api.github.com/users/maoqyhz/following{/other_user}", "gists_url": "https://api.github.com/users/maoqyhz/gists{/gist_id}", "starred_url": "https://api.github.com/users/maoqyhz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maoqyhz/subscriptions", "organizations_url": "https://api.github.com/users/maoqyhz/orgs", "repos_url": "https://api.github.com/users/maoqyhz/repos", "events_url": "https://api.github.com/users/maoqyhz/events{/privacy}", "received_events_url": "https://api.github.com/users/maoqyhz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-07-11T08:51:55Z", "updated_at": "2017-07-11T12:27:28Z", "closed_at": "2017-07-11T12:26:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "I want to use **Androguard** and **cuckoo** in yara, so i recompile yara. And in command-line, it can work well, But when i use yara-python, it raise some error, just like.\r\n```\r\nrule = yara.compile(source='import \"cuckoo\"')\r\nyara.SyntaxError: line 1: unknown module \"cuckoo\"\r\n```\r\nso how to fix it?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/51", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/51/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/51/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/51/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/51", "id": 241633949, "node_id": "MDU6SXNzdWUyNDE2MzM5NDk=", "number": 51, "title": "AttributeError: 'module' object has no attribute 'compile'", "user": {"login": "mylamour", "id": 12653147, "node_id": "MDQ6VXNlcjEyNjUzMTQ3", "avatar_url": "https://avatars3.githubusercontent.com/u/12653147?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mylamour", "html_url": "https://github.com/mylamour", "followers_url": "https://api.github.com/users/mylamour/followers", "following_url": "https://api.github.com/users/mylamour/following{/other_user}", "gists_url": "https://api.github.com/users/mylamour/gists{/gist_id}", "starred_url": "https://api.github.com/users/mylamour/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mylamour/subscriptions", "organizations_url": "https://api.github.com/users/mylamour/orgs", "repos_url": "https://api.github.com/users/mylamour/repos", "events_url": "https://api.github.com/users/mylamour/events{/privacy}", "received_events_url": "https://api.github.com/users/mylamour/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-07-10T08:17:53Z", "updated_at": "2017-07-11T06:29:12Z", "closed_at": "2017-07-11T06:29:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nTraceback (most recent call last):\r\n  File \"yara.py\", line 5, in <module>\r\n    import yara\r\n  File \"/home/mour/working/script/yara.py\", line 8, in <module>\r\n    rules = yara.compile(\"./php.yar\")\r\nAttributeError: 'module' object has no attribute 'compile'\r\n```\r\nI don't know what's wrong with it, No matter what, I use `pip install yara-python` also compile from source code, always was wrong. \r\n```\r\nconda:  python version: 3.6\r\nyara lastst version compile from source code\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/50", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/50/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/50/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/50/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/50", "id": 239724421, "node_id": "MDU6SXNzdWUyMzk3MjQ0MjE=", "number": 50, "title": "Compiled Rules file is not handled in yara-python", "user": {"login": "rainaashutosh", "id": 16841220, "node_id": "MDQ6VXNlcjE2ODQxMjIw", "avatar_url": "https://avatars0.githubusercontent.com/u/16841220?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rainaashutosh", "html_url": "https://github.com/rainaashutosh", "followers_url": "https://api.github.com/users/rainaashutosh/followers", "following_url": "https://api.github.com/users/rainaashutosh/following{/other_user}", "gists_url": "https://api.github.com/users/rainaashutosh/gists{/gist_id}", "starred_url": "https://api.github.com/users/rainaashutosh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rainaashutosh/subscriptions", "organizations_url": "https://api.github.com/users/rainaashutosh/orgs", "repos_url": "https://api.github.com/users/rainaashutosh/repos", "events_url": "https://api.github.com/users/rainaashutosh/events{/privacy}", "received_events_url": "https://api.github.com/users/rainaashutosh/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-06-30T09:25:10Z", "updated_at": "2018-08-01T09:16:38Z", "closed_at": "2018-08-01T09:16:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "Issue:\r\nyara.load method is throwing an unknown error when yara compiled file is passed on as input.\r\nI have tried using both filepath and file args in method but it shows the same error\r\n\r\n![yara1](https://user-images.githubusercontent.com/16841220/27729490-b3c631c4-5da3-11e7-9117-bd0735356b83.png)\r\n\r\n![yara2](https://user-images.githubusercontent.com/16841220/27729581-13da734a-5da4-11e7-841d-97973616cfa4.png)\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/49", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/49/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/49/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/49/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/49", "id": 238667628, "node_id": "MDU6SXNzdWUyMzg2Njc2Mjg=", "number": 49, "title": "match provides dict instead of list of dicts", "user": {"login": "ashelmire", "id": 6400770, "node_id": "MDQ6VXNlcjY0MDA3NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6400770?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ashelmire", "html_url": "https://github.com/ashelmire", "followers_url": "https://api.github.com/users/ashelmire/followers", "following_url": "https://api.github.com/users/ashelmire/following{/other_user}", "gists_url": "https://api.github.com/users/ashelmire/gists{/gist_id}", "starred_url": "https://api.github.com/users/ashelmire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ashelmire/subscriptions", "organizations_url": "https://api.github.com/users/ashelmire/orgs", "repos_url": "https://api.github.com/users/ashelmire/repos", "events_url": "https://api.github.com/users/ashelmire/events{/privacy}", "received_events_url": "https://api.github.com/users/ashelmire/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-06-26T20:58:21Z", "updated_at": "2017-06-26T21:25:44Z", "closed_at": "2017-06-26T21:25:44Z", "author_association": "NONE", "active_lock_reason": null, "body": ">>> import yara\r\n>>> r = yara.compile('/tmp/DC.yar')\r\n>>> dir(r)\r\n['__doc__', '__init__', '__module__', '__str__', '_context_args', '_contexts', '_strings', 'context', 'free', 'match', 'match_data', 'match_path', 'match_proc', 'namespaces', 'weight']\r\n>>> m = r.match_data(data)\r\n>>> print m\r\n{'main': [{'meta': {'date': '2014/04', 'maltype': 'Remote Access Trojan', 'filetype': 'exe', 'ref': 'http://malwareconfig.com/stats/DarkComet', 'author': ' Kevin Breen <kevin@techanarchy.net>'}, 'tags': [], 'matches': True, 'strings': [{'flags': 19, 'identifier': '$b5', 'data': '#KCMDDC', 'offset': 443840L}, {'flags': 19, 'identifier': '$b4', 'data': '#BOT#VisitUrl', 'offset': 513712L}, {'flags': 19, 'identifier': '$b3', 'data': \"I wasn't able to open the hosts file\", 'offset': 467496L}, {'flags': 19, 'identifier': '$b2', 'data': '%s, ClassID: %s', 'offset': 176972L}, {'flags': 19, 'identifier': '$b1', 'data': 'FastMM Borland Edition', 'offset': 2056L}, {'flags': 19, 'identifier': '$a2', 'data': 'Command successfully executed!', 'offset': 513989L}, {'flags': 19, 'identifier': '$a1', 'data': '#BOT#URLUpdate', 'offset': 514220L}], 'rule': 'DarkComet'}]}\r\n\r\n\r\n>>> m[0].rule\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nKeyError: 0\r\n\r\n>>> m['main'][0]['rule']\r\n'DarkComet'\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/43", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/43/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/43/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/43/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/43", "id": 230413506, "node_id": "MDU6SXNzdWUyMzA0MTM1MDY=", "number": 43, "title": "Python setup.py options not recognized", "user": {"login": "andrew-morris", "id": 3838808, "node_id": "MDQ6VXNlcjM4Mzg4MDg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3838808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrew-morris", "html_url": "https://github.com/andrew-morris", "followers_url": "https://api.github.com/users/andrew-morris/followers", "following_url": "https://api.github.com/users/andrew-morris/following{/other_user}", "gists_url": "https://api.github.com/users/andrew-morris/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrew-morris/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrew-morris/subscriptions", "organizations_url": "https://api.github.com/users/andrew-morris/orgs", "repos_url": "https://api.github.com/users/andrew-morris/repos", "events_url": "https://api.github.com/users/andrew-morris/events{/privacy}", "received_events_url": "https://api.github.com/users/andrew-morris/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-22T14:26:27Z", "updated_at": "2017-05-22T16:27:37Z", "closed_at": "2017-05-22T16:27:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am attempting to compile python-yara with dotnet support. The source code seems to be here but I cannot seem to enable the dotnet option.\r\n\r\n```\r\n[amorris] /tmp/yara-python $ git pull\r\nAlready up-to-date.\r\n[amorris] /tmp/yara-python $ date\r\nMon May 22 10:23:55 EDT 2017\r\n[amorris] /tmp/yara-python $ git status\r\nOn branch master\r\nYour branch is up-to-date with 'origin/master'.\r\nnothing to commit, working tree clean\r\n[amorris] /tmp/yara-python $ python setup.py install --dynamic-linking\r\nusage: setup.py [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]\r\n   or: setup.py --help [cmd1 cmd2 ...]\r\n   or: setup.py --help-commands\r\n   or: setup.py cmd --help\r\n\r\nerror: option --dynamic-linking not recognized\r\n[amorris] /tmp/yara-python $ python setup.py install --enable-dotnet\r\nusage: setup.py [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]\r\n   or: setup.py --help [cmd1 cmd2 ...]\r\n   or: setup.py --help-commands\r\n   or: setup.py cmd --help\r\n\r\nerror: option --enable-dotnet not recognized\r\n[amorris] /tmp/yara-python $\r\n```\r\n\r\nI feel like I might be doing something stupid. Please let me know what other information I can provide. Thanks so much!\r\n\r\n@mrphilroth", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/42", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/42/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/42/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/42/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/42", "id": 229593803, "node_id": "MDU6SXNzdWUyMjk1OTM4MDM=", "number": 42, "title": "Add a flag to the match function which indicates if you want your callback called for matches, non-matches or both", "user": {"login": "TofBaasken", "id": 12034220, "node_id": "MDQ6VXNlcjEyMDM0MjIw", "avatar_url": "https://avatars3.githubusercontent.com/u/12034220?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TofBaasken", "html_url": "https://github.com/TofBaasken", "followers_url": "https://api.github.com/users/TofBaasken/followers", "following_url": "https://api.github.com/users/TofBaasken/following{/other_user}", "gists_url": "https://api.github.com/users/TofBaasken/gists{/gist_id}", "starred_url": "https://api.github.com/users/TofBaasken/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TofBaasken/subscriptions", "organizations_url": "https://api.github.com/users/TofBaasken/orgs", "repos_url": "https://api.github.com/users/TofBaasken/repos", "events_url": "https://api.github.com/users/TofBaasken/events{/privacy}", "received_events_url": "https://api.github.com/users/TofBaasken/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-18T08:34:07Z", "updated_at": "2018-08-01T09:06:41Z", "closed_at": "2018-08-01T09:06:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "When matching a lot of files against a lot of files with yara python , the callback function gets called every time , match or no match , which creates a lot of overhead if you're only interested in the matches.\r\nWould it be possible to provide an option where you can specify whether you want your callback called for matches, non-matches or both? I think performance could increase a lot ...", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/41", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/41/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/41/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/41/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/41", "id": 224568028, "node_id": "MDU6SXNzdWUyMjQ1NjgwMjg=", "number": 41, "title": "LINK : fatal error LNK1181: cannot open input file 'libeay64.lib'", "user": {"login": "whisperzzzz", "id": 17351103, "node_id": "MDQ6VXNlcjE3MzUxMTAz", "avatar_url": "https://avatars2.githubusercontent.com/u/17351103?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whisperzzzz", "html_url": "https://github.com/whisperzzzz", "followers_url": "https://api.github.com/users/whisperzzzz/followers", "following_url": "https://api.github.com/users/whisperzzzz/following{/other_user}", "gists_url": "https://api.github.com/users/whisperzzzz/gists{/gist_id}", "starred_url": "https://api.github.com/users/whisperzzzz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whisperzzzz/subscriptions", "organizations_url": "https://api.github.com/users/whisperzzzz/orgs", "repos_url": "https://api.github.com/users/whisperzzzz/repos", "events_url": "https://api.github.com/users/whisperzzzz/events{/privacy}", "received_events_url": "https://api.github.com/users/whisperzzzz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-04-26T19:02:07Z", "updated_at": "2017-05-22T12:10:42Z", "closed_at": "2017-05-22T12:10:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "Here's the log while executing \"pip install yara-python\":\r\n\r\n  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\x86_amd64\\link.exe /nologo /INCREMENTAL:NO /LTCG /DLL /MANIFEST:EMBED,ID=2 /MANIFESTUAC:NO /LIBPATH:yara/windows/lib /LIBPATH:C:\\Python3\\libs /LIBPATH:C:\\Python3\\PCbuild\\amd64 \"/LIBPATH:C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\LIB\\amd64\" \"/LIBPATH:C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\ATLMFC\\LIB\\amd64\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.15063.0\\ucrt\\x64\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\lib\\um\\x64\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.15063.0\\um\\x64\" advapi32.lib user32.lib libeay64.lib /EXPORT:PyInit_yara build\\temp.win-amd64-3.6\\Release\\yara-python.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\ahocorasick.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\arena.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\atoms.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\compiler.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\exec.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\exefiles.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\filemap.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\grammar.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\hash.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\hex_grammar.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\hex_lexer.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\lexer.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\libyara.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\mem.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\modules.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\object.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\parser.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\proc.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\re.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\re_grammar.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\re_lexer.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\rules.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\scan.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\sizedstr.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\stream.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\strutils.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\threading.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\modules\\demo.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\modules\\elf.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\modules\\hash.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\modules\\math.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\modules\\pe.obj build\\temp.win-amd64-3.6\\Release\\yara\\libyara\\modules\\tests.obj /OUT:build\\lib.win-amd64-3.6\\yara.cp36-win_amd64.pyd /IMPLIB:build\\temp.win-amd64-3.6\\Release\\yara.cp36-win_amd64.lib\r\n\r\n  **LINK : fatal error LNK1181: cannot open input file 'libeay64.lib'\r\n  error: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 14.0\\\\VC\\\\BIN\\\\x86_amd64\\\\link.exe' failed with exit status 1181**\r\n\r\nI had openssl installed and specified it in the PATH. The error code 1181 seems like there exist spaces in the path of the linker. Is there a way to fix this problem?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/40", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/40/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/40/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/40/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/40", "id": 211961963, "node_id": "MDU6SXNzdWUyMTE5NjE5NjM=", "number": 40, "title": "Can not allocate memory when build setup in eaba8c1", "user": {"login": "gnh1201", "id": 4439601, "node_id": "MDQ6VXNlcjQ0Mzk2MDE=", "avatar_url": "https://avatars3.githubusercontent.com/u/4439601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gnh1201", "html_url": "https://github.com/gnh1201", "followers_url": "https://api.github.com/users/gnh1201/followers", "following_url": "https://api.github.com/users/gnh1201/following{/other_user}", "gists_url": "https://api.github.com/users/gnh1201/gists{/gist_id}", "starred_url": "https://api.github.com/users/gnh1201/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gnh1201/subscriptions", "organizations_url": "https://api.github.com/users/gnh1201/orgs", "repos_url": "https://api.github.com/users/gnh1201/repos", "events_url": "https://api.github.com/users/gnh1201/events{/privacy}", "received_events_url": "https://api.github.com/users/gnh1201/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-03-05T15:52:05Z", "updated_at": "2017-05-16T17:37:01Z", "closed_at": "2017-05-16T17:37:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I did use yara-python released 3.5.0, It have not setup problems and so well.\r\nbut, I got memory insufficient error from committed eaba8c1 when build setup\r\nalthough have enough swap space.\r\n\r\n> free -m\r\n>              total       used       free     shared    buffers     cached\r\n> Mem:          3009       1036       1973         12         90        671\r\n> -/+ buffers/cache:        274       2735\r\n> Swap:        13311          0      13311\r\n\r\nI know so lack physical memory space of my workspace,\r\nbut It is not lack because of all memory space with swap space.\r\n\r\n> python setup.py build\r\n> running build\r\n> running build_ext\r\n> building 'yara' extension\r\n> x86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara-python.c -o build/temp.linux-x86_64-2.7/yara-python.o\r\n> yara-python.c: In function \u2018yara_callback\u2019:\r\n> yara-python.c:727:60: error: \u2018YR_MATCH\u2019 has no member named \u2018data_length\u2019\r\n>        object = PyBytes_FromStringAndSize((char*) m->data, m->data_length);\r\n>                                                             ^\r\n> yara-python.c: In function \u2018handle_error\u2019:\r\n> yara-python.c:914:10: error: \u2018ERROR_INSUFFICIENT_MEMORY\u2019 undeclared (first use in this function)\r\n>      case ERROR_INSUFFICIENT_MEMORY:\r\n>           ^\r\n> yara-python.c:914:10: note: each undeclared identifier is reported only once for each function it appears in\r\n> yara-python.c:940:10: error: \u2018ERROR_INVALID_EXTERNAL_VARIABLE_TYPE\u2019 undeclared (first use in this function)\r\n>      case ERROR_INVALID_EXTERNAL_VARIABLE_TYPE:\r\n>           ^\r\n> yara-python.c: In function \u2018yara_compile\u2019:\r\n> yara-python.c:1958:31: error: \u2018ERROR_INSUFFICIENT_MEMORY\u2019 undeclared (first use in this function)\r\n>          result = handle_error(ERROR_INSUFFICIENT_MEMORY, NULL);\r\n>                                ^\r\n> error: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n> root@ubuntu:~/yara-python# python setup.py build\r\n> running build\r\n> running build_ext\r\n> building 'yara' extension\r\n> x86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara-python.c -o build/temp.linux-x86_64-2.7/yara-python.o\r\n> yara-python.c: In function \u2018yara_callback\u2019:\r\n> yara-python.c:727:60: error: \u2018YR_MATCH\u2019 has no member named \u2018data_length\u2019\r\n>        object = PyBytes_FromStringAndSize((char*) m->data, m->data_length);\r\n>                                                             ^\r\n> yara-python.c: In function \u2018handle_error\u2019:\r\n> yara-python.c:914:10: error: \u2018ERROR_INSUFFICIENT_MEMORY\u2019 undeclared (first use in this function)\r\n>      case ERROR_INSUFFICIENT_MEMORY:\r\n>           ^\r\n> yara-python.c:914:10: note: each undeclared identifier is reported only once for each function it appears in\r\n> yara-python.c:940:10: error: \u2018ERROR_INVALID_EXTERNAL_VARIABLE_TYPE\u2019 undeclared (first use in this function)\r\n>      case ERROR_INVALID_EXTERNAL_VARIABLE_TYPE:\r\n>           ^\r\n> yara-python.c: In function \u2018yara_compile\u2019:\r\n> yara-python.c:1958:31: error: \u2018ERROR_INSUFFICIENT_MEMORY\u2019 undeclared (first use in this function)\r\n>          result = handle_error(ERROR_INSUFFICIENT_MEMORY, NULL);\r\n>                                ^\r\n> error: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n\r\nIt is occurred from return null(no rules) of pyobject_new.\r\nI can not know reason why not allocate memory by pyobject_new in master(eaba8c1) source code.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/39", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/39/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/39/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/39/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/39", "id": 211559390, "node_id": "MDU6SXNzdWUyMTE1NTkzOTA=", "number": 39, "title": "Feature request: Include namespaces in result when matching multiple rule sources", "user": {"login": "austinbyers", "id": 3608925, "node_id": "MDQ6VXNlcjM2MDg5MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/3608925?v=4", "gravatar_id": "", "url": "https://api.github.com/users/austinbyers", "html_url": "https://github.com/austinbyers", "followers_url": "https://api.github.com/users/austinbyers/followers", "following_url": "https://api.github.com/users/austinbyers/following{/other_user}", "gists_url": "https://api.github.com/users/austinbyers/gists{/gist_id}", "starred_url": "https://api.github.com/users/austinbyers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/austinbyers/subscriptions", "organizations_url": "https://api.github.com/users/austinbyers/orgs", "repos_url": "https://api.github.com/users/austinbyers/repos", "events_url": "https://api.github.com/users/austinbyers/events{/privacy}", "received_events_url": "https://api.github.com/users/austinbyers/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-03-03T00:21:16Z", "updated_at": "2018-08-01T09:03:41Z", "closed_at": "2018-08-01T09:03:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "```python\r\nimport yara\r\nrules = yara.compile(sources={\r\n    'namespace1':'rule dummy { condition: true }',\r\n    'namespace2':'rule dummy { condition: true }',\r\n    'namespace3':'rule dummy2 { condition: true }'}\r\n)\r\nrules.match(data='hello world')  # Returns [dummy, dummy2, dummy]\r\n```\r\n\r\nThe whole point of the namespaces is to distinguish between the different rules when they may have the same name. Please include the namespaces in the match result, e.g.\r\n```\r\n[namespace1:dummy, namespace2:dummy, namespace3:dummy2]\r\n```\r\nor similar. As it stands, I may have to implement a callback to keep track of which namespaces and rules were matched.\r\n\r\n## Environment\r\nI'm running `yara-python v3.5.0`, installed via `pip` on Mac OS X.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/38", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/38/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/38/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/38/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/38", "id": 203420324, "node_id": "MDU6SXNzdWUyMDM0MjAzMjQ=", "number": 38, "title": "Yara failing on Travis CI?", "user": {"login": "jbremer", "id": 1148773, "node_id": "MDQ6VXNlcjExNDg3NzM=", "avatar_url": "https://avatars2.githubusercontent.com/u/1148773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jbremer", "html_url": "https://github.com/jbremer", "followers_url": "https://api.github.com/users/jbremer/followers", "following_url": "https://api.github.com/users/jbremer/following{/other_user}", "gists_url": "https://api.github.com/users/jbremer/gists{/gist_id}", "starred_url": "https://api.github.com/users/jbremer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jbremer/subscriptions", "organizations_url": "https://api.github.com/users/jbremer/orgs", "repos_url": "https://api.github.com/users/jbremer/repos", "events_url": "https://api.github.com/users/jbremer/events{/privacy}", "received_events_url": "https://api.github.com/users/jbremer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-01-26T16:38:08Z", "updated_at": "2017-02-20T22:46:16Z", "closed_at": "2017-02-07T11:53:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI'm seeing this error more often in the issue list of `yara-python`, however, it would appear those are based on older versions. See, e.g., the following Travis CI report, https://travis-ci.org/jbremer/cuckoo/builds/195577079. On line `2475` you will see a simple test that imports `yara` - and note that `yara-python==3.5.0` was installed through `pip`, while still having the `yr_finalize` import error. I'd very much like to ship Yara with Cuckoo by default, but this regression test failure is preventing me from doing so. Any tips?\r\n\r\nJurriaan", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/37", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/37/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/37/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/37/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/37", "id": 199599813, "node_id": "MDU6SXNzdWUxOTk1OTk4MTM=", "number": 37, "title": "Broken build (ERROR_INSUFFICIENT_MEMORY typo)", "user": {"login": "wbenny", "id": 4465216, "node_id": "MDQ6VXNlcjQ0NjUyMTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/4465216?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wbenny", "html_url": "https://github.com/wbenny", "followers_url": "https://api.github.com/users/wbenny/followers", "following_url": "https://api.github.com/users/wbenny/following{/other_user}", "gists_url": "https://api.github.com/users/wbenny/gists{/gist_id}", "starred_url": "https://api.github.com/users/wbenny/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wbenny/subscriptions", "organizations_url": "https://api.github.com/users/wbenny/orgs", "repos_url": "https://api.github.com/users/wbenny/repos", "events_url": "https://api.github.com/users/wbenny/events{/privacy}", "received_events_url": "https://api.github.com/users/wbenny/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-01-09T16:39:13Z", "updated_at": "2017-01-09T17:24:45Z", "closed_at": "2017-01-09T17:24:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've seen you've edited the typo in ERROR_INSUFFICIENT_MEMORY, but the build is still not working properly.\r\n\r\n```\r\n$ python setup.py build --enable-cuckoo\r\nrunning build\r\nrunning build_ext\r\nbuilding 'yara' extension\r\ncreating build\r\ncreating build/temp.linux-x86_64-2.7\r\ncreating build/temp.linux-x86_64-2.7/yara\r\ncreating build/temp.linux-x86_64-2.7/yara/libyara\r\ncreating build/temp.linux-x86_64-2.7/yara/libyara/modules\r\nx86_64-linux-gnu-gcc -pthread -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fno-strict-aliasing -Wdate-time -D_FORTIFY_SOURCE=2 -g -fstack-protector-strong -Wformat -Werror=format-security -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -DCUCKOO_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara-python.c -o build/temp.linux-x86_64-2.7/yara-python.o\r\nyara-python.c: In function \u2018handle_error\u2019:\r\nyara-python.c:914:10: error: \u2018ERROR_INSUFFICIENT_MEMORY\u2019 undeclared (first use in this function)\r\n     case ERROR_INSUFFICIENT_MEMORY:\r\n          ^\r\nyara-python.c:914:10: note: each undeclared identifier is reported only once for each function it appears in\r\nyara-python.c: In function \u2018yara_compile\u2019:\r\nyara-python.c:1958:31: error: \u2018ERROR_INSUFFICIENT_MEMORY\u2019 undeclared (first use in this function)\r\n         result = handle_error(ERROR_INSUFFICIENT_MEMORY, NULL);\r\n                               ^\r\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n\r\n```\r\n\r\nAlthough it works after:\r\n`$ grep -rl 'ERROR_INSUFICIENT_MEMORY' ./ | xargs sed -i 's/ERROR_INSUFICIENT_MEMORY/ERROR_INSUFFICIENT_MEMORY/g'`\r\n\r\nI think bumping subrepo (where it seems to be already fixed) will work.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/36", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/36/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/36/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/36/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/36", "id": 199599192, "node_id": "MDU6SXNzdWUxOTk1OTkxOTI=", "number": 36, "title": "yara.so: undefined symbol: pe_get_directory_entry", "user": {"login": "wbenny", "id": 4465216, "node_id": "MDQ6VXNlcjQ0NjUyMTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/4465216?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wbenny", "html_url": "https://github.com/wbenny", "followers_url": "https://api.github.com/users/wbenny/followers", "following_url": "https://api.github.com/users/wbenny/following{/other_user}", "gists_url": "https://api.github.com/users/wbenny/gists{/gist_id}", "starred_url": "https://api.github.com/users/wbenny/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wbenny/subscriptions", "organizations_url": "https://api.github.com/users/wbenny/orgs", "repos_url": "https://api.github.com/users/wbenny/repos", "events_url": "https://api.github.com/users/wbenny/events{/privacy}", "received_events_url": "https://api.github.com/users/wbenny/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-01-09T16:36:43Z", "updated_at": "2017-02-07T11:54:57Z", "closed_at": "2017-02-07T11:54:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\n>>> import yara\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nImportError: /.../yara_python-3.5.0-py2.7-linux-x86_64.egg/yara.so: undefined symbol: pe_get_directory_entry\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/35", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/35/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/35/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/35/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/35", "id": 197206499, "node_id": "MDU6SXNzdWUxOTcyMDY0OTk=", "number": 35, "title": "lib magic is not included correctly", "user": {"login": "hnstance", "id": 24719306, "node_id": "MDQ6VXNlcjI0NzE5MzA2", "avatar_url": "https://avatars1.githubusercontent.com/u/24719306?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hnstance", "html_url": "https://github.com/hnstance", "followers_url": "https://api.github.com/users/hnstance/followers", "following_url": "https://api.github.com/users/hnstance/following{/other_user}", "gists_url": "https://api.github.com/users/hnstance/gists{/gist_id}", "starred_url": "https://api.github.com/users/hnstance/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hnstance/subscriptions", "organizations_url": "https://api.github.com/users/hnstance/orgs", "repos_url": "https://api.github.com/users/hnstance/repos", "events_url": "https://api.github.com/users/hnstance/events{/privacy}", "received_events_url": "https://api.github.com/users/hnstance/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-12-22T16:01:46Z", "updated_at": "2017-05-22T18:23:16Z", "closed_at": "2017-05-22T18:23:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "This apples to building yara-python-3.5.0 on Ubuntu Trusty 14.04.\r\n\r\n```\r\nsudo apt-get install libmagic-dev\r\n\r\n(In a virtualenv)\r\npython setup.py build --enable-magic\r\npython setup.py install\r\n```\r\nThen in a Python terminal, ```import yara``` returns the following error:\r\n\r\n```\r\n>>> import yara\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nImportError: /home/vagrant/yara/local/lib/python2.7/site-packages/yara_python-3.5.0-py2.7-linux-x86_64.egg/yara.so: undefined symbol: magic_load\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/34", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/34/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/34/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/34/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/34", "id": 188626196, "node_id": "MDU6SXNzdWUxODg2MjYxOTY=", "number": 34, "title": "build fails even after adding the -std=c99 flag", "user": {"login": "kolmai", "id": 16187929, "node_id": "MDQ6VXNlcjE2MTg3OTI5", "avatar_url": "https://avatars2.githubusercontent.com/u/16187929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kolmai", "html_url": "https://github.com/kolmai", "followers_url": "https://api.github.com/users/kolmai/followers", "following_url": "https://api.github.com/users/kolmai/following{/other_user}", "gists_url": "https://api.github.com/users/kolmai/gists{/gist_id}", "starred_url": "https://api.github.com/users/kolmai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kolmai/subscriptions", "organizations_url": "https://api.github.com/users/kolmai/orgs", "repos_url": "https://api.github.com/users/kolmai/repos", "events_url": "https://api.github.com/users/kolmai/events{/privacy}", "received_events_url": "https://api.github.com/users/kolmai/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-11-10T21:42:46Z", "updated_at": "2017-02-07T11:56:33Z", "closed_at": "2017-02-07T11:56:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nAt first the error suggests to use option -std=c99 in order to compile.\r\n\r\n```\r\n~/Downloads/yara-python$ python setup.py build\r\nrunning build\r\nrunning build_ext\r\nbuilding 'yara' extension\r\ncreating build\r\ncreating build/temp.linux-x86_64-2.7\r\ncreating build/temp.linux-x86_64-2.7/yara\r\ncreating build/temp.linux-x86_64-2.7/yara/libyara\r\ncreating build/temp.linux-x86_64-2.7/yara/libyara/modules\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara-python.c -o build/temp.linux-x86_64-2.7/yara-python.o\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/object.c -o build/temp.linux-x86_64-2.7/yara/libyara/object.o\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/lexer.c -o build/temp.linux-x86_64-2.7/yara/libyara/lexer.o\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/grammar.c -o build/temp.linux-x86_64-2.7/yara/libyara/grammar.o\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/sizedstr.c -o build/temp.linux-x86_64-2.7/yara/libyara/sizedstr.o\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/rules.c -o build/temp.linux-x86_64-2.7/yara/libyara/rules.o\r\nyara/libyara/rules.c: In function \u2018yr_rules_save_stream\u2019:\r\nyara/libyara/rules.c:743:3: error: \u2018for\u2019 loop initial declarations are only allowed in C99 mode\r\n   for (int i = 0; i < YR_BITARRAY_NCHARS(MAX_THREADS); ++i) {\r\n   ^\r\nyara/libyara/rules.c:743:3: note: use option -std=c99 or -std=gnu99 to compile your code\r\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n```\r\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++\r\nAfter adding the required flag build still fails at sigjmp_buf function.\r\n(unknown type name \u2018sigjmp_buf\u2019)\r\nPlease help how to proceed with the compilation process.\r\nThanks ahead!\r\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++\r\n```\r\n~/Downloads/yara-python$ python setup.py build\r\nrunning build\r\nrunning build_ext\r\nbuilding 'yara' extension\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara-python.c -o build/temp.linux-x86_64-2.7/yara-python.o --std=c99\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/object.c -o build/temp.linux-x86_64-2.7/yara/libyara/object.o --std=c99\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/lexer.c -o build/temp.linux-x86_64-2.7/yara/libyara/lexer.o --std=c99\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/grammar.c -o build/temp.linux-x86_64-2.7/yara/libyara/grammar.o --std=c99\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/sizedstr.c -o build/temp.linux-x86_64-2.7/yara/libyara/sizedstr.o --std=c99\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -DHAVE_MEMMEM=1 -DHASH_MODULE=1 -Iyara/libyara/include -Iyara/libyara/ -I. -I/usr/include/python2.7 -c yara/libyara/rules.c -o build/temp.linux-x86_64-2.7/yara/libyara/rules.o --std=c99\r\nIn file included from yara/libyara/rules.c:51:0:\r\nyara/libyara/exception.h:81:1: error: unknown type name \u2018sigjmp_buf\u2019\r\n sigjmp_buf *exc_jmp_buf[MAX_THREADS];\r\n ^\r\nyara/libyara/exception.h: In function \u2018exception_handler\u2019:\r\nyara/libyara/exception.h:89:7: warning: passing argument 1 of \u2018siglongjmp\u2019 makes pointer from integer without a cast [enabled by default]\r\n       siglongjmp(*exc_jmp_buf[tidx], 1);\r\n       ^\r\nIn file included from /usr/include/features.h:374:0,\r\n                 from /usr/include/assert.h:35,\r\n                 from yara/libyara/rules.c:30:\r\n/usr/include/x86_64-linux-gnu/bits/setjmp2.h:31:13: note: expected \u2018struct __jmp_buf_tag *\u2019 but argument is of type \u2018int\u2019\r\n extern void __REDIRECT_NTHNL (siglongjmp,\r\n             ^\r\nIn file included from yara/libyara/rules.c:51:0:\r\nyara/libyara/rules.c: In function \u2018yr_rules_scan_mem_blocks\u2019:\r\nyara/libyara/exception.h:100:22: error: storage size of \u2018oldact\u2019 isn\u2019t known\r\n     struct sigaction oldact;                                    \\\r\n                      ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:101:22: error: storage size of \u2018act\u2019 isn\u2019t known\r\n     struct sigaction act;                                       \\\r\n                      ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:102:5: error: unknown type name \u2018sigset_t\u2019\r\n     sigset_t oldmask;                                           \\\r\n     ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:101:12: warning: implicit declaration of function \u2018sigemptyset\u2019 [-Wimplicit-function-declaration]\r\n     struct sigaction act;                                       \\\r\n            ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:101:12: warning: implicit declaration of function \u2018pthread_sigmask\u2019 [-Wimplicit-function-declaration]\r\n     struct sigaction act;                                       \\\r\n            ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:108:21: error: \u2018SIG_SETMASK\u2019 undeclared (first use in this function)\r\n     pthread_sigmask(SIG_SETMASK, &act.sa_mask, &oldmask);       \\\r\n                     ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:108:21: note: each undeclared identifier is reported only once for each function it appears in\r\n     pthread_sigmask(SIG_SETMASK, &act.sa_mask, &oldmask);       \\\r\n                     ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:101:12: warning: implicit declaration of function \u2018sigaction\u2019 [-Wimplicit-function-declaration]\r\n     struct sigaction act;                                       \\\r\n            ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:112:5: error: unknown type name \u2018sigjmp_buf\u2019\r\n     sigjmp_buf jb;                                              \\\r\n     ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:101:12: warning: implicit declaration of function \u2018sigsetjmp\u2019 [-Wimplicit-function-declaration]\r\n     struct sigaction act;                                       \\\r\n            ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:101:22: warning: unused variable \u2018act\u2019 [-Wunused-variable]\r\n     struct sigaction act;                                       \\\r\n                      ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:100:22: warning: unused variable \u2018oldact\u2019 [-Wunused-variable]\r\n     struct sigaction oldact;                                    \\\r\n                      ^\r\nyara/libyara/rules.c:437:7: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n       YR_TRYCATCH({\r\n       ^\r\nyara/libyara/exception.h:100:22: error: storage size of \u2018oldact\u2019 isn\u2019t known\r\n     struct sigaction oldact;                                    \\\r\n                      ^\r\nyara/libyara/rules.c:450:5: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n     YR_TRYCATCH({\r\n     ^\r\nyara/libyara/exception.h:101:22: error: storage size of \u2018act\u2019 isn\u2019t known\r\n     struct sigaction act;                                       \\\r\n                      ^\r\nyara/libyara/rules.c:450:5: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n     YR_TRYCATCH({\r\n     ^\r\nyara/libyara/exception.h:102:5: error: unknown type name \u2018sigset_t\u2019\r\n     sigset_t oldmask;                                           \\\r\n     ^\r\nyara/libyara/rules.c:450:5: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n     YR_TRYCATCH({\r\n     ^\r\nyara/libyara/exception.h:112:5: error: unknown type name \u2018sigjmp_buf\u2019\r\n     sigjmp_buf jb;                                              \\\r\n     ^\r\nyara/libyara/rules.c:450:5: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n     YR_TRYCATCH({\r\n     ^\r\nyara/libyara/exception.h:101:22: warning: unused variable \u2018act\u2019 [-Wunused-variable]\r\n     struct sigaction act;                                       \\\r\n                      ^\r\nyara/libyara/rules.c:450:5: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n     YR_TRYCATCH({\r\n     ^\r\nyara/libyara/exception.h:100:22: warning: unused variable \u2018oldact\u2019 [-Wunused-variable]\r\n     struct sigaction oldact;                                    \\\r\n                      ^\r\nyara/libyara/rules.c:450:5: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n     YR_TRYCATCH({\r\n     ^\r\nyara/libyara/exception.h:100:22: error: storage size of \u2018oldact\u2019 isn\u2019t known\r\n     struct sigaction oldact;                                    \\\r\n                      ^\r\nyara/libyara/rules.c:468:3: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n   YR_TRYCATCH({\r\n   ^\r\nyara/libyara/exception.h:101:22: error: storage size of \u2018act\u2019 isn\u2019t known\r\n     struct sigaction act;                                       \\\r\n                      ^\r\nyara/libyara/rules.c:468:3: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n   YR_TRYCATCH({\r\n   ^\r\nyara/libyara/exception.h:102:5: error: unknown type name \u2018sigset_t\u2019\r\n     sigset_t oldmask;                                           \\\r\n     ^\r\nyara/libyara/rules.c:468:3: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n   YR_TRYCATCH({\r\n   ^\r\nyara/libyara/exception.h:112:5: error: unknown type name \u2018sigjmp_buf\u2019\r\n     sigjmp_buf jb;                                              \\\r\n     ^\r\nyara/libyara/rules.c:468:3: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n   YR_TRYCATCH({\r\n   ^\r\nyara/libyara/exception.h:101:22: warning: unused variable \u2018act\u2019 [-Wunused-variable]\r\n     struct sigaction act;                                       \\\r\n                      ^\r\nyara/libyara/rules.c:468:3: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n   YR_TRYCATCH({\r\n   ^\r\nyara/libyara/exception.h:100:22: warning: unused variable \u2018oldact\u2019 [-Wunused-variable]\r\n     struct sigaction oldact;                                    \\\r\n                      ^\r\nyara/libyara/rules.c:468:3: note: in expansion of macro \u2018YR_TRYCATCH\u2019\r\n   YR_TRYCATCH({\r\n   ^\r\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/33", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/33/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/33/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/33/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/33", "id": 188156802, "node_id": "MDU6SXNzdWUxODgxNTY4MDI=", "number": 33, "title": "Windows compatibility", "user": {"login": "jbremer", "id": 1148773, "node_id": "MDQ6VXNlcjExNDg3NzM=", "avatar_url": "https://avatars2.githubusercontent.com/u/1148773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jbremer", "html_url": "https://github.com/jbremer", "followers_url": "https://api.github.com/users/jbremer/followers", "following_url": "https://api.github.com/users/jbremer/following{/other_user}", "gists_url": "https://api.github.com/users/jbremer/gists{/gist_id}", "starred_url": "https://api.github.com/users/jbremer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jbremer/subscriptions", "organizations_url": "https://api.github.com/users/jbremer/orgs", "repos_url": "https://api.github.com/users/jbremer/repos", "events_url": "https://api.github.com/users/jbremer/events{/privacy}", "received_events_url": "https://api.github.com/users/jbremer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-11-09T02:50:45Z", "updated_at": "2017-05-22T12:12:34Z", "closed_at": "2017-05-22T12:12:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "Two questions.\r\n\r\n1) The binary link for installing `yara-python` on Windows is broken in the documentation.\r\n2) Provided that binaries for Windows have been built in the past, would it be possible to ship those by default (when installing on Windows)? On a plain Windows 7 machine `yara-python` will not install right now as visual studio is missing (which is not necessarily an error, but not everyone will have installed that).", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/30", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/30/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/30/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/30/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/30", "id": 177285331, "node_id": "MDU6SXNzdWUxNzcyODUzMzE=", "number": 30, "title": "Symbol not found: _yr_compiler_add_file", "user": {"login": "r3comp1le", "id": 2692404, "node_id": "MDQ6VXNlcjI2OTI0MDQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/2692404?v=4", "gravatar_id": "", "url": "https://api.github.com/users/r3comp1le", "html_url": "https://github.com/r3comp1le", "followers_url": "https://api.github.com/users/r3comp1le/followers", "following_url": "https://api.github.com/users/r3comp1le/following{/other_user}", "gists_url": "https://api.github.com/users/r3comp1le/gists{/gist_id}", "starred_url": "https://api.github.com/users/r3comp1le/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/r3comp1le/subscriptions", "organizations_url": "https://api.github.com/users/r3comp1le/orgs", "repos_url": "https://api.github.com/users/r3comp1le/repos", "events_url": "https://api.github.com/users/r3comp1le/events{/privacy}", "received_events_url": "https://api.github.com/users/r3comp1le/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-09-15T20:45:28Z", "updated_at": "2017-12-01T20:17:56Z", "closed_at": "2017-05-22T16:46:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "OSX\nYara Version 3.5\nyara-python==3.5.0\n\n`\n\n> > > import yara\n> > > Traceback (most recent call last):\n> > >   File \"<stdin>\", line 1, in <module>\n> > > ImportError: dlopen(/Library/Python/2.7/site-packages/yara_python-3.5.0-py2.7-macosx-10.11-intel.egg/yara.so, 2): Symbol not found: _yr_compiler_add_file\n> > >   Referenced from: /Library/Python/2.7/site-packages/yara_python-3.5.0-py2.7-macosx-10.11-intel.egg/yara.so\n> > >   Expected in: flat namespace\n> > >  in /Library/Python/2.7/site-packages/yara_python-3.5.0-py2.7-macosx-10.11-intel.egg/yara.so\n> > > `\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/29", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/29/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/29/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/29/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/29", "id": 176701962, "node_id": "MDU6SXNzdWUxNzY3MDE5NjI=", "number": 29, "title": "yara-python process scanning not working", "user": {"login": "hackers-terabit", "id": 18134147, "node_id": "MDQ6VXNlcjE4MTM0MTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/18134147?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hackers-terabit", "html_url": "https://github.com/hackers-terabit", "followers_url": "https://api.github.com/users/hackers-terabit/followers", "following_url": "https://api.github.com/users/hackers-terabit/following{/other_user}", "gists_url": "https://api.github.com/users/hackers-terabit/gists{/gist_id}", "starred_url": "https://api.github.com/users/hackers-terabit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hackers-terabit/subscriptions", "organizations_url": "https://api.github.com/users/hackers-terabit/orgs", "repos_url": "https://api.github.com/users/hackers-terabit/repos", "events_url": "https://api.github.com/users/hackers-terabit/events{/privacy}", "received_events_url": "https://api.github.com/users/hackers-terabit/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-09-13T17:31:16Z", "updated_at": "2016-09-13T18:56:19Z", "closed_at": "2016-09-13T18:56:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Greetings, \n\nI have the following proof of concept code showing yara-python pid scanning not working, I've tried all I can to narrow down the problem to no avail.  Can you tell me if I'm interacting with the api wrong or if this feature is not supported on Linux? \n\n```\nimport yara,re,sys,syslog,os\nfrom os.path import join, getsize\n\ndef findrules(path):\n        rules_dict = {}\n        rgx=re.compile('^.*\\.yar[a]?$')\n\n        for root, dirs, files in os.walk(path):\n           for entry in files:\n              filepath=root+\"/\"+entry\n              if rgx.match(filepath):\n                rules_dict.update({filepath:filepath})\n\n        return rules_dict\n\ndef main():\n\n     if len(sys.argv) < 2:\n        print (\"Please specify path to YARA rules.\")\n        sys.exit(1)\n\n     path=sys.argv[1]\n     rules = yara.compile(filepaths=findrules(path))\n     while 1==1:\n            pids = [pid for pid in os.listdir('/proc') if pid.isdigit()]\n            for procid in pids:\n               print (\"Scanning process \", procid)\n               try:\n                 matches=rules.match(pid=int(procid),timeout=30)\n                 if (matches):\n                   msg = (\"Process \", open(os.path.join('/proc', pid, 'cmdline'), 'rb').read(),\n                          \"Matched against YARA rule - \", str(matches[0]))\n                   print (msg)\n                   syslog.syslog(join(\"Malicious-Process:\",str(msg)))\n               except Exception as e:\n                    print (\"Process scanner exception: \",e)\n                    traceback = sys.exc_info()\n                    print (traceback)\n\nif __name__ == \"__main__\":\n    main()\n```\n\nTo run just  do 'python script.py  /path/rulesdir/'  , I've used similar steps to do packet scanning successfully. \n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/28", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/28/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/28/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/28/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/28", "id": 173285069, "node_id": "MDU6SXNzdWUxNzMyODUwNjk=", "number": 28, "title": "Module PE Not Functioning Correctly", "user": {"login": "rholloway", "id": 3996981, "node_id": "MDQ6VXNlcjM5OTY5ODE=", "avatar_url": "https://avatars2.githubusercontent.com/u/3996981?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rholloway", "html_url": "https://github.com/rholloway", "followers_url": "https://api.github.com/users/rholloway/followers", "following_url": "https://api.github.com/users/rholloway/following{/other_user}", "gists_url": "https://api.github.com/users/rholloway/gists{/gist_id}", "starred_url": "https://api.github.com/users/rholloway/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rholloway/subscriptions", "organizations_url": "https://api.github.com/users/rholloway/orgs", "repos_url": "https://api.github.com/users/rholloway/repos", "events_url": "https://api.github.com/users/rholloway/events{/privacy}", "received_events_url": "https://api.github.com/users/rholloway/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-08-25T19:10:02Z", "updated_at": "2018-09-03T00:50:00Z", "closed_at": "2017-05-22T16:43:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am having an issue using the PE module within yara-python, although it works fine from command line yara.\n\nUsing yara 3.5.0 and yara-python 3.5.0. It looks somewhat related to #8 but in this case I don't have an issue on the import, but I can't use the functions.\n\n(env) vagrant@web:/opt$ yara --version\nyara 3.5.0\n(env) vagrant@web:/opt$ python\nPython 2.7.6 (default, Jun 22 2015, 17:58:13)\n[GCC 4.8.2] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n\n> > > import yara\n> > > yara.**version**\n> > > '3.5.0'\n> > > yara.compile(source='import \"pe\" rule test_rule { condition: pe.imphash() == \"A\" \\* 32}')\n> > > Traceback (most recent call last):\n> > >   File \"<stdin>\", line 1, in <module>\n> > > yara.SyntaxError: invalid field name \"imphash\"\n> > > yara.compile(source='import \"pe\"')\n> > > <yara.Rules object at 0x7f06dea91d00>\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/26", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/26/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/26/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/26/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/26", "id": 173003077, "node_id": "MDU6SXNzdWUxNzMwMDMwNzc=", "number": 26, "title": "Install options aren't recognized", "user": {"login": "CalebFenton", "id": 1356658, "node_id": "MDQ6VXNlcjEzNTY2NTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1356658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CalebFenton", "html_url": "https://github.com/CalebFenton", "followers_url": "https://api.github.com/users/CalebFenton/followers", "following_url": "https://api.github.com/users/CalebFenton/following{/other_user}", "gists_url": "https://api.github.com/users/CalebFenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/CalebFenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CalebFenton/subscriptions", "organizations_url": "https://api.github.com/users/CalebFenton/orgs", "repos_url": "https://api.github.com/users/CalebFenton/repos", "events_url": "https://api.github.com/users/CalebFenton/events{/privacy}", "received_events_url": "https://api.github.com/users/CalebFenton/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-24T16:46:11Z", "updated_at": "2016-08-24T17:08:15Z", "closed_at": "2016-08-24T17:08:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Copied the install example command from README:\n\n``` bash\npython setup.py install --dynamic-linking                                                                                    1 \u21b5\nusage: setup.py [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]\n   or: setup.py --help [cmd1 cmd2 ...]\n   or: setup.py --help-commands\n   or: setup.py cmd --help\n\nerror: option --dynamic-linking not recognized\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/25", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/25/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/25/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/25/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/25", "id": 171478345, "node_id": "MDU6SXNzdWUxNzE0NzgzNDU=", "number": 25, "title": "Testcases testEntrypoint / testIn / testIntegerFunctions failing on ppc64 architecture", "user": {"login": "xambroz", "id": 723625, "node_id": "MDQ6VXNlcjcyMzYyNQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/723625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xambroz", "html_url": "https://github.com/xambroz", "followers_url": "https://api.github.com/users/xambroz/followers", "following_url": "https://api.github.com/users/xambroz/following{/other_user}", "gists_url": "https://api.github.com/users/xambroz/gists{/gist_id}", "starred_url": "https://api.github.com/users/xambroz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xambroz/subscriptions", "organizations_url": "https://api.github.com/users/xambroz/orgs", "repos_url": "https://api.github.com/users/xambroz/repos", "events_url": "https://api.github.com/users/xambroz/events{/privacy}", "received_events_url": "https://api.github.com/users/xambroz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-16T17:56:03Z", "updated_at": "2019-03-18T22:55:39Z", "closed_at": "2019-03-18T22:55:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "The test-case testEntrypoint is failing on ppc64 architecture. Possibly some endianness issue with yara on ppc64 architecture. Tested with yara 3.5.0.\n\nhttps://kojipkgs.fedoraproject.org//work/tasks/591/15270591/build.log\n\n```\n+ PYTHONPATH=/builddir/build/BUILDROOT/python-yara-3.5.0-5.el7.ppc64//usr/lib64/python2.7/site-packages/\n+ /usr/bin/nosetests-2.7 -v '--exclude=^testModuleData$'\ntestAnonymousStrings (tests.TestYara) ... ok\ntestArithmeticOperators (tests.TestYara) ... ok\ntestAt (tests.TestYara) ... ok\ntestBitwiseOperators (tests.TestYara) ... ok\ntestBooleanOperators (tests.TestYara) ... ok\ntestCallback (tests.TestYara) ... ok\ntestComments (tests.TestYara) ... ok\ntestCompare (tests.TestYara) ... ok\ntestComparisonOperators (tests.TestYara) ... ok\ntestCompileFile (tests.TestYara) ... ok\ntestCompileFiles (tests.TestYara) ... ok\ntestCount (tests.TestYara) ... ok\ntestEntrypoint (tests.TestYara) ... FAIL\ntestExternals (tests.TestYara) ... ok\ntestFilesize (tests.TestYara) ... ok\ntestFor (tests.TestYara) ... ok\ntestHexStrings (tests.TestYara) ... ok\ntestIn (tests.TestYara) ... FAIL\ntestIncludeFiles (tests.TestYara) ... ok\ntestIntegerFunctions (tests.TestYara) ... FAIL\ntestLength (tests.TestYara) ... ok\ntestModules (tests.TestYara) ... ok\ntestOf (tests.TestYara) ... ok\ntestOffset (tests.TestYara) ... ok\ntestRE (tests.TestYara) ... ok\ntestStringIO (tests.TestYara) ... ok\ntestStrings (tests.TestYara) ... ok\ntestSyntax (tests.TestYara) ... ok\ntestWildcardStrings (tests.TestYara) ... ok\n======================================================================\nFAIL: testEntrypoint (tests.TestYara)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/builddir/build/BUILD/yara-python-9fd9fd290872e36360e5e3839c49e21a908bf128/tests.py\", line 681, in testEntrypoint\n    ], PE32_FILE)\n  File \"/builddir/build/BUILD/yara-python-9fd9fd290872e36360e5e3839c49e21a908bf128/tests.py\", line 274, in assertTrueRules\n    self.assertTrue(r.match(data=data))\nAssertionError: [] is not true\n======================================================================\nFAIL: testIn (tests.TestYara)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/builddir/build/BUILD/yara-python-9fd9fd290872e36360e5e3839c49e21a908bf128/tests.py\", line 580, in testIn\n    ], PE32_FILE)\n  File \"/builddir/build/BUILD/yara-python-9fd9fd290872e36360e5e3839c49e21a908bf128/tests.py\", line 274, in assertTrueRules\n    self.assertTrue(r.match(data=data))\nAssertionError: [] is not true\n======================================================================\nFAIL: testIntegerFunctions (tests.TestYara)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/builddir/build/BUILD/yara-python-9fd9fd290872e36360e5e3839c49e21a908bf128/tests.py\", line 898, in testIntegerFunctions\n    ], b'\\xAA\\xBB\\xCC\\xDD')\n  File \"/builddir/build/BUILD/yara-python-9fd9fd290872e36360e5e3839c49e21a908bf128/tests.py\", line 274, in assertTrueRules\n    self.assertTrue(r.match(data=data))\nAssertionError: [] is not true\n----------------------------------------------------------------------\nRan 29 tests in 0.162s\nFAILED (failures=3)\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/22", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/22/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/22/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/22/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/22", "id": 169629697, "node_id": "MDU6SXNzdWUxNjk2Mjk2OTc=", "number": 22, "title": "yara-python 3.5.0 on PyPI has stale .y and .l generated code files", "user": {"login": "joachimmetz", "id": 3888750, "node_id": "MDQ6VXNlcjM4ODg3NTA=", "avatar_url": "https://avatars2.githubusercontent.com/u/3888750?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joachimmetz", "html_url": "https://github.com/joachimmetz", "followers_url": "https://api.github.com/users/joachimmetz/followers", "following_url": "https://api.github.com/users/joachimmetz/following{/other_user}", "gists_url": "https://api.github.com/users/joachimmetz/gists{/gist_id}", "starred_url": "https://api.github.com/users/joachimmetz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joachimmetz/subscriptions", "organizations_url": "https://api.github.com/users/joachimmetz/orgs", "repos_url": "https://api.github.com/users/joachimmetz/repos", "events_url": "https://api.github.com/users/joachimmetz/events{/privacy}", "received_events_url": "https://api.github.com/users/joachimmetz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-08-05T15:13:37Z", "updated_at": "2017-05-22T12:09:18Z", "closed_at": "2017-05-22T12:09:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "FYI you likely want to have sdist handle updating the .y and .l generated code files\n\nThe yara-python 3.5.0 version provides via https://pypi.python.org/pypi/yara-python/3.5.0 contains stale .y and .l generated code files e.g. yara/libyara/grammar.c still includes stdint.h while gammar.y references yara/integers.h. Currently this causes yara-python unable to build on Windows.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/21", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/21/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/21/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/21/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/21", "id": 169273457, "node_id": "MDU6SXNzdWUxNjkyNzM0NTc=", "number": 21, "title": "Testcases testCompare and testModuleData are failing with python3", "user": {"login": "xambroz", "id": 723625, "node_id": "MDQ6VXNlcjcyMzYyNQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/723625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xambroz", "html_url": "https://github.com/xambroz", "followers_url": "https://api.github.com/users/xambroz/followers", "following_url": "https://api.github.com/users/xambroz/following{/other_user}", "gists_url": "https://api.github.com/users/xambroz/gists{/gist_id}", "starred_url": "https://api.github.com/users/xambroz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xambroz/subscriptions", "organizations_url": "https://api.github.com/users/xambroz/orgs", "repos_url": "https://api.github.com/users/xambroz/repos", "events_url": "https://api.github.com/users/xambroz/events{/privacy}", "received_events_url": "https://api.github.com/users/xambroz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-04T01:47:15Z", "updated_at": "2019-03-18T22:53:02Z", "closed_at": "2019-03-18T22:53:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, \nwhen building the yara python3 module I run the tests.py and some of the tests are failing. Same tests do not fail for python2 (same environment, same directory just python3 instead of python2 resp. nosetests-3.4 instead of nosetests-2.7)\n\nThe testcase testModuleData seems to be always failing with python3.\nThe testcase testCompare seems to have some race condition and is sometimes failing with python3.\n\nI am testing with version 9fd9fd290872e36360e5e3839c49e21a908bf128.\n\nPYTHONPATH=/rpmbuild/BUILDROOT/python-yara-3.5.0-0.rc1.fc23.x86_64//usr/lib64/python3.4/site-packages/ nosetests-3.4 -v\ntestAnonymousStrings (tests.TestYara) ... ok\ntestArithmeticOperators (tests.TestYara) ... ok\ntestAt (tests.TestYara) ... ok\ntestBitwiseOperators (tests.TestYara) ... ok\ntestBooleanOperators (tests.TestYara) ... ok\ntestCallback (tests.TestYara) ... ok\ntestComments (tests.TestYara) ... ok\ntestCompare (tests.TestYara) ... FAIL\ntestComparisonOperators (tests.TestYara) ... ok\ntestCompileFile (tests.TestYara) ... ok\ntestCompileFiles (tests.TestYara) ... ok\ntestCount (tests.TestYara) ... ok\ntestEntrypoint (tests.TestYara) ... ok\ntestExternals (tests.TestYara) ... ok\ntestFilesize (tests.TestYara) ... ok\ntestFor (tests.TestYara) ... ok\ntestHexStrings (tests.TestYara) ... ok\ntestIn (tests.TestYara) ... ok\ntestIncludeFiles (tests.TestYara) ... ok\ntestIntegerFunctions (tests.TestYara) ... ok\ntestLength (tests.TestYara) ... ok\ntestModuleData (tests.TestYara) ... FAIL\ntestModules (tests.TestYara) ... ok\ntestOf (tests.TestYara) ... ok\ntestOffset (tests.TestYara) ... ok\ntestRE (tests.TestYara) ... ok\ntestStringIO (tests.TestYara) ... ok\ntestStrings (tests.TestYara) ... ok\ntestSyntax (tests.TestYara) ... ok\ntestWildcardStrings (tests.TestYara) ... ok\n# \n## FAIL: testCompare (tests.TestYara)\n\nTraceback (most recent call last):\n  File \"/rpmbuild/BUILD/yara-python-9fd9fd290872e36360e5e3839c49e21a908bf128/tests.py\", line 840, in testCompare\n    self.assertTrue(m[0] < m[1])\nAssertionError: False is not true\n# \n## FAIL: testModuleData (tests.TestYara)\n\nTraceback (most recent call last):\n  File \"/rpmbuild/BUILD/yara-python-9fd9fd290872e36360e5e3839c49e21a908bf128/tests.py\", line 930, in testModuleData\n    self.assertTrue(data['constants']['foo'] == 'foo')\nAssertionError: False is not true\n\nBest regards\nMichal Ambroz\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/20", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/20/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/20/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/20/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/20", "id": 169270322, "node_id": "MDU6SXNzdWUxNjkyNzAzMjI=", "number": 20, "title": "Dynamic linking of yara python module not allowed with CUCKOO / MAGIC", "user": {"login": "xambroz", "id": 723625, "node_id": "MDQ6VXNlcjcyMzYyNQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/723625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xambroz", "html_url": "https://github.com/xambroz", "followers_url": "https://api.github.com/users/xambroz/followers", "following_url": "https://api.github.com/users/xambroz/following{/other_user}", "gists_url": "https://api.github.com/users/xambroz/gists{/gist_id}", "starred_url": "https://api.github.com/users/xambroz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xambroz/subscriptions", "organizations_url": "https://api.github.com/users/xambroz/orgs", "repos_url": "https://api.github.com/users/xambroz/repos", "events_url": "https://api.github.com/users/xambroz/events{/privacy}", "received_events_url": "https://api.github.com/users/xambroz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-08-04T01:20:23Z", "updated_at": "2016-08-04T08:14:14Z", "closed_at": "2016-08-04T07:27:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\nthe dynamic linking of the yara python module is not allowed if there is also CUCKOO and MAGIC modules enabled. Is this really necessary? \n\nThe definitions -DMAGIC_MODULE=1 -DCUCKOO_MODULE=1 doesn't seem to be used for anything within yara-python.c and when linking dynamically to libyara still all the testcases from tests.py are working.\n\nAm I missing something or can we get rid of this check?\n\nThank you\nMichal Ambroz\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/19", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/19/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/19/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/19/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/19", "id": 168499457, "node_id": "MDU6SXNzdWUxNjg0OTk0NTc=", "number": 19, "title": "Request for comment - DEX module", "user": {"login": "CalebFenton", "id": 1356658, "node_id": "MDQ6VXNlcjEzNTY2NTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1356658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CalebFenton", "html_url": "https://github.com/CalebFenton", "followers_url": "https://api.github.com/users/CalebFenton/followers", "following_url": "https://api.github.com/users/CalebFenton/following{/other_user}", "gists_url": "https://api.github.com/users/CalebFenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/CalebFenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CalebFenton/subscriptions", "organizations_url": "https://api.github.com/users/CalebFenton/orgs", "repos_url": "https://api.github.com/users/CalebFenton/repos", "events_url": "https://api.github.com/users/CalebFenton/events{/privacy}", "received_events_url": "https://api.github.com/users/CalebFenton/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-07-31T03:30:22Z", "updated_at": "2016-07-31T15:21:19Z", "closed_at": "2016-07-31T15:21:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "We recently created a module for dalvik executables: https://github.com/rednaga/yara/blob/master/libyara/modules/dex.c\n\nWe're using the module for a tool we wrote called apkid, so we have a vested interest in maintaining the module: https://github.com/rednaga/APKiD\n\nWould this be something you're interested in merging into this project? We're not C wizards but we _did_ fuzz the code to make sure there weren't any obvious crashing vulns.\n\nI could make a pull request with this module, but I'm not sure how you'd want it integrated. Either as an optional `--with-dex` compile flag or enabled by default. Please advise.\n\ncc @strazzere\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/18", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/18/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/18/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/18/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/18", "id": 167174315, "node_id": "MDU6SXNzdWUxNjcxNzQzMTU=", "number": 18, "title": "setup.py fails with distutils 2.7.11", "user": {"login": "joachimmetz", "id": 3888750, "node_id": "MDQ6VXNlcjM4ODg3NTA=", "avatar_url": "https://avatars2.githubusercontent.com/u/3888750?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joachimmetz", "html_url": "https://github.com/joachimmetz", "followers_url": "https://api.github.com/users/joachimmetz/followers", "following_url": "https://api.github.com/users/joachimmetz/following{/other_user}", "gists_url": "https://api.github.com/users/joachimmetz/gists{/gist_id}", "starred_url": "https://api.github.com/users/joachimmetz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joachimmetz/subscriptions", "organizations_url": "https://api.github.com/users/joachimmetz/orgs", "repos_url": "https://api.github.com/users/joachimmetz/repos", "events_url": "https://api.github.com/users/joachimmetz/events{/privacy}", "received_events_url": "https://api.github.com/users/joachimmetz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-07-23T08:16:25Z", "updated_at": "2016-08-03T11:16:07Z", "closed_at": "2016-08-03T11:16:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "platform Windows 7 VS 2010\nsetuptools 18.2\ndistutils 2.7.11\n\nError:\n\n```\nAssertionError: Should have already checked this\n```\n\nWhere:\n\n```\ndistutils\\command\\bdist_msi.py\n```\n\nI think this is related to how setup.py delays defining the Extension()\n\nwork around\n\n```\nsetup.py build bdist_msi\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/17", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/17/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/17/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/17/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/17", "id": 165985105, "node_id": "MDU6SXNzdWUxNjU5ODUxMDU=", "number": 17, "title": "setup.py build fails to correctly detect missing openssl on Mac OS X", "user": {"login": "joachimmetz", "id": 3888750, "node_id": "MDQ6VXNlcjM4ODg3NTA=", "avatar_url": "https://avatars2.githubusercontent.com/u/3888750?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joachimmetz", "html_url": "https://github.com/joachimmetz", "followers_url": "https://api.github.com/users/joachimmetz/followers", "following_url": "https://api.github.com/users/joachimmetz/following{/other_user}", "gists_url": "https://api.github.com/users/joachimmetz/gists{/gist_id}", "starred_url": "https://api.github.com/users/joachimmetz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joachimmetz/subscriptions", "organizations_url": "https://api.github.com/users/joachimmetz/orgs", "repos_url": "https://api.github.com/users/joachimmetz/repos", "events_url": "https://api.github.com/users/joachimmetz/events{/privacy}", "received_events_url": "https://api.github.com/users/joachimmetz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-07-17T16:57:14Z", "updated_at": "2018-08-01T08:14:08Z", "closed_at": "2018-08-01T08:14:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Darwin X 15.5.0 Darwin Kernel Version 15.5.0: Tue Apr 19 18:36:36 PDT 2016; root:xnu-3248.50.21~8/RELEASE_X86_64 x86_64\n\n```\nsetup.py build\n```\n\n```\nyara/libyara/modules/hash.c:17:10: fatal error: 'openssl/md5.h' file not found\n#include <openssl/md5.h>\n         ^\n1 error generated.\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/14", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/14/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/14/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/14/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/14", "id": 161311580, "node_id": "MDU6SXNzdWUxNjEzMTE1ODA=", "number": 14, "title": "Feature request: expose ahocorasick in the bindings", "user": {"login": "pombredanne", "id": 675997, "node_id": "MDQ6VXNlcjY3NTk5Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/675997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pombredanne", "html_url": "https://github.com/pombredanne", "followers_url": "https://api.github.com/users/pombredanne/followers", "following_url": "https://api.github.com/users/pombredanne/following{/other_user}", "gists_url": "https://api.github.com/users/pombredanne/gists{/gist_id}", "starred_url": "https://api.github.com/users/pombredanne/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pombredanne/subscriptions", "organizations_url": "https://api.github.com/users/pombredanne/orgs", "repos_url": "https://api.github.com/users/pombredanne/repos", "events_url": "https://api.github.com/users/pombredanne/events{/privacy}", "received_events_url": "https://api.github.com/users/pombredanne/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-06-20T22:34:15Z", "updated_at": "2016-08-03T17:58:56Z", "closed_at": "2016-08-03T17:58:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "It would be great to have access to the ahorasick automaton in https://github.com/VirusTotal/yara/blob/b11898bf78336a1ee770e8162a1ac21114ffab88/libyara/ahocorasick.c through this binding\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/13", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/13/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/13/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/13/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/13", "id": 159058169, "node_id": "MDU6SXNzdWUxNTkwNTgxNjk=", "number": 13, "title": "yara-python wheels are built with the library in the wrong place", "user": {"login": "sruggier", "id": 427071, "node_id": "MDQ6VXNlcjQyNzA3MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/427071?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sruggier", "html_url": "https://github.com/sruggier", "followers_url": "https://api.github.com/users/sruggier/followers", "following_url": "https://api.github.com/users/sruggier/following{/other_user}", "gists_url": "https://api.github.com/users/sruggier/gists{/gist_id}", "starred_url": "https://api.github.com/users/sruggier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sruggier/subscriptions", "organizations_url": "https://api.github.com/users/sruggier/orgs", "repos_url": "https://api.github.com/users/sruggier/repos", "events_url": "https://api.github.com/users/sruggier/events{/privacy}", "received_events_url": "https://api.github.com/users/sruggier/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-06-08T01:04:52Z", "updated_at": "2017-05-23T00:37:23Z", "closed_at": "2017-05-22T16:44:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "I don't know off-hand why this is broken, but when yara is built as a wheel, the library gets placed at an incorrect path, which results in a broken installation.\n\nI suspect that [this ansible issue](https://github.com/ansible/ansible/issues/9169) is describing the same problem, so the notes there about absolute vs. relative paths may be relevant.\n\nWith wheel (broken):\n\n```\n$ virtualenv with-wheel && with-wheel/bin/pip install --upgrade pip && with-wheel/bin/pip install wheel && with-wheel/bin/pip install yara && find with-wheel -name libyara.so\nRunning virtualenv with interpreter /usr/bin/python2\nNew python executable in with-wheel/bin/python2\nAlso creating executable in with-wheel/bin/python\nInstalling setuptools, pip...done.\nDownloading/unpacking pip from https://pypi.python.org/packages/9c/32/004ce0852e0a127f07f358b715015763273799bd798956fa930814b60f39/pip-8.1.2-py2.py3-none-any.whl#md5=0570520434c5b600d89ec95393b2650b\n  Downloading pip-8.1.2-py2.py3-none-any.whl (1.2MB): 1.2MB downloaded\nInstalling collected packages: pip\n  Found existing installation: pip 1.5.6\n    Uninstalling pip:\n      Successfully uninstalled pip\nSuccessfully installed pip\nCleaning up...\nCollecting wheel\n  Downloading wheel-0.29.0-py2.py3-none-any.whl (66kB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 71kB 859kB/s \nInstalling collected packages: wheel\nSuccessfully installed wheel-0.29.0\nCollecting yara\n  Using cached yara-1.7.7.tar.gz\nBuilding wheels for collected packages: yara\n  Running setup.py bdist_wheel for yara ... done\n  Stored in directory: /home/myuser/.cache/pip/wheels/75/07/12/b7042cb4c8ec9b99f5e6a320fbabd92bbdf349dbe8d54f816a\nSuccessfully built yara\nInstalling collected packages: yara\nSuccessfully installed yara-1.7.7\nwith-wheel/lib/python2.7/site-packages/tmp/test/with-wheel/lib/libyara.so\n```\n\nThe normal installation process works fine:\n\n```\nvirtualenv without-wheel && without-wheel/bin/pip install --upgrade pip && without-wheel/bin/pip install yara && find without-wheel -name libyara.so\nRunning virtualenv with interpreter /usr/bin/python2\nNew python executable in without-wheel/bin/python2\nAlso creating executable in without-wheel/bin/python\nInstalling setuptools, pip...done.\nDownloading/unpacking pip from https://pypi.python.org/packages/9c/32/004ce0852e0a127f07f358b715015763273799bd798956fa930814b60f39/pip-8.1.2-py2.py3-none-any.whl#md5=0570520434c5b600d89ec95393b2650b\n  Downloading pip-8.1.2-py2.py3-none-any.whl (1.2MB): 1.2MB downloaded\nInstalling collected packages: pip\n  Found existing installation: pip 1.5.6\n    Uninstalling pip:\n      Successfully uninstalled pip\nSuccessfully installed pip\nCleaning up...\nCollecting yara\n  Using cached yara-1.7.7.tar.gz\nInstalling collected packages: yara\n  Running setup.py install for yara ... done\nSuccessfully installed yara-1.7.7\nwithout-wheel/lib/libyara.so\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/12", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/12/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/12/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/12/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/12", "id": 155732987, "node_id": "MDU6SXNzdWUxNTU3MzI5ODc=", "number": 12, "title": "Segfault when changing type in external variables", "user": {"login": "jurg", "id": 255318, "node_id": "MDQ6VXNlcjI1NTMxOA==", "avatar_url": "https://avatars0.githubusercontent.com/u/255318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jurg", "html_url": "https://github.com/jurg", "followers_url": "https://api.github.com/users/jurg/followers", "following_url": "https://api.github.com/users/jurg/following{/other_user}", "gists_url": "https://api.github.com/users/jurg/gists{/gist_id}", "starred_url": "https://api.github.com/users/jurg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jurg/subscriptions", "organizations_url": "https://api.github.com/users/jurg/orgs", "repos_url": "https://api.github.com/users/jurg/repos", "events_url": "https://api.github.com/users/jurg/events{/privacy}", "received_events_url": "https://api.github.com/users/jurg/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-19T13:11:25Z", "updated_at": "2016-06-20T10:35:59Z", "closed_at": "2016-06-20T10:35:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "If you compile a rule set in yara-python with defined external variables, then send it different types when matching (ie. you give it an int instead of a string) yara can segfault. If you give it an int instead of a string, it will pass that int to strlen as a pointer to the string to read:\n\n```\n#!/usr/bin/python                                          \n\nimport yara                                                \n\nexternal_vars = {                                          \n    \"test1\": \"\",                                           \n    \"test2\": 0                                             \n}                                                          \n\nbuggy_exts = {                                             \n    \"test1\": 0xDEADBEEF,                                   \n    \"test2\": 1                                             \n}                                                          \n\nrules = yara.compile(\"test.rules\", externals=external_vars)\nm = rules.match(\"test.rules\", externals=buggy_exts)\n```\n\nWill result in something like this(from gdb):\n\n```\n(gdb) run test.py\nStarting program: /usr/bin/python test.py\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n\nProgram received signal SIGSEGV, Segmentation fault.\nstrlen () at ../sysdeps/x86_64/strlen.S:106\n106 ../sysdeps/x86_64/strlen.S: No such file or directory.\n(gdb) i r\nrax            0xdeadbeef   3735928559\nrbx            0xdeadbeef   3735928559\n...\n```\n\nIn most (all?) cases you should be able to sanitize this input before it gets sent to yara, but that should not (IMO) be necessary - an error message or warning would be fine, but segfaulting is a bit bad.\n\nEdit: This is with latest commit in git. 3.4 release also has this behaviour.\nEdit 2: And the contents of `test.rules` doesn't matter.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/11", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/11/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/11/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/11/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/11", "id": 153162688, "node_id": "MDU6SXNzdWUxNTMxNjI2ODg=", "number": 11, "title": "ImportError: dynamic module does not define init function (inityara)", "user": {"login": "tungpun", "id": 5058370, "node_id": "MDQ6VXNlcjUwNTgzNzA=", "avatar_url": "https://avatars2.githubusercontent.com/u/5058370?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tungpun", "html_url": "https://github.com/tungpun", "followers_url": "https://api.github.com/users/tungpun/followers", "following_url": "https://api.github.com/users/tungpun/following{/other_user}", "gists_url": "https://api.github.com/users/tungpun/gists{/gist_id}", "starred_url": "https://api.github.com/users/tungpun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tungpun/subscriptions", "organizations_url": "https://api.github.com/users/tungpun/orgs", "repos_url": "https://api.github.com/users/tungpun/repos", "events_url": "https://api.github.com/users/tungpun/events{/privacy}", "received_events_url": "https://api.github.com/users/tungpun/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-05-05T03:41:06Z", "updated_at": "2018-08-01T08:13:29Z", "closed_at": "2018-08-01T08:13:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "I installed in a clean virtual machine yara from sources:\n\n```\n# ./bootstrap.sh\n# ./configure\n# make\n# sudo make install\n# yara -v\nyara 3.4.0\n```\n\nThen, I installed yara-python from github:\n\n```\n# git clone ...\n# python setup.py build\n# sudo python setup.py install\n```\n\nAnd when I received the next error when I import yara in python:\n\n```\n# python\nPython 2.6.6 (r266:84292, Jul 23 2015, 15:22:56) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-11)] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import yara\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nImportError: dynamic module does not define init function (inityara)\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/10", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/10/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/10/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/10/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/10", "id": 142057626, "node_id": "MDU6SXNzdWUxNDIwNTc2MjY=", "number": 10, "title": "Error installing from PIP", "user": {"login": "seifreed", "id": 1843119, "node_id": "MDQ6VXNlcjE4NDMxMTk=", "avatar_url": "https://avatars0.githubusercontent.com/u/1843119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seifreed", "html_url": "https://github.com/seifreed", "followers_url": "https://api.github.com/users/seifreed/followers", "following_url": "https://api.github.com/users/seifreed/following{/other_user}", "gists_url": "https://api.github.com/users/seifreed/gists{/gist_id}", "starred_url": "https://api.github.com/users/seifreed/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seifreed/subscriptions", "organizations_url": "https://api.github.com/users/seifreed/orgs", "repos_url": "https://api.github.com/users/seifreed/repos", "events_url": "https://api.github.com/users/seifreed/events{/privacy}", "received_events_url": "https://api.github.com/users/seifreed/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-03-19T12:35:48Z", "updated_at": "2019-04-26T20:05:59Z", "closed_at": "2016-03-19T15:02:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "Seifreed@machine:~$ sudo pip install yara\n\nThe directory '/Users/Seifreed/Library/Caches/pip/http' or its parent directory is not owned by the current user and the cache has been disabled. Please check the permissions and owner of that directory. If executing pip with sudo, you may want sudo's -H flag.\nThe directory '/Users/Seifreed/Library/Caches/pip' or its parent directory is not owned by the current user and caching wheels has been disabled. check the permissions and owner of that directory. If executing pip with sudo, you may want sudo's -H flag.\nCollecting yara\n  Downloading yara-1.7.7.tar.gz (387kB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 389kB 1.2MB/s\nInstalling collected packages: yara\n  Running setup.py install for yara ... error\n    Complete output from command /usr/bin/python -u -c \"import setuptools, tokenize;**file**='/private/tmp/pip-build-tmIEax/yara/setup.py';exec(compile(getattr(tokenize, 'open', open)(**file**).read().replace('\\r\\n', '\\n'), **file**, 'exec'))\" install --record /tmp/pip-GdhYyw-record/install-record.txt --single-version-externally-managed --compile:\n    running install\n    running build\n    running build_py\n    creating build\n    creating build/lib\n    creating build/lib/yara\n    copying yara/**init**.py -> build/lib/yara\n    copying yara/cli.py -> build/lib/yara\n    copying yara/libyara_wrapper.py -> build/lib/yara\n    copying yara/preprocessor.py -> build/lib/yara\n    copying yara/rules.py -> build/lib/yara\n    copying yara/scan.py -> build/lib/yara\n    copying yara/version.py -> build/lib/yara\n    creating build/lib/yara/rules\n    creating build/lib/yara/rules/example\n    copying yara/rules/example/foobar.yar -> build/lib/yara/rules/example\n    copying yara/rules/example/imports.yar -> build/lib/yara/rules/example\n    copying yara/rules/example/pe.yar -> build/lib/yara/rules/example\n    running install_lib\n    running install_data\n    copying ./libs/darwin/x86_64/libyara.so -> /System/Library/Frameworks/Python.framework/Versions/2.7/lib\n    error: [Errno 1] Operation not permitted: '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/libyara.so'\n\n```\n----------------------------------------\n```\n\n**Command \"/usr/bin/python -u -c \"import setuptools, tokenize;**file**='/private/tmp/pip-build-tmIEax/yara/setup.py';exec(compile(getattr(tokenize, 'open', open)(**file**).read().replace('\\r\\n', '\\n'), **file**, 'exec'))\" install --record /tmp/pip-GdhYyw-record/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /private/tmp/pip-build-tmIEax/yara/**\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/9", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/9/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/9/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/9/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/9", "id": 141000676, "node_id": "MDU6SXNzdWUxNDEwMDA2NzY=", "number": 9, "title": "YARA on Pypi", "user": {"login": "flamableconcrete", "id": 1014193, "node_id": "MDQ6VXNlcjEwMTQxOTM=", "avatar_url": "https://avatars2.githubusercontent.com/u/1014193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flamableconcrete", "html_url": "https://github.com/flamableconcrete", "followers_url": "https://api.github.com/users/flamableconcrete/followers", "following_url": "https://api.github.com/users/flamableconcrete/following{/other_user}", "gists_url": "https://api.github.com/users/flamableconcrete/gists{/gist_id}", "starred_url": "https://api.github.com/users/flamableconcrete/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flamableconcrete/subscriptions", "organizations_url": "https://api.github.com/users/flamableconcrete/orgs", "repos_url": "https://api.github.com/users/flamableconcrete/repos", "events_url": "https://api.github.com/users/flamableconcrete/events{/privacy}", "received_events_url": "https://api.github.com/users/flamableconcrete/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-03-15T15:08:04Z", "updated_at": "2017-05-22T16:29:43Z", "closed_at": "2017-05-22T16:29:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "It looks like you have pushed this version up to https://testpypi.python.org, but someone else ( mjdorma/ Michael Dorman) is the owner/maintainer on pypi. Is there any push to get this consolidated/figured out so YARA 3.4 can be for the masses? Thanks!\n\nhttps://pypi.python.org/pypi/yara\nhttps://testpypi.python.org/pypi/yara-python/3.4.4\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/7", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/7/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/7/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/7/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/7", "id": 138089950, "node_id": "MDU6SXNzdWUxMzgwODk5NTA=", "number": 7, "title": "undefined symbol: yr_finalize", "user": {"login": "plutec", "id": 444620, "node_id": "MDQ6VXNlcjQ0NDYyMA==", "avatar_url": "https://avatars2.githubusercontent.com/u/444620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plutec", "html_url": "https://github.com/plutec", "followers_url": "https://api.github.com/users/plutec/followers", "following_url": "https://api.github.com/users/plutec/following{/other_user}", "gists_url": "https://api.github.com/users/plutec/gists{/gist_id}", "starred_url": "https://api.github.com/users/plutec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plutec/subscriptions", "organizations_url": "https://api.github.com/users/plutec/orgs", "repos_url": "https://api.github.com/users/plutec/repos", "events_url": "https://api.github.com/users/plutec/events{/privacy}", "received_events_url": "https://api.github.com/users/plutec/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-03-03T06:38:17Z", "updated_at": "2019-05-07T19:00:02Z", "closed_at": "2016-08-03T11:21:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "I installed in a clean virtual machine yara from sources:\n\n```\n./bootstrap.sh\n./configure\nmake\nsudo make install\n```\n\nand yara works fine.\n\nThen, I installed yara-python from github:\n\n```\ngit clone ...\npython setup.py build\nsudo python setup.py install\n```\n\nAnd when I received the next error when I import yara in python:\n\n```\nPython 2.7.6 (default, Jun 22 2015, 17:58:13) \n[GCC 4.8.2] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import yara\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nImportError: /usr/local/lib/python2.7/dist-packages/yara_python-3.4.0.0-py2.7.egg/yara.so: undefined symbol: yr_finalize\n```\n\nAny idea?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/6", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/6/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/6/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/6/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/6", "id": 135485904, "node_id": "MDU6SXNzdWUxMzU0ODU5MDQ=", "number": 6, "title": "Seg fault with large rulesets", "user": {"login": "mlaferrera", "id": 3821041, "node_id": "MDQ6VXNlcjM4MjEwNDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/3821041?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mlaferrera", "html_url": "https://github.com/mlaferrera", "followers_url": "https://api.github.com/users/mlaferrera/followers", "following_url": "https://api.github.com/users/mlaferrera/following{/other_user}", "gists_url": "https://api.github.com/users/mlaferrera/gists{/gist_id}", "starred_url": "https://api.github.com/users/mlaferrera/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mlaferrera/subscriptions", "organizations_url": "https://api.github.com/users/mlaferrera/orgs", "repos_url": "https://api.github.com/users/mlaferrera/repos", "events_url": "https://api.github.com/users/mlaferrera/events{/privacy}", "received_events_url": "https://api.github.com/users/mlaferrera/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-02-22T17:33:25Z", "updated_at": "2017-05-22T16:39:27Z", "closed_at": "2017-05-22T16:39:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm running into a similar issue as #3, but it occurs when I am matching against compiled rules from a file object:\n\n```\n>>> import yara\n>>> # rules.yar is a 3.1Mb file with approximately 12k rules\n>>> with open(\"rules.yar\") as rules:\n...       rules = yara.compile(file=rules)\n>>> r.match(data=\"BADNESS\")\n[1] segmentation fault (core dumped)  python\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/5", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/5/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/5/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/5", "id": 131372998, "node_id": "MDU6SXNzdWUxMzEzNzI5OTg=", "number": 5, "title": "How to install?", "user": {"login": "scudette", "id": 3856546, "node_id": "MDQ6VXNlcjM4NTY1NDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3856546?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scudette", "html_url": "https://github.com/scudette", "followers_url": "https://api.github.com/users/scudette/followers", "following_url": "https://api.github.com/users/scudette/following{/other_user}", "gists_url": "https://api.github.com/users/scudette/gists{/gist_id}", "starred_url": "https://api.github.com/users/scudette/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scudette/subscriptions", "organizations_url": "https://api.github.com/users/scudette/orgs", "repos_url": "https://api.github.com/users/scudette/repos", "events_url": "https://api.github.com/users/scudette/events{/privacy}", "received_events_url": "https://api.github.com/users/scudette/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-02-04T15:00:09Z", "updated_at": "2017-05-22T16:32:15Z", "closed_at": "2017-05-22T16:32:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is this supposed to be working yet? \n\n```\n$ pip install -I yara-python\nDownloading/unpacking yara-python\n  Could not find any downloads that satisfy the requirement yara-python\nCleaning up...\nNo distributions at all found for yara-python\nStoring debug log for failure in /home/scudette/.pip/pip.log\n```\n\nAlso when installing by hand it seems to make an empty package. Even after `git submodule init/update`.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/3", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/3/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/3/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/3/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/3", "id": 121220435, "node_id": "MDU6SXNzdWUxMjEyMjA0MzU=", "number": 3, "title": "Seg. Fault", "user": {"login": "plutec", "id": 444620, "node_id": "MDQ6VXNlcjQ0NDYyMA==", "avatar_url": "https://avatars2.githubusercontent.com/u/444620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plutec", "html_url": "https://github.com/plutec", "followers_url": "https://api.github.com/users/plutec/followers", "following_url": "https://api.github.com/users/plutec/following{/other_user}", "gists_url": "https://api.github.com/users/plutec/gists{/gist_id}", "starred_url": "https://api.github.com/users/plutec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plutec/subscriptions", "organizations_url": "https://api.github.com/users/plutec/orgs", "repos_url": "https://api.github.com/users/plutec/repos", "events_url": "https://api.github.com/users/plutec/events{/privacy}", "received_events_url": "https://api.github.com/users/plutec/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-12-09T11:56:08Z", "updated_at": "2017-05-22T16:30:10Z", "closed_at": "2017-05-22T16:30:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm not sure if this problem is for Yara or Yara-python.\n\nWhen you compile several rules from a dictionary, it produce a seg.fault. Bellow you can follow a python code to reproduce it.\n\n```\nimport yara\nrules_dict = dict()\ncontent = 'import \"androguard\"\\r\\nimport \"file\"\\r\\nimport \"cuckoo\"\\r\\n\\r\\n\\r\\nrule koodous : official\\r\\n{\\r\\n\\tmeta:\\r\\n\\t\\tdescription = \"This rule detects the koodous application, used to show all Yara rules potential\"\\r\\n\\t\\tsample = \"e6ef34577a75fc0dc0a1f473304de1fc3a0d7d330bf58448db5f3108ed92741b\"\\r\\n\\r\\n\\tstrings:\\r\\n\\t\\t$a = {63 6F 6D 24 6B 6F 6F 64 6F 75 73 24 61 6E 64 72 6F 69 64}\\r\\n\\r\\n\\tcondition:\\r\\n\\t\\tandroguard.package_name(\"com.koodous.android\") and\\r\\n\\t\\tandroguard.app_name(\"Koodous\") and\\r\\n\\t\\tandroguard.activity(/Details_Activity/i) and\\r\\n\\t\\tandroguard.permission(/android.permission.INTERNET/) and\\r\\n\\t\\tandroguard.certificate.sha1(\"8399A145C14393A55AC4FCEEFB7AB4522A905139\") and\\r\\n\\t\\tandroguard.url(/koodous\\\\.com/) and\\r\\n\\t\\tnot file.md5(\"d367fd26b52353c2cce72af2435bd0d5\") and \\r\\n\\t\\t$a and\\r\\n\\t\\tcuckoo.network.dns_lookup(/settings.crashlytics.com/) //Yes, we use crashlytics to debug our app!\\r\\n\\t\\t\\r\\n}\\r\\n'\nfor i in range(1000):\n    rules_dict['rule_%d'%i] = content\n\nyara.compile(sources=rules_dict)\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/VirusTotal/yara-python/issues/2", "repository_url": "https://api.github.com/repos/VirusTotal/yara-python", "labels_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/2/labels{/name}", "comments_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/2/comments", "events_url": "https://api.github.com/repos/VirusTotal/yara-python/issues/2/events", "html_url": "https://github.com/VirusTotal/yara-python/issues/2", "id": 110585818, "node_id": "MDU6SXNzdWUxMTA1ODU4MTg=", "number": 2, "title": "import yara error: undefined symbol: yr_finalize", "user": {"login": "MindMac", "id": 1232354, "node_id": "MDQ6VXNlcjEyMzIzNTQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/1232354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MindMac", "html_url": "https://github.com/MindMac", "followers_url": "https://api.github.com/users/MindMac/followers", "following_url": "https://api.github.com/users/MindMac/following{/other_user}", "gists_url": "https://api.github.com/users/MindMac/gists{/gist_id}", "starred_url": "https://api.github.com/users/MindMac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MindMac/subscriptions", "organizations_url": "https://api.github.com/users/MindMac/orgs", "repos_url": "https://api.github.com/users/MindMac/repos", "events_url": "https://api.github.com/users/MindMac/events{/privacy}", "received_events_url": "https://api.github.com/users/MindMac/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2015-10-09T04:27:10Z", "updated_at": "2015-10-09T05:32:30Z", "closed_at": "2015-10-09T05:32:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "After installing the latest yara-python on Ubuntu 12.04.4 LTS, there is an error when import yara. I have compiled and installed the latest yara before installing yara-python.\n\nimport yara\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nImportError: /usr/local/lib/python2.7/dist-packages/yara_python-3.4.1-py2.7.egg/yara.so: undefined symbol: yr_finalize\n", "performed_via_github_app": null, "score": 1.0}]}