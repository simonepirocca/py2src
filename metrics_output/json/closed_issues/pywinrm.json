{"total_count": 158, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/diyan/pywinrm/issues/296", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/296/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/296/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/296/events", "html_url": "https://github.com/diyan/pywinrm/issues/296", "id": 639334371, "node_id": "MDU6SXNzdWU2MzkzMzQzNzE=", "number": 296, "title": "[WARNING]: Unhandled error in Python interpreter discovery for host x.x.x.x:basic: the specified credentials were rejected by the server", "user": {"login": "sureshkachwa", "id": 55589840, "node_id": "MDQ6VXNlcjU1NTg5ODQw", "avatar_url": "https://avatars0.githubusercontent.com/u/55589840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sureshkachwa", "html_url": "https://github.com/sureshkachwa", "followers_url": "https://api.github.com/users/sureshkachwa/followers", "following_url": "https://api.github.com/users/sureshkachwa/following{/other_user}", "gists_url": "https://api.github.com/users/sureshkachwa/gists{/gist_id}", "starred_url": "https://api.github.com/users/sureshkachwa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sureshkachwa/subscriptions", "organizations_url": "https://api.github.com/users/sureshkachwa/orgs", "repos_url": "https://api.github.com/users/sureshkachwa/repos", "events_url": "https://api.github.com/users/sureshkachwa/events{/privacy}", "received_events_url": "https://api.github.com/users/sureshkachwa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-16T03:07:25Z", "updated_at": "2020-06-16T06:00:20Z", "closed_at": "2020-06-16T03:24:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "x.x.x.x | UNREACHABLE! => {\r\n    \"changed\": false,\r\n    \"msg\": \"basic: the specified credentials were rejected by the server\",\r\n    \"unreachable\": true\r\n}\r\n\r\nthe above error is from my linux machine when trying to run ansible ad-hoc commands to a windows server 2012.\r\n\r\nBelow is the inventory file.\r\n\r\n[winrm]\r\n172.20.1.13\r\n\r\n[winrm:vars]\r\nansible_user=opc\r\nansible_password=xxxxxxxxxxxx\r\nansible_winrm_transport=basic\r\nansible_connection=winrm\r\nansible_winrm_server_cert_validation=ignore\r\n\r\nopc is a domain user and member of administrator as well, local firewall is allowing both ingress traffic for http on port 5985.\r\n\r\nBelow is winrm config:\r\n\r\nPS C:\\Windows\\system32> winrm get winrm/config\r\nConfig\r\n    MaxEnvelopeSizekb = 500\r\n    MaxTimeoutms = 60000\r\n    MaxBatchItems = 32000\r\n    MaxProviderRequests = 4294967295\r\n    Client\r\n        NetworkDelayms = 5000\r\n        URLPrefix = wsman\r\n        AllowUnencrypted = false\r\n        Auth\r\n            Basic = true\r\n            Digest = true\r\n            Kerberos = true\r\n            Negotiate = true\r\n            Certificate = true\r\n            CredSSP = false\r\n        DefaultPorts\r\n            HTTP = 5985\r\n            HTTPS = 5986\r\n        TrustedHosts\r\n    Service\r\n        RootSDDL = O:NSG:BAD:P(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)\r\n        MaxConcurrentOperations = 4294967295\r\n        MaxConcurrentOperationsPerUser = 1500\r\n        EnumerationTimeoutms = 240000\r\n        MaxConnections = 300\r\n        MaxPacketRetrievalTimeSeconds = 120\r\n        AllowUnencrypted = false\r\n        Auth\r\n            Basic = true\r\n            Kerberos = true\r\n            Negotiate = true\r\n            Certificate = false\r\n            CredSSP = false\r\n            CbtHardeningLevel = Relaxed\r\n        DefaultPorts\r\n            HTTP = 5985\r\n            HTTPS = 5986\r\n        IPv4Filter = *\r\n        IPv6Filter = *\r\n        EnableCompatibilityHttpListener = false\r\n        EnableCompatibilityHttpsListener = false\r\n        CertificateThumbprint\r\n        AllowRemoteAccess = true\r\n    Winrs\r\n        AllowRemoteShellAccess = true\r\n        IdleTimeout = 7200000\r\n        MaxConcurrentUsers = 2147483647\r\n        MaxShellRunTime = 2147483647\r\n        MaxProcessesPerShell = 2147483647\r\n        MaxMemoryPerShellMB = 2147483647\r\n        MaxShellsPerUser = 2147483647\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/294", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/294/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/294/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/294/events", "html_url": "https://github.com/diyan/pywinrm/issues/294", "id": 606185792, "node_id": "MDU6SXNzdWU2MDYxODU3OTI=", "number": 294, "title": "how to use variable", "user": {"login": "motianya211314", "id": 15711438, "node_id": "MDQ6VXNlcjE1NzExNDM4", "avatar_url": "https://avatars1.githubusercontent.com/u/15711438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/motianya211314", "html_url": "https://github.com/motianya211314", "followers_url": "https://api.github.com/users/motianya211314/followers", "following_url": "https://api.github.com/users/motianya211314/following{/other_user}", "gists_url": "https://api.github.com/users/motianya211314/gists{/gist_id}", "starred_url": "https://api.github.com/users/motianya211314/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/motianya211314/subscriptions", "organizations_url": "https://api.github.com/users/motianya211314/orgs", "repos_url": "https://api.github.com/users/motianya211314/repos", "events_url": "https://api.github.com/users/motianya211314/events{/privacy}", "received_events_url": "https://api.github.com/users/motianya211314/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-04-24T09:46:42Z", "updated_at": "2020-04-24T09:50:09Z", "closed_at": "2020-04-24T09:50:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "code:\r\ndef test(boolean):\r\n    exec_ps_script = \"\"\"\r\n        $tt = %s\r\n        if (\"$tt\" -eq $true){\r\n            ipconfig\r\n        }\r\n        \"\"\" % boolean\r\n    print(exec_ps_script)\r\n    r = s.run_ps(exec_ps_script)\r\n    print(r.std_out.decode(\"unicode_escape\"))\r\n    print(r.std_err.decode(\"unicode_escape\"))\r\n    if r.status_code == 0:\r\n        return True\r\n    else:\r\n        return False\r\n\r\nif __name__ == \"__main__\":\r\n    print(test(True))\r\n\r\nreturn:\r\n$tt = True\r\nif (\"$tt\" -eq $true){\r\n          ipconfig\r\n     }\r\n        \r\nTrue : The term 'True' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the\r\n spelling of the name, or if a path was included, verify that the path is correct and try again.\r\nAt line:2 char:15\r\n+         $tt = True\r\n+               ~~~~\r\n    + CategoryInfo          : ObjectNotFound: (True:String) [], CommandNotFoundException\r\n    + FullyQualifiedErrorId : CommandNotFoundException\r\nFalse\r\n\r\nhow to solve\uff1f", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/292", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/292/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/292/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/292/events", "html_url": "https://github.com/diyan/pywinrm/issues/292", "id": 558955896, "node_id": "MDU6SXNzdWU1NTg5NTU4OTY=", "number": 292, "title": "stuck on get_command_output in protocol.py", "user": {"login": "changsijay", "id": 245306, "node_id": "MDQ6VXNlcjI0NTMwNg==", "avatar_url": "https://avatars3.githubusercontent.com/u/245306?v=4", "gravatar_id": "", "url": "https://api.github.com/users/changsijay", "html_url": "https://github.com/changsijay", "followers_url": "https://api.github.com/users/changsijay/followers", "following_url": "https://api.github.com/users/changsijay/following{/other_user}", "gists_url": "https://api.github.com/users/changsijay/gists{/gist_id}", "starred_url": "https://api.github.com/users/changsijay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/changsijay/subscriptions", "organizations_url": "https://api.github.com/users/changsijay/orgs", "repos_url": "https://api.github.com/users/changsijay/repos", "events_url": "https://api.github.com/users/changsijay/events{/privacy}", "received_events_url": "https://api.github.com/users/changsijay/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-02-03T09:32:31Z", "updated_at": "2020-02-03T10:57:31Z", "closed_at": "2020-02-03T09:43:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I use ansible to collect facts on many servers, and on 1 host it stucked in `protocol.py` `get_command_output` in the [while loop](https://github.com/diyan/pywinrm/blob/master/winrm/protocol.py#L446)\r\n\r\nI've set ansible options but it didn't help\r\n\r\n```\r\nansible_winrm_operation_timeout_sec: 90\r\nansible_winrm_read_timeout_sec: 120\r\n```\r\n\r\nis there any option to set timeout in this case?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/291", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/291/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/291/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/291/events", "html_url": "https://github.com/diyan/pywinrm/issues/291", "id": 553736078, "node_id": "MDU6SXNzdWU1NTM3MzYwNzg=", "number": 291, "title": "Ansible playbook is not working but shows in play recap - ", "user": {"login": "jimmymalhan", "id": 32525076, "node_id": "MDQ6VXNlcjMyNTI1MDc2", "avatar_url": "https://avatars3.githubusercontent.com/u/32525076?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimmymalhan", "html_url": "https://github.com/jimmymalhan", "followers_url": "https://api.github.com/users/jimmymalhan/followers", "following_url": "https://api.github.com/users/jimmymalhan/following{/other_user}", "gists_url": "https://api.github.com/users/jimmymalhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimmymalhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimmymalhan/subscriptions", "organizations_url": "https://api.github.com/users/jimmymalhan/orgs", "repos_url": "https://api.github.com/users/jimmymalhan/repos", "events_url": "https://api.github.com/users/jimmymalhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jimmymalhan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-22T19:09:02Z", "updated_at": "2020-01-22T19:32:38Z", "closed_at": "2020-01-22T19:20:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Nothing changed on the target host, not even rebooted but able to ping and can do a handshake**\r\nPlaybook -\r\n\r\nPLAY [windows] *************************************************************************************************************************************************************\r\n\r\nTASK [Gathering Facts] *****************************************************************************************************************************************************\r\nok: [MQN-CKMH5E31UM7.corp.medqia.com]\r\n\r\nTASK [Install all security, critical, and rollup updates without a scheduled task] *****************************************************************************************\r\nok: [MQN-CKMH5E31UM7.corp.medqia.com]\r\n\r\nTASK [Install only security updates as a scheduled task for window machines] ***********************************************************************************************\r\nok: [MQN-CKMH5E31UM7.corp.medqia.com]\r\n\r\nTASK [Install only particular updates based on the KB numbers] *************************************************************************************************************\r\nok: [MQN-CKMH5E31UM7.corp.medqia.com]\r\n\r\nTASK [Install all security updates with automatic reboots] *****************************************************************************************************************\r\nok: [MQN-CKMH5E31UM7.corp.medqia.com]\r\n\r\nTASK [Ensure WinRM starts when the system has settled and is ready to work reliably] ***************************************************************************************\r\nok: [MQN-CKMH5E31UM7.corp.medqia.com]\r\n\r\n**PLAY RECAP *****************************************************************************************************************************************************************\r\nMQN-CKMH5E31UM7.corp.medqia.com : ok=6 changed=0 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0**\r\n\r\n**Playbook contents =**\r\nhosts: windows\r\nvars:\r\nansible_connection: winrm\r\nansible_ssh_port: 5986\r\nanisble_winrm_transport: kerberos\r\nansible_winrm_server_cert_validation: ignore\r\nvalidate_certs: false\r\nansible_winrm_scheme: https\r\nansibe_winrm_read_timeout_sec: 120\r\ntasks:\r\nname: Install all security, critical, and rollup updates without a scheduled task\r\nwin_updates:\r\ncategory_names:\r\n- SecurityUpdates\r\n- CriticalUpdates\r\n- UpdateRollups\r\n\r\nname: Install only security updates as a scheduled task for window machines\r\nwin_updates:\r\ncategory_names: SecurityUpdates\r\nuse_scheduled_task: yes\r\n\r\nname: Install only particular updates based on the KB numbers\r\nwin_updates:\r\ncategory_name:\r\n\r\nSecurityUpdates\r\nwhitelist:\r\nKB4528760\r\nKB890830\r\nKB4534271\r\nKB22677602\r\nname: Install all security updates with automatic reboots\r\nwin_updates:\r\ncategory_names:\r\n\r\nSecurityUpdates\r\nreboot: yes\r\nname: Ensure WinRM starts when the system has settled and is ready to work reliably\r\nwin_service:\r\nname: WinRM\r\nstart_mode: delayed", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/290", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/290/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/290/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/290/events", "html_url": "https://github.com/diyan/pywinrm/issues/290", "id": 549246569, "node_id": "MDU6SXNzdWU1NDkyNDY1Njk=", "number": 290, "title": "Ansible - ERROR! Syntax Error while loading YAML.", "user": {"login": "jimmymalhan", "id": 32525076, "node_id": "MDQ6VXNlcjMyNTI1MDc2", "avatar_url": "https://avatars3.githubusercontent.com/u/32525076?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimmymalhan", "html_url": "https://github.com/jimmymalhan", "followers_url": "https://api.github.com/users/jimmymalhan/followers", "following_url": "https://api.github.com/users/jimmymalhan/following{/other_user}", "gists_url": "https://api.github.com/users/jimmymalhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimmymalhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimmymalhan/subscriptions", "organizations_url": "https://api.github.com/users/jimmymalhan/orgs", "repos_url": "https://api.github.com/users/jimmymalhan/repos", "events_url": "https://api.github.com/users/jimmymalhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jimmymalhan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-13T23:41:45Z", "updated_at": "2020-01-14T00:09:30Z", "closed_at": "2020-01-14T00:09:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "---\r\n- hosts: windows\r\n  vars:\r\n    ansible_user: user@DOMAIN\r\n    ansible_password: #####\r\n    ansible_connection: winrm\r\n    ansible_ssh_port: 5986\r\n    anisble_winrm_transport: kerberos\r\n    ansible_winrm_server_cert_validation: ignore\r\n    validate_certs: false\r\n    ansible_winrm_scheme: https\r\n    ansibe_winrm_read_timeout_sec: 120\r\n  tasks:\r\n   - name: Install all security, critical, and rollup updates without a scheduled task\r\n     win_updates:\r\n       category_names:\r\n         - SecurityUpdates\r\n         - CriticalUpdates\r\n         - UpdateRollups\r\n\r\n   - name: Install only security updates as a scheduled task for window machines\r\n     win_updates:\r\n       category_names: SecurityUpdates\r\n       use_scheduled_task: yes\r\n\r\n   - name: Search-only, return list of found updates (if any), log to C:\\ansible_wu.txt\r\n     win_updates:\r\n       category_names: SecurityUpdates\r\n          state: searched\r\n          log_path: C:\\ansible_wu.txt\r\n\r\n  - name: Install all security updates with automatic reboots\r\n     win_updates:\r\n       category_names:\r\n        - SecurityUpdates\r\n          reboot: yes\r\n\r\n  - name: Install only particular updates based on the KB numbers\r\n     win_updates:\r\n      category_name:\r\n       - SecurityUpdates\r\n       whitelist:\r\n        - KB4056892\r\n        - KB4073117\r\n\r\n  - name: Exclude updates based on the update title\r\n     win_updates:\r\n      category_name:\r\n       - SecurityUpdates\r\n       - CriticalUpdates\r\n      blacklist:\r\n       - Windows Malicious Software Removal Tool for Windows\r\n       - \\d{4}-\\d{2} Cumulative Update for Windows Server 2016\r\n\r\n# One way to ensure the system is reliable just after a reboot, is to set WinRM to a delayed startup\r\n  - name: Ensure WinRM starts when the system has settled and is ready to work reliably\r\n     win_service:\r\n      name: WinRM\r\n      start_mode: delayed\r\n\r\n# Optionally, you can increase the reboot_timeout to survive long updates during reboot\r\n  - name: Ensure we wait long enough for the updates to be applied during reboot\r\n     win_updates:\r\n      reboot: yes\r\n      reboot_timeout: 3600\r\n\r\n# Search and download Windows updates\r\n  - name: Search and download Windows updates without installing them\r\n     win_updates:\r\n      state: downloaded\r\n\r\n![Capture](https://user-images.githubusercontent.com/32525076/72301235-10143c80-361b-11ea-9348-f829a939c044.PNG)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/289", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/289/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/289/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/289/events", "html_url": "https://github.com/diyan/pywinrm/issues/289", "id": 549172113, "node_id": "MDU6SXNzdWU1NDkxNzIxMTM=", "number": 289, "title": "Kerberos Authentication to WinRm - Unspecified GSS failure ", "user": {"login": "jimmymalhan", "id": 32525076, "node_id": "MDQ6VXNlcjMyNTI1MDc2", "avatar_url": "https://avatars3.githubusercontent.com/u/32525076?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimmymalhan", "html_url": "https://github.com/jimmymalhan", "followers_url": "https://api.github.com/users/jimmymalhan/followers", "following_url": "https://api.github.com/users/jimmymalhan/following{/other_user}", "gists_url": "https://api.github.com/users/jimmymalhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimmymalhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimmymalhan/subscriptions", "organizations_url": "https://api.github.com/users/jimmymalhan/orgs", "repos_url": "https://api.github.com/users/jimmymalhan/repos", "events_url": "https://api.github.com/users/jimmymalhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jimmymalhan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-01-13T20:46:27Z", "updated_at": "2020-01-13T21:23:08Z", "closed_at": "2020-01-13T20:51:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Considering klist and knit are successful passing through and can generate ticket\r\n=== yml.conf ===\r\n---\r\n- hosts: windows\r\n  vars:\r\n    ansible_user: user@DOMAIN_NAME\r\n    ansible_password: ######\r\n    ansible_connection: winrm\r\n    ansible_ssh_port: 5986\r\n    anisble_winrm_transport: kerberos\r\n    ansible_winrm_server_cert_validation: ignore\r\n    validate_certs: false\r\n    ansible_winrm_scheme: http\r\n    ansibe_winrm_read_timeout_sec: 60\r\n\r\n=== host file ===\r\n[windows]\r\n192.168.29.138\r\n10.0.2.226\r\n\r\n[windows:vars]\r\nansible_ssh_user = 'user@DOMAIN_NAME'\r\nansible_password = '######'\r\nansible_connection = winrm\r\nansible_ssh_port = 5986\r\nansible_winrm_transport = kerberos\r\nansible_winrm_server_cert_validation = ignore\r\nvalidate_certs = false\r\n\r\n![a](https://user-images.githubusercontent.com/32525076/72289914-fb2aaf80-3600-11ea-81ef-08d385fd0849.PNG)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/287", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/287/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/287/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/287/events", "html_url": "https://github.com/diyan/pywinrm/issues/287", "id": 534630517, "node_id": "MDU6SXNzdWU1MzQ2MzA1MTc=", "number": 287, "title": "TypeError: startswith first arg must be bytes or a tuple of bytes, not str", "user": {"login": "aaronesau-summit", "id": 58276648, "node_id": "MDQ6VXNlcjU4Mjc2NjQ4", "avatar_url": "https://avatars3.githubusercontent.com/u/58276648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaronesau-summit", "html_url": "https://github.com/aaronesau-summit", "followers_url": "https://api.github.com/users/aaronesau-summit/followers", "following_url": "https://api.github.com/users/aaronesau-summit/following{/other_user}", "gists_url": "https://api.github.com/users/aaronesau-summit/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaronesau-summit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaronesau-summit/subscriptions", "organizations_url": "https://api.github.com/users/aaronesau-summit/orgs", "repos_url": "https://api.github.com/users/aaronesau-summit/repos", "events_url": "https://api.github.com/users/aaronesau-summit/events{/privacy}", "received_events_url": "https://api.github.com/users/aaronesau-summit/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-09T00:29:20Z", "updated_at": "2019-12-09T00:37:30Z", "closed_at": "2019-12-09T00:37:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to execute a simple `Add-Content` PS command but am getting this (I verified that it worked on the remote host):\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/winrm/__init__.py\", line 54, in run_ps\r\n    rs.std_err = self._clean_error_msg(rs.std_err)\r\n  File \"/usr/lib/python3/dist-packages/winrm/__init__.py\", line 62, in _clean_error_msg\r\n    if msg.startswith(\"#< CLIXML\\r\\n\"):\r\nTypeError: startswith first arg must be bytes or a tuple of bytes, not str\r\n```\r\n\r\nIs this a bug? It looks like it errors after receiving a response, which makes me think it's an issue with the library.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/286", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/286/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/286/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/286/events", "html_url": "https://github.com/diyan/pywinrm/issues/286", "id": 534625409, "node_id": "MDU6SXNzdWU1MzQ2MjU0MDk=", "number": 286, "title": "urllib3.connectionpool Failed to parse headers ", "user": {"login": "aaronesau-summit", "id": 58276648, "node_id": "MDQ6VXNlcjU4Mjc2NjQ4", "avatar_url": "https://avatars3.githubusercontent.com/u/58276648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaronesau-summit", "html_url": "https://github.com/aaronesau-summit", "followers_url": "https://api.github.com/users/aaronesau-summit/followers", "following_url": "https://api.github.com/users/aaronesau-summit/following{/other_user}", "gists_url": "https://api.github.com/users/aaronesau-summit/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaronesau-summit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaronesau-summit/subscriptions", "organizations_url": "https://api.github.com/users/aaronesau-summit/orgs", "repos_url": "https://api.github.com/users/aaronesau-summit/repos", "events_url": "https://api.github.com/users/aaronesau-summit/events{/privacy}", "received_events_url": "https://api.github.com/users/aaronesau-summit/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-08T23:56:11Z", "updated_at": "2019-12-09T00:27:36Z", "closed_at": "2019-12-09T00:09:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "When executing a command after connecting, I get this from urllib3:\r\n\r\n## Warning:\r\n\r\n```\r\n2019-12-08_23:52:58:WARNING:urllib3.connectionpool Failed to parse headers (url=http://172.31.16.32:5985/wsman): [StartBoundaryNotFoundDefect(), MultipartInvariantViolationDefect()], unparsed data: ''\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/urllib3/connectionpool.py\", line 396, in _make_request\r\n    assert_header_parsing(httplib_response.msg)\r\n  File \"/usr/lib/python3/dist-packages/urllib3/util/response.py\", line 72, in assert_header_parsing\r\n    raise HeaderParsingError(defects=defects, unparsed_data=unparsed_data)\r\nurllib3.exceptions.HeaderParsingError: [StartBoundaryNotFoundDefect(), MultipartInvariantViolationDefect()], unparsed data: ''\r\n```\r\n## Version Details:\r\n\r\nPython 3.7.3\r\n```\r\n>>> urllib3.__version__\r\n'1.24.1'\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/285", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/285/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/285/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/285/events", "html_url": "https://github.com/diyan/pywinrm/issues/285", "id": 521399619, "node_id": "MDU6SXNzdWU1MjEzOTk2MTk=", "number": 285, "title": "Error when out is too long on run_ps", "user": {"login": "fernandocastrovilar", "id": 33423447, "node_id": "MDQ6VXNlcjMzNDIzNDQ3", "avatar_url": "https://avatars3.githubusercontent.com/u/33423447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fernandocastrovilar", "html_url": "https://github.com/fernandocastrovilar", "followers_url": "https://api.github.com/users/fernandocastrovilar/followers", "following_url": "https://api.github.com/users/fernandocastrovilar/following{/other_user}", "gists_url": "https://api.github.com/users/fernandocastrovilar/gists{/gist_id}", "starred_url": "https://api.github.com/users/fernandocastrovilar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fernandocastrovilar/subscriptions", "organizations_url": "https://api.github.com/users/fernandocastrovilar/orgs", "repos_url": "https://api.github.com/users/fernandocastrovilar/repos", "events_url": "https://api.github.com/users/fernandocastrovilar/events{/privacy}", "received_events_url": "https://api.github.com/users/fernandocastrovilar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-11-12T08:27:55Z", "updated_at": "2020-01-30T11:37:02Z", "closed_at": "2020-01-30T11:37:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Library:**\r\n\r\n- pywinrm==0.3.0\r\n\r\nWhen running a powershell command with run_ps, if the output is too long, it returns and error.\r\n\r\nThe script i'm trying to run is a simple user domain list:\r\n```\r\n$Users = Get-ADUser -Filter *\r\nForeach($U In $Users)\r\n{\r\n    Write-Host $U.Name\"#\"$U.GivenName\"#\"$U.DistinguishedName\"#\"$U.Enabled\"#\"$U.Surname\"@\"\r\n}\r\n```\r\nThis issue was reproduced on python3.x as follow:\r\n```\r\n>>> import winrm\r\n>>> s = winrm.Session('domain.controller', auth=('User', 'Password'))\r\n>>> script = '''$Users = Get-ADUser -Filter * \\n\r\n... Foreach($U In $Users)\\n\r\n... {\\n\r\n...     Write-Host $U.Name\"#\"$U.GivenName\"#\"$U.DistinguishedName\"#\"$U.Enabled\"#\"$U.Surname\"@\" \\n\r\n... }\\n '''\r\n>>> r = s.run_ps(script)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/lib/python3/dist-packages/winrm/__init__.py\", line 54, in run_ps\r\n    rs.std_err = self._clean_error_msg(rs.std_err)\r\n  File \"/usr/lib/python3/dist-packages/winrm/__init__.py\", line 62, in _clean_error_msg\r\n    if msg.startswith(\"#< CLIXML\\r\\n\"):\r\nTypeError: startswith first arg must be bytes or a tuple of bytes, not str\r\n```\r\n\r\nAs temporal fix, i commented the next lines on `winrm/__init__.py` what apparently make the function working well again with long outputs:\r\n```\r\n51,55c51,55\r\n<         if len(rs.std_err):\r\n<             # if there was an error message, clean it it up and make it human\r\n<             # readable\r\n<             rs.std_err = self._clean_error_msg(rs.std_err)\r\n<         return rs\r\n---\r\n>         #if len(rs.std_err):\r\n>         #    # if there was an error message, clean it it up and make it human\r\n>         #    # readable\r\n>         #    rs.std_err = self._clean_error_msg(rs.std_err)\r\n>         #return rs\r\n```\r\n\r\nAs additional data, the output which is making the failed has 161573 characters long.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/280", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/280/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/280/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/280/events", "html_url": "https://github.com/diyan/pywinrm/issues/280", "id": 517215516, "node_id": "MDU6SXNzdWU1MTcyMTU1MTY=", "number": 280, "title": "requests_kerberos import issue", "user": {"login": "tdavison784", "id": 32623295, "node_id": "MDQ6VXNlcjMyNjIzMjk1", "avatar_url": "https://avatars2.githubusercontent.com/u/32623295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tdavison784", "html_url": "https://github.com/tdavison784", "followers_url": "https://api.github.com/users/tdavison784/followers", "following_url": "https://api.github.com/users/tdavison784/following{/other_user}", "gists_url": "https://api.github.com/users/tdavison784/gists{/gist_id}", "starred_url": "https://api.github.com/users/tdavison784/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tdavison784/subscriptions", "organizations_url": "https://api.github.com/users/tdavison784/orgs", "repos_url": "https://api.github.com/users/tdavison784/repos", "events_url": "https://api.github.com/users/tdavison784/events{/privacy}", "received_events_url": "https://api.github.com/users/tdavison784/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-11-04T15:10:38Z", "updated_at": "2019-11-04T18:15:24Z", "closed_at": "2019-11-04T18:15:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI am having an issue when trying to use the pywinrm module. I have narrowed the problem down to the following line in: winrm.transport module. \r\n\r\nIssue:\r\n\r\nWhen running a test connect against a Windows server in my domain I get the following exception\r\n\r\n~~~\r\nfrom winrm.protocol import Protocol\r\np = Protocol(\r\nendpoint='http://myserver:5985/wsman',\r\ntransport='kerberos',\r\nusername=r'username@MY.DOMAIN',\r\npassword='password')\r\nshell_id = p.open_shell()\r\nwinrm.exceptions.WinRMError: requested auth method is kerberos, but requests_kerberos is not installed\r\n~~~\r\n\r\nI have narrowed it down to line 26 in winrm.transport module:\r\n\r\n~~~\r\nfrom .vendor.requests_kerberos import HTTPKerberosAuth, REQUIRED\r\n~~~\r\n\r\nIt appears that the  .vendor. import seems to be breaking the import when the module is already present in my virtualenv.\r\n\r\nFix:\r\nWhen I remove the .vendor. portion of the import I can get the module to work correctly. \r\n\r\n~~~\r\nfrom requests_kerberos import HTTPKerberosAuth, REQUIRED\r\n~~~\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/277", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/277/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/277/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/277/events", "html_url": "https://github.com/diyan/pywinrm/issues/277", "id": 509581093, "node_id": "MDU6SXNzdWU1MDk1ODEwOTM=", "number": 277, "title": "Multi-Threaded WinRM Requests Fail.", "user": {"login": "Neetz", "id": 4192211, "node_id": "MDQ6VXNlcjQxOTIyMTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/4192211?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Neetz", "html_url": "https://github.com/Neetz", "followers_url": "https://api.github.com/users/Neetz/followers", "following_url": "https://api.github.com/users/Neetz/following{/other_user}", "gists_url": "https://api.github.com/users/Neetz/gists{/gist_id}", "starred_url": "https://api.github.com/users/Neetz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Neetz/subscriptions", "organizations_url": "https://api.github.com/users/Neetz/orgs", "repos_url": "https://api.github.com/users/Neetz/repos", "events_url": "https://api.github.com/users/Neetz/events{/privacy}", "received_events_url": "https://api.github.com/users/Neetz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-10-20T11:21:32Z", "updated_at": "2019-10-26T20:11:11Z", "closed_at": "2019-10-26T20:11:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello!\r\n\r\nI'm using  **winrm** package with python, what i've observed is let's say you have a **single threaded** program where you try to connect to host and execute a cmd ( any command ) it works, but as soon as i spawn multiple threads to execute the same command, it fails with the authorization issue **the specified credentials were rejected by the server**\r\n\r\nThe threads don't change the variables, the threads simply resuse the variables created from the process stack. Just specifiying that, there is no write-racing of variables between the threads.\r\n \r\n```\r\nimport threading\r\nfrom winrm import Session\r\n\r\nsession = Session(\r\n      \"10.46.32.49\",\r\n      auth=(\"my_ad\", \"my_passwd\"),\r\n      transport=\"ntlm\"\r\n    )\r\ncmd = \"Test-Path \\\\\\\\aute31548153\\\\some_share\"\r\n\r\ndef abc():\r\n  resp = session.run_ps(cmd)\r\n  response = {\r\n    'status': resp.status_code,\r\n    'stdout': resp.std_out,\r\n    'stderr': resp.std_err\r\n  }\r\n  print response\r\n\r\n\r\nt1 = threading.Thread(target=abc)\r\nt2 = threading.Thread(target=abc)\r\nt3 = threading.Thread(target=abc)\r\n\r\nt1.start()\r\nt2.start()\r\nt3.start()\r\n\r\n```\r\nI get **InvalidCredentialsError: the specified credentials were rejected by the server** from all 3 threads here. \r\nBut if i have a single thread executing the same program, it goes through. \r\nNow I'm not sure whether there's a problem in the package or is it the HOST's settings? But it looks like it's not the host settings problem because if i create a session variable for each thread it goes through fine, i took a look at the method `**run_cmd**` which gets called by **runs_ps**\r\nIt looks like there is only one shell which is being opened and closed. Instead i'd request the framework to have a pool of connection and maintain the closure and opens of the handle accordingly.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/276", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/276/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/276/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/276/events", "html_url": "https://github.com/diyan/pywinrm/issues/276", "id": 494083908, "node_id": "MDU6SXNzdWU0OTQwODM5MDg=", "number": 276, "title": "Failed to establish a new connection", "user": {"login": "abhicool92", "id": 33102268, "node_id": "MDQ6VXNlcjMzMTAyMjY4", "avatar_url": "https://avatars3.githubusercontent.com/u/33102268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhicool92", "html_url": "https://github.com/abhicool92", "followers_url": "https://api.github.com/users/abhicool92/followers", "following_url": "https://api.github.com/users/abhicool92/following{/other_user}", "gists_url": "https://api.github.com/users/abhicool92/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhicool92/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhicool92/subscriptions", "organizations_url": "https://api.github.com/users/abhicool92/orgs", "repos_url": "https://api.github.com/users/abhicool92/repos", "events_url": "https://api.github.com/users/abhicool92/events{/privacy}", "received_events_url": "https://api.github.com/users/abhicool92/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-16T14:23:53Z", "updated_at": "2019-10-21T00:57:26Z", "closed_at": "2019-10-21T00:57:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying to connect multiple instances in a given CIDR range using python winrm. We are getting the following exception.\r\n\r\n`\r\nimport wimrm \r\n\r\nurl = \"http://10.24.x.x:5985/wsman\"\r\n username = admin@domain.com\r\npassword = xxxx\r\n\r\nsession = winrm.Session(url, auth=(username, password), transport='ntlm', server_cert_validation = 'ignore') \r\n\r\n`\r\n\r\nEXCEPTION HTTPConnectionPool(host='10.24.x.x', port=5985): Max retries exceeded with url: /wsman (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x191062B0>: Failed to establish a new connection: [WinError 10055] An operation on a socket could not be performed because the system lacked sufficient buffer space or because a queue was full'))  \r\n\r\nWhen tried connecting to a single server we were able to connect it. Would appreciate if provided with a solution. \r\n\r\nPython 3.6\r\npywinrm 0.3.0", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/275", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/275/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/275/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/275/events", "html_url": "https://github.com/diyan/pywinrm/issues/275", "id": 492561037, "node_id": "MDU6SXNzdWU0OTI1NjEwMzc=", "number": 275, "title": "non-administrative user run PowerShell/Enter-PSSession ok, but pywinrm failed", "user": {"login": "AndrewTsao", "id": 133179, "node_id": "MDQ6VXNlcjEzMzE3OQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/133179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AndrewTsao", "html_url": "https://github.com/AndrewTsao", "followers_url": "https://api.github.com/users/AndrewTsao/followers", "following_url": "https://api.github.com/users/AndrewTsao/following{/other_user}", "gists_url": "https://api.github.com/users/AndrewTsao/gists{/gist_id}", "starred_url": "https://api.github.com/users/AndrewTsao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AndrewTsao/subscriptions", "organizations_url": "https://api.github.com/users/AndrewTsao/orgs", "repos_url": "https://api.github.com/users/AndrewTsao/repos", "events_url": "https://api.github.com/users/AndrewTsao/events{/privacy}", "received_events_url": "https://api.github.com/users/AndrewTsao/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-09-12T03:11:16Z", "updated_at": "2019-09-17T05:55:03Z", "closed_at": "2019-09-12T09:44:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "I use this command to allow non-admin user new ps session.\r\n```powershell\r\nSet-PSSessionConfiguration -Name Microsoft.PowerShell -ShowSecurityDescriptorUI -Force\r\n```\r\n\r\nbut I run this code fail. and use administrator user is ok.\r\n\r\n```powershell\r\nimport winrm\r\n\r\ns = winrm.Session('http://127.0.0.1:55985/wsman',\r\n                  auth=('test', 'xxxxx'),\r\n                  transport='credssp')\r\nr = s.run_cmd('ipconfig', [r'/all'])\r\nprint(r.status_code)\r\nprint(r.std_out.decode('gbk'))\r\n```\r\n\r\nshow this error.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"e:\\test\\credssp\\.venv\\lib\\site-packages\\winrm\\transport.py\", line 262, in _send_message_request\r\n    response.raise_for_status()\r\n  File \"e:\\test\\credssp\\.venv\\lib\\site-packages\\requests\\models.py\", line 940, in raise_for_status\r\n    raise HTTPError(http_error_msg, response=self)\r\nrequests.exceptions.HTTPError: 500 Server Error:  for url: http://127.0.0.1:55985/wsman\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"e:\\test\\credssp\\.venv\\lib\\site-packages\\winrm\\protocol.py\", line 234, in send_message\r\n    resp = self.transport.send_message(message)\r\n  File \"e:\\test\\credssp\\.venv\\lib\\site-packages\\winrm\\transport.py\", line 256, in send_message\r\n    response = self._send_message_request(prepared_request, message)\r\n  File \"e:\\test\\credssp\\.venv\\lib\\site-packages\\winrm\\transport.py\", line 273, in _send_message_request\r\n    raise WinRMTransportError('http', ex.response.status_code, response_text)\r\nwinrm.exceptions.WinRMTransportError: Bad HTTP response returned from server. Code 500\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"c:\\Users\\caosw\\.vscode\\extensions\\ms-python.python-2019.9.34911\\pythonFiles\\ptvsd_launcher.py\", line 43, in <module>\r\n    main(ptvsdArgs)\r\n  File \"c:\\Users\\caosw\\.vscode\\extensions\\ms-python.python-2019.9.34911\\pythonFiles\\lib\\python\\ptvsd\\__main__.py\", line 432, in main\r\n    run()\r\n  File \"c:\\Users\\caosw\\.vscode\\extensions\\ms-python.python-2019.9.34911\\pythonFiles\\lib\\python\\ptvsd\\__main__.py\", line 316, in run_file\r\n    runpy.run_path(target, run_name='__main__')\r\n  File \"D:\\ProgramData\\Anaconda3\\lib\\runpy.py\", line 263, in run_path\r\n    pkg_name=pkg_name, script_name=fname)\r\n  File \"D:\\ProgramData\\Anaconda3\\lib\\runpy.py\", line 96, in _run_module_code\r\n    mod_name, mod_spec, pkg_name, script_name)\r\n  File \"D:\\ProgramData\\Anaconda3\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"e:\\test\\credssp\\test.py\", line 6, in <module>\r\n    r = s.run_cmd('ipconfig', [r'/all'])\r\n  File \"e:\\test\\credssp\\.venv\\lib\\site-packages\\winrm\\__init__.py\", line 37, in run_cmd\r\n    shell_id = self.protocol.open_shell()\r\n  File \"e:\\test\\credssp\\.venv\\lib\\site-packages\\winrm\\protocol.py\", line 157, in open_shell\r\n    res = self.send_message(xmltodict.unparse(req))\r\n  File \"e:\\test\\credssp\\.venv\\lib\\site-packages\\winrm\\protocol.py\", line 272, in send_message\r\n    raise WinRMError('{0} (extended fault data: {1})'.format(error_message, fault_data))\r\nwinrm.exceptions.WinRMError: Access is denied.  (extended fault data: {'transport_message': 'Bad HTTP response returned from server. Code 500', 'http_status_code': 500, 'wsmanfault_code': '5', 'fault_code': 's:Sender', 'fault_subcode': 'w:AccessDenied'})\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/274", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/274/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/274/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/274/events", "html_url": "https://github.com/diyan/pywinrm/issues/274", "id": 491524474, "node_id": "MDU6SXNzdWU0OTE1MjQ0NzQ=", "number": 274, "title": "powershell hangs / no timeout", "user": {"login": "ronansalmon", "id": 10869202, "node_id": "MDQ6VXNlcjEwODY5MjAy", "avatar_url": "https://avatars3.githubusercontent.com/u/10869202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronansalmon", "html_url": "https://github.com/ronansalmon", "followers_url": "https://api.github.com/users/ronansalmon/followers", "following_url": "https://api.github.com/users/ronansalmon/following{/other_user}", "gists_url": "https://api.github.com/users/ronansalmon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronansalmon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronansalmon/subscriptions", "organizations_url": "https://api.github.com/users/ronansalmon/orgs", "repos_url": "https://api.github.com/users/ronansalmon/repos", "events_url": "https://api.github.com/users/ronansalmon/events{/privacy}", "received_events_url": "https://api.github.com/users/ronansalmon/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-09-10T08:26:00Z", "updated_at": "2020-01-22T20:01:14Z", "closed_at": "2020-01-22T20:01:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "winrm is hanging on some windows servers and this cause by different reasons, ex:\r\n- wmi hanging because of the TiWorker\r\n- The following PS is hanging : `Invoke-WmiMethod -EA Ignore -Name GetServerFeature -Namespace root\\microsoft\\windows\\servermanager -Class MSFT_ServerManagerTasks\r\n`\r\nEx:\r\n\r\n```\r\nfrom winrm.protocol import Protocol\r\n\r\np = Protocol(\r\n    endpoint='https://10.0.0.1:5986/wsman',\r\n    transport='ntlm',\r\n    username=r'user',\r\n    password='password',\r\n    server_cert_validation='ignore')\r\nshell_id = p.open_shell()\r\ncommand_id = p.run_command(shell_id, 'powershell', ['ipconfig /all'])\r\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\r\ncommand_id = p.run_command(shell_id, 'powershell', ['Invoke-WmiMethod -EA Ignore -Name GetServerFeature -Namespace root\\microsoft\\windows\\servermanager -Class MSFT_ServerManagerTasks'])\r\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\r\n\r\n```\r\n`ipconfig /all ` works just fine, but the script will hang on the next command. \r\nI understand that those servers may have stability issues, but how come the command never timed out ? Is it not supposed to be killed after operation_timeout_sec ?\r\nHow can we eventually automatically kill the running command ?\r\n\r\nI have a server having this issue right now. If you need to run some test/debugging, please ask me asap as we are going to reboot it soon enough.\r\n\r\npywinrm  0.3.0\r\nPython 2.7.5\r\n\r\nThanks\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/273", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/273/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/273/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/273/events", "html_url": "https://github.com/diyan/pywinrm/issues/273", "id": 484460455, "node_id": "MDU6SXNzdWU0ODQ0NjA0NTU=", "number": 273, "title": "Executing code on LOCAL exchange server", "user": {"login": "goooroooX", "id": 27283908, "node_id": "MDQ6VXNlcjI3MjgzOTA4", "avatar_url": "https://avatars0.githubusercontent.com/u/27283908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goooroooX", "html_url": "https://github.com/goooroooX", "followers_url": "https://api.github.com/users/goooroooX/followers", "following_url": "https://api.github.com/users/goooroooX/following{/other_user}", "gists_url": "https://api.github.com/users/goooroooX/gists{/gist_id}", "starred_url": "https://api.github.com/users/goooroooX/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goooroooX/subscriptions", "organizations_url": "https://api.github.com/users/goooroooX/orgs", "repos_url": "https://api.github.com/users/goooroooX/repos", "events_url": "https://api.github.com/users/goooroooX/events{/privacy}", "received_events_url": "https://api.github.com/users/goooroooX/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-08-23T10:36:44Z", "updated_at": "2019-08-23T11:06:10Z", "closed_at": "2019-08-23T11:06:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi! I'm trying to implement following PS code with pypsrp for the **local** Exchange server:\r\n```\r\n$Session = (New-PSSession -configurationname Microsoft.Exchange -connectionURI http://exchange-srv.acme.com/PowerShell)\r\nImport-PSSession $Session\r\nSearch-AdminAuditLog -StartDate '07-17-2019 09:00:00' -EndDate '07-18-2019 11:00:00'\r\n```\r\n\r\nPS code works fine, but not pypsrp version:\r\n\r\n```\r\nfrom pypsrp.powershell import PowerShell, RunspacePool\r\nfrom pypsrp.wsman import WSMan\r\n\r\nwsman = WSMan(server=\"exchange-srv.acme.com\", port=5985, path=\"wsman\", username=\"DOMAIN\\\\user\", password=\"password\", ssl=False, auth=\"kerberos\", cert_validation=False)\r\n\r\nwith RunspacePool(wsman, configuration_name=\"Microsoft.Exchange\") as pool:\r\n    ps = PowerShell(pool)\r\n    ps.add_script(\"Search-AdminAuditLog -StartDate '07-17-2019 09:00:00' -EndDate '07-18-2019 11:00:00'\")\r\n    output = ps.invoke()\r\n    print output\r\n```\r\n\r\nThe code above  return resource exception:\r\n> pypsrp.exceptions.WSManFaultError: Received a WSManFault message. (Code: 2150858811, Machine: srv-scn-cas1.scnsoft.com, Reason: The WS-Management service cannot process the request. The resource URI (http://schemas.microsoft.com/powershell/Microsoft.Exchange) was not found in the WS-Management catalog. The catalog contains the metadata that describes resources, or logical endpoints.)\r\n\r\nWhen changing \"path\" to \"powershell\", I got 404:\r\n> HTTP Error 404. The requested resource is not found.\r\n\r\nCan anyone help to identify the problem?\r\nThank you in advance!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/272", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/272/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/272/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/272/events", "html_url": "https://github.com/diyan/pywinrm/issues/272", "id": 479450617, "node_id": "MDU6SXNzdWU0Nzk0NTA2MTc=", "number": 272, "title": "User NTLM Authentication Issue", "user": {"login": "nbulischeck", "id": 18054589, "node_id": "MDQ6VXNlcjE4MDU0NTg5", "avatar_url": "https://avatars0.githubusercontent.com/u/18054589?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbulischeck", "html_url": "https://github.com/nbulischeck", "followers_url": "https://api.github.com/users/nbulischeck/followers", "following_url": "https://api.github.com/users/nbulischeck/following{/other_user}", "gists_url": "https://api.github.com/users/nbulischeck/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbulischeck/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbulischeck/subscriptions", "organizations_url": "https://api.github.com/users/nbulischeck/orgs", "repos_url": "https://api.github.com/users/nbulischeck/repos", "events_url": "https://api.github.com/users/nbulischeck/events{/privacy}", "received_events_url": "https://api.github.com/users/nbulischeck/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-12T03:04:54Z", "updated_at": "2019-08-12T07:45:20Z", "closed_at": "2019-08-12T07:45:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using the [ruby WinRM](https://github.com/WinRb/WinRM) package, I can authenticate to the remote server as \"Administrator\" and the normal user, however when using PyWinRM I can only authenticate as \"Administrator\". I'm not terribly sure why this would happen as the HTTPNtlmAuth succeeds in the example below:\r\n\r\n```Python\r\nimport requests\r\nfrom requests_ntlm import HttpNtlmAuth\r\n\r\nsession = requests.Session()\r\nsession.verify = False\r\n\r\ndef negotiate(username, password):\r\n    headers = {\r\n        'Content-Type': 'application/soap+xml;charset=UTF-8'\r\n    }\r\n    session.auth = HttpNtlmAuth(username, password)\r\n    if not session.post('http://10.10.10.1:5985/wsman').ok:\r\n        return False\r\n    return True\r\n\r\nprint(negotiate('user', r'password'))\r\n```\r\n\r\nBelow is the Ruby WinRM connection and the Python version that I ported.\r\n\r\n```Ruby\r\nconn = WinRM::Connection.new( \r\n  endpoint: 'http://10.10.10.1:5985/wsman',\r\n  transport: :negotiate,\r\n  user: 'user',\r\n  password: 'password',\r\n  :no_ssl_peer_verification => true\r\n)\r\n```\r\n\r\n```Python\r\np = winrm.protocol.Protocol(\r\n  endpoint  = 'http://10.10.10.1:5985/wsman',\r\n  transport = 'ntlm',\r\n  username  = 'user',\r\n  password  = 'password',\r\n  server_cert_validation = 'ignore'\r\n)\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/267", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/267/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/267/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/267/events", "html_url": "https://github.com/diyan/pywinrm/issues/267", "id": 465489047, "node_id": "MDU6SXNzdWU0NjU0ODkwNDc=", "number": 267, "title": "Embed kerberos auth handler", "user": {"login": "nitzmahone", "id": 6775756, "node_id": "MDQ6VXNlcjY3NzU3NTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/6775756?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nitzmahone", "html_url": "https://github.com/nitzmahone", "followers_url": "https://api.github.com/users/nitzmahone/followers", "following_url": "https://api.github.com/users/nitzmahone/following{/other_user}", "gists_url": "https://api.github.com/users/nitzmahone/gists{/gist_id}", "starred_url": "https://api.github.com/users/nitzmahone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nitzmahone/subscriptions", "organizations_url": "https://api.github.com/users/nitzmahone/orgs", "repos_url": "https://api.github.com/users/nitzmahone/repos", "events_url": "https://api.github.com/users/nitzmahone/events{/privacy}", "received_events_url": "https://api.github.com/users/nitzmahone/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-07-08T22:37:18Z", "updated_at": "2019-07-11T20:06:05Z", "closed_at": "2019-07-11T20:06:05Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "The [requests-kerberos](https://github.com/requests/requests-kerberos/) auth handler pywinrm relies on for Kerberos auth is going to remove functionality needed by pywinrm for HTTP message encryption (see https://github.com/requests/requests-kerberos/pull/133) in order to fix some concurrency issues when using requests-kerberos from multiple threads with a shared session object.\r\n\r\nRather than scrambling to adapt pywinrm to the (still unproven) method being proposed over on requests-kerberos, I'm suggesting that we embed a copy of requests-kerberos locally. We could also either just switch over to requests-gssapi or embed a copy of that and use python-gssapi directly, but we'd have to keep some form of the old stuff around to support Windows clients anyway (since python-gssapi didn't support Windows last I checked).\r\n\r\n@badcure @jborean93 this is a fairly major storm headed our way, so we'll need to act quickly before requests-kerberos does a release, or everyone's going to be broken... Thoughts?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/261", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/261/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/261/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/261/events", "html_url": "https://github.com/diyan/pywinrm/issues/261", "id": 453920653, "node_id": "MDU6SXNzdWU0NTM5MjA2NTM=", "number": 261, "title": "Concerns with the direction and ownership of pywinrm", "user": {"login": "badcure", "id": 4654506, "node_id": "MDQ6VXNlcjQ2NTQ1MDY=", "avatar_url": "https://avatars0.githubusercontent.com/u/4654506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/badcure", "html_url": "https://github.com/badcure", "followers_url": "https://api.github.com/users/badcure/followers", "following_url": "https://api.github.com/users/badcure/following{/other_user}", "gists_url": "https://api.github.com/users/badcure/gists{/gist_id}", "starred_url": "https://api.github.com/users/badcure/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/badcure/subscriptions", "organizations_url": "https://api.github.com/users/badcure/orgs", "repos_url": "https://api.github.com/users/badcure/repos", "events_url": "https://api.github.com/users/badcure/events{/privacy}", "received_events_url": "https://api.github.com/users/badcure/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-06-09T17:37:43Z", "updated_at": "2019-06-11T01:32:11Z", "closed_at": "2019-06-11T01:32:10Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "I am currently concerned with the state of pywinrm, and winrm in general within the Python community. The core of the issue is the apparent inability for not just me, but others to be able to contribute and help guide the direction of pywinrm. For some examples, you can see my comments in #243.\r\n\r\nI created a couple of PRs back in 2016, and since then have had 0 interactions. Most notably is #132, which I think is still valid today. I think the ability to completely close all network connections to the server when the task is completed would be great. Ansible doesn't necessarily need this, the application exits when it is done. If there is an always-on application that uses it, this can become very beneficial. \r\n\r\nThe problem as I see it and as @nitzmahone stated in #249: It is not maintained because they are moving to https://github.com/jborean93/pypsrpby in Ansible. Let me preface this, I am not questioning the quality, direction, etc of this new project. Nor am I saying that others should not use it. If it makes sense for you, go ahead! My concern is that @jborean93 also works for Ansible...I may be wrong in the long run, but it is very possible that the fate of that project will be the same: Features will be added only to the extent that it benefits the Ansible product.\r\n\r\nThe current owners essentially have 0 vested interest in seeing pywinrm succeed. One example that I see is the ability to transfer files. Each application has to build its own, which is what Ansible did. As you can see in #77, @nitzmahone mentioned that Ansible had to build its own even though he essentially runs this project. https://github.com/ansible/ansible/pull/13209 is an example of work he did for Ansible for this in particular, that I think could have benefited this project and community as a whole. Even to this day, I think that would be an extremely beneficial feature to have. @jborean93 wrote his own. It will probably become the new standard out of necessity and not community preference. As far as committing work, #222 is an example to where multiple multiple PRs years old by various people, were finally addressed only by work that they both did. \r\n\r\nMy question out of all this is simply: Are there any community driven(and not Ansible dictated) WinRM solutions out there? If it is pywinrm, what is the process? Regardless, my view is it should be clearly stated whether pywinrm is now an Ansible helper library only, or an open source library for the Python Community.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/259", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/259/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/259/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/259/events", "html_url": "https://github.com/diyan/pywinrm/issues/259", "id": 426268804, "node_id": "MDU6SXNzdWU0MjYyNjg4MDQ=", "number": 259, "title": "winrm.exceptions.WinRMError: The WS-Management service cannot process the request because the request contained invalid selectors for the resource.", "user": {"login": "rustyscottweber", "id": 4672283, "node_id": "MDQ6VXNlcjQ2NzIyODM=", "avatar_url": "https://avatars2.githubusercontent.com/u/4672283?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rustyscottweber", "html_url": "https://github.com/rustyscottweber", "followers_url": "https://api.github.com/users/rustyscottweber/followers", "following_url": "https://api.github.com/users/rustyscottweber/following{/other_user}", "gists_url": "https://api.github.com/users/rustyscottweber/gists{/gist_id}", "starred_url": "https://api.github.com/users/rustyscottweber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rustyscottweber/subscriptions", "organizations_url": "https://api.github.com/users/rustyscottweber/orgs", "repos_url": "https://api.github.com/users/rustyscottweber/repos", "events_url": "https://api.github.com/users/rustyscottweber/events{/privacy}", "received_events_url": "https://api.github.com/users/rustyscottweber/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-28T02:40:55Z", "updated_at": "2019-05-30T15:51:45Z", "closed_at": "2019-05-28T23:18:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "After a process dies a terrible death.. I get the following exception:\r\n\r\n```\r\n    stdout, stderr, return_code, command_done = self.protocol._raw_get_command_output(self.shell_id, self.command_id)\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\winrm\\protocol.py\", line 417, in _raw_get_command_output\r\n    res = self.send_message(xmltodict.unparse(req))\r\n  File \"C:\\Program Files\\Python37\\lib\\site-packages\\winrm\\protocol.py\", line 272, in send_message\r\n    raise WinRMError('{0} (extended fault data: {1})'.format(error_message, fault_data))\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/258", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/258/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/258/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/258/events", "html_url": "https://github.com/diyan/pywinrm/issues/258", "id": 423550422, "node_id": "MDU6SXNzdWU0MjM1NTA0MjI=", "number": 258, "title": "requests.exceptions.HTTPError: 401 Client Error:  for url", "user": {"login": "zhaowei699", "id": 30488215, "node_id": "MDQ6VXNlcjMwNDg4MjE1", "avatar_url": "https://avatars3.githubusercontent.com/u/30488215?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhaowei699", "html_url": "https://github.com/zhaowei699", "followers_url": "https://api.github.com/users/zhaowei699/followers", "following_url": "https://api.github.com/users/zhaowei699/following{/other_user}", "gists_url": "https://api.github.com/users/zhaowei699/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhaowei699/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhaowei699/subscriptions", "organizations_url": "https://api.github.com/users/zhaowei699/orgs", "repos_url": "https://api.github.com/users/zhaowei699/repos", "events_url": "https://api.github.com/users/zhaowei699/events{/privacy}", "received_events_url": "https://api.github.com/users/zhaowei699/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-21T02:33:55Z", "updated_at": "2019-05-28T23:21:19Z", "closed_at": "2019-05-28T23:21:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Error:\r\nTraceback (most recent call last):\r\n  File \"C:\\software\\anaconda3440\\envs\\D3plot\\lib\\site-packages\\winrm\\transport.py\", line 262, in _send_message_request\r\n    response.raise_for_status()\r\n  File \"C:\\software\\anaconda3440\\envs\\D3plot\\lib\\site-packages\\requests\\models.py\", line 928, in raise_for_status\r\n    raise HTTPError(http_error_msg, response=self)\r\nrequests.exceptions.HTTPError: 401 Client Error:  for url: http://ctc-app02.ap.autoliv.int:5985/wsman\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\ncode:\r\nimport winrm\r\nwintest = winrm.Session('http://server name:5985/wsman',auth=('user','Password'))\r\nret = wintest.run_cmd('ipconfig')\r\nprint(ret)\r\n\r\nserver winrm setting:\r\n>winrm get winrm/config\r\nConfig\r\n    MaxEnvelopeSizekb = 150\r\n    MaxTimeoutms = 60000\r\n    MaxBatchItems = 32000\r\n    MaxProviderRequests = 4294967295\r\n    Client\r\n        NetworkDelayms = 5000\r\n        URLPrefix = wsman\r\n        AllowUnencrypted = false\r\n        Auth\r\n            Basic = true\r\n            Digest = true\r\n            Kerberos = true\r\n            Negotiate = true\r\n            Certificate = true\r\n            CredSSP = false\r\n        DefaultPorts\r\n            HTTP = 5985\r\n            HTTPS = 5986\r\n        TrustedHosts\r\n    Service\r\n        RootSDDL = O:NSG:BAD:P(A;;GA;;;BA)S:P(AU;FA;GA;;;WD)(AU;SA;GWGX;;;WD)\r\n        MaxConcurrentOperations = 4294967295\r\n        MaxConcurrentOperationsPerUser = 15\r\n        EnumerationTimeoutms = 60000\r\n        MaxConnections = 25\r\n        MaxPacketRetrievalTimeSeconds = 120\r\n        AllowUnencrypted = true\r\n        Auth\r\n            Basic = true\r\n            Kerberos = true\r\n            Negotiate = true\r\n            Certificate = false\r\n            CredSSP = false\r\n            CbtHardeningLevel = Relaxed\r\n        DefaultPorts\r\n            HTTP = 5985\r\n            HTTPS = 5986\r\n        IPv4Filter = *\r\n        IPv6Filter = *\r\n        EnableCompatibilityHttpListener = false\r\n        EnableCompatibilityHttpsListener = false\r\n        CertificateThumbprint\r\n    Winrs\r\n        AllowRemoteShellAccess = true\r\n        IdleTimeout = 180000\r\n        MaxConcurrentUsers = 5\r\n        MaxShellRunTime = 2147483647\r\n        MaxProcessesPerShell = 15\r\n        MaxMemoryPerShellMB = 150\r\n        MaxShellsPerUser = 5\r\nPlease kindly help me, thanks a lot", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/255", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/255/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/255/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/255/events", "html_url": "https://github.com/diyan/pywinrm/issues/255", "id": 420987005, "node_id": "MDU6SXNzdWU0MjA5ODcwMDU=", "number": 255, "title": "Only one environment variable is set on a shell", "user": {"login": "nmaludy", "id": 3693851, "node_id": "MDQ6VXNlcjM2OTM4NTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/3693851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nmaludy", "html_url": "https://github.com/nmaludy", "followers_url": "https://api.github.com/users/nmaludy/followers", "following_url": "https://api.github.com/users/nmaludy/following{/other_user}", "gists_url": "https://api.github.com/users/nmaludy/gists{/gist_id}", "starred_url": "https://api.github.com/users/nmaludy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nmaludy/subscriptions", "organizations_url": "https://api.github.com/users/nmaludy/orgs", "repos_url": "https://api.github.com/users/nmaludy/repos", "events_url": "https://api.github.com/users/nmaludy/events{/privacy}", "received_events_url": "https://api.github.com/users/nmaludy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-03-14T12:19:00Z", "updated_at": "2019-05-24T23:30:58Z", "closed_at": "2019-05-24T23:30:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Currently `Protocol.open_shell` only sets a single environment variable for the whole `env_vars` dict.\r\n\r\nLooking at the code i believe the bug is here: https://github.com/diyan/pywinrm/blob/master/winrm/protocol.py#L155\r\n\r\n```python\r\n        if env_vars:\r\n            env = shell.setdefault('rsp:Environment', {})\r\n            for key, value in env_vars.items():\r\n                env['rsp:Variable'] = {'@Name': key, '#text': value}\r\n```\r\n\r\nAs you can see, it appears that `env['rsp:Variable']` is overwritten many times and the last item is the one that wins.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/254", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/254/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/254/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/254/events", "html_url": "https://github.com/diyan/pywinrm/issues/254", "id": 420535807, "node_id": "MDU6SXNzdWU0MjA1MzU4MDc=", "number": 254, "title": "Getting different output when executing commands through winrm", "user": {"login": "bhanukumar22", "id": 17473678, "node_id": "MDQ6VXNlcjE3NDczNjc4", "avatar_url": "https://avatars3.githubusercontent.com/u/17473678?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bhanukumar22", "html_url": "https://github.com/bhanukumar22", "followers_url": "https://api.github.com/users/bhanukumar22/followers", "following_url": "https://api.github.com/users/bhanukumar22/following{/other_user}", "gists_url": "https://api.github.com/users/bhanukumar22/gists{/gist_id}", "starred_url": "https://api.github.com/users/bhanukumar22/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bhanukumar22/subscriptions", "organizations_url": "https://api.github.com/users/bhanukumar22/orgs", "repos_url": "https://api.github.com/users/bhanukumar22/repos", "events_url": "https://api.github.com/users/bhanukumar22/events{/privacy}", "received_events_url": "https://api.github.com/users/bhanukumar22/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-13T14:37:35Z", "updated_at": "2019-05-28T23:22:45Z", "closed_at": "2019-05-28T23:22:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have run AD  commands on the server manually, got the output properly.\r\nBut when executed same command using winrm, it is giving different output.\r\n\r\nAll the servers are in AWS.\r\n\r\nScenario: There are 5 servers, which has to be reached from master and get the status of the servers.\r\nWhen run manually on the master, it is reaching to all the 5 servers and fetch the status of servers.\r\nBut, when we are trying to execute the command from linux to windows master server, it is reaching only one server and rest we are not getting output. Getting 110 error.\r\n\r\nKindly help here, let me know if you need further information.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/253", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/253/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/253/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/253/events", "html_url": "https://github.com/diyan/pywinrm/issues/253", "id": 418702606, "node_id": "MDU6SXNzdWU0MTg3MDI2MDY=", "number": 253, "title": "Release 0.3.1?", "user": {"login": "dentarg", "id": 42626, "node_id": "MDQ6VXNlcjQyNjI2", "avatar_url": "https://avatars2.githubusercontent.com/u/42626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dentarg", "html_url": "https://github.com/dentarg", "followers_url": "https://api.github.com/users/dentarg/followers", "following_url": "https://api.github.com/users/dentarg/following{/other_user}", "gists_url": "https://api.github.com/users/dentarg/gists{/gist_id}", "starred_url": "https://api.github.com/users/dentarg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dentarg/subscriptions", "organizations_url": "https://api.github.com/users/dentarg/orgs", "repos_url": "https://api.github.com/users/dentarg/repos", "events_url": "https://api.github.com/users/dentarg/events{/privacy}", "received_events_url": "https://api.github.com/users/dentarg/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-03-08T09:25:28Z", "updated_at": "2019-11-03T04:07:17Z", "closed_at": "2019-11-03T04:07:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "@nitzmahone do you have any plans to release 0.3.1 with https://github.com/diyan/pywinrm/pull/202?\r\n\r\nI see that you updated the changelog in https://github.com/diyan/pywinrm/commit/354b1cd49e1a28839832463abf691d9fff1f8e6f but there's no such release, which is a bit confusing", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/252", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/252/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/252/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/252/events", "html_url": "https://github.com/diyan/pywinrm/issues/252", "id": 418102864, "node_id": "MDU6SXNzdWU0MTgxMDI4NjQ=", "number": 252, "title": "pywinrm can't run some ConvertFrom-SecureString -SecureString", "user": {"login": "rickroot", "id": 11386229, "node_id": "MDQ6VXNlcjExMzg2MjI5", "avatar_url": "https://avatars0.githubusercontent.com/u/11386229?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rickroot", "html_url": "https://github.com/rickroot", "followers_url": "https://api.github.com/users/rickroot/followers", "following_url": "https://api.github.com/users/rickroot/following{/other_user}", "gists_url": "https://api.github.com/users/rickroot/gists{/gist_id}", "starred_url": "https://api.github.com/users/rickroot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rickroot/subscriptions", "organizations_url": "https://api.github.com/users/rickroot/orgs", "repos_url": "https://api.github.com/users/rickroot/repos", "events_url": "https://api.github.com/users/rickroot/events{/privacy}", "received_events_url": "https://api.github.com/users/rickroot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-07T02:44:45Z", "updated_at": "2019-06-24T20:09:34Z", "closed_at": "2019-06-24T20:09:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi \r\nI encounter an issue when I run some script on my windows 2012R2 server, I write chef cookbook to deploy our windows services, all other step works, but just in a step include ConvertFrom-SecureString function. I run recipe on windows directly it's work properly, it's failed just in remotely use pywinrm. it show \"access deny\", I pick up the actual code in python run directly, it's also failed, I tested by powershell directly, it works. So I think it's should be related to pywinrm itself, Could you someone help investigate it?\r\n\r\n>>> import winrm\r\n>>> session =winrm.Session('xxxx.example.com', auth=('admin', 'fssfbxf3!!!'))\r\n>>> ps_script=\"\"\"\r\n... $ProgressPreference = 'SilentlyContinue'\r\n... $ClearPass = \"Abcd1234\"\r\n... $SecurePass = $ClearPass | ConvertTo-SecureString -AsPlainText -Force\r\n... ConvertFrom-SecureString -SecureString $SecurePass -verbose | out-file \"D:\\\\mongos.key\"\r\n... get-content \"D:\\\\mongos.key\"\r\n... \"\"\"\r\n>>> session.run_ps(ps_script)\r\nb'#< CLIXML\\r\\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><S S=\"Error\">ConvertFrom-SecureString : Access is denied._x000D__x000A_</S><S S=\"Error\">At line:5 char:1_x000D__x000A_</S><S S=\"Error\">+ ConvertFrom-SecureString -SecureString $SecurePass -verbose | out-fil ..._x000D__x000A_</S><S S=\"Error\">+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~_x000D__x000A_</S><S S=\"Error\">    + CategoryInfo          : NotSpecified: (:) [ConvertFrom-SecureString], Cr _x000D__x000A_</S><S S=\"Error\">   yptographicException_x000D__x000A_</S><S S=\"Error\">    + FullyQualifiedErrorId : System.Security.Cryptography.CryptographicExcept _x000D__x000A_</S><S S=\"Error\">   ion,Microsoft.PowerShell.Commands.ConvertFromSecureStringCommand_x000D__x000A_</S><S S=\"Error\"> _x000D__x000A_</S></Objs>'\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/251", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/251/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/251/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/251/events", "html_url": "https://github.com/diyan/pywinrm/issues/251", "id": 417720876, "node_id": "MDU6SXNzdWU0MTc3MjA4NzY=", "number": 251, "title": "Installation on Windows", "user": {"login": "damienvanrobaeys", "id": 8832278, "node_id": "MDQ6VXNlcjg4MzIyNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/8832278?v=4", "gravatar_id": "", "url": "https://api.github.com/users/damienvanrobaeys", "html_url": "https://github.com/damienvanrobaeys", "followers_url": "https://api.github.com/users/damienvanrobaeys/followers", "following_url": "https://api.github.com/users/damienvanrobaeys/following{/other_user}", "gists_url": "https://api.github.com/users/damienvanrobaeys/gists{/gist_id}", "starred_url": "https://api.github.com/users/damienvanrobaeys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/damienvanrobaeys/subscriptions", "organizations_url": "https://api.github.com/users/damienvanrobaeys/orgs", "repos_url": "https://api.github.com/users/damienvanrobaeys/repos", "events_url": "https://api.github.com/users/damienvanrobaeys/events{/privacy}", "received_events_url": "https://api.github.com/users/damienvanrobaeys/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-06T10:07:57Z", "updated_at": "2019-05-28T23:23:55Z", "closed_at": "2019-05-28T23:23:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI am using Rundeck installed on a Windows computer.\r\nRundeck used a plugin Python Winrm, [this one,](https://github.com/rundeck-plugins/py-winrm-plugin) \r\nThis plugin requires pywinrm.\r\n\r\nI tested on a Linux by installing pyrim and it worked like a charm but I try to test it from Windows.\r\nI have installed Python 3 and 2 and also anaconda but have the following issue: \r\n**_Cannot run program \"python\": CreateProcess error=2, File specified not found_**\r\n\r\nDo you know what should be missing that is includes in pywim ?\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/249", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/249/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/249/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/249/events", "html_url": "https://github.com/diyan/pywinrm/issues/249", "id": 404820573, "node_id": "MDU6SXNzdWU0MDQ4MjA1NzM=", "number": 249, "title": "is this project no longer maintained?", "user": {"login": "graingert", "id": 413772, "node_id": "MDQ6VXNlcjQxMzc3Mg==", "avatar_url": "https://avatars3.githubusercontent.com/u/413772?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graingert", "html_url": "https://github.com/graingert", "followers_url": "https://api.github.com/users/graingert/followers", "following_url": "https://api.github.com/users/graingert/following{/other_user}", "gists_url": "https://api.github.com/users/graingert/gists{/gist_id}", "starred_url": "https://api.github.com/users/graingert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graingert/subscriptions", "organizations_url": "https://api.github.com/users/graingert/orgs", "repos_url": "https://api.github.com/users/graingert/repos", "events_url": "https://api.github.com/users/graingert/events{/privacy}", "received_events_url": "https://api.github.com/users/graingert/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-01-30T15:19:59Z", "updated_at": "2019-06-11T07:29:41Z", "closed_at": "2019-05-28T23:28:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "looks like a lot of PRs are open but not reviewed", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/246", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/246/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/246/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/246/events", "html_url": "https://github.com/diyan/pywinrm/issues/246", "id": 393087384, "node_id": "MDU6SXNzdWUzOTMwODczODQ=", "number": 246, "title": "Unable to read the directory which has hypen in the path", "user": {"login": "babvin", "id": 30034691, "node_id": "MDQ6VXNlcjMwMDM0Njkx", "avatar_url": "https://avatars1.githubusercontent.com/u/30034691?v=4", "gravatar_id": "", "url": "https://api.github.com/users/babvin", "html_url": "https://github.com/babvin", "followers_url": "https://api.github.com/users/babvin/followers", "following_url": "https://api.github.com/users/babvin/following{/other_user}", "gists_url": "https://api.github.com/users/babvin/gists{/gist_id}", "starred_url": "https://api.github.com/users/babvin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/babvin/subscriptions", "organizations_url": "https://api.github.com/users/babvin/orgs", "repos_url": "https://api.github.com/users/babvin/repos", "events_url": "https://api.github.com/users/babvin/events{/privacy}", "received_events_url": "https://api.github.com/users/babvin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-12-20T15:12:11Z", "updated_at": "2019-06-24T20:13:24Z", "closed_at": "2019-06-24T20:13:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nimport winrm \r\nfqdn=\"host\"\r\nuser = \"username\"\r\npasswd = \"password\"\r\ns = winrm.Session(fqdn, auth=(user, passwd))\r\npath = 'dir \"E:\\Program Files\\EMC\\DPA\\services\\shared\\report-results\"'\r\nr1 = s.run_cmd(path)\r\nout=r1.std_out.decode('utf8')\r\nprint(out)\r\n```\r\nI'm not able to get into the directory and print the output\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/245", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/245/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/245/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/245/events", "html_url": "https://github.com/diyan/pywinrm/issues/245", "id": 387216276, "node_id": "MDU6SXNzdWUzODcyMTYyNzY=", "number": 245, "title": "System.Management.Automation.PSCustomObject error", "user": {"login": "mnjagadeesh", "id": 4705969, "node_id": "MDQ6VXNlcjQ3MDU5Njk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4705969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mnjagadeesh", "html_url": "https://github.com/mnjagadeesh", "followers_url": "https://api.github.com/users/mnjagadeesh/followers", "following_url": "https://api.github.com/users/mnjagadeesh/following{/other_user}", "gists_url": "https://api.github.com/users/mnjagadeesh/gists{/gist_id}", "starred_url": "https://api.github.com/users/mnjagadeesh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mnjagadeesh/subscriptions", "organizations_url": "https://api.github.com/users/mnjagadeesh/orgs", "repos_url": "https://api.github.com/users/mnjagadeesh/repos", "events_url": "https://api.github.com/users/mnjagadeesh/events{/privacy}", "received_events_url": "https://api.github.com/users/mnjagadeesh/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-12-04T10:25:22Z", "updated_at": "2020-05-07T14:30:57Z", "closed_at": "2019-06-24T20:20:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "Here my code\r\n\r\nr = s.run_ps('dir') I am getting below message in r.std_err\r\n\r\n```\r\n#< CLIXML\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\"><Obj S=\"progress\" RefId=\"0\"><TN RefId=\"0\"><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=\"SourceId\">1</I64><PR N=\"Record\"><AV>Preparing modules for first use.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>\r\n```\r\n\r\nany insights and help is appriciated.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/244", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/244/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/244/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/244/events", "html_url": "https://github.com/diyan/pywinrm/issues/244", "id": 379617802, "node_id": "MDU6SXNzdWUzNzk2MTc4MDI=", "number": 244, "title": "Failed to establish a new connection - ...target machine actively refused", "user": {"login": "lastusrnameon3", "id": 34868770, "node_id": "MDQ6VXNlcjM0ODY4Nzcw", "avatar_url": "https://avatars3.githubusercontent.com/u/34868770?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lastusrnameon3", "html_url": "https://github.com/lastusrnameon3", "followers_url": "https://api.github.com/users/lastusrnameon3/followers", "following_url": "https://api.github.com/users/lastusrnameon3/following{/other_user}", "gists_url": "https://api.github.com/users/lastusrnameon3/gists{/gist_id}", "starred_url": "https://api.github.com/users/lastusrnameon3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lastusrnameon3/subscriptions", "organizations_url": "https://api.github.com/users/lastusrnameon3/orgs", "repos_url": "https://api.github.com/users/lastusrnameon3/repos", "events_url": "https://api.github.com/users/lastusrnameon3/events{/privacy}", "received_events_url": "https://api.github.com/users/lastusrnameon3/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-11-12T04:35:41Z", "updated_at": "2019-06-24T20:21:08Z", "closed_at": "2019-06-24T20:21:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "`from winrm.protocol import Protocol\r\n\r\np = Protocol(\r\n    endpoint='https://windows-host:5986/wsman',\r\n    transport='ntlm',\r\n    message_encryption='auto',\r\n    username=r'somedomain\\someuser',\r\n    password='MyPassword',\r\n    server_cert_validation='ignore')\r\nshell_id = p.open_shell()\r\ncommand_id = p.run_command(shell_id, 'ipconfig', ['/all'])\r\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\r\np.cleanup_command(shell_id, command_id)\r\np.close_shell(shell_id)`\r\n\r\nChecking my winrm config (winrm get win/config) I find that: \r\n[items omitted by me!]\r\nService \r\n\r\nAuth \r\n     Kerb  = True\r\n     Negotiate = True\r\nDefaultPorts\r\n     HTTPS = 5986\r\nAllowRemoteAccess =True\r\n\r\nAllowRemoteShellAccess = True\r\n\r\nAny ideas?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/243", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/243/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/243/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/243/events", "html_url": "https://github.com/diyan/pywinrm/issues/243", "id": 379437207, "node_id": "MDU6SXNzdWUzNzk0MzcyMDc=", "number": 243, "title": "Alternatives to pywinrm?", "user": {"login": "jxn", "id": 683881, "node_id": "MDQ6VXNlcjY4Mzg4MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/683881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jxn", "html_url": "https://github.com/jxn", "followers_url": "https://api.github.com/users/jxn/followers", "following_url": "https://api.github.com/users/jxn/following{/other_user}", "gists_url": "https://api.github.com/users/jxn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jxn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jxn/subscriptions", "organizations_url": "https://api.github.com/users/jxn/orgs", "repos_url": "https://api.github.com/users/jxn/repos", "events_url": "https://api.github.com/users/jxn/events{/privacy}", "received_events_url": "https://api.github.com/users/jxn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-11-10T16:37:27Z", "updated_at": "2019-06-11T01:30:06Z", "closed_at": "2019-06-11T01:30:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've just started a project that depends on pywinrm, and it's work well, other than the encoding issues I've run into issues described in many of the open issues and merge requests (e.g. #222 ).\r\n\r\nIt seems like the PR's and development is stagnating.  Is there a fork or a similar project which is more active that I should depend on instead?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/240", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/240/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/240/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/240/events", "html_url": "https://github.com/diyan/pywinrm/issues/240", "id": 375117328, "node_id": "MDU6SXNzdWUzNzUxMTczMjg=", "number": 240, "title": "OperationTimeout is set incorrectly", "user": {"login": "sovetov", "id": 4168238, "node_id": "MDQ6VXNlcjQxNjgyMzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/4168238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sovetov", "html_url": "https://github.com/sovetov", "followers_url": "https://api.github.com/users/sovetov/followers", "following_url": "https://api.github.com/users/sovetov/following{/other_user}", "gists_url": "https://api.github.com/users/sovetov/gists{/gist_id}", "starred_url": "https://api.github.com/users/sovetov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sovetov/subscriptions", "organizations_url": "https://api.github.com/users/sovetov/orgs", "repos_url": "https://api.github.com/users/sovetov/repos", "events_url": "https://api.github.com/users/sovetov/events{/privacy}", "received_events_url": "https://api.github.com/users/sovetov/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-10-29T16:57:09Z", "updated_at": "2018-11-06T13:07:49Z", "closed_at": "2018-11-06T13:07:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/diyan/pywinrm/blob/ffec9542d2063305efab9242ffb3623ed618756f/winrm/protocol.py#L210\r\n\r\nThis looks like ISO duration. If I set timeout to 120 sec, it's sent as `PT120S` and interpreted as 1 minute 20 seconds.\r\n\r\nWhen I had a problem with hanging service, responses came after exactly 80 sec while `PT120S` was sent in XML.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/238", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/238/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/238/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/238/events", "html_url": "https://github.com/diyan/pywinrm/issues/238", "id": 373827398, "node_id": "MDU6SXNzdWUzNzM4MjczOTg=", "number": 238, "title": "exchange managenment shell", "user": {"login": "SamGenTLEManKaka", "id": 24671601, "node_id": "MDQ6VXNlcjI0NjcxNjAx", "avatar_url": "https://avatars3.githubusercontent.com/u/24671601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SamGenTLEManKaka", "html_url": "https://github.com/SamGenTLEManKaka", "followers_url": "https://api.github.com/users/SamGenTLEManKaka/followers", "following_url": "https://api.github.com/users/SamGenTLEManKaka/following{/other_user}", "gists_url": "https://api.github.com/users/SamGenTLEManKaka/gists{/gist_id}", "starred_url": "https://api.github.com/users/SamGenTLEManKaka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SamGenTLEManKaka/subscriptions", "organizations_url": "https://api.github.com/users/SamGenTLEManKaka/orgs", "repos_url": "https://api.github.com/users/SamGenTLEManKaka/repos", "events_url": "https://api.github.com/users/SamGenTLEManKaka/events{/privacy}", "received_events_url": "https://api.github.com/users/SamGenTLEManKaka/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-25T08:21:22Z", "updated_at": "2019-06-24T19:56:16Z", "closed_at": "2019-06-24T19:56:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "winrm \r\nCan be executed remotely **exchange managenment shell**?\r\nhere is C# code\r\n![image](https://user-images.githubusercontent.com/24671601/47486018-fbab1f00-d871-11e8-8a93-bd8dd0c74851.png)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/237", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/237/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/237/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/237/events", "html_url": "https://github.com/diyan/pywinrm/issues/237", "id": 373529146, "node_id": "MDU6SXNzdWUzNzM1MjkxNDY=", "number": 237, "title": "Python3 'post data should be bytes' issue", "user": {"login": "briantownjr", "id": 6304074, "node_id": "MDQ6VXNlcjYzMDQwNzQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6304074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/briantownjr", "html_url": "https://github.com/briantownjr", "followers_url": "https://api.github.com/users/briantownjr/followers", "following_url": "https://api.github.com/users/briantownjr/following{/other_user}", "gists_url": "https://api.github.com/users/briantownjr/gists{/gist_id}", "starred_url": "https://api.github.com/users/briantownjr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/briantownjr/subscriptions", "organizations_url": "https://api.github.com/users/briantownjr/orgs", "repos_url": "https://api.github.com/users/briantownjr/repos", "events_url": "https://api.github.com/users/briantownjr/events{/privacy}", "received_events_url": "https://api.github.com/users/briantownjr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-24T15:00:35Z", "updated_at": "2019-05-21T01:44:53Z", "closed_at": "2019-05-21T01:44:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "getting following when I run the basic example given on git page:\r\n\r\n#!/usr/bin/env python\r\n import winrm\r\n  s = winrm.Session('box63.test.com', auth=('vkumar@TEST.COM', 'IamUsingKerbTicket'), transport='kerberos')\r\n  r = s.run_cmd('ipconfig', ['/all'])\r\n  print r.status_code\r\n  print r.std_out\r\n  print r.std_err\r\n\r\nTypeError: POST data should be bytes or an iterable of bytes. It cannot be of type str\r\n\r\nIf I use python2.7 it works fine. Is this not updated to Python3?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/228", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/228/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/228/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/228/events", "html_url": "https://github.com/diyan/pywinrm/issues/228", "id": 356718014, "node_id": "MDU6SXNzdWUzNTY3MTgwMTQ=", "number": 228, "title": "Use of Kerberos auth", "user": {"login": "fwalrus", "id": 42962310, "node_id": "MDQ6VXNlcjQyOTYyMzEw", "avatar_url": "https://avatars3.githubusercontent.com/u/42962310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fwalrus", "html_url": "https://github.com/fwalrus", "followers_url": "https://api.github.com/users/fwalrus/followers", "following_url": "https://api.github.com/users/fwalrus/following{/other_user}", "gists_url": "https://api.github.com/users/fwalrus/gists{/gist_id}", "starred_url": "https://api.github.com/users/fwalrus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fwalrus/subscriptions", "organizations_url": "https://api.github.com/users/fwalrus/orgs", "repos_url": "https://api.github.com/users/fwalrus/repos", "events_url": "https://api.github.com/users/fwalrus/events{/privacy}", "received_events_url": "https://api.github.com/users/fwalrus/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-04T09:06:55Z", "updated_at": "2018-09-12T12:59:59Z", "closed_at": "2018-09-12T12:59:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "From the doc I can see this :\r\n\r\n>Will use Kerberos authentication for domain accounts which only works when the client is in the same domain as the server and the required dependencies are installed. **Currently a Kerberos ticket needs to be initialized outside of pywinrm using the kinit command.**\r\n\r\nIs there any plan to interface this more with Kerb ? I'm trying to build a solution using this code (thanks a lot for it) that maintains a refreshed keytab inside Python (or outside if there is no choice). I feel like there is very little support for Kerberos or at least I'm not sure it does what I expect.\r\n\r\nAny ideas ?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/227", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/227/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/227/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/227/events", "html_url": "https://github.com/diyan/pywinrm/issues/227", "id": 346367997, "node_id": "MDU6SXNzdWUzNDYzNjc5OTc=", "number": 227, "title": "Using the example code to connect to Office 365 not working", "user": {"login": "yoonlees", "id": 9824467, "node_id": "MDQ6VXNlcjk4MjQ0Njc=", "avatar_url": "https://avatars0.githubusercontent.com/u/9824467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yoonlees", "html_url": "https://github.com/yoonlees", "followers_url": "https://api.github.com/users/yoonlees/followers", "following_url": "https://api.github.com/users/yoonlees/following{/other_user}", "gists_url": "https://api.github.com/users/yoonlees/gists{/gist_id}", "starred_url": "https://api.github.com/users/yoonlees/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yoonlees/subscriptions", "organizations_url": "https://api.github.com/users/yoonlees/orgs", "repos_url": "https://api.github.com/users/yoonlees/repos", "events_url": "https://api.github.com/users/yoonlees/events{/privacy}", "received_events_url": "https://api.github.com/users/yoonlees/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-07-31T21:38:18Z", "updated_at": "2018-12-16T22:41:24Z", "closed_at": "2018-08-01T19:28:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is a rather a question than issue but I tried to connect to Office 365 using pywinrm but it is not working. I pasted the error message at the below but is it possible to use pywinrm to connect to Office 365 at all?\r\n\r\nraise WinRMError('{0} (extended fault data: {1})'.format(error_message, fault_data))\r\nwinrm.exceptions.WinRMError: The WS-Management service cannot process the request. The resource URI is missing or it has an incorrect format. Check the documentation or use the following command for information on how to construct a resource URI: \"winrm help uris\".  (extended fault data: {u'fault_subcode': 'a:DestinationUnreachable', u'fault_code': 's:Sender', u'wsmanfault_code': '2150858811', 'transport_message': u'Bad HTTP response returned from server. Code 500', 'http_status_code': 500})", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/226", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/226/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/226/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/226/events", "html_url": "https://github.com/diyan/pywinrm/issues/226", "id": 346366806, "node_id": "MDU6SXNzdWUzNDYzNjY4MDY=", "number": 226, "title": "Function <unbound method HTTPKerberosAuth.__init__> does not contain optional arg send_cbt", "user": {"login": "Sneedes", "id": 41973032, "node_id": "MDQ6VXNlcjQxOTczMDMy", "avatar_url": "https://avatars1.githubusercontent.com/u/41973032?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Sneedes", "html_url": "https://github.com/Sneedes", "followers_url": "https://api.github.com/users/Sneedes/followers", "following_url": "https://api.github.com/users/Sneedes/following{/other_user}", "gists_url": "https://api.github.com/users/Sneedes/gists{/gist_id}", "starred_url": "https://api.github.com/users/Sneedes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Sneedes/subscriptions", "organizations_url": "https://api.github.com/users/Sneedes/orgs", "repos_url": "https://api.github.com/users/Sneedes/repos", "events_url": "https://api.github.com/users/Sneedes/events{/privacy}", "received_events_url": "https://api.github.com/users/Sneedes/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-07-31T21:34:07Z", "updated_at": "2018-08-01T18:27:09Z", "closed_at": "2018-08-01T18:27:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Receive the following message on every Ansible task.    Unsure what the \"optional arg send_cbt\" warning is all about.\r\n\r\n```\r\n/usr/lib/python2.7/site-packages/winrm/transport.py:299: UserWarning: Function <unbound method HTTPKerberosAuth.__init__> does not contain optional arg send_cbt, check installed version with pip list\r\n  % (str(function), name))\r\n\r\n```\r\n```\r\nansible --version\r\nansible 2.4.3.0\r\n  config file = /home/XXXXX/xxxxx/.ansible.cfg\r\n  configured module search path = [u'/home/XXXXX/xxxxx/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Feb 20 2018, 09:19:12) [GCC 4.8.5 20150623 (Red Hat 4.8.5-28)]\r\n```\r\n\r\n```\r\nansible_connection: winrm\r\nansible_port: 5986\r\nansible_winrm_transport: kerberos\r\nansible_winrm_kerberos_delegation: true\r\nansible_user: xxx@XXXXX.COM\r\nansible_password: \"xxxxxxxxxxx\"\r\nansible_winrm_server_cert_validation: validate\r\nansible_winrm_ca_trust_path: '/home/XXXXX/xxxxx/xxxxxCAs.pem'\r\n```\r\n\r\n\r\n```\r\npip show pywinrm\r\nName: pywinrm\r\nVersion: 0.3.0\r\nSummary: Python library for Windows Remote Management\r\nHome-page: http://github.com/diyan/pywinrm/\r\nAuthor: Alexey Diyan\r\nAuthor-email: alexey.diyan@gmail.com\r\nLicense: MIT license\r\nLocation: /usr/lib/python2.7/site-packages\r\nRequires: xmltodict, requests, requests-ntlm, six\r\nRequired-by:\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/225", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/225/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/225/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/225/events", "html_url": "https://github.com/diyan/pywinrm/issues/225", "id": 338966610, "node_id": "MDU6SXNzdWUzMzg5NjY2MTA=", "number": 225, "title": "Access is denied when trying to open remote drive files via pywinrm", "user": {"login": "amosbird", "id": 5085485, "node_id": "MDQ6VXNlcjUwODU0ODU=", "avatar_url": "https://avatars3.githubusercontent.com/u/5085485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amosbird", "html_url": "https://github.com/amosbird", "followers_url": "https://api.github.com/users/amosbird/followers", "following_url": "https://api.github.com/users/amosbird/following{/other_user}", "gists_url": "https://api.github.com/users/amosbird/gists{/gist_id}", "starred_url": "https://api.github.com/users/amosbird/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amosbird/subscriptions", "organizations_url": "https://api.github.com/users/amosbird/orgs", "repos_url": "https://api.github.com/users/amosbird/repos", "events_url": "https://api.github.com/users/amosbird/events{/privacy}", "received_events_url": "https://api.github.com/users/amosbird/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-07-06T14:46:29Z", "updated_at": "2019-06-24T20:24:34Z", "closed_at": "2019-06-24T20:24:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I'm building a remote launching script like this\r\n```\r\n#!/usr/bin/env python\r\n\r\nfrom winrm.protocol import Protocol\r\nimport sys\r\n\r\np = Protocol(\r\n    endpoint='https://172.26.172.81:5986/wsman',\r\n    transport='basic',\r\n    username=r'amos',\r\n    password='bird',\r\n    server_cert_validation='ignore')\r\nshell_id = p.open_shell()\r\ncommand_id = p.run_command(shell_id, 'cmd /c', [sys.argv[1]])\r\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\r\nprint(std_out)\r\nprint(std_err)\r\nprint(status_code)\r\np.cleanup_command(shell_id, command_id)\r\n```\r\n\r\nHowever it always returns `Access is denied` when trying to open files residing on a remote mounted drive. (a drive mounted by freerdp). \r\n\r\nEnv:\r\n\r\nhost: archlinux\r\nremote: Windows 10\r\npywinrm: branch master\r\n\r\nIs there a way to fix this permission issue?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/221", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/221/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/221/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/221/events", "html_url": "https://github.com/diyan/pywinrm/issues/221", "id": 324942346, "node_id": "MDU6SXNzdWUzMjQ5NDIzNDY=", "number": 221, "title": "CreddSSP Patch CVE-2018-0886", "user": {"login": "muralikanagala", "id": 32024686, "node_id": "MDQ6VXNlcjMyMDI0Njg2", "avatar_url": "https://avatars2.githubusercontent.com/u/32024686?v=4", "gravatar_id": "", "url": "https://api.github.com/users/muralikanagala", "html_url": "https://github.com/muralikanagala", "followers_url": "https://api.github.com/users/muralikanagala/followers", "following_url": "https://api.github.com/users/muralikanagala/following{/other_user}", "gists_url": "https://api.github.com/users/muralikanagala/gists{/gist_id}", "starred_url": "https://api.github.com/users/muralikanagala/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/muralikanagala/subscriptions", "organizations_url": "https://api.github.com/users/muralikanagala/orgs", "repos_url": "https://api.github.com/users/muralikanagala/repos", "events_url": "https://api.github.com/users/muralikanagala/events{/privacy}", "received_events_url": "https://api.github.com/users/muralikanagala/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-21T14:43:23Z", "updated_at": "2019-06-24T19:56:00Z", "closed_at": "2019-06-24T19:56:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello Everyone,\r\n\r\nI have tried using pywinrm to run some remote commands but the CredSSP is not working.\r\nBelow patches are applied on all of our severs and forced the clients (RDP) to update.\r\n\r\nIs Pywinrm affected by this patch? If yes are there any changes made/planned for it?\r\n\r\nhttps://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-0886\r\nhttps://support.microsoft.com/en-us/help/4093492/credssp-updates-for-cve-2018-0886-march-13-2018\r\nhttps://www.securityweek.com/microsoft-patches-remote-code-execution-flaw-credssp\r\n\r\nThanks,\r\nMurali Kanagala", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/219", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/219/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/219/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/219/events", "html_url": "https://github.com/diyan/pywinrm/issues/219", "id": 322534460, "node_id": "MDU6SXNzdWUzMjI1MzQ0NjA=", "number": 219, "title": "Avoid Dependency on distutils", "user": {"login": "hlieberman", "id": 711517, "node_id": "MDQ6VXNlcjcxMTUxNw==", "avatar_url": "https://avatars1.githubusercontent.com/u/711517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hlieberman", "html_url": "https://github.com/hlieberman", "followers_url": "https://api.github.com/users/hlieberman/followers", "following_url": "https://api.github.com/users/hlieberman/following{/other_user}", "gists_url": "https://api.github.com/users/hlieberman/gists{/gist_id}", "starred_url": "https://api.github.com/users/hlieberman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hlieberman/subscriptions", "organizations_url": "https://api.github.com/users/hlieberman/orgs", "repos_url": "https://api.github.com/users/hlieberman/repos", "events_url": "https://api.github.com/users/hlieberman/events{/privacy}", "received_events_url": "https://api.github.com/users/hlieberman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-12T18:54:00Z", "updated_at": "2019-06-24T19:55:52Z", "closed_at": "2019-06-24T19:55:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nForwarding a patch applied to the Debian downstream that avoids the extra dependency on python-distutils.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/217", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/217/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/217/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/217/events", "html_url": "https://github.com/diyan/pywinrm/issues/217", "id": 318262973, "node_id": "MDU6SXNzdWUzMTgyNjI5NzM=", "number": 217, "title": "CredSSP updates for CVE-2018-0886", "user": {"login": "ykrmy", "id": 26535431, "node_id": "MDQ6VXNlcjI2NTM1NDMx", "avatar_url": "https://avatars0.githubusercontent.com/u/26535431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ykrmy", "html_url": "https://github.com/ykrmy", "followers_url": "https://api.github.com/users/ykrmy/followers", "following_url": "https://api.github.com/users/ykrmy/following{/other_user}", "gists_url": "https://api.github.com/users/ykrmy/gists{/gist_id}", "starred_url": "https://api.github.com/users/ykrmy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ykrmy/subscriptions", "organizations_url": "https://api.github.com/users/ykrmy/orgs", "repos_url": "https://api.github.com/users/ykrmy/repos", "events_url": "https://api.github.com/users/ykrmy/events{/privacy}", "received_events_url": "https://api.github.com/users/ykrmy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-27T03:07:44Z", "updated_at": "2018-04-27T05:14:41Z", "closed_at": "2018-04-27T05:14:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Microsoft will release updates about CredSSP in May 8, 2018.\r\nhttps://support.microsoft.com/en-us/help/4093492/credssp-updates-for-cve-2018-0886-march-13-2018\r\n\r\nIs pywinrm affected by this update?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/216", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/216/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/216/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/216/events", "html_url": "https://github.com/diyan/pywinrm/issues/216", "id": 316243506, "node_id": "MDU6SXNzdWUzMTYyNDM1MDY=", "number": 216, "title": "Line break every 80 chars in output?", "user": {"login": "adpham95", "id": 32873177, "node_id": "MDQ6VXNlcjMyODczMTc3", "avatar_url": "https://avatars3.githubusercontent.com/u/32873177?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adpham95", "html_url": "https://github.com/adpham95", "followers_url": "https://api.github.com/users/adpham95/followers", "following_url": "https://api.github.com/users/adpham95/following{/other_user}", "gists_url": "https://api.github.com/users/adpham95/gists{/gist_id}", "starred_url": "https://api.github.com/users/adpham95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adpham95/subscriptions", "organizations_url": "https://api.github.com/users/adpham95/orgs", "repos_url": "https://api.github.com/users/adpham95/repos", "events_url": "https://api.github.com/users/adpham95/events{/privacy}", "received_events_url": "https://api.github.com/users/adpham95/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-04-20T12:13:13Z", "updated_at": "2019-06-24T20:24:58Z", "closed_at": "2019-06-24T20:24:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running against PowerShell v2, we're seeing a line break appear every 80 chars in the returned std_out and std_err. For example, echoing a string of 90 chars will cause it to contain a \\r\\n inserted after 80 chars in the string.\r\n\r\nWe also seem to be unable to increase the buffer size by running:\r\n\r\n    $Host.UI.RawUI.BufferSize = New-Object Management.Automation.Host.Size (500, 30)\r\n\r\nSince, correct me if I'm wrong, changes don't seem to persist between commands in a session since the shell is closed after each command.\r\n\r\nAny suggestions to avoid this? We would like to support PSv2 if possible, so upgrading would be a last resort (not my choice, sadly).", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/215", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/215/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/215/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/215/events", "html_url": "https://github.com/diyan/pywinrm/issues/215", "id": 314149432, "node_id": "MDU6SXNzdWUzMTQxNDk0MzI=", "number": 215, "title": "Basic Auth with AD Creds", "user": {"login": "oldskoolsig", "id": 7605863, "node_id": "MDQ6VXNlcjc2MDU4NjM=", "avatar_url": "https://avatars1.githubusercontent.com/u/7605863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oldskoolsig", "html_url": "https://github.com/oldskoolsig", "followers_url": "https://api.github.com/users/oldskoolsig/followers", "following_url": "https://api.github.com/users/oldskoolsig/following{/other_user}", "gists_url": "https://api.github.com/users/oldskoolsig/gists{/gist_id}", "starred_url": "https://api.github.com/users/oldskoolsig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oldskoolsig/subscriptions", "organizations_url": "https://api.github.com/users/oldskoolsig/orgs", "repos_url": "https://api.github.com/users/oldskoolsig/repos", "events_url": "https://api.github.com/users/oldskoolsig/events{/privacy}", "received_events_url": "https://api.github.com/users/oldskoolsig/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-13T15:20:26Z", "updated_at": "2018-04-13T15:21:45Z", "closed_at": "2018-04-13T15:21:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nNot sure if this is the right place, but wanted to put the question out there.\r\n\r\nI'm trying to use basic auth to log into a Windows 2012 Server Host using Ansible.\r\nIf I use a local account, that is in the Administrators group, auth succeeds\r\nIf I use an AD account, authentication fails with credentials rejected by server.\r\nI tried using DOMAIN\\username to authenticate, but still am getting rejected by server.\r\n\r\nI guess my question is ... if I'm using basic auth does that imply that the account has to be local?\r\n\r\nThanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/212", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/212/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/212/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/212/events", "html_url": "https://github.com/diyan/pywinrm/issues/212", "id": 306248537, "node_id": "MDU6SXNzdWUzMDYyNDg1Mzc=", "number": 212, "title": "Why not use \"WSMAN\" as Kerberos Service?", "user": {"login": "mklemm2", "id": 17253314, "node_id": "MDQ6VXNlcjE3MjUzMzE0", "avatar_url": "https://avatars1.githubusercontent.com/u/17253314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mklemm2", "html_url": "https://github.com/mklemm2", "followers_url": "https://api.github.com/users/mklemm2/followers", "following_url": "https://api.github.com/users/mklemm2/following{/other_user}", "gists_url": "https://api.github.com/users/mklemm2/gists{/gist_id}", "starred_url": "https://api.github.com/users/mklemm2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mklemm2/subscriptions", "organizations_url": "https://api.github.com/users/mklemm2/orgs", "repos_url": "https://api.github.com/users/mklemm2/repos", "events_url": "https://api.github.com/users/mklemm2/events{/privacy}", "received_events_url": "https://api.github.com/users/mklemm2/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-03-18T15:12:02Z", "updated_at": "2019-06-24T20:25:56Z", "closed_at": "2019-06-24T20:25:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is there a reason why pywinrm, by default, uses \"HTTP\" as service? Correct me if I'm wrong but I think the correct service name should be \"WSMAN\". At least on all my test machines I found the SPNs WSMAN/<fqdn_of_server> and WSMAN/<shortname_of_server> pre-registered in AD.\r\n\r\nUsing \"WSMAN\" should prevent any potential conflict with IIS, shouldn't it?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/211", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/211/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/211/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/211/events", "html_url": "https://github.com/diyan/pywinrm/issues/211", "id": 304258269, "node_id": "MDU6SXNzdWUzMDQyNTgyNjk=", "number": 211, "title": "Instructions to use Kerberos in Windows? ", "user": {"login": "II-VSB-II", "id": 18592412, "node_id": "MDQ6VXNlcjE4NTkyNDEy", "avatar_url": "https://avatars2.githubusercontent.com/u/18592412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/II-VSB-II", "html_url": "https://github.com/II-VSB-II", "followers_url": "https://api.github.com/users/II-VSB-II/followers", "following_url": "https://api.github.com/users/II-VSB-II/following{/other_user}", "gists_url": "https://api.github.com/users/II-VSB-II/gists{/gist_id}", "starred_url": "https://api.github.com/users/II-VSB-II/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/II-VSB-II/subscriptions", "organizations_url": "https://api.github.com/users/II-VSB-II/orgs", "repos_url": "https://api.github.com/users/II-VSB-II/repos", "events_url": "https://api.github.com/users/II-VSB-II/events{/privacy}", "received_events_url": "https://api.github.com/users/II-VSB-II/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-12T06:52:38Z", "updated_at": "2019-06-24T19:55:26Z", "closed_at": "2019-06-24T19:55:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi All, anyone know how to config kerberos in windows and use pywinrm module to execute commands on endpoint.?\r\nPlease Let Me Know.\r\n\r\nthanks in Advance.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/210", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/210/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/210/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/210/events", "html_url": "https://github.com/diyan/pywinrm/issues/210", "id": 302686937, "node_id": "MDU6SXNzdWUzMDI2ODY5Mzc=", "number": 210, "title": "Not a Issue. But I want Some Information.", "user": {"login": "II-VSB-II", "id": 18592412, "node_id": "MDQ6VXNlcjE4NTkyNDEy", "avatar_url": "https://avatars2.githubusercontent.com/u/18592412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/II-VSB-II", "html_url": "https://github.com/II-VSB-II", "followers_url": "https://api.github.com/users/II-VSB-II/followers", "following_url": "https://api.github.com/users/II-VSB-II/following{/other_user}", "gists_url": "https://api.github.com/users/II-VSB-II/gists{/gist_id}", "starred_url": "https://api.github.com/users/II-VSB-II/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/II-VSB-II/subscriptions", "organizations_url": "https://api.github.com/users/II-VSB-II/orgs", "repos_url": "https://api.github.com/users/II-VSB-II/repos", "events_url": "https://api.github.com/users/II-VSB-II/events{/privacy}", "received_events_url": "https://api.github.com/users/II-VSB-II/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-06T12:46:08Z", "updated_at": "2019-06-24T20:27:06Z", "closed_at": "2019-06-24T20:27:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "**I have a keytab file. \r\nHow to use pywinrm module to execute commands on Domain account with kerberos authentication.?** ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/208", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/208/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/208/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/208/events", "html_url": "https://github.com/diyan/pywinrm/issues/208", "id": 298921619, "node_id": "MDU6SXNzdWUyOTg5MjE2MTk=", "number": 208, "title": "winrm.exceptions.WinRMTransportError: (u'http', u'Bad HTTP response returned from server. Code 500')", "user": {"login": "bhanukumar22", "id": 17473678, "node_id": "MDQ6VXNlcjE3NDczNjc4", "avatar_url": "https://avatars3.githubusercontent.com/u/17473678?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bhanukumar22", "html_url": "https://github.com/bhanukumar22", "followers_url": "https://api.github.com/users/bhanukumar22/followers", "following_url": "https://api.github.com/users/bhanukumar22/following{/other_user}", "gists_url": "https://api.github.com/users/bhanukumar22/gists{/gist_id}", "starred_url": "https://api.github.com/users/bhanukumar22/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bhanukumar22/subscriptions", "organizations_url": "https://api.github.com/users/bhanukumar22/orgs", "repos_url": "https://api.github.com/users/bhanukumar22/repos", "events_url": "https://api.github.com/users/bhanukumar22/events{/privacy}", "received_events_url": "https://api.github.com/users/bhanukumar22/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-02-21T10:48:10Z", "updated_at": "2019-06-24T20:29:22Z", "closed_at": "2019-06-24T20:29:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi All,\r\n\r\nIm getting the below error when I tried do winrm from my linux host to Windows target.\r\n\r\nwinrm.exceptions.WinRMTransportError: (u'http', u'Bad HTTP response returned from server. Code 500')\r\n\r\nBut, if I set \"AllowUnEncrypted\" to \"true\", it is working fine. But, for security purpose, we want the message to be encrypted, when it is being passed.\r\n\r\nAlso, able to connect from windows to windows, even when AllowUnEncrypted is set to false. But I want this to work from linux box to windows box. \r\n\r\nBoth the servers (linux host and windows target) are in same network.\r\n\r\nHaving pywinrm 0.3.0 version on linux host.\r\n\r\nPlease find the below details of the windows server:\r\nService\r\n    RootSDDL = O:NSG:BAD:P(A;;GA;A;;;WD)(AU;SA;GXGW;;;WD)\r\n    MaxConcurrentOperations = 4294967295\r\n    MaxConcurrentOperationsPerUser = 1500\r\n    EnumerationTimeoutms = 240000\r\n    MaxConnections = 300\r\n    MaxPacketRetrievalTimeSeconds = 120\r\n    AllowUnencrypted = false\r\n    Auth\r\n        Basic = true\r\n        Kerberos = true\r\n        Negotiate = true\r\n        Certificate = false\r\n        CredSSP = false\r\n        CbtHardeningLevel = Relaxed\r\n    DefaultPorts\r\n        HTTP = 5985\r\n        HTTPS = 5986\r\n    IPv4Filter = *\r\n    IPv6Filter = *\r\n    EnableCompatibilityHttpListener = false\r\n    EnableCompatibilityHttpsListener = false\r\n    CertificateThumbprint\r\n    AllowRemoteAccess = true\r\n\r\nIn new release 0.3.0, this was supposed to get fixed, but we are still not able to connect from linux to windows. Could someone Please me with the issue.\r\n\r\nThanks in adnvace.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/206", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/206/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/206/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/206/events", "html_url": "https://github.com/diyan/pywinrm/issues/206", "id": 295774238, "node_id": "MDU6SXNzdWUyOTU3NzQyMzg=", "number": 206, "title": "Can'nt run CMDlets for ActiveDirectory on Server 2012r2", "user": {"login": "jtuttas", "id": 3327742, "node_id": "MDQ6VXNlcjMzMjc3NDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/3327742?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jtuttas", "html_url": "https://github.com/jtuttas", "followers_url": "https://api.github.com/users/jtuttas/followers", "following_url": "https://api.github.com/users/jtuttas/following{/other_user}", "gists_url": "https://api.github.com/users/jtuttas/gists{/gist_id}", "starred_url": "https://api.github.com/users/jtuttas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jtuttas/subscriptions", "organizations_url": "https://api.github.com/users/jtuttas/orgs", "repos_url": "https://api.github.com/users/jtuttas/repos", "events_url": "https://api.github.com/users/jtuttas/events{/privacy}", "received_events_url": "https://api.github.com/users/jtuttas/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-02-09T07:06:39Z", "updated_at": "2019-05-21T01:50:28Z", "closed_at": "2019-05-21T01:50:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, \r\nwell pywinrm works fine with every standard CMDlet (e.g. Get-Command, Get-Help, Get-Childitem etc.). But when I execute a CMDlet for the ActiveDirectory (e.g. Get-AdGroup etc.) I got the following error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"powershell.py\", line 4, in <module>\r\n    result = session.run_ps(\"Get-ADGroup -Filter *\")\r\n  File \"/usr/local/lib/python3.5/dist-packages/winrm/__init__.py\", line 54, in run_ps\r\n    rs.std_err = self._clean_error_msg(rs.std_err)\r\n  File \"/usr/local/lib/python3.5/dist-packages/winrm/__init__.py\", line 62, in _clean_error_msg\r\n    if msg.startswith(\"#< CLIXML\\r\\n\"):\r\nTypeError: startswith first arg must be bytes or a tuple of bytes, not str\r\n```\r\n\r\nHere is my python code:\r\n```python\r\nimport winrm\r\nsession = winrm.Session('192.168.178.123', auth=('admin','admin'))\r\nresult = session.run_ps(\"Get-ADGroup -Filter *\")\r\nout=result.std_out.decode(\"utf-8\")\r\nprint(\"Result=\"+out);\r\n```\r\n\r\nOn a PS Remote Session to server everything works like expected.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/205", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/205/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/205/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/205/events", "html_url": "https://github.com/diyan/pywinrm/issues/205", "id": 295157580, "node_id": "MDU6SXNzdWUyOTUxNTc1ODA=", "number": 205, "title": "What Encryption Type", "user": {"login": "rmauc", "id": 18124843, "node_id": "MDQ6VXNlcjE4MTI0ODQz", "avatar_url": "https://avatars1.githubusercontent.com/u/18124843?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmauc", "html_url": "https://github.com/rmauc", "followers_url": "https://api.github.com/users/rmauc/followers", "following_url": "https://api.github.com/users/rmauc/following{/other_user}", "gists_url": "https://api.github.com/users/rmauc/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmauc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmauc/subscriptions", "organizations_url": "https://api.github.com/users/rmauc/orgs", "repos_url": "https://api.github.com/users/rmauc/repos", "events_url": "https://api.github.com/users/rmauc/events{/privacy}", "received_events_url": "https://api.github.com/users/rmauc/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-02-07T14:28:36Z", "updated_at": "2019-06-24T19:55:19Z", "closed_at": "2019-06-24T19:55:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nOn our Ansible server we have installed the following:\r\npywinrm 0.3.0b1\r\npykerberos 1.2.1b1\r\nrequests-kerberos 0.12.0b1\r\nntlm-auth 1.0.6\r\nrequests-ntlm 1.1.0\r\nrequests-credssp 0.1.0\r\n\r\nare connecting to Windows targets using the following: \r\n\r\nansible_port: 5985\r\nansible_connection: winrm\r\nansible_winrm_transport: kerberos\r\nansible_user: user@XXX.com\r\n\r\nLooking at the packets leaving the Ansible Control server - these appear to be encrypted.. but can you tell me what type of encryption pywinrm uses?\r\n\r\nThanks a lot\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/204", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/204/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/204/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/204/events", "html_url": "https://github.com/diyan/pywinrm/issues/204", "id": 290095429, "node_id": "MDU6SXNzdWUyOTAwOTU0Mjk=", "number": 204, "title": "RHEL/CentOS 6 Compatibility", "user": {"login": "brandongray", "id": 36018, "node_id": "MDQ6VXNlcjM2MDE4", "avatar_url": "https://avatars0.githubusercontent.com/u/36018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brandongray", "html_url": "https://github.com/brandongray", "followers_url": "https://api.github.com/users/brandongray/followers", "following_url": "https://api.github.com/users/brandongray/following{/other_user}", "gists_url": "https://api.github.com/users/brandongray/gists{/gist_id}", "starred_url": "https://api.github.com/users/brandongray/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brandongray/subscriptions", "organizations_url": "https://api.github.com/users/brandongray/orgs", "repos_url": "https://api.github.com/users/brandongray/repos", "events_url": "https://api.github.com/users/brandongray/events{/privacy}", "received_events_url": "https://api.github.com/users/brandongray/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-01-19T20:19:25Z", "updated_at": "2019-06-24T19:55:11Z", "closed_at": "2019-06-24T19:55:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "pip installed - pywinrm (0.3.0)\r\nOS - RHEL6\r\nPython version - 2.6.6 (default)\r\n\r\nLine 244 of protocol.py -\r\nfault = root.find('soapenv:Body/soapenv:Fault', xmlns)\r\n\r\nWe're getting a TypeError since Element.find only takes 2 args (including self).  Here is an example -\r\n>>> import xml.etree.ElementTree as ET\r\n>>> root = ET.fromstring(\"<foo>bar</foo>\")\r\n>>> xmlns = {\r\n...     'soapenv': 'http://www.w3.org/2003/05/soap-envelope',\r\n...     'soapaddr': 'http://schemas.xmlsoap.org/ws/2004/08/addressing',\r\n...     'wsmanfault': \"http://schemas.microsoft.com/wbem/wsman/1/wsmanfault\"\r\n... }\r\n>>> root.find('soapenv:Body/soapenv:Fault', xmlns)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nTypeError: find() takes exactly 2 arguments (3 given)\r\n>>>\r\n\r\nIt looks like this broken compatibility with PR #189 ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/201", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/201/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/201/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/201/events", "html_url": "https://github.com/diyan/pywinrm/issues/201", "id": 285572940, "node_id": "MDU6SXNzdWUyODU1NzI5NDA=", "number": 201, "title": "server_cert_validation 'ignore' no longer works in 0.3.0", "user": {"login": "kcd83", "id": 707312, "node_id": "MDQ6VXNlcjcwNzMxMg==", "avatar_url": "https://avatars3.githubusercontent.com/u/707312?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kcd83", "html_url": "https://github.com/kcd83", "followers_url": "https://api.github.com/users/kcd83/followers", "following_url": "https://api.github.com/users/kcd83/following{/other_user}", "gists_url": "https://api.github.com/users/kcd83/gists{/gist_id}", "starred_url": "https://api.github.com/users/kcd83/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kcd83/subscriptions", "organizations_url": "https://api.github.com/users/kcd83/orgs", "repos_url": "https://api.github.com/users/kcd83/repos", "events_url": "https://api.github.com/users/kcd83/events{/privacy}", "received_events_url": "https://api.github.com/users/kcd83/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 8636400, "node_id": "MDU6TGFiZWw4NjM2NDAw", "url": "https://api.github.com/repos/diyan/pywinrm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "nitzmahone", "id": 6775756, "node_id": "MDQ6VXNlcjY3NzU3NTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/6775756?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nitzmahone", "html_url": "https://github.com/nitzmahone", "followers_url": "https://api.github.com/users/nitzmahone/followers", "following_url": "https://api.github.com/users/nitzmahone/following{/other_user}", "gists_url": "https://api.github.com/users/nitzmahone/gists{/gist_id}", "starred_url": "https://api.github.com/users/nitzmahone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nitzmahone/subscriptions", "organizations_url": "https://api.github.com/users/nitzmahone/orgs", "repos_url": "https://api.github.com/users/nitzmahone/repos", "events_url": "https://api.github.com/users/nitzmahone/events{/privacy}", "received_events_url": "https://api.github.com/users/nitzmahone/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nitzmahone", "id": 6775756, "node_id": "MDQ6VXNlcjY3NzU3NTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/6775756?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nitzmahone", "html_url": "https://github.com/nitzmahone", "followers_url": "https://api.github.com/users/nitzmahone/followers", "following_url": "https://api.github.com/users/nitzmahone/following{/other_user}", "gists_url": "https://api.github.com/users/nitzmahone/gists{/gist_id}", "starred_url": "https://api.github.com/users/nitzmahone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nitzmahone/subscriptions", "organizations_url": "https://api.github.com/users/nitzmahone/orgs", "repos_url": "https://api.github.com/users/nitzmahone/repos", "events_url": "https://api.github.com/users/nitzmahone/events{/privacy}", "received_events_url": "https://api.github.com/users/nitzmahone/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2018-01-03T00:25:25Z", "updated_at": "2019-11-04T09:51:37Z", "closed_at": "2018-01-12T19:27:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following no longer works against a self-signed certificate, has `server_cert_validation` changed? \r\n\r\n```\r\nfrom winrm.protocol import Protocol\r\n\r\np = Protocol(\r\n    endpoint='https://somewindows:5986/wsman',\r\n    transport='ntlm',\r\n    username=r'\\Admin',\r\n    password='ThePassword1',\r\n    server_cert_validation='ignore')\r\nshell_id = p.open_shell()\r\ncommand_id = p.run_command(shell_id, 'ipconfig', ['/all'])\r\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\r\nprint std_out\r\np.cleanup_command(shell_id, command_id)\r\np.close_shell(shell_id)\r\n```\r\n\r\n> Traceback (most recent call last):\r\n>   File \"winrmtest.py\", line 9, in <module>\r\n>     shell_id = p.open_shell()\r\n>   File \"/usr/lib/python2.7/site-packages/winrm/protocol.py\", line 157, in open_shell\r\n>     res = self.send_message(xmltodict.unparse(req))\r\n>   File \"/usr/lib/python2.7/site-packages/winrm/protocol.py\", line 234, in send_message\r\n>     resp = self.transport.send_message(message)\r\n>   File \"/usr/lib/python2.7/site-packages/winrm/transport.py\", line 256, in send_message\r\n>     response = self._send_message_request(prepared_request, message)\r\n>   File \"/usr/lib/python2.7/site-packages/winrm/transport.py\", line 261, in _send_message_request\r\n>     response = self.session.send(prepared_request, timeout=self.read_timeout_sec)\r\n>   File \"/usr/lib/python2.7/site-packages/requests/sessions.py\", line 618, in send\r\n>     r = adapter.send(request, **kwargs)\r\n>   File \"/usr/lib/python2.7/site-packages/requests/adapters.py\", line 506, in send\r\n>     raise SSLError(e, request=request)\r\n> requests.exceptions.SSLError: HTTPSConnectionPool(host='123.45.67.89', port=5986): Max retries exceeded with url: /wsman (Caused by SSLError(SSLError(\"bad handshake: Error([('SSL routines', 'tls_process_server_certificate', 'certificate verify failed')],)\",),))\r\n\r\n\r\n\r\nWith:\r\n\r\n```\r\npip show pywinrm\r\n---\r\nMetadata-Version: 2.0\r\nName: pywinrm\r\nVersion: 0.3.0\r\nSummary: Python library for Windows Remote Management\r\nHome-page: http://github.com/diyan/pywinrm/\r\nAuthor: Alexey Diyan\r\nAuthor-email: alexey.diyan@gmail.com\r\nInstaller: pip\r\nLicense: MIT license\r\nLocation: /usr/lib/python2.7/site-packages\r\nRequires: six, requests-ntlm, requests, xmltodict\r\nClassifiers:\r\n  Development Status :: 4 - Beta\r\n  Environment :: Console\r\n  Intended Audience :: Developers\r\n  Intended Audience :: System Administrators\r\n  Natural Language :: English\r\n  License :: OSI Approved :: MIT License\r\n  Programming Language :: Python\r\n  Programming Language :: Python :: 2\r\n  Programming Language :: Python :: 2.6\r\n  Programming Language :: Python :: 2.7\r\n  Programming Language :: Python :: 3\r\n  Programming Language :: Python :: 3.3\r\n  Programming Language :: Python :: 3.4\r\n  Programming Language :: Python :: 3.5\r\n  Programming Language :: Python :: 3.6\r\n  Programming Language :: Python :: Implementation :: PyPy\r\n  Topic :: Software Development :: Libraries :: Python Modules\r\n  Topic :: System :: Clustering\r\n  Topic :: System :: Distributed Computing\r\n  Topic :: System :: Systems Administration\r\n```\r\n\r\nHowever this previous release does work\r\n\r\n```\r\npip show pywinrm\r\n---\r\nMetadata-Version: 2.0\r\nName: pywinrm\r\nVersion: 0.2.2\r\nSummary: Python library for Windows Remote Management\r\nHome-page: http://github.com/diyan/pywinrm/\r\nAuthor: Alexey Diyan\r\nAuthor-email: alexey.diyan@gmail.com\r\nInstaller: pip\r\nLicense: MIT license\r\nLocation: /usr/lib/python2.7/site-packages\r\nRequires: six, requests-ntlm, requests, xmltodict\r\nClassifiers:\r\n  Development Status :: 4 - Beta\r\n  Environment :: Console\r\n  Intended Audience :: Developers\r\n  Intended Audience :: System Administrators\r\n  Natural Language :: English\r\n  License :: OSI Approved :: MIT License\r\n  Programming Language :: Python\r\n  Programming Language :: Python :: 2\r\n  Programming Language :: Python :: 2.6\r\n  Programming Language :: Python :: 2.7\r\n  Programming Language :: Python :: 3\r\n  Programming Language :: Python :: 3.3\r\n  Programming Language :: Python :: 3.4\r\n  Programming Language :: Python :: 3.5\r\n  Programming Language :: Python :: 3.6\r\n  Programming Language :: Python :: Implementation :: PyPy\r\n  Topic :: Software Development :: Libraries :: Python Modules\r\n  Topic :: System :: Clustering\r\n  Topic :: System :: Distributed Computing\r\n  Topic :: System :: Systems Administration\r\n```\r\n\r\n\r\n  ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/200", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/200/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/200/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/200/events", "html_url": "https://github.com/diyan/pywinrm/issues/200", "id": 284371000, "node_id": "MDU6SXNzdWUyODQzNzEwMDA=", "number": 200, "title": "Not Found HTTP Error 404. The requested resource is not found", "user": {"login": "abedzaben28", "id": 26892251, "node_id": "MDQ6VXNlcjI2ODkyMjUx", "avatar_url": "https://avatars0.githubusercontent.com/u/26892251?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abedzaben28", "html_url": "https://github.com/abedzaben28", "followers_url": "https://api.github.com/users/abedzaben28/followers", "following_url": "https://api.github.com/users/abedzaben28/following{/other_user}", "gists_url": "https://api.github.com/users/abedzaben28/gists{/gist_id}", "starred_url": "https://api.github.com/users/abedzaben28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abedzaben28/subscriptions", "organizations_url": "https://api.github.com/users/abedzaben28/orgs", "repos_url": "https://api.github.com/users/abedzaben28/repos", "events_url": "https://api.github.com/users/abedzaben28/events{/privacy}", "received_events_url": "https://api.github.com/users/abedzaben28/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-12-24T16:14:22Z", "updated_at": "2019-06-24T20:31:02Z", "closed_at": "2019-06-24T20:31:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "hello,\r\n\r\nI'm building simple app that will request the remote host using the http protocl, need to know how to configure the remote machine to be able to handle requests from http through the winrm, \r\n\r\nfor now i was able to run commands and get results from my laptop to remote host from cmd, but i need also to be able to run through http request through browsers as well.\r\n\r\nThanks in advance ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/199", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/199/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/199/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/199/events", "html_url": "https://github.com/diyan/pywinrm/issues/199", "id": 283824089, "node_id": "MDU6SXNzdWUyODM4MjQwODk=", "number": 199, "title": "AttributeError: 'module' object has no attribute 'Session'", "user": {"login": "shakashaka", "id": 18391131, "node_id": "MDQ6VXNlcjE4MzkxMTMx", "avatar_url": "https://avatars2.githubusercontent.com/u/18391131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shakashaka", "html_url": "https://github.com/shakashaka", "followers_url": "https://api.github.com/users/shakashaka/followers", "following_url": "https://api.github.com/users/shakashaka/following{/other_user}", "gists_url": "https://api.github.com/users/shakashaka/gists{/gist_id}", "starred_url": "https://api.github.com/users/shakashaka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shakashaka/subscriptions", "organizations_url": "https://api.github.com/users/shakashaka/orgs", "repos_url": "https://api.github.com/users/shakashaka/repos", "events_url": "https://api.github.com/users/shakashaka/events{/privacy}", "received_events_url": "https://api.github.com/users/shakashaka/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-12-21T09:39:11Z", "updated_at": "2018-01-12T22:47:27Z", "closed_at": "2018-01-12T22:47:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nroot@shaka:/media/sf_ubuntu/Automate_latest/Auto1/AWS_auto# python RDP.py \r\nTraceback (most recent call last):\r\n  File \"RDP.py\", line 6, in <module>\r\n    s = winrm.Session('windows-host.example.com', auth=('john.smith', 'secret'))\r\nAttributeError: 'module' object has no attribute 'Session'\r\n\r\nI get this every time - and looking through the winrm package, i could not find the Session module", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/195", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/195/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/195/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/195/events", "html_url": "https://github.com/diyan/pywinrm/issues/195", "id": 282883694, "node_id": "MDU6SXNzdWUyODI4ODM2OTQ=", "number": 195, "title": "local variable 'e' referenced before assignment", "user": {"login": "botzill", "id": 4686040, "node_id": "MDQ6VXNlcjQ2ODYwNDA=", "avatar_url": "https://avatars3.githubusercontent.com/u/4686040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/botzill", "html_url": "https://github.com/botzill", "followers_url": "https://api.github.com/users/botzill/followers", "following_url": "https://api.github.com/users/botzill/following{/other_user}", "gists_url": "https://api.github.com/users/botzill/gists{/gist_id}", "starred_url": "https://api.github.com/users/botzill/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/botzill/subscriptions", "organizations_url": "https://api.github.com/users/botzill/orgs", "repos_url": "https://api.github.com/users/botzill/repos", "events_url": "https://api.github.com/users/botzill/events{/privacy}", "received_events_url": "https://api.github.com/users/botzill/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-12-18T13:45:57Z", "updated_at": "2017-12-19T06:23:53Z", "closed_at": "2017-12-19T02:21:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Have an issue when running ansible and `pywinrm==0.2.2`.\r\n\r\n```\r\nThe full traceback is:\r\nTraceback (most recent call last):\r\n  File \"/Users/geo/.virtualenvs/venvp3/lib/python3.6/site-packages/ansible/executor/task_executor.py\", line 130, in run\r\n    res = self._execute()\r\n  File \"/Users/geo/.virtualenvs/venvp3/lib/python3.6/site-packages/ansible/executor/task_executor.py\", line 528, in _execute\r\n    result = self._handler.run(task_vars=variables)\r\n  File \"/Users/geo/.virtualenvs/venvp3/lib/python3.6/site-packages/ansible/plugins/action/win_reboot.py\", line 134, in run\r\n    self.do_until_success_or_timeout(raise_if_port_open, shutdown_timeout, what_desc=\"winrm port down\")\r\n  File \"/Users/geo/.virtualenvs/venvp3/lib/python3.6/site-packages/ansible/plugins/action/win_reboot.py\", line 51, in do_until_success_or_timeout\r\n    raise TimedOutException(\"timed out waiting for %s: %s\" % (what_desc, e))\r\nUnboundLocalError: local variable 'e' referenced before assignment\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/194", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/194/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/194/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/194/events", "html_url": "https://github.com/diyan/pywinrm/issues/194", "id": 281539199, "node_id": "MDU6SXNzdWUyODE1MzkxOTk=", "number": 194, "title": "Not able to execute remote command using \"Invoke-command\"", "user": {"login": "vgandhi-fdu", "id": 17304068, "node_id": "MDQ6VXNlcjE3MzA0MDY4", "avatar_url": "https://avatars1.githubusercontent.com/u/17304068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vgandhi-fdu", "html_url": "https://github.com/vgandhi-fdu", "followers_url": "https://api.github.com/users/vgandhi-fdu/followers", "following_url": "https://api.github.com/users/vgandhi-fdu/following{/other_user}", "gists_url": "https://api.github.com/users/vgandhi-fdu/gists{/gist_id}", "starred_url": "https://api.github.com/users/vgandhi-fdu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vgandhi-fdu/subscriptions", "organizations_url": "https://api.github.com/users/vgandhi-fdu/orgs", "repos_url": "https://api.github.com/users/vgandhi-fdu/repos", "events_url": "https://api.github.com/users/vgandhi-fdu/events{/privacy}", "received_events_url": "https://api.github.com/users/vgandhi-fdu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-12-12T21:13:59Z", "updated_at": "2017-12-19T02:24:03Z", "closed_at": "2017-12-19T02:24:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI tried pywinrm and am able to execute a PowerShell located on a Windows server.  Our administrator would like me to execute \"Invoke-command \u2013computername my_remote_computer \u2013configurationname my_configuration_name \u2013scriptblock {get-aduser \u2013identity my_sameaccountname}\" from my python script and I can't seem to figure out a way to do this.  Is this supported?  I'll appreciate any help and guidance on this.  Thank you.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/190", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/190/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/190/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/190/events", "html_url": "https://github.com/diyan/pywinrm/issues/190", "id": 279388777, "node_id": "MDU6SXNzdWUyNzkzODg3Nzc=", "number": 190, "title": "Release Not Up To Date", "user": {"login": "swtch1", "id": 12050926, "node_id": "MDQ6VXNlcjEyMDUwOTI2", "avatar_url": "https://avatars1.githubusercontent.com/u/12050926?v=4", "gravatar_id": "", "url": "https://api.github.com/users/swtch1", "html_url": "https://github.com/swtch1", "followers_url": "https://api.github.com/users/swtch1/followers", "following_url": "https://api.github.com/users/swtch1/following{/other_user}", "gists_url": "https://api.github.com/users/swtch1/gists{/gist_id}", "starred_url": "https://api.github.com/users/swtch1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/swtch1/subscriptions", "organizations_url": "https://api.github.com/users/swtch1/orgs", "repos_url": "https://api.github.com/users/swtch1/repos", "events_url": "https://api.github.com/users/swtch1/events{/privacy}", "received_events_url": "https://api.github.com/users/swtch1/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-12-05T14:11:23Z", "updated_at": "2018-01-12T22:26:14Z", "closed_at": "2018-01-12T22:26:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "It appears there are a number of changes in the master branch that are not available in the latest release v0.2.2.  I'm getting v0.2.2 from pip and it would be really nice to get the latest there without having to build it from source.  As of now it's been 23 commits and almost a year since the release was updated.\r\n\r\nThanks for the project.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/188", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/188/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/188/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/188/events", "html_url": "https://github.com/diyan/pywinrm/issues/188", "id": 278457851, "node_id": "MDU6SXNzdWUyNzg0NTc4NTE=", "number": 188, "title": "InvalidCredentialsError(\u201cthe specified credentials were rejected by the server\u201d)", "user": {"login": "vincentk1405", "id": 24777091, "node_id": "MDQ6VXNlcjI0Nzc3MDkx", "avatar_url": "https://avatars0.githubusercontent.com/u/24777091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vincentk1405", "html_url": "https://github.com/vincentk1405", "followers_url": "https://api.github.com/users/vincentk1405/followers", "following_url": "https://api.github.com/users/vincentk1405/following{/other_user}", "gists_url": "https://api.github.com/users/vincentk1405/gists{/gist_id}", "starred_url": "https://api.github.com/users/vincentk1405/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vincentk1405/subscriptions", "organizations_url": "https://api.github.com/users/vincentk1405/orgs", "repos_url": "https://api.github.com/users/vincentk1405/repos", "events_url": "https://api.github.com/users/vincentk1405/events{/privacy}", "received_events_url": "https://api.github.com/users/vincentk1405/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-12-01T12:54:15Z", "updated_at": "2018-01-12T22:28:40Z", "closed_at": "2018-01-12T22:28:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am unable to get WinRM session in a python script.\r\n\r\nClient - 2012 R2\r\n\r\nClient is a Domain member. user01 is a non domain account and member of Local administrators group.\r\nI have tried setting winrm basic or kerberos to false.\r\nI even tried with local administrator account but still same error.\r\nBoth ntlm and ssl were not working.\r\n\r\nAfter setting LocalAccountTokenFilterPolicy registry to 1 this works:\r\n\r\n    p = Protocol(\r\n        endpoint='https://X.X.X.X:5986/wsman',\r\n        transport='ntlm',\r\n        username='user01',\r\n        password='admin@123',\r\n        server_cert_validation='ignore')\r\n    \r\n    p.open_shell()\r\n\r\n\r\nSSL is not working:\r\n\r\n    p = Protocol(\r\n        endpoint='https://X.X.X.X:5986/wsman',\r\n        transport='ssl',\r\n        username='user01',\r\n        password='admin@123',\r\n        server_cert_validation='ignore')\r\n    \r\n    p.open_shell()\r\n\r\nError:\r\n\r\n> InvalidCredentialsError(\"the specified credentials were rejected by the server\")\r\n> winrm.exceptions.InvalidCredentialsError: the specified credentials were rejected by the server\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/185", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/185/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/185/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/185/events", "html_url": "https://github.com/diyan/pywinrm/issues/185", "id": 274518583, "node_id": "MDU6SXNzdWUyNzQ1MTg1ODM=", "number": 185, "title": "Google Cloud InvalidCredentials error ", "user": {"login": "nkakouros", "id": 11805218, "node_id": "MDQ6VXNlcjExODA1MjE4", "avatar_url": "https://avatars2.githubusercontent.com/u/11805218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nkakouros", "html_url": "https://github.com/nkakouros", "followers_url": "https://api.github.com/users/nkakouros/followers", "following_url": "https://api.github.com/users/nkakouros/following{/other_user}", "gists_url": "https://api.github.com/users/nkakouros/gists{/gist_id}", "starred_url": "https://api.github.com/users/nkakouros/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nkakouros/subscriptions", "organizations_url": "https://api.github.com/users/nkakouros/orgs", "repos_url": "https://api.github.com/users/nkakouros/repos", "events_url": "https://api.github.com/users/nkakouros/events{/privacy}", "received_events_url": "https://api.github.com/users/nkakouros/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-11-16T13:38:31Z", "updated_at": "2017-11-17T13:36:46Z", "closed_at": "2017-11-17T13:36:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to connect to a fresh Windows 2008 R2 instance on Google Cloud. According to the [documentation](https://github.com/GoogleCloudPlatform/compute-image-windows#instance-setup), WinRM is configured to accept remote connections by default. While I can connect to WinRM with PowerShell, I cannot connect with pywinrm. The Google Cloud firewall is configured to allow connections on every port from my ip address. I have installed pywinrm with pip3.\r\n\r\n# How WinRM is configured on the instance\r\nWhen a new windows image boots for the first time after creation, there is [a script](https://github.com/GoogleCloudPlatform/compute-image-windows/blob/master/sysprep/instance_setup.ps1) set to automatically run. In this script, there is [the following function](https://github.com/GoogleCloudPlatform/compute-image-windows/blob/master/sysprep/instance_setup.ps1#L167) that enables WinRM:\r\n\r\n```ps1\r\nfunction Configure-WinRM {\r\n  <#\r\n    .SYNOPSIS\r\n      Setup WinRM on the instance.\r\n    .DESCRIPTION\r\n      Create a self signed cert to use with a HTTPS WinRM endpoint and restart the WinRM service.\r\n  #>\r\n\r\n  Write-Log 'Configuring WinRM...'\r\n\r\n  if (Get-Command Import-PfxCertificate -ErrorAction SilentlyContinue) {\r\n    $tempDir = \"${env:TEMP}\\cert\"\r\n    New-Item $tempDir -Type Directory\r\n    & $script:gce_install_dir\\tools\\certgen.exe -outDir $tempDir\r\n\r\n    if (-not (Test-Path \"${tempDir}\\cert.p12\")) {\r\n      Write-Log 'Error creating cert, unable to setup WinRM'\r\n      return\r\n    }\r\n    $cert = Import-PfxCertificate -FilePath $tempDir\\cert.p12 -CertStoreLocation cert:\\LocalMachine\\My\r\n    Remove-Item $tempDir -Recurse\r\n  }\r\n  else {\r\n    # SHA1 self signed cert using hostname as the SubjectKey and name installed to LocalMachine\\My store\r\n    # with enhanced key usage object identifiers of Server Authentication and Client Authentication.\r\n    # https://msdn.microsoft.com/en-us/library/windows/desktop/aa386968(v=vs.85).aspx\r\n    $eku = '1.3.6.1.5.5.7.3.1,1.3.6.1.5.5.7.3.2'\r\n    & $script:gce_install_dir\\tools\\makecert.exe -r -a SHA1 -sk \"$(hostname)\" -n \"CN=$(hostname)\" -ss My -sr LocalMachine -eku $eku\r\n    $cert = Get-ChildItem Cert:\\LocalMachine\\my | Where-Object {$_.Subject -eq \"CN=$(hostname)\"} | Select-Object -First 1\r\n  }\r\n\r\n  $xml = @\"\r\n<p:Listener xmlns:p=\"http://schemas.microsoft.com/wbem/wsman/1/config/listener.xsd\">\r\n<p:Enabled>True</p:Enabled>\r\n<p:URLPrefix>wsman</p:URLPrefix>\r\n<p:CertificateThumbPrint>$($cert.Thumbprint)</p:CertificateThumbPrint>\r\n</p:Listener>\r\n\"@\r\n\r\n  $sess = (New-Object -ComObject 'WSMAN.Automation').CreateSession()\r\n  try {\r\n    $sess.Create('winrm/config/listener?Address=*+Transport=HTTPS', $xml)\r\n  }\r\n  catch {\r\n    $sess.Put('winrm/config/listener?Address=*+Transport=HTTPS', $xml)\r\n  }\r\n\r\n  # Open the firewall.\r\n  $rule = 'Windows Remote Management (HTTPS-In)'\r\n  Invoke-ExternalCommand netsh advfirewall firewall add rule profile=any name=$rule dir=in localport=5986 protocol=TCP action=allow\r\n  Restart-Service WinRM\r\n  Write-Log 'Setup of WinRM complete.'\r\n}\r\n\r\n# Check if COM1 exists.\r\nif (-not ($global:write_to_serial)) {\r\n  Write-Log 'COM1 does not exist on this machine. Logs will not be written to GCE console.'\r\n}\r\n```\r\n\r\n# Connecting with Powershell\r\nThis is how i have managed to connect via WinRM to the instance. I am using Powershell 5.1 on a Windows 10 VM on my linux from where I also tried pywinrm.\r\n\r\n```ps1\r\nEnter-PSSession -ComputerName instance-2 -UseSSL -SessionOption (New-PSSessionOption -SkipCACheck) -Credential $credentials\r\n```\r\nAfter that, I get a prompt on the remote instance and can work.\r\n\r\n# Connecting with pywinrm\r\nIn the python3 interactive console, I am giving the following commands:\r\n\r\n```python\r\nimport winrm\r\nwinrmsession = winrm.Session('host',auth=('user','pass'),transport='ssl',server_cert_validation='ignore')\r\nwinrmsession.run_ps(\"(Get-WindowsFeature).Where{$PSItem.Installed}\")\r\nwinrmsession.run_cmd('ipconfig',['/all'])\r\n```\r\nBoth last two commands fail with the following error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/site-packages/winrm/transport.py\", line 186, in send_message\r\n    response.raise_for_status()\r\n  File \"/usr/lib/python3.6/site-packages/requests/models.py\", line 935, in raise_for_status\r\n    raise HTTPError(http_error_msg, response=self)\r\nrequests.exceptions.HTTPError: 401 Client Error:  for url: https://35.195.82.247:5986/wsman\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/lib/python3.6/site-packages/winrm/__init__.py\", line 37, in run_cmd\r\n    shell_id = self.protocol.open_shell()\r\n  File \"/usr/lib/python3.6/site-packages/winrm/protocol.py\", line 132, in open_shell\r\n    res = self.send_message(xmltodict.unparse(req))\r\n  File \"/usr/lib/python3.6/site-packages/winrm/protocol.py\", line 207, in send_message\r\n    return self.transport.send_message(message)\r\n  File \"/usr/lib/python3.6/site-packages/winrm/transport.py\", line 190, in send_message\r\n    raise InvalidCredentialsError(\"the specified credentials were rejected by the server\")\r\nwinrm.exceptions.InvalidCredentialsError: the specified credentials were rejected by the server\r\n```\r\n\r\n# WinRM Configuration on the remote instance\r\nHere is the output of `winrm get winrm/config/service`:\r\n```\r\n[instance-1]: PS C:\\> winrm get winrm/config/service\r\nService\r\n    RootSDDL = O:NSG:BAD:P(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)\r\n    MaxConcurrentOperations = 4294967295\r\n    MaxConcurrentOperationsPerUser = 1500\r\n    EnumerationTimeoutms = 240000\r\n    MaxConnections = 300\r\n    MaxPacketRetrievalTimeSeconds = 120\r\n    AllowUnencrypted = false\r\n    Auth\r\n        Basic = false\r\n        Kerberos = true\r\n        Negotiate = true\r\n        Certificate = false\r\n        CredSSP = false\r\n        CbtHardeningLevel = Relaxed\r\n    DefaultPorts\r\n        HTTP = 5985\r\n        HTTPS = 5986\r\n    IPv4Filter = *\r\n    IPv6Filter = *\r\n    EnableCompatibilityHttpListener = false\r\n    EnableCompatibilityHttpsListener = false\r\n    CertificateThumbprint\r\n    AllowRemoteAccess = true\r\n```\r\n\r\nand this is the output of `winrm e winrm/config/Listener`:\r\n```\r\n[instance-1]: PS C:\\> winrm e winrm/config/Listener\r\nListener\r\n    Address = *\r\n    Transport = HTTPS\r\n    Port = 5986\r\n    Hostname\r\n    Enabled = true\r\n    URLPrefix = wsman\r\n    CertificateThumbprint = EC73F30FC2CE5252BE0A89A4FCB05091976B00F0\r\n    ListeningOn = 10.0.0.2, 127.0.0.1, ::1\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/183", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/183/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/183/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/183/events", "html_url": "https://github.com/diyan/pywinrm/issues/183", "id": 265963634, "node_id": "MDU6SXNzdWUyNjU5NjM2MzQ=", "number": 183, "title": "Include LICENSE in source distribution", "user": {"login": "synapticarbors", "id": 589279, "node_id": "MDQ6VXNlcjU4OTI3OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/589279?v=4", "gravatar_id": "", "url": "https://api.github.com/users/synapticarbors", "html_url": "https://github.com/synapticarbors", "followers_url": "https://api.github.com/users/synapticarbors/followers", "following_url": "https://api.github.com/users/synapticarbors/following{/other_user}", "gists_url": "https://api.github.com/users/synapticarbors/gists{/gist_id}", "starred_url": "https://api.github.com/users/synapticarbors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/synapticarbors/subscriptions", "organizations_url": "https://api.github.com/users/synapticarbors/orgs", "repos_url": "https://api.github.com/users/synapticarbors/repos", "events_url": "https://api.github.com/users/synapticarbors/events{/privacy}", "received_events_url": "https://api.github.com/users/synapticarbors/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-10-17T01:22:45Z", "updated_at": "2018-01-12T22:38:33Z", "closed_at": "2018-01-12T22:38:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "This issue was mentioned in https://github.com/diyan/pywinrm/issues/57, but I'd like to re-raise it since it was closed without addressing it. I believe all you need is a `MANIFEST.in` file. I'm happy to put in a PR if the developers would be amenable to it. ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/181", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/181/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/181/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/181/events", "html_url": "https://github.com/diyan/pywinrm/issues/181", "id": 261355321, "node_id": "MDU6SXNzdWUyNjEzNTUzMjE=", "number": 181, "title": "UnicodeDecodeError with PS 5.1", "user": {"login": "Patrock", "id": 644530, "node_id": "MDQ6VXNlcjY0NDUzMA==", "avatar_url": "https://avatars3.githubusercontent.com/u/644530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Patrock", "html_url": "https://github.com/Patrock", "followers_url": "https://api.github.com/users/Patrock/followers", "following_url": "https://api.github.com/users/Patrock/following{/other_user}", "gists_url": "https://api.github.com/users/Patrock/gists{/gist_id}", "starred_url": "https://api.github.com/users/Patrock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Patrock/subscriptions", "organizations_url": "https://api.github.com/users/Patrock/orgs", "repos_url": "https://api.github.com/users/Patrock/repos", "events_url": "https://api.github.com/users/Patrock/events{/privacy}", "received_events_url": "https://api.github.com/users/Patrock/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-09-28T15:11:12Z", "updated_at": "2017-09-28T15:22:41Z", "closed_at": "2017-09-28T15:22:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\ni'm getting DecodeErrors when executing 'run_ps' on Session:\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python2.7/dist-packages/winrm/__init__.py\", line 54, in run_ps\r\n    rs.std_err = self._clean_error_msg(rs.std_err)\r\n  File \"/usr/local/lib/python2.7/dist-packages/winrm/__init__.py\", line 62, in _clean_error_msg\r\n    if msg.startswith(\"#< CLIXML\\r\\n\"):\r\nUnicodeDecodeError: 'ascii' codec can't decode byte 0x81 in position 271: ordinal not in range(128)\r\n\r\n\r\nusing 'run_cmd' works fine.\r\n\r\nIm using Python 2.7 and latest pywinrm...\r\n\r\nAny hints on this ?\r\n\r\nThank you\r\n\r\nPatrock", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/179", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/179/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/179/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/179/events", "html_url": "https://github.com/diyan/pywinrm/issues/179", "id": 259595000, "node_id": "MDU6SXNzdWUyNTk1OTUwMDA=", "number": 179, "title": "Custom CA bundles/paths do not work", "user": {"login": "dekimsey", "id": 90741, "node_id": "MDQ6VXNlcjkwNzQx", "avatar_url": "https://avatars1.githubusercontent.com/u/90741?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dekimsey", "html_url": "https://github.com/dekimsey", "followers_url": "https://api.github.com/users/dekimsey/followers", "following_url": "https://api.github.com/users/dekimsey/following{/other_user}", "gists_url": "https://api.github.com/users/dekimsey/gists{/gist_id}", "starred_url": "https://api.github.com/users/dekimsey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dekimsey/subscriptions", "organizations_url": "https://api.github.com/users/dekimsey/orgs", "repos_url": "https://api.github.com/users/dekimsey/repos", "events_url": "https://api.github.com/users/dekimsey/events{/privacy}", "received_events_url": "https://api.github.com/users/dekimsey/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-09-21T18:48:08Z", "updated_at": "2018-01-12T22:42:18Z", "closed_at": "2018-01-12T22:42:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "The `ca_trust_path` argument of **Protocol** is passed down to **Transport** but **Transport** does not set the `verify=` argument on **requests.Session**. So the provided CA bundle goes nowhere, failing the connection. Instead the library throws CERTIFICATE_VERIFY_FAILED error.\r\n\r\npython 3.6.2\r\npywinrm 0.2.2\r\n\r\nipython example:\r\n```\r\nIn [31]: s = winrm.Session('https://ad.example.com:5986', auth=(None, None), transport='kerberos', ca_trust_path='adca.crt') ; s.run_cmd('ipconfig')\r\n---------------------------------------------------------------------------\r\nSSLError                                  Traceback (most recent call last)\r\n/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)\r\n    600                                                   body=body, headers=headers,\r\n--> 601                                                   chunked=chunked)\r\n    602\r\n\r\n/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py in _make_request(self, conn, method, url, timeout, chunked, **httplib_request_kw)\r\n    345         try:\r\n--> 346             self._validate_conn(conn)\r\n    347         except (SocketTimeout, BaseSSLError) as e:\r\n\r\n/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py in _validate_conn(self, conn)\r\n    849         if not getattr(conn, 'sock', None):  # AppEngine might not have  `.sock`\r\n--> 850             conn.connect()\r\n    851\r\n\r\n/usr/local/lib/python3.6/site-packages/urllib3/connection.py in connect(self)\r\n    325             server_hostname=hostname,\r\n--> 326             ssl_context=context)\r\n    327\r\n\r\n/usr/local/lib/python3.6/site-packages/urllib3/util/ssl_.py in ssl_wrap_socket(sock, keyfile, certfile, cert_reqs, ca_certs, server_hostname, ssl_version, ciphers, ssl_context, ca_cert_dir)\r\n    328     if HAS_SNI:  # Platform-specific: OpenSSL with enabled SNI\r\n--> 329         return context.wrap_socket(sock, server_hostname=server_hostname)\r\n    330\r\n\r\n/usr/local/Cellar/python3/3.6.2/Frameworks/Python.framework/Versions/3.6/lib/python3.6/ssl.py in wrap_socket(self, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, session)\r\n    400                          server_hostname=server_hostname,\r\n--> 401                          _context=self, _session=session)\r\n    402\r\n\r\n/usr/local/Cellar/python3/3.6.2/Frameworks/Python.framework/Versions/3.6/lib/python3.6/ssl.py in __init__(self, sock, keyfile, certfile, server_side, cert_reqs, ssl_version, ca_certs, do_handshake_on_connect, family, type, proto, fileno, suppress_ragged_eofs, npn_protocols, ciphers, server_hostname, _context, _session)\r\n    807                         raise ValueError(\"do_handshake_on_connect should not be specified for non-blocking sockets\")\r\n--> 808                     self.do_handshake()\r\n    809\r\n\r\n/usr/local/Cellar/python3/3.6.2/Frameworks/Python.framework/Versions/3.6/lib/python3.6/ssl.py in do_handshake(self, block)\r\n   1060                 self.settimeout(None)\r\n-> 1061             self._sslobj.do_handshake()\r\n   1062         finally:\r\n\r\n/usr/local/Cellar/python3/3.6.2/Frameworks/Python.framework/Versions/3.6/lib/python3.6/ssl.py in do_handshake(self)\r\n    682         \"\"\"Start the SSL/TLS handshake.\"\"\"\r\n--> 683         self._sslobj.do_handshake()\r\n    684         if self.context.check_hostname:\r\n\r\nSSLError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:748)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nMaxRetryError                             Traceback (most recent call last)\r\n/usr/local/lib/python3.6/site-packages/requests/adapters.py in send(self, request, stream, timeout, verify, cert, proxies)\r\n    439                     retries=self.max_retries,\r\n--> 440                     timeout=timeout\r\n    441                 )\r\n\r\n/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)\r\n    638             retries = retries.increment(method, url, error=e, _pool=self,\r\n--> 639                                         _stacktrace=sys.exc_info()[2])\r\n    640             retries.sleep()\r\n\r\n/usr/local/lib/python3.6/site-packages/urllib3/util/retry.py in increment(self, method, url, response, error, _pool, _stacktrace)\r\n    387         if new_retry.is_exhausted():\r\n--> 388             raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\n    389\r\n\r\nMaxRetryError: HTTPSConnectionPool(host='ad.example.com', port=5986): Max retries exceeded with url: /wsman (Caused by SSLError(SSLError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:748)'),))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nSSLError                                  Traceback (most recent call last)\r\n<ipython-input-31-2976251a2d3f> in <module>()\r\n----> 1 s = winrm.Session('https://ad.example.com:5986', auth=(None, None), transport='kerberos', ca_trust_path='adca.crt') ; s.run_cmd('ipconfig')\r\n\r\n/usr/local/lib/python3.6/site-packages/winrm/__init__.py in run_cmd(self, command, args)\r\n     35     def run_cmd(self, command, args=()):\r\n     36         # TODO optimize perf. Do not call open/close shell every time\r\n---> 37         shell_id = self.protocol.open_shell()\r\n     38         command_id = self.protocol.run_command(shell_id, command, args)\r\n     39         rs = Response(self.protocol.get_command_output(shell_id, command_id))\r\n\r\n/usr/local/lib/python3.6/site-packages/winrm/protocol.py in open_shell(self, i_stream, o_stream, working_directory, env_vars, noprofile, codepage, lifetime, idle_timeout)\r\n    130                 env['rsp:Variable'] = {'@Name': key, '#text': value}\r\n    131\r\n--> 132         res = self.send_message(xmltodict.unparse(req))\r\n    133         #res = xmltodict.parse(res)\r\n    134         #return res['s:Envelope']['s:Body']['x:ResourceCreated']['a:ReferenceParameters']['w:SelectorSet']['w:Selector']['#text']\r\n\r\n/usr/local/lib/python3.6/site-packages/winrm/protocol.py in send_message(self, message)\r\n    205         # TODO add message_id vs relates_to checking\r\n    206         # TODO port error handling code\r\n--> 207         return self.transport.send_message(message)\r\n    208\r\n    209     def close_shell(self, shell_id):\r\n\r\n/usr/local/lib/python3.6/site-packages/winrm/transport.py in send_message(self, message)\r\n    182\r\n    183         try:\r\n--> 184             response = self.session.send(prepared_request, timeout=self.read_timeout_sec)\r\n    185             response_text = response.text\r\n    186             response.raise_for_status()\r\n\r\n/usr/local/lib/python3.6/site-packages/requests/sessions.py in send(self, request, **kwargs)\r\n    616\r\n    617         # Send the request\r\n--> 618         r = adapter.send(request, **kwargs)\r\n    619\r\n    620         # Total elapsed time of the request (approximately)\r\n\r\n/usr/local/lib/python3.6/site-packages/requests/adapters.py in send(self, request, stream, timeout, verify, cert, proxies)\r\n    504             if isinstance(e.reason, _SSLError):\r\n    505                 # This branch is for urllib3 v1.22 and later.\r\n--> 506                 raise SSLError(e, request=request)\r\n    507\r\n    508             raise ConnectionError(e, request=request)\r\n\r\nSSLError: HTTPSConnectionPool(host='ad.example.com', port=5986): Max retries exceeded with url: /wsman (Caused by SSLError(SSLError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:748)'),))\r\n```\r\n\r\nPer request.Session docs, verify can be one of (True, False, '/path/to/cabundle.crt', '/path/to/ca-bundle/'). FWIW the separate validation flag (`server_cert_validation`) isn't really needed.\r\nSuper monkey patch follows:\r\n```\r\nIn [37]: orig_build_session = winrm.transport.Transport.build_session\r\n\r\nIn [38]: def build_session(self):\r\n    ...:     session = orig_build_session(self)\r\n    ...:     if self.ca_trust_path is not None:\r\n    ...:         session.verify = self.ca_trust_path\r\n    ...:     return session\r\n    ...:\r\n\r\nIn [39]: winrm.transport.Transport.build_session = build_session\r\n\r\nIn [40]: s = winrm.Session('https://ad.example.com:5986', auth=(None, None), transport='kerberos', ca_trust_path='adca.crt') ; s.run_cmd('ipconfig')\r\n/usr/local/lib/python3.6/site-packages/urllib3/connection.py:344: SubjectAltNameWarning: Certificate for ad.example.com has no `subjectAltName`, falling back to check for a `commonName` for now. This feature is being removed by major browsers and deprecated by RFC 2818. (See https://github.com/shazow/urllib3/issues/497 for details.)\r\n  SubjectAltNameWarning\r\nOut[40]: <Response code 0, out \"b'\\r\\nWindows IP Configu'\", err \"b''\">\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/173", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/173/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/173/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/173/events", "html_url": "https://github.com/diyan/pywinrm/issues/173", "id": 248543696, "node_id": "MDU6SXNzdWUyNDg1NDM2OTY=", "number": 173, "title": "need credssp code and conf example", "user": {"login": "copdips", "id": 13083856, "node_id": "MDQ6VXNlcjEzMDgzODU2", "avatar_url": "https://avatars1.githubusercontent.com/u/13083856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/copdips", "html_url": "https://github.com/copdips", "followers_url": "https://api.github.com/users/copdips/followers", "following_url": "https://api.github.com/users/copdips/following{/other_user}", "gists_url": "https://api.github.com/users/copdips/gists{/gist_id}", "starred_url": "https://api.github.com/users/copdips/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/copdips/subscriptions", "organizations_url": "https://api.github.com/users/copdips/orgs", "repos_url": "https://api.github.com/users/copdips/repos", "events_url": "https://api.github.com/users/copdips/events{/privacy}", "received_events_url": "https://api.github.com/users/copdips/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-08-07T22:00:17Z", "updated_at": "2017-08-12T16:21:54Z", "closed_at": "2017-08-08T13:16:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI'm a windows guy, don't have much knowledge on linux.\r\nI'm testing pywrinm on redhat 7.2, it's great, thx a lot for your work.\r\n\r\nCurrent example provided by the repo is based on the NTLM authentication.\r\nCould you please provide an example on how to use credssp ?\r\n\r\nIf I set transport='ntlm', it works.\r\nBut if I tried transport='credssp' in winrm.Session(), but it doesn't work.\r\nAnd when I provoke a credssp connection from a windows server to the same target, it works too.\r\n\r\nError message:\r\n![pywinrm-credssp](https://user-images.githubusercontent.com/13083856/29047552-6d820e08-7bcc-11e7-9aba-5d19ff412f50.PNG)\r\n\r\nThx", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/171", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/171/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/171/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/171/events", "html_url": "https://github.com/diyan/pywinrm/issues/171", "id": 245471951, "node_id": "MDU6SXNzdWUyNDU0NzE5NTE=", "number": 171, "title": "InvalidCredentialsError", "user": {"login": "ianbeh96", "id": 26463426, "node_id": "MDQ6VXNlcjI2NDYzNDI2", "avatar_url": "https://avatars3.githubusercontent.com/u/26463426?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianbeh96", "html_url": "https://github.com/ianbeh96", "followers_url": "https://api.github.com/users/ianbeh96/followers", "following_url": "https://api.github.com/users/ianbeh96/following{/other_user}", "gists_url": "https://api.github.com/users/ianbeh96/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianbeh96/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianbeh96/subscriptions", "organizations_url": "https://api.github.com/users/ianbeh96/orgs", "repos_url": "https://api.github.com/users/ianbeh96/repos", "events_url": "https://api.github.com/users/ianbeh96/events{/privacy}", "received_events_url": "https://api.github.com/users/ianbeh96/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-07-25T17:13:21Z", "updated_at": "2018-01-12T22:48:53Z", "closed_at": "2018-01-12T22:48:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I am having some issues when connecting to a virtual machine that is running Windows Server 2008.  This is the part of my code which i am using to connect to the machine.\r\n\r\nconnection = Protocol(\r\n                   endpoint = 'http://' + ip[0].attributes['addr'].value + ':5985/wsman',\r\n                   transport = 'ntlm',\r\n                   username = vm_user2,\r\n                   password = vm_pass2,\r\n                   server_cert_validation = 'ignore')\r\n\r\nAnd it is giving me this error.\r\n\r\nTraceback (most recent call last):\r\n  File \"./prune.py\", line 57, in <module>\r\n    shell_id = connection.open_shell()\r\n  File \"/usr/local/lib/python2.7/dist-packages/winrm/protocol.py\", line 132, in open_shell\r\n    res = self.send_message(xmltodict.unparse(req))\r\n  File \"/usr/local/lib/python2.7/dist-packages/winrm/protocol.py\", line 207, in send_message\r\n    return self.transport.send_message(message)\r\n  File \"/usr/local/lib/python2.7/dist-packages/winrm/transport.py\", line 190, in send_message\r\n    raise InvalidCredentialsError(\"the specified credentials were rejected by the server\")\r\nwinrm.exceptions.InvalidCredentialsError: the specified credentials were rejected by the server\r\n\r\nI have a bunch of VMs that i am trying to connect to, but the code only works when connecting to machines that run on Windows 7 otherwise it breaks.\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/167", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/167/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/167/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/167/events", "html_url": "https://github.com/diyan/pywinrm/issues/167", "id": 226638330, "node_id": "MDU6SXNzdWUyMjY2MzgzMzA=", "number": 167, "title": "Support Elevation via Scheduled tasks", "user": {"login": "heri16", "id": 527101, "node_id": "MDQ6VXNlcjUyNzEwMQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/527101?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heri16", "html_url": "https://github.com/heri16", "followers_url": "https://api.github.com/users/heri16/followers", "following_url": "https://api.github.com/users/heri16/following{/other_user}", "gists_url": "https://api.github.com/users/heri16/gists{/gist_id}", "starred_url": "https://api.github.com/users/heri16/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heri16/subscriptions", "organizations_url": "https://api.github.com/users/heri16/orgs", "repos_url": "https://api.github.com/users/heri16/repos", "events_url": "https://api.github.com/users/heri16/events{/privacy}", "received_events_url": "https://api.github.com/users/heri16/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 8636405, "node_id": "MDU6TGFiZWw4NjM2NDA1", "url": "https://api.github.com/repos/diyan/pywinrm/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-05-05T17:22:04Z", "updated_at": "2018-01-12T22:52:36Z", "closed_at": "2018-01-12T22:52:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "See: https://github.com/WinRb/winrm-elevated", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/163", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/163/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/163/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/163/events", "html_url": "https://github.com/diyan/pywinrm/issues/163", "id": 217310464, "node_id": "MDU6SXNzdWUyMTczMTA0NjQ=", "number": 163, "title": "What is recommended good practice for running commands using Protocol?", "user": {"login": "mikequentel", "id": 5436386, "node_id": "MDQ6VXNlcjU0MzYzODY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5436386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mikequentel", "html_url": "https://github.com/mikequentel", "followers_url": "https://api.github.com/users/mikequentel/followers", "following_url": "https://api.github.com/users/mikequentel/following{/other_user}", "gists_url": "https://api.github.com/users/mikequentel/gists{/gist_id}", "starred_url": "https://api.github.com/users/mikequentel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mikequentel/subscriptions", "organizations_url": "https://api.github.com/users/mikequentel/orgs", "repos_url": "https://api.github.com/users/mikequentel/repos", "events_url": "https://api.github.com/users/mikequentel/events{/privacy}", "received_events_url": "https://api.github.com/users/mikequentel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2017-03-27T16:59:17Z", "updated_at": "2017-03-30T18:48:30Z", "closed_at": "2017-03-30T18:48:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Have an Ansible playbook that runs a python script that imports `winrm.Protocol` to make connections to a Windows 2012 Server. _Just as an aside: I never got the Ansible `winrm` connection to successfully work for NTLM; hence calling PyWinrm python scripts from Ansible, rather than using the [Ansible winrm module](http://docs.ansible.com/ansible/intro_windows.html)_\r\n\r\nSo, is it acceptable (recommended good practice) to open one shell, then run multiple commands, then close the shell, like the following example?:\r\n\r\n```\r\n#!/usr/bin/python\r\nimport os\r\nfrom winrm.protocol import Protocol\r\nuser = os.environ['ANSIBLE_USER']\r\npasswd = os.environ['ANSIBLE_PASSWORD']\r\np = Protocol(endpoint='https://mywindows2012server:5986/wsman',transport='ntlm',username=user,password=passwd,server_cert_validation='ignore')\r\nshell_id = p.open_shell()\r\ncommand_id = p.run_command(shell_id, 'ipconfig', ['/all'])\r\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\r\np.cleanup_command(shell_id, command_id)\r\nprint \"std_out: \" + str(std_out)\r\nprint \"std_err: \" + str(std_err)\r\nprint \"status_code: \" + str(status_code)\r\ncommand_id = p.run_command(shell_id, 'ping', ['10.27.14.149'])\r\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\r\np.cleanup_command(shell_id, command_id)\r\nprint \"std_out: \" + str(std_out)\r\nprint \"std_err: \" + str(std_err)\r\nprint \"status_code: \" + str(status_code)\r\np.close_shell(shell_id)\r\n```\r\n\r\nThanks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/161", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/161/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/161/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/161/events", "html_url": "https://github.com/diyan/pywinrm/issues/161", "id": 214993164, "node_id": "MDU6SXNzdWUyMTQ5OTMxNjQ=", "number": 161, "title": "Kerberos & Channel Binding Token (CBT).", "user": {"login": "romanponomarev", "id": 15785694, "node_id": "MDQ6VXNlcjE1Nzg1Njk0", "avatar_url": "https://avatars2.githubusercontent.com/u/15785694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/romanponomarev", "html_url": "https://github.com/romanponomarev", "followers_url": "https://api.github.com/users/romanponomarev/followers", "following_url": "https://api.github.com/users/romanponomarev/following{/other_user}", "gists_url": "https://api.github.com/users/romanponomarev/gists{/gist_id}", "starred_url": "https://api.github.com/users/romanponomarev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/romanponomarev/subscriptions", "organizations_url": "https://api.github.com/users/romanponomarev/orgs", "repos_url": "https://api.github.com/users/romanponomarev/repos", "events_url": "https://api.github.com/users/romanponomarev/events{/privacy}", "received_events_url": "https://api.github.com/users/romanponomarev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2017-03-17T12:45:28Z", "updated_at": "2018-01-12T22:55:05Z", "closed_at": "2018-01-12T22:55:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, \r\n\r\nafter enable Channel Binding Token with domain policy (CbtHardeningLevel = Strict)\r\n\r\n```\r\nPS C:\\windows\\system32> winrm get winrm/config/service/auth\r\nAuth\r\n    Basic = false [Source=\"GPO\"]\r\n    Kerberos = true\r\n    Negotiate = true\r\n    Certificate = false\r\n    CredSSP = false\r\n    CbtHardeningLevel = Strict [Source=\"GPO\"]\r\n```\r\nI get error\r\n\r\n```\r\n<server-name.example.com> WINRM CONNECTION ERROR: the specified credentials were rejected by the server\r\nTraceback (most recent call last):\r\nFile \"/usr/lib/python2.7/site-packages/ansible/plugins/connection/winrm.py\", line 154, in _winrm_connect\r\nself.shell_id = protocol.open_shell(codepage=65001) # UTF-8\r\nFile \"build/bdist.linux-x86_64/egg/winrm/protocol.py\", line 132, in open_shell\r\nres = self.send_message(xmltodict.unparse(req))\r\nFile \"build/bdist.linux-x86_64/egg/winrm/protocol.py\", line 207, in send_message\r\nreturn self.transport.send_message(message)\r\nFile \"build/bdist.linux-x86_64/egg/winrm/transport.py\", line 179, in send_message\r\nraise InvalidCredentialsError(\"the specified credentials were rejected by the server\")\r\nInvalidCredentialsError: the specified credentials were rejected by the server\r\n\r\nserver-name.example.com | UNREACHABLE! => {\r\n\"changed\": false,\r\n\"msg\": \"kerberos: the specified credentials were rejected by the server\",\r\n\"unreachable\": true\r\n}\r\n```\r\nansible (2.2.1.0), pywinrm (0.2.1), pykerberos (1.1.13), requests-kerberos (0.10.0) are installed in to ansible linux host.\r\n\r\nAnsible connections parameters:\r\n```\r\nansible_port: 5986\r\nansible_connection: winrm\r\nansible_winrm_service: https\r\nansible_winrm_server_cert_validation: ignore\r\nansible_winrm_transport: kerberos\r\n```\r\nUnfortunately we can't use NTLM instead of Kerberos because of internal security requirements.\r\n\r\nHow can I resolve this problem, using Kerberos authorisation only ?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/159", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/159/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/159/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/159/events", "html_url": "https://github.com/diyan/pywinrm/issues/159", "id": 212656017, "node_id": "MDU6SXNzdWUyMTI2NTYwMTc=", "number": 159, "title": "please give an example how to run session class methods", "user": {"login": "Dash-Abhishek", "id": 25668223, "node_id": "MDQ6VXNlcjI1NjY4MjIz", "avatar_url": "https://avatars3.githubusercontent.com/u/25668223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dash-Abhishek", "html_url": "https://github.com/Dash-Abhishek", "followers_url": "https://api.github.com/users/Dash-Abhishek/followers", "following_url": "https://api.github.com/users/Dash-Abhishek/following{/other_user}", "gists_url": "https://api.github.com/users/Dash-Abhishek/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dash-Abhishek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dash-Abhishek/subscriptions", "organizations_url": "https://api.github.com/users/Dash-Abhishek/orgs", "repos_url": "https://api.github.com/users/Dash-Abhishek/repos", "events_url": "https://api.github.com/users/Dash-Abhishek/events{/privacy}", "received_events_url": "https://api.github.com/users/Dash-Abhishek/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-03-08T07:09:19Z", "updated_at": "2017-03-10T05:44:55Z", "closed_at": "2017-03-10T05:44:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Example to run s.run_ps()\r\nExample to run s.run_cmd()\r\n\"windows-host.example.com\"  what should be written instead of it\r\nif my target machine name is EBII362f1.corp.********.com", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/158", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/158/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/158/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/158/events", "html_url": "https://github.com/diyan/pywinrm/issues/158", "id": 212093120, "node_id": "MDU6SXNzdWUyMTIwOTMxMjA=", "number": 158, "title": "the specified credentials were rejected by the server", "user": {"login": "Dash-Abhishek", "id": 25668223, "node_id": "MDQ6VXNlcjI1NjY4MjIz", "avatar_url": "https://avatars3.githubusercontent.com/u/25668223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dash-Abhishek", "html_url": "https://github.com/Dash-Abhishek", "followers_url": "https://api.github.com/users/Dash-Abhishek/followers", "following_url": "https://api.github.com/users/Dash-Abhishek/following{/other_user}", "gists_url": "https://api.github.com/users/Dash-Abhishek/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dash-Abhishek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dash-Abhishek/subscriptions", "organizations_url": "https://api.github.com/users/Dash-Abhishek/orgs", "repos_url": "https://api.github.com/users/Dash-Abhishek/repos", "events_url": "https://api.github.com/users/Dash-Abhishek/events{/privacy}", "received_events_url": "https://api.github.com/users/Dash-Abhishek/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-03-06T11:19:17Z", "updated_at": "2018-03-06T22:25:49Z", "closed_at": "2018-01-12T22:55:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Traceback (most recent call last):\r\n  File \"<pyshell#8>\", line 1, in <module>\r\n    r = s.run_cmd('ipconfig', ['/all'])\r\n  File \"C:\\Python27\\lib\\site-packages\\winrm\\__init__.py\", line 37, in run_cmd\r\n    shell_id = self.protocol.open_shell()\r\n  File \"C:\\Python27\\lib\\site-packages\\winrm\\protocol.py\", line 132, in open_shell\r\n    res = self.send_message(xmltodict.unparse(req))\r\n  File \"C:\\Python27\\lib\\site-packages\\winrm\\protocol.py\", line 207, in send_message\r\n    return self.transport.send_message(message)\r\n  File \"C:\\Python27\\lib\\site-packages\\winrm\\transport.py\", line 190, in send_message\r\n    raise InvalidCredentialsError(\"the specified credentials were rejected by the server\")\r\nInvalidCredentialsError: the specified credentials were rejected by the server", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/154", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/154/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/154/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/154/events", "html_url": "https://github.com/diyan/pywinrm/issues/154", "id": 205520575, "node_id": "MDU6SXNzdWUyMDU1MjA1NzU=", "number": 154, "title": "winrm.exceptions.InvalidCredentialsError: the specified credentials were rejected by the server", "user": {"login": "yanikkoval", "id": 3940227, "node_id": "MDQ6VXNlcjM5NDAyMjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3940227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yanikkoval", "html_url": "https://github.com/yanikkoval", "followers_url": "https://api.github.com/users/yanikkoval/followers", "following_url": "https://api.github.com/users/yanikkoval/following{/other_user}", "gists_url": "https://api.github.com/users/yanikkoval/gists{/gist_id}", "starred_url": "https://api.github.com/users/yanikkoval/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yanikkoval/subscriptions", "organizations_url": "https://api.github.com/users/yanikkoval/orgs", "repos_url": "https://api.github.com/users/yanikkoval/repos", "events_url": "https://api.github.com/users/yanikkoval/events{/privacy}", "received_events_url": "https://api.github.com/users/yanikkoval/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2017-02-06T08:52:12Z", "updated_at": "2019-06-24T19:54:11Z", "closed_at": "2019-06-24T19:54:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I tried many different approaches but still can't login to my VM with extension: \r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"fast_deploy.py\", line 57, in <module>\r\n    r = win_session.run_cmd('ipconfig', ['/all'])\r\n  File \"/Users/yanik/workspace/safeqa/env-deploy/lib/python3.5/site-packages/winrm/__init__.py\", line 37, in run_cmd\r\n    shell_id = self.protocol.open_shell()\r\n  File \"/Users/yanik/workspace/safeqa/env-deploy/lib/python3.5/site-packages/winrm/protocol.py\", line 132, in open_shell\r\n    res = self.send_message(xmltodict.unparse(req))\r\n  File \"/Users/yanik/workspace/safeqa/env-deploy/lib/python3.5/site-packages/winrm/protocol.py\", line 207, in send_message\r\n    return self.transport.send_message(message)\r\n  File \"/Users/yanik/workspace/safeqa/env-deploy/lib/python3.5/site-packages/winrm/transport.py\", line 190, in send_message\r\n    raise InvalidCredentialsError(\"the specified credentials were rejected by the server\")\r\nwinrm.exceptions.InvalidCredentialsError: the specified credentials were rejected by the server\r\n```\r\n\r\n\r\nMy command is very simple: \r\n\r\n```\r\n# windows session\r\nwin_session = winrm.Session(CML_IP, auth=(r'QA13S104\\administartor', '111111'))\r\nr = win_session.run_cmd('ipconfig', ['/all'])\r\n```\r\n\r\nBut I also tried different approaches, from similar issue titles, nothing is working for me.\r\n\r\nI have permission to execute commands on the machine for this user and my winrm config:\r\n```\r\nConfig\r\n    MaxEnvelopeSizekb = 500\r\n    MaxTimeoutms = 60000\r\n    MaxBatchItems = 32000\r\n    MaxProviderRequests = 4294967295\r\n    Client\r\n        NetworkDelayms = 5000\r\n        URLPrefix = wsman\r\n        AllowUnencrypted = false\r\n        Auth\r\n            Basic = true\r\n            Digest = true\r\n            Kerberos = true\r\n            Negotiate = true\r\n            Certificate = true\r\n            CredSSP = false\r\n        DefaultPorts\r\n            HTTP = 5985\r\n            HTTPS = 5986\r\n        TrustedHosts = 10.0.*\r\n    Service\r\n        RootSDDL = O:NSG:BAD:P(A;;GAGX;;;BA)(A;;GXGR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)\r\n        MaxConcurrentOperations = 4294967295\r\n        MaxConcurrentOperationsPerUser = 1500\r\n        EnumerationTimeoutms = 240000\r\n        MaxConnections = 300\r\n        MaxPacketRetrievalTimeSeconds = 120\r\n        AllowUnencrypted = false\r\n        Auth\r\n            Basic = false\r\n            Kerberos = true\r\n            Negotiate = true\r\n            Certificate = false\r\n            CredSSP = false\r\n            CbtHardeningLevel = Relaxed\r\n        DefaultPorts\r\n            HTTP = 5985\r\n            HTTPS = 5986\r\n        IPv4Filter = *\r\n        IPv6Filter = *\r\n        EnableCompatibilityHttpListener = false\r\n        EnableCompatibilityHttpsListener = false\r\n        CertificateThumbprint\r\n        AllowRemoteAccess = true\r\n    Winrs\r\n        AllowRemoteShellAccess = true\r\n        IdleTimeout = 7200000\r\n        MaxConcurrentUsers = 10\r\n        MaxShellRunTime = 2147483647\r\n        MaxProcessesPerShell = 25\r\n        MaxMemoryPerShellMB = 1024\r\n        MaxShellsPerUser = 30\r\n```\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/153", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/153/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/153/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/153/events", "html_url": "https://github.com/diyan/pywinrm/issues/153", "id": 199601088, "node_id": "MDU6SXNzdWUxOTk2MDEwODg=", "number": 153, "title": "Bad HTTP response returned from server. Code 500 -> with domain account only", "user": {"login": "Hachebourin", "id": 19730082, "node_id": "MDQ6VXNlcjE5NzMwMDgy", "avatar_url": "https://avatars3.githubusercontent.com/u/19730082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hachebourin", "html_url": "https://github.com/Hachebourin", "followers_url": "https://api.github.com/users/Hachebourin/followers", "following_url": "https://api.github.com/users/Hachebourin/following{/other_user}", "gists_url": "https://api.github.com/users/Hachebourin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hachebourin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hachebourin/subscriptions", "organizations_url": "https://api.github.com/users/Hachebourin/orgs", "repos_url": "https://api.github.com/users/Hachebourin/repos", "events_url": "https://api.github.com/users/Hachebourin/events{/privacy}", "received_events_url": "https://api.github.com/users/Hachebourin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-01-09T16:44:00Z", "updated_at": "2018-01-12T22:55:57Z", "closed_at": "2018-01-12T22:55:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, \r\n\r\nI got an issue only when i'm trying to open a connection with a domain account :\r\n![image](https://cloud.githubusercontent.com/assets/19730082/21774072/8e9faad6-d691-11e6-9b44-192cc19e3c16.png)\r\nWith a local account like Administrator it's working.\r\nWhen I'm doing a winrm connection windows to windows with the same domain account it's working well.\r\n\r\nHere is my code : \r\n![image](https://cloud.githubusercontent.com/assets/19730082/21774283/4e208574-d692-11e6-836f-996d570b4a47.png)\r\n\r\nAnd finally my winrm configuration : \r\n![image](https://cloud.githubusercontent.com/assets/19730082/21774304/59411ee6-d692-11e6-975d-9fdebbe1e2dc.png)\r\n\r\nI really don't know what to do :(. Any idea ?\r\n\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/150", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/150/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/150/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/150/events", "html_url": "https://github.com/diyan/pywinrm/issues/150", "id": 197535199, "node_id": "MDU6SXNzdWUxOTc1MzUxOTk=", "number": 150, "title": "When using kerberos got this issue.", "user": {"login": "crazy-canux", "id": 14313415, "node_id": "MDQ6VXNlcjE0MzEzNDE1", "avatar_url": "https://avatars0.githubusercontent.com/u/14313415?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crazy-canux", "html_url": "https://github.com/crazy-canux", "followers_url": "https://api.github.com/users/crazy-canux/followers", "following_url": "https://api.github.com/users/crazy-canux/following{/other_user}", "gists_url": "https://api.github.com/users/crazy-canux/gists{/gist_id}", "starred_url": "https://api.github.com/users/crazy-canux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crazy-canux/subscriptions", "organizations_url": "https://api.github.com/users/crazy-canux/orgs", "repos_url": "https://api.github.com/users/crazy-canux/repos", "events_url": "https://api.github.com/users/crazy-canux/events{/privacy}", "received_events_url": "https://api.github.com/users/crazy-canux/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-12-26T04:41:30Z", "updated_at": "2018-01-12T22:56:14Z", "closed_at": "2018-01-12T22:56:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "authGSSClientInit() failed: (('Unspecified GSS failure.  Minor code may provide more information', 851968), (\"Can't find client principal USER@DOMAIN in cache collection\", -1765328243))\r\n\r\nany ideas?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/146", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/146/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/146/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/146/events", "html_url": "https://github.com/diyan/pywinrm/issues/146", "id": 181880465, "node_id": "MDU6SXNzdWUxODE4ODA0NjU=", "number": 146, "title": "Future pywinrm plans/MS-PSRP support", "user": {"login": "jborean93", "id": 8462645, "node_id": "MDQ6VXNlcjg0NjI2NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8462645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jborean93", "html_url": "https://github.com/jborean93", "followers_url": "https://api.github.com/users/jborean93/followers", "following_url": "https://api.github.com/users/jborean93/following{/other_user}", "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}", "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions", "organizations_url": "https://api.github.com/users/jborean93/orgs", "repos_url": "https://api.github.com/users/jborean93/repos", "events_url": "https://api.github.com/users/jborean93/events{/privacy}", "received_events_url": "https://api.github.com/users/jborean93/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-10-09T10:49:38Z", "updated_at": "2019-06-24T19:41:23Z", "closed_at": "2019-06-24T19:41:23Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Hi\n\nI am wondering if there was any upcoming plans to utilise MS-PSRP with pywinrm. Some details behind this can be read here http://www.hurryupandwait.io/blog/a-look-under-the-hood-at-powershell-remoting-through-a-ruby-cross-plaform-lens. Some features I have planned to add are;\n- CredSSP auth support with https://github.com/diyan/pywinrm/pull/135\n- Encrypted Message support with CredSSP auth (once above pull request merged in)\n- Encrypted Message support with NTLM auth (once pull request merged with requests_ntlm to enable this)\n\nI know @nitzmahone is working hard on some Ansible work as well as encrypted message support with Kerberos auth as well as some other work. I am keen to help with any future work with this library and was hoping to get some guidance of where some of the main contributors thought it should be going next. My thoughts were adding support for the PSRP protocol would be good but wasn't sure if my efforts were better directed somewhere more useful or if this work would be duplicating other people's plans.\n\nThanks\n\nJordan\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/143", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/143/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/143/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/143/events", "html_url": "https://github.com/diyan/pywinrm/issues/143", "id": 179117493, "node_id": "MDU6SXNzdWUxNzkxMTc0OTM=", "number": 143, "title": "Test failures on OSX", "user": {"login": "b-long", "id": 66993, "node_id": "MDQ6VXNlcjY2OTkz", "avatar_url": "https://avatars0.githubusercontent.com/u/66993?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b-long", "html_url": "https://github.com/b-long", "followers_url": "https://api.github.com/users/b-long/followers", "following_url": "https://api.github.com/users/b-long/following{/other_user}", "gists_url": "https://api.github.com/users/b-long/gists{/gist_id}", "starred_url": "https://api.github.com/users/b-long/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b-long/subscriptions", "organizations_url": "https://api.github.com/users/b-long/orgs", "repos_url": "https://api.github.com/users/b-long/repos", "events_url": "https://api.github.com/users/b-long/events{/privacy}", "received_events_url": "https://api.github.com/users/b-long/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-09-26T00:04:25Z", "updated_at": "2019-06-24T20:34:31Z", "closed_at": "2019-06-24T20:34:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi there, sorry if this is just noise, but I'd like to help with development of pywinrm.  As such, I tried to clone and test this repository.  This resulted in test failures, here are my annotated results : \n\nPrint the commit that I'm attempting to build: \n\n```\nmy-laptop:pywinrm me$ git log -n 1\ncommit 7115b87bf30563caeb6e7d0a072064b532dab6fa\nAuthor: nitzmahone <mdavis@ansible.com>\nDate:   Tue Sep 20 11:42:27 2016 -0700\n\n    changelog/version updates for release 0.2.1\n```\n\nEnsure we're using a proper Python version (based on [`setup.py`](https://github.com/diyan/pywinrm/blob/7115b87bf30563caeb6e7d0a072064b532dab6fa/setup.py#L38) ) : \n\n```\nmy-laptop:pywinrm me$ pyenv install 2.7\nDownloading Python-2.7.tgz...\n-> https://www.python.org/ftp/python/2.7/Python-2.7.tgz\nInstalling Python-2.7...\npatching file setup.py\npatching file ./Modules/readline.c\nHunk #1 succeeded at 200 (offset -6 lines).\nHunk #2 succeeded at 699 (offset -50 lines).\nHunk #3 succeeded at 809 (offset -50 lines).\nHunk #4 succeeded at 849 with fuzz 2 (offset -69 lines).\npatching file ./Lib/ssl.py\nHunk #2 succeeded at 397 (offset -2 lines).\npatching file ./Modules/_ssl.c\nHunk #3 succeeded at 1713 (offset -1 lines).\nInstalling pip from https://bootstrap.pypa.io/get-pip.py...\nInstalled Python-2.7 to /usr/local/var/pyenv/versions/2.7\n```\n\nSwitch to version 2.7 : \n\n```\nmy-laptop:pywinrm me$ pyenv local 2.7\n```\n\nInstall dependencies : \n\n```\nmy-laptop:pywinrm me$ pip install -r requirements-test.txt \nCollecting pytest (from -r requirements-test.txt (line 2))\n  Using cached pytest-3.0.2-py2.py3-none-any.whl\nCollecting pytest-cov (from -r requirements-test.txt (line 3))\n  Using cached pytest_cov-2.3.1-py2.py3-none-any.whl\nCollecting pytest-pep8 (from -r requirements-test.txt (line 4))\n  Using cached pytest-pep8-1.0.6.tar.gz\nCollecting mock (from -r requirements-test.txt (line 5))\n  Using cached mock-2.0.0-py2.py3-none-any.whl\nCollecting py>=1.4.29 (from pytest->-r requirements-test.txt (line 2))\n  Using cached py-1.4.31-py2.py3-none-any.whl\nCollecting coverage>=3.7.1 (from pytest-cov->-r requirements-test.txt (line 3))\n  Using cached coverage-4.2.tar.gz\nCollecting pytest-cache (from pytest-pep8->-r requirements-test.txt (line 4))\n  Using cached pytest-cache-1.0.tar.gz\nCollecting pep8>=1.3 (from pytest-pep8->-r requirements-test.txt (line 4))\n  Using cached pep8-1.7.0-py2.py3-none-any.whl\nCollecting funcsigs>=1; python_version < \"3.3\" (from mock->-r requirements-test.txt (line 5))\n  Using cached funcsigs-1.0.2-py2.py3-none-any.whl\nCollecting pbr>=0.11 (from mock->-r requirements-test.txt (line 5))\n  Using cached pbr-1.10.0-py2.py3-none-any.whl\nCollecting six>=1.9 (from mock->-r requirements-test.txt (line 5))\n  Using cached six-1.10.0-py2.py3-none-any.whl\nCollecting execnet>=1.1.dev1 (from pytest-cache->pytest-pep8->-r requirements-test.txt (line 4))\n  Using cached execnet-1.4.1-py2.py3-none-any.whl\nCollecting apipkg>=1.4 (from execnet>=1.1.dev1->pytest-cache->pytest-pep8->-r requirements-test.txt (line 4))\n  Using cached apipkg-1.4-py2.py3-none-any.whl\nBuilding wheels for collected packages: pytest-pep8, coverage, pytest-cache\n  Running setup.py bdist_wheel for pytest-pep8 ... done\n  Stored in directory: /Users/me/Library/Caches/pip/wheels/18/26/e6/37ad77195c19a94c729fcd7fb3a6dadca805e34568510e4baa\n  Running setup.py bdist_wheel for coverage ... done\n  Stored in directory: /Users/me/Library/Caches/pip/wheels/6f/54/a5/e7629c41b30061b18f0ccbe4be643ed4cf5329f7b2459cf9ae\n  Running setup.py bdist_wheel for pytest-cache ... done\n  Stored in directory: /Users/me/Library/Caches/pip/wheels/6d/22/a3/5b776623c29d057b5a71126cc3d7860ccfb08d5e4c377c3b72\nSuccessfully built pytest-pep8 coverage pytest-cache\nInstalling collected packages: py, pytest, coverage, pytest-cov, apipkg, execnet, pytest-cache, pep8, pytest-pep8, funcsigs, pbr, six, mock\nSuccessfully installed apipkg-1.4 coverage-4.2 execnet-1.4.1 funcsigs-1.0.2 mock-2.0.0 pbr-1.10.0 pep8-1.7.0 py-1.4.31 pytest-3.0.2 pytest-cache-1.0 pytest-cov-2.3.1 pytest-pep8-1.0.6 six-1.10.0\n```\n\nExecute the tests : \n\n```\nmy-laptop:pywinrm me$ py.test \n========================================================================================== test session starts ==========================================================================================\nplatform darwin -- Python 2.7.0, pytest-3.0.2, py-1.4.31, pluggy-0.3.1\nrootdir: /Users/me/Desktop/github/diyan/pywinrm, inifile: setup.cfg\nplugins: cov-2.3.1, pep8-1.0.6\ncollected 0 items / 1 errors \n\n================================================================================================ ERRORS =================================================================================================\n___________________________________________________________________________________________ ERROR collecting  ___________________________________________________________________________________________\n/usr/local/var/pyenv/versions/2.7/lib/python2.7/site-packages/py/_path/common.py:332: in visit\n    for x in Visitor(fil, rec, ignore, bf, sort).gen(self):\n/usr/local/var/pyenv/versions/2.7/lib/python2.7/site-packages/py/_path/common.py:378: in gen\n    for p in self.gen(subdir):\n/usr/local/var/pyenv/versions/2.7/lib/python2.7/site-packages/py/_path/common.py:368: in gen\n    if p.check(dir=1) and (rec is None or rec(p))])\n/usr/local/var/pyenv/versions/2.7/lib/python2.7/site-packages/_pytest/main.py:672: in _recurse\n    ihook = self.gethookproxy(path)\n/usr/local/var/pyenv/versions/2.7/lib/python2.7/site-packages/_pytest/main.py:575: in gethookproxy\n    my_conftestmodules = pm._getconftestmodules(fspath)\n/usr/local/var/pyenv/versions/2.7/lib/python2.7/site-packages/_pytest/config.py:315: in _getconftestmodules\n    mod = self._importconftest(conftestpath)\n/usr/local/var/pyenv/versions/2.7/lib/python2.7/site-packages/_pytest/config.py:340: in _importconftest\n    raise ConftestImportFailure(conftestpath, sys.exc_info())\nE   ConftestImportFailure: ImportError('No module named xmltodict',)\nE     File \"/Users/me/Desktop/github/diyan/pywinrm/winrm/__init__.py\", line 6, in <module>\nE       from winrm.protocol import Protocol\nE     File \"/Users/me/Desktop/github/diyan/pywinrm/winrm/protocol.py\", line 7, in <module>\nE       import xmltodict\n======================================================================================== pytest-warning summary =========================================================================================\nWC1 None [pytest] section in setup.cfg files is deprecated, use [tool:pytest] instead.\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! Interrupted: 1 errors during collection !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n============================================================================== 1 pytest-warnings, 1 error in 0.20 seconds ===============================================================================\n\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/141", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/141/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/141/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/141/events", "html_url": "https://github.com/diyan/pywinrm/issues/141", "id": 179085370, "node_id": "MDU6SXNzdWUxNzkwODUzNzA=", "number": 141, "title": "pywin Session.run_cmd blocked by \"the specified credentials were rejected by the server\"", "user": {"login": "arifismail", "id": 4365258, "node_id": "MDQ6VXNlcjQzNjUyNTg=", "avatar_url": "https://avatars3.githubusercontent.com/u/4365258?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arifismail", "html_url": "https://github.com/arifismail", "followers_url": "https://api.github.com/users/arifismail/followers", "following_url": "https://api.github.com/users/arifismail/following{/other_user}", "gists_url": "https://api.github.com/users/arifismail/gists{/gist_id}", "starred_url": "https://api.github.com/users/arifismail/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arifismail/subscriptions", "organizations_url": "https://api.github.com/users/arifismail/orgs", "repos_url": "https://api.github.com/users/arifismail/repos", "events_url": "https://api.github.com/users/arifismail/events{/privacy}", "received_events_url": "https://api.github.com/users/arifismail/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-09-25T13:08:24Z", "updated_at": "2018-01-12T23:02:41Z", "closed_at": "2018-01-12T23:02:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\nI'm trying to get started with pywinrm but Session.run_cmd() gets blocked by:\n# requests.exceptions.HTTPError: 401 Client Error:  for url: http://<HOSTNAME>:5985/wsman OR \"the specified credentials were rejected by the server\" when handling exception as shown below.\n\nimport winrm\ntry:\n    s = winrm.Session('<REMOTE_WINDOWS_HOSTNAME>', auth=('administrator', '<PASSWORD>'))\n    r = s.run_cmd('ipconfig', ['/all'])\nexcept Exception as e:\n    print (e)\n# \n\nI am using python3.5 on MAC and RHEL 6 and targeting a remote \"Windows Server 2012 Standard\".    The password is correct and the remote windows system does not have NTLM or Kerberos enabled.\n\nUsing a non-administrator account and  \"<windows_host>\\administrator\", and \"administrator@<windows_host>\" didn't help either.  Checking Windows event viewer didn't help either.  Looks like, I'm missing out something very basic.  Any thing to be done on the Windows server?  \n# Here are a few things I checked on the Windows system.\n\nPS C:\\Users\\Administrator> Get-Item WSMan:\\localhost\\Client\\TrustedHosts\n\n   WSManConfig: Microsoft.WSMan.Management\\WSMan::localhost\\Client\n\nType            Name                           SourceOfValue   Value\n\n---\n\nSystem.String   TrustedHosts\n\nPS C:\\Users\\Administrator> Get-Service -ComputerName localhost -Name winrm\n\nStatus   Name               DisplayName\n\n---\n\nRunning  winrm              Windows Remote Management (WS-Manag...\n\nPS C:\\Users\\Administrator> Get-ChildItem WSMan:\\localhost\\Client\\DefaultPorts\n\n   WSManConfig: Microsoft.WSMan.Management\\WSMan::localhost\\Client\\DefaultPorts\n\nType            Name                           SourceOfValue   Value\n\n---\n\nSystem.String   HTTP                                           5985\nSystem.String   HTTPS                                          5986\n\nPS C:\\Users\\Administrator> Get-ChildItem WSMan:\\localhost\\Listener\n\n   WSManConfig: Microsoft.WSMan.Management\\WSMan::localhost\\Listener\n\nType            Keys                                Name\n\n---\n\nContainer       {Transport=HTTP, Address=*}         Listener_1084132640\n# PS C:\\Users\\Administrator>\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/140", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/140/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/140/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/140/events", "html_url": "https://github.com/diyan/pywinrm/issues/140", "id": 178340277, "node_id": "MDU6SXNzdWUxNzgzNDAyNzc=", "number": 140, "title": "Publish sdist package to PyPI?", "user": {"login": "walro", "id": 2550510, "node_id": "MDQ6VXNlcjI1NTA1MTA=", "avatar_url": "https://avatars3.githubusercontent.com/u/2550510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/walro", "html_url": "https://github.com/walro", "followers_url": "https://api.github.com/users/walro/followers", "following_url": "https://api.github.com/users/walro/following{/other_user}", "gists_url": "https://api.github.com/users/walro/gists{/gist_id}", "starred_url": "https://api.github.com/users/walro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/walro/subscriptions", "organizations_url": "https://api.github.com/users/walro/orgs", "repos_url": "https://api.github.com/users/walro/repos", "events_url": "https://api.github.com/users/walro/events{/privacy}", "received_events_url": "https://api.github.com/users/walro/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-09-21T13:02:02Z", "updated_at": "2016-12-21T01:10:30Z", "closed_at": "2016-12-21T01:10:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since version 0.2.0 it seems like there was a switch, when uploading to PyPI, from sdist (.tar.gz) to bdist_wheel (.whl). Would it be possible to publish both versions? To my knowledge [homebrew](https://github.com/Homebrew/homebrew-core) can only handle sdist.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/136", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/136/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/136/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/136/events", "html_url": "https://github.com/diyan/pywinrm/issues/136", "id": 177300056, "node_id": "MDU6SXNzdWUxNzczMDAwNTY=", "number": 136, "title": "python3:  Exception if there is any output on std_err", "user": {"login": "alvaroaleman", "id": 6496100, "node_id": "MDQ6VXNlcjY0OTYxMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/6496100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alvaroaleman", "html_url": "https://github.com/alvaroaleman", "followers_url": "https://api.github.com/users/alvaroaleman/followers", "following_url": "https://api.github.com/users/alvaroaleman/following{/other_user}", "gists_url": "https://api.github.com/users/alvaroaleman/gists{/gist_id}", "starred_url": "https://api.github.com/users/alvaroaleman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alvaroaleman/subscriptions", "organizations_url": "https://api.github.com/users/alvaroaleman/orgs", "repos_url": "https://api.github.com/users/alvaroaleman/repos", "events_url": "https://api.github.com/users/alvaroaleman/events{/privacy}", "received_events_url": "https://api.github.com/users/alvaroaleman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-09-15T21:56:50Z", "updated_at": "2019-05-21T01:45:11Z", "closed_at": "2019-05-21T01:45:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Testscript:\n\n```\n#!/usr/bin/env python3\n\nimport winrm\n\ns = winrm.Session('127.0.0.1:55985', auth=('vagrant', 'vagrant'))\ns.run_ps('asfasf')\n```\n\nResult:\n\n```\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/home/alvaro/.local/lib/python3.5/site-packages/winrm/__init__.py\", line 54, in run_ps\n    rs.std_err = self._clean_error_msg(rs.std_err)\n  File \"/home/alvaro/.local/lib/python3.5/site-packages/winrm/__init__.py\", line 62, in _clean_error_msg\n    if msg.startswith(\"#< CLIXML\\r\\n\"):\nTypeError: startswith first arg must be bytes or a tuple of bytes, not str\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/134", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/134/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/134/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/134/events", "html_url": "https://github.com/diyan/pywinrm/issues/134", "id": 174682447, "node_id": "MDU6SXNzdWUxNzQ2ODI0NDc=", "number": 134, "title": "CredSSP Support", "user": {"login": "jborean93", "id": 8462645, "node_id": "MDQ6VXNlcjg0NjI2NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8462645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jborean93", "html_url": "https://github.com/jborean93", "followers_url": "https://api.github.com/users/jborean93/followers", "following_url": "https://api.github.com/users/jborean93/following{/other_user}", "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}", "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions", "organizations_url": "https://api.github.com/users/jborean93/orgs", "repos_url": "https://api.github.com/users/jborean93/repos", "events_url": "https://api.github.com/users/jborean93/events{/privacy}", "received_events_url": "https://api.github.com/users/jborean93/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-09-02T05:19:10Z", "updated_at": "2016-12-06T22:03:54Z", "closed_at": "2016-12-06T22:03:54Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Hi\n\nI have created a requests-credssp library https://github.com/jborean93/requests-credssp to use with pywinrm for double hop authentication. I have tested it locally with both a domain joined and non domain joined computer and a modified version of pywinrm. Before I raise a pull request to link it to pywinrm I am waiting on a few things before trying to integrate it into pywinrm. \n\nI wanted to get some feedback on the best way to integrate it into pywinrm. Currently it is using NTLM as the auth mechanism in CredSSP but in the future it could support Kerberos. I can either set the transport option to use CredSSP and somehow automatically determine whether to use Kerberos or NTLM if possible. Another option would be to continue to have Kerberos or NTLM as an option but have another option like delegate or delegate-credssp to determine whether to use CredSSP or not. This would work with NTLM but I see that Kerberos already has that option for a Kerberos specific feature.\n\nPlease let me know your thoughts on this.\n\nThanks\n\nJordan\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/133", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/133/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/133/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/133/events", "html_url": "https://github.com/diyan/pywinrm/issues/133", "id": 173921847, "node_id": "MDU6SXNzdWUxNzM5MjE4NDc=", "number": 133, "title": "pip install pywinrm[kerberos]", "user": {"login": "crazy-canux", "id": 14313415, "node_id": "MDQ6VXNlcjE0MzEzNDE1", "avatar_url": "https://avatars0.githubusercontent.com/u/14313415?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crazy-canux", "html_url": "https://github.com/crazy-canux", "followers_url": "https://api.github.com/users/crazy-canux/followers", "following_url": "https://api.github.com/users/crazy-canux/following{/other_user}", "gists_url": "https://api.github.com/users/crazy-canux/gists{/gist_id}", "starred_url": "https://api.github.com/users/crazy-canux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crazy-canux/subscriptions", "organizations_url": "https://api.github.com/users/crazy-canux/orgs", "repos_url": "https://api.github.com/users/crazy-canux/repos", "events_url": "https://api.github.com/users/crazy-canux/events{/privacy}", "received_events_url": "https://api.github.com/users/crazy-canux/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-08-30T03:25:43Z", "updated_at": "2016-09-02T08:33:44Z", "closed_at": "2016-09-02T08:33:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "no matches found: pywinrm[kerberos].\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/129", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/129/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/129/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/129/events", "html_url": "https://github.com/diyan/pywinrm/issues/129", "id": 173384227, "node_id": "MDU6SXNzdWUxNzMzODQyMjc=", "number": 129, "title": "pywinrm with transport=kerberos and AllowUnecrypted = false", "user": {"login": "argaliev", "id": 3026605, "node_id": "MDQ6VXNlcjMwMjY2MDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/3026605?v=4", "gravatar_id": "", "url": "https://api.github.com/users/argaliev", "html_url": "https://github.com/argaliev", "followers_url": "https://api.github.com/users/argaliev/followers", "following_url": "https://api.github.com/users/argaliev/following{/other_user}", "gists_url": "https://api.github.com/users/argaliev/gists{/gist_id}", "starred_url": "https://api.github.com/users/argaliev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/argaliev/subscriptions", "organizations_url": "https://api.github.com/users/argaliev/orgs", "repos_url": "https://api.github.com/users/argaliev/repos", "events_url": "https://api.github.com/users/argaliev/events{/privacy}", "received_events_url": "https://api.github.com/users/argaliev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-08-26T07:07:38Z", "updated_at": "2016-08-26T08:52:17Z", "closed_at": "2016-08-26T08:52:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using pywinrm with kerberos auth method, it works only with configuring option 'AllowUnecrypted=true' on the client. When change option to 'AllowUnecrypted=false', it raise error 500 and event log show message that server receive unencrypted message and it forbidden. So, my question is what happens if 'AllowUnencrypted = false', that pywinrm failed to work?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/128", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/128/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/128/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/128/events", "html_url": "https://github.com/diyan/pywinrm/issues/128", "id": 173120568, "node_id": "MDU6SXNzdWUxNzMxMjA1Njg=", "number": 128, "title": "make call to merge_environment_settings in transport.py depending upon the version imported requests module", "user": {"login": "soumyajuit", "id": 11650135, "node_id": "MDQ6VXNlcjExNjUwMTM1", "avatar_url": "https://avatars1.githubusercontent.com/u/11650135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soumyajuit", "html_url": "https://github.com/soumyajuit", "followers_url": "https://api.github.com/users/soumyajuit/followers", "following_url": "https://api.github.com/users/soumyajuit/following{/other_user}", "gists_url": "https://api.github.com/users/soumyajuit/gists{/gist_id}", "starred_url": "https://api.github.com/users/soumyajuit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soumyajuit/subscriptions", "organizations_url": "https://api.github.com/users/soumyajuit/orgs", "repos_url": "https://api.github.com/users/soumyajuit/repos", "events_url": "https://api.github.com/users/soumyajuit/events{/privacy}", "received_events_url": "https://api.github.com/users/soumyajuit/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-08-25T06:00:28Z", "updated_at": "2016-08-26T03:07:10Z", "closed_at": "2016-08-25T18:09:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\n\nI am using PyWinRM with NTLM authentication for development. Following are my environment settings.\n\ni) Scientific Linux 2.6.32\nii) Python 2.7.3\niii) requests 2.2.0\n\nNow I am facing an issue w.r.t interaction between PyWinRM and requests library. There is call \"merge_environment_settings()\" in transport.py:120 . This function does not exists in the lower versions ( < 2.4.1) of requests package. Now I can't upgrade neither python nor requests package. Because requests package is used by various other modules and if I upgrade requests package then several other modules (which aren't owned by me) will start seeing \"Insecure*Warnings\"[https://urllib3.readthedocs.io/en/latest/user-guide.html] which would make others uncomfortable. \n\nSo here is my ask, \"Is it worth to add a check for the requests module's version before  the function call (mentioned above)  in transport.py\". Thanks in advance.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/127", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/127/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/127/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/127/events", "html_url": "https://github.com/diyan/pywinrm/issues/127", "id": 172463852, "node_id": "MDU6SXNzdWUxNzI0NjM4NTI=", "number": 127, "title": "NTLM Encrypted Traffic Support", "user": {"login": "jborean93", "id": 8462645, "node_id": "MDQ6VXNlcjg0NjI2NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8462645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jborean93", "html_url": "https://github.com/jborean93", "followers_url": "https://api.github.com/users/jborean93/followers", "following_url": "https://api.github.com/users/jborean93/following{/other_user}", "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}", "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions", "organizations_url": "https://api.github.com/users/jborean93/orgs", "repos_url": "https://api.github.com/users/jborean93/repos", "events_url": "https://api.github.com/users/jborean93/events{/privacy}", "received_events_url": "https://api.github.com/users/jborean93/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-08-22T14:16:09Z", "updated_at": "2018-01-12T23:02:05Z", "closed_at": "2018-01-12T23:02:05Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "I have been successful in implementing signing and sealing support for NTLM to allow encrypted traffic through both HTTP and HTTPS otherwise known as SPEGNO. The pull request is still waiting for approval with python-ntlm3 for this support to be readily available to use in pywinrm but in the meantime I have made some very rough modifications to enable encryption support in pywinrm for NTLM.\n\nBefore I go about making some more changes I wanted to get some feedback on how it should be implemented. If signing and sealing have been negotiated during the NTLM handshake python-ntlm3 should make an object called session_security available which has 2 methods, wrap and unwrap (https://github.com/jborean93/python-ntlm3/blob/master/ntlm3/session_security.py). Due to the encryption structure being application specific (https://msdn.microsoft.com/en-us/library/cc251575.aspx) I feel this should not be done in requests-ntlm rather in this library but I am struggling to find a good way to implement this.\n\nThe rough modifications I have made are in send_message in transport.py (they probably should be elsewhere) but here it is;\n\n```\nif self.session_security is not None:\n    new_message, signature = self.session_security.wrap(message)\n\n    new_body = '--Encrypted Boundary\\r\\n'.encode('utf-8')\n    new_body += '\\tContent-Type: application/HTTP-SPNEGO-session-encrypted\\r\\n'.encode('utf-8')\n    new_body += '\\tOriginalContent: type=application/soap+xml;charset=UTF-8;Length='.encode('utf-8') + str(len(message)) + '\\r\\n'.encode('utf-8')\n    new_body += '--Encrypted Boundary\\r\\n'.encode('utf-8')\n    new_body += '\\tContent-Type: application/octet-stream\\r\\n'.encode('utf-8')\n    new_body += struct.pack(\"<i\", len(signature))\n    new_body += signature\n    new_body += new_message\n    new_body += '--Encrypted Boundary\\r\\n'.encode('utf-8')\n\n    request = requests.Request('POST', self.endpoint, data=new_body)\n    prepared_request = self.session.prepare_request(request)\n    prepared_request.headers['Content-Length'.encode('ascii')] = str(len(prepared_request.body)).encode('ascii')\n    prepared_request.headers['Content-Type'.encode('ascii')] = 'multipart/encrypted;protocol=\"application/HTTP-SPNEGO-session-encrypted\";boundary=\"Encrypted Boundary\"'.encode('ascii')\nelse:\n    request = requests.Request('POST', self.endpoint, data=message)\n    prepared_request = self.session.prepare_request(request)\n\ntry:\n    response = self.session.send(prepared_request, timeout=self.read_timeout_sec)\n    response_text = response.text\n\n    if self.session_security is None:\n        self.session_security = self.session.auth.session_security\n\n    response_content_type = response.headers['Content-Type'].split(';')\n\n    if 'protocol=\"application/HTTP-SPNEGO-session-encrypted\"' in response_content_type:\n        encrypted_parts = response.content.split('--Encrypted Boundary\\r\\n'.encode('utf-8'))\n        expected_length = int(encrypted_parts[1].split(';Length='.encode('utf-8'))[1].strip())\n        encrypted_data = encrypted_parts[2].split('application/octet-stream\\r\\n'.encode('utf-8'))[1]\n        signature_length = struct.unpack(\"<i\", encrypted_data[:4])[0]\n        signature = encrypted_data[4:signature_length + 4]\n        encrypted_message = encrypted_data[signature_length + 4:len(encrypted_data) - len('--Encrypted Boundary'.encode('utf-8')) - 4]\n\n        response_text = self.session_security.unwrap(encrypted_message, signature)\n        actual_length = len(response_text)\n\n        if actual_length != expected_length:\n           raise Exception(\"Encrypted length from server does not match the expected size, message has been tampered with\")\n\n    response.raise_for_status()\n    return response_text\nexcept requests.HTTPError as ex:\n```\n\nHopefully you can see, in the example pywinrm is then getting the session_security object to sign/seal and verify/unseal the message contents and using that value to create the encryption structure set out in MS-WSMV. This will obviously need to go elsewhere in pywinrm and made more generic to support both Kerberos and CredSSP encryption when they are supported in the future.\n\nOne the pull request to python-ntlm3 is approved I will get started and raise a pull request to add this support. In the meantime I am hoping the main contributors would have some suggestions or ideas how this should be implemented.\n\nThanks\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/126", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/126/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/126/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/126/events", "html_url": "https://github.com/diyan/pywinrm/issues/126", "id": 172380251, "node_id": "MDU6SXNzdWUxNzIzODAyNTE=", "number": 126, "title": "Cleanup documentation on what is supported", "user": {"login": "jborean93", "id": 8462645, "node_id": "MDQ6VXNlcjg0NjI2NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8462645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jborean93", "html_url": "https://github.com/jborean93", "followers_url": "https://api.github.com/users/jborean93/followers", "following_url": "https://api.github.com/users/jborean93/following{/other_user}", "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}", "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions", "organizations_url": "https://api.github.com/users/jborean93/orgs", "repos_url": "https://api.github.com/users/jborean93/repos", "events_url": "https://api.github.com/users/jborean93/events{/privacy}", "received_events_url": "https://api.github.com/users/jborean93/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-08-22T06:47:28Z", "updated_at": "2016-12-06T22:03:32Z", "closed_at": "2016-12-06T22:03:32Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "I want to take a crack at cleaning up the README to cover what is and isn't supported. There have been a few issue pop up over questions that could hopefully be covered by this. Does anyone have an objections over this, I will raise a pull request if there isn't.\n\nI was also hoping to clarify some of the transport options in this, we current have 6;\n- kerberos (Kerberos authentication)\n- certificate (Certificate authentication)\n- ssl (Either Certificate or basic over SSL depending on the cert_pem and cert_key_pem params)\n- ntlm (NTLM authentication)\n- plaintext (basic over http)\n- basic (basic)\n\nI feel like this should be separated into the following 4 options instead and move the HTTPS or HTTP option outside of this parameter (use the target param exclusively)\n- kerberos\n- certificate\n- ntlm\n- basic\n  This way it lines up with the winrm options, we don't have overlap like plaintext and basic and we don't have complex if statements like we do under build_session.\n\nIf you wish me to just document it as it is I am happy to and I can leave the transport options alone.\n\nThanks\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/121", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/121/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/121/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/121/events", "html_url": "https://github.com/diyan/pywinrm/issues/121", "id": 169309206, "node_id": "MDU6SXNzdWUxNjkzMDkyMDY=", "number": 121, "title": "NTLM transport not supported in winrmsession", "user": {"login": "LeoQuote", "id": 4143818, "node_id": "MDQ6VXNlcjQxNDM4MTg=", "avatar_url": "https://avatars3.githubusercontent.com/u/4143818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeoQuote", "html_url": "https://github.com/LeoQuote", "followers_url": "https://api.github.com/users/LeoQuote/followers", "following_url": "https://api.github.com/users/LeoQuote/following{/other_user}", "gists_url": "https://api.github.com/users/LeoQuote/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeoQuote/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeoQuote/subscriptions", "organizations_url": "https://api.github.com/users/LeoQuote/orgs", "repos_url": "https://api.github.com/users/LeoQuote/repos", "events_url": "https://api.github.com/users/LeoQuote/events{/privacy}", "received_events_url": "https://api.github.com/users/LeoQuote/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 803247315, "node_id": "MDU6TGFiZWw4MDMyNDczMTU=", "url": "https://api.github.com/repos/diyan/pywinrm/labels/high_level_api", "name": "high_level_api", "color": "b60205", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-08-04T07:30:27Z", "updated_at": "2019-06-24T19:42:46Z", "closed_at": "2019-06-24T19:42:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I just simply edit the `__init__.py` and it works, I'll create a pull request later\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/120", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/120/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/120/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/120/events", "html_url": "https://github.com/diyan/pywinrm/issues/120", "id": 168307499, "node_id": "MDU6SXNzdWUxNjgzMDc0OTk=", "number": 120, "title": "Why the program is no-response?", "user": {"login": "fcxjluo", "id": 11330107, "node_id": "MDQ6VXNlcjExMzMwMTA3", "avatar_url": "https://avatars1.githubusercontent.com/u/11330107?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fcxjluo", "html_url": "https://github.com/fcxjluo", "followers_url": "https://api.github.com/users/fcxjluo/followers", "following_url": "https://api.github.com/users/fcxjluo/following{/other_user}", "gists_url": "https://api.github.com/users/fcxjluo/gists{/gist_id}", "starred_url": "https://api.github.com/users/fcxjluo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fcxjluo/subscriptions", "organizations_url": "https://api.github.com/users/fcxjluo/orgs", "repos_url": "https://api.github.com/users/fcxjluo/repos", "events_url": "https://api.github.com/users/fcxjluo/events{/privacy}", "received_events_url": "https://api.github.com/users/fcxjluo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-07-29T11:44:27Z", "updated_at": "2018-01-12T22:57:14Z", "closed_at": "2018-01-12T22:57:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "I exec a .bat ,and the .bat runs  a monitoring program\u3002The py is no-response\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/119", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/119/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/119/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/119/events", "html_url": "https://github.com/diyan/pywinrm/issues/119", "id": 168122655, "node_id": "MDU6SXNzdWUxNjgxMjI2NTU=", "number": 119, "title": "ssl: auth method ssl requires a password", "user": {"login": "arunjohn", "id": 7934886, "node_id": "MDQ6VXNlcjc5MzQ4ODY=", "avatar_url": "https://avatars3.githubusercontent.com/u/7934886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arunjohn", "html_url": "https://github.com/arunjohn", "followers_url": "https://api.github.com/users/arunjohn/followers", "following_url": "https://api.github.com/users/arunjohn/following{/other_user}", "gists_url": "https://api.github.com/users/arunjohn/gists{/gist_id}", "starred_url": "https://api.github.com/users/arunjohn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arunjohn/subscriptions", "organizations_url": "https://api.github.com/users/arunjohn/orgs", "repos_url": "https://api.github.com/users/arunjohn/repos", "events_url": "https://api.github.com/users/arunjohn/events{/privacy}", "received_events_url": "https://api.github.com/users/arunjohn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-07-28T15:19:04Z", "updated_at": "2016-08-04T21:37:27Z", "closed_at": "2016-08-04T21:37:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "ssl: auth method ssl requires a password \n\n<!--- Verify first that your issue/request is not already reported in GitHub -->\n##### ISSUE TYPE\n\n<!--- Pick one below and delete the rest: -->\n- Bug Report\n##### ANSIBLE VERSION\n\n<!--- Paste verbatim output from \u201cansible --version\u201d between quotes below -->\n\n```\n ansible --version\nansible 2.1.0.0\n\n```\n##### CONFIGURATION\n\n<!---\nMention any settings you have changed/added/removed in ansible.cfg\n(or using the ANSIBLE_* environment variables).\n-->\n##### OS / ENVIRONMENT\n\n<!---\nubuntu\n-->\n##### SUMMARY\n\nWhile trying to connect to a windows VM through Ansible I get this error:\n\nTASK [setup] *******************************************************************\n<10.xx.xx.xx> ESTABLISH WINRM CONNECTION FOR USER: winad-admin on PORT 5986 TO 10.xx.xx.xx\nfatal: [10.xx.xx.xx]: UNREACHABLE! => {\"changed\": false, \"msg\": \"ssl: auth method ssl requires a password\", \"unreachable\": true}\n##### STEPS TO REPRODUCE\n\nWhile trying to connect to a windows VM through Ansible I get this error:\n\nTASK [setup] *******************************************************************\n<10.xx.xx.xx> ESTABLISH WINRM CONNECTION FOR USER: winad-admin on PORT 5986 TO 10.xx.xx.xx\nfatal: [10.xx.xx.xx]: UNREACHABLE! => {\"changed\": false, \"msg\": \"ssl: auth method ssl requires a password\", \"unreachable\": true}\n\n---\n\nInventory file :\n\n---hosts---\n\n```\n[win_servers]\n10.xx.xx.xx\n\n[nonprod1_ad_servers:vars]\nansible_user=administrator\nansible_pass=Horse@1234\nansible_port=5986\nansible_connection=winrm\nansible_winrm_server_cert_validation=ignore\n\n```\n\n---\n\nAnd the powershell script used to enable winrm on the windows machine is as follows:\n\n---\n\n```\nParam (\n    [string]$SubjectName = $env:COMPUTERNAME,\n    [int]$CertValidityDays = 365,\n    [switch]$SkipNetworkProfileCheck = $true,\n    $CreateSelfSignedCert = $true,\n    [switch]$ForceNewSSLCert = $true,\n    $VerbosePreference = \"Continue\"\n)\n\nFunction New-LegacySelfSignedCert\n{\n    Param (\n        [string]$SubjectName,\n        [int]$ValidDays = 365\n    )\n\n    $name = New-Object -COM \"X509Enrollment.CX500DistinguishedName.1\"\n    $name.Encode(\"CN=$SubjectName\", 0)\n\n    $key = New-Object -COM \"X509Enrollment.CX509PrivateKey.1\"\n    $key.ProviderName = \"Microsoft RSA SChannel Cryptographic Provider\"\n    $key.KeySpec = 1\n    $key.Length = 1024\n    $key.SecurityDescriptor = \"D:PAI(A;;0xd01f01ff;;;SY)(A;;0xd01f01ff;;;BA)(A;;0x80120089;;;NS)\"\n    $key.MachineContext = 1\n    $key.Create()\n\n    $serverauthoid = New-Object -COM \"X509Enrollment.CObjectId.1\"\n    $serverauthoid.InitializeFromValue(\"1.3.6.1.5.5.7.3.1\")\n    $ekuoids = New-Object -COM \"X509Enrollment.CObjectIds.1\"\n    $ekuoids.Add($serverauthoid)\n    $ekuext = New-Object -COM \"X509Enrollment.CX509ExtensionEnhancedKeyUsage.1\"\n    $ekuext.InitializeEncode($ekuoids)\n\n    $cert = New-Object -COM \"X509Enrollment.CX509CertificateRequestCertificate.1\"\n    $cert.InitializeFromPrivateKey(2, $key, \"\")\n    $cert.Subject = $name\n    $cert.Issuer = $cert.Subject\n    $cert.NotBefore = (Get-Date).AddDays(-1)\n    $cert.NotAfter = $cert.NotBefore.AddDays($ValidDays)\n    $cert.X509Extensions.Add($ekuext)\n    $cert.Encode()\n\n    $enrollment = New-Object -COM \"X509Enrollment.CX509Enrollment.1\"\n    $enrollment.InitializeFromRequest($cert)\n    $certdata = $enrollment.CreateRequest(0)\n    $enrollment.InstallResponse(2, $certdata, 0, \"\")\n\n    # Return the thumbprint of the last installed certificate;\n    # This is needed for the new HTTPS WinRM listerner we're\n    # going to create further down.\n    Get-ChildItem \"Cert:\\LocalMachine\\my\"| Sort-Object NotBefore -Descending | Select -First 1 | Select -Expand Thumbprint\n}\n\n# Setup error handling.\nTrap\n{\n    $_\n    Exit 1\n}\n$ErrorActionPreference = \"Stop\"\n\n# Detect PowerShell version.\nIf ($PSVersionTable.PSVersion.Major -lt 3)\n{\n    Throw \"PowerShell version 3 or higher is required.\"\n}\n\n# Find and start the WinRM service.\nWrite-Verbose \"Verifying WinRM service.\"\nIf (!(Get-Service \"WinRM\"))\n{\n    Throw \"Unable to find the WinRM service.\"\n}\nElseIf ((Get-Service \"WinRM\").Status -ne \"Running\")\n{\n    Write-Verbose \"Starting WinRM service.\"\n    Start-Service -Name \"WinRM\" -ErrorAction Stop\n}\n\n# WinRM should be running; check that we have a PS session config.\nIf (!(Get-PSSessionConfiguration -Verbose:$false) -or (!(Get-ChildItem WSMan:\\localhost\\Listener)))\n{\n  if ($SkipNetworkProfileCheck) {\n    Write-Verbose \"Enabling PS Remoting without checking Network profile.\"\n    Enable-PSRemoting -SkipNetworkProfileCheck -Force -ErrorAction Stop\n  }\n  else {\n    Write-Verbose \"Enabling PS Remoting\"\n    Enable-PSRemoting -Force -ErrorAction Stop\n  }\n}\nElse\n{\n    Write-Verbose \"PS Remoting is already enabled.\"\n}\n\n# Make sure there is a SSL listener.\n$listeners = Get-ChildItem WSMan:\\localhost\\Listener\nIf (!($listeners | Where {$_.Keys -like \"TRANSPORT=HTTPS\"}))\n{\n    # HTTPS-based endpoint does not exist.\n    If (Get-Command \"New-SelfSignedCertificate\" -ErrorAction SilentlyContinue)\n    {\n        $cert = New-SelfSignedCertificate -DnsName $SubjectName -CertStoreLocation \"Cert:\\LocalMachine\\My\"\n        $thumbprint = $cert.Thumbprint\n        Write-Host \"Self-signed SSL certificate generated; thumbprint: $thumbprint\"\n    }\n    Else\n    {\n        $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName\n        Write-Host \"(Legacy) Self-signed SSL certificate generated; thumbprint: $thumbprint\"\n    }\n\n    # Create the hashtables of settings to be used.\n    $valueset = @{}\n    $valueset.Add('Hostname', $SubjectName)\n    $valueset.Add('CertificateThumbprint', $thumbprint)\n\n    $selectorset = @{}\n    $selectorset.Add('Transport', 'HTTPS')\n    $selectorset.Add('Address', '*')\n\n    Write-Verbose \"Enabling SSL listener.\"\n    New-WSManInstance -ResourceURI 'winrm/config/Listener' -SelectorSet $selectorset -ValueSet $valueset\n}\nElse\n{\n    Write-Verbose \"SSL listener is already active.\"\n\n    # Force a new SSL cert on Listener if the $ForceNewSSLCert\n    if($ForceNewSSLCert){\n\n        # Create the new cert.\n        If (Get-Command \"New-SelfSignedCertificate\" -ErrorAction SilentlyContinue)\n        {\n            $cert = New-SelfSignedCertificate -DnsName $SubjectName -CertStoreLocation \"Cert:\\LocalMachine\\My\"\n            $thumbprint = $cert.Thumbprint\n            Write-Host \"Self-signed SSL certificate generated; thumbprint: $thumbprint\"\n        }\n        Else\n        {\n            $thumbprint = New-LegacySelfSignedCert -SubjectName $SubjectName\n            Write-Host \"(Legacy) Self-signed SSL certificate generated; thumbprint: $thumbprint\"\n        }\n\n        $valueset = @{}\n        $valueset.Add('Hostname', $SubjectName)\n        $valueset.Add('CertificateThumbprint', $thumbprint)\n\n        # Delete the listener for SSL\n        $selectorset = @{}\n        $selectorset.Add('Transport', 'HTTPS')\n        $selectorset.Add('Address', '*')\n        Remove-WSManInstance -ResourceURI 'winrm/config/Listener' -SelectorSet $selectorset\n\n        # Add new Listener with new SSL cert\n        New-WSManInstance -ResourceURI 'winrm/config/Listener' -SelectorSet $selectorset -ValueSet $valueset\n    }\n}\n\n# Check for basic authentication.\n$basicAuthSetting = Get-ChildItem WSMan:\\localhost\\Service\\Auth | Where {$_.Name -eq \"Basic\"}\nIf (($basicAuthSetting.Value) -eq $false)\n{\n    Write-Verbose \"Enabling basic auth support.\"\n    Set-Item -Path \"WSMan:\\localhost\\Service\\Auth\\Basic\" -Value $true\n}\nElse\n{\n    Write-Verbose \"Basic auth is already enabled.\"\n}\n\n# Configure firewall to allow WinRM HTTPS connections.\n$fwtest1 = netsh advfirewall firewall show rule name=\"Allow WinRM HTTPS\"\n$fwtest2 = netsh advfirewall firewall show rule name=\"Allow WinRM HTTPS\" profile=any\nIf ($fwtest1.count -lt 5)\n{\n    Write-Verbose \"Adding firewall rule to allow WinRM HTTPS.\"\n    netsh advfirewall firewall add rule profile=any name=\"Allow WinRM HTTPS\" dir=in localport=5986 protocol=TCP action=allow\n}\nElseIf (($fwtest1.count -ge 5) -and ($fwtest2.count -lt 5))\n{\n    Write-Verbose \"Updating firewall rule to allow WinRM HTTPS for any profile.\"\n    netsh advfirewall firewall set rule name=\"Allow WinRM HTTPS\" new profile=any\n}\nElse\n{\n    Write-Verbose \"Firewall rule already exists to allow WinRM HTTPS.\"\n}\n\n# Test a remoting connection to localhost, which should work.\n$httpResult = Invoke-Command -ComputerName \"localhost\" -ScriptBlock {$env:COMPUTERNAME} -ErrorVariable httpError -ErrorAction SilentlyContinue\n$httpsOptions = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck\n\n$httpsResult = New-PSSession -UseSSL -ComputerName \"localhost\" -SessionOption $httpsOptions -ErrorVariable httpsError -ErrorAction SilentlyContinue\n\nIf ($httpResult -and $httpsResult)\n{\n    Write-Verbose \"HTTP: Enabled | HTTPS: Enabled\"\n}\nElseIf ($httpsResult -and !$httpResult)\n{\n    Write-Verbose \"HTTP: Disabled | HTTPS: Enabled\"\n}\nElseIf ($httpResult -and !$httpsResult)\n{\n    Write-Verbose \"HTTP: Enabled | HTTPS: Disabled\"\n}\nElse\n{\n    Throw \"Unable to establish an HTTP or HTTPS remoting session.\"\n}\nWrite-Verbose \"PS Remoting has been successfully configured for Ansible.\"\n\n\n```\n##### EXPECTED RESULTS\n\nTASK [setup] *******************************************************************\nok: [10.xx.xx.xx]\n##### ACTUAL RESULTS\n\nTASK [setup] *******************************************************************\n<10.xx.xx.xx> ESTABLISH WINRM CONNECTION FOR USER: winad-admin on PORT 5986 TO 10.xx.xx.xx\nfatal: [10.xx.xx.xx]: UNREACHABLE! => {\"changed\": false, \"msg\": \"ssl: auth method ssl requires a password\", \"unreachable\": true}\n\n```\n\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/118", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/118/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/118/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/118/events", "html_url": "https://github.com/diyan/pywinrm/issues/118", "id": 167825636, "node_id": "MDU6SXNzdWUxNjc4MjU2MzY=", "number": 118, "title": "How to do SPNEGO/sspinegotiate?", "user": {"login": "superonduper", "id": 19823612, "node_id": "MDQ6VXNlcjE5ODIzNjEy", "avatar_url": "https://avatars0.githubusercontent.com/u/19823612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/superonduper", "html_url": "https://github.com/superonduper", "followers_url": "https://api.github.com/users/superonduper/followers", "following_url": "https://api.github.com/users/superonduper/following{/other_user}", "gists_url": "https://api.github.com/users/superonduper/gists{/gist_id}", "starred_url": "https://api.github.com/users/superonduper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/superonduper/subscriptions", "organizations_url": "https://api.github.com/users/superonduper/orgs", "repos_url": "https://api.github.com/users/superonduper/repos", "events_url": "https://api.github.com/users/superonduper/events{/privacy}", "received_events_url": "https://api.github.com/users/superonduper/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-07-27T10:50:38Z", "updated_at": "2016-08-10T18:51:21Z", "closed_at": "2016-08-10T18:51:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Gents,\n\nBackground: I'm making an application that must be able to execute remote powershell, **without requiring the user to make changes to the remote windows machine** (other than \"AllowRemoteAccess = true\" obviously). The application is running on an Ubuntu box that is not joined to the domain.\n\nI made a wrongful assumption that \"AllowUnencrypted = false\" meant I have to use the HTTPS protocol, when in fact it means \"use SPNEGO/sspinegotiate\" with kerberos or ntlm.\n\nSo my question is, does pywinrm support SPNEGO/sspinegotiate? and how to use it?\n\nOut of the box, in a domain environment the remote setup looks like this.\n\nPS C:\\Users\\administrator> winrm e winrm/config/listener\nListener\n    Address = *\n    Transport = HTTP\n    Port = 5985\n    Hostname\n    Enabled = true\n    URLPrefix = wsman\n    CertificateThumbprint\n    ListeningOn = 127.0.0.1, 192.168.200.210, ::1, fe80::5efe:192.168.200.210%13, fe80::6856:b486:4058:b477%12\n\nPS C:\\Users\\administrator> winrm get winrm/config/service\nService\n    RootSDDL = O:NSG:BAD:P(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)\n    MaxConcurrentOperations = 4294967295\n    MaxConcurrentOperationsPerUser = 1500\n    EnumerationTimeoutms = 240000\n    MaxConnections = 300\n    MaxPacketRetrievalTimeSeconds = 120\n    AllowUnencrypted = false\n    Auth\n        Basic = false\n        Kerberos = true\n        Negotiate = true\n        Certificate = false\n        CredSSP = false\n        CbtHardeningLevel = Relaxed\n    DefaultPorts\n        HTTP = 5985\n        HTTPS = 5986\n    IPv4Filter = *\n    IPv6Filter = *\n    EnableCompatibilityHttpListener = false\n    EnableCompatibilityHttpsListener = false\n    CertificateThumbprint\n    AllowRemoteAccess = true\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/117", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/117/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/117/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/117/events", "html_url": "https://github.com/diyan/pywinrm/issues/117", "id": 167455676, "node_id": "MDU6SXNzdWUxNjc0NTU2NzY=", "number": 117, "title": "HTTPS.. how to? clues? documentation?", "user": {"login": "superonduper", "id": 19823612, "node_id": "MDQ6VXNlcjE5ODIzNjEy", "avatar_url": "https://avatars0.githubusercontent.com/u/19823612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/superonduper", "html_url": "https://github.com/superonduper", "followers_url": "https://api.github.com/users/superonduper/followers", "following_url": "https://api.github.com/users/superonduper/following{/other_user}", "gists_url": "https://api.github.com/users/superonduper/gists{/gist_id}", "starred_url": "https://api.github.com/users/superonduper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/superonduper/subscriptions", "organizations_url": "https://api.github.com/users/superonduper/orgs", "repos_url": "https://api.github.com/users/superonduper/repos", "events_url": "https://api.github.com/users/superonduper/events{/privacy}", "received_events_url": "https://api.github.com/users/superonduper/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-07-25T20:18:19Z", "updated_at": "2016-07-27T10:20:05Z", "closed_at": "2016-07-27T10:20:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "Gents,\n\nI can't seem to find any examples of pywinrm using HTTPS, and reading the source code doesn't give me any clues off hand (python is outside my comfort zone).\n\nWhat works so far on my ubuntu 16.04 is kerberos authentication, with AllowUnencrypted=\"true\" on the remote windows, but using HTTPS (AllowUnencrypted=\"false\") it just times out after the default 30 secs.\n\nI can successfully get a valid kerberos ticket, I have cert and key for the windows domain user in PEM format, and I can successfully create a keytab file.\n\nBUT I have no clue how to use the correct parameters to get a powershell session with HTTPS, I have experimented a couple of hours, but no cigar, could anyone be so kind and give some working examples? or clues?\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/114", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/114/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/114/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/114/events", "html_url": "https://github.com/diyan/pywinrm/issues/114", "id": 163159438, "node_id": "MDU6SXNzdWUxNjMxNTk0Mzg=", "number": 114, "title": "WinRM - the specified credentials were rejected by the server", "user": {"login": "vikas027", "id": 6998650, "node_id": "MDQ6VXNlcjY5OTg2NTA=", "avatar_url": "https://avatars1.githubusercontent.com/u/6998650?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vikas027", "html_url": "https://github.com/vikas027", "followers_url": "https://api.github.com/users/vikas027/followers", "following_url": "https://api.github.com/users/vikas027/following{/other_user}", "gists_url": "https://api.github.com/users/vikas027/gists{/gist_id}", "starred_url": "https://api.github.com/users/vikas027/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vikas027/subscriptions", "organizations_url": "https://api.github.com/users/vikas027/orgs", "repos_url": "https://api.github.com/users/vikas027/repos", "events_url": "https://api.github.com/users/vikas027/events{/privacy}", "received_events_url": "https://api.github.com/users/vikas027/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2016-06-30T13:00:01Z", "updated_at": "2020-07-31T08:39:46Z", "closed_at": "2016-07-06T03:42:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am unable to get WinRM session in a python script.\n## Environment\n\n```\nad-dns.test.com    - Windows 2012 AD and DNS Server\nbox88.test.com     - CentOS 7.2 : Kerberos, Python (Not joined to domain)\nbox62.test.com     - Windows 2012 R2 Standard (Joined to domain)\nbox63.test.com     - Windows 10 (Joined to domain)\n```\n\n---\n## Configurations\n\nI have enabled WinRM on Windows 10 and 2012 server through [ConfigureRemotingForAnsible.ps1](https://github.com/ansible/ansible/blob/devel/examples/scripts/ConfigureRemotingForAnsible.ps1) PowerShell script. These are the WinRM configurations.\n\n```\nPS C:\\Windows\\system32> winrm get winrm/config\nConfig\n    MaxEnvelopeSizekb = 500\n    MaxTimeoutms = 60000\n    MaxBatchItems = 32000\n    MaxProviderRequests = 4294967295\n    Client\n        NetworkDelayms = 5000\n        URLPrefix = wsman\n        AllowUnencrypted = false\n        Auth\n            Basic = true\n            Digest = true\n            Kerberos = true\n            Negotiate = true\n            Certificate = true\n            CredSSP = false\n        DefaultPorts\n            HTTP = 5985\n            HTTPS = 5986\n        TrustedHosts = *\n    Service\n        RootSDDL = O:NSG:BAD:P(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)\n        MaxConcurrentOperations = 4294967295\n        MaxConcurrentOperationsPerUser = 1500\n        EnumerationTimeoutms = 240000\n        MaxConnections = 300\n        MaxPacketRetrievalTimeSeconds = 120\n        AllowUnencrypted = false\n        Auth\n            Basic = true\n            Kerberos = true\n            Negotiate = true\n            Certificate = false\n            CredSSP = false\n            CbtHardeningLevel = Relaxed\n        DefaultPorts\n            HTTP = 5985\n            HTTPS = 5986\n        IPv4Filter = *\n        IPv6Filter = *\n        EnableCompatibilityHttpListener = false\n        EnableCompatibilityHttpsListener = false\n        CertificateThumbprint\n        AllowRemoteAccess = true\n    Winrs\n        AllowRemoteShellAccess = true\n        IdleTimeout = 7200000\n        MaxConcurrentUsers = 10\n        MaxShellRunTime = 2147483647\n        MaxProcessesPerShell = 25\n        MaxMemoryPerShellMB = 1024\n        MaxShellsPerUser = 30\nPS C:\\Windows\\system32> \n```\n\nI have prepared CentOS box as below\n\n```\n# yum -y install python-pip python-devel krb5-devel krb5-libs krb5-workstation\n# pip install --upgrade pip\n# pip install  \"pywinrm>=0.1.1\" kerberos pykerberos requests-kerberos isodate xmltodict\n\n# cat /etc/krb5.conf\n[libdefaults]\n default_realm = TEST.COM\n\n[realms]\n TEST.COM = {\n  kdc = ad-dns.test.com\n  admin_server   = ad-dns.test.com\n  kpasswd_server = ad-dns.test.com\n  default_domain = test.com\n }\n\n[domain_realm]\n .test.com = TEST.COM\n test.com = TEST.COM\n#\n\n# kinit vkumar@TEST.COM\nPassword for vkumar@TEST.COM:\n# klist\nTicket cache: FILE:/tmp/krb5cc_0\nDefault principal: vkumar@TEST.COM\n\nValid starting       Expires              Service principal\n2016-06-30T02:15:20  2016-06-30T12:15:20  krbtgt/TEST.COM@TEST.COM\n    renew until 2016-07-01T02:15:16\n#\n```\n## Problem\n\nUntil now, everything appears smooth. The problem occurs when I try to use this kerberos ticket to authenticate the Windows servers using the below script.\n\n```\n#!/usr/bin/env python\n\nimport winrm\n\ns = winrm.Session('box63.test.com', auth=('vkumar@TEST.COM', 'IamUsingKerbTicket'), transport='kerberos')\nr = s.run_cmd('ipconfig', ['/all'])\nprint r.status_code\nprint r.std_out\nprint r.std_err\n\n\n# ./winrm_ipconfig.py\nTraceback (most recent call last):\n  File \"./winrm_ipconfig.py\", line 6, in <module>\n    r = s.run_cmd('ipconfig', ['/all'])\n  File \"/usr/lib/python2.7/site-packages/winrm/__init__.py\", line 37, in run_cmd\n    shell_id = self.protocol.open_shell()\n  File \"/usr/lib/python2.7/site-packages/winrm/protocol.py\", line 132, in open_shell\n    res = self.send_message(xmltodict.unparse(req))\n  File \"/usr/lib/python2.7/site-packages/winrm/protocol.py\", line 207, in send_message\n    return self.transport.send_message(message)\n  File \"/usr/lib/python2.7/site-packages/winrm/transport.py\", line 179, in send_message\n    raise InvalidCredentialsError(\"the specified credentials were rejected by the server\")\nwinrm.exceptions.InvalidCredentialsError: the specified credentials were rejected by the server\n#\n```\n\nNot sure, why I see this error while `Event Logs` on Windows server show success. Apparently, I see three `Logon` and `Logoff` occurring at the same time. \n[![Windows_Event_Logs](http://i.stack.imgur.com/C520p.png)](http://i.stack.imgur.com/C520p.png)\n\nNot sure what I am missing here. Firewall is stopped/disabled on both CentOS & Windows machines and times are also in sync.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/113", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/113/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/113/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/113/events", "html_url": "https://github.com/diyan/pywinrm/issues/113", "id": 162181436, "node_id": "MDU6SXNzdWUxNjIxODE0MzY=", "number": 113, "title": "Windows:Powershell: arrays handled correctly", "user": {"login": "jelep", "id": 8484066, "node_id": "MDQ6VXNlcjg0ODQwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/8484066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jelep", "html_url": "https://github.com/jelep", "followers_url": "https://api.github.com/users/jelep/followers", "following_url": "https://api.github.com/users/jelep/following{/other_user}", "gists_url": "https://api.github.com/users/jelep/gists{/gist_id}", "starred_url": "https://api.github.com/users/jelep/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jelep/subscriptions", "organizations_url": "https://api.github.com/users/jelep/orgs", "repos_url": "https://api.github.com/users/jelep/repos", "events_url": "https://api.github.com/users/jelep/events{/privacy}", "received_events_url": "https://api.github.com/users/jelep/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-06-24T16:16:58Z", "updated_at": "2016-06-24T19:17:22Z", "closed_at": "2016-06-24T19:17:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi all,\nconsider the following\n## variable is set in ansible containing a list\n\nvar_array: item1,item2,item3\n## in a playbook i call a PS script providing it \"var_array\" as input\n\n...\n  scripts: files/scripts/testArray.ps1 {{ var_array }}\n  register: runResults\n...\n\nin the PS script, i take in the argument, split the items, and run the array through a foreach loop\nparam(\n [string]$inData\n)\necho $inData\n$localArray = @($inData -split(\",\"))\n\nforeach ($arrayItem in $localArray){\n echo $arrayItem\n echo \"---------\"\n}\n\nwhen run the PS script locally on the windows server, the result is:\n## item1\n## item2\n## item3\n\nhowever, when i run the playbook through ansible against the same windows server:\nitem1 item2 item3\n\nIs this a WinRM limitation? or am I missing something in Ansible...\n\nThanks all\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/111", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/111/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/111/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/111/events", "html_url": "https://github.com/diyan/pywinrm/issues/111", "id": 162097827, "node_id": "MDU6SXNzdWUxNjIwOTc4Mjc=", "number": 111, "title": "TypeError: startswith first arg must be bytes or a tuple of bytes, not str", "user": {"login": "aogooc", "id": 19569866, "node_id": "MDQ6VXNlcjE5NTY5ODY2", "avatar_url": "https://avatars1.githubusercontent.com/u/19569866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aogooc", "html_url": "https://github.com/aogooc", "followers_url": "https://api.github.com/users/aogooc/followers", "following_url": "https://api.github.com/users/aogooc/following{/other_user}", "gists_url": "https://api.github.com/users/aogooc/gists{/gist_id}", "starred_url": "https://api.github.com/users/aogooc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aogooc/subscriptions", "organizations_url": "https://api.github.com/users/aogooc/orgs", "repos_url": "https://api.github.com/users/aogooc/repos", "events_url": "https://api.github.com/users/aogooc/events{/privacy}", "received_events_url": "https://api.github.com/users/aogooc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 8636400, "node_id": "MDU6TGFiZWw4NjM2NDAw", "url": "https://api.github.com/repos/diyan/pywinrm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2016-06-24T08:15:29Z", "updated_at": "2019-05-21T01:42:51Z", "closed_at": "2019-05-21T01:42:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "python 3, winrm version 0.2\n\ncode\n\n```\ncommand = 'mkdir C:/a/b/c'\ns = winrm.Session(hostname, auth=(username, password))\nr = s.run_ps(command)\n```\n\nIf command is 'ls C:/a/b' ,then success.\n\nTraceback\n\n```\nTraceback (most recent call last):\n  File \"/usr/lib64/python3.4/site-packages/tornado/web.py\", line 1443, in _execute\n    result = method(*self.path_args, **self.path_kwargs)\n  File \"/g/ops_card-master/handler/business/script.py\", line 40, in post\n    result = self.exec_script(pk)\n  File \"/g/ops_card-master/handler/decorator.py\", line 4, in wrapper\n    result = func(*args, **kwargs)\n  File \"/g/ops_card-master/handler/business/script.py\", line 136, in exec_script\n    result = self.pool.starmap(self.exe, li)\n  File \"/usr/lib64/python3.4/multiprocessing/pool.py\", line 268, in starmap\n    return self._map_async(func, iterable, starmapstar, chunksize).get()\n  File \"/usr/lib64/python3.4/multiprocessing/pool.py\", line 599, in get\n    raise self._value\n  File \"/usr/lib64/python3.4/multiprocessing/pool.py\", line 119, in worker\n    result = (True, func(*args, **kwds))\n  File \"/usr/lib64/python3.4/multiprocessing/pool.py\", line 47, in starmapstar\n    return list(itertools.starmap(args[0], args[1]))\n  File \"/g/ops_card-master/handler/decorator.py\", line 18, in wrapper\n    result = func(*args, **kwargs)\n  File \"/g/ops_card-master/handler/business/script.py\", line 172, in exe\n    r = s.run_ps(command)\n  File \"/usr/lib/python3.4/site-packages/pywinrm-0.2.0-py3.4.egg/winrm/__init__.py\", line 54, in run_ps\n    rs.std_err = self._clean_error_msg(rs.std_err)\n  File \"/usr/lib/python3.4/site-packages/pywinrm-0.2.0-py3.4.egg/winrm/__init__.py\", line 62, in _clean_error_msg\n    if msg.startswith(\"#< CLIXML\\r\\n\"):\nTypeError: startswith first arg must be bytes or a tuple of bytes, not str\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/110", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/110/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/110/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/110/events", "html_url": "https://github.com/diyan/pywinrm/issues/110", "id": 160003684, "node_id": "MDU6SXNzdWUxNjAwMDM2ODQ=", "number": 110, "title": "The installed version of WinRM does not support transport(s) [u'ntlm']", "user": {"login": "jelep", "id": 8484066, "node_id": "MDQ6VXNlcjg0ODQwNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/8484066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jelep", "html_url": "https://github.com/jelep", "followers_url": "https://api.github.com/users/jelep/followers", "following_url": "https://api.github.com/users/jelep/following{/other_user}", "gists_url": "https://api.github.com/users/jelep/gists{/gist_id}", "starred_url": "https://api.github.com/users/jelep/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jelep/subscriptions", "organizations_url": "https://api.github.com/users/jelep/orgs", "repos_url": "https://api.github.com/users/jelep/repos", "events_url": "https://api.github.com/users/jelep/events{/privacy}", "received_events_url": "https://api.github.com/users/jelep/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-06-13T17:30:51Z", "updated_at": "2018-02-09T17:45:13Z", "closed_at": "2018-01-12T22:56:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "upgraded Ansible to ver 2.1, and ensured that pywinrm was also updated\n\non the target Windows server, WinRM 3.0, patched and configured to work with earlier version of Ansible.\n\nin inventory vars, i have included: ansible_winrm_transport: ntlm\n\nand in credential, I updated the username format to domain\\userID from userID@domain.com\n\nwhen i perform a win_ping against a windows server, we encounter the following error:\n\nUsing /etc/ansible/ansible.cfg as config file\nSSH password: \nLoaded callback minimal of type stdout, v2.0\nmyTarget.Server.com | FAILED! => {\n    \"failed\": true, \n    \"msg\": \"The installed version of WinRM does not support transport(s) [u'ntlm']\"\n}\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/109", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/109/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/109/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/109/events", "html_url": "https://github.com/diyan/pywinrm/issues/109", "id": 159854397, "node_id": "MDU6SXNzdWUxNTk4NTQzOTc=", "number": 109, "title": "InvalidCredentialsError", "user": {"login": "jborean93", "id": 8462645, "node_id": "MDQ6VXNlcjg0NjI2NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8462645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jborean93", "html_url": "https://github.com/jborean93", "followers_url": "https://api.github.com/users/jborean93/followers", "following_url": "https://api.github.com/users/jborean93/following{/other_user}", "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}", "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions", "organizations_url": "https://api.github.com/users/jborean93/orgs", "repos_url": "https://api.github.com/users/jborean93/repos", "events_url": "https://api.github.com/users/jborean93/events{/privacy}", "received_events_url": "https://api.github.com/users/jborean93/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2016-06-12T23:35:16Z", "updated_at": "2016-12-08T06:06:34Z", "closed_at": "2016-12-08T06:06:34Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "I am having some issues trying to run a basic test on the new NTLM auth methods with Ansible. The first thing I am trying to just setup a test connection over HTTPS and this is the code I am using to do it\n\n```\nfrom winrm.protocol import Protocol\n\np = Protocol(\n    endpoint='https://HOSTNAME.DOMAIN:5986/wsman',\n    transport='ntlm',\n    username='DOMAIN\\\\USER',\n    password='PASS',\n    server_cert_validation='ignore')\nshell_id = p.open_shell()\ncommand_id = p.run_command(shell_id, 'ipconfig', ['/all'])\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\np.cleanup_command(shell_id, command_id)\np.close_shell(shell_id)\n```\n\nWhen running this I get the following error;\n\n> Traceback (most recent call last):\n>   File \"winrm_test.py\", line 11, in <module>\n>     shell_id = p.open_shell()\n>   File \"/apps/dev/venvs/py27/lib/python2.7/site-packages/winrm/protocol.py\", line 132, in open_shell\n>     res = self.send_message(xmltodict.unparse(req))\n>   File \"/apps/dev/venvs/py27/lib/python2.7/site-packages/winrm/protocol.py\", line 207, in send_message\n>     return self.transport.send_message(message)\n>   File \"/apps/dev/venvs/py27/lib/python2.7/site-packages/winrm/transport.py\", line 179, in send_message\n>     raise InvalidCredentialsError(\"the specified credentials were rejected by the server\")\n> winrm.exceptions.InvalidCredentialsError: the specified credentials were rejected by the server\n\nI can verify that the credentials are correct as I am currently logged onto the machine using that user and I can run the following test to verify the winrm listener is up and running and works with that user\n`Test-WsMan HOSTNAME.DOMAIN -Authentication Negotiate -UseSSL -Credential USER`\n\nWhen looking at the windows error log in the security section I can see the following auth error when trying to run it from pywinrm\n\n> An account failed to log on.\n> Subject:\n>   Security ID:        NULL SID\n>   Account Name:       -\n>   Account Domain:     -\n>   Logon ID:       0x0\n> \n> Logon Type:           3\n> \n> Account For Which Logon Failed:\n>   Security ID:        NULL SID\n>   Account Name:       USER\n>   Account Domain:     DOMAIN\n> \n> Failure Information:\n>   Failure Reason:     An Error occured during Logon.\n>   Status:         0xC000035B\n>   Sub Status:     0x0\n> \n> Process Information:\n>   Caller Process ID:  0x0\n>   Caller Process Name:    -\n> \n> Network Information:\n>   Workstation Name:   ANSIBLEHOST.DOMAIN\n>   Source Network Address: -\n>   Source Port:        -\n> \n> Detailed Authentication Information:\n>   Logon Process:  \n>   Authentication Package: NTLM\n>   Transited Services: -\n>   Package Name (NTLM only):   -\n>   Key Length:     0\n\nWhen looking online at error 0xC000035B there are some references to a registry key which I have verified is not the case https://support.microsoft.com/en-au/kb/2903333\n\nWhen using http I get the following error message and no audit log entires on the remote box\n\n> Traceback (most recent call last):\n>   File \"winrm_test.py\", line 11, in <module>\n>     shell_id = p.open_shell()\n>   File \"/apps/dev/venvs/py27/lib/python2.7/site-packages/winrm/protocol.py\", line 132, in open_shell\n>     res = self.send_message(xmltodict.unparse(req))\n>   File \"/apps/dev/venvs/py27/lib/python2.7/site-packages/winrm/protocol.py\", line 207, in send_message\n>     return self.transport.send_message(message)\n>   File \"/apps/dev/venvs/py27/lib/python2.7/site-packages/winrm/transport.py\", line 191, in send_message\n>     raise WinRMTransportError('http', error_message)\n> winrm.exceptions.WinRMTransportError: (u'http', u'Bad HTTP response returned from server. Code 403')\n\nHere is my winrm config for the listener\n\n> winrm e winrm/config/listener\n> Listener\n>     Address = *\n>     Transport = HTTP\n>     Port = 5985\n>     Hostname\n>     Enabled = true\n>     URLPrefix = wsman\n>     CertificateThumbprint\n>     ListeningOn = 10.11.145.11, 127.0.0.1, ::1\n> \n> Listener\n>     Address = *\n>     Transport = HTTPS\n>     Port = 5986\n>     Hostname = HOSTNAME.DOMAIN\n>     Enabled = true\n>     URLPrefix = wsman\n>     CertificateThumbprint = e0 9c 0b 32 54 ea 32 b9  8c ae 85 cc 2b 4a 75 c545 c0 ac cc\n>     ListeningOn = 10.11.145.11, 127.0.0.1, ::1\n\nwinrm get winrm/config\n\n> Config\n>     MaxEnvelopeSizekb = 500\n>     MaxTimeoutms = 60000\n>     MaxBatchItems = 32000\n>     MaxProviderRequests = 4294967295\n>     Client\n>         NetworkDelayms = 5000\n>         URLPrefix = wsman\n>         AllowUnencrypted = false [Source=\"GPO\"]\n>         Auth\n>             Basic = false [Source=\"GPO\"]\n>             Digest = false [Source=\"GPO\"]\n>             Kerberos = true [Source=\"GPO\"]\n>             Negotiate = true [Source=\"GPO\"]\n>             Certificate = true\n>             CredSSP = true [Source=\"GPO\"]\n>         DefaultPorts\n>             HTTP = 5985\n>             HTTPS = 5986\n>         TrustedHosts = *.DOMAIN [Source=\"GPO\"]\n>     Service\n>         RootSDDL = O:NSG:BAD:P(A;;GA;;;BA)(A;;GR;;;IU)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)\n>         MaxConcurrentOperations = 4294967295\n>         MaxConcurrentOperationsPerUser = 1500\n>         EnumerationTimeoutms = 240000\n>         MaxConnections = 300\n>         MaxPacketRetrievalTimeSeconds = 120\n>         AllowUnencrypted = false [Source=\"GPO\"]\n>         Auth\n>             Basic = false [Source=\"GPO\"]\n>             Kerberos = true [Source=\"GPO\"]\n>             Negotiate = true [Source=\"GPO\"]\n>             Certificate = false\n>             CredSSP = true [Source=\"GPO\"]\n>             CbtHardeningLevel = Strict [Source=\"GPO\"]\n>         DefaultPorts\n>             HTTP = 5985\n>             HTTPS = 5986\n>         IPv4Filter = *\n>         IPv6Filter = *\n>         EnableCompatibilityHttpListener = false [Source=\"GPO\"]\n>         EnableCompatibilityHttpsListener = false [Source=\"GPO\"]\n>         CertificateThumbprint\n>         AllowRemoteAccess = true\n>     Winrs\n>         AllowRemoteShellAccess = true [Source=\"GPO\"]\n>         IdleTimeout = 7200000\n>         MaxConcurrentUsers = 10\n>         MaxShellRunTime = 2147483647\n>         MaxProcessesPerShell = 25\n>         MaxMemoryPerShellMB = 1024\n>         MaxShellsPerUser = 30\n\nLastly here is my installed pip modules with all the libraries installed\n\n> ansible (2.1.0.0)\n> boto (2.40.0)\n> cffi (1.6.0)\n> cloud-accounts-client (1.9)\n> cryptography (1.3.2)\n> enum34 (1.1.6)\n> future (0.15.2)\n> idna (2.1)\n> ipaddress (1.0.16)\n> Jinja2 (2.8)\n> MarkupSafe (0.23)\n> paramiko (2.0.0)\n> pip (8.1.2)\n> pyasn1 (0.1.9)\n> pycparser (2.14)\n> pycrypto (2.6.1)\n> python-dateutil (2.5.3)\n> python-ntlm3 (1.0.2)\n> pywinrm (0.2.0)\n> PyYAML (3.11)\n> requests (2.10.0)\n> requests-ntlm (0.3.0)\n> setuptools (11.3)\n> six (1.10.0)\n> xmltodict (0.10.2)\n\nEdit:\nAfter some further digging and debugging I have found the root cause to be CbtHardeningLevel = Strict flag under winrm/config/service/auth (https://msdn.microsoft.com/en-us/library/dd767318(v=vs.90).aspx). If this is set to relaxed then the connection is make and I can run the commands, I can also set AllowUnencrypted to true but that won't fly in a production environment so it is out of the question. Unfortunately our companies GPO sets this to strict by default and I won't be able to change it.\n\nHopefully someone with better knowledge than me with the library might be able to help track down the issue and help identify a possibly solution.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/108", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/108/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/108/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/108/events", "html_url": "https://github.com/diyan/pywinrm/issues/108", "id": 159224071, "node_id": "MDU6SXNzdWUxNTkyMjQwNzE=", "number": 108, "title": "installing pywinrm on solaris ", "user": {"login": "superonduper", "id": 19823612, "node_id": "MDQ6VXNlcjE5ODIzNjEy", "avatar_url": "https://avatars0.githubusercontent.com/u/19823612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/superonduper", "html_url": "https://github.com/superonduper", "followers_url": "https://api.github.com/users/superonduper/followers", "following_url": "https://api.github.com/users/superonduper/following{/other_user}", "gists_url": "https://api.github.com/users/superonduper/gists{/gist_id}", "starred_url": "https://api.github.com/users/superonduper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/superonduper/subscriptions", "organizations_url": "https://api.github.com/users/superonduper/orgs", "repos_url": "https://api.github.com/users/superonduper/repos", "events_url": "https://api.github.com/users/superonduper/events{/privacy}", "received_events_url": "https://api.github.com/users/superonduper/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-06-08T17:17:12Z", "updated_at": "2016-06-10T22:48:36Z", "closed_at": "2016-06-10T22:48:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "Gents,\n\nI'm having problems installing pywinrm on OmniOS (illumos). Obviously I can't run yum or apt-get, only pkg and pkgin. I have installed \n\nPython 2.7.6 (default, May 19 2016, 15:48:48)\n[GCC 4.8.1] on sunos5.11\n\nSo when I run \n$ pip install pywinrm[kerberos]\n\nIt fails, and from what I can see, this is a problem with pywinrm: \n\n> Traceback (most recent call last): \n> File \"<string>\", line 1, in <module> \n> File \"/tmp/pip-build-3gE8gK/pykerberos/setup.py\", line 52, in <module> \n> extra_link_args = check_krb5_config(\"--libs\", \"gssapi\") \n> File \"/tmp/pip-build-3gE8gK/pykerberos/setup.py\", line 36, in check_krb5_c onfig \n> raise subprocess.CalledProcessError(retcode, cmd, output=output) \n> subprocess.CalledProcessError: Command 'krb5-config' returned non-zero exit status 1 \n\nI wonder if it's assuming Linux commands for some things? \n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/107", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/107/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/107/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/107/events", "html_url": "https://github.com/diyan/pywinrm/issues/107", "id": 158356464, "node_id": "MDU6SXNzdWUxNTgzNTY0NjQ=", "number": 107, "title": "NTLM authentication ?", "user": {"login": "Hachebourin", "id": 19730082, "node_id": "MDQ6VXNlcjE5NzMwMDgy", "avatar_url": "https://avatars3.githubusercontent.com/u/19730082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hachebourin", "html_url": "https://github.com/Hachebourin", "followers_url": "https://api.github.com/users/Hachebourin/followers", "following_url": "https://api.github.com/users/Hachebourin/following{/other_user}", "gists_url": "https://api.github.com/users/Hachebourin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hachebourin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hachebourin/subscriptions", "organizations_url": "https://api.github.com/users/Hachebourin/orgs", "repos_url": "https://api.github.com/users/Hachebourin/repos", "events_url": "https://api.github.com/users/Hachebourin/events{/privacy}", "received_events_url": "https://api.github.com/users/Hachebourin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2016-06-03T12:29:55Z", "updated_at": "2016-06-03T18:43:19Z", "closed_at": "2016-06-03T18:43:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\n\nWhat is working is to create a winrm session with basic authentication. However, I want to connect with negotiate authentication and I don't know how to do. \n\nHere is my code : `\n\n> > > from winrm.protocol import Protocol\n> > > p = Protocol(\n> > > ...     endpoint='https://10.70.22.80:5986/wsman',\n> > > ...     transport='ssl',\n> > > ...     username=r'Administrator',\n> > > ...     password='Password',\n> > > ...     server_cert_validation='ignore')\n> > > shell_id = p.open_shell()\n> > > Traceback (most recent call last):\n> > >   File \"<stdin>\", line 1, in <module>\n> > >   File \"/usr/lib/python2.7/site-packages/winrm/protocol.py\", line 121, in open_shell\n> > >     rs = self.send_message(xmltodict.unparse(rq))\n> > >   File \"/usr/lib/python2.7/site-packages/winrm/protocol.py\", line 194, in send_message\n> > >     return self.transport.send_message(message)\n> > >   File \"/usr/lib/python2.7/site-packages/winrm/transport.py\", line 126, in send_message\n> > >     raise UnauthorizedError(transport='plaintext', message=ex.msg)\n> > > winrm.exceptions.UnauthorizedError: 401 Unauthorized.`\n\nI try with transport='ntlm' but it seems to not exist : \n`Traceback (most recent call last):\n  File \"<stdin>\", line 6, in <module>\n  File \"/usr/lib/python2.7/site-packages/winrm/protocol.py\", line 50, in __init__\n    raise NotImplementedError()\nNotImplementedError\n`\nIs it possible to do a negotiate connection ?\n\nThank you,\n\nArkantos\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/106", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/106/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/106/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/106/events", "html_url": "https://github.com/diyan/pywinrm/issues/106", "id": 158283626, "node_id": "MDU6SXNzdWUxNTgyODM2MjY=", "number": 106, "title": "Use demo error in Python 3.4", "user": {"login": "aogooc", "id": 19569866, "node_id": "MDQ6VXNlcjE5NTY5ODY2", "avatar_url": "https://avatars1.githubusercontent.com/u/19569866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aogooc", "html_url": "https://github.com/aogooc", "followers_url": "https://api.github.com/users/aogooc/followers", "following_url": "https://api.github.com/users/aogooc/following{/other_user}", "gists_url": "https://api.github.com/users/aogooc/gists{/gist_id}", "starred_url": "https://api.github.com/users/aogooc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aogooc/subscriptions", "organizations_url": "https://api.github.com/users/aogooc/orgs", "repos_url": "https://api.github.com/users/aogooc/repos", "events_url": "https://api.github.com/users/aogooc/events{/privacy}", "received_events_url": "https://api.github.com/users/aogooc/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-06-03T03:21:33Z", "updated_at": "2016-06-03T18:47:41Z", "closed_at": "2016-06-03T18:47:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "In the centos 7 of the python 3.4.  version 0.1.1\n\n> code\n\np = Protocol(\n       endpoint='http://server01:5985/wsman',\n       transport='plaintext',\n       username=username,\n       password=password)\nshell_id = p.open_shell()\ncommand_id = p.run_command(shell_id, 'ipconfig', ['/all'])\nstd_out, std_err, status_code = p.get_command_output(shell_id, command_id)\np.cleanup_command(shell_id, command_id)\np.close_shell(shell_id)\n\n> error\n\nTraceback (most recent call last):\n  File \"t.py\", line 11, in <module>\n    shell_id = p.open_shell()\n  File \"/usr/lib/python3.4/site-packages/winrm/protocol.py\", line 121, in open_shell\n    rs = self.send_message(xmltodict.unparse(rq))\n  File \"/usr/lib/python3.4/site-packages/winrm/protocol.py\", line 193, in send_message\n    return self.transport.send_message(message)\n  File \"/usr/lib/python3.4/site-packages/winrm/transport.py\", line 108, in send_message\n    response = self.opener.open(request, timeout=self.timeout)\n  File \"/usr/lib64/python3.4/urllib/request.py\", line 461, in open\n    req = meth(req)\n  File \"/usr/lib64/python3.4/urllib/request.py\", line 1112, in do_request_\n    raise TypeError(msg)\nTypeError: POST data should be bytes or an iterable of bytes. It cannot be of type str.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/105", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/105/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/105/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/105/events", "html_url": "https://github.com/diyan/pywinrm/issues/105", "id": 157221126, "node_id": "MDU6SXNzdWUxNTcyMjExMjY=", "number": 105, "title": "Issue connecting to Workgroup Windows Server 2012 R2", "user": {"login": "mikef-nl", "id": 18595631, "node_id": "MDQ6VXNlcjE4NTk1NjMx", "avatar_url": "https://avatars1.githubusercontent.com/u/18595631?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mikef-nl", "html_url": "https://github.com/mikef-nl", "followers_url": "https://api.github.com/users/mikef-nl/followers", "following_url": "https://api.github.com/users/mikef-nl/following{/other_user}", "gists_url": "https://api.github.com/users/mikef-nl/gists{/gist_id}", "starred_url": "https://api.github.com/users/mikef-nl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mikef-nl/subscriptions", "organizations_url": "https://api.github.com/users/mikef-nl/orgs", "repos_url": "https://api.github.com/users/mikef-nl/repos", "events_url": "https://api.github.com/users/mikef-nl/events{/privacy}", "received_events_url": "https://api.github.com/users/mikef-nl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-05-27T14:38:14Z", "updated_at": "2019-06-24T19:53:54Z", "closed_at": "2019-06-24T19:53:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "I make use of pywinrm through Ansible. I receive the following error on a Windows Server 2012 R2 Workgroup server:\n \"msg\": \"ntlm: ('Connection aborted.', error(104, 'Connection reset by peer'))\"\nThis is of course when using ntlm auth. Are there any steps I can take to further troubleshoot this?\nTried pywinrm via python and got the following:\n\nFile \"/usr/lib/python2.7/site-packages/winrm/transport.py\", line 179, in send_message\n    raise InvalidCredentialsError(\"the specified credentials were rejected by the server\")\nwinrm.exceptions.InvalidCredentialsError: the specified credentials were rejected by the server\n\nBut if I logon to the server using the same credentials it logs in perfectly.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/102", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/102/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/102/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/102/events", "html_url": "https://github.com/diyan/pywinrm/issues/102", "id": 154544679, "node_id": "MDU6SXNzdWUxNTQ1NDQ2Nzk=", "number": 102, "title": "Remove code if not used or put comment that explains intention", "user": {"login": "diyan", "id": 285644, "node_id": "MDQ6VXNlcjI4NTY0NA==", "avatar_url": "https://avatars2.githubusercontent.com/u/285644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/diyan", "html_url": "https://github.com/diyan", "followers_url": "https://api.github.com/users/diyan/followers", "following_url": "https://api.github.com/users/diyan/following{/other_user}", "gists_url": "https://api.github.com/users/diyan/gists{/gist_id}", "starred_url": "https://api.github.com/users/diyan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/diyan/subscriptions", "organizations_url": "https://api.github.com/users/diyan/orgs", "repos_url": "https://api.github.com/users/diyan/repos", "events_url": "https://api.github.com/users/diyan/events{/privacy}", "received_events_url": "https://api.github.com/users/diyan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 8636402, "node_id": "MDU6TGFiZWw4NjM2NDAy", "url": "https://api.github.com/repos/diyan/pywinrm/labels/priority/nice-to-have", "name": "priority/nice-to-have", "color": "84b6eb", "default": false, "description": null}, {"id": 375258991, "node_id": "MDU6TGFiZWwzNzUyNTg5OTE=", "url": "https://api.github.com/repos/diyan/pywinrm/labels/version/0.2.0", "name": "version/0.2.0", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-12T18:02:38Z", "updated_at": "2016-05-16T17:47:39Z", "closed_at": "2016-05-16T17:47:39Z", "author_association": "OWNER", "active_lock_reason": null, "body": "https://github.com/diyan/pywinrm/blob/449f7973f257251cdc689514e0f4f5e0f0cfa8f7/winrm/__init__.py#L8-L11\n\n/cc @nitzmahone \n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/101", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/101/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/101/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/101/events", "html_url": "https://github.com/diyan/pywinrm/issues/101", "id": 154544318, "node_id": "MDU6SXNzdWUxNTQ1NDQzMTg=", "number": 101, "title": "Drop isodate dependency if it's useless", "user": {"login": "diyan", "id": 285644, "node_id": "MDQ6VXNlcjI4NTY0NA==", "avatar_url": "https://avatars2.githubusercontent.com/u/285644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/diyan", "html_url": "https://github.com/diyan", "followers_url": "https://api.github.com/users/diyan/followers", "following_url": "https://api.github.com/users/diyan/following{/other_user}", "gists_url": "https://api.github.com/users/diyan/gists{/gist_id}", "starred_url": "https://api.github.com/users/diyan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/diyan/subscriptions", "organizations_url": "https://api.github.com/users/diyan/orgs", "repos_url": "https://api.github.com/users/diyan/repos", "events_url": "https://api.github.com/users/diyan/events{/privacy}", "received_events_url": "https://api.github.com/users/diyan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 8636402, "node_id": "MDU6TGFiZWw4NjM2NDAy", "url": "https://api.github.com/repos/diyan/pywinrm/labels/priority/nice-to-have", "name": "priority/nice-to-have", "color": "84b6eb", "default": false, "description": null}, {"id": 375258991, "node_id": "MDU6TGFiZWwzNzUyNTg5OTE=", "url": "https://api.github.com/repos/diyan/pywinrm/labels/version/0.2.0", "name": "version/0.2.0", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-12T18:00:56Z", "updated_at": "2016-05-16T17:47:31Z", "closed_at": "2016-05-16T17:47:31Z", "author_association": "OWNER", "active_lock_reason": null, "body": "https://github.com/diyan/pywinrm/blob/449f7973f257251cdc689514e0f4f5e0f0cfa8f7/setup.py#L26\nhttps://github.com/diyan/pywinrm/blob/449f7973f257251cdc689514e0f4f5e0f0cfa8f7/requirements.txt#L1\n\n/cc @nitzmahone \n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/100", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/100/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/100/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/100/events", "html_url": "https://github.com/diyan/pywinrm/issues/100", "id": 154543765, "node_id": "MDU6SXNzdWUxNTQ1NDM3NjU=", "number": 100, "title": "AppVeyour. Use \"ps: |\" literal_block declaration in init, install sections", "user": {"login": "diyan", "id": 285644, "node_id": "MDQ6VXNlcjI4NTY0NA==", "avatar_url": "https://avatars2.githubusercontent.com/u/285644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/diyan", "html_url": "https://github.com/diyan", "followers_url": "https://api.github.com/users/diyan/followers", "following_url": "https://api.github.com/users/diyan/following{/other_user}", "gists_url": "https://api.github.com/users/diyan/gists{/gist_id}", "starred_url": "https://api.github.com/users/diyan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/diyan/subscriptions", "organizations_url": "https://api.github.com/users/diyan/orgs", "repos_url": "https://api.github.com/users/diyan/repos", "events_url": "https://api.github.com/users/diyan/events{/privacy}", "received_events_url": "https://api.github.com/users/diyan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 8636402, "node_id": "MDU6TGFiZWw4NjM2NDAy", "url": "https://api.github.com/repos/diyan/pywinrm/labels/priority/nice-to-have", "name": "priority/nice-to-have", "color": "84b6eb", "default": false, "description": null}, {"id": 375258991, "node_id": "MDU6TGFiZWwzNzUyNTg5OTE=", "url": "https://api.github.com/repos/diyan/pywinrm/labels/version/0.2.0", "name": "version/0.2.0", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-12T17:58:12Z", "updated_at": "2016-05-16T17:47:23Z", "closed_at": "2016-05-16T17:47:22Z", "author_association": "OWNER", "active_lock_reason": null, "body": "https://github.com/diyan/pywinrm/blob/449f7973f257251cdc689514e0f4f5e0f0cfa8f7/appveyor.yml#L31-L41\n\n(Offtopic) @nitzmahone You have enabled integration tests on Windows/AppVeyor, you are my hero!\nI was close, but you took all the glory ;)\n\n``` yaml\ntest_script:\n  # configure winrm envvars for tests\n  - ps: |\n      $ErrorActionPreference = \"Stop\"\n      $env:WINRM_USERNAME=$($env:USERNAME)\n      $env:WINRM_PASSWORD=[Microsoft.Win32.Registry]::GetValue(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\", \"DefaultPassword\", '')\n      $env:WINRM_TRANSPORT=\"basic\"\n      $env:WINRM_ENDPOINT=\"http://localhost:5985/wsman\"\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/99", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/99/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/99/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/99/events", "html_url": "https://github.com/diyan/pywinrm/issues/99", "id": 154543180, "node_id": "MDU6SXNzdWUxNTQ1NDMxODA=", "number": 99, "title": "Travis CI. Make sure that pywinrm[kerberos] is installable", "user": {"login": "diyan", "id": 285644, "node_id": "MDQ6VXNlcjI4NTY0NA==", "avatar_url": "https://avatars2.githubusercontent.com/u/285644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/diyan", "html_url": "https://github.com/diyan", "followers_url": "https://api.github.com/users/diyan/followers", "following_url": "https://api.github.com/users/diyan/following{/other_user}", "gists_url": "https://api.github.com/users/diyan/gists{/gist_id}", "starred_url": "https://api.github.com/users/diyan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/diyan/subscriptions", "organizations_url": "https://api.github.com/users/diyan/orgs", "repos_url": "https://api.github.com/users/diyan/repos", "events_url": "https://api.github.com/users/diyan/events{/privacy}", "received_events_url": "https://api.github.com/users/diyan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 8636402, "node_id": "MDU6TGFiZWw4NjM2NDAy", "url": "https://api.github.com/repos/diyan/pywinrm/labels/priority/nice-to-have", "name": "priority/nice-to-have", "color": "84b6eb", "default": false, "description": null}, {"id": 375258991, "node_id": "MDU6TGFiZWwzNzUyNTg5OTE=", "url": "https://api.github.com/repos/diyan/pywinrm/labels/version/0.2.0", "name": "version/0.2.0", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-12T17:55:20Z", "updated_at": "2016-05-16T17:47:14Z", "closed_at": "2016-05-16T17:47:14Z", "author_association": "OWNER", "active_lock_reason": null, "body": "There is no way to run integration tests on Travis but we can try to run an equivalent of 'pip install pywinrm[kerberos]'\n\nhttps://github.com/diyan/pywinrm/blob/449f7973f257251cdc689514e0f4f5e0f0cfa8f7/.travis.yml#L12\n/cc @nitzmahone \n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/diyan/pywinrm/issues/98", "repository_url": "https://api.github.com/repos/diyan/pywinrm", "labels_url": "https://api.github.com/repos/diyan/pywinrm/issues/98/labels{/name}", "comments_url": "https://api.github.com/repos/diyan/pywinrm/issues/98/comments", "events_url": "https://api.github.com/repos/diyan/pywinrm/issues/98/events", "html_url": "https://github.com/diyan/pywinrm/issues/98", "id": 154542561, "node_id": "MDU6SXNzdWUxNTQ1NDI1NjE=", "number": 98, "title": "Consider drop requirements.txt file or make it equivalent to the pywinrm[kerberos]", "user": {"login": "diyan", "id": 285644, "node_id": "MDQ6VXNlcjI4NTY0NA==", "avatar_url": "https://avatars2.githubusercontent.com/u/285644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/diyan", "html_url": "https://github.com/diyan", "followers_url": "https://api.github.com/users/diyan/followers", "following_url": "https://api.github.com/users/diyan/following{/other_user}", "gists_url": "https://api.github.com/users/diyan/gists{/gist_id}", "starred_url": "https://api.github.com/users/diyan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/diyan/subscriptions", "organizations_url": "https://api.github.com/users/diyan/orgs", "repos_url": "https://api.github.com/users/diyan/repos", "events_url": "https://api.github.com/users/diyan/events{/privacy}", "received_events_url": "https://api.github.com/users/diyan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 8636402, "node_id": "MDU6TGFiZWw4NjM2NDAy", "url": "https://api.github.com/repos/diyan/pywinrm/labels/priority/nice-to-have", "name": "priority/nice-to-have", "color": "84b6eb", "default": false, "description": null}, {"id": 375258991, "node_id": "MDU6TGFiZWwzNzUyNTg5OTE=", "url": "https://api.github.com/repos/diyan/pywinrm/labels/version/0.2.0", "name": "version/0.2.0", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-05-12T17:52:21Z", "updated_at": "2016-05-16T17:46:50Z", "closed_at": "2016-05-16T17:46:50Z", "author_association": "OWNER", "active_lock_reason": null, "body": "https://github.com/diyan/pywinrm/blob/449f7973f257251cdc689514e0f4f5e0f0cfa8f7/.travis.yml#L15\n/cc @nitzmahone \n", "performed_via_github_app": null, "score": 1.0}]}