{"total_count": 33, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/google/pasta/issues/83", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/83/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/83/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/83/events", "html_url": "https://github.com/google/pasta/issues/83", "id": 567285134, "node_id": "MDU6SXNzdWU1NjcyODUxMzQ=", "number": 83, "title": "Support for async code", "user": {"login": "cript0nauta", "id": 1222362, "node_id": "MDQ6VXNlcjEyMjIzNjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1222362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cript0nauta", "html_url": "https://github.com/cript0nauta", "followers_url": "https://api.github.com/users/cript0nauta/followers", "following_url": "https://api.github.com/users/cript0nauta/following{/other_user}", "gists_url": "https://api.github.com/users/cript0nauta/gists{/gist_id}", "starred_url": "https://api.github.com/users/cript0nauta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cript0nauta/subscriptions", "organizations_url": "https://api.github.com/users/cript0nauta/orgs", "repos_url": "https://api.github.com/users/cript0nauta/repos", "events_url": "https://api.github.com/users/cript0nauta/events{/privacy}", "received_events_url": "https://api.github.com/users/cript0nauta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-19T03:05:41Z", "updated_at": "2020-03-13T18:58:56Z", "closed_at": "2020-03-13T18:58:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi! I noted that pasta isn't able to parse async Python code. For example, this script will raise an error instead of succeeding:\r\n\r\n```python\r\n\r\nimport pasta\r\n\r\nsource_code = \"\"\"\r\nasync def f():\r\n    return\r\n\"\"\"\r\n\r\npasta.parse(source_code)\r\n```\r\n\r\nI got the following traceback:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"sscce.py\", line 8, in <module>\r\n    pasta.parse(source_code)\r\n  File \"/src/.venv/src/pasta/pasta/__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 1214, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 133, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/nix/store/hmcha8bv2ziwabla76hd612vgxr20pnd-python3-3.7.6/lib/python3.7/ast.py\", line 271, in visit\r\n    return visitor(node)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 47, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 225, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"/nix/store/hmcha8bv2ziwabla76hd612vgxr20pnd-python3-3.7.6/lib/python3.7/ast.py\", line 279, in generic_visit\r\n    self.visit(item)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 1214, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 133, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/nix/store/hmcha8bv2ziwabla76hd612vgxr20pnd-python3-3.7.6/lib/python3.7/ast.py\", line 271, in visit\r\n    return visitor(node)\r\n  File \"/nix/store/hmcha8bv2ziwabla76hd612vgxr20pnd-python3-3.7.6/lib/python3.7/ast.py\", line 279, in generic_visit\r\n    self.visit(item)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 1214, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 133, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/nix/store/hmcha8bv2ziwabla76hd612vgxr20pnd-python3-3.7.6/lib/python3.7/ast.py\", line 271, in visit\r\n    return visitor(node)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 47, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 680, in visit_Return\r\n    self.token('return')\r\n  File \"/src/.venv/src/pasta/pasta/base/annotate.py\", line 1353, in token\r\n    token_val, token.src, token.start[0], token.line))\r\npasta.base.annotate.AnnotationError: Expected 'return' but found 'async'\r\nline 2: async def f():\r\n```\r\n\r\nIt would be nice if it could handle it properly.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/82", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/82/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/82/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/82/events", "html_url": "https://github.com/google/pasta/issues/82", "id": 554573164, "node_id": "MDU6SXNzdWU1NTQ1NzMxNjQ=", "number": 82, "title": "IndentationError when appending new node to function body", "user": {"login": "cript0nauta", "id": 1222362, "node_id": "MDQ6VXNlcjEyMjIzNjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1222362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cript0nauta", "html_url": "https://github.com/cript0nauta", "followers_url": "https://api.github.com/users/cript0nauta/followers", "following_url": "https://api.github.com/users/cript0nauta/following{/other_user}", "gists_url": "https://api.github.com/users/cript0nauta/gists{/gist_id}", "starred_url": "https://api.github.com/users/cript0nauta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cript0nauta/subscriptions", "organizations_url": "https://api.github.com/users/cript0nauta/orgs", "repos_url": "https://api.github.com/users/cript0nauta/repos", "events_url": "https://api.github.com/users/cript0nauta/events{/privacy}", "received_events_url": "https://api.github.com/users/cript0nauta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-24T06:51:05Z", "updated_at": "2020-01-25T03:50:43Z", "closed_at": "2020-01-24T18:37:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi! I found a bug in `pasta` when I try to add a node to a function body (I think it's the same with every node class that has a body). I built the following script to reproduce the bug:\r\n\r\n```python\r\nimport ast\r\nimport pasta\r\n\r\nsource_code = \"\"\"\r\nif 1:  # This is required\r\n    def f():\r\n        a=1\r\n\"\"\"\r\n\r\nclass SampleTransformer(ast.NodeTransformer):\r\n    def visit_FunctionDef(self, node):\r\n        return_node = ast.copy_location(\r\n            ast.Return(value=None), node.body[0])\r\n        # return_node = ast.Return(value=None)  # This produces the same error than above\r\n        node.body.append(return_node)\r\n        return node\r\n\r\ntree = pasta.parse(source_code)\r\nSampleTransformer().visit(tree)\r\n\r\nprint(pasta.dump(tree))\r\n```\r\n\r\nThe expected output of it should be:\r\n\r\n```python\r\nif 1:  # This is required\r\n    def f():\r\n        a=1\r\n        return\r\n```\r\n\r\nBut instead it produces a syntactically invalid code:\r\n\r\n```python\r\nif 1:  # This is required\r\n    def f():\r\n        a=1\r\n            return\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/79", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/79/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/79/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/79/events", "html_url": "https://github.com/google/pasta/issues/79", "id": 525154928, "node_id": "MDU6SXNzdWU1MjUxNTQ5Mjg=", "number": 79, "title": "Fails to parse usages of metaclass", "user": {"login": "timokau", "id": 3799330, "node_id": "MDQ6VXNlcjM3OTkzMzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/3799330?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timokau", "html_url": "https://github.com/timokau", "followers_url": "https://api.github.com/users/timokau/followers", "following_url": "https://api.github.com/users/timokau/following{/other_user}", "gists_url": "https://api.github.com/users/timokau/gists{/gist_id}", "starred_url": "https://api.github.com/users/timokau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timokau/subscriptions", "organizations_url": "https://api.github.com/users/timokau/orgs", "repos_url": "https://api.github.com/users/timokau/repos", "events_url": "https://api.github.com/users/timokau/events{/privacy}", "received_events_url": "https://api.github.com/users/timokau/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-19T17:27:46Z", "updated_at": "2019-11-19T20:32:41Z", "closed_at": "2019-11-19T17:59:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tried to use the tensorflow update script on a codebase that uses abstract classes with `ABCMeta`. Parsing failed with\r\n\r\n```\r\nAnnotationError: Expected ':' but found 'metaclass'\r\n```\r\n\r\nMinimal example:\r\n\r\n```\r\npasta.parse('class A(metaclass=X): pass')    \r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/78", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/78/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/78/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/78/events", "html_url": "https://github.com/google/pasta/issues/78", "id": 501053958, "node_id": "MDU6SXNzdWU1MDEwNTM5NTg=", "number": 78, "title": "Bad indentation when using try..finally", "user": {"login": "cript0nauta", "id": 1222362, "node_id": "MDQ6VXNlcjEyMjIzNjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1222362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cript0nauta", "html_url": "https://github.com/cript0nauta", "followers_url": "https://api.github.com/users/cript0nauta/followers", "following_url": "https://api.github.com/users/cript0nauta/following{/other_user}", "gists_url": "https://api.github.com/users/cript0nauta/gists{/gist_id}", "starred_url": "https://api.github.com/users/cript0nauta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cript0nauta/subscriptions", "organizations_url": "https://api.github.com/users/cript0nauta/orgs", "repos_url": "https://api.github.com/users/cript0nauta/repos", "events_url": "https://api.github.com/users/cript0nauta/events{/privacy}", "received_events_url": "https://api.github.com/users/cript0nauta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-01T17:58:31Z", "updated_at": "2019-10-01T19:59:49Z", "closed_at": "2019-10-01T19:53:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi! It's me again, this time with more pasta edge cases!\r\n\r\nWhen I run the following Python 2 code:\r\n\r\n```python\r\nimport ast\r\nimport pasta\r\n\r\nsource_code = '''\r\ntry:\r\n    if 1:\r\n        a=1\r\nfinally:\r\n    a=1\r\n'''\r\n\r\nclass SampleTransformer(ast.NodeTransformer):\r\n    def visit_If(self, node):\r\n        node.body = [ast.Pass()]\r\n        return node\r\n\r\ntree = pasta.parse(source_code)\r\nSampleTransformer().visit(tree)\r\n\r\nprint pasta.dump(tree)\r\n```\r\n\r\nThe expected output of it should be\r\n\r\n```python\r\ntry:\r\n    if 1:\r\n        pass\r\nfinally:\r\n    a=1\r\n```\r\n\r\nBut the output is this instead:\r\n\r\n```python\r\ntry:\r\n    if 1:\r\n    pass\r\nfinally:\r\n    a=1\r\n```\r\n\r\nThis produces a SyntaxError in the rewritten code.\r\n\r\nIf I change the code of the `visit_TryFinally` function in `pasta/base/annotate.py` to use `self.indented(node, 'body')` instead of `node.body`, the previous example works ok. However, when I run the test suite, there are six failing tests so I suppose there has to be a better way to fix this.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/76", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/76/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/76/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/76/events", "html_url": "https://github.com/google/pasta/issues/76", "id": 487101065, "node_id": "MDU6SXNzdWU0ODcxMDEwNjU=", "number": 76, "title": "Bad indentation when rewriting funcion body (new bug)", "user": {"login": "cript0nauta", "id": 1222362, "node_id": "MDQ6VXNlcjEyMjIzNjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1222362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cript0nauta", "html_url": "https://github.com/cript0nauta", "followers_url": "https://api.github.com/users/cript0nauta/followers", "following_url": "https://api.github.com/users/cript0nauta/following{/other_user}", "gists_url": "https://api.github.com/users/cript0nauta/gists{/gist_id}", "starred_url": "https://api.github.com/users/cript0nauta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cript0nauta/subscriptions", "organizations_url": "https://api.github.com/users/cript0nauta/orgs", "repos_url": "https://api.github.com/users/cript0nauta/repos", "events_url": "https://api.github.com/users/cript0nauta/events{/privacy}", "received_events_url": "https://api.github.com/users/cript0nauta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-08-29T18:04:45Z", "updated_at": "2019-09-30T22:35:53Z", "closed_at": "2019-08-29T23:08:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi! I found an issue similar to #62. When certain conditions are met and I rewrite the body of a function, it won't be properly indented, therefore it will produce incorrect or syntactically invalid code.\r\n\r\nI found the bug while rewriting some parts of [this `HostImporter` class](https://github.com/infobyte/faraday/blob/040f9fd/faraday/server/importer.py#L405). I shrinked the code to find the minimum code required to trigger the bug and ended up with this:\r\n\r\n```python\r\nimport ast\r\nimport pasta\r\n\r\nsource_code = '''\r\nclass K(object):\r\n    def f1():\r\n        if True:\r\n            yield host_ip\r\n            pass\r\n\r\n    def f2():\r\n        pass\r\n'''\r\n\r\nclass SampleTransformer(ast.NodeTransformer):\r\n    def visit_FunctionDef(self, node):\r\n        node.body = [ast.copy_location(ast.Pass(), node.body[0])]\r\n        return node\r\n\r\ntree = pasta.parse(source_code)\r\nSampleTransformer().visit(tree)\r\n\r\nprint pasta.dump(tree)\r\n\r\n```\r\n\r\nThe expected output of running this script should be\r\n\r\n```python\r\nclass K(object):\r\n    def f1():\r\n        pass\r\n    def f2():\r\n        pass\r\n```\r\n\r\nBut the output is this instead:\r\n\r\n```python\r\nclass K(object):\r\n    def f1():\r\n        pass\r\ndef f2():\r\n        pass\r\n```\r\n\r\nThis code is incorrect, but not yet syntactically invalid. If you add a third `f3()` method to the K class, then the output will be:\r\n\r\n```python\r\nclass K(object):\r\n    def f1():\r\n        pass\r\ndef f2():\r\n        pass\r\n    def f3():\r\n        pass\r\n```\r\n\r\nThis will raise a SyntaxError when executed.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/70", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/70/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/70/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/70/events", "html_url": "https://github.com/google/pasta/issues/70", "id": 468249107, "node_id": "MDU6SXNzdWU0NjgyNDkxMDc=", "number": 70, "title": "Support mixing tabs and spaces in python2", "user": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-07-15T17:34:16Z", "updated_at": "2019-10-01T22:04:45Z", "closed_at": "2019-10-01T22:04:45Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Yuck... but python2 recognizes a tab as 8 spaces when the two are mixed. Currently this produces an `IndentationError` when parsing.\r\n\r\nSome good explanation here:\r\nhttps://stackoverflow.com/questions/2034517/pythons-interpretation-of-tabs-and-spaces-to-indent\r\n\r\nThere is probably a more graceful way to handle this situation, anyway, aside from failing outright.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/68", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/68/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/68/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/68/events", "html_url": "https://github.com/google/pasta/issues/68", "id": 463945337, "node_id": "MDU6SXNzdWU0NjM5NDUzMzc=", "number": 68, "title": "Auto-detect indentation in a file and reuse on unformatted code", "user": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828046, "node_id": "MDU6TGFiZWw3NjM4MjgwNDY=", "url": "https://api.github.com/repos/google/pasta/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-07-03T20:45:40Z", "updated_at": "2019-07-03T22:17:31Z", "closed_at": "2019-07-03T22:17:31Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Follow-on for #62.\r\n\r\nIf we insert a node without formatting data into a tree with formatting data, the new node will be printed with default format, including 2 spaces for indentation. If the rest of the file uses tabs or four spaces or whatever, the new code should match this.\r\n\r\nThe suggestion here is to find the most prevalent indentation style in the file and apply it as the default when indenting unformatted nodes.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/65", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/65/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/65/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/65/events", "html_url": "https://github.com/google/pasta/issues/65", "id": 449830596, "node_id": "MDU6SXNzdWU0NDk4MzA1OTY=", "number": 65, "title": "Incomplete handling of complex f-strings", "user": {"login": "kriskorrel-cw", "id": 49682364, "node_id": "MDQ6VXNlcjQ5NjgyMzY0", "avatar_url": "https://avatars0.githubusercontent.com/u/49682364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kriskorrel-cw", "html_url": "https://github.com/kriskorrel-cw", "followers_url": "https://api.github.com/users/kriskorrel-cw/followers", "following_url": "https://api.github.com/users/kriskorrel-cw/following{/other_user}", "gists_url": "https://api.github.com/users/kriskorrel-cw/gists{/gist_id}", "starred_url": "https://api.github.com/users/kriskorrel-cw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kriskorrel-cw/subscriptions", "organizations_url": "https://api.github.com/users/kriskorrel-cw/orgs", "repos_url": "https://api.github.com/users/kriskorrel-cw/repos", "events_url": "https://api.github.com/users/kriskorrel-cw/events{/privacy}", "received_events_url": "https://api.github.com/users/kriskorrel-cw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-29T14:07:17Z", "updated_at": "2019-05-29T17:17:29Z", "closed_at": "2019-05-29T17:17:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Pasta, which is required for the tf_upgrade_v2 script of Tensorflow, throws an error on a specific f-string. I believe support for f-strings has been added recently, but this seems to be incomplete.\r\n\r\nThis concerns the following minimal code example\r\n```\r\nimport os\r\npath = [\"path\", \"to\", \"file\"]\r\nc = f\"/{(os.sep).join(path)}\"\r\n```\r\nWhen running `tf_upgrade_v2` (`pip3 install tensorflow==tensorflow==2.0.0-alpha0`)\r\n\r\nRelated: https://github.com/google/pasta/pull/61, https://github.com/google/pasta/pull/58, https://github.com/google/pasta/pull/59, https://github.com/tensorflow/tensorflow/issues/26486", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/64", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/64/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/64/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/64/events", "html_url": "https://github.com/google/pasta/issues/64", "id": 449423023, "node_id": "MDU6SXNzdWU0NDk0MjMwMjM=", "number": 64, "title": "Support PEP 448 - Additional Unpacking Generalizations", "user": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-05-28T18:50:12Z", "updated_at": "2019-05-28T19:14:21Z", "closed_at": "2019-05-28T19:14:21Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "(extracted from #58)\r\n\r\nFor example `merged = {**a, **b}` fails with a cryptic error\r\n\r\n```\r\n  File \"pasta/base/annotate.py\", line 804, in visit_Dict\r\n    self.visit(key)\r\n  File \"pasta/base/annotate.py\", line 1189, in visit\r\n    fmt.set(node, 'indent', self._indent)\r\n  File \"pasta/base/formatting.py\", line 37, in set\r\n    _formatting_dict(node)[name] = value\r\n  File \"pasta/base/formatting.py\", line 53, in _formatting_dict\r\n    return getattr(node, PASTA_DICT)\r\nAttributeError: 'NoneType' object has no attribute '__pasta__'\r\n```\r\n\r\nbecause the node key in `visit_Dict` will be `None`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/62", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/62/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/62/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/62/events", "html_url": "https://github.com/google/pasta/issues/62", "id": 429900346, "node_id": "MDU6SXNzdWU0Mjk5MDAzNDY=", "number": 62, "title": "Bad indentation when rewriting funcion body", "user": {"login": "cript0nauta", "id": 1222362, "node_id": "MDQ6VXNlcjEyMjIzNjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1222362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cript0nauta", "html_url": "https://github.com/cript0nauta", "followers_url": "https://api.github.com/users/cript0nauta/followers", "following_url": "https://api.github.com/users/cript0nauta/following{/other_user}", "gists_url": "https://api.github.com/users/cript0nauta/gists{/gist_id}", "starred_url": "https://api.github.com/users/cript0nauta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cript0nauta/subscriptions", "organizations_url": "https://api.github.com/users/cript0nauta/orgs", "repos_url": "https://api.github.com/users/cript0nauta/repos", "events_url": "https://api.github.com/users/cript0nauta/events{/privacy}", "received_events_url": "https://api.github.com/users/cript0nauta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-04-05T19:21:32Z", "updated_at": "2019-07-03T20:46:47Z", "closed_at": "2019-07-01T23:28:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi! I'm using your library in a toy project to change the body of some functions. When I change it and dump the modified ast, the code isn't indented right, so executing the dumped code will cause a SyntaxError.\r\n\r\nHere is an example script that describes the issue:\r\n\r\n```python\r\nimport ast\r\nimport pasta\r\n\r\nsource_code = '''\r\ndef test():\r\n    return 5\r\n'''\r\n\r\nclass SampleTransformer(ast.NodeTransformer):\r\n    def visit_FunctionDef(self, node):\r\n        node.body = [ast.copy_location(ast.Pass(), node.body[0])]\r\n        return node\r\n\r\ntree = pasta.parse(source_code)\r\nSampleTransformer().visit(tree)\r\n\r\nprint pasta.dump(tree)\r\n```\r\n\r\nWhen I run it, I get the following output:\r\n\r\n```python\r\ndef test():\r\npass\r\n```\r\n\r\nInstead of what I expected, that has proper indentation:\r\n\r\n```python\r\ndef test():\r\n    pass\r\n```\r\n\r\nI read that there is a known issue related to changing the indentation level of a block, but I think this is another (but maybe related) issue.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/60", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/60/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/60/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/60/events", "html_url": "https://github.com/google/pasta/issues/60", "id": 424429900, "node_id": "MDU6SXNzdWU0MjQ0Mjk5MDA=", "number": 60, "title": "Parsing for non-defaulted kwargs after `*args` fails", "user": {"login": "athre0z", "id": 6553158, "node_id": "MDQ6VXNlcjY1NTMxNTg=", "avatar_url": "https://avatars2.githubusercontent.com/u/6553158?v=4", "gravatar_id": "", "url": "https://api.github.com/users/athre0z", "html_url": "https://github.com/athre0z", "followers_url": "https://api.github.com/users/athre0z/followers", "following_url": "https://api.github.com/users/athre0z/following{/other_user}", "gists_url": "https://api.github.com/users/athre0z/gists{/gist_id}", "starred_url": "https://api.github.com/users/athre0z/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/athre0z/subscriptions", "organizations_url": "https://api.github.com/users/athre0z/orgs", "repos_url": "https://api.github.com/users/athre0z/repos", "events_url": "https://api.github.com/users/athre0z/events{/privacy}", "received_events_url": "https://api.github.com/users/athre0z/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-03-22T23:06:42Z", "updated_at": "2019-03-22T23:20:17Z", "closed_at": "2019-03-22T23:16:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "```python\r\nimport pasta\r\n\r\naaa = '''\r\ndef meow(self, *args, blah):\r\n    pass\r\n'''\r\n\r\npasta.parse(aaa)\r\n```\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nAnnotationError                           Traceback (most recent call last)\r\n<ipython-input-12-cf34fed7cd55> in <module>\r\n      6 '''\r\n      7\r\n----> 8 pasta.parse(aaa)\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/__init__.py in parse(src)\r\n     23   t = ast_utils.parse(src)\r\n     24   annotator = annotate.AstAnnotator(src)\r\n---> 25   annotator.visit(t)\r\n     26   return t\r\n     27\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit(self, node)\r\n   1170       fmt.set(node, 'indent', self._indent)\r\n   1171       fmt.set(node, 'indent_diff', self._indent_diff)\r\n-> 1172       super(AstAnnotator, self).visit(node)\r\n   1173     except (TypeError, ValueError, IndexError, KeyError) as e:\r\n   1174       raise AnnotationError(e)\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit(self, node)\r\n    130   def visit(self, node):\r\n    131     self._stack.append(node)\r\n--> 132     super(BaseVisitor, self).visit(node)\r\n    133     assert node is self._stack.pop()\r\n    134\r\n\r\n/opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/ast.py in visit(self, node)\r\n    260         method = 'visit_' + node.__class__.__name__\r\n    261         visitor = getattr(self, method, self.generic_visit)\r\n--> 262         return visitor(node)\r\n    263\r\n    264     def generic_visit(self, node):\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in wrapped(self, node, *args, **kwargs)\r\n     45       if prefix:\r\n     46         self.prefix(node, default=self._indent if statement else '')\r\n---> 47       f(self, node, *args, **kwargs)\r\n     48       if suffix:\r\n     49         self.suffix(node, max_lines=max_suffix_lines, semicolon=semicolon,\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit_Module(self, node)\r\n    218   @module\r\n    219   def visit_Module(self, node):\r\n--> 220     self.generic_visit(node)\r\n    221\r\n    222   @block_statement\r\n\r\n/opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/ast.py in generic_visit(self, node)\r\n    268                 for item in value:\r\n    269                     if isinstance(item, AST):\r\n--> 270                         self.visit(item)\r\n    271             elif isinstance(value, AST):\r\n    272                 self.visit(value)\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit(self, node)\r\n   1170       fmt.set(node, 'indent', self._indent)\r\n   1171       fmt.set(node, 'indent_diff', self._indent_diff)\r\n-> 1172       super(AstAnnotator, self).visit(node)\r\n   1173     except (TypeError, ValueError, IndexError, KeyError) as e:\r\n   1174       raise AnnotationError(e)\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit(self, node)\r\n    130   def visit(self, node):\r\n    131     self._stack.append(node)\r\n--> 132     super(BaseVisitor, self).visit(node)\r\n    133     assert node is self._stack.pop()\r\n    134\r\n\r\n/opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/ast.py in visit(self, node)\r\n    260         method = 'visit_' + node.__class__.__name__\r\n    261         visitor = getattr(self, method, self.generic_visit)\r\n--> 262         return visitor(node)\r\n    263\r\n    264     def generic_visit(self, node):\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in wrapped(self, node, *args, **kwargs)\r\n     93   def wrapped(self, node, *args, **kwargs):\r\n     94     self.prefix(node, default=self._indent)\r\n---> 95     f(self, node, *args, **kwargs)\r\n     96     if hasattr(self, 'block_suffix'):\r\n     97       last_child = ast_utils.get_last_child(node)\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit_FunctionDef(self, node)\r\n    399     with self.scope(node, 'args', trailing_comma=args_count > 0,\r\n    400                     default_parens=True):\r\n--> 401       self.visit(node.args)\r\n    402\r\n    403     if getattr(node, 'returns', None):\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit(self, node)\r\n   1170       fmt.set(node, 'indent', self._indent)\r\n   1171       fmt.set(node, 'indent_diff', self._indent_diff)\r\n-> 1172       super(AstAnnotator, self).visit(node)\r\n   1173     except (TypeError, ValueError, IndexError, KeyError) as e:\r\n   1174       raise AnnotationError(e)\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit(self, node)\r\n    130   def visit(self, node):\r\n    131     self._stack.append(node)\r\n--> 132     super(BaseVisitor, self).visit(node)\r\n    133     assert node is self._stack.pop()\r\n    134\r\n\r\n/opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/ast.py in visit(self, node)\r\n    260         method = 'visit_' + node.__class__.__name__\r\n    261         visitor = getattr(self, method, self.generic_visit)\r\n--> 262         return visitor(node)\r\n    263\r\n    264     def generic_visit(self, node):\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in wrapped(self, node, *args, **kwargs)\r\n     45       if prefix:\r\n     46         self.prefix(node, default=self._indent if statement else '')\r\n---> 47       f(self, node, *args, **kwargs)\r\n     48       if suffix:\r\n     49         self.suffix(node, max_lines=max_suffix_lines, semicolon=semicolon,\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in visit_arguments(self, node)\r\n   1083       self.visit(arg)\r\n   1084       self.attr(node, 'kw_default_%d' % i, [self.ws, '=', self.ws],\r\n-> 1085                 default='=')\r\n   1086       self.visit(default)\r\n   1087       arg_i += 1\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in attr(***failed resolving arguments***)\r\n   1387     for attr_val in attr_vals:\r\n   1388       if isinstance(attr_val, six.string_types):\r\n-> 1389         attr_parts.append(self.token(attr_val))\r\n   1390       else:\r\n   1391         attr_parts.append(attr_val())\r\n\r\n/private/tmp/test2/venv/lib/python3.7/site-packages/pasta/base/annotate.py in token(self, token_val)\r\n   1313     if token.src != token_val:\r\n   1314       raise AnnotationError(\"Expected %r but found %r\\nline %d: %s\" % (\r\n-> 1315           token_val, token.src, token.start[0], token.line))\r\n   1316\r\n   1317     # If the token opens or closes a parentheses scope, keep track of it\r\n\r\nAnnotationError: Expected '=' but found ')'\r\nline 2: def meow(self, *args, blah):\r\n```\r\n\r\nThis is valid syntax in Python 3. IIRC, this wasn't always the case but later added in a 3.X version, although I'm not exactly sure when.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/56", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/56/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/56/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/56/events", "html_url": "https://github.com/google/pasta/issues/56", "id": 417957759, "node_id": "MDU6SXNzdWU0MTc5NTc3NTk=", "number": 56, "title": "Missing support for relative imports over direct ancestor", "user": {"login": "mmv", "id": 47368, "node_id": "MDQ6VXNlcjQ3MzY4", "avatar_url": "https://avatars2.githubusercontent.com/u/47368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mmv", "html_url": "https://github.com/mmv", "followers_url": "https://api.github.com/users/mmv/followers", "following_url": "https://api.github.com/users/mmv/following{/other_user}", "gists_url": "https://api.github.com/users/mmv/gists{/gist_id}", "starred_url": "https://api.github.com/users/mmv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mmv/subscriptions", "organizations_url": "https://api.github.com/users/mmv/orgs", "repos_url": "https://api.github.com/users/mmv/repos", "events_url": "https://api.github.com/users/mmv/events{/privacy}", "received_events_url": "https://api.github.com/users/mmv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-03-06T18:55:45Z", "updated_at": "2019-03-08T22:26:02Z", "closed_at": "2019-03-08T22:26:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "\u2714 Works:\r\n```\r\nimport pasta\r\ntree = pasta.parse('from .uncle.package import foo')\r\n```\r\n\u2714 Works:\r\n```\r\nimport pasta\r\ntree = pasta.parse('from ..granduncle.package import foo')\r\n```\r\n\u274c Fails:\r\n```\r\nimport pasta\r\ntree = pasta.parse('from ...greatgranduncle.package import foo')\r\n```\r\nwith error `AnnotationError: Expected '.' but found '...'`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/55", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/55/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/55/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/55/events", "html_url": "https://github.com/google/pasta/issues/55", "id": 409562629, "node_id": "MDU6SXNzdWU0MDk1NjI2Mjk=", "number": 55, "title": "foo[:bar] doesn't work if [:bar] is on a new line", "user": {"login": "annarev", "id": 22060313, "node_id": "MDQ6VXNlcjIyMDYwMzEz", "avatar_url": "https://avatars0.githubusercontent.com/u/22060313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/annarev", "html_url": "https://github.com/annarev", "followers_url": "https://api.github.com/users/annarev/followers", "following_url": "https://api.github.com/users/annarev/following{/other_user}", "gists_url": "https://api.github.com/users/annarev/gists{/gist_id}", "starred_url": "https://api.github.com/users/annarev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/annarev/subscriptions", "organizations_url": "https://api.github.com/users/annarev/orgs", "repos_url": "https://api.github.com/users/annarev/repos", "events_url": "https://api.github.com/users/annarev/events{/privacy}", "received_events_url": "https://api.github.com/users/annarev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-02-13T00:15:10Z", "updated_at": "2019-02-15T17:10:48Z", "closed_at": "2019-02-15T17:10:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I am seeing an error when parsing foo[:bar] if [:bar] is on the next line.\r\n\r\nThe following code:\r\n```\r\nimport pasta\r\npasta.parse('test(foo\\n[:2])')\r\n```\r\ncauses error:\r\n```\r\npasta.base.annotate.AnnotationError: Expected '[' but found '\\n'\r\nline 1: test(foo\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/54", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/54/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/54/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/54/events", "html_url": "https://github.com/google/pasta/issues/54", "id": 409537088, "node_id": "MDU6SXNzdWU0MDk1MzcwODg=", "number": 54, "title": "Error parsing [...]", "user": {"login": "annarev", "id": 22060313, "node_id": "MDQ6VXNlcjIyMDYwMzEz", "avatar_url": "https://avatars0.githubusercontent.com/u/22060313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/annarev", "html_url": "https://github.com/annarev", "followers_url": "https://api.github.com/users/annarev/followers", "following_url": "https://api.github.com/users/annarev/following{/other_user}", "gists_url": "https://api.github.com/users/annarev/gists{/gist_id}", "starred_url": "https://api.github.com/users/annarev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/annarev/subscriptions", "organizations_url": "https://api.github.com/users/annarev/orgs", "repos_url": "https://api.github.com/users/annarev/repos", "events_url": "https://api.github.com/users/annarev/events{/privacy}", "received_events_url": "https://api.github.com/users/annarev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-02-12T22:49:28Z", "updated_at": "2019-02-12T22:58:36Z", "closed_at": "2019-02-12T22:58:36Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I am running tf_upgrade_v2 tool in TensorFlow which is based on Pasta but hitting error parsing [...].\r\n\r\nSteps to reproduce:\r\nimport pasta\r\ntree = pasta.parse('foo[...] = 5')\r\n\r\nThis gives the following error:\r\npasta.base.annotate.AnnotationError: Expected '.' but found '['\r\nline 1: foo[...] = 5", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/50", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/50/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/50/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/50/events", "html_url": "https://github.com/google/pasta/issues/50", "id": 397169707, "node_id": "MDU6SXNzdWUzOTcxNjk3MDc=", "number": 50, "title": "Create release in pypi", "user": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-01-09T01:15:17Z", "updated_at": "2019-01-09T22:20:49Z", "closed_at": "2019-01-09T22:20:49Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/47", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/47/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/47/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/47/events", "html_url": "https://github.com/google/pasta/issues/47", "id": 389913972, "node_id": "MDU6SXNzdWUzODk5MTM5NzI=", "number": 47, "title": "Support PEP 526 Variable Annotations", "user": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828046, "node_id": "MDU6TGFiZWw3NjM4MjgwNDY=", "url": "https://api.github.com/repos/google/pasta/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-12-11T19:17:50Z", "updated_at": "2018-12-18T19:30:05Z", "closed_at": "2018-12-18T19:30:05Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "https://www.python.org/dev/peps/pep-0526/", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/46", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/46/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/46/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/46/events", "html_url": "https://github.com/google/pasta/issues/46", "id": 387198596, "node_id": "MDU6SXNzdWUzODcxOTg1OTY=", "number": 46, "title": "Undefined name 'lineno' in ./pasta/base/annotate.py", "user": {"login": "cclauss", "id": 3709715, "node_id": "MDQ6VXNlcjM3MDk3MTU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3709715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cclauss", "html_url": "https://github.com/cclauss", "followers_url": "https://api.github.com/users/cclauss/followers", "following_url": "https://api.github.com/users/cclauss/following{/other_user}", "gists_url": "https://api.github.com/users/cclauss/gists{/gist_id}", "starred_url": "https://api.github.com/users/cclauss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cclauss/subscriptions", "organizations_url": "https://api.github.com/users/cclauss/orgs", "repos_url": "https://api.github.com/users/cclauss/repos", "events_url": "https://api.github.com/users/cclauss/events{/privacy}", "received_events_url": "https://api.github.com/users/cclauss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-04T09:43:35Z", "updated_at": "2018-12-04T17:54:42Z", "closed_at": "2018-12-04T17:54:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "[flake8](http://flake8.pycqa.org) testing of https://github.com/google/pasta on Python 3.7.1\r\n\r\n$ __flake8 . --count --select=E901,E999,F821,F822,F823 --show-source --statistics__\r\n```\r\n./pasta/base/annotate.py:1143:48: F821 undefined name 'lineno'\r\n          'more than the outer indentation.' % lineno)\r\n                                               ^\r\n1     F821 undefined name 'lineno'\r\n1\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/38", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/38/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/38/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/38/events", "html_url": "https://github.com/google/pasta/issues/38", "id": 379901138, "node_id": "MDU6SXNzdWUzNzk5MDExMzg=", "number": 38, "title": "Docstring with \\n causes AnnotationError", "user": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-11-12T18:30:58Z", "updated_at": "2018-11-13T23:16:51Z", "closed_at": "2018-11-13T23:16:51Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**repro.py**\r\n```\r\nclass C:\r\n  def f1(self):\r\n    \"\"\"Doc.\r\n\r\n    String\\nwith\\nnewlines.\r\n    \"\"\"\r\n    pass\r\n\r\n  def f2(self):\r\n    pass\r\n```\r\n\r\n```\r\nPython 2.7.13 (default, Nov 24 2017, 17:33:09) \r\n[GCC 6.3.0 20170516] on linux2\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import pasta\r\n>>> with open('repro.py', 'r') as f:\r\n...   src = f.read()\r\n... \r\n>>> t = pasta.parse(src)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"pasta/__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"pasta/base/annotate.py\", line 1113, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"pasta/base/annotate.py\", line 126, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/usr/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"pasta/base/annotate.py\", line 46, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"pasta/base/annotate.py\", line 210, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"/usr/lib/python2.7/ast.py\", line 249, in generic_visit\r\n    self.visit(item)\r\n  File \"pasta/base/annotate.py\", line 1113, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"pasta/base/annotate.py\", line 126, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/usr/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"pasta/base/annotate.py\", line 89, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"pasta/base/annotate.py\", line 371, in visit_ClassDef\r\n    self.visit(stmt)\r\n  File \"pasta/base/annotate.py\", line 1113, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"pasta/base/annotate.py\", line 126, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/usr/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"pasta/base/annotate.py\", line 89, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"pasta/base/annotate.py\", line 398, in visit_FunctionDef\r\n    for stmt in self.indented(node, 'body'):\r\n  File \"pasta/base/annotate.py\", line 1143, in indented\r\n    'more than the outer indentation.' % lineno)\r\npasta.base.annotate.AnnotationError: Indent detection failed (line 1); inner indentation level is not more than the outer indentation.\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/35", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/35/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/35/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/35/events", "html_url": "https://github.com/google/pasta/issues/35", "id": 317724881, "node_id": "MDU6SXNzdWUzMTc3MjQ4ODE=", "number": 35, "title": "Support PEP 498 Literal String Interpolation (3.6+)", "user": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828046, "node_id": "MDU6TGFiZWw3NjM4MjgwNDY=", "url": "https://api.github.com/repos/google/pasta/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-04-25T17:34:11Z", "updated_at": "2019-08-05T16:20:49Z", "closed_at": "2019-08-05T16:20:49Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "https://www.python.org/dev/peps/pep-0498/\r\n\r\nThere may be names referenced in fstrings that have to change as part of a refactoring. Pasta should be able to help with this, at least detecting where they are used.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/31", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/31/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/31/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/31/events", "html_url": "https://github.com/google/pasta/issues/31", "id": 297821188, "node_id": "MDU6SXNzdWUyOTc4MjExODg=", "number": 31, "title": "Plethora of 2.7 parse issues", "user": {"login": "ndevenish", "id": 529963, "node_id": "MDQ6VXNlcjUyOTk2Mw==", "avatar_url": "https://avatars0.githubusercontent.com/u/529963?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ndevenish", "html_url": "https://github.com/ndevenish", "followers_url": "https://api.github.com/users/ndevenish/followers", "following_url": "https://api.github.com/users/ndevenish/following{/other_user}", "gists_url": "https://api.github.com/users/ndevenish/gists{/gist_id}", "starred_url": "https://api.github.com/users/ndevenish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ndevenish/subscriptions", "organizations_url": "https://api.github.com/users/ndevenish/orgs", "repos_url": "https://api.github.com/users/ndevenish/repos", "events_url": "https://api.github.com/users/ndevenish/events{/privacy}", "received_events_url": "https://api.github.com/users/ndevenish/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-02-16T15:25:37Z", "updated_at": "2020-03-18T22:09:10Z", "closed_at": "2020-03-18T22:09:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "Tried on our large and some-parts-somewhat-ancient 2.7-compatible codebase (the kind it'd be nice to have, say, automatic transformations for...). Most of the files worked but a few recurring issues - perhaps these come under \"some features not supported\" but I didn't see an explicit list anywhere. All come from real files that work.\r\n\r\n- Complex numbers don't work\r\n```python\r\n1j\r\n# AnnotationError: no ordering relation is defined for complex numbers\r\n```\r\n- Various issues with tuple parameter unpacking:\r\n```python\r\ndef a((b,c), d):\r\n  pass\r\n# AnnotationError: Expected ',' but found ')'\r\ndef some((a,b,c)):\r\n  pass\r\n# AnnotationError: Expected ':' but found ')'\r\n```\r\n\r\n- Slicing with steps:\r\n```python\r\nsome_sliceable[::]\r\n# AnnotationError: Expected 'None' but found ']'\r\n```\r\n- Calling functions with extra newlines:\r\n```python\r\ndef call_func(a, something_else): # valid function\r\n  pass\r\ncall_func((1\r\n,), something_else=True)\r\n\r\n# AnnotationError: Expected 'something_else' but found ')'\r\n```\r\n- `<>` operator: \r\n```python\r\nTrue <> False\r\n# AnnotationError: Expected '!=' but found '<>'\r\n```\r\n- BOM at start of file: \r\n```python\r\npasta.parse(\"\\xef\\xbb\\xbf\\r\\nimport sys\")\r\n# Expected 'import' but found '\\xef'`\r\n```\r\n\r\n- Old-style repr (for obvious reasons having trouble typing this one in markdown)\r\n```python\r\npasta.parse(\"\\x60True\\x60\")\r\n# Expected 'repr' but found '\\x60'\r\n```\r\n\r\n- Something with exec and lines?\r\n```python\r\nexec(\"\", None, None)\r\nTrue\r\n# Expected 'True' but found ')'\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/30", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/30/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/30/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/30/events", "html_url": "https://github.com/google/pasta/issues/30", "id": 296096310, "node_id": "MDU6SXNzdWUyOTYwOTYzMTA=", "number": 30, "title": "Consider jedi for refactoring  ", "user": {"login": "delijati", "id": 769969, "node_id": "MDQ6VXNlcjc2OTk2OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/769969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/delijati", "html_url": "https://github.com/delijati", "followers_url": "https://api.github.com/users/delijati/followers", "following_url": "https://api.github.com/users/delijati/following{/other_user}", "gists_url": "https://api.github.com/users/delijati/gists{/gist_id}", "starred_url": "https://api.github.com/users/delijati/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/delijati/subscriptions", "organizations_url": "https://api.github.com/users/delijati/orgs", "repos_url": "https://api.github.com/users/delijati/repos", "events_url": "https://api.github.com/users/delijati/events{/privacy}", "received_events_url": "https://api.github.com/users/delijati/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-10T12:13:52Z", "updated_at": "2018-02-12T17:27:27Z", "closed_at": "2018-02-12T17:27:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "The is already some work done in [jedi](https://github.com/davidhalter/jedi/issues/667) for refactoring ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/27", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/27/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/27/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/27/events", "html_url": "https://github.com/google/pasta/issues/27", "id": 290481237, "node_id": "MDU6SXNzdWUyOTA0ODEyMzc=", "number": 27, "title": "rename_external breaking with ValueError", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-01-22T14:20:56Z", "updated_at": "2018-01-26T23:54:46Z", "closed_at": "2018-01-26T23:54:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nRunning the rename_external on the following file `test.py` causes a `ValueError: <_ast.Name object at 0x0000000005322F98> is not in list`\r\n\r\nFile: test.py\r\n```\r\nfrom a.b import c\r\n\r\ndef ABC(oi=c):\r\n    pass\r\n```\r\n\r\nLog:\r\n```\r\n(test_pasta) \u03bb python s2.py\r\nTraceback (most recent call last):\r\n  File \"s2.py\", line 13, in <module>\r\n    rename.rename_external(tree, 'a.b.c', 'a.b.d')\r\n  File \"w:\\william\\repo_pasta\\pasta\\augment\\rename.py\", line 92, in rename_external\r\n    _rename_reads(sc, t, rename_old, rename_new)\r\n  File \"w:\\william\\repo_pasta\\pasta\\augment\\rename.py\", line 153, in _rename_reads\r\n    ast.parse(new_name).body[0].value)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\ast_utils.py\", line 240, in replace_child\r\n    field_val[field_val.index(node)] = replace_with\r\nValueError: <_ast.Name object at 0x0000000005252F98> is not in list\r\n```\r\n\r\nScript:\r\n\r\n```\r\nwith open('test.py', mode='r') as file:\r\n    tree = pasta.parse(file.read())\r\n    rename.rename_external(tree, 'a.b.c', 'a.b.d')\r\n```\r\n\r\n\r\ncc @nicoddemus", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/26", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/26/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/26/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/26/events", "html_url": "https://github.com/google/pasta/issues/26", "id": 289626632, "node_id": "MDU6SXNzdWUyODk2MjY2MzI=", "number": 26, "title": "Comment at the end of the file is being removed after executing pasta.dump", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-01-18T13:22:49Z", "updated_at": "2018-01-25T23:50:55Z", "closed_at": "2018-01-25T23:49:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi again =)\r\n\r\nI found this issue while running the following script \"script.py \"on file \"rename.py\"\r\nScript.py\r\n```\r\nimport os\r\nimport pasta\r\nfrom pasta.augment import rename\r\n\r\npath = r'rename.py'\r\nwith open(path, mode='r') as file:\r\n    tree = pasta.parse(file.read())\r\n    for moved_classes in list_of_classes_to_move:\r\n        rename.rename_external(tree, 'a.b.c', 'a.b.d')\r\n    source_code = pasta.dump(tree)\r\n\r\nwith open(path, mode='w') as file:\r\n    print(source_code)\r\n    file.write(source_code)\r\n```\r\n\r\nFile before the pasta.dump:\r\n```\r\nfrom a.b import c \r\n\r\nc\r\n\r\n#Testing\r\n#Test1\r\n```\r\n\r\nFile after the pasta.dump:\r\n```\r\nfrom a.b import d \r\n\r\nd\r\n\r\n```\r\n\r\n\r\nI've noticed that this issue just occurs when the commentary is at the end of the file, without any more code after it.\r\n\r\nSo in this example, the pasta.dump works just fine:\r\n```\r\nfrom a.b import c \r\n\r\nc\r\n\r\n#Testing\r\n#Test1\r\n\r\nprint('Hi')\r\n```\r\nAfter dump:\r\n```\r\nfrom a.b import d \r\n\r\nd\r\n\r\n#Testing\r\n#Test1\r\n\r\nprint('Hi')\r\n```\r\n\r\ncc @nicoddemus\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/25", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/25/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/25/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/25/events", "html_url": "https://github.com/google/pasta/issues/25", "id": 289307829, "node_id": "MDU6SXNzdWUyODkzMDc4Mjk=", "number": 25, "title": "Problem to recognize syntax", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-01-17T15:32:36Z", "updated_at": "2018-01-30T19:52:48Z", "closed_at": "2018-01-30T19:52:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nI have the following snippet that is valid in Python 2.7 and is correctly parsed.\r\n\r\n```numpy.array([list(range(10)), list(range(10))])[1, 3]```\r\n```numpy.array([list(range(10)), list(range(10))])[1:2, 3]```\r\n\r\nWhen I move the end bracket to a new line, the library cannot parse the code with a slice.\r\n\r\nWhat I mean is, this following code works correctly:\r\n```\r\nnumpy.array([list(range(10)), list(range(10))])[1, 3\r\n]\r\n```\r\n\r\nBut this one doesn't work:\r\n```\r\nnumpy.array([list(range(10)), list(range(10))])[1:2, 3\r\n]\r\n```\r\n\r\nExecuting:\r\n```\r\n(test_pasta) \u03bb python test.py\r\n\r\n(test_pasta) \u03bb python script.py\r\nTraceback (most recent call last):\r\n  File \"script.py\", line 6, in <module>\r\n    tree = pasta.parse(file.read())\r\n  File \"w:\\william\\repo_pasta\\pasta\\__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 168, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 249, in generic_visit\r\n    self.visit(item)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 513, in visit_Expr\r\n    self.visit(node.value)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 779, in visit_Subscript\r\n    self.visit(node.slice)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1013, in visit_ExtSlice\r\n    self.token(']')\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1106, in token\r\n    token_val, token.src, token.start[0], token.line))\r\npasta.base.annotate.AnnotationError: Expected ']' but found '\\n'\r\nline 1: numpy.array([list(range(10)), list(range(10))])[1:2, 3\r\n```\r\n\r\ncc @nicoddemus", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/24", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/24/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/24/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/24/events", "html_url": "https://github.com/google/pasta/issues/24", "id": 289105031, "node_id": "MDU6SXNzdWUyODkxMDUwMzE=", "number": 24, "title": "Failed to recognize trailing comma on import statement with parenthese", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-01-17T00:42:30Z", "updated_at": "2018-01-23T19:35:57Z", "closed_at": "2018-01-23T19:35:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nTrailing comma is not allowed in import, but when inside parentheses it's valid syntax\r\nI know that this one can sound too specific, but still a valid syntax =)\r\n\r\n\r\nfile:\r\n```\r\nfrom foo.a import (do,)\r\n\r\ndo()\r\n\r\n```\r\nScript:\r\n```\r\nimport pasta\r\nfrom pasta.augment import rename\r\n\r\npath = r'test.py'\r\n\r\n\r\nwith open(path) as file:\r\n    tree = pasta.parse(file.read())\r\n\r\n```\r\n\r\nFull stack trace\r\n```\r\nTraceback (most recent call last):\r\n  File \"script.py\", line 8, in <module>\r\n    tree = pasta.parse(file.read())\r\n  File \"/opt/pasta/pasta/__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1055, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 168, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py27/lib/python2.7/ast.py\", line 249, in generic_visit\r\n    self.visit(item)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1055, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 520, in visit_Expr\r\n    self.visit(node.value)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1055, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 637, in visit_Call\r\n    self.visit(node.func)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1055, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py27/lib/python2.7/ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 754, in visit_Name\r\n    self.token(node.id)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1118, in token\r\n    token_val, token.src, token.start[0], token.line))\r\npasta.base.annotate.AnnotationError: Expected 'do' but found ','\r\nline 1: from foo.a import (do,)\r\n\r\n```\r\n\r\ncc @nicoddemus", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/23", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/23/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/23/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/23/events", "html_url": "https://github.com/google/pasta/issues/23", "id": 288899043, "node_id": "MDU6SXNzdWUyODg4OTkwNDM=", "number": 23, "title": "Failed to recognize nested try:", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}, {"id": 807941737, "node_id": "MDU6TGFiZWw4MDc5NDE3Mzc=", "url": "https://api.github.com/repos/google/pasta/labels/syntax", "name": "syntax", "color": "fbca04", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-01-16T13:02:34Z", "updated_at": "2018-02-01T00:38:26Z", "closed_at": "2018-02-01T00:38:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nRunning the parser against a file with \"nested try\" results in the following error:\r\n\r\n```\r\npasta.base.annotate.AnnotationError: Expected 'error' but found 'try'\r\nline 2:     try:\r\n```\r\n\r\nI found this issue with \r\n```\r\nPython 2.7.8 :: Continuum Analytics, Inc.\r\nPython 2.7.9 :: Continuum Analytics, Inc.\r\nPython 2.7.12\r\n```\r\n\r\n(In python 3.4.5 works just fine)\r\n\r\nTest.py\r\n```\r\ntry:\r\n    try:\r\n        error = 1/0\r\n    except:\r\n        print('1')\r\nfinally:\r\n    print('2')\r\n```\r\n\r\n\r\nScript.py:\r\n```\r\nimport os\r\nimport pasta\r\n\r\npath = r'test.py'\r\nwith open(path) as file:\r\n   tree = pasta.parse(file.read())\r\n```\r\n\r\nFull Log:\r\n```\r\nTraceback (most recent call last):\r\n  File \"script.py\", line 10, in <module>\r\n    tree = pasta.parse(file.read())\r\n  File \"w:\\william\\repo_pasta\\pasta\\__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 168, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 249, in generic_visit\r\n    self.visit(item)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 367, in visit_TryFinally\r\n    self.visit(stmt)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 379, in visit_TryExcept\r\n    self.visit(stmt)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 470, in visit_Assign\r\n    self.visit(target)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1048, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\alfasim\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 747, in visit_Name\r\n    self.token(node.id)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1106, in token\r\n    token_val, token.src, token.start[0], token.line))\r\npasta.base.annotate.AnnotationError: Expected 'error' but found 'try'\r\nline 2:     try:\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/21", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/21/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/21/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/21/events", "html_url": "https://github.com/google/pasta/issues/21", "id": 287621607, "node_id": "MDU6SXNzdWUyODc2MjE2MDc=", "number": 21, "title": "Failed to recognize comma on exec function on python2.7", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-01-11T00:12:25Z", "updated_at": "2019-01-09T01:06:40Z", "closed_at": "2019-01-09T01:06:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nThe parser does not recognize the comma on exec function with python2.7\r\n\r\nI did try to create a PR solving this issue, I was doing a function \" in_or_comma() \" but I realized that the problem would be deeper than this because the `visit_exec` is treating the exec as a statement instead of function. Am I right?\r\n\r\nHere it's a small reproducible example of the error:\r\n\r\nFile:\r\n`exec('x = 10' ,  {} )`\r\n\r\nScript:\r\n```\r\nimport pasta\r\nfrom pasta.augment import rename\r\n\r\npath = r'test.py'\r\n\r\nwith open(path) as file:\r\n        tree = pasta.parse(file.read())\r\n```\r\nError:\r\n```\r\npasta.base.annotate.AnnotationError: Expected 'in' but found ','\r\nline 1: exec ('x = 10', {})\r\n\r\n```\r\n\r\n\r\n\r\n\r\ncc @nicoddemus\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/19", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/19/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/19/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/19/events", "html_url": "https://github.com/google/pasta/issues/19", "id": 287262035, "node_id": "MDU6SXNzdWUyODcyNjIwMzU=", "number": 19, "title": "Failed to recognize semicolons on python file ", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-01-09T23:09:14Z", "updated_at": "2018-01-25T23:14:26Z", "closed_at": "2018-01-25T23:14:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nThe parser does not recognize the semicolons on python files.\r\nI don't know how often people use semicolons as separator on python, but I think that it's a good idea to provide some support for such cases =)\r\n\r\nHere it's a small reproducible example of the error:\r\n\r\nFile:\r\n`a=(1+1);print(a)\r\n`\r\n\r\nScript\r\n```\r\nimport pasta\r\nfrom pasta.augment import rename\r\n\r\npath = r'test.py'\r\n\r\nwith open(path) as file:\r\n        tree = pasta.parse(file.read())\r\n```\r\n\r\nError:\r\n```\r\nTraceback (most recent call last):\r\n\r\n  File \"script.py\", line 7, in <module>\r\n    tree = pasta.parse(file.read())\r\n  File \"/opt/pasta/pasta/__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1044, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py34/lib/python3.4/ast.py\", line 245, in visit\r\n    return visitor(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 166, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py34/lib/python3.4/ast.py\", line 253, in generic_visit\r\n    self.visit(item)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1044, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py34/lib/python3.4/ast.py\", line 245, in visit\r\n    return visitor(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 509, in visit_Expr\r\n    self.visit(node.value)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1044, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py34/lib/python3.4/ast.py\", line 245, in visit\r\n    return visitor(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 626, in visit_Call\r\n    self.visit(node.func)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1044, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/william/miniconda3/envs/google_pasta_py34/lib/python3.4/ast.py\", line 245, in visit\r\n    return visitor(node)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 743, in visit_Name\r\n    self.token(node.id)\r\n  File \"/opt/pasta/pasta/base/annotate.py\", line 1094, in token\r\n    token_val, token.src, token.start[0], token.line))\r\npasta.base.annotate.AnnotationError: Expected 'print' but found ';'\r\nline 1: a=(1+1);print(a)\r\n\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/18", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/18/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/18/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/18/events", "html_url": "https://github.com/google/pasta/issues/18", "id": 286880971, "node_id": "MDU6SXNzdWUyODY4ODA5NzE=", "number": 18, "title": "Failed to recognize empty __init__.py", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-01-08T20:47:33Z", "updated_at": "2018-01-08T21:46:58Z", "closed_at": "2018-01-08T21:46:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello,\r\n\r\nRunning google-pasta with python 2.7 against a empty `__init__.py` file throws a `pasta.base.annotate.AnnotationError  list index out of range`\r\n\r\nScript:\r\n```\r\nimport pasta\r\npath = r'__init__.py'\r\nwith open(path) as file:\r\n    tree = pasta.parse(file.read())\r\n```\r\n\r\nStack:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"script.py\", line 10, in <module>\r\n    tree = pasta.parse(file.read())\r\n  File \"w:\\william\\repo_pasta\\pasta\\__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"w:\\william\\repo_pasta\\pasta\\base\\annotate.py\", line 1042, in visit\r\n    raise AnnotationError(e)\r\npasta.base.annotate.AnnotationError: list index out of range\r\n\r\n```\r\n  ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/16", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/16/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/16/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/16/events", "html_url": "https://github.com/google/pasta/issues/16", "id": 286731627, "node_id": "MDU6SXNzdWUyODY3MzE2Mjc=", "number": 16, "title": "Failed to recognize import with parentheses", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-01-08T12:32:57Z", "updated_at": "2018-01-09T22:52:53Z", "closed_at": "2018-01-09T22:52:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi Nick,\r\n\r\nRunning google-pasta with python 2.7 against a file that has an import with parentheses throws a `pasta.base.annotate.AnnotationError:`\r\n\r\nI'm using Python 2.7\r\n```\r\n(test_pasta) \u03bb python --version\r\nPython 2.7.12\r\n```\r\nWith the following script:\r\n```\r\nimport pasta\r\nfrom pasta.augment import rename\r\n\r\npath = r'test.py'\r\n\r\nwith open(path) as file:\r\n    tree = pasta.parse(file.read())\r\n```\r\n\r\nOn the test.py file:\r\n```\r\nfrom test2 import (test2)\r\nprint(test2.ID)\r\n```\r\n\r\nError:\r\n```\r\npasta.base.annotate.AnnotationError: Expected 'test2' but found '('\r\nline 1: from test2 import (test2)\r\n```\r\n\r\nFull stack trace:\r\n```\r\nTraceback (most recent call last):\r\n  File \"script.py\", line 10, in <module>\r\n    tree = pasta.parse(file.read())\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1038, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 162, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 249, in generic_visit\r\n    self.visit(item)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1038, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 545, in visit_ImportFrom\r\n    self.visit(alias)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1038, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 43, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 910, in visit_alias\r\n    default=node.name)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1148, in attr\r\n    attr_parts.append(self.token(attr_val))\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1088, in token\r\n    token_val, token.src, token.start[0], token.line))\r\n```\r\n  \r\n\r\n\r\ncc @nicoddemus", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/15", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/15/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/15/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/15/events", "html_url": "https://github.com/google/pasta/issues/15", "id": 286387568, "node_id": "MDU6SXNzdWUyODYzODc1Njg=", "number": 15, "title": "Failed to recognize python2 syntax for exception", "user": {"login": "williamjamir", "id": 5083518, "node_id": "MDQ6VXNlcjUwODM1MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5083518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/williamjamir", "html_url": "https://github.com/williamjamir", "followers_url": "https://api.github.com/users/williamjamir/followers", "following_url": "https://api.github.com/users/williamjamir/following{/other_user}", "gists_url": "https://api.github.com/users/williamjamir/gists{/gist_id}", "starred_url": "https://api.github.com/users/williamjamir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/williamjamir/subscriptions", "organizations_url": "https://api.github.com/users/williamjamir/orgs", "repos_url": "https://api.github.com/users/williamjamir/repos", "events_url": "https://api.github.com/users/williamjamir/events{/privacy}", "received_events_url": "https://api.github.com/users/williamjamir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-01-05T19:51:54Z", "updated_at": "2018-01-05T22:19:36Z", "closed_at": "2018-01-05T22:19:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nRunning google-pasta with python 2.7 against a file that has an try/except that follows the syntax from Python2 throws a `pasta.base.annotate.AnnotationError` saying that `Expected 'as' but found ','`\r\n\r\nBelow you can see a minimum code that reproduces the problem\r\n\r\nUsing Python 2.7\r\n```\r\n(test_pasta) \u03bb python --version\r\nPython 2.7.12\r\n```\r\n\r\nFile test.py\r\n```\r\ndef foo():\r\n    try:\r\n        pass\r\n    except Exception, e:\r\n        pass\r\n\r\n```\r\nScript:\r\n```\r\nimport pasta\r\npath = r'test.py'\r\n\r\nwith open(path) as file:\r\n    tree = pasta.parse(file.read())\r\n```\r\n\r\nThrows the following error:\r\n\r\n```\r\npasta.base.annotate.AnnotationError: Expected 'as' but found ','\r\nline 4:     except Exception, e:\r\n```\r\n\r\nFull StackStrace\r\n```\r\nTraceback (most recent call last):\r\n  File \"past_script.py\", line 15, in <module>\r\n    tree = pasta.parse(file.read())\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1033, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 158, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 249, in generic_visit\r\n    self.visit(item)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1033, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 347, in visit_FunctionDef\r\n    self.visit(stmt)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1033, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 371, in visit_TryExcept\r\n    self.visit(handler)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1033, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 115, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\ast.py\", line 241, in visit\r\n    return visitor(node)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 79, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 407, in visit_ExceptHandler\r\n    self.attr(node, 'as', [self.ws, 'as', self.ws], default=' as ')\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1139, in attr\r\n    attr_parts.append(self.token(attr_val))\r\n  File \"W:\\william\\envs\\test_pasta\\lib\\site-packages\\pasta\\base\\annotate.py\", line 1083, in token\r\n    token_val, token.src, token.start[0], token.line))\r\npasta.base.annotate.AnnotationError: Expected 'as' but found ','\r\nline 4:     except Exception, e:\r\n```\r\n\r\n\r\ncc: @nicoddemus\r\n\r\n  ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/13", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/13/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/13/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/13/events", "html_url": "https://github.com/google/pasta/issues/13", "id": 285556011, "node_id": "MDU6SXNzdWUyODU1NTYwMTE=", "number": 13, "title": "Whitespace different for methods with tuples at end", "user": {"login": "akov", "id": 28480, "node_id": "MDQ6VXNlcjI4NDgw", "avatar_url": "https://avatars3.githubusercontent.com/u/28480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akov", "html_url": "https://github.com/akov", "followers_url": "https://api.github.com/users/akov/followers", "following_url": "https://api.github.com/users/akov/following{/other_user}", "gists_url": "https://api.github.com/users/akov/gists{/gist_id}", "starred_url": "https://api.github.com/users/akov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akov/subscriptions", "organizations_url": "https://api.github.com/users/akov/orgs", "repos_url": "https://api.github.com/users/akov/repos", "events_url": "https://api.github.com/users/akov/events{/privacy}", "received_events_url": "https://api.github.com/users/akov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-01-02T22:36:16Z", "updated_at": "2018-01-03T17:48:53Z", "closed_at": "2018-01-03T17:48:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\r\nIn [25]: code = \"\"\"\\                                                                                                                                                                                                \r\nclass Foo():\r\n  def a(self):\r\n    return 1\r\n\r\n  def b(self):\r\n    return 2\r\n\r\n  def c(self):\r\n    return 3\r\n\"\"\"\r\n\r\nIn [26]: tree = pasta.parse(code)                                                                                                                                                                                   \r\n\r\nIn [27]: tree.body[0].body.pop(1).name                                                                                                                                                                              \r\nOut[27]: 'b'\r\n\r\nIn [28]: print pasta.dump(tree)                                                                                                                                                                                     \r\nclass Foo():\r\n  def a(self):\r\n    return 1\r\n\r\n  def c(self):\r\n    return 3\r\n\r\n\r\nIn [29]: code = \"\"\"\\                                                                                                                                                                                                \r\nclass Foo():\r\n  def a(self):\r\n    return 1\r\n\r\n  def b(self):\r\n    return 2,'a'\r\n\r\n  def c(self):\r\n    return 3\r\n\"\"\"\r\n\r\nIn [30]: tree = pasta.parse(code)\r\n\r\nIn [31]: tree.body[0].body.pop(1).name\r\nOut[31]: 'b'\r\n\r\nIn [32]: print pasta.dump(tree)\r\nclass Foo():\r\n  def a(self):\r\n    return 1\r\ndef c(self):\r\n    return 3\r\n\r\n```\r\n\r\nThe first snippet here acts as expected. I would expect the result of the second snippet to be the same, but in reality a newline seems to get lost.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/google/pasta/issues/3", "repository_url": "https://api.github.com/repos/google/pasta", "labels_url": "https://api.github.com/repos/google/pasta/issues/3/labels{/name}", "comments_url": "https://api.github.com/repos/google/pasta/issues/3/comments", "events_url": "https://api.github.com/repos/google/pasta/issues/3/events", "html_url": "https://github.com/google/pasta/issues/3", "id": 277910527, "node_id": "MDU6SXNzdWUyNzc5MTA1Mjc=", "number": 3, "title": "Doesn't respect comments between functions", "user": {"login": "akov", "id": 28480, "node_id": "MDQ6VXNlcjI4NDgw", "avatar_url": "https://avatars3.githubusercontent.com/u/28480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akov", "html_url": "https://github.com/akov", "followers_url": "https://api.github.com/users/akov/followers", "following_url": "https://api.github.com/users/akov/following{/other_user}", "gists_url": "https://api.github.com/users/akov/gists{/gist_id}", "starred_url": "https://api.github.com/users/akov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akov/subscriptions", "organizations_url": "https://api.github.com/users/akov/orgs", "repos_url": "https://api.github.com/users/akov/repos", "events_url": "https://api.github.com/users/akov/events{/privacy}", "received_events_url": "https://api.github.com/users/akov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 763828044, "node_id": "MDU6TGFiZWw3NjM4MjgwNDQ=", "url": "https://api.github.com/repos/google/pasta/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "soupytwist", "id": 1455827, "node_id": "MDQ6VXNlcjE0NTU4Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1455827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soupytwist", "html_url": "https://github.com/soupytwist", "followers_url": "https://api.github.com/users/soupytwist/followers", "following_url": "https://api.github.com/users/soupytwist/following{/other_user}", "gists_url": "https://api.github.com/users/soupytwist/gists{/gist_id}", "starred_url": "https://api.github.com/users/soupytwist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soupytwist/subscriptions", "organizations_url": "https://api.github.com/users/soupytwist/orgs", "repos_url": "https://api.github.com/users/soupytwist/repos", "events_url": "https://api.github.com/users/soupytwist/events{/privacy}", "received_events_url": "https://api.github.com/users/soupytwist/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2017-11-29T21:19:42Z", "updated_at": "2017-12-04T20:02:04Z", "closed_at": "2017-12-04T20:01:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When you try to remove a function it seems to count comments after it that are clearly not on the indentation level of the body of the function as part of the function and they seem to get removed.\r\n\r\n```\r\nIn [4]: src = \"\"\"\\\r\n   ...: x = 3\r\n   ...: def f(y):\r\n   ...:   return y + 2\r\n   ...: # lol\r\n   ...: def g(y):\r\n   ...:   return y + 7\r\n   ...: \"\"\"\r\n\r\nIn [5]: n = pasta.parse(src)\r\n\r\nIn [6]: n\r\nOut[6]: <_ast.Module at 0x3ac1750>\r\n\r\nIn [7]: n.body\r\nOut[7]: \r\n[<_ast.Assign at 0x3ac1790>,\r\n <_ast.FunctionDef at 0x3ac1b10>,\r\n <_ast.FunctionDef at 0x3ac19d0>]\r\n\r\nIn [8]: n.body = n.body[n.body[0], n.body[2]]\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-8-5d440e76f12a> in <module>()\r\n----> 1 n.body = n.body[n.body[0], n.body[2]]\r\n\r\nTypeError: list indices must be integers, not tuple\r\n\r\nIn [9]: n.body = [n.body[0], n.body[2]]\r\n\r\nIn [10]: n.body\r\nOut[10]: [<_ast.Assign at 0x3ac1790>, <_ast.FunctionDef at 0x3ac19d0>]\r\n\r\nIn [11]: pasta.dump(n)\r\nOut[11]: 'x = 3\\ndef g(y):\\n  return y + 7\\n'\r\n\r\nIn [12]: print pasta.dump(n)\r\nx = 3\r\ndef g(y):\r\n  return y + 7\r\n```", "performed_via_github_app": null, "score": 1.0}]}