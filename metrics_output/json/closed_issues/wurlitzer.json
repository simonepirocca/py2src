{"total_count": 15, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/minrk/wurlitzer/issues/39", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/39/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/39/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/39/events", "html_url": "https://github.com/minrk/wurlitzer/issues/39", "id": 681348869, "node_id": "MDU6SXNzdWU2ODEzNDg4Njk=", "number": 39, "title": "%unload_ext wurlitzer doesn't work", "user": {"login": "realead", "id": 17513912, "node_id": "MDQ6VXNlcjE3NTEzOTEy", "avatar_url": "https://avatars2.githubusercontent.com/u/17513912?v=4", "gravatar_id": "", "url": "https://api.github.com/users/realead", "html_url": "https://github.com/realead", "followers_url": "https://api.github.com/users/realead/followers", "following_url": "https://api.github.com/users/realead/following{/other_user}", "gists_url": "https://api.github.com/users/realead/gists{/gist_id}", "starred_url": "https://api.github.com/users/realead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/realead/subscriptions", "organizations_url": "https://api.github.com/users/realead/orgs", "repos_url": "https://api.github.com/users/realead/repos", "events_url": "https://api.github.com/users/realead/events{/privacy}", "received_events_url": "https://api.github.com/users/realead/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-08-18T21:19:31Z", "updated_at": "2020-08-19T13:01:15Z", "closed_at": "2020-08-19T13:01:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "For the following notebook:\r\n\r\n```\r\n#[1]:\r\n%load_ext Cython\r\n\r\n#[2]:\r\n%%cython\r\nfrom libc.stdio cimport printf\r\ndef print_to_cstdout(const char* s):\r\n    printf(\"%s\", s)\r\n\r\n#[3]:\r\n%load_ext wurlitzer\r\n\r\n#[4]:\r\nprint_to_cstdout(b\"first\\n\")\r\n#output: first\r\n\r\n#[5]:\r\n%unload_ext wurlitzer\r\n\r\n#[6]:\r\nprint_to_cstdout(b\"second\\n\")\r\n#output: second\r\n```\r\n\r\nThere is a problem as the output to c-stdout is still captured (\"second\" is printed to the notebook)\r\n\r\nThe problem seems to be that for the line-magic `%unload_ext wurlitzer`,  `sys_pipes_forever` runs due to the `pre_execute`-hook/event, but after the corresponding `stop_sys_pipes` doesn't not because it gets unregistered.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/37", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/37/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/37/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/37/events", "html_url": "https://github.com/minrk/wurlitzer/issues/37", "id": 650336568, "node_id": "MDU6SXNzdWU2NTAzMzY1Njg=", "number": 37, "title": "Capturing redirected output", "user": {"login": "mrzv", "id": 720816, "node_id": "MDQ6VXNlcjcyMDgxNg==", "avatar_url": "https://avatars2.githubusercontent.com/u/720816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrzv", "html_url": "https://github.com/mrzv", "followers_url": "https://api.github.com/users/mrzv/followers", "following_url": "https://api.github.com/users/mrzv/following{/other_user}", "gists_url": "https://api.github.com/users/mrzv/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrzv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrzv/subscriptions", "organizations_url": "https://api.github.com/users/mrzv/orgs", "repos_url": "https://api.github.com/users/mrzv/repos", "events_url": "https://api.github.com/users/mrzv/events{/privacy}", "received_events_url": "https://api.github.com/users/mrzv/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-03T04:35:21Z", "updated_at": "2020-07-06T08:12:51Z", "closed_at": "2020-07-06T08:12:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following simple example behaves differently if I run it plain or with stdout redirected to a file (by the shell). Is this expected behavior? If yes, is there a way to capture output in the second case as well?\r\n\r\n```python\r\nfrom io import StringIO\r\nfrom wurlitzer import pipes, STDOUT\r\n\r\ndef f():\r\n    print(\"Hello from f\")\r\n\r\nout = StringIO()\r\nwith pipes(stdout=out, stderr=STDOUT):\r\n    f()\r\nprint(\"Captured:\", out.getvalue())\r\n```\r\n\r\n```\r\n$ python test.py\r\nCaptured: Hello from f\r\n\r\n```\r\n\r\n```\r\n$ python test.py > out\r\n$ cat out\r\nHello from f\r\nCaptured: ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/35", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/35/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/35/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/35/events", "html_url": "https://github.com/minrk/wurlitzer/issues/35", "id": 510631992, "node_id": "MDU6SXNzdWU1MTA2MzE5OTI=", "number": 35, "title": "Tests in test.py", "user": {"login": "alexmarie78", "id": 45236882, "node_id": "MDQ6VXNlcjQ1MjM2ODgy", "avatar_url": "https://avatars0.githubusercontent.com/u/45236882?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexmarie78", "html_url": "https://github.com/alexmarie78", "followers_url": "https://api.github.com/users/alexmarie78/followers", "following_url": "https://api.github.com/users/alexmarie78/following{/other_user}", "gists_url": "https://api.github.com/users/alexmarie78/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexmarie78/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexmarie78/subscriptions", "organizations_url": "https://api.github.com/users/alexmarie78/orgs", "repos_url": "https://api.github.com/users/alexmarie78/repos", "events_url": "https://api.github.com/users/alexmarie78/events{/privacy}", "received_events_url": "https://api.github.com/users/alexmarie78/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-22T12:46:50Z", "updated_at": "2020-08-20T09:37:03Z", "closed_at": "2020-08-20T09:37:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, \r\n\r\nI am packaging wurlitzer for debian.\r\nThe issue is that the tests do not run when calling test.py. \r\nThere is no main in the file so I think this is the problem.\r\nHow can we run the tests ?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/32", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/32/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/32/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/32/events", "html_url": "https://github.com/minrk/wurlitzer/issues/32", "id": 473343707, "node_id": "MDU6SXNzdWU0NzMzNDM3MDc=", "number": 32, "title": "wulitzer fires an exception on macOS and probably any BSD-like system", "user": {"login": "Mottl", "id": 4404433, "node_id": "MDQ6VXNlcjQ0MDQ0MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/4404433?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mottl", "html_url": "https://github.com/Mottl", "followers_url": "https://api.github.com/users/Mottl/followers", "following_url": "https://api.github.com/users/Mottl/following{/other_user}", "gists_url": "https://api.github.com/users/Mottl/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mottl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mottl/subscriptions", "organizations_url": "https://api.github.com/users/Mottl/orgs", "repos_url": "https://api.github.com/users/Mottl/repos", "events_url": "https://api.github.com/users/Mottl/events{/privacy}", "received_events_url": "https://api.github.com/users/Mottl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-26T12:53:12Z", "updated_at": "2019-10-25T11:40:20Z", "closed_at": "2019-10-25T11:40:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "macOS and BSD systems lack `select.poll`:\r\n\r\n```\r\nFile \"/Users/admin/src/wurlitzer/wurlitzer.py\", line 179, in forwarder\r\n    poller = select.poll()\r\nAttributeError: module 'select' has no attribute 'poll'\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/29", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/29/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/29/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/29/events", "html_url": "https://github.com/minrk/wurlitzer/issues/29", "id": 452139718, "node_id": "MDU6SXNzdWU0NTIxMzk3MTg=", "number": 29, "title": "Error when several threads use wurlitzer", "user": {"login": "impact27", "id": 6740194, "node_id": "MDQ6VXNlcjY3NDAxOTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6740194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impact27", "html_url": "https://github.com/impact27", "followers_url": "https://api.github.com/users/impact27/followers", "following_url": "https://api.github.com/users/impact27/following{/other_user}", "gists_url": "https://api.github.com/users/impact27/gists{/gist_id}", "starred_url": "https://api.github.com/users/impact27/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impact27/subscriptions", "organizations_url": "https://api.github.com/users/impact27/orgs", "repos_url": "https://api.github.com/users/impact27/repos", "events_url": "https://api.github.com/users/impact27/events{/privacy}", "received_events_url": "https://api.github.com/users/impact27/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-06-04T18:20:24Z", "updated_at": "2019-06-13T08:34:02Z", "closed_at": "2019-06-13T08:34:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```python-traceback\r\nTraceback (most recent call last):\r\n\r\n  File \"/usr/local/lib/python3.7/site-packages/wurlitzer.py\", line 327, in stop_sys_pipes\r\n    _mighty_wurlitzer.__exit__(None, None, None)\r\n\r\n  File \"/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py\", line 119, in __exit__\r\n    next(self.gen)\r\n\r\nValueError: generator already executing\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/27", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/27/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/27/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/27/events", "html_url": "https://github.com/minrk/wurlitzer/issues/27", "id": 451818712, "node_id": "MDU6SXNzdWU0NTE4MTg3MTI=", "number": 27, "title": "wurlitzer tries to __enter__ multiple times", "user": {"login": "impact27", "id": 6740194, "node_id": "MDQ6VXNlcjY3NDAxOTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6740194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impact27", "html_url": "https://github.com/impact27", "followers_url": "https://api.github.com/users/impact27/followers", "following_url": "https://api.github.com/users/impact27/following{/other_user}", "gists_url": "https://api.github.com/users/impact27/gists{/gist_id}", "starred_url": "https://api.github.com/users/impact27/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impact27/subscriptions", "organizations_url": "https://api.github.com/users/impact27/orgs", "repos_url": "https://api.github.com/users/impact27/repos", "events_url": "https://api.github.com/users/impact27/events{/privacy}", "received_events_url": "https://api.github.com/users/impact27/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-06-04T06:26:32Z", "updated_at": "2019-06-13T08:34:03Z", "closed_at": "2019-06-13T08:34:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I am not sure exactly how I manage to get this error, but here is the traceback I get: \r\n```python-traceback\r\nError in callback <function sys_pipes_forever at 0x11a0d49d8> (for pre_execute):\r\n\r\nTraceback (most recent call last):\r\n\r\n  File \"/usr/local/lib/python3.7/site-packages/wurlitzer.py\", line 320, in sys_pipes_forever\r\n    _mighty_wurlitzer.__enter__()\r\n\r\n  File \"/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py\", line 110, in __enter__\r\n    del self.args, self.kwds, self.func\r\n\r\nAttributeError: args\r\n```\r\n\r\nLooking at the `sys_pipes_forever` function, it looks like `__enter__` is called even if wurlitzer already called `__enter__`. As pointed out in the comment above line 110:\r\n```\r\n        # do not keep args and kwds alive unnecessarily\r\n        # they are only needed for recreation, which is not possible anymore\r\n```\r\nThis means that `__enter__` can not be called more than once.\r\n\r\nMaybe this could be fixed by changing the indentation of line 320?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/22", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/22/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/22/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/22/events", "html_url": "https://github.com/minrk/wurlitzer/issues/22", "id": 385207109, "node_id": "MDU6SXNzdWUzODUyMDcxMDk=", "number": 22, "title": "filedescriptor out of range in select()", "user": {"login": "jayendra13", "id": 651057, "node_id": "MDQ6VXNlcjY1MTA1Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/651057?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jayendra13", "html_url": "https://github.com/jayendra13", "followers_url": "https://api.github.com/users/jayendra13/followers", "following_url": "https://api.github.com/users/jayendra13/following{/other_user}", "gists_url": "https://api.github.com/users/jayendra13/gists{/gist_id}", "starred_url": "https://api.github.com/users/jayendra13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jayendra13/subscriptions", "organizations_url": "https://api.github.com/users/jayendra13/orgs", "repos_url": "https://api.github.com/users/jayendra13/repos", "events_url": "https://api.github.com/users/jayendra13/events{/privacy}", "received_events_url": "https://api.github.com/users/jayendra13/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-11-28T10:46:17Z", "updated_at": "2018-12-12T10:05:37Z", "closed_at": "2018-12-12T10:05:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "Here is the way to reproduce this.\r\n\r\n    $ ulimit -n\r\n    1048576\r\n\r\nSo the process can open max 1048576 files.\r\nThe following snippet is creating file descriptor objects which exceeds 1024 and puts the fid having greater than 1024 at that moment `select` function raises the error `ValueError: filedescriptor out of range in select()`\r\n\r\n    import os, sys, select\r\n    \r\n    my_fd = sys.stdout.fileno()\r\n    enough = False\r\n    fids = []\r\n    \r\n    while not enough:\r\n        f_ = os.dup(my_fd)\r\n        fids.append(f_)\r\n        if f_ > 1024:\r\n            enough = True\r\n    \r\n    r, w, x = select.select(fids[-2:], [], [], None)\r\n\r\nSo my process has already opened 1K files and later I try to use Wurlitzer, it won't work.\r\n\r\nhttps://mail.python.org/pipermail/python-list/2009-March/529177.html", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/17", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/17/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/17/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/17/events", "html_url": "https://github.com/minrk/wurlitzer/issues/17", "id": 323824758, "node_id": "MDU6SXNzdWUzMjM4MjQ3NTg=", "number": 17, "title": "Push new version to PyPI", "user": {"login": "gidim", "id": 5440856, "node_id": "MDQ6VXNlcjU0NDA4NTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/5440856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gidim", "html_url": "https://github.com/gidim", "followers_url": "https://api.github.com/users/gidim/followers", "following_url": "https://api.github.com/users/gidim/following{/other_user}", "gists_url": "https://api.github.com/users/gidim/gists{/gist_id}", "starred_url": "https://api.github.com/users/gidim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gidim/subscriptions", "organizations_url": "https://api.github.com/users/gidim/orgs", "repos_url": "https://api.github.com/users/gidim/repos", "events_url": "https://api.github.com/users/gidim/events{/privacy}", "received_events_url": "https://api.github.com/users/gidim/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-16T23:43:00Z", "updated_at": "2018-05-20T17:50:14Z", "closed_at": "2018-05-20T17:50:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thanks for fixing the race condition! Can you push the latest version to PyPi?\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/15", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/15/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/15/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/15/events", "html_url": "https://github.com/minrk/wurlitzer/issues/15", "id": 321673316, "node_id": "MDU6SXNzdWUzMjE2NzMzMTY=", "number": 15, "title": "Wurlitzer hangs process when pipe/buffer is full", "user": {"login": "gidim", "id": 5440856, "node_id": "MDQ6VXNlcjU0NDA4NTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/5440856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gidim", "html_url": "https://github.com/gidim", "followers_url": "https://api.github.com/users/gidim/followers", "following_url": "https://api.github.com/users/gidim/following{/other_user}", "gists_url": "https://api.github.com/users/gidim/gists{/gist_id}", "starred_url": "https://api.github.com/users/gidim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gidim/subscriptions", "organizations_url": "https://api.github.com/users/gidim/orgs", "repos_url": "https://api.github.com/users/gidim/repos", "events_url": "https://api.github.com/users/gidim/events{/privacy}", "received_events_url": "https://api.github.com/users/gidim/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-05-09T18:16:14Z", "updated_at": "2018-05-16T11:11:44Z", "closed_at": "2018-05-16T11:11:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nWe're using Wurlitzer at Comet.ml and we found that when the C library prints a large string\r\nthe entire process hangs. We manage to create a test that reproduces this. Would it be possible to increase the buffer size or find a workaround?\r\n\r\n```\r\ndef test_buffer_full():\r\n    with pipes(stdout=PIPE, stderr=PIPE) as (stdout, stderr):\r\n        long_string = \"x\" * 1000000 # create a very long string\r\n        printf_err(long_string)\r\n\r\n    # Test never reaches here as the process hangs.\r\n    assert stderr.read() == long_string+\"\\n\"\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/10", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/10/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/10/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/10/events", "html_url": "https://github.com/minrk/wurlitzer/issues/10", "id": 289025241, "node_id": "MDU6SXNzdWUyODkwMjUyNDE=", "number": 10, "title": "Core dump on Python3", "user": {"login": "Lothiraldan", "id": 243665, "node_id": "MDQ6VXNlcjI0MzY2NQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/243665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lothiraldan", "html_url": "https://github.com/Lothiraldan", "followers_url": "https://api.github.com/users/Lothiraldan/followers", "following_url": "https://api.github.com/users/Lothiraldan/following{/other_user}", "gists_url": "https://api.github.com/users/Lothiraldan/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lothiraldan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lothiraldan/subscriptions", "organizations_url": "https://api.github.com/users/Lothiraldan/orgs", "repos_url": "https://api.github.com/users/Lothiraldan/repos", "events_url": "https://api.github.com/users/Lothiraldan/events{/privacy}", "received_events_url": "https://api.github.com/users/Lothiraldan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-01-16T19:19:36Z", "updated_at": "2018-01-22T05:52:56Z", "closed_at": "2018-01-22T05:45:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, first of all, thank you for the `wurlitzer` library.\r\n\r\nI'm trying to use it to capture the stdout and stderr from a library that should works in Python 2 and Python 3. In Python 2, this test file works well:\r\n\r\n```\r\nfrom wurlitzer import pipes\r\n\r\ndef test():\r\n    print(\"Test\")\r\n\r\nwith pipes() as (out, err):\r\n    test()\r\n```\r\n\r\nBut on Python 3, it very easily crash with this output:\r\n\r\n```\r\nlibgcc_s.so.1 must be installed for pthread_cancel to work\r\nAborted (core dumped)\r\n```\r\n\r\nAfter digging, I think I've hit this Python bug: https://bugs.python.org/issue18748\r\n\r\nMy core dump stack trace looks similar:\r\n\r\n```\r\n(gdb) bt\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\r\n#1  0x00007f3527e50f5d in __GI_abort () at abort.c:90\r\n#2  0x00007f3527e9928d in __libc_message (action=action@entry=(do_abort | do_backtrace), fmt=fmt@entry=0x7f3527fbe7fe \"%s\") at ../sysdeps/posix/libc_fatal.c:181\r\n#3  0x00007f3527e992e2 in __GI___libc_fatal (message=message@entry=0x7f3528db34d8 \"libgcc_s.so.1 must be installed for pthread_cancel to work\\n\") at ../sysdeps/posix/libc_fatal.c:191\r\n#4  0x00007f3528db181f in pthread_cancel_init () at ../sysdeps/nptl/unwind-forcedunwind.c:64\r\n#5  0x00007f3528db1924 in _Unwind_ForcedUnwind (exc=0x7f35275dcd70, stop=stop@entry=0x7f3528daf780 <unwind_stop>, stop_argument=0x7f35275dbf20) at ../sysdeps/nptl/unwind-forcedunwind.c:126\r\n#6  0x00007f3528daf900 in __GI___pthread_unwind (buf=<optimized out>) at unwind.c:121\r\n#7  0x00007f3528da6a25 in __do_cancel () at pthreadP.h:297\r\n#8  __pthread_exit (value=<optimized out>) at pthread_exit.c:28\r\n#9  0x000000000043e7dc in PyThread_exit_thread ()\r\n#10 0x000000000058e335 in ?? ()\r\n#11 0x00007f3528da57fc in start_thread (arg=0x7f35275dc700) at pthread_create.c:465\r\n#12 0x00007f3527f2cb0f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n```\r\n\r\nThe Python bug doesn't mention a workaround that could be done on the code side, unfortunately.\r\n\r\nI was wondering if you had an idea how to update the code to avoid it or just letting you know that the library is crashing on Python 3.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/7", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/7/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/7/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/7/events", "html_url": "https://github.com/minrk/wurlitzer/issues/7", "id": 237738884, "node_id": "MDU6SXNzdWUyMzc3Mzg4ODQ=", "number": 7, "title": "OSError: [Errno 9] Bad file descriptor", "user": {"login": "clouds56", "id": 730813, "node_id": "MDQ6VXNlcjczMDgxMw==", "avatar_url": "https://avatars1.githubusercontent.com/u/730813?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clouds56", "html_url": "https://github.com/clouds56", "followers_url": "https://api.github.com/users/clouds56/followers", "following_url": "https://api.github.com/users/clouds56/following{/other_user}", "gists_url": "https://api.github.com/users/clouds56/gists{/gist_id}", "starred_url": "https://api.github.com/users/clouds56/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clouds56/subscriptions", "organizations_url": "https://api.github.com/users/clouds56/orgs", "repos_url": "https://api.github.com/users/clouds56/repos", "events_url": "https://api.github.com/users/clouds56/events{/privacy}", "received_events_url": "https://api.github.com/users/clouds56/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-06-22T05:53:54Z", "updated_at": "2017-06-22T14:32:16Z", "closed_at": "2017-06-22T14:32:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've got these error when using `%load_ext wurlitzer` in jupyter and running a cell that should have no output in c function. This occurs randomly.\r\n\r\n```\r\nError in callback <function sys_pipes_forever at 0x7f8d6db31d90> (for pre_execute):\r\n---------------------------------------------------------------------------\r\nOSError                                   Traceback (most recent call last)\r\n/home/clouds/.local/lib/python3.6/site-packages/wurlitzer.py in sys_pipes_forever(encoding)\r\n    252     if _mighty_wurlitzer is None:\r\n    253         _mighty_wurlitzer = sys_pipes(encoding)\r\n--> 254     _mighty_wurlitzer.__enter__()\r\n    255 \r\n    256 \r\n\r\n/usr/lib/python3.6/contextlib.py in __enter__(self)\r\n     80     def __enter__(self):\r\n     81         try:\r\n---> 82             return next(self.gen)\r\n     83         except StopIteration:\r\n     84             raise RuntimeError(\"generator didn't yield\") from None\r\n\r\n/home/clouds/.local/lib/python3.6/site-packages/wurlitzer.py in pipes(stdout, stderr, encoding)\r\n    222     w = Wurlitzer(stdout=stdout_w, stderr=stderr_w, encoding=capture_encoding)\r\n    223     try:\r\n--> 224         with w:\r\n    225             yield stdout_r, stderr_r\r\n    226     finally:\r\n\r\n/home/clouds/.local/lib/python3.6/site-packages/wurlitzer.py in __enter__(self)\r\n    123         names = {}\r\n    124         if self._stdout:\r\n--> 125             pipe = self._setup_pipe('stdout')\r\n    126             pipes.append(pipe)\r\n    127             names[pipe] = 'stdout'\r\n\r\n/home/clouds/.local/lib/python3.6/site-packages/wurlitzer.py in _setup_pipe(self, name)\r\n     74     def _setup_pipe(self, name):\r\n     75         real_fd = getattr(sys, '__%s__' % name).fileno()\r\n---> 76         save_fd = os.dup(real_fd)\r\n     77         self._save_fds[name] = save_fd\r\n     78 \r\n\r\nOSError: [Errno 9] Bad file descriptor\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/6", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/6/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/6/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/6/events", "html_url": "https://github.com/minrk/wurlitzer/issues/6", "id": 229658261, "node_id": "MDU6SXNzdWUyMjk2NTgyNjE=", "number": 6, "title": "ZQM error: Assertion failed: nbytes == sizeof dummy", "user": {"login": "cbourjau", "id": 3288058, "node_id": "MDQ6VXNlcjMyODgwNTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3288058?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cbourjau", "html_url": "https://github.com/cbourjau", "followers_url": "https://api.github.com/users/cbourjau/followers", "following_url": "https://api.github.com/users/cbourjau/following{/other_user}", "gists_url": "https://api.github.com/users/cbourjau/gists{/gist_id}", "starred_url": "https://api.github.com/users/cbourjau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cbourjau/subscriptions", "organizations_url": "https://api.github.com/users/cbourjau/orgs", "repos_url": "https://api.github.com/users/cbourjau/repos", "events_url": "https://api.github.com/users/cbourjau/events{/privacy}", "received_events_url": "https://api.github.com/users/cbourjau/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2017-05-18T12:43:40Z", "updated_at": "2017-06-22T14:32:16Z", "closed_at": "2017-06-22T14:32:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nthanks for this package! I have stumbled over a bug which seems to be related to zqm and was discussed in `cling` concerning the root jupyter kernel: https://github.com/root-project/cling/issues/123\r\n\r\nReproducing the issue\r\n-----------------------------\r\nRunning the following in a jupyter-notebooke started with `jupyter-notebook` and `wurlitzer` installed from pip:\r\n```\r\nimport ROOT\r\nfrom wurlitzer import sys_pipes\r\nf = ROOT.TFile.Open(\"test.root\")\r\nwith sys_pipes():\r\n    f.ls()\r\n```\r\n\r\nThis causes the kernel to die and I get the following printed in the console:\r\n```\r\nAssertion failed: nbytes == sizeof dummy (src/signaler.cpp:196)\r\n```\r\n\r\nI know too little about jupyters inner workings, but I think this is related to the issue linked above. Might it be possible to port the fix developed there to wurlitzer?\r\n\r\nThanks again for publishing this package which seems to fill exactly my need, except that it crashes ;)\r\n\r\nCheers,\r\nChristian\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/5", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/5/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/5/events", "html_url": "https://github.com/minrk/wurlitzer/issues/5", "id": 220191093, "node_id": "MDU6SXNzdWUyMjAxOTEwOTM=", "number": 5, "title": "Running out of file descriptors", "user": {"login": "samousli", "id": 6003861, "node_id": "MDQ6VXNlcjYwMDM4NjE=", "avatar_url": "https://avatars1.githubusercontent.com/u/6003861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samousli", "html_url": "https://github.com/samousli", "followers_url": "https://api.github.com/users/samousli/followers", "following_url": "https://api.github.com/users/samousli/following{/other_user}", "gists_url": "https://api.github.com/users/samousli/gists{/gist_id}", "starred_url": "https://api.github.com/users/samousli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samousli/subscriptions", "organizations_url": "https://api.github.com/users/samousli/orgs", "repos_url": "https://api.github.com/users/samousli/repos", "events_url": "https://api.github.com/users/samousli/events{/privacy}", "received_events_url": "https://api.github.com/users/samousli/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-04-07T11:47:08Z", "updated_at": "2018-11-28T10:45:50Z", "closed_at": "2017-06-22T14:32:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "I believe the file descriptors are left open, or there is a delay in their freeing.\r\n\r\nI use pipes in a tight loop and it freezes at around 800~ iterations, I checked via\r\n`ulimit -Sn` that the maximum allowed number of FDs are 1024. I believe that's the cause.\r\n\r\nI may take a look at the issue myself once I find the time, but I'd appreciate your input.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/4", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/4/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/4/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/4/events", "html_url": "https://github.com/minrk/wurlitzer/issues/4", "id": 205303890, "node_id": "MDU6SXNzdWUyMDUzMDM4OTA=", "number": 4, "title": "OSError: [Errno 16] Device or resource busy", "user": {"login": "dfroger", "id": 697102, "node_id": "MDQ6VXNlcjY5NzEwMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/697102?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dfroger", "html_url": "https://github.com/dfroger", "followers_url": "https://api.github.com/users/dfroger/followers", "following_url": "https://api.github.com/users/dfroger/following{/other_user}", "gists_url": "https://api.github.com/users/dfroger/gists{/gist_id}", "starred_url": "https://api.github.com/users/dfroger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dfroger/subscriptions", "organizations_url": "https://api.github.com/users/dfroger/orgs", "repos_url": "https://api.github.com/users/dfroger/repos", "events_url": "https://api.github.com/users/dfroger/events{/privacy}", "received_events_url": "https://api.github.com/users/dfroger/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2017-02-04T00:12:28Z", "updated_at": "2017-06-22T14:32:16Z", "closed_at": "2017-06-22T14:32:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using `%load_ext wurlitzer` in a Jupyer notebook on GNU/Linux.\r\n\r\nIt works great, but sometimes, after re-running the same, I get the error:\r\n\r\n```python\r\nError in callback <function stop_sys_pipes at 0x7f71136ed158> (for post_execute):\r\n---------------------------------------------------------------------------\r\nOSError                                   Traceback (most recent call last)\r\n/data/miniconda3/envs/geomalgo/lib/python3.5/site-packages/wurlitzer.py in stop_sys_pipes()\r\n    259     global _mighty_wurlitzer\r\n    260     if _mighty_wurlitzer is not None:\r\n--> 261         _mighty_wurlitzer.__exit__(None, None, None)\r\n    262         _mighty_wurlitzer = None\r\n    263 \r\n\r\n/data/miniconda3/envs/geomalgo/lib/python3.5/contextlib.py in __exit__(self, type, value, traceback)\r\n     64         if type is None:\r\n     65             try:\r\n---> 66                 next(self.gen)\r\n     67             except StopIteration:\r\n     68                 return\r\n\r\n/data/miniconda3/envs/geomalgo/lib/python3.5/site-packages/wurlitzer.py in pipes(stdout, stderr, encoding)\r\n    223     try:\r\n    224         with w:\r\n--> 225             yield stdout_r, stderr_r\r\n    226     finally:\r\n    227         # close pipes\r\n\r\n/data/miniconda3/envs/geomalgo/lib/python3.5/site-packages/wurlitzer.py in __exit__(self, exc_type, exc_value, traceback)\r\n    171         for name, real_fd in self._real_fds.items():\r\n    172             save_fd = self._save_fds[name]\r\n--> 173             os.dup2(save_fd, real_fd)\r\n    174             os.close(save_fd)\r\n    175         # finalize handle\r\n\r\nOSError: [Errno 16] Device or resource busy\r\n```\r\n\r\nAfter restarting the notebook kernel, the error still occurs.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/minrk/wurlitzer/issues/1", "repository_url": "https://api.github.com/repos/minrk/wurlitzer", "labels_url": "https://api.github.com/repos/minrk/wurlitzer/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/minrk/wurlitzer/issues/1/comments", "events_url": "https://api.github.com/repos/minrk/wurlitzer/issues/1/events", "html_url": "https://github.com/minrk/wurlitzer/issues/1", "id": 174408069, "node_id": "MDU6SXNzdWUxNzQ0MDgwNjk=", "number": 1, "title": "truncation of very long outputs", "user": {"login": "anntzer", "id": 1322974, "node_id": "MDQ6VXNlcjEzMjI5NzQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/1322974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anntzer", "html_url": "https://github.com/anntzer", "followers_url": "https://api.github.com/users/anntzer/followers", "following_url": "https://api.github.com/users/anntzer/following{/other_user}", "gists_url": "https://api.github.com/users/anntzer/gists{/gist_id}", "starred_url": "https://api.github.com/users/anntzer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anntzer/subscriptions", "organizations_url": "https://api.github.com/users/anntzer/orgs", "repos_url": "https://api.github.com/users/anntzer/repos", "events_url": "https://api.github.com/users/anntzer/events{/privacy}", "received_events_url": "https://api.github.com/users/anntzer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-09-01T00:09:51Z", "updated_at": "2017-06-22T14:32:16Z", "closed_at": "2017-06-22T14:32:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Found while working on https://github.com/Calysto/matlab_kernel/issues/5: wurlitzer truncates very long outputs.  A minimal example is\n\n```\nPython 3.5.2 (default, Jun 28 2016, 08:46:01) \nType \"copyright\", \"credits\" or \"license\" for more information.\n\nIPython 5.1.0 -- An enhanced Interactive Python.\n?         -> Introduction and overview of IPython's features.\n%quickref -> Quick reference.\nhelp      -> Python's own help system.\nobject?   -> Details about 'object', use 'object??' for extra details.\n\nIn [1]: %load_ext wurlitzer\n\nIn [2]: import ctypes; ctypes.CDLL(None).printf(b\"%s\", \"\\n\".join(map(str, range(10000))).encode(\"\n   ...: ascii\"))\n```\n\nand the list of printed numbers stops around 280.\n\n(It is even more annoying from the point of view of the MATLAB kernel as it simply hangs during the call to `libc.fflush(c_stdout_p)`; I suspect the issues are related.)\n", "performed_via_github_app": null, "score": 1.0}]}