{"total_count": 257, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1335", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1335/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1335/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1335/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1335", "id": 674472575, "node_id": "MDU6SXNzdWU2NzQ0NzI1NzU=", "number": 1335, "title": "schema_salad.exceptions.ValidationException: Not found:", "user": {"login": "reliscu", "id": 50351159, "node_id": "MDQ6VXNlcjUwMzUxMTU5", "avatar_url": "https://avatars0.githubusercontent.com/u/50351159?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reliscu", "html_url": "https://github.com/reliscu", "followers_url": "https://api.github.com/users/reliscu/followers", "following_url": "https://api.github.com/users/reliscu/following{/other_user}", "gists_url": "https://api.github.com/users/reliscu/gists{/gist_id}", "starred_url": "https://api.github.com/users/reliscu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reliscu/subscriptions", "organizations_url": "https://api.github.com/users/reliscu/orgs", "repos_url": "https://api.github.com/users/reliscu/repos", "events_url": "https://api.github.com/users/reliscu/events{/privacy}", "received_events_url": "https://api.github.com/users/reliscu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-06T17:10:29Z", "updated_at": "2020-08-06T21:59:32Z", "closed_at": "2020-08-06T21:59:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "Trying to follow this tutorial:\r\nhttps://www.commonwl.org/user_guide/02-1st-example/index.html\r\n\r\nI got an error, and I have no clue where to go from here.\r\n\r\nFiles created:\r\n1st-tool.cwl\r\n\r\n```\r\n#!/usr/bin/env cwl-runner\r\n\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nbaseCommand: echo\r\ninputs:\r\n  message:\r\n    type: string\r\n    inputBinding:\r\n      position: 1\r\noutputs: []\r\n```\r\necho-job.yml\r\n\r\n```\r\nmessage: Hello world!\r\n```\r\n\r\ncommand:\r\n```\r\ncwl-runner 1st.tool.cwl echo-job.yml\r\n```\r\n\r\noutput:\r\n\r\n```\r\nINFO /Users/rebeccaeliscu/anaconda3/bin/cwl-runner 3.0.20200710214758\r\nTraceback (most recent call last):\r\n  File \"/Users/rebeccaeliscu/anaconda3/bin/cwl-runner\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/Users/rebeccaeliscu/anaconda3/lib/python3.8/site-packages/cwltool/main.py\", line 905, in main\r\n    uri, tool_file_uri = resolve_tool_uri(\r\n  File \"/Users/rebeccaeliscu/anaconda3/lib/python3.8/site-packages/cwltool/load_tool.py\", line 100, in resolve_tool_uri\r\n    raise ValidationException(\"Not found: '%s'\" % argsworkflow)\r\nschema_salad.exceptions.ValidationException: Not found: '1st.tool.cwl'\r\n```\r\n\r\nNotably, this command seemed to allow the workflow to run:\r\n```\r\ncwltool --preserve-environment PATH 1st-tool.cwl echo-job.yml \r\n```\r\nResulting in:\r\n```\r\n /Users/rebeccaeliscu/anaconda3/bin/cwltool 3.0.20200710214758\r\nINFO Resolved '1st-tool.cwl' to 'file:///Users/rebeccaeliscu/1st-tool.cwl'\r\nINFO [job 1st-tool.cwl] /private/tmp/docker_tmp9vofkj1g$ echo \\\r\n    'Hello world!'\r\nHello world!\r\nINFO [job 1st-tool.cwl] completed success\r\n{}\r\nINFO Final process status is success\r\n```\r\n\r\nIf possible, can anyone help me understand what might be going on? \r\n\r\n## Your Environment\r\n* cwltool version: 3.0.20200710214758\r\nAnd, not sure if it's relevent, but:\r\nPython version: Python 3.8.3\r\nConda version: conda 4.8.3\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1332", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1332/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1332/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1332/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1332", "id": 668953358, "node_id": "MDU6SXNzdWU2Njg5NTMzNTg=", "number": 1332, "title": "cwltool failed to check singularity version", "user": {"login": "hubentu", "id": 9856666, "node_id": "MDQ6VXNlcjk4NTY2NjY=", "avatar_url": "https://avatars1.githubusercontent.com/u/9856666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hubentu", "html_url": "https://github.com/hubentu", "followers_url": "https://api.github.com/users/hubentu/followers", "following_url": "https://api.github.com/users/hubentu/following{/other_user}", "gists_url": "https://api.github.com/users/hubentu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hubentu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hubentu/subscriptions", "organizations_url": "https://api.github.com/users/hubentu/orgs", "repos_url": "https://api.github.com/users/hubentu/repos", "events_url": "https://api.github.com/users/hubentu/events{/privacy}", "received_events_url": "https://api.github.com/users/hubentu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 655566179, "node_id": "MDU6TGFiZWw2NTU1NjYxNzk=", "url": "https://api.github.com/repos/common-workflow-language/cwltool/labels/status/awaiting%20user%20response", "name": "status/awaiting user response", "color": "1d76db", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-30T16:41:59Z", "updated_at": "2020-07-31T14:31:36Z", "closed_at": "2020-07-31T14:31:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "The `singularity.py` tries to check the version of singularity with function `get_version`, but it didn't work for current singularity 3.6.\r\nI have tried to install singularity from the source and from miniconda. They neither give me a regular version number, but `singularity version 47b018f-dirty`, which can't be handled by `get_version`. Thanks!\r\n\r\n\r\n```\r\n$cwltool --singularity tool.cwl tool.yml\r\nERROR Got workflow error\r\nTraceback (most recent call last):\r\n  File \"/home/qiang/miniconda3/lib/python3.8/site-packages/cwltool/executors.py\", line 257, in run_jobs\r\n    job.run(runtime_context)\r\n  File \"/home/qiang/miniconda3/lib/python3.8/site-packages/cwltool/job.py\", line 828, in run\r\n    (runtime, cidfile) = self.create_runtime(env, runtimeContext)\r\n  File \"/home/qiang/miniconda3/lib/python3.8/site-packages/cwltool/singularity.py\", line 394, in create_runtime\r\n    if is_version_3_1_or_newer():\r\n  File \"/home/qiang/miniconda3/lib/python3.8/site-packages/cwltool/singularity.py\", line 77, in is_version_3_1_or_newer\r\n    return int(version[0]) >= 4 or (int(version[0]) == 3 and int(version[1]) >= 1)\r\nValueError: invalid literal for int() with base 10: '47b018f-dirty\\n'\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n3.0.20200724003302\r\n\r\n* singularity version:\r\n$singularity --version\r\nsingularity version 47b018f-dirty\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1297", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1297/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1297/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1297/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1297", "id": 625790702, "node_id": "MDU6SXNzdWU2MjU3OTA3MDI=", "number": 1297, "title": "cwltool inserts spurious escaping in strings", "user": {"login": "kaushik-work", "id": 6299530, "node_id": "MDQ6VXNlcjYyOTk1MzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6299530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaushik-work", "html_url": "https://github.com/kaushik-work", "followers_url": "https://api.github.com/users/kaushik-work/followers", "following_url": "https://api.github.com/users/kaushik-work/following{/other_user}", "gists_url": "https://api.github.com/users/kaushik-work/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaushik-work/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaushik-work/subscriptions", "organizations_url": "https://api.github.com/users/kaushik-work/orgs", "repos_url": "https://api.github.com/users/kaushik-work/repos", "events_url": "https://api.github.com/users/kaushik-work/events{/privacy}", "received_events_url": "https://api.github.com/users/kaushik-work/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 269875289, "node_id": "MDU6TGFiZWwyNjk4NzUyODk=", "url": "https://api.github.com/repos/common-workflow-language/cwltool/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-27T15:21:26Z", "updated_at": "2020-07-06T14:10:23Z", "closed_at": "2020-07-06T14:10:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "`cwltool 3.0.20200324120055`\r\n\r\nThe following CWL should produce a file with the contents:\r\n```\r\nquote \"Hello\"\r\n```\r\ninstead it returns\r\n```\r\nquote \\\"Hello\\\"\r\n```\r\n\r\nApparently the following JS `${return 'quote \"' + inputs.quote + '\"'}` returns a string with escape sequence + quotes inside it, rather than just quotes.\r\n\r\n```\r\n#!/usr/bin/env cwl-runner\r\n\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\nlabel: Does cwltool have a JS quoting bug?\r\n\r\nrequirements:\r\n  InitialWorkDirRequirement:\r\n    listing:\r\n    - entryname: file.txt\r\n      entry: |\r\n        ${return 'quote \"' + inputs.quote + '\"'}\r\n    - entryname: script.sh\r\n      entry: |\r\n        set -xe\r\n        cat file.txt\r\n  InlineJavascriptRequirement: {}\r\n  ResourceRequirement:\r\n    coresMin: 2\r\n    ramMin: 1000\r\n\r\ninputs:\r\n  quote:\r\n    type: string?\r\n\r\noutputs:\r\n  out:\r\n    type: File\r\n    outputBinding:\r\n      glob: file.txt\r\n\r\nbaseCommand:\r\n- echo\r\narguments: []\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1292", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1292/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1292/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1292/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1292", "id": 622709807, "node_id": "MDU6SXNzdWU2MjI3MDk4MDc=", "number": 1292, "title": "we broke udocker ; doesn't suport --mount syntax, only --volume syntax", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-05-21T18:58:10Z", "updated_at": "2020-05-22T11:07:29Z", "closed_at": "2020-05-22T11:07:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\n$ cwltool --enable-ext --default-container=debian --user-space-docker-cmd=udocker tests/wf/timelimit.cwl --sleep_time 10\r\nINFO /home/michael/cwltool/env3.7/bin/cwltool 3.0.20200521133004\r\nINFO Resolved 'tests/wf/timelimit.cwl' to 'file:///home/michael/cwltool/tests/wf/timelimit.cwl'\r\nINFO ['udocker', 'pull', 'debian']\r\nDownloading layer: sha256:376057ac6fa17f65688c56977118e2e764b27c348b3f70637fa829cd2a12b200\r\nDownloading layer: sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4\r\nINFO [job timelimit.cwl] /tmp/yjljpdqe$ udocker \\\r\n    --quiet \\\r\n    run \\\r\n    --mount=type=bind,source=/tmp/yjljpdqe,target=/eLjWfd \\\r\n    --mount=type=bind,source=/tmp/5ze79_5y,target=/tmp \\\r\n    --workdir=/eLjWfd \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/eLjWfd \\\r\n    debian \\\r\n    sleep \\\r\n    10\r\nError: syntax error at: --mount=type=bind,source=/tmp/yjljpdqe,target=/eLjWfd --mount=type=bind,source=/tmp/5ze79_5y,target=/tmp\r\n```\r\n\r\nProbably introduced in https://github.com/common-workflow-language/cwltool/pull/1251\r\n\r\nWe missed this due to the `udocker` tests being skipped due to another issue which has since been fixed", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1286", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1286/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1286/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1286/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1286", "id": 617450135, "node_id": "MDU6SXNzdWU2MTc0NTAxMzU=", "number": 1286, "title": "Single element for an array input", "user": {"login": "jjkoehorst", "id": 4471699, "node_id": "MDQ6VXNlcjQ0NzE2OTk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4471699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jjkoehorst", "html_url": "https://github.com/jjkoehorst", "followers_url": "https://api.github.com/users/jjkoehorst/followers", "following_url": "https://api.github.com/users/jjkoehorst/following{/other_user}", "gists_url": "https://api.github.com/users/jjkoehorst/gists{/gist_id}", "starred_url": "https://api.github.com/users/jjkoehorst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jjkoehorst/subscriptions", "organizations_url": "https://api.github.com/users/jjkoehorst/orgs", "repos_url": "https://api.github.com/users/jjkoehorst/repos", "events_url": "https://api.github.com/users/jjkoehorst/events{/privacy}", "received_events_url": "https://api.github.com/users/jjkoehorst/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-13T13:29:27Z", "updated_at": "2020-05-13T13:52:04Z", "closed_at": "2020-05-13T13:52:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nWhen providing a single directory to a cwl step which expects a list of directories it should still function when this list is a single element.\r\n\r\nThus when in the workflow providing the following it should work\r\n\r\n```\r\n  irods_upload_folders:\r\n    run: ../irods/irods_upload.cwl\r\n    in:\r\n      folders: [fastqc/upload]\r\n      destination: destination\r\n      push: \r\n        default: true\r\n    out: []\r\n```\r\n\r\n\r\n\r\n\r\n## Actual Behavior\r\n\r\nHowever it gives the following error:\r\n\r\n```\r\nERROR Tool definition failed validation:\r\n\r\ncwls/workflows/workflow_assembly_illumina_paired.cwl:49:10: Source 'upload' of type \"Directory\" is\r\n                                                            incompatible\r\ncwls/workflows/workflow_assembly_illumina_paired.cwl:77:7:     with sink 'folders' of type\r\n                                                              [\"null\", {\"type\": \"array\", \"items\":\r\n                                                              \"Directory\"}]\r\n```\r\n\r\nWhen providing the element twice so it creates an array it works.\r\n\r\n```\r\n  irods_upload_folders:\r\n    run: ../irods/irods_upload.cwl\r\n    in:\r\n      folders: [fastqc/upload, fastqc/upload]\r\n      destination: destination\r\n      push: \r\n        default: true\r\n    out: []\r\n```\r\n\r\n\r\n## Workflow Code\r\n```\r\nSee above\r\n```\r\n\r\n## Your Environment\r\n* cwltool version:  3.0.20200416192244\r\nCheck using ``cwltool --version``\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1284", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1284/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1284/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1284/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1284", "id": 617036157, "node_id": "MDU6SXNzdWU2MTcwMzYxNTc=", "number": 1284, "title": "Javascript with variable called \"arguments\" fails", "user": {"login": "kaushik-work", "id": 6299530, "node_id": "MDQ6VXNlcjYyOTk1MzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6299530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaushik-work", "html_url": "https://github.com/kaushik-work", "followers_url": "https://api.github.com/users/kaushik-work/followers", "following_url": "https://api.github.com/users/kaushik-work/following{/other_user}", "gists_url": "https://api.github.com/users/kaushik-work/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaushik-work/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaushik-work/subscriptions", "organizations_url": "https://api.github.com/users/kaushik-work/orgs", "repos_url": "https://api.github.com/users/kaushik-work/repos", "events_url": "https://api.github.com/users/kaushik-work/events{/privacy}", "received_events_url": "https://api.github.com/users/kaushik-work/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 269875289, "node_id": "MDU6TGFiZWwyNjk4NzUyODk=", "url": "https://api.github.com/repos/common-workflow-language/cwltool/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-05-12T23:45:32Z", "updated_at": "2020-05-13T12:30:21Z", "closed_at": "2020-05-13T12:30:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following CWL fails on JS evaluation\r\n```\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\nrequirements:\r\n  InlineJavascriptRequirement: {}\r\n\r\nbaseCommand: [echo]\r\narguments:\r\n  - position: 1\r\n    valueFrom: |\r\n      ${\r\n        var arguments = 22;\r\n        return arguments\r\n      }\r\ninputs: []\r\noutputs: []\r\n```\r\n\r\nIt can be made to run as expected by changing `arguments` to some other name.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1275", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1275/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1275/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1275/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1275", "id": 605920209, "node_id": "MDU6SXNzdWU2MDU5MjAyMDk=", "number": 1275, "title": "Supporting docker post-command arguments", "user": {"login": "fmigneault", "id": 19194484, "node_id": "MDQ6VXNlcjE5MTk0NDg0", "avatar_url": "https://avatars3.githubusercontent.com/u/19194484?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmigneault", "html_url": "https://github.com/fmigneault", "followers_url": "https://api.github.com/users/fmigneault/followers", "following_url": "https://api.github.com/users/fmigneault/following{/other_user}", "gists_url": "https://api.github.com/users/fmigneault/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmigneault/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmigneault/subscriptions", "organizations_url": "https://api.github.com/users/fmigneault/orgs", "repos_url": "https://api.github.com/users/fmigneault/repos", "events_url": "https://api.github.com/users/fmigneault/events{/privacy}", "received_events_url": "https://api.github.com/users/fmigneault/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-04-23T22:42:19Z", "updated_at": "2020-05-03T19:18:56Z", "closed_at": "2020-04-25T07:15:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "Looking at the implementation, I feel like there are currently no way to provide additional arguments to docker. In some cases, this option would be useful such as for running commands with https://github.com/NVIDIA/nvidia-docker\r\n\r\nI have found through the CLI argument ``--user-space-docker-cmd CMD`` that allows override of the 'docker' command (eg: udocker or else), but this override is placed **before** the enforced docker commands.\r\n\r\nIn the case of `nvidia-docker`, the docker command doesn't actually need to be modified (toolkit hook replaces it), but flag ``--gpus '[options]'`` must be given **after** ``docker run`` to allow integration of CUDA devices within the container.\r\n\r\nI guess I could define a custom `RuntimeContext` to implement this behaviour, but I was wondering if it was something that could be considered for direct implementation in the CLI to avoid hacking the code? \r\n\r\nWould it be possible to add some kind of input argument like : \r\n``--user-space-docker-run-args \"args0 args1\"`` \r\n\r\n## Expected Behavior\r\n\r\nAllow to make a call as follows (or similar) : \r\n\r\n```\r\ncwltool --user-space-docker-run-args \"--gpus all\" [other-cwltool-args] process.cwl job.yml\r\n```\r\nWhich would eventually run : \r\n```\r\ndocker run --gpus all --volumes [...] [other-docker-args] docker-image:tag \r\n```\r\n\r\n**NOTE**:\r\nThis flag is allowed only with `run`, other will raise unknown argument.\r\nThe extra arguments must therefore be command based.\r\n\r\n## Actual Behavior\r\n\r\nJust doesn't work because GPU cannot be found.\r\n\r\n## Your Environment\r\n* cwltool version:  2.0.20200126090152\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1270", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1270/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1270/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1270/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1270", "id": 595557718, "node_id": "MDU6SXNzdWU1OTU1NTc3MTg=", "number": 1270, "title": "ShellCommandRequirement fails on docker container when entrypoint is set to a non-shell", "user": {"login": "alexiswl", "id": 8197659, "node_id": "MDQ6VXNlcjgxOTc2NTk=", "avatar_url": "https://avatars2.githubusercontent.com/u/8197659?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexiswl", "html_url": "https://github.com/alexiswl", "followers_url": "https://api.github.com/users/alexiswl/followers", "following_url": "https://api.github.com/users/alexiswl/following{/other_user}", "gists_url": "https://api.github.com/users/alexiswl/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexiswl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexiswl/subscriptions", "organizations_url": "https://api.github.com/users/alexiswl/orgs", "repos_url": "https://api.github.com/users/alexiswl/repos", "events_url": "https://api.github.com/users/alexiswl/events{/privacy}", "received_events_url": "https://api.github.com/users/alexiswl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-07T03:10:12Z", "updated_at": "2020-06-01T06:42:44Z", "closed_at": "2020-04-07T07:35:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nI have a tool -- [sortmerna](https://github.com/biocore/sortmerna) -- that takes in two fastq reads, and a list of reference files and runs an alignment. I have built a docker container for the tool and created a yaml definition file for the said tool. I have created a gist for this file that can be seen [here](https://gist.github.com/alexiswl/3b2c99086d56f252fa90258225189233). My main issue is that the reference files must be separated as separate parameters, i.e `--ref /path/to/fasta1 --ref /path/to/fasta2` as opposed to comma separated values. This could be resolved with the enhancement request: https://github.com/common-workflow-language/common-workflow-language/issues/857. As a workaround for now, I tried using the itemSeparator with ` --ref  ` and setting `shellQuote: false` s.t each value and prefix combination would be interpreted as separate values. \r\n\r\n## Actual Behavior\r\nWhen I run this command via cwl-runner (version  3.0.20200324120055) I can trace back the error to the following docker line:\r\n```\r\ndocker \\\r\n    run \\\r\n    -i \\\r\n    --mount=type=bind,source=/tmp/7jnyrk9n,target=/dVGQcw \\\r\n    --mount=type=bind,source=/tmp/rg3cg05r,target=/tmp \\\r\n    --mount=type=bind,source=/a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_1.fastq,target=/var/lib/cwl/stg8c17bcbf-0c8f-4596-82e8-7f396bb8a164/6h_1.fastq,readonly \\\r\n    --mount=type=bind,source=/a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_2.fastq,target=/var/lib/cwl/stg86e8b22b-978a-48ab-81d6-60577d624116/6h_2.fastq,readonly \\\r\n    --workdir=/dVGQcw \\\r\n    --read-only=true \\\r\n    --net=none \\\r\n    --user=1000:1000 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/dVGQcw \\\r\n    --cidfile=/tmp/ctj0mu57/20200407130129-489061.cid \\\r\n    umccr/sortmerna:4.2.0 \\\r\n    /bin/sh \\\r\n    -c \\\r\n    'sortmerna' '--workdir' '/dVGQcw/' '--reads' '/var/lib/cwl/stg8c17bcbf-0c8f-4596-82e8-7f396bb8a164/6h_1.fastq' '--reads' '/var/lib/cwl/stg86e8b22b-978a-48ab-81d6-60577d624116/6h_2.fastq' --ref /opt/rRNA_databases/rfam-5.8s-database-id98.fasta --ref /opt/rRNA_databases/rfam-5s-database-id98.fasta --ref /opt/rRNA_databases/silva-arc-16s-id95.fasta --ref /opt/rRNA_databases/silva-arc-23s-id98.fasta --ref /opt/rRNA_databases/silva-bac-16s-id90.fasta --ref /opt/rRNA_databases/silva-euk-28s-id98.fasta --ref /opt/rRNA_databases/silva-bac-23s-id98.fasta --ref /opt/rRNA_databases/silva-euk-18s-id95.fasta\r\n```\r\n\r\nThis results in the error:\r\n```\r\nFound value: sortmerna\r\nFound value: /bin/sh\r\nFound flag: -c\r\n```\r\n\r\nSince 'sortmerna' is the entrypoint to the docker container by default. And the ShellCommandRequirement has prepended `sh -c` to the command line. Would it be possible that the entrypoint is instead overwritten to /bin/sh in the case that ShellCommandRequirement is implemented, -c is the next argument, and all additional basecommands/arguments are placed as the second argument, quoted as required? \r\n\r\n## Workflow Code\r\n[This gist](https://gist.github.com/alexiswl/3b2c99086d56f252fa90258225189233) contains the cwltool defintion, a test yaml and the Dockerfile.\r\n\r\n## Full Traceback\r\n```pytb\r\n/home/alexiswl/anaconda3/envs/cwl/lib/python3.8/site-packages/cwltool-3.0.20200324120055-py3.8.egg/cwltool/docker.py:423: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n/home/alexiswl/anaconda3/envs/cwl/lib/python3.8/site-packages/cwltool-3.0.20200324120055-py3.8.egg/cwltool/docker.py:423: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n\u001b[1;30mINFO\u001b[0m /home/alexiswl/anaconda3/envs/cwl/bin/cwl-runner 3.0.20200324120055\r\n\u001b[1;30mINFO\u001b[0m Resolved 'sortmerna.cwl' to 'file:///a/UMCCR-ILLUMINA/stratus/TES/wts/qc/sortmerna.cwl'\r\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job sortmerna] initializing from file:///a/UMCCR-ILLUMINA/stratus/TES/wts/qc/sortmerna.cwl#sortmerna\u001b[0m\r\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job sortmerna] {\r\n    \"read_1\": {\r\n        \"class\": \"File\",\r\n        \"format\": \"http://edamontology.org/format_1930\",\r\n        \"location\": \"file:///a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_1.fastq\",\r\n        \"size\": 169555913,\r\n        \"basename\": \"6h_1.fastq\",\r\n        \"nameroot\": \"6h_1\",\r\n        \"nameext\": \".fastq\"\r\n    },\r\n    \"read_2\": {\r\n        \"class\": \"File\",\r\n        \"format\": \"http://edamontology.org/format_1930\",\r\n        \"location\": \"file:///a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_2.fastq\",\r\n        \"size\": 169555913,\r\n        \"basename\": \"6h_2.fastq\",\r\n        \"nameroot\": \"6h_2\",\r\n        \"nameext\": \".fastq\"\r\n    },\r\n    \"ref_array\": [\r\n        \"/opt/rRNA_databases/rfam-5.8s-database-id98.fasta\",\r\n        \"/opt/rRNA_databases/rfam-5s-database-id98.fasta\",\r\n        \"/opt/rRNA_databases/silva-arc-16s-id95.fasta\",\r\n        \"/opt/rRNA_databases/silva-arc-23s-id98.fasta\",\r\n        \"/opt/rRNA_databases/silva-bac-16s-id90.fasta\",\r\n        \"/opt/rRNA_databases/silva-euk-28s-id98.fasta\",\r\n        \"/opt/rRNA_databases/silva-bac-23s-id98.fasta\",\r\n        \"/opt/rRNA_databases/silva-euk-18s-id95.fasta\"\r\n    ]\r\n}\u001b[0m\r\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job sortmerna] path mappings is {\r\n    \"file:///a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_1.fastq\": [\r\n        \"/a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_1.fastq\",\r\n        \"/var/lib/cwl/stgbddfd8de-fcf6-426f-ab99-7e3f6221459a/6h_1.fastq\",\r\n        \"File\",\r\n        true\r\n    ],\r\n    \"file:///a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_2.fastq\": [\r\n        \"/a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_2.fastq\",\r\n        \"/var/lib/cwl/stgdc1556ee-bc6f-4191-b792-8dd6745ccae1/6h_2.fastq\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\u001b[0m\r\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job sortmerna] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ],\r\n        \"datum\": \"sortmerna\"\r\n    },\r\n    {\r\n        \"valueFrom\": \"--workdir\",\r\n        \"position\": [\r\n            0,\r\n            0\r\n        ]\r\n    },\r\n    {\r\n        \"valueFrom\": \"$(runtime.outdir)/\",\r\n        \"position\": [\r\n            0,\r\n            1\r\n        ]\r\n    },\r\n    {\r\n        \"prefix\": \"--reads\",\r\n        \"separate\": true,\r\n        \"position\": [\r\n            0,\r\n            \"read_1\"\r\n        ],\r\n        \"datum\": {\r\n            \"class\": \"File\",\r\n            \"format\": \"http://edamontology.org/format_1930\",\r\n            \"location\": \"file:///a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_1.fastq\",\r\n            \"size\": 169555913,\r\n            \"basename\": \"6h_1.fastq\",\r\n            \"nameroot\": \"6h_1\",\r\n            \"nameext\": \".fastq\",\r\n            \"path\": \"/var/lib/cwl/stgbddfd8de-fcf6-426f-ab99-7e3f6221459a/6h_1.fastq\",\r\n            \"dirname\": \"/var/lib/cwl/stgbddfd8de-fcf6-426f-ab99-7e3f6221459a\"\r\n        }\r\n    },\r\n    {\r\n        \"prefix\": \"--reads\",\r\n        \"separate\": true,\r\n        \"position\": [\r\n            0,\r\n            \"read_2\"\r\n        ],\r\n        \"datum\": {\r\n            \"class\": \"File\",\r\n            \"format\": \"http://edamontology.org/format_1930\",\r\n            \"location\": \"file:///a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_2.fastq\",\r\n            \"size\": 169555913,\r\n            \"basename\": \"6h_2.fastq\",\r\n            \"nameroot\": \"6h_2\",\r\n            \"nameext\": \".fastq\",\r\n            \"path\": \"/var/lib/cwl/stgdc1556ee-bc6f-4191-b792-8dd6745ccae1/6h_2.fastq\",\r\n            \"dirname\": \"/var/lib/cwl/stgdc1556ee-bc6f-4191-b792-8dd6745ccae1\"\r\n        }\r\n    },\r\n    {\r\n        \"prefix\": \"--ref\",\r\n        \"separate\": true,\r\n        \"itemSeparator\": \" --ref \",\r\n        \"shellQuote\": false,\r\n        \"position\": [\r\n            0,\r\n            \"ref_array\"\r\n        ],\r\n        \"datum\": [\r\n            \"/opt/rRNA_databases/rfam-5.8s-database-id98.fasta\",\r\n            \"/opt/rRNA_databases/rfam-5s-database-id98.fasta\",\r\n            \"/opt/rRNA_databases/silva-arc-16s-id95.fasta\",\r\n            \"/opt/rRNA_databases/silva-arc-23s-id98.fasta\",\r\n            \"/opt/rRNA_databases/silva-bac-16s-id90.fasta\",\r\n            \"/opt/rRNA_databases/silva-euk-28s-id98.fasta\",\r\n            \"/opt/rRNA_databases/silva-bac-23s-id98.fasta\",\r\n            \"/opt/rRNA_databases/silva-euk-18s-id95.fasta\"\r\n        ]\r\n    }\r\n]\u001b[0m\r\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job sortmerna] initial work dir {}\u001b[0m\r\n\u001b[1;30mWARNING\u001b[0m \u001b[33m[job sortmerna] Skipping Docker software container '--memory' limit despite presence of ResourceRequirement with ramMin and/or ramMax setting. Consider running with --strict-memory-limit for increased portability assurance.\u001b[0m\r\n\u001b[1;30mINFO\u001b[0m [job sortmerna] /tmp/x_6ixb3g$ docker \\\r\n    run \\\r\n    -i \\\r\n    --mount=type=bind,source=/tmp/x_6ixb3g,target=/IDUhDS \\\r\n    --mount=type=bind,source=/tmp/n804dzqk,target=/tmp \\\r\n    --mount=type=bind,source=/a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_1.fastq,target=/var/lib/cwl/stgbddfd8de-fcf6-426f-ab99-7e3f6221459a/6h_1.fastq,readonly \\\r\n    --mount=type=bind,source=/a/UMCCR-ILLUMINA/stratus/TES/wts/qc/RNA_Example_Fastq/6h_2.fastq,target=/var/lib/cwl/stgdc1556ee-bc6f-4191-b792-8dd6745ccae1/6h_2.fastq,readonly \\\r\n    --workdir=/IDUhDS \\\r\n    --read-only=true \\\r\n    --net=none \\\r\n    --user=1000:1000 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/IDUhDS \\\r\n    --cidfile=/tmp/7les5iae/20200407130949-200291.cid \\\r\n    umccr/sortmerna:4.2.0 \\\r\n    /bin/sh \\\r\n    -c \\\r\n    'sortmerna' '--workdir' '/IDUhDS/' '--reads' '/var/lib/cwl/stgbddfd8de-fcf6-426f-ab99-7e3f6221459a/6h_1.fastq' '--reads' '/var/lib/cwl/stgdc1556ee-bc6f-4191-b792-8dd6745ccae1/6h_2.fastq' --ref /opt/rRNA_databases/rfam-5.8s-database-id98.fasta --ref /opt/rRNA_databases/rfam-5s-database-id98.fasta --ref /opt/rRNA_databases/silva-arc-16s-id95.fasta --ref /opt/rRNA_databases/silva-arc-23s-id98.fasta --ref /opt/rRNA_databases/silva-bac-16s-id90.fasta --ref /opt/rRNA_databases/silva-euk-28s-id98.fasta --ref /opt/rRNA_databases/silva-bac-23s-id98.fasta --ref /opt/rRNA_databases/silva-euk-18s-id95.fasta\r\n\r\n\u001b[0;31mERROR\u001b[0m: [opt_default:1019] Option: 'c' is not recognized\r\n\r\n[process:1369] === Options processing starts ... ===\r\n\r\nFound value: sortmerna\r\nFound value: /bin/sh\r\nFound flag: -c\r\nFound value: 'sortmerna' '--workdir' '/IDUhDS/' '--reads' '/var/lib/cwl/stgbddfd8de-fcf6-426f-ab99-7e3f6221459a/6h_1.fastq' '--reads' '/var/lib/cwl/stgdc1556ee-bc6f-4191-b792-8dd6745ccae1/6h_2.fastq' --ref /opt/rRNA_databases/rfam-5.8s-database-id98.fasta --ref /opt/rRNA_databases/rfam-5s-database-id98.fasta --ref /opt/rRNA_databases/silva-arc-16s-id95.fasta --ref /opt/rRNA_databases/silva-arc-23s-id98.fasta --ref /opt/rRNA_databases/silva-bac-16s-id90.fasta --ref /opt/rRNA_databases/silva-euk-28s-id98.fasta --ref /opt/rRNA_databases/silva-bac-23s-id98.fasta --ref /opt/rRNA_databases/silva-euk-18s-id95.fasta of previous flag: -c\r\nMissing required flag: ref\r\nMissing required flag: reads\r\n[process:1453] Processing option: c with value: 'sortmerna' '--workdir' '/IDUhDS/' '--reads' '/var/lib/cwl/stgbddfd8de-fcf6-426f-ab99-7e3f6221459a/6h_1.fastq' '--reads' '/var/lib/cwl/stgdc1556ee-bc6f-4191-b792-8dd6745ccae1/6h_2.fastq' --ref /opt/rRNA_databases/rfam-5.8s-database-id98.fasta --ref /opt/rRNA_databases/rfam-5s-database-id98.fasta --ref /opt/rRNA_databases/silva-arc-16s-id95.fasta --ref /opt/rRNA_databases/silva-arc-23s-id98.fasta --ref /opt/rRNA_databases/silva-bac-16s-id90.fasta --ref /opt/rRNA_databases/silva-euk-28s-id98.fasta --ref /opt/rRNA_databases/silva-bac-23s-id98.fasta --ref /opt/rRNA_databases/silva-euk-18s-id95.fasta\r\n  Usage:   sortmerna --ref FILE [--ref FILE] --reads FWD_READS [--reads REV_READS] [OPTIONS]:\r\n  -------------------------------------------------------------------------------------------------------------\r\n  | option            type-format           description                                            default    |\r\n  -------------------------------------------------------------------------------------------------------------\r\n\r\n    [REQUIRED]\r\n    --ref             PATH        Required  Reference file (FASTA) absolute or relative path.\r\n                                            Use mutliple times, once per a reference file\r\n\r\n    --reads           PATH        Required  Raw reads file (FASTA/FASTQ/FASTA.GZ/FASTQ.GZ).\r\n                                            Use twice for files with paired reads\r\n\r\n\r\n    [COMMON]\r\n    --workdir         PATH        Optional  Directory for storing Reference index,      USRDIR/sortmerna/run/\r\n                                            Key-value database, and the output.\r\n                                            Default structure:\r\n                                              WORKDIR/\r\n                                                 idx/\r\n                                                 kvdb/\r\n                                                 out/\r\n\r\n    --kvdb            PATH        Optional  Directory for storing Key-value database    WORKDIR/kvdb\r\n                                            KVDB is used for storing alignement results.\r\n\r\n    --idx             PATH        Optional  Directory for storing Reference index.      WORKDIR/idx\r\n                                            \r\n\r\n    --fastx           BOOL        Optional  Output aligned reads into FASTA/FASTQ file\r\n    --sam             BOOL        Optional  Output SAM alignment for aligned reads.\r\n\r\n    --SQ              BOOL        Optional  Add SQ tags to the SAM file\r\n\r\n    --blast           STRING      Optional  output alignments in various Blast-like formats\r\n                                            '0'                    - pairwise\r\n                                            '1'                    - tabular(Blast - m 8 format)\r\n                                            '1 cigar'              - tabular + column for CIGAR\r\n                                            '1 cigar qcov'         - tabular + columns for CIGAR\r\n                                                                     and query coverage\r\n                                            '1 cigar qcov qstrand' - tabular + columns for CIGAR,\r\n                                                                     query coverage and strand\r\n\r\n    --aligned         STRING/BOOL Optional  Aligned reads file prefix [dir/][pfx]       WORKDIR/out/aligned\r\n                                            Directory and file prefix for aligned output i.e.\r\n                                            each output file will go into the specified directory with the given prefix.\r\n                                            The appropriate extension (fasta|fastq|blast|sam|etc) will be automatically added.\r\n                                            Both 'dir' and 'pfx' are optional.\r\n                                            The 'dir' can be a relative or an absolute path.\r\n                                            If 'dir' is not specified, the output will be created in the WORKDIR/out/\r\n                                            If 'pfx' is not specified, the prefix 'aligned' will be used\r\n                                            Examples:\r\n                                             -aligned $MYDIR/dir_1/dir_2/1 -> $MYDIR/dir_1/dir_2/1.fasta\r\n                                             -aligned dir_1/apfx           -> $PWD/dir_1/apfx.fasta\r\n                                             -aligned dir_1/               -> $PWD/aligned.fasta\r\n                                             -aligned apfx                 -> $PWD/apfx.fasta\r\n                                             -aligned  (no argument)       -> WORKDIR/out/aligned.fasta\r\n\r\n    --other           STRING/BOOL Optional  Non-aligned reads file prefix [dir/][pfx]   WORKDIR/out/other\r\n                                            Must be used with 'fastx'.\r\n                                            Directory and file prefix for non-aligned output i.e.\r\n                                            each output file will go into the specified directory with the given prefix.\r\n                                            The appropriate extension (fasta|fastq|blast|sam|etc) will be automatically added.\r\n                                            Both 'dir' and 'pfx' are optional.\r\n                                            The 'dir' can be a relative or an absolute path.\r\n                                            If 'dir' is not specified, the output will be created in the WORKDIR/out/\r\n                                            If 'pfx' is not specified, the prefix 'other' will be used\r\n                                            Examples:\r\n                                             -other $MYDIR/dir_1/dir_2/1 -> $MYDIR/dir_1/dir_2/1.fasta\r\n                                             -other dir_1/apfx           -> $PWD/dir_1/apfx.fasta\r\n                                             -other dir_1/               -> $PWD/dir_1/other.fasta\r\n                                             -other apfx                 -> $PWD/apfx.fasta\r\n                                             -other  (no argument)       -> aligned_out/other.fasta\r\n                                                                            i.e. the same output directory as used\r\n                                                                            for aligned output\r\n\r\n    --num_alignments  INT         Optional  Positive integer (INT >=0).\r\n                                            Report first INT alignments per read reaching E-value\r\n                                            If INT = 0, all alignments will be output\r\n\r\n    --best            INT         Optional  Report INT best alignments per read reaching E-value    1\r\n                                            by searching --min_lis INT candidate alignments\r\n                                            If INT == 0: search All candidate alignments\r\n                                            If INT > 0: search INT best alignments.\r\n                                            The larger is the INT, the longer is the search time.\r\n                                            Explanation:\r\n                                            A read can potentially be aligned (reaching E-value threshold)\r\n                                            to multiple reference sequences.\r\n                                            The 'best' alignment is an alignment that is better\r\n                                            than the previously found alignments.\r\n                                            The very first found alignment is automatically the best alignment\r\n                                            until a better one is found.\r\n\r\n    --min_lis         INT         Optional  Search all alignments having the first INT longest LIS\r\n                                            LIS stands for Longest Increasing Subsequence,\r\n                                            it is computed using seeds' positions to expand hits into\r\n                                            longer matches prior to Smith - Waterman alignment.\r\n                                            Requires option 'best'.\r\n                                            Mutually exclusive with option 'num_alignments'\r\n\r\n    --print_all_reads BOOL        Optional  Output null alignment strings for non-aligned reads     False\r\n                                            to SAM and/or BLAST tabular files\r\n\r\n    --paired          BOOL        Optional  Indicates a Single reads file with paired reads         False\r\n                                            If a single reads file with paired reads is used,\r\n                                            and neither 'paired_in' nor 'paired_out' are specified,\r\n                                            use this option together with 'out2' to output\r\n                                            FWD and REV reads into separate files\r\n\r\n    --paired_in       BOOL        Optional  If one of the paired-end reads is Aligned,              False\r\n                                            put both reads into Aligned FASTA/Q file\r\n                                            Must be used with 'fastx'.\r\n                                            Mutually exclusive with 'paired_out'.\r\n\r\n    --paired_out      BOOL        Optional  If one of the paired-end reads is Non-aligned,          False\r\n                                            put both reads into Non-Aligned FASTA/Q file\r\n                                            Must be used with 'fastx'.\r\n                                            Mutually exclusive with 'paired_in'.\r\n\r\n    --out2            BOOL        Optional  Output paired reads into separate files.                False\r\n                                            Must be used with 'fastx'.\r\n                                            Ignored without either of 'paired_in' |\r\n                                            'paired_out' | 'paired' | two 'reads'\r\n\r\n    --match           INT         Optional  SW score (positive integer) for a match.                2\r\n\r\n    --mismatch        INT         Optional  SW penalty (negative integer) for a mismatch.          -3\r\n\r\n    --gap_open        INT         Optional  SW penalty (positive integer) for introducing a gap.    5\r\n\r\n    --gap_ext         INT         Optional  SW penalty (positive integer) for extending a gap.      2\r\n\r\n    -e                DOUBLE      Optional  E-value threshold.                                      1\r\n                                            Defines the 'statistical significance' of a local alignment.\r\n                                            Exponentially correllates with the Minimal Alignment Score.\r\n                                            Higher E-values (100, 1000, ...) cause More reads\r\n                                            to Pass the alignment threshold\r\n\r\n    -F                BOOL        Optional  Search only the forward strand.                         False\r\n\r\n    -N                BOOL        Optional  SW penalty for ambiguous letters (N's) scored\r\n                                            as --mismatch\r\n\r\n    -R                BOOL        Optional  Search only the reverse-complementary strand.           False\r\n\r\n\r\n    [OTU_PICKING]\r\n    --id              INT         Optional  %%id similarity threshold (the alignment                0.97\r\n                                            must still pass the E-value threshold).\r\n\r\n    --coverage        INT         Optional  %%query coverage threshold (the alignment must          0.97\r\n                                            still pass the E-value threshold)\r\n\r\n    --de_novo_otu     BOOL        Optional  FASTA/FASTQ file for reads matching database < %%id     False\r\n                                            (set using --id) and < %%cov (set using --coverage)\r\n                                            (alignment must still pass the E-value threshold).\r\n\r\n    --otu_map         BOOL        Optional  Output OTU map (input to QIIME's make_otu_table.py).    False\r\n\r\n\r\n    [ADVANCED]\r\n    --passes          INT,INT,INT Optional  Three intervals at which to place the seed on the read  L,L/2,3\r\n                                            (L is the seed length)\r\n\r\n    --edges           INT         Optional  Number (or percent if INT followed by %% sign) of       4\r\n                                            nucleotides to add to each edge of the read\r\n                                            prior to SW local alignment\r\n\r\n    --num_seeds       BOOL        Optional  Number of seeds matched before searching                2\r\n                                            for candidate LIS\r\n\r\n    --full_search     INT         Optional  Search for all 0-error and 1-error seed                 False\r\n                                            matches in the index rather than stopping\r\n                                            after finding a 0-error match (<1%% gain in\r\n                                            sensitivity with up four-fold decrease in speed)\r\n\r\n    --pid             BOOL        Optional  Add pid to output file names.                           False\r\n\r\n    -a                INT         Optional  DEPRECATED in favour of '-threads'. Number of           numCores\r\n                                            processing threads to use.\r\n                                            Automatically redirects to '-threads'\r\n\r\n    --threads         INT         Optional  Number of Processing threads to use                     numCores\r\n\r\n\r\n    [INDEXING]\r\n    -L                DOUBLE      Optional  Indexing: seed length.                                  18\r\n\r\n    -m                DOUBLE      Optional  Indexing: the amount of memory (in Mbytes) for building 3072\r\n                                            the index.\r\n\r\n    -v                BOOL        Optional  Produce verbose output when building the index          True\r\n\r\n    --interval        INT         Optional  Indexing: Positive integer: index every Nth L-mer in    1\r\n                                            the reference database e.g. '-interval 2'.\r\n\r\n    --max_pos         INT         Optional  Indexing: maximum (integer) number of positions to store  1000\r\n                                            for each unique L-mer. If 0 all positions are stored.\r\n\r\n\r\n    [HELP]\r\n    -h                BOOL        Optional  Print help information\r\n\r\n    --version         BOOL        Optional  Print SortMeRNA version number\r\n\r\n\r\n    [DEVELOPER]\r\n    --dbg_put_db      BOOL        Optional  \r\n    --cmd             BOOL        Optional  Launch an interactive session (command prompt)          False\r\n\r\n    --task            INT         Optional  Processing Task:                                        4\r\n                                            0 - align. Only perform alignment\r\n                                            1 - post-processing (log writing)\r\n                                            2 - generate reports\r\n                                            3 - align and post-process\r\n                                            4 - all\r\n\r\n\u001b[1;30mINFO\u001b[0m [job sortmerna] Max memory used: 0MiB\r\n\u001b[1;30mERROR\u001b[0m \u001b[31m[job sortmerna] Job error:\r\n(\"Error collecting output for parameter 'sortmerna_log':\\nsortmerna.cwl:70:7: Did not find output file with glob pattern: '['aligned.log']'\", {})\u001b[0m\r\n\u001b[1;30mWARNING\u001b[0m \u001b[33m[job sortmerna] completed permanentFail\u001b[0m\r\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job sortmerna] outputs {}\u001b[0m\r\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job sortmerna] Removing input staging directory /tmp/2xpdc5x4\u001b[0m\r\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job sortmerna] Removing temporary directory /tmp/n804dzqk\u001b[0m\r\n{}\r\n\u001b[1;30mWARNING\u001b[0m \u001b[33mFinal process status is permanentFail\u001b[0m\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\nCheck using ``cwltool --version``\r\nVersion: 3.0.20200324120055", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1268", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1268/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1268/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1268/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1268", "id": 591703798, "node_id": "MDU6SXNzdWU1OTE3MDM3OTg=", "number": 1268, "title": "SyntaxWarning when running on python v3.8.2", "user": {"login": "alexiswl", "id": 8197659, "node_id": "MDQ6VXNlcjgxOTc2NTk=", "avatar_url": "https://avatars2.githubusercontent.com/u/8197659?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexiswl", "html_url": "https://github.com/alexiswl", "followers_url": "https://api.github.com/users/alexiswl/followers", "following_url": "https://api.github.com/users/alexiswl/following{/other_user}", "gists_url": "https://api.github.com/users/alexiswl/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexiswl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexiswl/subscriptions", "organizations_url": "https://api.github.com/users/alexiswl/orgs", "repos_url": "https://api.github.com/users/alexiswl/repos", "events_url": "https://api.github.com/users/alexiswl/events{/privacy}", "received_events_url": "https://api.github.com/users/alexiswl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-04-01T07:53:59Z", "updated_at": "2020-04-05T21:29:10Z", "closed_at": "2020-04-05T21:29:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nNo warnings present when running `cwltool --version`\r\n\r\n## Actual Behavior\r\nThe following two lines are written to stderr\r\n```\r\n/home/alexiswl/anaconda3/envs/cwl/lib/python3.8/site-packages/cwltool-3.0.20200324120055-py3.8.egg/cwltool/docker.py:423: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n/home/alexiswl/anaconda3/envs/cwl/lib/python3.8/site-packages/cwltool-3.0.20200324120055-py3.8.egg/cwltool/docker.py:423: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n```\r\n\r\n## Workflow Code\r\n```\r\ncwltool --version\r\n```\r\n\r\n## Full Traceback\r\nN/A\r\n\r\n## Your Environment\r\n* cwltool version: \r\nCheck using ``cwltool --version``\r\n\r\nVersion: 3.0.20200324120055\r\nPython Version: 3.8.2\r\nConda Version: 4.8.3\r\nOS-release: Ubuntu 18.04.4 LTS (Running via WSL2)\r\n\r\nInstallation steps:\r\n```\r\nconda create --name cwl python=3.8\r\nconda activate cwl\r\npip install cwltool\r\ncwltool --version\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1266", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1266/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1266/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1266/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1266", "id": 587840098, "node_id": "MDU6SXNzdWU1ODc4NDAwOTg=", "number": 1266, "title": "About usage of Factory class", "user": {"login": "giannisdoukas", "id": 7229857, "node_id": "MDQ6VXNlcjcyMjk4NTc=", "avatar_url": "https://avatars0.githubusercontent.com/u/7229857?v=4", "gravatar_id": "", "url": "https://api.github.com/users/giannisdoukas", "html_url": "https://github.com/giannisdoukas", "followers_url": "https://api.github.com/users/giannisdoukas/followers", "following_url": "https://api.github.com/users/giannisdoukas/following{/other_user}", "gists_url": "https://api.github.com/users/giannisdoukas/gists{/gist_id}", "starred_url": "https://api.github.com/users/giannisdoukas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/giannisdoukas/subscriptions", "organizations_url": "https://api.github.com/users/giannisdoukas/orgs", "repos_url": "https://api.github.com/users/giannisdoukas/repos", "events_url": "https://api.github.com/users/giannisdoukas/events{/privacy}", "received_events_url": "https://api.github.com/users/giannisdoukas/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-25T16:50:10Z", "updated_at": "2020-03-25T18:48:32Z", "closed_at": "2020-03-25T18:48:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello everyone. I am using cwltool python library to execute cwl. In the test suit, I have seen that you have a factory class for creating the executor for the workflow but in cwltool code, you do not use it. Actually the main function seems to be a lot more complicated rather than factory's code. So my question is if in order to use the cwltool as a library the suggested way is to follow your main's function logic or to initialize the tool with the factory method. \r\n\r\nThank you for your time.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1250", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1250/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1250/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1250/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1250", "id": 563315427, "node_id": "MDU6SXNzdWU1NjMzMTU0Mjc=", "number": 1250, "title": "Error if colon in input/output paths when running with DockerRequirement", "user": {"login": "mccalluc", "id": 730388, "node_id": "MDQ6VXNlcjczMDM4OA==", "avatar_url": "https://avatars2.githubusercontent.com/u/730388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mccalluc", "html_url": "https://github.com/mccalluc", "followers_url": "https://api.github.com/users/mccalluc/followers", "following_url": "https://api.github.com/users/mccalluc/following{/other_user}", "gists_url": "https://api.github.com/users/mccalluc/gists{/gist_id}", "starred_url": "https://api.github.com/users/mccalluc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mccalluc/subscriptions", "organizations_url": "https://api.github.com/users/mccalluc/orgs", "repos_url": "https://api.github.com/users/mccalluc/repos", "events_url": "https://api.github.com/users/mccalluc/events{/privacy}", "received_events_url": "https://api.github.com/users/mccalluc/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-02-11T16:14:28Z", "updated_at": "2020-02-19T18:25:43Z", "closed_at": "2020-02-19T18:25:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected Behavior\r\nWhen run with `DockerRequirement`, input paths with colons should work.\r\n\r\n## Actual Behavior\r\nIt fails: \r\n\r\n```\r\nINFO [job workflow.cwl] /tmp/4cf898fg$ docker \\\r\n   run \\\r\n   -i \\\r\n   --volume=/tmp/4cf898fg:/HZfoyx:rw \\\r\n   --volume=/tmp/e8pu8i7i:/tmp:rw \\\r\n   --volume=/home/airflow/repositories/ingest-pipeline/src/ingest-pipeline/airflow/data/temp/trig_\r\n_2020-02-08T22:34:44.290910+00:00/cwl_out/cluster-marker-genes:/var/lib/cwl/stg706d994b-d3e7-49fd-9\r\n9a2-d236a8783326/cluster-marker-genes:ro \\\r\n   --workdir=/HZfoyx \\\r\n   --read-only=true \\\r\n   --user=1008:1008 \\\r\n...\r\ndocker: Error response from daemon: invalid volume specification: '/home/airflow/repositories/inges\r\nt-pipeline/src/ingest-pipeline/airflow/data/temp/trig__2020-02-08T22:34:44.290910+00:00/cwl_out/clu\r\nster-marker-genes:/var/lib/cwl/stg706d994b-d3e7-49fd-99a2-d236a8783326/cluster-marker-genes:ro'.\r\n```\r\n\r\n(from https://github.com/hubmapconsortium/airflow-dev/issues/33)\r\n\r\n## Root Cause\r\nin `cwltool/docker.py`:\r\n```\r\n    def append_volume(runtime, source, target, writable=False):\r\n        # type: (List[str], str, str, bool) -> None\r\n        \"\"\"Add binding arguments to the runtime list.\"\"\"\r\n        runtime.append(\r\n            \"--volume={}:{}:{}\".format(\r\n                docker_windows_path_adjust(source), target, \"rw\" if writable else \"ro\"\r\n            )\r\n        )\r\n```\r\nWith the `--volume`, colons have a special meaning. The **[solution](https://github.com/moby/moby/issues/8604#issuecomment-332673783)** is to use `--mount` instead.\r\n\r\n## Next Steps\r\nI'll make a PR to address this.\r\n\r\n## Workflow Code\r\n(skip for now)\r\n## Full Traceback\r\n(skip for now)\r\n## Your Environment\r\n(skip for now)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1238", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1238/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1238/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1238/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1238", "id": 554623355, "node_id": "MDU6SXNzdWU1NTQ2MjMzNTU=", "number": 1238, "title": "Workflow that passes validation fails to pack", "user": {"login": "KerstenBreuer", "id": 28008309, "node_id": "MDQ6VXNlcjI4MDA4MzA5", "avatar_url": "https://avatars3.githubusercontent.com/u/28008309?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KerstenBreuer", "html_url": "https://github.com/KerstenBreuer", "followers_url": "https://api.github.com/users/KerstenBreuer/followers", "following_url": "https://api.github.com/users/KerstenBreuer/following{/other_user}", "gists_url": "https://api.github.com/users/KerstenBreuer/gists{/gist_id}", "starred_url": "https://api.github.com/users/KerstenBreuer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KerstenBreuer/subscriptions", "organizations_url": "https://api.github.com/users/KerstenBreuer/orgs", "repos_url": "https://api.github.com/users/KerstenBreuer/repos", "events_url": "https://api.github.com/users/KerstenBreuer/events{/privacy}", "received_events_url": "https://api.github.com/users/KerstenBreuer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-24T09:18:56Z", "updated_at": "2020-01-24T15:32:27Z", "closed_at": "2020-01-24T13:40:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nIf a workflow that passes validation (`cwltool --validate`) there should be no errors when packing.\r\n\r\n## Actual Behavior\r\nIn this specific case, I tested the workflow https://raw.githubusercontent.com/Athanaseus/2gc-pipeline/master/selfcal_simulation.cwl .\r\n\r\nIt passes the validation (`cwltool --validate https://raw.githubusercontent.com/Athanaseus/2gc-pipeline/master/selfcal_simulation.cwl`) but fails when running:\r\n```\r\ncwltool --pack --debug \\\r\nhttps://raw.githubusercontent.com/Athanaseus/2gc-pipeline/master/selfcal_simulation.cwl > /dev/null\r\n```\r\n\r\nAlso see CompEpigen/CWLab#38.\r\n(@Athanaseus please have a look.)\r\n## Workflow Code\r\nPlease find it at https://raw.githubusercontent.com/Athanaseus/2gc-pipeline/master/selfcal_simulation.cwl.\r\n\r\n## Full Traceback\r\nThe error thrown was:\r\n```\r\nINFO /usr/local/bin/cwltool 1.0.20180809224403\r\nERROR I'm sorry, I couldn't load this CWL file.\r\nThe error was:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/cwltool/main.py\", line 916, in main\r\n    print_pack(loadingContext.loader, processobj, uri, metadata)\r\n  File \"/usr/local/lib/python3.6/dist-packages/cwltool/main.py\", line 563, in print_pack\r\n    packed = pack(document_loader, processobj, uri, metadata)\r\n  File \"/usr/local/lib/python3.6/dist-packages/cwltool/pack.py\", line 222, in pack\r\n    import_embed(packed, set())\r\n  File \"/usr/local/lib/python3.6/dist-packages/cwltool/pack.py\", line 118, in import_embed\r\n    import_embed(d[k], seen)\r\n  File \"/usr/local/lib/python3.6/dist-packages/cwltool/pack.py\", line 104, in import_embed\r\n    import_embed(v, seen)\r\n  File \"/usr/local/lib/python3.6/dist-packages/cwltool/pack.py\", line 118, in import_embed\r\n    import_embed(d[k], seen)\r\n  File \"/usr/local/lib/python3.6/dist-packages/cwltool/pack.py\", line 108, in import_embed\r\n    if d[n] in seen:\r\nTypeError: unhashable type: 'CommentedMap'\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180809224403\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1235", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1235/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1235/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1235/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1235", "id": 551794091, "node_id": "MDU6SXNzdWU1NTE3OTQwOTE=", "number": 1235, "title": "loosen ruaml.yaml version requirement?", "user": {"login": "Zymergen-phaverty", "id": 55174937, "node_id": "MDQ6VXNlcjU1MTc0OTM3", "avatar_url": "https://avatars2.githubusercontent.com/u/55174937?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zymergen-phaverty", "html_url": "https://github.com/Zymergen-phaverty", "followers_url": "https://api.github.com/users/Zymergen-phaverty/followers", "following_url": "https://api.github.com/users/Zymergen-phaverty/following{/other_user}", "gists_url": "https://api.github.com/users/Zymergen-phaverty/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zymergen-phaverty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zymergen-phaverty/subscriptions", "organizations_url": "https://api.github.com/users/Zymergen-phaverty/orgs", "repos_url": "https://api.github.com/users/Zymergen-phaverty/repos", "events_url": "https://api.github.com/users/Zymergen-phaverty/events{/privacy}", "received_events_url": "https://api.github.com/users/Zymergen-phaverty/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-18T16:51:00Z", "updated_at": "2020-01-22T12:45:27Z", "closed_at": "2020-01-22T12:45:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Good morning. I am interested in the very specific version requirement for ruaml.yaml. This causes me a bit of dependency conflict. Can I help update something in cwltool that would allow for a version of ruaml.yaml > 0.16.0 to be used?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1234", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1234/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1234/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1234/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1234", "id": 551481885, "node_id": "MDU6SXNzdWU1NTE0ODE4ODU=", "number": 1234, "title": "Issue with multiple schema definitions in same file", "user": {"login": "ionox0", "id": 6385646, "node_id": "MDQ6VXNlcjYzODU2NDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/6385646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ionox0", "html_url": "https://github.com/ionox0", "followers_url": "https://api.github.com/users/ionox0/followers", "following_url": "https://api.github.com/users/ionox0/following{/other_user}", "gists_url": "https://api.github.com/users/ionox0/gists{/gist_id}", "starred_url": "https://api.github.com/users/ionox0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ionox0/subscriptions", "organizations_url": "https://api.github.com/users/ionox0/orgs", "repos_url": "https://api.github.com/users/ionox0/repos", "events_url": "https://api.github.com/users/ionox0/events{/privacy}", "received_events_url": "https://api.github.com/users/ionox0/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-17T15:33:16Z", "updated_at": "2020-01-22T15:26:25Z", "closed_at": "2020-01-20T09:02:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "It seems that only the last type in a referenced `SchemaDef` file is able to be referenced in a workflow. With multiple type definitions, it only passes validation if only the last type definition is used. \r\n\r\nThis may just be an issue with the `--validate` command, as the workflow seems to still run. \r\n\r\n## Expected Behavior\r\nAny of the types referenced by `schema.yml#my_type` should be available in a workflow\r\n\r\n## Actual Behavior\r\nOnly the last type that is present in the definitions file is available, and only that case successfully passes `cwltool --validate` and runs. \r\n\r\n## Workflow Code\r\nschemas.yaml\r\n```\r\ntype: record\r\nname: my_type_one\r\nfields:\r\n  - name: a_field\r\n    type: string\r\n\r\ntype: record\r\nname: my_type_two\r\nfields:\r\n  - name: another_field\r\n    type: string\r\n```\r\n\r\nworkflow.cwl\r\n```\r\n...\r\nrequirements:\r\n  SchemaDefRequirement:\r\n    types:\r\n      - $import: schemas.yaml\r\n...\r\n\r\ninputs:\r\n  run_tools: schemas.yaml#my_type_one\r\n...\r\n```\r\n\r\n```\r\nchecking object `workflows/ACCESS_pipeline.cwl#run_tools`\r\n    Field `type` references unknown identifier `file:///Users/johnsoni/Desktop/Code/Innovation-Pipeline/resources/run_tools/schemas.yaml#my_type_one`\r\n```\r\n\r\n## Full Traceback\r\n```\r\n/usr/local/bin/cwltool 1.0.20180306140409\r\nResolved 'workflows/ACCESS_pipeline.cwl' to 'file:///Users/johnsoni/Desktop/Code/Innovation-Pipeline/workflows/ACCESS_pipeline.cwl'\r\nTool definition failed validation:\r\nworkflows/ACCESS_pipeline.cwl:26:1: checking field `inputs`\r\nworkflows/ACCESS_pipeline.cwl:28:3:   checking object `workflows/ACCESS_pipeline.cwl#run_tools`\r\nworkflows/ACCESS_pipeline.cwl:28:3:     Field `type` references unknown identifier `file:///Users/johnsoni/Desktop/Code/Innovation-Pipeline/resources/run_tools/schemas.yaml#run_tools`, tried file:///Users/johnsoni/Desktop/Code/Innovation-Pipeline/workflows/ACCESS_pipeline.cwl#file:///Users/johnsoni/Desktop/Code/Innovation-Pipeline/resources/run_tools/schemas.yaml#run_tools\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180306140409\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1232", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1232/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1232/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1232/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1232", "id": 551177793, "node_id": "MDU6SXNzdWU1NTExNzc3OTM=", "number": 1232, "title": "Allow secondaryFile JavaScript expression to accept file object for secondary ", "user": {"login": "illusional", "id": 22381693, "node_id": "MDQ6VXNlcjIyMzgxNjkz", "avatar_url": "https://avatars1.githubusercontent.com/u/22381693?v=4", "gravatar_id": "", "url": "https://api.github.com/users/illusional", "html_url": "https://github.com/illusional", "followers_url": "https://api.github.com/users/illusional/followers", "following_url": "https://api.github.com/users/illusional/following{/other_user}", "gists_url": "https://api.github.com/users/illusional/gists{/gist_id}", "starred_url": "https://api.github.com/users/illusional/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/illusional/subscriptions", "organizations_url": "https://api.github.com/users/illusional/orgs", "repos_url": "https://api.github.com/users/illusional/repos", "events_url": "https://api.github.com/users/illusional/events{/privacy}", "received_events_url": "https://api.github.com/users/illusional/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-17T03:29:34Z", "updated_at": "2020-04-16T19:22:45Z", "closed_at": "2020-04-16T19:22:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This issue is based on the Discourse: https://cwl.discourse.group/t/ask-cwl-to-rename-a-secondary-file/72 and conversation: https://gitter.im/common-workflow-language/common-workflow-language?at=5df2f44d7ce7ea1e3574bfb4\r\n\r\n##  Expected Behavior\r\nAn expression in the CWLTool field on an output should allow a file object to be returned (of the secondary file), primarily to allow an override in the glob.\r\n\r\nThe spec says:\r\n\r\n> The expression must return:\r\n> - a filename string relative to the path to the primary File,\r\n> - a File or Directory object with either path or location and basename fields set,\r\nor an array consisting of strings or File or Directory objects.\r\n> - It is legal to reference an unchanged File or Directory object taken from input as a secondaryFile.\r\n\r\n## Actual Behavior\r\n\r\nIt fails, as it things the return type is a string of the `sfname` (and builds the location based on that). \r\n\r\n## Workflow Code\r\n```yaml\r\n  out:\r\n    type: File\r\n    outputBinding:\r\n      glob: $(inputs.bam.basename)\r\n    secondaryFiles: |\r\n      ${\r\n          function resolveSecondary(base, secPattern) {\r\n            if (secPattern[0] == \"^\") {\r\n              var spl = base.split(\".\");\r\n              var endIndex = spl.length > 1 ? spl.length - 1 : 1;\r\n              return resolveSecondary(spl.slice(undefined, endIndex).join(\".\"), secPattern.slice(1));\r\n            }\r\n            return base + secPattern\r\n          }\r\n\r\n          return [{\r\n            path: resolveSecondary(self.path, \"^.bai\"),\r\n            basename: resolveSecondary(self.basename, \".bai\"),\r\n          }]\r\n      }\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\nTraceback (most recent call last):\r\n  File \"/anaconda3/lib/python3.7/site-packages/cwltool/executors.py\", line 169, in run_jobs\r\n    for job in jobiter:\r\n  File \"/anaconda3/lib/python3.7/site-packages/cwltool/command_line_tool.py\", line 430, in job\r\n    builder = self._init_job(job_order, runtimeContext)\r\n  File \"/anaconda3/lib/python3.7/site-packages/cwltool/process.py\", line 747, in _init_job\r\n    discover_secondaryFiles=getdefault(runtime_context.toplevel, False)))\r\n  File \"/anaconda3/lib/python3.7/site-packages/cwltool/builder.py\", line 276, in bind_input\r\n    bindings.extend(self.bind_input(f, datum[f[\"name\"]], lead_pos=lead_pos, tail_pos=f[\"name\"], discover_secondaryFiles=discover_secondaryFiles))\r\n  File \"/anaconda3/lib/python3.7/site-packages/cwltool/builder.py\", line 332, in bind_input\r\n    sf_location = datum[\"location\"][0:datum[\"location\"].rindex(\"/\")+1]+sfname\r\nTypeError: can only concatenate str (not \"dict\") to str\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: /anaconda3/bin/cwltool 2.0.20200107113851\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1229", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1229/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1229/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1229/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1229", "id": 538817759, "node_id": "MDU6SXNzdWU1Mzg4MTc3NTk=", "number": 1229, "title": "Output evaluation is not including secondary files.", "user": {"login": "illusional", "id": 22381693, "node_id": "MDQ6VXNlcjIyMzgxNjkz", "avatar_url": "https://avatars1.githubusercontent.com/u/22381693?v=4", "gravatar_id": "", "url": "https://api.github.com/users/illusional", "html_url": "https://github.com/illusional", "followers_url": "https://api.github.com/users/illusional/followers", "following_url": "https://api.github.com/users/illusional/following{/other_user}", "gists_url": "https://api.github.com/users/illusional/gists{/gist_id}", "starred_url": "https://api.github.com/users/illusional/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/illusional/subscriptions", "organizations_url": "https://api.github.com/users/illusional/orgs", "repos_url": "https://api.github.com/users/illusional/repos", "events_url": "https://api.github.com/users/illusional/events{/privacy}", "received_events_url": "https://api.github.com/users/illusional/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-17T03:56:29Z", "updated_at": "2019-12-17T08:57:53Z", "closed_at": "2019-12-17T08:57:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "##  Expected Behavior\r\n\r\n> I'm trying to rewrite the extension of a secondary file.\r\n\r\nThe `outputEval` block does not contain an array for secondaryFiles.\r\n\r\n## Actual Behavior\r\n\r\nWithin `self` in the `outputEval` javascript block, no `secondaryFiles` property is found.\r\n\r\nThis is because the [\"outputEval\" block is before](https://github.com/common-workflow-language/cwltool/blob/master/cwltool/command_line_tool.py#L779-L781) the [secondaryFiles resolution block](https://github.com/common-workflow-language/cwltool/blob/master/cwltool/command_line_tool.py#L795-L828). Traceback below shows the missing block.\r\n\r\n## Workflow Code\r\n\r\ncwl\r\n```\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nbaseCommand: \"ls\"\r\ninputs:\r\n  bam:\r\n    type: File\r\n    secondaryFiles: [\"^.bai\"]\r\noutputs:\r\n  std: stdout\r\n  out:\r\n    type: File\r\n    secondaryFiles: [\"^.bai\"]\r\n    outputBinding:\r\n      glob: $(inputs.bam.basename)\r\n      outputEval: |\r\n        ${\r\n            console.log(self)\r\n            self[0].secondaryFiles[0].basename=\".bai\"\r\n        }\r\nrequirements:\r\n  InitialWorkDirRequirement:\r\n    listing:\r\n      - $(inputs.bam)\r\n  InlineJavascriptRequirement: {}\r\n```\r\n\r\n## Full Traceback\r\n\r\n_This has been formatted for readability_:\r\n\r\n```\r\n('Error collecting output for parameter \\'out\\':Expression evaluation error:Expecting value: line 1 column 1 (char 0)script was:\r\n01 \"use strict\";\r\n02 var inputs = {\r\n03     \"bam\": {\r\n04         \"class\": \"File\",\r\n05         \"location\": \"file:///path/to/BRCA1.bam\",\r\n06         \"size\": 2997846,\r\n07         \"basename\": \"BRCA1.bam\",\r\n08         \"nameroot\": \"BRCA1\",\r\n09         \"nameext\": \".bam\",\r\n10         \"secondaryFiles\": [\r\n11             {\r\n12                 \"location\": \"file:///path/to/BRCA1.bai\",\r\n13                 \"basename\": \"BRCA1.bai\",\r\n14                 \"class\": \"File\",\r\n15                 \"nameroot\": \"BRCA1\",\r\n16                 \"nameext\": \".bai\",\r\n17                 \"path\": \"/private/tmp/docker_tmplo7vt97z/BRCA1.bai\",\r\n18                 \"dirname\": \"/private/tmp/docker_tmplo7vt97z\"\r\n19             }\r\n20         ],\r\n21         \"path\": \"/private/tmp/docker_tmplo7vt97z/BRCA1.bam\",\r\n22         \"dirname\": \"/private/tmp/docker_tmplo7vt97z\"\r\n23     }\r\n24 };\r\n25 var self = [\r\n26     {\r\n27         \"location\": \"file:///private/tmp/docker_tmplo7vt97z/BRCA1.bam\",\r\n28         \"path\": \"/private/tmp/docker_tmplo7vt97z/BRCA1.bam\",\r\n29         \"basename\": \"BRCA1.bam\",\r\n30         \"nameroot\": \"BRCA1\",\r\n31         \"nameext\": \".bam\",\r\n32         \"class\": \"File\",\r\n33         \"checksum\": \"sha1$8a38a4e8d58c91d9aaca8cdc739e05eddf7dec1d\",\r\n              # missing secondaryFiles here\r\n34         \"size\": 2997846\r\n35     }\r\n36 ];\r\n37 var runtime = {\r\n38     \"cores\": 1,\r\n39     \"ram\": 1024,\r\n40     \"tmpdirSize\": 1024,\r\n41     \"outdirSize\": 1024,\r\n42     \"tmpdir\": \"/private/var/folders/jz/y9gqxt_s7jxcjkc26gr71ywr7zs5yz/T/tmpoer80xbz\",\r\n43     \"outdir\": \"/private/tmp/docker_tmplo7vt97z\"\r\n44 };\r\n45 (function(){\r\n46     console.log(self)\r\n47     self[0].secondaryFiles[0].basename=\".bai\"\r\n48     return self\r\n49 })()\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: `cwltool-1.0.20191213153910`\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1224", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1224/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1224/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1224/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1224", "id": 533909298, "node_id": "MDU6SXNzdWU1MzM5MDkyOTg=", "number": 1224, "title": "AttributeError: module 'schema_salad.validate' has no attribute 'indent'", "user": {"login": "gijzelaerr", "id": 326308, "node_id": "MDQ6VXNlcjMyNjMwOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/326308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gijzelaerr", "html_url": "https://github.com/gijzelaerr", "followers_url": "https://api.github.com/users/gijzelaerr/followers", "following_url": "https://api.github.com/users/gijzelaerr/following{/other_user}", "gists_url": "https://api.github.com/users/gijzelaerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gijzelaerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gijzelaerr/subscriptions", "organizations_url": "https://api.github.com/users/gijzelaerr/orgs", "repos_url": "https://api.github.com/users/gijzelaerr/repos", "events_url": "https://api.github.com/users/gijzelaerr/events{/privacy}", "received_events_url": "https://api.github.com/users/gijzelaerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-06T11:31:04Z", "updated_at": "2019-12-06T12:51:49Z", "closed_at": "2019-12-06T12:51:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I made a mistake in a CWL file, but now I get an error related to schema_salad which doesn't seem valid:\r\n```\r\n$  venv/bin/cwltool --debug workflow.cwl\r\nINFO venv/bin/cwltool 1.0.20191022103248\r\nINFO Resolved 'workflow.cwl' to 'file:///Users/gijs/Work/demo_cwl/workflow.cwl'\r\nERROR Validation exception\r\nTraceback (most recent call last):\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/workflow.py\", line 641, in __init__\r\n    toolpath_object[\"run\"], loadingContext)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/load_tool.py\", line 372, in load_tool\r\n    loadingContext, workflowobj, uri)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/load_tool.py\", line 291, in resolve_and_validate_document\r\n    processobj, metadata = document_loader.resolve_all(workflowobj, fileuri)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/schema_salad/ref_resolver.py\", line 1203, in resolve_all\r\n    strict_foreign_properties=strict_foreign_properties,\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/schema_salad/ref_resolver.py\", line 1426, in validate_links\r\n    raise errors[0]\r\nschema_salad.exceptions.ValidationException: first.cwl:7:1:  checking field `inputs`\r\nfirst.cwl:12:3:   checking object `first.cwl#a_string_argument`\r\nfirst.cwl:13:5:     Field `type` references unknown identifier `str`, tried\r\n                    file:///Users/gijs/Work/demo_cwl/first.cwl#str\r\nERROR I'm sorry, I couldn't load this CWL file.\r\nThe error was:\r\nTraceback (most recent call last):\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/workflow.py\", line 641, in __init__\r\n    toolpath_object[\"run\"], loadingContext)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/load_tool.py\", line 372, in load_tool\r\n    loadingContext, workflowobj, uri)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/load_tool.py\", line 291, in resolve_and_validate_document\r\n    processobj, metadata = document_loader.resolve_all(workflowobj, fileuri)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/schema_salad/ref_resolver.py\", line 1203, in resolve_all\r\n    strict_foreign_properties=strict_foreign_properties,\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/schema_salad/ref_resolver.py\", line 1426, in validate_links\r\n    raise errors[0]\r\nschema_salad.exceptions.ValidationException: first.cwl:7:1:  checking field `inputs`\r\nfirst.cwl:12:3:   checking object `first.cwl#a_string_argument`\r\nfirst.cwl:13:5:     Field `type` references unknown identifier `str`, tried\r\n                    file:///Users/gijs/Work/demo_cwl/first.cwl#str\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/main.py\", line 779, in main\r\n    tool = make_tool(uri, loadingContext)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/load_tool.py\", line 353, in make_tool\r\n    tool = loadingContext.construct_tool_object(processobj, loadingContext)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/workflow.py\", line 58, in default_make_tool\r\n    return Workflow(toolpath_object, loadingContext)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/workflow.py\", line 543, in __init__\r\n    loadingContext.prov_obj))\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/workflow.py\", line 576, in make_workflow_step\r\n    return WorkflowStep(toolpath_object, pos, loadingContext, parentworkflowProv)\r\n  File \"/Users/gijs/Work/demo_cwl/venv/lib/python3.7/site-packages/cwltool/workflow.py\", line 647, in __init__\r\n    (toolpath_object[\"run\"], validate.indent(str(vexc)))), vexc)\r\nAttributeError: module 'schema_salad.validate' has no attribute 'indent'\r\n```\r\n\r\n```\r\n$  venv/bin/pip freeze | grep salad\r\nschema-salad==4.5.20191204060541\r\n```\r\n\r\nInstallation method was just `pip install cwltool` in a python3 venv.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1223", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1223/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1223/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1223/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1223", "id": 532864316, "node_id": "MDU6SXNzdWU1MzI4NjQzMTY=", "number": 1223, "title": "pass option \"--entrypoint\" to docker run", "user": {"login": "hubentu", "id": 9856666, "node_id": "MDQ6VXNlcjk4NTY2NjY=", "avatar_url": "https://avatars1.githubusercontent.com/u/9856666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hubentu", "html_url": "https://github.com/hubentu", "followers_url": "https://api.github.com/users/hubentu/followers", "following_url": "https://api.github.com/users/hubentu/following{/other_user}", "gists_url": "https://api.github.com/users/hubentu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hubentu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hubentu/subscriptions", "organizations_url": "https://api.github.com/users/hubentu/orgs", "repos_url": "https://api.github.com/users/hubentu/repos", "events_url": "https://api.github.com/users/hubentu/events{/privacy}", "received_events_url": "https://api.github.com/users/hubentu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-04T18:40:20Z", "updated_at": "2020-04-07T11:16:16Z", "closed_at": "2020-04-07T11:16:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nIs there a way to pass \"--entrypoint /bin/bash\" to docker run by cwltool?\r\n\r\nI want to use another tool from a docker image that has entrypoint option. An option \"--entrypoint /bin/bash\" to `docker run` would work. But I couldn't find a way to pass docker run options from cwltool.\r\n\r\nThanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1217", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1217/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1217/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1217/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1217", "id": 515116034, "node_id": "MDU6SXNzdWU1MTUxMTYwMzQ=", "number": 1217, "title": "'First example' fails with Python import error", "user": {"login": "stevekm", "id": 10505524, "node_id": "MDQ6VXNlcjEwNTA1NTI0", "avatar_url": "https://avatars3.githubusercontent.com/u/10505524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stevekm", "html_url": "https://github.com/stevekm", "followers_url": "https://api.github.com/users/stevekm/followers", "following_url": "https://api.github.com/users/stevekm/following{/other_user}", "gists_url": "https://api.github.com/users/stevekm/gists{/gist_id}", "starred_url": "https://api.github.com/users/stevekm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stevekm/subscriptions", "organizations_url": "https://api.github.com/users/stevekm/orgs", "repos_url": "https://api.github.com/users/stevekm/repos", "events_url": "https://api.github.com/users/stevekm/events{/privacy}", "received_events_url": "https://api.github.com/users/stevekm/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-31T02:39:38Z", "updated_at": "2020-02-07T05:49:03Z", "closed_at": "2019-10-31T10:19:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nTrying to run through the intro guide's [first example](https://www.commonwl.org/user_guide/02-1st-example/index.html) and `cwl-runner` fails with an error:\r\n\r\n```\r\n$ cwl-runner 1st-tool.cwl echo-job.yml\r\nTraceback (most recent call last):\r\n  File \"/Users/steve/projects/cwl-test1/conda/bin/cwl-runner\", line 6, in <module>\r\n    from cwltool.main import main\r\n  File \"/Users/steve/projects/cwl-test1/conda/lib/python3.6/site-packages/cwltool/main.py\", line 18, in <module>\r\n    import schema_salad.validate as validate\r\n  File \"/Users/steve/projects/cwl-test1/conda/lib/python3.6/site-packages/schema_salad/__init__.py\", line 35, in <module>\r\n    from past import autotranslate  # type: ignore\r\nImportError: cannot import name 'autotranslate'\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n\r\n```\r\n$ cwltool --version\r\nTraceback (most recent call last):\r\n  File \"/Users/steve/projects/cwl-test1/conda/bin/cwltool\", line 11, in <module>\r\n    load_entry_point('cwltool==1.0.20180225105849', 'console_scripts', 'cwltool')()\r\n  File \"/Users/steve/projects/cwl-test1/conda/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 476, in load_entry_point\r\n    return get_distribution(dist).load_entry_point(group, name)\r\n  File \"/Users/steve/projects/cwl-test1/conda/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 2700, in load_entry_point\r\n    return ep.load()\r\n  File \"/Users/steve/projects/cwl-test1/conda/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 2318, in load\r\n    return self.resolve()\r\n  File \"/Users/steve/projects/cwl-test1/conda/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 2324, in resolve\r\n    module = __import__(self.module_name, fromlist=['__name__'], level=0)\r\n  File \"/Users/steve/projects/cwl-test1/conda/lib/python3.6/site-packages/cwltool/main.py\", line 18, in <module>\r\n    import schema_salad.validate as validate\r\n  File \"/Users/steve/projects/cwl-test1/conda/lib/python3.6/site-packages/schema_salad/__init__.py\", line 35, in <module>\r\n    from past import autotranslate  # type: ignore\r\nImportError: cannot import name 'autotranslate'\r\n```\r\n\r\nInstalled with `conda`;\r\n\r\n```\r\nconda install -y \\\r\n\tconda=4.5.4 \\\r\n\tbioconda::cwltool=1.0.20180225105849 \\\r\n\tconda-forge::cwl_runner=1.0\r\n```\r\n\r\nI tried searching for this missing `autotranslate` package in `conda` but did not see it listed.  Any suggestions? Thanks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1214", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1214/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1214/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1214/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1214", "id": 511925993, "node_id": "MDU6SXNzdWU1MTE5MjU5OTM=", "number": 1214, "title": "Setup cwltool.readthedocs.org", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-10-24T12:55:24Z", "updated_at": "2019-10-25T13:07:58Z", "closed_at": "2019-10-25T13:07:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "https://docs.readthedocs.io/en/stable/intro/getting-started-with-sphinx.html", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1200", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1200/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1200/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1200/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1200", "id": 498453933, "node_id": "MDU6SXNzdWU0OTg0NTM5MzM=", "number": 1200, "title": "only the last SchemaDefRequirement seems to be registered.", "user": {"login": "itajaja", "id": 697647, "node_id": "MDQ6VXNlcjY5NzY0Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/697647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/itajaja", "html_url": "https://github.com/itajaja", "followers_url": "https://api.github.com/users/itajaja/followers", "following_url": "https://api.github.com/users/itajaja/following{/other_user}", "gists_url": "https://api.github.com/users/itajaja/gists{/gist_id}", "starred_url": "https://api.github.com/users/itajaja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/itajaja/subscriptions", "organizations_url": "https://api.github.com/users/itajaja/orgs", "repos_url": "https://api.github.com/users/itajaja/repos", "events_url": "https://api.github.com/users/itajaja/events{/privacy}", "received_events_url": "https://api.github.com/users/itajaja/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-09-25T18:34:01Z", "updated_at": "2019-09-26T14:03:20Z", "closed_at": "2019-09-26T09:42:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected Behavior\r\nIt should work\r\n\r\n## Actual Behavior\r\ninstead received error:\r\n\r\n```\r\nERROR Tool definition failed validation:\r\nlocal-tests/workflow2.cwl:19:1: Type property \"Foo\" not a valid Avro schema: Could not make an Avro Schema object from Foo.\r\n```\r\n\r\nNow, if we remove the second `SchemaDefRequirement` then it works, or if we swap the order of the two `SchemaDefRequirement` entries. it feels like only the last `SchemaDefRequirement` is used in Avro. Not sure if this is a cwltool error or an schema_salad, or maybe it's by design.\r\n\r\n## Workflow Code\r\n```yml\r\ncwlVersion: v1.0\r\nclass: Workflow\r\nlabel: HelloWorld\r\nrequirements:\r\n- class: StepInputExpressionRequirement\r\n- class: InlineJavascriptRequirement\r\n- class: MultipleInputFeatureRequirement\r\n- class: SchemaDefRequirement\r\n  types:\r\n  - name: Foo\r\n    type: enum\r\n    symbols: [a, b]\r\n- class: SchemaDefRequirement\r\n  types:\r\n  - name: Bar\r\n    type: enum\r\n    symbols: [c, d]\r\n\r\ninputs:\r\n  foo:\r\n    type: Foo\r\n\r\noutputs: {}\r\n\r\nsteps: {}\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\nTraceback (most recent call last):\r\n  File \"/Users/gtagliabue/.pyenv/versions/3.7.2/envs/cwltool/lib/python3.7/site-packages/schema_salad/avro/schema.py\", line 297, in __init__\r\n    type_schema = make_avsc_object(cast(Dict[Text, Text], atype), names)\r\n  File \"/Users/gtagliabue/.pyenv/versions/3.7.2/envs/cwltool/lib/python3.7/site-packages/schema_salad/avro/schema.py\", line 599, in make_avsc_object\r\n    raise SchemaParseException(fail_msg)\r\nschema_salad.avro.schema.SchemaParseException: Could not make an Avro Schema object from Foo.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/gtagliabue/workspace/qsi/cwltool/cwltool/process.py\", line 542, in __init__\r\n    schema.convert_to_dict(self.inputs_record_schema), self.names)\r\n  File \"/Users/gtagliabue/.pyenv/versions/3.7.2/envs/cwltool/lib/python3.7/site-packages/schema_salad/avro/schema.py\", line 581, in make_avsc_object\r\n    name, namespace, fields, names, atype, doc, other_props\r\n  File \"/Users/gtagliabue/.pyenv/versions/3.7.2/envs/cwltool/lib/python3.7/site-packages/schema_salad/avro/schema.py\", line 524, in __init__\r\n    field_objects = RecordSchema.make_field_objects(fields, names)\r\n  File \"/Users/gtagliabue/.pyenv/versions/3.7.2/envs/cwltool/lib/python3.7/site-packages/schema_salad/avro/schema.py\", line 482, in make_field_objects\r\n    atype, name, has_default, default, order, names, doc, other_props\r\n  File \"/Users/gtagliabue/.pyenv/versions/3.7.2/envs/cwltool/lib/python3.7/site-packages/schema_salad/avro/schema.py\", line 300, in __init__\r\n    'Type property \"%s\" not a valid Avro schema: %s' % (atype, e)\r\nschema_salad.avro.schema.SchemaParseException: Type property \"Foo\" not a valid Avro schema: Could not make an Avro Schema object from Foo.\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/gtagliabue/workspace/qsi/cwltool/cwltool/main.py\", line 690, in main\r\n    tool = make_tool(uri, loadingContext)\r\n  File \"/Users/gtagliabue/workspace/qsi/cwltool/cwltool/load_tool.py\", line 352, in make_tool\r\n    tool = loadingContext.construct_tool_object(processobj, loadingContext)\r\n  File \"/Users/gtagliabue/workspace/qsi/cwltool/cwltool/workflow.py\", line 58, in default_make_tool\r\n    return Workflow(toolpath_object, loadingContext)\r\n  File \"/Users/gtagliabue/workspace/qsi/cwltool/cwltool/workflow.py\", line 511, in __init__\r\n    toolpath_object, loadingContext)\r\n  File \"/Users/gtagliabue/workspace/qsi/cwltool/cwltool/process.py\", line 542, in __init__\r\n    schema.convert_to_dict(self.inputs_record_schema), self.names)\r\n  File \"/Users/gtagliabue/.pyenv/versions/3.7.2/envs/cwltool/lib/python3.7/site-packages/schema_salad/sourceline.py\", line 298, in __exit__\r\n    raise_from(self.makeError(six.text_type(exc_value)), exc_value)\r\n  File \"/Users/gtagliabue/.pyenv/versions/3.7.2/envs/cwltool/lib/python3.7/site-packages/future/utils/__init__.py\", line 400, in raise_from\r\n    exec(execstr, myglobals, mylocals)\r\n  File \"<string>\", line 1, in <module>\r\nschema_salad.validate.ValidationException: local-tests/workflow2.cwl:19:1: Type property \"Foo\" not a valid Avro schema: Could not make an Avro Schema object from Foo.\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: `1.0.20190915164430`\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1195", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1195/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1195/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1195/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1195", "id": 491545458, "node_id": "MDU6SXNzdWU0OTE1NDU0NTg=", "number": 1195, "title": "Output files don't end up in current working directory when run from python", "user": {"login": "EricBoix", "id": 26405741, "node_id": "MDQ6VXNlcjI2NDA1NzQx", "avatar_url": "https://avatars2.githubusercontent.com/u/26405741?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EricBoix", "html_url": "https://github.com/EricBoix", "followers_url": "https://api.github.com/users/EricBoix/followers", "following_url": "https://api.github.com/users/EricBoix/following{/other_user}", "gists_url": "https://api.github.com/users/EricBoix/gists{/gist_id}", "starred_url": "https://api.github.com/users/EricBoix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EricBoix/subscriptions", "organizations_url": "https://api.github.com/users/EricBoix/orgs", "repos_url": "https://api.github.com/users/EricBoix/repos", "events_url": "https://api.github.com/users/EricBoix/events{/privacy}", "received_events_url": "https://api.github.com/users/EricBoix/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-09-10T09:07:05Z", "updated_at": "2019-09-16T13:38:56Z", "closed_at": "2019-09-16T13:34:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nOutput files should end up in the invocation directory when a workflow (docker based) is [run as a module](https://github.com/common-workflow-language/cwltool#import-as-a-module) just as when the same workflow is run with the cwl-runner.\r\n\r\n## Actual Behavior\r\nNo output files in the invocation directory (actually where do they end up at all?) \r\n\r\n## Workflow Code\r\nFor convenience, all the files required to reproduce this issue can be found within the [attached outdir_in_python.zip zipfile](https://github.com/common-workflow-language/cwltool/files/3594658/outdir_in_python.zip) (proceed with the withheld `Readme.md`). \r\n\r\nThe following is an extract from those files:\r\n - recreate the `tar.cwl`, `tar-job.yml` and `hello.tar` files of the [output chapter of the user guide](https://www.commonwl.org/user_guide/04-output/index.html)\r\n - create the following `tar.py` file\r\n    _tar.py_\r\n    ```\r\n     import cwltool.factory\r\n     import re\r\n     import yaml\r\n     import json\r\n     import os\r\n\r\n     input = yaml.load(open(\"tar-job.yml\", \"r\"), Loader=yaml.CLoader)\r\n     # Input files are specified with a \"path\" attribute when in yaml. Yet\r\n     # when in python this same attribute becomes \"location\" (refer to\r\n     # https://github.com/common-workflow-language/cwltool/issues/828 ). We thus\r\n     # need to (dirty) fix the yaml-parsed input:\r\n     for unused, file_param in input.items():\r\n        if isinstance(file_param, dict):\r\n           if 'class' in file_param and file_param['class'] == 'File':\r\n              file_param['location'] = file_param['path']\r\n\r\n     # Loading the workflow with the help of an ad-hoc factory:\r\n     fac = cwltool.factory.Factory()\r\n     logana = fac.make(\"tar.cwl\")\r\n\r\n     # Executing the workflow with the input we parsed:\r\n     result = logana(**input)\r\n\r\n     print( json.dumps(result, sort_keys=True, indent=4) )\r\n\r\n     # Eventually display the result (to provide the user with some feedback):\r\n     if os.path.isfile('hello.txt'):\r\n        print(\"OK\")\r\n     else:\r\n        print(\"Where did the output file hello.txt go ?\")\r\n    ```\r\n\r\nNow proceed with the Installation of dependencies\r\n```bash\r\nvirtualenv -p python3 venv\r\nsource venv/bin/activate\r\npip3 install cwltool\r\ncwlref-runner                  # for cwl-runner\r\npip3 install cwltool[deps]\r\npip3 install pyyaml            # for the python script\r\n```\r\n\r\nPrepare the input content (this is part of [the user guide](https://www.commonwl.org/user_guide/04-output/index.html)):\r\n```bash\r\ntouch hello.txt && tar -cvf hello.tar hello.txt\r\n```\r\n\r\nNow when running the with `tar.cwl ` with the `cwl-runner` engine an output file in the current working directory gets produced (in accordance with the workflow):\r\n```bash\r\nrm -f hello.txt      # easier to check existence of output than its time\r\ncwl-runner tar.cwl tar-job.yml\r\nls -al hello.txt     # Yep it is here\r\n```\r\n\r\nBut when invoked from python, the output file does not \"appear\" in the current working directory:\r\n```bash\r\nrm -f hello.txt\r\npython tar.py\r\nls -al hello.txt     # ls: hello.txt: No such file or directory\r\n```\r\n\r\n## Full Traceback\r\n```\r\n(venv): python tar.py\r\npython tar.py\r\nResolved 'tar.cwl' to 'file:///private/tmp/outdir_in_python/tar.cwl'\r\n[job tar.cwl] /private/var/folders/4f/l5svz0t119l_qhq9l7qnqstm0000gn/T/vnpvpywi$ tar \\\r\n    --extract \\\r\n    --file \\\r\n    /private/var/folders/4f/l5svz0t119l_qhq9l7qnqstm0000gn/T/tmpzimdaobv/stg7f6f4d45-e8f4-4886-8015-680129b0b4be/hello.tar\r\n[job tar.cwl] completed success\r\n{\r\n    \"example_out\": {\r\n        \"basename\": \"hello.txt\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"class\": \"File\",\r\n        \"http://commonwl.org/cwltool#generation\": 0,\r\n        \"location\": \"file:///private/var/folders/4f/l5svz0t119l_qhq9l7qnqstm0000gn/T/vnpvpywi/hello.txt\",\r\n        \"nameext\": \".txt\",\r\n        \"nameroot\": \"hello\",\r\n        \"size\": 0\r\n    }\r\n}\r\nWhere did the output file hello.txt go ?\r\n```\r\nA clue might be the `location` value of the result that differs from the one displayed when running with cwl-runner.\r\n\r\nNote: I tried to adapt the python script behavior by explicitly setting an \"outdir\" directory.\r\nAlas I was **unable to find any documentation of example illustrating how to set an `outdir` in the python scripting context**. Damned, no luck on this one...\r\n\r\n## Your Environment\r\n* cwltool version: cwltool 1.0.20190906054215\r\n* Python 3.6.5\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1186", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1186/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1186/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1186/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1186", "id": 488891941, "node_id": "MDU6SXNzdWU0ODg4OTE5NDE=", "number": 1186, "title": "singularity option does not work correctly 2 step workflow", "user": {"login": "manabuishii", "id": 7508005, "node_id": "MDQ6VXNlcjc1MDgwMDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/7508005?v=4", "gravatar_id": "", "url": "https://api.github.com/users/manabuishii", "html_url": "https://github.com/manabuishii", "followers_url": "https://api.github.com/users/manabuishii/followers", "following_url": "https://api.github.com/users/manabuishii/following{/other_user}", "gists_url": "https://api.github.com/users/manabuishii/gists{/gist_id}", "starred_url": "https://api.github.com/users/manabuishii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/manabuishii/subscriptions", "organizations_url": "https://api.github.com/users/manabuishii/orgs", "repos_url": "https://api.github.com/users/manabuishii/repos", "events_url": "https://api.github.com/users/manabuishii/events{/privacy}", "received_events_url": "https://api.github.com/users/manabuishii/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-04T01:18:35Z", "updated_at": "2019-09-04T03:07:18Z", "closed_at": "2019-09-04T03:07:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\n\r\nI execute CWL workflow that has 2 step with `--singularity` .\r\n\r\nI setup `CWL_SINGULARITY_CACHE`\r\n\r\n```console\r\n$ echo $CWL_SINGULARITY_CACHE\r\n/home/manabu/work/toil/singularity_cache\r\n```\r\n\r\nI execute with\r\n\r\n```\r\ncwltool --debug --singularity headhead-wf.cwl --source foobar.txt --nlines 1\r\n```\r\n\r\n\r\n## Actual Behavior\r\n\r\nFirst step works fine cwltool using singularity cached.\r\nSecond step does not work, because cwltool try to find wrong place.\r\nIt looks `CWL_SINGULARITY_CACHE` twice.\r\n\r\n## Workflow Code\r\n\r\nhere is CommandLineTool\r\n\r\n```head-container.cwl\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nrequirements:\r\n  - class: DockerRequirement\r\n    dockerPull: ubuntu:16.04\r\n\r\nbaseCommand: [head]\r\narguments: [-n$(inputs.nlines), $(inputs.source)]\r\ninputs:\r\n  - id: source\r\n    type: File\r\n  - id: nlines\r\n    type: int\r\noutputs:\r\n  - id: out\r\n    type: stdout\r\nstdout: output.txt\r\n```\r\n\r\nhere is Workflow\r\n\r\n```headhead-wf.cwl\r\ncwlVersion: v1.0\r\nclass: Workflow\r\n\r\ninputs:\r\n  - id: source\r\n    type: File\r\n  - id: nlines\r\n    type: int\r\nsteps:\r\n  - id: head1\r\n    run: head-container.cwl\r\n    in:\r\n      - id:  source\r\n        source: source\r\n      - id:  nlines\r\n        source: nlines\r\n    out: [out]\r\n  - id: head2\r\n    run: head-container.cwl\r\n    in:\r\n      - id:  source\r\n        source: head1/out\r\n      - id:  nlines\r\n        source: nlines\r\n    out: [out]\r\n\r\n\r\noutputs:\r\n  - id: headhead\r\n    type: File\r\n    outputSource: head2/out\r\n```\r\n\r\n\r\n## Full Traceback\r\n```pytb\r\nINFO /bwfefs/home/manabu/work/toil/toilgithub/bin/cwltool 1.0.20190815141648\r\nINFO Resolved 'headhead-wf.cwl' to 'file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl'\r\nDEBUG Parsed job order from command line: {\r\n    \"id\": \"headhead-wf.cwl\",\r\n    \"source\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///bwfefs/home/manabu/work/toil/zatsu/foobar.txt\"\r\n    },\r\n    \"nlines\": 1\r\n}\r\nDEBUG [workflow ] initialized from file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl\r\nINFO [workflow ] start\r\nDEBUG [workflow ] {\r\n    \"source\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///bwfefs/home/manabu/work/toil/zatsu/foobar.txt\",\r\n        \"size\": 21,\r\n        \"basename\": \"foobar.txt\",\r\n        \"nameroot\": \"foobar\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"nlines\": 1\r\n}\r\nINFO [workflow ] starting step head1\r\nDEBUG [job step head1] job input {\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head1/source\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///bwfefs/home/manabu/work/toil/zatsu/foobar.txt\",\r\n        \"size\": 21,\r\n        \"basename\": \"foobar.txt\",\r\n        \"nameroot\": \"foobar\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head1/nlines\": 1\r\n}\r\nDEBUG [job step head1] evaluated job input to {\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head1/source\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///bwfefs/home/manabu/work/toil/zatsu/foobar.txt\",\r\n        \"size\": 21,\r\n        \"basename\": \"foobar.txt\",\r\n        \"nameroot\": \"foobar\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head1/nlines\": 1\r\n}\r\nINFO [step head1] start\r\nDEBUG [job head1] initializing from file:///bwfefs/home/manabu/work/toil/zatsu/head-container.cwl as part of step head1\r\nDEBUG [job head1] {\r\n    \"source\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///bwfefs/home/manabu/work/toil/zatsu/foobar.txt\",\r\n        \"size\": 21,\r\n        \"basename\": \"foobar.txt\",\r\n        \"nameroot\": \"foobar\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"nlines\": 1\r\n}\r\nDEBUG [job head1] path mappings is {\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/foobar.txt\": [\r\n        \"/bwfefs/home/manabu/work/toil/zatsu/foobar.txt\",\r\n        \"/var/lib/cwl/stg1f0431c2-4670-4ac0-bc05-967f6eb037ae/foobar.txt\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\nDEBUG [job head1] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ],\r\n        \"datum\": \"head\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            0,\r\n            0\r\n        ],\r\n        \"valueFrom\": \"-n$(inputs.nlines)\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            0,\r\n            1\r\n        ],\r\n        \"valueFrom\": \"$(inputs.source)\"\r\n    }\r\n]\r\nINFO Using local copy of Singularity image found in /home/manabu/work/toil/singularity_cache\r\nDEBUG [job head1] initial work dir {}\r\nINFO [job head1] /tmp/maaoy1nc$ singularity \\\r\n    --quiet \\\r\n    exec \\\r\n    --contain \\\r\n    --pid \\\r\n    --ipc \\\r\n    --home \\\r\n    /tmp/maaoy1nc:/lRgfpn \\\r\n    --bind \\\r\n    /tmp/0ag_x7fj:/tmp:rw \\\r\n    --bind \\\r\n    /bwfefs/home/manabu/work/toil/zatsu/foobar.txt:/var/lib/cwl/stg1f0431c2-4670-4ac0-bc05-967f6eb037ae/foobar.txt:ro \\\r\n    --pwd \\\r\n    /lRgfpn \\\r\n    /home/manabu/work/toil/singularity_cache/ubuntu:16.04.sif \\\r\n    head \\\r\n    -n1 \\\r\n    /var/lib/cwl/stg1f0431c2-4670-4ac0-bc05-967f6eb037ae/foobar.txt > /tmp/maaoy1nc/output.txt\r\nINFO [job head1] completed success\r\nDEBUG [job head1] {\r\n    \"out\": {\r\n        \"location\": \"file:///tmp/maaoy1nc/output.txt\",\r\n        \"basename\": \"output.txt\",\r\n        \"nameroot\": \"output\",\r\n        \"nameext\": \".txt\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n        \"size\": 2,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\nDEBUG [step head1] produced output {\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head1/out\": {\r\n        \"location\": \"file:///tmp/maaoy1nc/output.txt\",\r\n        \"basename\": \"output.txt\",\r\n        \"nameroot\": \"output\",\r\n        \"nameext\": \".txt\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n        \"size\": 2,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\nINFO [step head1] completed success\r\nDEBUG [job head1] Removing input staging directory /tmp/o1klvarn\r\nDEBUG [job head1] Removing temporary directory /tmp/0ag_x7fj\r\nINFO [workflow ] starting step head2\r\nDEBUG [job step head2] job input {\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head2/source\": {\r\n        \"location\": \"file:///tmp/maaoy1nc/output.txt\",\r\n        \"basename\": \"output.txt\",\r\n        \"nameroot\": \"output\",\r\n        \"nameext\": \".txt\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n        \"size\": 2,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    },\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head2/nlines\": 1\r\n}\r\nDEBUG [job step head2] evaluated job input to {\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head2/source\": {\r\n        \"location\": \"file:///tmp/maaoy1nc/output.txt\",\r\n        \"basename\": \"output.txt\",\r\n        \"nameroot\": \"output\",\r\n        \"nameext\": \".txt\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n        \"size\": 2,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    },\r\n    \"file:///bwfefs/home/manabu/work/toil/zatsu/headhead-wf.cwl#head2/nlines\": 1\r\n}\r\nINFO [step head2] start\r\nDEBUG [job head2] initializing from file:///bwfefs/home/manabu/work/toil/zatsu/head-container.cwl as part of step head2\r\nDEBUG [job head2] {\r\n    \"source\": {\r\n        \"location\": \"file:///tmp/maaoy1nc/output.txt\",\r\n        \"basename\": \"output.txt\",\r\n        \"nameroot\": \"output\",\r\n        \"nameext\": \".txt\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n        \"size\": 2,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    },\r\n    \"nlines\": 1\r\n}\r\nDEBUG [job head2] path mappings is {\r\n    \"file:///tmp/maaoy1nc/output.txt\": [\r\n        \"/tmp/maaoy1nc/output.txt\",\r\n        \"/var/lib/cwl/stga8be8f3f-962c-470c-8e46-57e7411f5ab2/output.txt\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\nDEBUG [job head2] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ],\r\n        \"datum\": \"head\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            0,\r\n            0\r\n        ],\r\n        \"valueFrom\": \"-n$(inputs.nlines)\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            0,\r\n            1\r\n        ],\r\n        \"valueFrom\": \"$(inputs.source)\"\r\n    }\r\n]\r\nINFO ['singularity', 'pull', '--force', '--name', '/home/manabu/work/toil/singularity_cache//home/manabu/work/toil/singularity_cache/ubuntu:16.04.sif', 'docker://ubuntu:16.04']\r\nWARNING: Authentication token file not found : Only pulls of public images will succeed\r\nINFO:    Starting build...\r\ntime=\"2019-09-04T10:13:28+09:00\" level=warning msg=\"\\\"/run/user/3220\\\" directory set by $XDG_RUNTIME_DIR does not exist. Either create the directory or unset $XDG_RUNTIME_DIR.: stat /run/user/3220: no such file or directory: Trying to pull image in the event that it is a public image.\"\r\nFATAL:   Unable to pull docker://ubuntu:16.04: conveyor failed to get: pinging docker registry returned: Get https://registry-1.docker.io/v2/: dial tcp: address registry-1.docker.io: no suitable address found\r\nDEBUG Singularity error\r\nTraceback (most recent call last):\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/job.py\", line 636, in run\r\n    getdefault(runtimeContext.tmp_outdir_prefix, DEFAULT_TMP_PREFIX)))\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/singularity.py\", line 219, in get_from_requirements\r\n    if not self.get_image(r, pull_image, force_pull):\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/singularity.py\", line 163, in get_image\r\n    check_call(cmd, env=env, stdout=sys.stderr)  # nosec\r\n  File \"/home/manabu/anaconda2/envs/toil/lib/python3.7/subprocess.py\", line 347, in check_call\r\n    raise CalledProcessError(retcode, cmd)\r\nsubprocess.CalledProcessError: Command '['singularity', 'pull', '--force', '--name', '/home/manabu/work/toil/singularity_cache//home/manabu/work/toil/singularity_cache/ubuntu:16.04.sif', 'docker://ubuntu:16.04']' returned non-zero exit status 255.\r\nERROR Workflow or tool uses unsupported feature:\r\nSingularity is required to run this tool: Command '['singularity', 'pull', '--force', '--name', '/home/manabu/work/toil/singularity_cache//home/manabu/work/toil/singularity_cache/ubuntu:16.04.sif', 'docker://ubuntu:16.04']' returned non-zero exit status 255.\r\nTraceback (most recent call last):\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/job.py\", line 636, in run\r\n    getdefault(runtimeContext.tmp_outdir_prefix, DEFAULT_TMP_PREFIX)))\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/singularity.py\", line 219, in get_from_requirements\r\n    if not self.get_image(r, pull_image, force_pull):\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/singularity.py\", line 163, in get_image\r\n    check_call(cmd, env=env, stdout=sys.stderr)  # nosec\r\n  File \"/home/manabu/anaconda2/envs/toil/lib/python3.7/subprocess.py\", line 347, in check_call\r\n    raise CalledProcessError(retcode, cmd)\r\nsubprocess.CalledProcessError: Command '['singularity', 'pull', '--force', '--name', '/home/manabu/work/toil/singularity_cache//home/manabu/work/toil/singularity_cache/ubuntu:16.04.sif', 'docker://ubuntu:16.04']' returned non-zero exit status 255.\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/main.py\", line 830, in main\r\n    logger=_logger)\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/executors.py\", line 46, in __call__\r\n    return self.execute(*args, **kwargs)\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/executors.py\", line 106, in execute\r\n    self.run_jobs(process, job_order_object, logger, runtime_context)\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/executors.py\", line 188, in run_jobs\r\n    job.run(runtime_context)\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/cwltool/job.py\", line 665, in run\r\n    \"%s is required to run this tool: %s\" % (container, Text(err))), err)\r\n  File \"/bwfefs/home/manabu/work/toil/toilgithub/lib/python3.7/site-packages/future/utils/__init__.py\", line 400, in raise_from\r\n    exec(execstr, myglobals, mylocals)\r\n  File \"<string>\", line 1, in <module>\r\ncwltool.errors.UnsupportedRequirement: Singularity is required to run this tool: Command '['singularity', 'pull', '--force', '--name', '/home/manabu/work/toil/singularity_cache//home/manabu/work/toil/singularity_cache/ubuntu:16.04.sif', 'docker://ubuntu:16.04']' returned non-zero exit status 255.\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n\r\nPython 3.7.3 | packaged by conda-forge | (default, Jul  1 2019, 21:52:21)\r\n\r\ncwltool 1.0.20190815141648\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1182", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1182/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1182/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1182/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1182", "id": 487361740, "node_id": "MDU6SXNzdWU0ODczNjE3NDA=", "number": 1182, "title": "Error accessing docker start file under Windows", "user": {"login": "than99", "id": 39557443, "node_id": "MDQ6VXNlcjM5NTU3NDQz", "avatar_url": "https://avatars2.githubusercontent.com/u/39557443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/than99", "html_url": "https://github.com/than99", "followers_url": "https://api.github.com/users/than99/followers", "following_url": "https://api.github.com/users/than99/following{/other_user}", "gists_url": "https://api.github.com/users/than99/gists{/gist_id}", "starred_url": "https://api.github.com/users/than99/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/than99/subscriptions", "organizations_url": "https://api.github.com/users/than99/orgs", "repos_url": "https://api.github.com/users/than99/repos", "events_url": "https://api.github.com/users/than99/events{/privacy}", "received_events_url": "https://api.github.com/users/than99/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-08-30T08:40:29Z", "updated_at": "2019-08-31T11:02:52Z", "closed_at": "2019-08-31T11:02:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\n(cwl) C:\\CWL>cwl-runner 1st-tool.cwl test.yaml\r\n\u001b[30mINFO\u001b[0m C:\\Users\\user\\Anaconda3\\envs\\cwl\\Scripts\\cwl-runner 1.0.20190815141648\r\n\u001b[30mINFO\u001b[0m Resolved '1st-tool.cwl' to 'file:///C:/CWL/1st-tool.cwl'\r\n\u001b[30mWARNING\u001b[0m \u001b[33m\r\nWe are on Microsoft Windows and not all components of this CWL description have a\r\ncontainer specified. This means that these steps will be executed in the default container,\r\nwhich is frolvlad/alpine-bash.\r\n\r\nNote, this could affect portability if this CWL description relies on non-POSIX features\r\nor commands in this container. For best results add the following to your CWL\r\ndescription's hints section:\r\n\r\nhints:\r\n  DockerRequirement:\r\n    dockerPull: frolvlad/alpine-bash\r\n\u001b[0m\r\nINFO [job 1st-tool.cwl] C:\\Users\\user\\AppData\\Local\\Temp\\4ahxulbx$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/C/Users/user/AppData/Local/Temp/4ahxulbx:/rvfrvb:rw \\\r\n    --volume=/C/Users/user/AppData/Local/Temp/ekuzqnhf:/tmp:rw \\\r\n    --workdir=/rvfrvb \\\r\n    --read-only=true \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/rvfrvb \\\r\n    --cidfile=C:\\Users\\user\\AppData\\Local\\Temp\\9el4tl5z\\20190830152952-110282.cid \\\r\n    frolvlad/alpine-bash \\\r\n    echo \\\r\n    'Hello world!'\r\nERROR Exception while running job\r\nTraceback (most recent call last):\r\n  File \"c:\\users\\user\\anaconda3\\envs\\cwl\\lib\\site-packages\\cwltool\\job.py\", line 321, in _execute\r\n    monitor_function=monitor_function\r\n  File \"c:\\users\\user\\anaconda3\\envs\\cwl\\lib\\site-packages\\cwltool\\job.py\", line 785, in _job_popen\r\n    monitor_function(sproc)\r\n  File \"c:\\users\\user\\anaconda3\\envs\\cwl\\lib\\site-packages\\cwltool\\job.py\", line 708, in docker_monitor\r\n    with open(stats_file.name, mode=\"w\") as stats_file_handle:\r\nPermissionError: [Errno 13] Permission denied: 'C:\\\\Users\\\\user\\\\AppData\\\\Local\\\\Temp\\\\0_8ctckh'\r\nWARNING [job 1st-tool.cwl] completed permanentFail\r\n{}\r\nWARNING Final process status is permanentFail\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1180", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1180/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1180/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1180/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1180", "id": 487254150, "node_id": "MDU6SXNzdWU0ODcyNTQxNTA=", "number": 1180, "title": "conda package is way too old -- 2018-02-25 !!", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-08-30T02:25:49Z", "updated_at": "2019-09-27T21:10:29Z", "closed_at": "2019-09-27T21:10:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "- [x] Remove from README?\r\n- [ ] update the package?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1162", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1162/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1162/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1162/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1162", "id": 476231339, "node_id": "MDU6SXNzdWU0NzYyMzEzMzk=", "number": 1162, "title": "should use os.path.join for --tmp-outdir-prefix", "user": {"login": "ionox0", "id": 6385646, "node_id": "MDQ6VXNlcjYzODU2NDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/6385646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ionox0", "html_url": "https://github.com/ionox0", "followers_url": "https://api.github.com/users/ionox0/followers", "following_url": "https://api.github.com/users/ionox0/following{/other_user}", "gists_url": "https://api.github.com/users/ionox0/gists{/gist_id}", "starred_url": "https://api.github.com/users/ionox0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ionox0/subscriptions", "organizations_url": "https://api.github.com/users/ionox0/orgs", "repos_url": "https://api.github.com/users/ionox0/repos", "events_url": "https://api.github.com/users/ionox0/events{/privacy}", "received_events_url": "https://api.github.com/users/ionox0/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-02T15:16:56Z", "updated_at": "2019-08-02T15:33:12Z", "closed_at": "2019-08-02T15:18:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected Behavior\r\nif `--tmp-outdir-prefix` is supplied as `/some/dir`, temporary directories will show up in `/some/dir` and be named as `XXXX`\r\n\r\n## Actual Behavior\r\nif `--tmp-outdir-prefix` is supplied as `/some/dir`, temporary directories will show up in `/some` and be named as `/dirXXXX`\r\n\r\n## Workflow Code\r\n```\r\ncwltool --debug --preserve-entire-environment --tmpdir-prefix `pwd` --tmp-outdir-prefix `pwd` workflow.cwl inputs.yaml\r\n```\r\n\r\n## Full Traceback\r\nNo traceback, just location of tmp dirs\r\n\r\n## Your Environment\r\n* cwltool version: \r\n`cwltool 1.0.20181118133959`\r\n\r\n<img width=\"543\" alt=\"Screen Shot 2019-08-02 at 11 07 16 AM\" src=\"https://user-images.githubusercontent.com/6385646/62379840-beb53c80-b515-11e9-857a-fef83df2207a.png\">\r\n\r\nMy thinking is that there could be somewhere where folder and tmp dir are being combined as strings, without using the `os.path.join()` method.\r\n\r\nIt's also possible that this same behavior occurs with the `--tmpdir-prefix` as well.\r\n\r\nThank you!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1159", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1159/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1159/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1159/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1159", "id": 474211794, "node_id": "MDU6SXNzdWU0NzQyMTE3OTQ=", "number": 1159, "title": "cwltool fails to insert some commandline options", "user": {"login": "tonyyzy", "id": 38984697, "node_id": "MDQ6VXNlcjM4OTg0Njk3", "avatar_url": "https://avatars3.githubusercontent.com/u/38984697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tonyyzy", "html_url": "https://github.com/tonyyzy", "followers_url": "https://api.github.com/users/tonyyzy/followers", "following_url": "https://api.github.com/users/tonyyzy/following{/other_user}", "gists_url": "https://api.github.com/users/tonyyzy/gists{/gist_id}", "starred_url": "https://api.github.com/users/tonyyzy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tonyyzy/subscriptions", "organizations_url": "https://api.github.com/users/tonyyzy/orgs", "repos_url": "https://api.github.com/users/tonyyzy/repos", "events_url": "https://api.github.com/users/tonyyzy/events{/privacy}", "received_events_url": "https://api.github.com/users/tonyyzy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-29T19:14:50Z", "updated_at": "2019-11-13T13:58:56Z", "closed_at": "2019-11-13T13:58:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This issue is version dependent. Versions after `1.0.20190228155703` have this problem, `1.0.20190228155703` is the newest version that does not have this problem.\r\n\r\nThe error occurs on the last line of the log, notice that two entries are empty strings.\r\n\r\n## Expected Behavior\r\n```bash\r\n[job cuffnorm] /private/tmp/docker_tmp4o6npwww$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/private/tmp/docker_tmp4o6npwww:/vUfJCz:rw \\\r\n    --volume=/private/tmp/docker_tmpclyt754y:/tmp:rw \\\r\n    --volume=/private/tmp/docker_tmpbghh01eg/test1/abundances.cxb:/var/lib/cwl/stg67bfa63e-0093-4cc9-a686-8260200c16ee/abundances.cxb:ro \\\r\n    --volume=/private/tmp/docker_tmpkasy3g6z/test2/abundances.cxb:/var/lib/cwl/stgedc9eeb6-086e-415d-8b83-21210cf9db17/abundances.cxb:ro \\\r\n    --volume=/private/tmp/docker_tmp9xuwr51r/test3/abundances.cxb:/var/lib/cwl/stgd161a051-7e3d-4fda-b6d2-2ad8c93d349a/abundances.cxb:ro \\\r\n    --volume=/private/tmp/docker_tmp6g_t656q/test4/abundances.cxb:/var/lib/cwl/stgc630ead7-92ac-4bee-84de-7225d0adb1d3/abundances.cxb:ro \\\r\n    --volume=/Users/tony/cwl/scripts/cuffnorm_table.py:/var/lib/cwl/stgd5cbe1ac-7bd0-422a-a67c-eb3348ac4b35/cuffnorm_table.py:ro \\\r\n    --volume=/private/tmp/docker_tmp8z8mn7xc/cuffmerge/merged.gtf:/var/lib/cwl/stg4b289632-d47c-4fe5-836b-4f029972fb52/merged.gtf:ro \\\r\n    --volume=/Users/tony/cwl/tests/metadata.csv:/var/lib/cwl/stga3260768-9eed-4cdc-a2f2-1f1416616916/metadata.csv:ro \\\r\n    --workdir=/vUfJCz \\\r\n    --read-only=true \\\r\n    --user=506:20 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/vUfJCz \\\r\n    --cidfile=/private/tmp/docker_tmprft0s39r/20190729195524-274513.cid \\\r\n    filipejesus/cufflinks:2.2.1 \\\r\n    /bin/sh \\\r\n    -c \\\r\n    'mkdir' 'cuffnorm' && cuffnorm '-o' 'cuffnorm' '-p' '1' '/var/lib/cwl/stg4b289632-d47c-4fe5-836b-4f029972fb52/merged.gtf' '/var/lib/cwl/stg67bfa63e-0093-4cc9-a686-8260200c16ee/abundances.cxb,/var/lib/cwl/stgedc9eeb6-086e-415d-8b83-21210cf9db17/abundances.cxb' '/var/lib/cwl/stgd161a051-7e3d-4fda-b6d2-2ad8c93d349a/abundances.cxb,/var/lib/cwl/stgc630ead7-92ac-4bee-84de-7225d0adb1d3/abundances.cxb' && python '/var/lib/cwl/stgd5cbe1ac-7bd0-422a-a67c-eb3348ac4b35/cuffnorm_table.py' '/var/lib/cwl/stga3260768-9eed-4cdc-a2f2-1f1416616916/metadata.csv' 'cuffnorm/genes.count_table' 'cuffnorm/genes.attr_table' 'untreated,treated'\r\n```\r\n\r\n## Actual Behavior\r\n```bash\r\nINFO [job cuffnorm] /private/tmp/docker_tmpzf_ml5a9$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/private/tmp/docker_tmpzf_ml5a9:/nTcKQN:rw \\\r\n    --volume=/private/tmp/docker_tmpxpo49xf_:/tmp:rw \\\r\n    --volume=/private/tmp/docker_tmp4aw0ke_i/test1/abundances.cxb:/var/lib/cwl/stgf4b27480-847f-4fd5-88ae-5531b8ee702e/abundances.cxb:ro \\\r\n    --volume=/private/tmp/docker_tmp2kaayxdw/test2/abundances.cxb:/var/lib/cwl/stg3f846a3f-01e2-4779-bdb9-6257fbe174e4/abundances.cxb:ro \\\r\n    --volume=/private/tmp/docker_tmpyv_jfs8s/test3/abundances.cxb:/var/lib/cwl/stg1c3044a5-f36f-433b-9d3c-facc4e2a6cc2/abundances.cxb:ro \\\r\n    --volume=/private/tmp/docker_tmpfm3f6us6/test4/abundances.cxb:/var/lib/cwl/stg142797c9-e628-4f57-b695-e516cb7d46ba/abundances.cxb:ro \\\r\n    --volume=/Users/tony/cwl/scripts/cuffnorm_table.py:/var/lib/cwl/stg90f457c3-5c2e-4b27-b2fa-e0cfae2ee367/cuffnorm_table.py:ro \\\r\n    --volume=/private/tmp/docker_tmphezv3t35/cuffmerge/merged.gtf:/var/lib/cwl/stg5d3a04e6-7556-4a24-a5f6-bc35edbae382/merged.gtf:ro \\\r\n    --volume=/Users/tony/cwl/tests/metadata.csv:/var/lib/cwl/stg88fed3d1-b39c-46d3-84d9-747751a424c5/metadata.csv:ro \\\r\n    --workdir=/nTcKQN \\\r\n    --read-only=true \\\r\n    --user=506:20 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/nTcKQN \\\r\n    --cidfile=/private/tmp/docker_tmp1ylpj5jj/20190729194823-205467.cid \\\r\n    filipejesus/cufflinks:2.2.1 \\\r\n    /bin/sh \\\r\n    -c \\\r\n    'mkdir' 'cuffnorm' && cuffnorm '-o' 'cuffnorm' '-p' '1' '/var/lib/cwl/stg5d3a04e6-7556-4a24-a5f6-bc35edbae382/merged.gtf' '' '' && python '/var/lib/cwl/stg90f457c3-5c2e-4b27-b2fa-e0cfae2ee367/cuffnorm_table.py' '/var/lib/cwl/stg88fed3d1-b39c-46d3-84d9-747751a424c5/metadata.csv' 'cuffnorm/genes.count_table' 'cuffnorm/genes.attr_table' 'untreated,treated'\r\n\r\n```\r\n\r\n## Workflow Code\r\nThe `cuffnorm` tool's script is shown here https://github.com/rawgene/cwl/blob/master/tools/cuffnorm.cwl\r\n\r\nThe easiest way to reproduce the error would be\r\n```bash\r\ngit clone https://github.com/rawgene/cwl\r\ncwltool ./cwl/workflows/hisat2_cufflink_cuffmerge_cuffquant_ballgown.cuffdiffs.cwl ./cwl/workflows/hisat2_cufflink_cuffmerge_cuffquant_ballgown.cuffdiffs.yml \r\n```\r\nAlternatively, if you have `pytest` and `cwlref-runner` installed\r\n```bash\r\npytest -s ./cwl/tests/test_workflow3_docker.py \r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20190228155703, 1.0.20190621234233\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1156", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1156/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1156/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1156/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1156", "id": 472936601, "node_id": "MDU6SXNzdWU0NzI5MzY2MDE=", "number": 1156, "title": "Do not capture stdout", "user": {"login": "jjkoehorst", "id": 4471699, "node_id": "MDQ6VXNlcjQ0NzE2OTk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4471699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jjkoehorst", "html_url": "https://github.com/jjkoehorst", "followers_url": "https://api.github.com/users/jjkoehorst/followers", "following_url": "https://api.github.com/users/jjkoehorst/following{/other_user}", "gists_url": "https://api.github.com/users/jjkoehorst/gists{/gist_id}", "starred_url": "https://api.github.com/users/jjkoehorst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jjkoehorst/subscriptions", "organizations_url": "https://api.github.com/users/jjkoehorst/orgs", "repos_url": "https://api.github.com/users/jjkoehorst/repos", "events_url": "https://api.github.com/users/jjkoehorst/events{/privacy}", "received_events_url": "https://api.github.com/users/jjkoehorst/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-25T15:38:15Z", "updated_at": "2019-07-25T16:17:39Z", "closed_at": "2019-07-25T16:17:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "This might be a strange request but I am wondering how to prevent CWL to automatically capture the stdout and stderr since I am trying to implement CWL in a running system which also requires the stdout and stderr information.\r\n\r\nOr if cwl fails that it will print the log files to the screens.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1155", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1155/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1155/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1155/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1155", "id": 470618082, "node_id": "MDU6SXNzdWU0NzA2MTgwODI=", "number": 1155, "title": "Replace galaxy-lib requirement with galaxy-tool-util", "user": {"login": "nsoranzo", "id": 4924623, "node_id": "MDQ6VXNlcjQ5MjQ2MjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/4924623?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsoranzo", "html_url": "https://github.com/nsoranzo", "followers_url": "https://api.github.com/users/nsoranzo/followers", "following_url": "https://api.github.com/users/nsoranzo/following{/other_user}", "gists_url": "https://api.github.com/users/nsoranzo/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsoranzo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsoranzo/subscriptions", "organizations_url": "https://api.github.com/users/nsoranzo/orgs", "repos_url": "https://api.github.com/users/nsoranzo/repos", "events_url": "https://api.github.com/users/nsoranzo/events{/privacy}", "received_events_url": "https://api.github.com/users/nsoranzo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-20T01:07:44Z", "updated_at": "2019-12-25T19:21:56Z", "closed_at": "2019-12-25T19:21:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm working on Planemo to replace its dependency on galaxy-lib (which will be basically deprecated with Galaxy release 19.09) with [galaxy-tool-util](https://pypi.org/project/galaxy-tool-util/). Unfortunately CWL support in Planemo via cwltool would break unless also cwltool moves to galaxy-tool-util.\r\n\r\nI can do the necessary changes in cwltool when I'm back from holidays, in the mean time I wanted to check that's fine with you all.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1149", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1149/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1149/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1149/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1149", "id": 466384106, "node_id": "MDU6SXNzdWU0NjYzODQxMDY=", "number": 1149, "title": "Can't load directory with files having $ in filename", "user": {"login": "hubentu", "id": 9856666, "node_id": "MDQ6VXNlcjk4NTY2NjY=", "avatar_url": "https://avatars1.githubusercontent.com/u/9856666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hubentu", "html_url": "https://github.com/hubentu", "followers_url": "https://api.github.com/users/hubentu/followers", "following_url": "https://api.github.com/users/hubentu/following{/other_user}", "gists_url": "https://api.github.com/users/hubentu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hubentu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hubentu/subscriptions", "organizations_url": "https://api.github.com/users/hubentu/orgs", "repos_url": "https://api.github.com/users/hubentu/repos", "events_url": "https://api.github.com/users/hubentu/events{/privacy}", "received_events_url": "https://api.github.com/users/hubentu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-10T15:43:18Z", "updated_at": "2019-07-10T16:00:19Z", "closed_at": "2019-07-10T16:00:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Error happened when cwltool load directory with files that have \"$\" in filenames.\r\n\r\n## Expected Behavior\r\nTo load directory with any files.\r\n\r\n## Actual Behavior\r\nIf there is a file with \"$\" filename in a directory, the directory could not be loaded.\r\nFor example, we define a \"ls\" tool to list a directory.\r\n```\r\n$mkdir test\r\n$touch test/1\\$2\r\n$ls test\r\n1$2\r\n```\r\n\r\n\r\n## Workflow Code\r\nls.cwl\r\n```\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nbaseCommand: ls\r\ninputs:\r\n  dir:\r\n    type: Directory\r\n    inputBinding:\r\n      separate: true\r\noutputs:\r\n  output:\r\n    type: stdout\r\n```\r\nls.yml\r\n```\r\ndir:\r\n  class: Directory\r\n  path: /home/qhu/tmp/test\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\n/home/qhu/.local/bin/cwltool 1.0.20180721142728\r\nResolved 'ls.cwl' to 'file:///home/qhu/tmp/ls.cwl'\r\n[job ls.cwl] initializing from file:///home/qhu/tmp/ls.cwl\r\n[job ls.cwl] {\r\n    \"dir\": {\r\n        \"class\": \"Directory\", \r\n        \"location\": \"file:///home/qhu/tmp/test\", \r\n        \"basename\": \"test\"\r\n    }\r\n}\r\nWorkflow error:\r\nInvalid filename: '1$2' contains illegal characters\r\nTraceback (most recent call last):\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/main.py\", line 606, in main\r\n    logger=_logger)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/executors.py\", line 39, in __call__\r\n    return self.execute(*args, **kwargs)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/executors.py\", line 89, in execute\r\n    self.run_jobs(process, job_order_object, logger, runtime_context)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/executors.py\", line 141, in run_jobs\r\n    for job in jobiter:\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 402, in job\r\n    visit_class([builder.files, builder.bindings], (\"File\", \"Directory\"), _check_adjust)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/utils.py\", line 233, in visit_class\r\n    visit_class(d, cls, op)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/utils.py\", line 233, in visit_class\r\n    visit_class(d, cls, op)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/utils.py\", line 230, in visit_class\r\n    visit_class(rec[d], cls, op)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/utils.py\", line 233, in visit_class\r\n    visit_class(d, cls, op)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/utils.py\", line 228, in visit_class\r\n    op(rec)\r\n  File \"/home/qhu/.local/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 207, in check_adjust\r\n    file_o[\"basename\"]))\r\nWorkflowException: Invalid filename: '1$2' contains illegal characters\r\n\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n1.0.20180721142728", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1146", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1146/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1146/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1146/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1146", "id": 463589982, "node_id": "MDU6SXNzdWU0NjM1ODk5ODI=", "number": 1146, "title": "for-in statement for arrays in JavascriptExpression does not work", "user": {"login": "tom-tan", "id": 4450141, "node_id": "MDQ6VXNlcjQ0NTAxNDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/4450141?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tom-tan", "html_url": "https://github.com/tom-tan", "followers_url": "https://api.github.com/users/tom-tan/followers", "following_url": "https://api.github.com/users/tom-tan/following{/other_user}", "gists_url": "https://api.github.com/users/tom-tan/gists{/gist_id}", "starred_url": "https://api.github.com/users/tom-tan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tom-tan/subscriptions", "organizations_url": "https://api.github.com/users/tom-tan/orgs", "repos_url": "https://api.github.com/users/tom-tan/repos", "events_url": "https://api.github.com/users/tom-tan/events{/privacy}", "received_events_url": "https://api.github.com/users/tom-tan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-03T07:27:59Z", "updated_at": "2019-07-04T04:09:02Z", "closed_at": "2019-07-04T04:09:02Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## How to reproduce\r\n`listing.cwl` is an expression tool that takes an array of strings and I expect it will return the same array of strings.\r\n\r\n```console\r\n$ ls\r\nlisting.cwl  listing.yml\r\n$ cat listing.yml\r\nfile_names:\r\n  - foo\r\n  - bar\r\n$ cwltool --debug listing.cwl listing.yml\r\n```\r\n\r\n## Expected Behavior\r\n\r\n```console\r\n$ cwltool --debug listing.cwl listing.yml\r\n...\r\n{\r\n    \"arr\": [\r\n        \"foo\",\r\n        \"bar\"\r\n    ]\r\n}\r\n```\r\n\r\n## Actual Behavior\r\nIt returns an array of strings, but each element is a string that represents its index rather than its original element.\r\n\r\n```console\r\n$ cwltool --debug listing.cwl listing.yml\r\nINFO /Users/tom-tan/.pyenv/versions/3.6.5/bin/cwltool 1.0.20190621234233\r\nINFO Resolved 'listing.cwl' to 'file:///Users/tom-tan/issue/listing.cwl'\r\n{\r\n    \"arr\": [\r\n        \"0\",\r\n        \"1\"\r\n    ]\r\n}\r\nINFO Final process status is success\r\n```\r\n\r\n## Workflow Code\r\n- listing.cwl\r\n```cwl\r\n#!/usr/bin/env cwl-runner\r\ncwlVersion: v1.0\r\nclass: ExpressionTool\r\nrequirements:\r\n  InlineJavascriptRequirement: {}\r\ninputs:\r\n  file_names: string[]\r\nexpression: |\r\n  ${\r\n    var ret = [];\r\n    for(var n in inputs.file_names) {\r\n      ret.push(n);\r\n    }\r\n    return {\r\n      arr: ret,\r\n    };\r\n  }\r\noutputs:\r\n  files: string[]\r\n```\r\n\r\n- listing.yml\r\n```yaml\r\nfile_names:\r\n  - foo\r\n  - bar\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\nPaste the full traceback in case there is an exception\r\nRun the workflow with ``--debug`` flag for more verbose logging \r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n```console\r\n$ cwltool --version\r\n/Users/tom-tan/.pyenv/versions/3.6.5/bin/cwltool 1.0.20190621234233\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1139", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1139/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1139/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1139/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1139", "id": 458740044, "node_id": "MDU6SXNzdWU0NTg3NDAwNDQ=", "number": 1139, "title": "Default networking for docker run changed?", "user": {"login": "Stikus", "id": 41360525, "node_id": "MDQ6VXNlcjQxMzYwNTI1", "avatar_url": "https://avatars2.githubusercontent.com/u/41360525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Stikus", "html_url": "https://github.com/Stikus", "followers_url": "https://api.github.com/users/Stikus/followers", "following_url": "https://api.github.com/users/Stikus/following{/other_user}", "gists_url": "https://api.github.com/users/Stikus/gists{/gist_id}", "starred_url": "https://api.github.com/users/Stikus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Stikus/subscriptions", "organizations_url": "https://api.github.com/users/Stikus/orgs", "repos_url": "https://api.github.com/users/Stikus/repos", "events_url": "https://api.github.com/users/Stikus/events{/privacy}", "received_events_url": "https://api.github.com/users/Stikus/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2019-06-20T15:55:34Z", "updated_at": "2019-06-22T06:50:10Z", "closed_at": "2019-06-22T06:50:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello.\r\nToday I updated cwltool on my machine from cwltool-1.0.20190228155703 to latest cwltool-1.0.20190618201008.\r\nAfter this update all my pipelines became broken.\r\nAs I discovered from starter log - default options for docker run changed.\r\ncwltool-1.0.20190228155703:\r\n```\r\n$ cwltool --outdir /home/bio/test vep.cwl_schema.yml vep.val_test.yml\r\n[job vep.cwl_schema.yml] /tmp/uk7ve30p$ docker \\                                                                            \r\n    run \\                                                                                                                   \r\n    -i \\                                                                                                                    \r\n    --volume=/tmp/uk7ve30p:/JlOrjE:rw \\                                                                                     \r\n    --volume=/tmp/omihujk3:/tmp:rw \\                                                                                        \r\n    --volume=/home/bio/REPOs/varscan.all.all.hc.fp-filtered-D3.Somatic.vcf:/var/lib/cwl/stga0d0fe86-05d0-4a3f-a971-8b41d1192227/varscan.all.all.hc.fp-filtered-D3.Somatic.vcf:ro \\\r\n    --workdir=/JlOrjE \\                                                                                                     \r\n    --read-only=true \\                                                                                                      \r\n    --user=1000:1000 \\                                                                                                      \r\n    --rm \\                                                                                                                  \r\n    --env=TMPDIR=/tmp \\                                                                                                     \r\n    --env=HOME=/JlOrjE \\                                                                                                    \r\n    --cidfile=/tmp/_lle2che/20190620182526-906933.cid \\                                                                     \r\n    nexus.cspmz.ru:8443/vep:v0.3.13 \\                                                                                       \r\n    --sample-name \\                                                                                                         \r\n    E07002 \\                                                                                                                \r\n    --genome-build \\                                                                                                        \r\n    GRCh38.d1.vd1 \\                                                                                                         \r\n    --opts-for-neo \\                                                                                                        \r\n    true \\                                                                                                                  \r\n    --opts-for-maf \\                                                                                                        \r\n    true \\                                                                                                                  \r\n    --extra-opts \\                                                                                                          \r\n    '' \\                                                                                                                    \r\n    --output-dir \\                                                                                                          \r\n    out_workdir \\                                                                                                           \r\n    --output-gz \\                                                                                                           \r\n    E07002.vep_logs.tar.gz \\                                                                                                \r\n    --output-vcf \\                                                                                                          \r\n    E07002.annot-vep.vcf \\                                                                                                  \r\n    /var/lib/cwl/stga0d0fe86-05d0-4a3f-a971-8b41d1192227/varscan.all.all.hc.fp-filtered-D3.Somatic.vcf\r\n```\r\n\r\ncwltool-1.0.20190618201008:\r\n```\r\n$ cwltool --outdir /home/bio/test vep.cwl_schema.yml vep.val_test.yml\r\n[job vep] /tmp/5gf7pbvv$ docker \\                                                                                           \r\n    run \\                                                                                                                   \r\n    -i \\                                                                                                                    \r\n    --volume=/tmp/5gf7pbvv:/CJnsMo:rw \\                                                                                     \r\n    --volume=/tmp/ir3qpfrr:/tmp:rw \\                                                                                        \r\n    --volume=/home/bio/REPOs/varscan.all.all.hc.fp-filtered-D3.Somatic.vcf:/var/lib/cwl/stg7665d317-d0e4-4fed-ad18-d1caa7c96c11/varscan.all.all.hc.fp-filtered-D3.Somatic.vcf:ro \\                                                                      \r\n    --workdir=/CJnsMo \\                                                                                                     \r\n    --read-only=true \\                                                                                                      \r\n    --net=none \\                                                                                                            \r\n    --user=1000:1000 \\                                                                                                      \r\n    --rm \\                                                                                                                  \r\n    --env=TMPDIR=/tmp \\                                                                                                     \r\n    --env=HOME=/CJnsMo \\                                                                                                    \r\n    --cidfile=/tmp/s5iqmorx/20190620183825-019022.cid \\                                                                     \r\n    nexus.cspmz.ru:8443/vep:v0.3.13 \\                                                                                       \r\n    --sample-name \\                                                                                                         \r\n    E07002 \\                                                                                                                \r\n    --genome-build \\                                                                                                        \r\n    GRCh38.d1.vd1 \\                                                                                                         \r\n    --opts-for-neo \\                                                                                                        \r\n    true \\                                                                                                                  \r\n    --opts-for-maf \\                                                                                                        \r\n    true \\                                                                                                                  \r\n    --extra-opts \\                                                                                                          \r\n    '' \\                                                                                                                    \r\n    --output-dir \\                                                                                                          \r\n    out_workdir \\                                                                                                           \r\n    --output-gz \\                                                                                                           \r\n    E07002.vep_logs.tar.gz \\                                                                                                \r\n    --output-vcf \\                                                                                                          \r\n    E07002.annot-vep.vcf \\                                                                                                  \r\n    /var/lib/cwl/stg7665d317-d0e4-4fed-ad18-d1caa7c96c11/varscan.all.all.hc.fp-filtered-D3.Somatic.vcf\r\n```\r\nAs you can see - network switched to 'none'.\r\nIs this intended? And if yes - can you help me to fix my settings to reproduce old behaviour?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1134", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1134/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1134/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1134/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1134", "id": 457041902, "node_id": "MDU6SXNzdWU0NTcwNDE5MDI=", "number": 1134, "title": "Unhelpful error message when a parameter name is different in job file and in main workflow file.", "user": {"login": "jarnolaitinen", "id": 16347222, "node_id": "MDQ6VXNlcjE2MzQ3MjIy", "avatar_url": "https://avatars0.githubusercontent.com/u/16347222?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jarnolaitinen", "html_url": "https://github.com/jarnolaitinen", "followers_url": "https://api.github.com/users/jarnolaitinen/followers", "following_url": "https://api.github.com/users/jarnolaitinen/following{/other_user}", "gists_url": "https://api.github.com/users/jarnolaitinen/gists{/gist_id}", "starred_url": "https://api.github.com/users/jarnolaitinen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jarnolaitinen/subscriptions", "organizations_url": "https://api.github.com/users/jarnolaitinen/orgs", "repos_url": "https://api.github.com/users/jarnolaitinen/repos", "events_url": "https://api.github.com/users/jarnolaitinen/events{/privacy}", "received_events_url": "https://api.github.com/users/jarnolaitinen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-06-17T16:59:54Z", "updated_at": "2019-06-19T09:38:34Z", "closed_at": "2019-06-19T09:38:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nPlease give a clear error which row causes problem and what is the problem.\r\nNow a typo in any output field paramater of any steps refers to the main workflow file so finding the place is hard. \r\n\r\n## Actual Behavior\r\nERROR I'm sorry, I couldn't load this CWL file, try again with --debug for more information.\r\n**The error was: unhashable type: 'CommentedMap'**\r\n\r\n## Workflow Code\r\nAny working code, where the  parameter name is mismatching between the job file and the  name of the parameter  in the main workflow file. \r\n\r\n## Full Traceback\r\n(venv) [jarno@jlcwl WesTest]$ cwltool --debug workflow.cwl workflow.yml\r\nINFO /home/jarno/ve/venv/bin/cwltool 1.0.20190607183319\r\nINFO Resolved 'workflow.cwl' to 'file:///home/jarno/WesTest/workflow.cwl'\r\nERROR I'm sorry, I couldn't load this CWL file.\r\nThe error was:\r\nTraceback (most recent call last):\r\n  File \"/home/jarno/ve/venv/lib/python2.7/site-packages/cwltool/main.py\", line 6                                                           83, in main\r\n    tool = make_tool(uri, loadingContext)\r\n  File \"/home/jarno/ve/venv/lib/python2.7/site-packages/cwltool/load_tool.py\", l                                                           ine 352, in make_tool\r\n    tool = loadingContext.construct_tool_object(processobj, loadingContext)\r\n  File \"/home/jarno/ve/venv/lib/python2.7/site-packages/cwltool/workflow.py\", li                                                           ne 55, in default_make_tool\r\n    return Workflow(toolpath_object, loadingContext)\r\n  File \"/home/jarno/ve/venv/lib/python2.7/site-packages/cwltool/workflow.py\", li                                                           ne 536, in __init__\r\n    loadingContext.prov_obj))\r\n  File \"/home/jarno/ve/venv/lib/python2.7/site-packages/cwltool/workflow.py\", li                                                           ne 570, in make_workflow_step\r\n    return WorkflowStep(toolpath_object, pos, loadingContext, parentworkflowProv                                                           )\r\n  File \"/home/jarno/ve/venv/lib/python2.7/site-packages/cwltool/workflow.py\", li                                                           ne 679, in __init__\r\n    + \"\\n\" + SourceLine(self.embedded_tool.tool, \"outputs\").makeError(\r\n  File \"/home/jarno/ve/venv/lib/python2.7/site-packages/cwltool/process.py\", lin                                                           e 198, in shortname\r\n    d = urllib.parse.urlparse(inputid)\r\n  File \"/usr/lib64/python2.7/urlparse.py\", line 142, in urlparse\r\n    tuple = urlsplit(url, scheme, allow_fragments)\r\n  File \"/usr/lib64/python2.7/urlparse.py\", line 190, in urlsplit\r\n    cached = _parse_cache.get(key, None)\r\nTypeError: unhashable type: 'CommentedMap'\r\n\r\n\r\n## Your Environment\r\ncwltool 1.0.20190607183319", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1129", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1129/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1129/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1129/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1129", "id": 453170620, "node_id": "MDU6SXNzdWU0NTMxNzA2MjA=", "number": 1129, "title": "packed CommandLineTool initialworkdirrequirement-docker-out.cwl fails", "user": {"login": "wgerlach", "id": 835536, "node_id": "MDQ6VXNlcjgzNTUzNg==", "avatar_url": "https://avatars3.githubusercontent.com/u/835536?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wgerlach", "html_url": "https://github.com/wgerlach", "followers_url": "https://api.github.com/users/wgerlach/followers", "following_url": "https://api.github.com/users/wgerlach/following{/other_user}", "gists_url": "https://api.github.com/users/wgerlach/gists{/gist_id}", "starred_url": "https://api.github.com/users/wgerlach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wgerlach/subscriptions", "organizations_url": "https://api.github.com/users/wgerlach/orgs", "repos_url": "https://api.github.com/users/wgerlach/repos", "events_url": "https://api.github.com/users/wgerlach/events{/privacy}", "received_events_url": "https://api.github.com/users/wgerlach/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-06-06T18:14:11Z", "updated_at": "2019-06-21T18:10:04Z", "closed_at": "2019-06-21T18:10:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nThis compliance test (common-workflow-language/v1.0 , test \"Test output of InitialWorkDir\") works:\r\n```\r\ncwltool v1.0/initialworkdirrequirement-docker-out.cwl v1.0/initialworkdirrequirement-docker-out-job.json\r\n```\r\n But the packed version fails:\r\n```\r\ncwltool --pack v1.0/initialworkdirrequirement-docker-out.cwl > v1.0/initialworkdirrequirement-docker-out.cwl.packed\r\n\r\ncwltool v1.0/initialworkdirrequirement-docker-out.cwl.packed v1.0/initialworkdirrequirement-docker-out-job.json\r\n\r\n```\r\n\r\n\r\n## Expected Behavior\r\nThe packed version of the CommandLineTool should executed the same way as the unpacked version.\r\n## Actual Behavior\r\ncwltool stops with error message:\r\n```\r\nv1.0/initialworkdirrequirement-docker-out.cwl.packed:28:13: string indices must be integers\r\n```\r\n\r\n## Workflow Code\r\n```\r\n{\r\n    \"requirements\": [\r\n        {\r\n            \"class\": \"DockerRequirement\",\r\n            \"dockerPull\": \"debian:stretch-slim\"\r\n        },\r\n        {\r\n            \"class\": \"InitialWorkDirRequirement\",\r\n            \"listing\": [\r\n                \"$(inputs.INPUT)\"\r\n            ]\r\n        }\r\n    ],\r\n    \"class\": \"CommandLineTool\",\r\n    \"inputs\": [\r\n        {\r\n            \"id\": \"#main/INPUT\",\r\n            \"type\": \"File\"\r\n        }\r\n    ],\r\n    \"outputs\": [\r\n        {\r\n            \"id\": \"#main/OUTPUT\",\r\n            \"type\": \"File\",\r\n            \"outputBinding\": {\r\n                \"glob\": \"$(inputs.INPUT.basename)\"\r\n            },\r\n            \"secondaryFiles\": [\r\n                \".fai\"\r\n            ]\r\n        }\r\n    ],\r\n    \"arguments\": [\r\n        {\r\n            \"valueFrom\": \"$(inputs.INPUT.basename).fai\",\r\n            \"position\": 0\r\n        }\r\n    ],\r\n    \"baseCommand\": [\r\n        \"touch\"\r\n    ],\r\n    \"id\": \"#main\",\r\n    \"cwlVersion\": \"v1.0\"\r\n}\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\nINFO /usr/local/bin/cwltool 1.0.20190603140227\r\nINFO Resolved 'v1.0/initialworkdirrequirement-docker-out.cwl.packed' to 'file:///Users/wolfganggerlach/git/common-workflow-language/v1.0/v1.0/initialworkdirrequirement-docker-out.cwl.packed'\r\nINFO [job main] /private/tmp/docker_tmp1q_y9xba$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/private/tmp/docker_tmp1q_y9xba:/eHiwBX:rw \\\r\n    --volume=/private/tmp/docker_tmpdehv7m3k:/tmp:rw \\\r\n    --volume=/Users/wolfganggerlach/git/common-workflow-language/v1.0/v1.0/ref.fasta:/eHiwBX/ref.fasta:ro \\\r\n    --workdir=/eHiwBX \\\r\n    --read-only=true \\\r\n    --net=none \\\r\n    --user=501:20 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/eHiwBX \\\r\n    --cidfile=/private/tmp/docker_tmpytiu0q1a/20190606130555-148571.cid \\\r\n    debian:stretch-slim \\\r\n    touch \\\r\n    ref.fasta.fai\r\nINFO [job main] Max memory used: 0MiB\r\nERROR [job main] Job error:\r\nError collecting output for parameter 'OUTPUT':\r\nv1.0/initialworkdirrequirement-docker-out.cwl.packed:28:13: string indices must be integers\r\nWARNING [job main] completed permanentFail\r\n{}\r\nWARNING Final process status is permanentFail\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20190603140227\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1128", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1128/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1128/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1128/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1128", "id": 452648478, "node_id": "MDU6SXNzdWU0NTI2NDg0Nzg=", "number": 1128, "title": "error message: Type property \"stdout\" not a valid Avro schema", "user": {"login": "wgerlach", "id": 835536, "node_id": "MDQ6VXNlcjgzNTUzNg==", "avatar_url": "https://avatars3.githubusercontent.com/u/835536?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wgerlach", "html_url": "https://github.com/wgerlach", "followers_url": "https://api.github.com/users/wgerlach/followers", "following_url": "https://api.github.com/users/wgerlach/following{/other_user}", "gists_url": "https://api.github.com/users/wgerlach/gists{/gist_id}", "starred_url": "https://api.github.com/users/wgerlach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wgerlach/subscriptions", "organizations_url": "https://api.github.com/users/wgerlach/orgs", "repos_url": "https://api.github.com/users/wgerlach/repos", "events_url": "https://api.github.com/users/wgerlach/events{/privacy}", "received_events_url": "https://api.github.com/users/wgerlach/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-06-05T18:21:33Z", "updated_at": "2019-06-21T17:46:24Z", "closed_at": "2019-06-21T17:46:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am not sure if that is my mistake or a bug in the cwltool.\r\n\r\n## Expected Behavior\r\nTell us what should happen\r\nCommandLineTool should run without error message.\r\n\r\n## Actual Behavior\r\nGot this error message:\r\n```text\r\nERROR Tool definition failed validation:\r\ncwl_tool.yaml:4:1: Type property \"stdout\" not a valid Avro schema: Could not make an Avro Schema object from stdout.\r\n```\r\n\r\n## Workflow Code\r\n```\r\nclass: CommandLineTool\r\nid: '#tool'\r\ninputs: []\r\noutputs:\r\n- id: out\r\n  type: stdout\r\nhints:\r\n- class: ResourceRequirement\r\n  ramMin: 8\r\nrequirements:\r\n- class: InlineJavascriptRequirement\r\n  expressionLib:\r\n  - function foo() { return 2; }\r\ncwlVersion: v1.0\r\narguments:\r\n- valueFrom: echo\r\n- valueFrom: $(foo())\r\nstdout: whatever.txt\r\n\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\ncwltool --debug  --validate cwl_tool.yaml \r\nINFO /usr/bin/cwltool 1.0.20190603140227\r\nINFO Resolved 'cwl_tool.yaml' to 'file:///Users/wolfganggerlach/awe_data/work/e2/2d/d3/e22dd330-07bc-4a5a-96a6-28c3807a02c7__main_tool_0/cwl_tool.yaml'\r\nERROR Tool definition failed validation:\r\ncwl_tool.yaml:4:1: Type property \"stdout\" not a valid Avro schema: Could not make an Avro Schema object from stdout.\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/site-packages/schema_salad/avro/schema.py\", line 304, in __init__\r\n    type_schema = make_avsc_object(cast(Dict[Text, Text], atype), names)\r\n  File \"/usr/lib/python3.6/site-packages/schema_salad/avro/schema.py\", line 573, in make_avsc_object\r\n    raise SchemaParseException(fail_msg)\r\nschema_salad.avro.schema.SchemaParseException: Could not make an Avro Schema object from stdout.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/site-packages/cwltool/process.py\", line 547, in __init__\r\n    schema.convert_to_dict(self.outputs_record_schema), self.names)\r\n  File \"/usr/lib/python3.6/site-packages/schema_salad/avro/schema.py\", line 556, in make_avsc_object\r\n    return RecordSchema(name, namespace, fields, names, atype, doc, other_props)\r\n  File \"/usr/lib/python3.6/site-packages/schema_salad/avro/schema.py\", line 501, in __init__\r\n    field_objects = RecordSchema.make_field_objects(fields, names)\r\n  File \"/usr/lib/python3.6/site-packages/schema_salad/avro/schema.py\", line 467, in make_field_objects\r\n    other_props)\r\n  File \"/usr/lib/python3.6/site-packages/schema_salad/avro/schema.py\", line 308, in __init__\r\n    % (atype, e))\r\nschema_salad.avro.schema.SchemaParseException: Type property \"stdout\" not a valid Avro schema: Could not make an Avro Schema object from stdout.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/site-packages/cwltool/main.py\", line 682, in main\r\n    tool = make_tool(uri, loadingContext)\r\n  File \"/usr/lib/python3.6/site-packages/cwltool/load_tool.py\", line 354, in make_tool\r\n    tool = loadingContext.construct_tool_object(processobj, loadingContext)\r\n  File \"/usr/lib/python3.6/site-packages/cwltool/workflow.py\", line 51, in default_make_tool\r\n    return command_line_tool.CommandLineTool(toolpath_object, loadingContext)\r\n  File \"/usr/lib/python3.6/site-packages/cwltool/command_line_tool.py\", line 246, in __init__\r\n    super(CommandLineTool, self).__init__(toolpath_object, loadingContext)\r\n  File \"/usr/lib/python3.6/site-packages/cwltool/process.py\", line 547, in __init__\r\n    schema.convert_to_dict(self.outputs_record_schema), self.names)\r\n  File \"/usr/lib/python3.6/site-packages/schema_salad/sourceline.py\", line 249, in __exit__\r\n    raise self.makeError(six.text_type(exc_value))\r\nschema_salad.validate.ValidationException: cwl_tool.yaml:4:1: Type property \"stdout\" not a valid Avro schema: Could not make an Avro Schema object from stdout.\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20190603140227\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1109", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1109/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1109/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1109/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1109", "id": 438692609, "node_id": "MDU6SXNzdWU0Mzg2OTI2MDk=", "number": 1109, "title": "Reported memory usage for Docker runs", "user": {"login": "hh-astron", "id": 50137404, "node_id": "MDQ6VXNlcjUwMTM3NDA0", "avatar_url": "https://avatars1.githubusercontent.com/u/50137404?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hh-astron", "html_url": "https://github.com/hh-astron", "followers_url": "https://api.github.com/users/hh-astron/followers", "following_url": "https://api.github.com/users/hh-astron/following{/other_user}", "gists_url": "https://api.github.com/users/hh-astron/gists{/gist_id}", "starred_url": "https://api.github.com/users/hh-astron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hh-astron/subscriptions", "organizations_url": "https://api.github.com/users/hh-astron/orgs", "repos_url": "https://api.github.com/users/hh-astron/repos", "events_url": "https://api.github.com/users/hh-astron/events{/privacy}", "received_events_url": "https://api.github.com/users/hh-astron/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-30T09:52:08Z", "updated_at": "2019-07-27T15:32:43Z", "closed_at": "2019-07-27T15:32:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\ncwltool reporting correct memory usage for Docker runs.\r\n\r\n## Actual Behavior\r\nmemory usage calculation is not (always) correct\r\n\r\n## Your Environment\r\n* cwltool version: \r\ncwltool used by MC during tutorial session at ASTRON 30/4/2019", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1097", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1097/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1097/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1097/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1097", "id": 427868794, "node_id": "MDU6SXNzdWU0Mjc4Njg3OTQ=", "number": 1097, "title": "CWLtool asks for InlineJavascriptRequirement for parameter reference", "user": {"login": "kaushik-work", "id": 6299530, "node_id": "MDQ6VXNlcjYyOTk1MzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6299530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaushik-work", "html_url": "https://github.com/kaushik-work", "followers_url": "https://api.github.com/users/kaushik-work/followers", "following_url": "https://api.github.com/users/kaushik-work/following{/other_user}", "gists_url": "https://api.github.com/users/kaushik-work/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaushik-work/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaushik-work/subscriptions", "organizations_url": "https://api.github.com/users/kaushik-work/orgs", "repos_url": "https://api.github.com/users/kaushik-work/repos", "events_url": "https://api.github.com/users/kaushik-work/events{/privacy}", "received_events_url": "https://api.github.com/users/kaushik-work/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "tetron", "id": 1316612, "node_id": "MDQ6VXNlcjEzMTY2MTI=", "avatar_url": "https://avatars3.githubusercontent.com/u/1316612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tetron", "html_url": "https://github.com/tetron", "followers_url": "https://api.github.com/users/tetron/followers", "following_url": "https://api.github.com/users/tetron/following{/other_user}", "gists_url": "https://api.github.com/users/tetron/gists{/gist_id}", "starred_url": "https://api.github.com/users/tetron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tetron/subscriptions", "organizations_url": "https://api.github.com/users/tetron/orgs", "repos_url": "https://api.github.com/users/tetron/repos", "events_url": "https://api.github.com/users/tetron/events{/privacy}", "received_events_url": "https://api.github.com/users/tetron/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tetron", "id": 1316612, "node_id": "MDQ6VXNlcjEzMTY2MTI=", "avatar_url": "https://avatars3.githubusercontent.com/u/1316612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tetron", "html_url": "https://github.com/tetron", "followers_url": "https://api.github.com/users/tetron/followers", "following_url": "https://api.github.com/users/tetron/following{/other_user}", "gists_url": "https://api.github.com/users/tetron/gists{/gist_id}", "starred_url": "https://api.github.com/users/tetron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tetron/subscriptions", "organizations_url": "https://api.github.com/users/tetron/orgs", "repos_url": "https://api.github.com/users/tetron/repos", "events_url": "https://api.github.com/users/tetron/events{/privacy}", "received_events_url": "https://api.github.com/users/tetron/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-04-01T19:17:38Z", "updated_at": "2019-04-01T19:32:35Z", "closed_at": "2019-04-01T19:32:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nParameter references should work without specifying `InlineJavascriptRequirement`\r\n\r\n\r\n## Actual Behavior\r\nCWLtool asks for `InlineJavascriptRequirement` for parameter reference\r\n\r\n## Workflow Code\r\n```\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\ndoc: ''\r\ninputs: []\r\noutputs: []\r\nbaseCommand: 'echo'\r\narguments:\r\n  - prefix: --output\r\n    valueFrom: $(2 + 4).ext\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\ncmd.line.binding.cwl:9:5: Expression evaluation error:\r\n                          Syntax error in parameter reference '(2 + 4)'. This could be due to using\r\n                          Javascript code without specifying InlineJavascriptRequirement.\r\n```\r\n\r\n## Your Environment\r\n`cwltool 1.0.20190228155703`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1081", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1081/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1081/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1081/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1081", "id": 421411509, "node_id": "MDU6SXNzdWU0MjE0MTE1MDk=", "number": 1081, "title": "RFC handling of umask for temporary directories", "user": {"login": "tiborsimko", "id": 517546, "node_id": "MDQ6VXNlcjUxNzU0Ng==", "avatar_url": "https://avatars0.githubusercontent.com/u/517546?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tiborsimko", "html_url": "https://github.com/tiborsimko", "followers_url": "https://api.github.com/users/tiborsimko/followers", "following_url": "https://api.github.com/users/tiborsimko/following{/other_user}", "gists_url": "https://api.github.com/users/tiborsimko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tiborsimko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tiborsimko/subscriptions", "organizations_url": "https://api.github.com/users/tiborsimko/orgs", "repos_url": "https://api.github.com/users/tiborsimko/repos", "events_url": "https://api.github.com/users/tiborsimko/events{/privacy}", "received_events_url": "https://api.github.com/users/tiborsimko/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-15T08:49:04Z", "updated_at": "2019-06-11T10:05:50Z", "closed_at": "2019-06-11T10:05:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected Behavior\r\n\r\nTemporary directories created by `cwltool` should respect the `umask` settings of the parent environment. For example, when I set `umask 002` before running `cwltool`, I would expect `cwltool` to create any files or directories according to this umask. \r\n\r\n## Actual Behavior\r\n\r\nThe `cwltool` seems to impose fixed 755 permissions in several places:\r\n\r\n```console\r\n$ git grep -Hni 0o0\r\ncwltool/docker.py:262:                os.makedirs(host_outdir_tgt, 0o0755)\r\ncwltool/job.py:536:            os.makedirs(dirname, 0o0755)\r\ncwltool/process.py:228:            os.makedirs(os.path.dirname(entry.target), 0o0755)\r\ncwltool/process.py:245:            os.makedirs(entry.target, 0o0755)\r\ncwltool/process.py:251:                os.makedirs(entry.target, 0o0755)\r\ncwltool/singularity.py:229:            os.makedirs(new_dir, 0o0755)\r\n```\r\n\r\n## Motivation\r\n\r\nWhen running CWL workflows on the containerised [REANA](http://www.reana.io/) reproducible analysis platform, there are situations where the user wants to be able to run the Docker image under some particular non-root user identity (say UID=501). In order to guarantee being able to write to the mounted workspace in the job container, the user (1) belongs to a particular group (say GID=0 following [OpenShift guidelines](https://docs.openshift.com/container-platform/3.11/creating_images/guidelines.html#openshift-specific-guidelines)) and (2) permissions on the workspace are set  via `umask 002` to be of the `drwxrwxr-x` nature. This is usually enough to address the need.  However, we have encountered an issue that `cwltool` seems to create some directories with fixed 755 permissions (see above), which fails. It would be good `cwltool` respects the parent umask setting or if this behaviour were configurable.\r\n\r\n## RFC\r\n\r\nIs there a particular reason for imposing fixed 755 in `cwltool`? Could we simply drop it and rely on the umask set by the parent environment? Alternatively, could we make it configurable?\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1080", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1080/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1080/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1080/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1080", "id": 418878229, "node_id": "MDU6SXNzdWU0MTg4NzgyMjk=", "number": 1080, "title": "cwltool running from Celery", "user": {"login": "r78v10a07", "id": 8643256, "node_id": "MDQ6VXNlcjg2NDMyNTY=", "avatar_url": "https://avatars0.githubusercontent.com/u/8643256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/r78v10a07", "html_url": "https://github.com/r78v10a07", "followers_url": "https://api.github.com/users/r78v10a07/followers", "following_url": "https://api.github.com/users/r78v10a07/following{/other_user}", "gists_url": "https://api.github.com/users/r78v10a07/gists{/gist_id}", "starred_url": "https://api.github.com/users/r78v10a07/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/r78v10a07/subscriptions", "organizations_url": "https://api.github.com/users/r78v10a07/orgs", "repos_url": "https://api.github.com/users/r78v10a07/repos", "events_url": "https://api.github.com/users/r78v10a07/events{/privacy}", "received_events_url": "https://api.github.com/users/r78v10a07/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-03-08T17:15:23Z", "updated_at": "2019-05-20T14:38:05Z", "closed_at": "2019-03-11T02:53:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n---\r\n\r\n## Expected Behavior\r\nUse cwltool in a Celery task\r\n\r\n## Actual Behavior\r\nException while running job:\r\n\r\n`AttributeError: 'LoggingProxy' object has no attribute 'fileno'`\r\n\r\n## Workflow Code\r\n```pytb\r\n@shared_task\r\ndef dngsstats_analysis_cwl(data):\r\n    runtimeContext = RuntimeContext()\r\n    runtimeContext.use_container = settings.CWLTOOL_USE_DOCKER\r\n    runtimeContext.tmp_outdir_prefix = settings.MEDIA_ROOT\r\n    runtimeContext.tmpdir_prefix = settings.MEDIA_ROOT\r\n\r\n    fac = cwltool.factory.Factory(runtime_context=runtimeContext)\r\n    corr = fac.make(settings.CWLTOOL_BASE_DIR + '/tools/R/correlation_json.cwl')\r\n        matrix = {\r\n            \"class\": \"File\",\r\n            \"location\": data['matrixfile']\r\n        }\r\n        factor = {\r\n            \"class\": \"File\",\r\n            \"location\": data['samplefile']\r\n        }\r\n\r\n        results = corr(\r\n            matrix=matrix,\r\n            factor=factor,\r\n            gene_id_column='Gene_Chr_Start',\r\n            factor_sample_column='sample',\r\n            min_count=10,\r\n            min_number_samples=10,\r\n            json='correlation.json')\r\n\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\n[2019-03-08 16:55:11,264: INFO/MainProcess] Received task: project.dngsstats.tasks.dngsstats_analysis_cwl[66146f54-d54e-41b3-85fd-4afbc773ec13]\r\nResolved '/Users/veraalva/Work/Developer/Python/cwl-workflow/tools/R/correlation_json.cwl' to 'file:///Users/veraalva/Work/Developer/Python/cwl-workflow/tools/R/correlation_json.cwl'\r\n[2019-03-08 16:55:11,283: INFO/ForkPoolWorker-2] Resolved '/Users/veraalva/Work/Developer/Python/cwl-workflow/tools/R/correlation_json.cwl' to 'file:///Users/veraalva/Work/Developer/Python/cwl-workflow/tools/R/correlation_json.cwl'\r\n[2019-03-08 16:55:12,731: WARNING/ForkPoolWorker-2] http://schema.org/docs/!DOCTYPE html does not look like a valid URI, trying to serialize this will break.\r\n[2019-03-08 16:55:12,732: WARNING/ForkPoolWorker-2] http://schema.org/docs/html lang=\"en\" does not look like a valid URI, trying to serialize this will break.\r\n[2019-03-08 16:55:13,158: INFO/ForkPoolWorker-2] Current options:\r\n\t\tpreserve space                         : True\r\n\t\toutput processor graph                 : True\r\n\t\toutput default graph                   : True\r\n\t\thost language                          : RDFa Core\r\n\t\taccept embedded RDF                    : False\r\n\t\tcheck rdfa lite                        : False\r\n\t\tcache vocabulary graphs                : False\r\n\r\n[job correlation_json.cwl] /private/var/folders/q7/cf50cxlx56z0gz82063p9zb8000chm/T/kv_55fr5$ Rscript \\\r\n    correlation.R \\\r\n    /private/var/folders/q7/cf50cxlx56z0gz82063p9zb8000chm/T/tmpbajm0gcy/stg455bd409-3778-400b-aff3-991dff732091/L70HRH9I5V32UPR_matrix.tsv \\\r\n    /private/var/folders/q7/cf50cxlx56z0gz82063p9zb8000chm/T/tmpbajm0gcy/stgd9848a6b-2ebd-419a-bd46-0d46a684c367/L70HRH9I5V32UPR_samples.tsv \\\r\n    Gene_Chr_Start \\\r\n    sample \\\r\n    10 \\\r\n    10 \\\r\n    correlation.json\r\n[2019-03-08 16:55:16,210: INFO/ForkPoolWorker-2] [job correlation_json.cwl] /private/var/folders/q7/cf50cxlx56z0gz82063p9zb8000chm/T/kv_55fr5$ Rscript \\\r\n    correlation.R \\\r\n    /private/var/folders/q7/cf50cxlx56z0gz82063p9zb8000chm/T/tmpbajm0gcy/stg455bd409-3778-400b-aff3-991dff732091/L70HRH9I5V32UPR_matrix.tsv \\\r\n    /private/var/folders/q7/cf50cxlx56z0gz82063p9zb8000chm/T/tmpbajm0gcy/stgd9848a6b-2ebd-419a-bd46-0d46a684c367/L70HRH9I5V32UPR_samples.tsv \\\r\n    Gene_Chr_Start \\\r\n    sample \\\r\n    10 \\\r\n    10 \\\r\n    correlation.json\r\nException while running job\r\nTraceback (most recent call last):\r\n  File \"/Users/veraalva/Work/Developer/Python/Django/ngsproject/venv/lib/python3.6/site-packages/cwltool/job.py\", line 308, in _execute\r\n    monitor_function=monitor_function\r\n  File \"/Users/veraalva/Work/Developer/Python/Django/ngsproject/venv/lib/python3.6/site-packages/cwltool/job.py\", line 748, in _job_popen\r\n    cwd=cwd)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/subprocess.py\", line 667, in __init__\r\n    errread, errwrite) = self._get_handles(stdin, stdout, stderr)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/subprocess.py\", line 1184, in _get_handles\r\n    c2pwrite = stdout.fileno()\r\nAttributeError: 'LoggingProxy' object has no attribute 'fileno'\r\n```\r\n\r\n## Your Environment\r\ncwltool 1.0.20181217162649\r\ncelery 4.2.1 (windowlicker)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1079", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1079/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1079/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1079/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1079", "id": 418774552, "node_id": "MDU6SXNzdWU0MTg3NzQ1NTI=", "number": 1079, "title": "IWDR+DockerReq: real input files inside Directory literals \u2192 PermissionError", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-03-08T12:51:26Z", "updated_at": "2020-05-19T12:40:03Z", "closed_at": "2020-05-19T12:40:03Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "> iwdr_dir_literal_real_file.cwl\r\n``` cwl\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\n\r\nrequirements:\r\n  DockerRequirement:\r\n      dockerPull: debian\r\n  InlineJavascriptRequirement: {}\r\n  InitialWorkDirRequirement:\r\n    listing: |\r\n      ${\r\n         return [{\"class\": \"Directory\",\r\n                  \"basename\": \"subdir\",\r\n                  \"listing\": [ inputs.example ]\r\n                  }]}\r\n\r\ninputs:\r\n  example: File\r\n\r\noutputs:\r\n  same:\r\n   type: File\r\n   outputBinding:\r\n     glob: subdir/$(inputs.example.basename)\r\n```\r\n\r\nresult\r\n\r\n```\r\n$ cwltool iwdr_dir_literal_real_file.cwl --example README.rst \r\n/home/michael/cwltool/env3/bin/cwltool 1.0.20190228200117\r\nResolved 'iwdr_dir_literal_real_file.cwl' to 'file:///home/michael/cwltool/iwdr_dir_literal_real_file.cwl'\r\n[job iwdr_dir_literal_real_file.cwl] /tmp/umhibvch$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/tmp/umhibvch:/fEuOgP:rw \\\r\n    --volume=/tmp/n2wem27d:/tmp:rw \\\r\n    --volume=/home/michael/cwltool/README.rst:/fEuOgP/subdir/README.rst:ro \\\r\n    --workdir=/fEuOgP \\\r\n    --read-only=true \\\r\n    --user=1000:1000 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/fEuOgP \\\r\n    --cidfile=/tmp/d11wgn0j/20190308144957-649141.cid \\\r\n    debian\r\n[job iwdr_dir_literal_real_file.cwl] Max memory used: 0MiB\r\nException while running job\r\nTraceback (most recent call last):\r\n  File \"/home/michael/cwltool/cwltool/job.py\", line 329, in _execute\r\n    inplace_update=self.inplace_update)\r\n  File \"/home/michael/cwltool/cwltool/job.py\", line 148, in relink_initialworkdir\r\n    os.remove(host_outdir_tgt)\r\nPermissionError: [Errno 13] Permission denied: '/tmp/umhibvch/subdir/README.rst'\r\n[job iwdr_dir_literal_real_file.cwl] completed permanentFail\r\n{}\r\nFinal process status is permanentFail\r\n```\r\nInstead of \r\n```\r\n$ cwltool iwdr_dir_literal_real_file.cwl --example README.rst \r\n/home/michael/cwltool/env3/bin/cwltool 1.0.20190228200117\r\nResolved 'iwdr_dir_literal_real_file.cwl' to 'file:///home/michael/cwltool/iwdr_dir_literal_real_file.cwl'\r\n[job iwdr_dir_literal_real_file.cwl] /tmp/mprnbbcc$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/tmp/mprnbbcc:/XteCes:rw \\\r\n    --volume=/tmp/jhmr849h:/tmp:rw \\\r\n    --workdir=/XteCes \\\r\n    --read-only=true \\\r\n    --user=1000:1000 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/XteCes \\\r\n    --cidfile=/tmp/zlkkrtdr/20190308145035-998641.cid \\\r\n    debian\r\n[job iwdr_dir_literal_real_file.cwl] Max memory used: 0MiB\r\n[job iwdr_dir_literal_real_file.cwl] completed success\r\n{\r\n    \"same\": {\r\n        \"location\": \"file:///home/michael/cwltool/README.rst\",\r\n        \"basename\": \"README.rst\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$a430706cc775c602686593cdf221b4d7ee9b09ea\",\r\n        \"size\": 27810,\r\n        \"path\": \"/home/michael/cwltool/README.rst\"\r\n    }\r\n}\r\nFinal process status is success\r\n```\r\n\r\nWorkaround, insert `, \"writable\": true` after the `\"listing\": [ inputs.example ]`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1074", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1074/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1074/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1074/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1074", "id": 415534858, "node_id": "MDU6SXNzdWU0MTU1MzQ4NTg=", "number": 1074, "title": "in an ExpressionTool, the `File`s inside a `Directory` lack path part fields", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-02-28T09:51:08Z", "updated_at": "2019-02-28T17:04:59Z", "closed_at": "2019-02-28T17:04:59Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Though a regular input of type `File` has `basename`, `nameroot`, `nameext` fields..\r\n\r\nThe problem exists even with `cwltool:LoadListingRequirement: { loadListing: deep_listing }`\r\n\r\n>biostars_365953.cwl\r\n``` cwl\r\nclass: ExpressionTool\r\ncwlVersion: v1.0\r\n$namespaces: { cwltool: \"http://commonwl.org/cwltool#\" }\r\ninputs:\r\n  randodir: Directory\r\n  randofile: File\r\noutputs:\r\n  exts: string[]\r\nrequirements:\r\n  InlineJavascriptRequirement: {}\r\n  cwltool:LoadListingRequirement:\r\n    loadListing: deep_listing\r\nexpression: |\r\n  ${\r\n    var exts = [];\r\n    \r\n    exts.push(inputs.randofile.nameext)\r\n    for (var i = 0; i < inputs.randodir.listing.length; i++) {\r\n      var file = inputs.randodir.listing[i];\r\n        exts.push(file.nameext);\r\n      }\r\n    return {\"exts\": exts};\r\n   }\r\n```\r\n```\r\n$ mkdir -p test1/test2\r\n$ touch test1/first.txt test1/test2/second.foo test1/test2/third.bar\r\n$ cwltool --enable-ext biostars_365953.cwl --randofile test1/first.txt --randodir test1/test2\r\n/home/michael/cwltool/env3/bin/cwltool 1.0.20190227152456\r\nResolved 'biostars_365953.cwl' to 'file:///home/michael/cwltool/biostars_365953.cwl'\r\n{\r\n    \"exts\": [\r\n        \".txt\",\r\n        null,\r\n        null\r\n    ]\r\n}\r\nFinal process status is success\r\n```\r\nVersion of the same, but putting the `expression` inside a `CommandLineTool`:\r\n> biostars_365953_clt.cwl\r\n\r\n``` cwl\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\ninputs:\r\n  randofile: File\r\n  randodir: Directory\r\noutputs:\r\n  exts:\r\n   type:\r\n     type: array\r\n     items: string\r\n   outputBinding:\r\n     outputEval: |\r\n       ${\r\n        var exts = [];\r\n        exts.push(inputs.randofile.nameext)\r\n        for (var i = 0; i < inputs.randodir.listing.length; i++) {\r\n          var file = inputs.randodir.listing[i];\r\n            exts.push(file.nameext);\r\n          }\r\n        return exts;\r\n        }\r\n\r\nrequirements:\r\n  InlineJavascriptRequirement: {}\r\nbaseCommand: /bin/true\r\n\r\n```\r\n\r\n```\r\n$ cwltool --enable-ext biostars_365953_clt.cwl --randofile test1/first.txt --randodir test1/test2\r\n/home/michael/cwltool/env3/bin/cwltool 1.0.20190227152456\r\nResolved 'biostars_365953_clt.cwl' to 'file:///home/michael/cwltool/biostars_365953_clt.cwl'\r\n[job biostars_365953_clt.cwl] /tmp/cpvdocm5$ /bin/true\r\nCould not collect memory usage, job ended before monitoring began.\r\n[job biostars_365953_clt.cwl] completed success\r\n{\r\n    \"exts\": [\r\n        \".txt\",\r\n        \".bar\",\r\n        \".foo\"\r\n    ]\r\n}\r\nFinal process status is success\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1060", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1060/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1060/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1060/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1060", "id": 410197467, "node_id": "MDU6SXNzdWU0MTAxOTc0Njc=", "number": 1060, "title": "ERROR: genrsa: Can't open \"/etc/apache2/ssl/pass.key\" for writing, Read-only file system", "user": {"login": "Johnnywang92", "id": 13830258, "node_id": "MDQ6VXNlcjEzODMwMjU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13830258?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Johnnywang92", "html_url": "https://github.com/Johnnywang92", "followers_url": "https://api.github.com/users/Johnnywang92/followers", "following_url": "https://api.github.com/users/Johnnywang92/following{/other_user}", "gists_url": "https://api.github.com/users/Johnnywang92/gists{/gist_id}", "starred_url": "https://api.github.com/users/Johnnywang92/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Johnnywang92/subscriptions", "organizations_url": "https://api.github.com/users/Johnnywang92/orgs", "repos_url": "https://api.github.com/users/Johnnywang92/repos", "events_url": "https://api.github.com/users/Johnnywang92/events{/privacy}", "received_events_url": "https://api.github.com/users/Johnnywang92/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-02-14T02:42:37Z", "updated_at": "2019-02-15T01:27:24Z", "closed_at": "2019-02-15T01:17:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "when I run the cwl tools on MAC, I gat an error message as following. Any suggestion? \r\n```\r\ngenrsa: Can't open \"/etc/apache2/ssl/pass.key\" for writing, Read-only file system\r\n[job bwa_index.cwl] Max memory used: 0MiB\r\n[job bwa_index.cwl] Job error:\r\nError collecting output for parameter 'output':\r\nbwa_index.cwl:30:5: Traceback (most recent call last):\r\nbwa_index.cwl:30:5:\r\nbwa_index.cwl:30:5:   File \"/Users/yifanwang/Test/CWL_work/venv_cwl/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 612, in collect_output_ports\r\nbwa_index.cwl:30:5:     compute_checksum=compute_checksum)\r\nbwa_index.cwl:30:5:\r\nbwa_index.cwl:30:5:   File \"/Users/yifanwang/Test/CWL_work/venv_cwl/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 692, in collect_output\r\nbwa_index.cwl:30:5:     raise\r\nbwa_index.cwl:30:5:\r\nbwa_index.cwl:30:5:   File \"/Users/yifanwang/Test/CWL_work/venv_cwl/lib/python2.7/site-packages/schema_salad/sourceline.py\", line 166, in __exit__\r\nbwa_index.cwl:30:5:     raise self.makeError(\"\\n\".join(traceback.format_exception(exc_type, exc_value, tb)))\r\nbwa_index.cwl:30:5:\r\nWorkflowException: bwa_index.cwl:33:7: Traceback (most recent call last):\r\nbwa_index.cwl:33:7:\r\nbwa_index.cwl:33:7:   File \"/Users/yifanwang/Test/CWL_work/venv_cwl/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 664, in collect_output\r\nbwa_index.cwl:33:7:     if gb.startswith(outdir):\r\nbwa_index.cwl:33:7:\r\nbwa_index.cwl:33:7: AttributeError: 'CommentedMap' object has no attribute 'startswith'\r\n[job bwa_index.cwl] completed permanentFail\r\n[job bwa_index.cwl] {}\r\n[job bwa_index.cwl] Removing input staging directory /var/folders/1m/zpv1ttyd3klg2ywkv8c_r4z40000gn/T/dVzS1t\r\n[job bwa_index.cwl] Removing temporary directory /var/folders/1m/zpv1ttyd3klg2ywkv8c_r4z40000gn/T/BcLAm1\r\n{}\r\nFinal process status is permanentFail\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1043", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1043/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1043/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1043/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1043", "id": 402316184, "node_id": "MDU6SXNzdWU0MDIzMTYxODQ=", "number": 1043, "title": "Python2: Staging an input file in a writable directory fails ~50% of the time", "user": {"login": "bogdang989", "id": 24608085, "node_id": "MDQ6VXNlcjI0NjA4MDg1", "avatar_url": "https://avatars2.githubusercontent.com/u/24608085?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bogdang989", "html_url": "https://github.com/bogdang989", "followers_url": "https://api.github.com/users/bogdang989/followers", "following_url": "https://api.github.com/users/bogdang989/following{/other_user}", "gists_url": "https://api.github.com/users/bogdang989/gists{/gist_id}", "starred_url": "https://api.github.com/users/bogdang989/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bogdang989/subscriptions", "organizations_url": "https://api.github.com/users/bogdang989/orgs", "repos_url": "https://api.github.com/users/bogdang989/repos", "events_url": "https://api.github.com/users/bogdang989/events{/privacy}", "received_events_url": "https://api.github.com/users/bogdang989/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-01-23T16:14:49Z", "updated_at": "2019-01-24T09:53:13Z", "closed_at": "2019-01-24T09:53:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected Behavior\r\nInput file is staged in a subdirectory.\r\n\r\n## Actual Behavior\r\nTwo items are up for creation, subdirectory and the staged file. In python3 seems like subdirectory is always created first, while in python2 the order is random, so trying to copy file to the non-existing subdirectory fails. Discovered by Jenkins(https://ci.commonwl.org/job/cwl-spec-pr/438/implementation=cwltool,version=v1.0/testReport/conformance_test_v1/0/Test_staging_array_of_files_in_a_subdirectory/), confirmed locally.\r\n\r\n## Workflow Code\r\n```\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\nbaseCommand:\r\n  - cp\r\n  - staged/whale.txt\r\n  - whale_copy.txt\r\ninputs:\r\n  - id: infiles\r\n    type: File[]\r\noutputs:\r\n  - id: outfile\r\n    type: File\r\n    outputBinding:\r\n      glob: whale_copy.txt\r\nrequirements:\r\n  - class: InitialWorkDirRequirement\r\n    listing:\r\n      - entry: >-\r\n          ${ return { 'class': 'Directory', 'listing': inputs.infiles,\r\n          'basename': 'staged'} }\r\n        writable: true\r\n  - class: InlineJavascriptRequirement\r\nhints:\r\n  - class: DockerRequirement\r\n    dockerPull: 'debian:stretch-slim'\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\nGot workflow error\r\nTraceback (most recent call last):\r\n  File \"/home/bogdan/miniconda2/lib/python2.7/site-packages/cwltool/executors.py\", line 182, in run_jobs\r\n    job.run(runtime_context)\r\n  File \"/home/bogdan/miniconda2/lib/python2.7/site-packages/cwltool/job.py\", line 644, in run\r\n    (runtime, cidfile) = self.create_runtime(env, runtimeContext)\r\n  File \"/home/bogdan/miniconda2/lib/python2.7/site-packages/cwltool/docker.py\", line 303, in create_runtime\r\n    tmpdir_prefix=runtimeContext.tmpdir_prefix)\r\n  File \"/home/bogdan/miniconda2/lib/python2.7/site-packages/cwltool/job.py\", line 569, in add_volumes\r\n    runtime, vol, host_outdir_tgt, tmpdir_prefix)\r\n  File \"/home/bogdan/miniconda2/lib/python2.7/site-packages/cwltool/docker.py\", line 232, in add_writable_file_volume\r\n    shutil.copy(volume.resolved, host_outdir_tgt)\r\n  File \"/home/bogdan/miniconda2/lib/python2.7/shutil.py\", line 119, in copy\r\n    copyfile(src, dst)\r\n  File \"/home/bogdan/miniconda2/lib/python2.7/shutil.py\", line 83, in copyfile\r\n    with open(dst, 'wb') as fdst:\r\nIOError: [Errno 2] No such file or directory: u'/tmp/sUDGJW/staged/whale.txt'\r\nWorkflow error, try again with --debug for more information:\r\n[Errno 2] No such file or directory: u'/tmp/sUDGJW/staged/whale.txt'\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20181217162649\r\nCheck using ``cwltool --version``\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1038", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1038/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1038/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1038/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1038", "id": 400980827, "node_id": "MDU6SXNzdWU0MDA5ODA4Mjc=", "number": 1038, "title": "restore ramMin default to 1G for CWL v1.0", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/common-workflow-language/cwltool/milestones/2", "html_url": "https://github.com/common-workflow-language/cwltool/milestone/2", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/milestones/2/labels", "id": 3078586, "node_id": "MDk6TWlsZXN0b25lMzA3ODU4Ng==", "number": 2, "title": "v1.1", "description": "Issues and pull requests for v1.1 specification changes", "creator": {"login": "anton-khodak", "id": 10351924, "node_id": "MDQ6VXNlcjEwMzUxOTI0", "avatar_url": "https://avatars1.githubusercontent.com/u/10351924?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anton-khodak", "html_url": "https://github.com/anton-khodak", "followers_url": "https://api.github.com/users/anton-khodak/followers", "following_url": "https://api.github.com/users/anton-khodak/following{/other_user}", "gists_url": "https://api.github.com/users/anton-khodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/anton-khodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anton-khodak/subscriptions", "organizations_url": "https://api.github.com/users/anton-khodak/orgs", "repos_url": "https://api.github.com/users/anton-khodak/repos", "events_url": "https://api.github.com/users/anton-khodak/events{/privacy}", "received_events_url": "https://api.github.com/users/anton-khodak/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 3, "state": "open", "created_at": "2018-01-31T16:10:51Z", "updated_at": "2019-02-28T15:05:48Z", "due_on": null, "closed_at": null}, "comments": 0, "created_at": "2019-01-19T09:59:28Z", "updated_at": "2019-02-28T15:05:48Z", "closed_at": "2019-02-28T15:05:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I agree that we should document the default value for `ramMin` in the CWL spec, but we should keep the 1024 (MiB) value for CWL v1.0\r\n\r\nhttps://github.com/common-workflow-language/cwltool/pull/879/files#diff-44cae4bc145a66f8f631d1f2703140f5R766\r\n\r\n- [x] Add `ResourceRequirement` with lower `ramMIn` hints to CWL conformance tests based upon measured values rounded up to the nearest attractive number.\r\n- [x] restore ramMin default to 1024 (MiB) in `cwltool` before the next release\r\n- [x] add new ramMin default of 256 (MiB) to CWL v1.1.0-devN\r\n- [x] implement new ramMin default of 256 (MiB) only for cwl v1.1+ in cwltool after the spec has been updated", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1036", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1036/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1036/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1036/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1036", "id": 400530321, "node_id": "MDU6SXNzdWU0MDA1MzAzMjE=", "number": 1036, "title": "tmp Dir exists already", "user": {"login": "ionox0", "id": 6385646, "node_id": "MDQ6VXNlcjYzODU2NDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/6385646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ionox0", "html_url": "https://github.com/ionox0", "followers_url": "https://api.github.com/users/ionox0/followers", "following_url": "https://api.github.com/users/ionox0/following{/other_user}", "gists_url": "https://api.github.com/users/ionox0/gists{/gist_id}", "starred_url": "https://api.github.com/users/ionox0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ionox0/subscriptions", "organizations_url": "https://api.github.com/users/ionox0/orgs", "repos_url": "https://api.github.com/users/ionox0/repos", "events_url": "https://api.github.com/users/ionox0/events{/privacy}", "received_events_url": "https://api.github.com/users/ionox0/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-01-18T01:11:03Z", "updated_at": "2020-01-21T18:14:41Z", "closed_at": "2020-01-21T18:14:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I see a stochastic error for certain jobs when kicking off many jobs at the same time (~100 or so).\r\n\r\n## Expected Behavior\r\n`tmp dir` should be created once and subsequently checked for existence.\r\n\r\n## Actual Behavior\r\n```\r\nOSError: [Errno 17] File exists: '/ifs/work/bergerm1/Innovation/sandbox/ian/pipeline_0.1.0-DEV-TEST/tmp'\r\n```\r\n\r\n## Command issued\r\n```\r\ntoil-cwl-runner \\\r\n--logFile /ifs/work/bergerm1/Innovation/sandbox/ian/pipeline_0.1.0-DEV-TEST/ValidationRedo-0.1.0-DEV/log/cwltoil.log \\\r\n--jobStore file:///ifs/work/bergerm1/Innovation/sandbox/ian/pipeline_0.1.0-DEV-TEST/ValidationRedo-0.1.0-DEV/tmp//jobstore-e18d4790-1ab8-11e9-bf33-70106fb1697e \\\r\n--batchSystem lsf \\\r\n--workDir /ifs/work/bergerm1/Innovation/sandbox/ian/pipeline_0.1.0-DEV-TEST/ValidationRedo-0.1.0-DEV/tmp/ \\\r\n--outdir /ifs/work/bergerm1/Innovation/sandbox/ian/pipeline_0.1.0-DEV-TEST/ValidationRedo-0.1.0-DEV \\\r\n--writeLogs /ifs/work/bergerm1/Innovation/sandbox/ian/pipeline_0.1.0-DEV-TEST/ValidationRedo-0.1.0-DEV/log \\\r\n--logLevel INFO \\\r\n--stats   \\\r\n--cleanWorkDir onSuccess  \\\r\n--defaultDisk 10G  \\\r\n--preserve-environment PATH PYTHONPATH TOIL_LSF_ARGS  \\\r\n--retryCount 2  \\\r\n--no-container   \\\r\n--defaultMem 10G  \\\r\n--disableCaching   \\\r\n--maxLogFileSize 20000000  \\\r\n/home/johnsoni/pipeline_0.1.0-DEV/ACCESS-Pipeline/workflows/subworkflows/snps_and_indels.cwl inputs.yaml\r\n```\r\n\r\nNote that the values that I am supplying for the `--workDir` and `--outdir` parameters are not in agreement with the `tmp` directory that is causing the error. \r\n\r\nThis mysterious `tmp` directory shows up in the current working directory from which the command was submitted. \r\n\r\nI am using toil, and this directory has appeared since upgrading from 3.15 to 3.18.\r\n\r\nHowever it seems like an issue with cwltool.\r\n\r\n## Workflow Code\r\nThe pipeline I'm running is quite large, but I believe this issue is instead caused by submitting a large number of jobs concurrently. \r\n\r\nI'm not familiar with all of the particular ways in which temporary directories are created by `cwltool`, and it seems there are several different ways of specifying the tmp dir location (`TMPDIR` environment variable, `--tmp-dir-prefix`, `--tmp-outdir-prefix`). \r\n\r\nBut my best guess is that there may be a race condition when creating the tmp dir because of this line: \r\n\r\nhttps://github.com/common-workflow-language/cwltool/blob/1.0.20180819175200/cwltool/job.py#L381\r\n\r\n```\r\n        if not os.path.exists(self.tmpdir):\r\n            os.makedirs(self.tmpdir)\r\n```\r\n\r\nWhich will error if two jobs reach the same point at the same time without synchronization (similarly for any other places where this tmp dir is going to be created). \r\n\r\n## Full Traceback\r\n```pytb\r\nWARNING:toil.leader:The job seems to have left a log file, indicating failure: 'file:///home/johnsoni/pipeline_0.1.0-DEV/ACCESS-Pipeline/cwl_tools/mutect/mutect.cwl' /opt/common/CentOS_6/java/jdk1.7.0_75/bin/java w/n/jobhgbJto\r\nWARNING:toil.leader:w/n/jobhgbJto    INFO:toil.worker:---TOIL WORKER OUTPUT LOG---\r\nWARNING:toil.leader:w/n/jobhgbJto    INFO:toil:Running Toil version 3.18.0-84239d802248a5f4a220e762b3b8ce5cc92af0be-dirty.\r\nWARNING:toil.leader:w/n/jobhgbJto    Got workflow error\r\nWARNING:toil.leader:w/n/jobhgbJto    Traceback (most recent call last):\r\nWARNING:toil.leader:w/n/jobhgbJto      File \"/home/johnsoni/virtualenvs/pipeline_0.1.0-DEV/lib/python2.7/site-packages/cwltool-1.0.20180820141117-py2.7.egg/cwltool/executors.py\", line 165, in run_jobs\r\nWARNING:toil.leader:w/n/jobhgbJto        job.run(runtime_context)\r\nWARNING:toil.leader:w/n/jobhgbJto      File \"/home/johnsoni/virtualenvs/pipeline_0.1.0-DEV/lib/python2.7/site-packages/cwltool-1.0.20180820141117-py2.7.egg/cwltool/job.py\", line 378, in run\r\nWARNING:toil.leader:w/n/jobhgbJto        os.makedirs(self.tmpdir)\r\nWARNING:toil.leader:w/n/jobhgbJto      File \"/home/johnsoni/virtualenvs/pipeline_0.1.0-DEV/lib/python2.7/os.py\", line 157, in makedirs\r\nWARNING:toil.leader:w/n/jobhgbJto        mkdir(name, mode)\r\nWARNING:toil.leader:w/n/jobhgbJto    OSError: [Errno 17] File exists: '/ifs/work/bergerm1/Innovation/sandbox/ian/pipeline_0.1.0-DEV-TEST/tmp'\r\nWARNING:toil.leader:w/n/jobhgbJto    ERROR:cwltool:Got workflow error\r\nWARNING:toil.leader:w/n/jobhgbJto    Traceback (most recent call last):\r\nWARNING:toil.leader:w/n/jobhgbJto      File \"/home/johnsoni/virtualenvs/pipeline_0.1.0-DEV/lib/python2.7/site-packages/cwltool-1.0.20180820141117-py2.7.egg/cwltool/executors.py\", line 165, in run_jobs\r\nWARNING:toil.leader:w/n/jobhgbJto        job.run(runtime_context)\r\nWARNING:toil.leader:w/n/jobhgbJto      File \"/home/johnsoni/virtualenvs/pipeline_0.1.0-DEV/lib/python2.7/site-packages/cwltool-1.0.20180820141117-py2.7.egg/cwltool/job.py\", line 378, in run\r\nWARNING:toil.leader:w/n/jobhgbJto        os.makedirs(self.tmpdir)\r\nWARNING:toil.leader:w/n/jobhgbJto      File \"/home/johnsoni/virtualenvs/pipeline_0.1.0-DEV/lib/python2.7/os.py\", line 157, in makedirs\r\nWARNING:toil.leader:w/n/jobhgbJto        mkdir(name, mode)\r\nWARNING:toil.leader:w/n/jobhgbJto    OSError: [Errno 17] File exists: '/ifs/work/bergerm1/Innovation/sandbox/ian/pipeline_0.1.0-DEV-TEST/tmp'\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n`1.0.20180820141117`\r\n* Toil version:\r\n`3.18.0-84239d802248a5f4a220e762b3b8ce5cc92af0be-dirty`\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1033", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1033/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1033/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/1033/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/1033", "id": 397497083, "node_id": "MDU6SXNzdWUzOTc0OTcwODM=", "number": 1033, "title": "Docker image for cwltool does not work on Ubuntu 16.04", "user": {"login": "suecharo", "id": 26019402, "node_id": "MDQ6VXNlcjI2MDE5NDAy", "avatar_url": "https://avatars3.githubusercontent.com/u/26019402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suecharo", "html_url": "https://github.com/suecharo", "followers_url": "https://api.github.com/users/suecharo/followers", "following_url": "https://api.github.com/users/suecharo/following{/other_user}", "gists_url": "https://api.github.com/users/suecharo/gists{/gist_id}", "starred_url": "https://api.github.com/users/suecharo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suecharo/subscriptions", "organizations_url": "https://api.github.com/users/suecharo/orgs", "repos_url": "https://api.github.com/users/suecharo/repos", "events_url": "https://api.github.com/users/suecharo/events{/privacy}", "received_events_url": "https://api.github.com/users/suecharo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-01-09T18:25:37Z", "updated_at": "2019-03-23T05:58:38Z", "closed_at": "2019-03-23T05:58:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\n- Working https://hub.docker.com/r/commonworkflowlanguage/cwltool\r\n\r\n## Actual Behavior\r\n- Does not work...\r\n\r\n```\r\n$ docker pull commonworkflowlanguage/cwltool\r\nUsing default tag: latest\r\nlatest: Pulling from commonworkflowlanguage/cwltool\r\n81033e7c1d6a: Pull complete \r\n9b61101706a6: Pull complete \r\nd0230414692f: Pull complete \r\n8017bde2e9e0: Pull complete \r\n69085333b636: Pull complete \r\n7bfb9b44446e: Pull complete \r\n6a50fee2bf7c: Pull complete \r\nc876db03cb9f: Pull complete \r\n50ff3a734fd6: Pull complete \r\nDigest: sha256:efab1df45d351a613951d50a90673954b007c705f4eeedbeeb4b780e39bd0660\r\nStatus: Downloaded newer image for commonworkflowlanguage/cwltool:latest\r\n\r\n$ docker run --privileged -ti --volume=$PWD:/tmp/workdir -w=/tmp/workdir commonworkflowlanguage/cwltool $*\r\nERROR: cwltool cannot work inside a container without access to docker\r\nLaunch the container with the option -v /var/run/docker.sock:/var/run/docker.sock\r\n```\r\n\r\n---\r\n\r\nThis Issue is very similar to Issue #546.\r\nI talked to him face-to-face, and created a really moving Dockerfile.\r\n\r\nhttps://github.com/suecharo/cwltool_in_container\r\n\r\nThe above code seems to work only on Linux due to differences in file system and file path of socket. When running on Mac or Windows, it is necessary to modify the code.\r\n\r\n## Workflow Code\r\nUsing https://github.com/hacchy1983/CWL-workflows\r\n\r\n## Your Environment\r\nUbuntu: 16.04\r\n\r\n```bash\r\n$ docker --version\r\nDocker version 18.09.0, build 4d60db4\r\n$ docker-compose --version\r\ndocker-compose version 1.23.1, build b02f1306\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/997", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/997/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/997/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/997/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/997", "id": 387251713, "node_id": "MDU6SXNzdWUzODcyNTE3MTM=", "number": 997, "title": "cwl-runner --singularity fails with inputs of type int", "user": {"login": "rvanharen", "id": 10499150, "node_id": "MDQ6VXNlcjEwNDk5MTUw", "avatar_url": "https://avatars2.githubusercontent.com/u/10499150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rvanharen", "html_url": "https://github.com/rvanharen", "followers_url": "https://api.github.com/users/rvanharen/followers", "following_url": "https://api.github.com/users/rvanharen/following{/other_user}", "gists_url": "https://api.github.com/users/rvanharen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rvanharen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rvanharen/subscriptions", "organizations_url": "https://api.github.com/users/rvanharen/orgs", "repos_url": "https://api.github.com/users/rvanharen/repos", "events_url": "https://api.github.com/users/rvanharen/events{/privacy}", "received_events_url": "https://api.github.com/users/rvanharen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-12-04T11:57:40Z", "updated_at": "2019-02-28T18:46:40Z", "closed_at": "2019-02-28T18:46:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\ncwl-runner --singularity supports inputs of type int\r\n\r\n## Actual Behavior\r\ncwl-runner --singularity fail with TypeError if input is of type int\r\n\r\n## Workflow Code\r\n```\r\n#!/usr/bin/env cwl-runner\r\n\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nbaseCommand: download_gefs.sh\r\nhints:\r\n  DockerRequirement:\r\n    dockerPull: ewatercycle/ewatercycle_forecast_getforcing\r\nrequirements:\r\n  EnvVarRequirement:\r\n    envDef:\r\n      ISO_DATE: $(inputs.iso_date)\r\ninputs:\r\n  iso_date:\r\n    type: int\r\noutputs:\r\n  download_gefs:\r\n    type: File\r\n    outputBinding:\r\nglob: gefs_$(inputs.iso_date).tar.bz2\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\ncwl-runner --singularity download_gefs.cwl --iso_date 20181202\r\n/nfs/home2/rhwater/venv-forecast/bin/cwl-runner 1.0.20181201184214\r\nResolved 'download_gefs.cwl' to 'file:///scratch/shared/tmp1/forecast-docker/getforcing/cwl/download_gefs.cwl'\r\nUsing local copy of Singularity image found in /scratch/shared/tmp1/forecast-docker/getforcing/cwl\r\nISO_DATE\r\nGot workflow error\r\nTraceback (most recent call last):\r\n  File \"/nfs/home2/rhwater/venv-forecast/lib/python2.7/site-packages/cwltool/executors.py\", line 182, in run_jobs\r\n    job.run(runtime_context)\r\n  File \"/nfs/home2/rhwater/venv-forecast/lib/python2.7/site-packages/cwltool/job.py\", line 605, in run\r\n    runtime = self.create_runtime(env, runtimeContext)\r\n  File \"/nfs/home2/rhwater/venv-forecast/lib/python2.7/site-packages/cwltool/singularity.py\", line 283, in create_runtime\r\n    env[\"SINGULARITYENV_{}\".format(name)] = value\r\n  File \"/nfs/home2/rhwater/venv-forecast/lib/python2.7/os.py\", line 473, in __setitem__\r\n    putenv(key, item)\r\nTypeError: must be string, not int\r\nWorkflow error, try again with --debug for more information:\r\nmust be string, not int\r\n```\r\n\r\n## Your Environment\r\n* cwltool version:  1.0.20181201184214\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/992", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/992/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/992/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/992/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/992", "id": 385690106, "node_id": "MDU6SXNzdWUzODU2OTAxMDY=", "number": 992, "title": "anonymous enum inside a record fails", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-11-29T11:27:02Z", "updated_at": "2018-12-01T18:42:15Z", "closed_at": "2018-12-01T18:42:15Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Inspired by https://www.biostars.org/p/350713/\r\n\r\nboth in `SchemaDefRequirements` and inside `inputs`\r\n\r\n``` cwl\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nbaseCommand: echo\r\noutputs: []\r\ninputs:\r\n  first:\r\n    type:\r\n      type: record\r\n      fields:\r\n        species:\r\n            - type: enum  # this doesn't work\r\n              symbols: [homo_sapiens, mus_musculus]\r\n    inputBinding: {}\r\n  second:\r\n    type:\r\n      type: enum  # this does work\r\n      symbols: [homo_sapiens, mus_musculus]\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/991", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/991/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/991/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/991/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/991", "id": 385626990, "node_id": "MDU6SXNzdWUzODU2MjY5OTA=", "number": 991, "title": "--target fails with workflow schema in packed $graph format", "user": {"login": "roksys", "id": 5921114, "node_id": "MDQ6VXNlcjU5MjExMTQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/5921114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/roksys", "html_url": "https://github.com/roksys", "followers_url": "https://api.github.com/users/roksys/followers", "following_url": "https://api.github.com/users/roksys/following{/other_user}", "gists_url": "https://api.github.com/users/roksys/gists{/gist_id}", "starred_url": "https://api.github.com/users/roksys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/roksys/subscriptions", "organizations_url": "https://api.github.com/users/roksys/orgs", "repos_url": "https://api.github.com/users/roksys/repos", "events_url": "https://api.github.com/users/roksys/events{/privacy}", "received_events_url": "https://api.github.com/users/roksys/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "tetron", "id": 1316612, "node_id": "MDQ6VXNlcjEzMTY2MTI=", "avatar_url": "https://avatars3.githubusercontent.com/u/1316612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tetron", "html_url": "https://github.com/tetron", "followers_url": "https://api.github.com/users/tetron/followers", "following_url": "https://api.github.com/users/tetron/following{/other_user}", "gists_url": "https://api.github.com/users/tetron/gists{/gist_id}", "starred_url": "https://api.github.com/users/tetron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tetron/subscriptions", "organizations_url": "https://api.github.com/users/tetron/orgs", "repos_url": "https://api.github.com/users/tetron/repos", "events_url": "https://api.github.com/users/tetron/events{/privacy}", "received_events_url": "https://api.github.com/users/tetron/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tetron", "id": 1316612, "node_id": "MDQ6VXNlcjEzMTY2MTI=", "avatar_url": "https://avatars3.githubusercontent.com/u/1316612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tetron", "html_url": "https://github.com/tetron", "followers_url": "https://api.github.com/users/tetron/followers", "following_url": "https://api.github.com/users/tetron/following{/other_user}", "gists_url": "https://api.github.com/users/tetron/gists{/gist_id}", "starred_url": "https://api.github.com/users/tetron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tetron/subscriptions", "organizations_url": "https://api.github.com/users/tetron/orgs", "repos_url": "https://api.github.com/users/tetron/repos", "events_url": "https://api.github.com/users/tetron/events{/privacy}", "received_events_url": "https://api.github.com/users/tetron/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-11-29T08:46:05Z", "updated_at": "2019-04-26T07:50:17Z", "closed_at": "2019-04-26T07:50:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi,\r\n\r\nI was working on integrating cwltool to [REANA](https://github.com/reanahub) and faced a problem when passing `--target` with workflow schema in json format.\r\n\r\nworkflow.json\r\n\r\n```\r\n{\r\n   \"cwlVersion\":\"v1.0\",\r\n   \"$graph\":[\r\n      {\r\n         \"inputs\":[\r\n            {\r\n               \"type\":\"File\",\r\n               \"id\":\"#fitdata.cwl/data\"\r\n            },\r\n            {\r\n               \"type\":\"File\",\r\n               \"id\":\"#fitdata.cwl/fitdata\"\r\n            },\r\n            {\r\n               \"default\":\"plot.png\",\r\n               \"type\":\"string\",\r\n               \"id\":\"#fitdata.cwl/outfile\"\r\n            }\r\n         ],\r\n         \"requirements\":[\r\n            {\r\n               \"dockerPull\":\"reanahub/reana-env-root6\",\r\n               \"class\":\"DockerRequirement\"\r\n            },\r\n            {\r\n               \"class\":\"InitialWorkDirRequirement\",\r\n               \"listing\":[\r\n                  \"$(inputs.fitdata)\",\r\n                  \"$(inputs.data)\"\r\n               ]\r\n            }\r\n         ],\r\n         \"stdout\":\"fitdata.log\",\r\n         \"outputs\":[\r\n            {\r\n               \"type\":\"stdout\",\r\n               \"id\":\"#fitdata.cwl/fitdata.log\"\r\n            },\r\n            {\r\n               \"outputBinding\":{\r\n                  \"glob\":\"$(inputs.outfile)\"\r\n               },\r\n               \"type\":\"File\",\r\n               \"id\":\"#fitdata.cwl/result\"\r\n            }\r\n         ],\r\n         \"baseCommand\":\"/bin/sh\",\r\n         \"class\":\"CommandLineTool\",\r\n         \"arguments\":[\r\n            {\r\n               \"prefix\":\"-c\",\r\n               \"valueFrom\":\"root -b -q '$(inputs.fitdata.basename)(\\\"$(inputs.data.basename)\\\",\\\"$(runtime.outdir)/$(inputs.outfile)\\\")'\\n\"\r\n            }\r\n         ],\r\n         \"id\":\"#fitdata.cwl\"\r\n      },\r\n      {\r\n         \"inputs\":[\r\n            {\r\n               \"type\":\"int\",\r\n               \"id\":\"#gendata.cwl/events\"\r\n            },\r\n            {\r\n               \"type\":\"File\",\r\n               \"id\":\"#gendata.cwl/gendata_tool\"\r\n            },\r\n            {\r\n               \"default\":\"data.root\",\r\n               \"type\":\"string\",\r\n               \"id\":\"#gendata.cwl/outfilename\"\r\n            }\r\n         ],\r\n         \"requirements\":[\r\n            {\r\n               \"dockerPull\":\"reanahub/reana-env-root6\",\r\n               \"class\":\"DockerRequirement\"\r\n            },\r\n            {\r\n               \"class\":\"InitialWorkDirRequirement\",\r\n               \"listing\":[\r\n                  \"$(inputs.gendata_tool)\"\r\n               ]\r\n            }\r\n         ],\r\n         \"stdout\":\"gendata.log\",\r\n         \"outputs\":[\r\n            {\r\n               \"outputBinding\":{\r\n                  \"glob\":\"$(inputs.outfilename)\"\r\n               },\r\n               \"type\":\"File\",\r\n               \"id\":\"#gendata.cwl/data\"\r\n            },\r\n            {\r\n               \"type\":\"stdout\",\r\n               \"id\":\"#gendata.cwl/gendata.log\"\r\n            }\r\n         ],\r\n         \"baseCommand\":\"/bin/sh\",\r\n         \"class\":\"CommandLineTool\",\r\n         \"arguments\":[\r\n            {\r\n               \"prefix\":\"-c\",\r\n               \"valueFrom\":\"root -b -q '$(inputs.gendata_tool.basename)($(inputs.events),\\\"$(runtime.outdir)/$(inputs.outfilename)\\\")'\\n\"\r\n            }\r\n         ],\r\n         \"id\":\"#gendata.cwl\"\r\n      },\r\n      {\r\n         \"inputs\":[\r\n            {\r\n               \"type\":\"int\",\r\n               \"id\":\"#main/events\"\r\n            },\r\n            {\r\n               \"type\":\"File\",\r\n               \"id\":\"#main/fitdata_tool\"\r\n            },\r\n            {\r\n               \"type\":\"File\",\r\n               \"id\":\"#main/gendata_tool\"\r\n            }\r\n         ],\r\n         \"steps\":[\r\n            {\r\n               \"out\":[\r\n                  \"#main/fitdata/result\",\r\n                  \"#main/fitdata/fitdata.log\"\r\n               ],\r\n               \"run\":\"#fitdata.cwl\",\r\n               \"id\":\"#main/fitdata\",\r\n               \"in\":[\r\n                  {\r\n                     \"source\":\"#main/gendata/data\",\r\n                     \"id\":\"#main/fitdata/data\"\r\n                  },\r\n                  {\r\n                     \"source\":\"#main/fitdata_tool\",\r\n                     \"id\":\"#main/fitdata/fitdata\"\r\n                  }\r\n               ]\r\n            },\r\n            {\r\n               \"out\":[\r\n                  \"#main/gendata/data\",\r\n                  \"#main/gendata/gendata.log\"\r\n               ],\r\n               \"run\":\"#gendata.cwl\",\r\n               \"id\":\"#main/gendata\",\r\n               \"in\":[\r\n                  {\r\n                     \"source\":\"#main/events\",\r\n                     \"id\":\"#main/gendata/events\"\r\n                  },\r\n                  {\r\n                     \"source\":\"#main/gendata_tool\",\r\n                     \"id\":\"#main/gendata/gendata_tool\"\r\n                  }\r\n               ]\r\n            }\r\n         ],\r\n         \"class\":\"Workflow\",\r\n         \"outputs\":[\r\n            {\r\n               \"type\":\"File\",\r\n               \"outputSource\":\"#main/fitdata/fitdata.log\",\r\n               \"id\":\"#main/fitdata.log\"\r\n            },\r\n            {\r\n               \"type\":\"File\",\r\n               \"outputSource\":\"#main/gendata/gendata.log\",\r\n               \"id\":\"#main/gendata.log\"\r\n            },\r\n            {\r\n               \"type\":\"File\",\r\n               \"outputSource\":\"#main/fitdata/result\",\r\n               \"id\":\"#main/plot\"\r\n            }\r\n         ],\r\n         \"id\":\"#main\"\r\n      }\r\n   ]\r\n}\r\n```\r\n\r\ninputs.json\r\n\r\n```\r\n{\r\n   \"fitdata_tool\":{\r\n      \"path\":\"code/fitdata.C\",\r\n      \"class\":\"File\"\r\n   },\r\n   \"events\":20000,\r\n   \"gendata_tool\":{\r\n      \"path\":\"code/gendata.C\",\r\n      \"class\":\"File\"\r\n   }\r\n}\r\n```\r\n\r\nReproducing error\r\n\r\n```\r\n$ cwltool --debug  --target gendata.log workflow.json inputs.json \r\n/Users/rokas/.virtualenvs/cwl/bin/cwltool 1.0.20181102182747\r\nResolved 'workflow.json' to 'file:///Users/rokas/reana-demo-root6-roofit/cwl-local-run/workflow.json'\r\nI'm sorry, I couldn't load this CWL file.\r\nThe error was: \r\nTraceback (most recent call last):\r\n  File \"/Users/rokas/.virtualenvs/cwl/lib/python2.7/site-packages/cwltool/main.py\", line 707, in main\r\n    tool)\r\n  File \"/Users/rokas/.virtualenvs/cwl/lib/python2.7/site-packages/cwltool/subgraph.py\", line 86, in get_subgraph\r\n    if nodes[r].type == OUTPUT:\r\nKeyError: u'file:///Users/rokas/reana-demo-root6-roofit/cwl-local-run/workflow.json#gendata.log'\r\n```\r\n\r\nIt works fine with with workflow in cwl.\r\n\r\n```\r\n$ cwltool --quiet  --target gendata.log ../workflow/cwl/workflow.cwl  input.yml \r\n{\r\n    \"gendata.log\": {\r\n        \"checksum\": \"sha1$dee4a5e8520d40d915e958a98be515b7355a6791\", \r\n        \"basename\": \"gendata.log\", \r\n        \"location\": \"file:///Users/rokas/reana-demo-root6-roofit/cwl-local-run/gendata.log\", \r\n        \"path\": \"/Users/rokas/reana-demo-root6-roofit/cwl-local-run/gendata.log\", \r\n        \"class\": \"File\", \r\n        \"size\": 2140\r\n    }\r\n}\r\n```\r\n\r\nExample code - https://github.com/reanahub/reana-demo-root6-roofit\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/989", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/989/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/989/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/989/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/989", "id": 385616361, "node_id": "MDU6SXNzdWUzODU2MTYzNjE=", "number": 989, "title": "mapSubject error needs fixing", "user": {"login": "ranijames", "id": 7900965, "node_id": "MDQ6VXNlcjc5MDA5NjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/7900965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ranijames", "html_url": "https://github.com/ranijames", "followers_url": "https://api.github.com/users/ranijames/followers", "following_url": "https://api.github.com/users/ranijames/following{/other_user}", "gists_url": "https://api.github.com/users/ranijames/gists{/gist_id}", "starred_url": "https://api.github.com/users/ranijames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ranijames/subscriptions", "organizations_url": "https://api.github.com/users/ranijames/orgs", "repos_url": "https://api.github.com/users/ranijames/repos", "events_url": "https://api.github.com/users/ranijames/events{/privacy}", "received_events_url": "https://api.github.com/users/ranijames/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-11-29T08:13:53Z", "updated_at": "2018-11-30T11:12:10Z", "closed_at": "2018-11-29T11:47:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello All, \r\n\r\nI have a CWL script which uses edit inplace for editing the results in the working directory, but the CWL.\r\n\r\n## Expected Behavior\r\nIt should run and give me the output\r\n## Actual Behavior\r\nit complains,\r\n\r\nDuplicate keys will become an error in future releases, and are errors\r\nby default when using the new API.\r\n\r\n  warnings.warn(DuplicateKeyFutureWarning(*args))\r\nTool definition failed validation:\r\n(\"mapSubject '%s' value '%s' is not a dictand does not have a mapPredicate\", '-class', None)\r\n## Workflow Code\r\n```\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\ndoc: Sp\r\n\r\nbaseCommand: [python,-m,spladder.spladder]\r\n\r\nhints:\r\n  cwltool:InplaceUpdateRequirement:\r\n    inplaceUpdate: true\r\nrequirements:\r\n  EnvVarRequirement:\r\n     envDef:\r\n       PYTHONPATH: /cluster/home/usr/spladder/python\r\n  -class: InlineJavascriptRequirement\r\n  -class: InitialWorkDirRequirement\r\n  listing: \r\n   - entry: $(inputs.spladder_dir)\r\n     writable: true\r\n\r\n\r\ninputs:\r\n spladder_gtf: \r\n  type: File\r\n  inputBinding:\r\n   position: 3\r\n   prefix: -a\r\n spladder_bams: \r\n  type: File[]\r\n  inputBinding:\r\n   position: 1\r\n   prefix: -b\r\n   itemSeparator: \",\"\r\n  secondaryFiles: .bai\r\n spladder_dir:\r\n  type: Directory\r\n  inputBinding:\r\n   position: 2\r\n   prefix: -o\r\n spladder_phase2:\r\n  type: string\r\n  inputBinding:\r\n   position: 4\r\n   prefix: -T\r\n spladder_merge_graphs:\r\n  type: string\r\n  inputBinding:\r\n    position: 5\r\n    prefix: -M\r\n spladder_qmode:\r\n  type: string\r\n  inputBinding:\r\n    position: 7\r\n    prefix: --qmode\r\n spladder_quantify_graph:\r\n  type: string\r\n  inputBinding:\r\n    position: 6\r\n    prefix: --quantify_graph\r\n\r\n\r\noutputs:\r\n spladder_out:\r\n  type: Directory\r\n  outputBinding:\r\n   glob: $(inputs.spladder_dir.basename)\r\n\r\n$namespaces:\r\n  cwltool: http://commonwl.org/cwltool#\r\n```\r\n\r\n## Full Traceback\r\n```\r\nfound duplicate key \"-class\" with value \"InitialWorkDirRequirement\" (original value: \"InlineJavascriptRequirement\")\r\n  in \"file:///cluster/home/aalva/Projects/PHRT-Immuno/scripts/cwl/spladder_part3.cwl\", line 15, column 3\r\n\r\nTo suppress this check see:\r\n    http://yaml.readthedocs.io/en/latest/api.html#duplicate-keys\r\n\r\nDuplicate keys will become an error in future releases, and are errors\r\nby default when using the new API.\r\n\r\n  warnings.warn(DuplicateKeyFutureWarning(*args))\r\nTool definition failed validation:\r\n(\"mapSubject '%s' value '%s' is not a dictand does not have a mapPredicate\", '-class', None)\r\nTraceback (most recent call last):\r\n  File \"/cluster/home/aalva/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/main.py\", line 657, in main\r\n    do_validate=loadingContext.do_validate)\r\n  File \"/cluster/home/aalva/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/load_tool.py\", line 284, in validate_document\r\n    workflowobj, fileuri, checklinks=do_validate)\r\n  File \"/cluster/home/aalva/software/anaconda/envs/py2/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 861, in resolve_all\r\n    self._resolve_idmap(document, loader)\r\n  File \"/cluster/home/aalva/software/anaconda/envs/py2/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 639, in _resolve_idmap\r\n    \"and does not have a mapPredicate\", k, v)\r\nValidationException: (\"mapSubject '%s' value '%s' is not a dictand does not have a mapPredicate\", '-class', None)\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\nCheck using ``cwltool v1.0``\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/955", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/955/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/955/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/955/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/955", "id": 373699328, "node_id": "MDU6SXNzdWUzNzM2OTkzMjg=", "number": 955, "title": "CWL throws JavascriptException:  error ", "user": {"login": "ranijames", "id": 7900965, "node_id": "MDQ6VXNlcjc5MDA5NjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/7900965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ranijames", "html_url": "https://github.com/ranijames", "followers_url": "https://api.github.com/users/ranijames/followers", "following_url": "https://api.github.com/users/ranijames/following{/other_user}", "gists_url": "https://api.github.com/users/ranijames/gists{/gist_id}", "starred_url": "https://api.github.com/users/ranijames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ranijames/subscriptions", "organizations_url": "https://api.github.com/users/ranijames/orgs", "repos_url": "https://api.github.com/users/ranijames/repos", "events_url": "https://api.github.com/users/ranijames/events{/privacy}", "received_events_url": "https://api.github.com/users/ranijames/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2018-10-24T22:17:52Z", "updated_at": "2018-10-29T12:09:22Z", "closed_at": "2018-10-29T12:09:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Dear All,\r\nI am running my CWL workflow on python 2.7 environment. \r\nI am trying to run couple python scripts, on BAM and tsv files. While I try to run my script. It is throwing following error. Following is the code. And I have all files suppiled in yml format\r\n\r\n## Workflow Code\r\n```\r\n#!/usr/bin/env cwl-runner\r\ncwlVersion: v1.0\r\nclass: Workflow\r\n\r\ndoc: \"Workflow Components: increment -> Spladder -> PeptidePackage\"\r\n\r\ninputs:\r\n incremnet_tsv:\r\n  type: File[]\r\n spladder_gtf:\r\n  type: File \r\n spladder_bams:\r\n  type: File[]\r\n spladder_outDir:\r\n  type: string\r\n spladder_phase2:\r\n  type: string\r\n donor:\r\n  type: string\r\n peptide_outDir:\r\n  type: string\r\n reference:\r\n  type: File\r\n\r\noutputs:\r\n increment_out:\r\n  type: File\r\n  outputSource: increment_count/increment_out\r\n spladder_out1:\r\n  type: Directory\r\n  outputSource: spladder/spladder_out_dir1\r\n spladder_out2:\r\n  type: Directory\r\n  outputSource: spladder/spladder_out_dir2\r\n peptide_out:\r\n  type: Directory\r\n  outputSource: peptide/peptideOutDir\r\n\r\nsteps:\r\n increment_count:\r\n  run: count_incrementally.cwl\r\n  in:\r\n   increment_out: increment_out\r\n  out: [increment_out]\r\n spladder:\r\n  run: spladder.cwl\r\n  in:\r\n   spladder_gtf: spladder_gtf\r\n   spladder_bams: spladder_bams\r\n   spladder_outDir: spladder_outDir\r\n   spladder_phase2: spladder_phase2\r\n  out: [spladder_out_dir1, spladder_out_dir2, spladderFile]\r\n peptide:\r\n  run: peptide_package.cwl\r\n  in:\r\n   donor: donor\r\n   peptide_outDir: peptide_outDir\r\n   spliceFile: spladder/spladderFile\r\n   annotation: spladder_gtf\r\n   reference: reference \r\n  out: [peptideOutDir]\r\n\r\n```\r\n\r\n## Full Traceback\r\n```\r\nValidation failed at\r\nTraceback (most recent call last):\r\n  File \"/cluster/home/aalva/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/workflow.py\", line 531, in __init__\r\n    loadingContext.prov_obj))\r\n  File \"/cluster/home/aalva/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/workflow.py\", line 689, in __init__\r\n    raise validate.ValidationException(\"\\n\".join(validation_errors))\r\nValidationException: ../cwl/pipeline_part2.cwl:44:9: Workflow step output 'increment_out' does not correspond to\r\n../cwl/count_incrementally.cwl:17:1:   tool output (expected 'incre_output')\r\nI'm sorry, I couldn't load this CWL file.\r\nThe error was: \r\nTraceback (most recent call last):\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/main.py\", line 673, in main\r\n    metadata, uri, loadingContext)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/load_tool.py\", line 346, in make_tool\r\n    tool = loadingContext.construct_tool_object(processobj, loadingContext)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/workflow.py\", line 54, in default_make_tool\r\n    return Workflow(toolpath_object, loadingContext)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/workflow.py\", line 531, in __init__\r\n    loadingContext.prov_obj))\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/workflow.py\", line 619, in __init__\r\n    toolpath_object[\"run\"], loadingContext)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/load_tool.py\", line 378, in load_tool\r\n    loadingContext)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/load_tool.py\", line 346, in make_tool\r\n    tool = loadingContext.construct_tool_object(processobj, loadingContext)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/workflow.py\", line 50, in default_make_tool\r\n    return command_line_tool.CommandLineTool(toolpath_object, loadingContext)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 229, in __init__\r\n    super(CommandLineTool, self).__init__(toolpath_object, loadingContext)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/process.py\", line 595, in __init__\r\n    validate_js_expressions(cast(CommentedMap, toolpath_object), self.doc_schema.names[toolpath_object[\"class\"]], validate_js_options)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/validate_js.py\", line 193, in validate_js_expressions\r\n    expression_errors, _ = jshint_js(code_fragment_js, js_globals, jshint_options)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/validate_js.py\", line 118, in jshint_js\r\n    context=jshint_functions_text\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/sandboxjs.py\", line 161, in exec_js_process\r\n    new_proc = new_js_proc(js_engine_code, force_docker_pull=force_docker_pull)\r\n  File \"/cluster/home/user/software/anaconda/envs/py2/lib/python2.7/site-packages/cwltool/sandboxjs.py\", line 110, in new_js_proc\r\n    u\"docker run node:slim\".format(u\", \".join(trynodes)))\r\nJavascriptException: cwltool requires Node.js engine to evaluate and validate Javascript expressions, but couldn't find it.  Tried nodejs, node, docker run node:slim\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: cwltool 1.0.20181012180214\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/952", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/952/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/952/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/952/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/952", "id": 372504797, "node_id": "MDU6SXNzdWUzNzI1MDQ3OTc=", "number": 952, "title": "Setuptools is out off date", "user": {"login": "mb1069", "id": 9156542, "node_id": "MDQ6VXNlcjkxNTY1NDI=", "avatar_url": "https://avatars1.githubusercontent.com/u/9156542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mb1069", "html_url": "https://github.com/mb1069", "followers_url": "https://api.github.com/users/mb1069/followers", "following_url": "https://api.github.com/users/mb1069/following{/other_user}", "gists_url": "https://api.github.com/users/mb1069/gists{/gist_id}", "starred_url": "https://api.github.com/users/mb1069/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mb1069/subscriptions", "organizations_url": "https://api.github.com/users/mb1069/orgs", "repos_url": "https://api.github.com/users/mb1069/repos", "events_url": "https://api.github.com/users/mb1069/events{/privacy}", "received_events_url": "https://api.github.com/users/mb1069/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-10-22T12:42:39Z", "updated_at": "2018-10-23T07:44:20Z", "closed_at": "2018-10-23T07:44:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I ran into the following error when trying to install directly from the cwltool repo:\r\n```\r\n(base) mdb-ml:wrapper mdb$ pip install  git+https://github.com/common-workflow-language/cwltool.git@measure_mem_usage\r\nCollecting git+https://github.com/common-workflow-language/cwltool.git@measure_mem_usage\r\n  Cloning https://github.com/common-workflow-language/cwltool.git (to revision measure_mem_usage) to /private/var/folders/ws/cf5jmmns74qb8cj5pmhvs_gjl5jrp6/T/pip-req-build-nqjsxuo9\r\nBranch measure_mem_usage set up to track remote branch measure_mem_usage from origin.\r\nSwitched to a new branch 'measure_mem_usage'\r\n    Complete output from command python setup.py egg_info:\r\n    running egg_info\r\n    Traceback (most recent call last):\r\n      File \"<string>\", line 1, in <module>\r\n      File \"/private/var/folders/ws/cf5jmmns74qb8cj5pmhvs_gjl5jrp6/T/pip-req-build-nqjsxuo9/setup.py\", line 111, in <module>\r\n        'Topic :: Utilities',\r\n      File \"/Users/mdb/miniconda3/lib/python3.6/site-packages/setuptools/__init__.py\", line 129, in setup\r\n        return distutils.core.setup(**attrs)\r\n      File \"/Users/mdb/miniconda3/lib/python3.6/distutils/core.py\", line 148, in setup\r\n        dist.run_commands()\r\n      File \"/Users/mdb/miniconda3/lib/python3.6/distutils/dist.py\", line 955, in run_commands\r\n        self.run_command(cmd)\r\n      File \"/Users/mdb/miniconda3/lib/python3.6/distutils/dist.py\", line 972, in run_command\r\n        cmd_obj = self.get_command_obj(command)\r\n      File \"/Users/mdb/miniconda3/lib/python3.6/distutils/dist.py\", line 847, in get_command_obj\r\n        cmd_obj = self.command_obj[command] = klass(self)\r\n      File \"/Users/mdb/miniconda3/lib/python3.6/site-packages/setuptools/__init__.py\", line 147, in __init__\r\n        _Command.__init__(self, dist)\r\n      File \"/Users/mdb/miniconda3/lib/python3.6/distutils/cmd.py\", line 62, in __init__\r\n        self.initialize_options()\r\n      File \"/Users/mdb/miniconda3/lib/python3.6/site-packages/setuptools/command/egg_info.py\", line 143, in initialize_options\r\n        self.vtags = None\r\n    AttributeError: can't set attribute\r\n    \r\n    ----------------------------------------\r\nCommand \"python setup.py egg_info\" failed with error code 1 in /private/var/folders/ws/cf5jmmns74qb8cj5pmhvs_gjl5jrp6/T/pip-req-build-nqjsxuo9/", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/940", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/940/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/940/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/940/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/940", "id": 368558772, "node_id": "MDU6SXNzdWUzNjg1NTg3NzI=", "number": 940, "title": "Cwltool crashes when reading empty json input file from stdin", "user": {"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-10-10T08:54:11Z", "updated_at": "2018-10-24T11:37:39Z", "closed_at": "2018-10-24T11:37:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The code in main.py doesn't take into account this rare edge-case.\r\n\r\nThe crash in particular is because value of an object is not compared correctly against None:\r\n\r\n```\r\necho '{}' | cwltool --debug https://www.ebi.ac.uk/~eduardo/my_workflow_1539097640017.cwl -\r\n/home/psafont/.local/etc/virtualenvs/cwltool/bin/cwltool 1.0.20180923172926\r\nI'm sorry, I couldn't load this CWL file.\r\nThe error was: \r\nTraceback (most recent call last):\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/cwltool/main.py\", line 567, in main\r\n    loadingContext.overrides_list, tool_file_uri)\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/cwltool/main.py\", line 245, in load_job_order\r\n    elif job_order_file:\r\nUnboundLocalError: local variable 'job_order_file' referenced before assignment\r\n```\r\n\r\nWhen those comparisons get fixed:\r\n\r\n```\r\n$ echo '{}' | cwltool --non-strict --debug https://www.ebi.ac.uk/~eduardo/my_workflow_1539097640017.cwl -\r\n/home/psafont/.local/etc/virtualenvs/cwltool/bin/cwltool 1.0.20180923172926\r\n\r\n[...]\r\n\r\n[Errno 2] No such file or directory: '/home/psafont/dev/ops/configuration/tools/workflow-service/-'\r\nTraceback (most recent call last):\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 149, in fetch_text\r\n    with open(urllib.request.url2pathname(str(path)), encoding='utf-8') as fp:\r\nFileNotFoundError: [Errno 2] No such file or directory: '/home/psafont/dev/ops/configuration/tools/workflow-service/-'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 575, in resolve_ref\r\n    doc = self.fetch(doc_url, inject_ids=(not mixin))\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 927, in fetch\r\n    text = self.fetch_text(url)\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 154, in fetch_text\r\n    raise RuntimeError(Text(err))\r\nRuntimeError: [Errno 2] No such file or directory: '/home/psafont/dev/ops/configuration/tools/workflow-service/-'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/cwltool/main.py\", line 296, in init_job_order\r\n    MutableMapping, loader.resolve_ref(cmd_line[\"job_order\"])[0])\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 575, in resolve_ref\r\n    doc = self.fetch(doc_url, inject_ids=(not mixin))\r\n  File \"/home/psafont/.local/etc/virtualenvs/cwltool/lib/python3.6/site-packages/schema_salad/sourceline.py\", line 168, in __exit__\r\n    raise self.makeError(six.text_type(exc_value))\r\nRuntimeError: [Errno 2] No such file or directory: '/home/psafont/dev/ops/configuration/tools/workflow-service/-'\r\n```\r\n\r\nNote that this invocation should be functionally equivalent to `cwltool --non-strict https://www.ebi.ac.uk/~eduardo/my_workflow_1539097640017.cwl`, which actually works", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/934", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/934/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/934/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/934/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/934", "id": 366822708, "node_id": "MDU6SXNzdWUzNjY4MjI3MDg=", "number": 934, "title": "UnsupportedRequirement: Singularity implementation does not support custom networking", "user": {"login": "gijzelaerr", "id": 326308, "node_id": "MDQ6VXNlcjMyNjMwOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/326308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gijzelaerr", "html_url": "https://github.com/gijzelaerr", "followers_url": "https://api.github.com/users/gijzelaerr/followers", "following_url": "https://api.github.com/users/gijzelaerr/following{/other_user}", "gists_url": "https://api.github.com/users/gijzelaerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gijzelaerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gijzelaerr/subscriptions", "organizations_url": "https://api.github.com/users/gijzelaerr/orgs", "repos_url": "https://api.github.com/users/gijzelaerr/repos", "events_url": "https://api.github.com/users/gijzelaerr/events{/privacy}", "received_events_url": "https://api.github.com/users/gijzelaerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-10-04T14:38:39Z", "updated_at": "2018-10-04T14:59:22Z", "closed_at": "2018-10-04T14:59:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I get this error when I run my pipeline with singularity enabled.\r\n\r\nfull log:  https://gist.github.com/gijzelaerr/1e0b3e3743317538ae47ef4f022d4b7d\r\ncommand:\r\n```\r\n$ toil-cwl-runner \\                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \r\n        --singularity \\                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \r\n        --logFile /home/gijs/Work/presto-cwl/runs/run_2018-10-04-16-33-51/log \\                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \r\n        --outdir /home/gijs/Work/presto-cwl/runs/run_2018-10-04-16-33-51/results \\                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \r\n        --jobStore file:///home/gijs/Work/presto-cwl/runs/run_2018-10-04-16-33-51/job_store \\                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \r\n        presto.cwl \\                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \r\n        demo_job.yaml\r\n```\r\n\r\npipeline: https://github.com/EOSC-LOFAR/presto-cwl\r\n\r\ntoil==3.18.0\r\ncwltool==1.0.20180820141117\r\nubuntu 18.04\r\nsingularity 2.6\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/928", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/928/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/928/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/928/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/928", "id": 365916055, "node_id": "MDU6SXNzdWUzNjU5MTYwNTU=", "number": 928, "title": "improve error message for supplying random file as the input object", "user": {"login": "gijzelaerr", "id": 326308, "node_id": "MDQ6VXNlcjMyNjMwOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/326308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gijzelaerr", "html_url": "https://github.com/gijzelaerr", "followers_url": "https://api.github.com/users/gijzelaerr/followers", "following_url": "https://api.github.com/users/gijzelaerr/following{/other_user}", "gists_url": "https://api.github.com/users/gijzelaerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gijzelaerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gijzelaerr/subscriptions", "organizations_url": "https://api.github.com/users/gijzelaerr/orgs", "repos_url": "https://api.github.com/users/gijzelaerr/repos", "events_url": "https://api.github.com/users/gijzelaerr/events{/privacy}", "received_events_url": "https://api.github.com/users/gijzelaerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-10-02T14:09:38Z", "updated_at": "2018-10-04T11:53:33Z", "closed_at": "2018-10-04T11:53:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "when trying out https://github.com/common-workflow-language/workflow-service/blob/master/testdata/md5sum.cwl\r\n```\r\n$ cwl-runner --debug ./md5sum.cwl md5sum.input\r\n../.venv2/bin/cwl-runner 1.0.20180518123035\r\nResolved './md5sum.cwl' to 'file:///home/gijs/Work/workflow-service/testdata/md5sum.cwl'\r\nWorkflow error, try again with --debug for more information:\r\nInvalid job input record:\r\nmd5sum.cwl:5:3: Traceback (most recent call last):\r\n                \r\n                  File\r\n                  \"/home/gijs/Work/workflow-service/.venv2/local/lib/python2.7/site-packages/cwltool/process.py\",\r\n                  line 358, in fillInDefaults\r\n                    if job.get(fieldname) is not None:\r\n                \r\n                AttributeError: 'str' object has no attribute 'get'\r\nTraceback (most recent call last):\r\n  File \"/home/gijs/Work/workflow-service/.venv2/local/lib/python2.7/site-packages/cwltool/main.py\", line 592, in main\r\n    **vars(args))\r\n  File \"/home/gijs/Work/workflow-service/.venv2/local/lib/python2.7/site-packages/cwltool/executors.py\", line 31, in __call__\r\n    return self.execute(*args, **kwargs)\r\n  File \"/home/gijs/Work/workflow-service/.venv2/local/lib/python2.7/site-packages/cwltool/executors.py\", line 71, in execute\r\n    self.run_jobs(t, job_order_object, logger, **kwargs)\r\n  File \"/home/gijs/Work/workflow-service/.venv2/local/lib/python2.7/site-packages/cwltool/executors.py\", line 100, in run_jobs\r\n    for r in jobiter:\r\n  File \"/home/gijs/Work/workflow-service/.venv2/local/lib/python2.7/site-packages/cwltool/workflow.py\", line 463, in job\r\n    builder = self._init_job(job_order, **kwargs)\r\n  File \"/home/gijs/Work/workflow-service/.venv2/local/lib/python2.7/site-packages/cwltool/process.py\", line 592, in _init_job\r\n    raise WorkflowException(\"Invalid job input record:\\n\" + Text(e))\r\nWorkflowException: Invalid job input record:\r\nmd5sum.cwl:5:3: Traceback (most recent call last):\r\nmd5sum.cwl:5:3: \r\nmd5sum.cwl:5:3:   File \"/home/gijs/Work/workflow-service/.venv2/local/lib/python2.7/site-packages/cwltool/process.py\", line 358, in fillInDefaults\r\nmd5sum.cwl:5:3:     if job.get(fieldname) is not None:\r\nmd5sum.cwl:5:3: \r\nmd5sum.cwl:5:3: AttributeError: 'str' object has no attribute 'get'\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/910", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/910/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/910/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/910/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/910", "id": 361819290, "node_id": "MDU6SXNzdWUzNjE4MTkyOTA=", "number": 910, "title": "cwltool relocateOutputs 'move' action for type Directory output", "user": {"login": "carcassona", "id": 36433055, "node_id": "MDQ6VXNlcjM2NDMzMDU1", "avatar_url": "https://avatars0.githubusercontent.com/u/36433055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carcassona", "html_url": "https://github.com/carcassona", "followers_url": "https://api.github.com/users/carcassona/followers", "following_url": "https://api.github.com/users/carcassona/following{/other_user}", "gists_url": "https://api.github.com/users/carcassona/gists{/gist_id}", "starred_url": "https://api.github.com/users/carcassona/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carcassona/subscriptions", "organizations_url": "https://api.github.com/users/carcassona/orgs", "repos_url": "https://api.github.com/users/carcassona/repos", "events_url": "https://api.github.com/users/carcassona/events{/privacy}", "received_events_url": "https://api.github.com/users/carcassona/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-19T16:03:38Z", "updated_at": "2018-10-01T14:06:27Z", "closed_at": "2018-10-01T14:06:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\n relocateFunction moves src directory into dst directoy\r\n\r\n## Actual Behavior\r\n CRASH\r\n\r\n## Workflow Code\r\n```\r\ncwlVersion: v1.0\r\nclass: ExpressionTool\r\n\r\nrequirements:\r\n  - class: InlineJavascriptRequirement\r\n\r\nid: \"files_to_folder\"\r\ninputs:\r\n  input_files:\r\n    type:\r\n    - File[]\r\n    - File\r\noutputs:\r\n  folder: Directory\r\nexpression: |\r\n  ${\r\n    var folder = {\r\n      \"class\": \"Directory\",\r\n      \"basename\": \"\",\r\n      \"listing\": []\r\n    }\r\n    var files = [];\r\n    if (!Array.isArray(inputs.input_files)){\r\n      files.push (inputs.input_files)\r\n    } else {\r\n      files = inputs.input_files\r\n    }\r\n    for (var i = 0; i < files.length; i++){\r\n      if (files[i].secondaryFiles && files[i].secondaryFiles.length > 0){\r\n        Array.prototype.push.apply(folder.listing, files[i].secondaryFiles);\r\n        delete files[i].secondaryFiles;\r\n      }\r\n      folder.listing.push (files[i])\r\n    }\r\n    return { \"folder\": folder };\r\n  }\r\n\r\ndoc: |\r\n  Returns Directory object with a listing set from File or File[]. Only one nested level of secondaryFiles\r\n  is supported\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\n[2018-09-19 09:43:43,806] {base_task_runner.py:107} INFO - Job 138: Subtask CWLJobGatherer [2018-09-19 09:43:43,806] {cli.py:492} INFO - Running <TaskInstance: bowtie-index.CWLJobGatherer 2018-09-19T0\r\n[2018-09-19 09:43:43,826] {models.py:1736} ERROR - 'posix.DirEntry' object has no attribute 'startswith'                                                                                                \r\nTraceback (most recent call last):                                                                                                                                                                      \r\n  File \"/usr/local/lib/python3.6/site-packages/airflow/models.py\", line 1633, in _run_raw_task                                                                                                          \r\n    result = task_copy.execute(context=context)                                                                                                                                                         \r\n  File \"/usr/local/lib/python3.6/site-packages/cwl_airflow_parser/operators/cwljobgatherer.py\", line 109, in execute                                                                                    \r\n    return self.cwl_gather(context)                                                                                                                                                                     \r\n  File \"/usr/local/lib/python3.6/site-packages/cwl_airflow_parser/operators/cwljobgatherer.py\", line 92, in cwl_gather                                                                                  \r\n    StdFsAccess(\"\"))                                                                                                                                                                                    \r\n  File \"/usr/local/lib/python3.6/site-packages/cwltool/process.py\", line 327, in relocateOutputs                                                                                                        \r\n    stageFiles(pm, stageFunc=_relocate, symLink=False)                                                                                                                                                  \r\n  File \"/usr/local/lib/python3.6/site-packages/cwltool/process.py\", line 249, in stageFiles                                                                                                             \r\n    stageFunc(p.resolved, p.target)                                                                                                                                                                     \r\n  File \"/usr/local/lib/python3.6/site-packages/cwltool/process.py\", line 310, in _relocate                                                                                                              \r\n    _relocate(dir_entry, os.path.join(dst, dir_entry.name))                                                                                                                                             \r\n  File \"/usr/local/lib/python3.6/site-packages/cwltool/process.py\", line 305, in _relocate                                                                                                              \r\n    if any(src.startswith(path + \"/\") for path in source_directories):                                                                                                                                  \r\n  File \"/usr/local/lib/python3.6/site-packages/cwltool/process.py\", line 305, in <genexpr>                                                                                                              \r\n    if any(src.startswith(path + \"/\") for path in source_directories):                                                                                                                                  \r\nAttributeError: 'posix.DirEntry' object has no attribute 'startswith'                                                                                                                                   \r\n[2018-09-19 09:43:43,828] {models.py:1756} INFO - Marking task as UP_FOR_RETRY       \r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180912090223\r\nCheck using ``cwltool --version``\r\n\r\n## Code with issue proccess.py line 302\r\n\r\n```\r\n        if action == \"move\":\r\n            # do not move anything if we are trying to move an entity from\r\n            # outside of the source directories\r\n            if any(src.startswith(path + \"/\") for path in source_directories):\r\n                _logger.debug(\"Moving %s to %s\", src, dst)\r\n                if os.path.isdir(src) and os.path.isdir(dst):\r\n                    # merge directories\r\n                    for dir_entry in scandir(src):\r\n                        _relocate(dir_entry, os.path.join(dst, dir_entry.name))\r\n                else:\r\n                    shutil.move(src, dst)\r\n                    return\r\n\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/909", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/909/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/909/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/909/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/909", "id": 361410933, "node_id": "MDU6SXNzdWUzNjE0MTA5MzM=", "number": 909, "title": "schema_salad.validate.ValidationException when subworkflow contains SchemaDefRequirement", "user": {"login": "jeremiahsavage", "id": 1272057, "node_id": "MDQ6VXNlcjEyNzIwNTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1272057?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeremiahsavage", "html_url": "https://github.com/jeremiahsavage", "followers_url": "https://api.github.com/users/jeremiahsavage/followers", "following_url": "https://api.github.com/users/jeremiahsavage/following{/other_user}", "gists_url": "https://api.github.com/users/jeremiahsavage/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeremiahsavage/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeremiahsavage/subscriptions", "organizations_url": "https://api.github.com/users/jeremiahsavage/orgs", "repos_url": "https://api.github.com/users/jeremiahsavage/repos", "events_url": "https://api.github.com/users/jeremiahsavage/events{/privacy}", "received_events_url": "https://api.github.com/users/jeremiahsavage/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-18T17:40:49Z", "updated_at": "2018-10-23T18:12:45Z", "closed_at": "2018-10-23T18:07:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The most recent release (1.0.20180912090223) of cwltool fails on the below workflow, while the prior release (1.0.20180906112546) succeeds.\r\n\r\n1.0.20180912090223:\r\n```\r\n$ git clone https://github.com/jeremiahsavage/cwl-schemadef-subworkflow.git\r\n$ cd cwl-schemadef-subworkflow\r\n$ cwltool --debug transform.cwl transform.yml\r\n/home/jeremiah/.virtualenvs/cwl20180912090223/bin/cwltool 1.0.20180912090223\r\nResolved 'transform.cwl' to 'file:///home/jeremiah/cwl-schemadef-subworkflow/transform.cwl'\r\nValidation exception\r\nTraceback (most recent call last):\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/workflow.py\", line 619, in __init__\r\n    toolpath_object[\"run\"], loadingContext)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/load_tool.py\", line 372, in load_tool\r\n    metadata=loadingContext.metadata)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/load_tool.py\", line 284, in validate_document\r\n    workflowobj, fileuri, checklinks=do_validate)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 919, in resolve_all\r\n    self.validate_links(document, u\"\", all_doc_ids)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 1091, in validate_links\r\n    raise errors[0]\r\nschema_salad.validate.ValidationException: fastq_clean_pe.cwl:5:1: checking field `requirements`\r\nfastq_clean_pe.cwl:7:5:   checking item\r\nfastq_clean_pe.cwl:8:5:     checking field `types`\r\nfastq_clean_pe.cwl:9:9:       checking object `readgroup_meta_type`\r\nreadgroup.yml:3:5:         checking field `fields`\r\nreadgroup.yml:3:5:           checking object `DS`\r\nreadgroup.yml:7:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `DT`\r\nreadgroup.yml:9:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `FO`\r\nreadgroup.yml:11:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `KS`\r\nreadgroup.yml:15:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `PI`\r\nreadgroup.yml:19:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `PM`\r\nreadgroup.yml:23:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `PU`\r\nreadgroup.yml:25:9:             `type` field is list, expected string, list, or a dict.\r\nfastq_clean_pe.cwl:9:9:       checking object `readgroup_fastq_pe_file`\r\nreadgroup.yml:31:5:         checking field `fields`\r\nreadgroup.yml:31:5:           checking object `readgroup_meta_pe_file`\r\nreadgroup.yml:37:9:             Field `type` references unknown identifier `readgroup_meta_type`, tried readgroup_meta_pe_file#readgroup_meta_type\r\nTool definition failed initialization:\r\nTool definition file:///home/jeremiah/cwl-schemadef-subworkflow/fastq_clean_pe.cwl failed validation:\r\nfastq_clean_pe.cwl:5:1:   checking field `requirements`\r\nfastq_clean_pe.cwl:7:5:     checking item\r\nfastq_clean_pe.cwl:8:5:       checking field `types`\r\nfastq_clean_pe.cwl:9:9:         checking object `readgroup_meta_type`\r\nreadgroup.yml:3:5:           checking field `fields`\r\nreadgroup.yml:3:5:             checking object `DS`\r\nreadgroup.yml:7:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `DT`\r\nreadgroup.yml:9:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `FO`\r\nreadgroup.yml:11:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `KS`\r\nreadgroup.yml:15:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `PI`\r\nreadgroup.yml:19:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `PM`\r\nreadgroup.yml:23:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `PU`\r\nreadgroup.yml:25:9:               `type` field is list, expected string, list, or a dict.\r\nfastq_clean_pe.cwl:9:9:         checking object `readgroup_fastq_pe_file`\r\nreadgroup.yml:31:5:           checking field `fields`\r\nreadgroup.yml:31:5:             checking object `readgroup_meta_pe_file`\r\nreadgroup.yml:37:9:               Field `type` references unknown identifier `readgroup_meta_type`, tried readgroup_meta_pe_file#readgroup_meta_type\r\nTraceback (most recent call last):\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/workflow.py\", line 619, in __init__\r\n    toolpath_object[\"run\"], loadingContext)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/load_tool.py\", line 372, in load_tool\r\n    metadata=loadingContext.metadata)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/load_tool.py\", line 284, in validate_document\r\n    workflowobj, fileuri, checklinks=do_validate)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 919, in resolve_all\r\n    self.validate_links(document, u\"\", all_doc_ids)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/schema_salad/ref_resolver.py\", line 1091, in validate_links\r\n    raise errors[0]\r\nschema_salad.validate.ValidationException: fastq_clean_pe.cwl:5:1: checking field `requirements`\r\nfastq_clean_pe.cwl:7:5:   checking item\r\nfastq_clean_pe.cwl:8:5:     checking field `types`\r\nfastq_clean_pe.cwl:9:9:       checking object `readgroup_meta_type`\r\nreadgroup.yml:3:5:         checking field `fields`\r\nreadgroup.yml:3:5:           checking object `DS`\r\nreadgroup.yml:7:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `DT`\r\nreadgroup.yml:9:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `FO`\r\nreadgroup.yml:11:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `KS`\r\nreadgroup.yml:15:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `PI`\r\nreadgroup.yml:19:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `PM`\r\nreadgroup.yml:23:9:             `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:           checking object `PU`\r\nreadgroup.yml:25:9:             `type` field is list, expected string, list, or a dict.\r\nfastq_clean_pe.cwl:9:9:       checking object `readgroup_fastq_pe_file`\r\nreadgroup.yml:31:5:         checking field `fields`\r\nreadgroup.yml:31:5:           checking object `readgroup_meta_pe_file`\r\nreadgroup.yml:37:9:             Field `type` references unknown identifier `readgroup_meta_type`, tried readgroup_meta_pe_file#readgroup_meta_type\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/main.py\", line 605, in main\r\n    metadata, uri, loadingContext)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/load_tool.py\", line 346, in make_tool\r\n    tool = loadingContext.construct_tool_object(processobj, loadingContext)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/workflow.py\", line 54, in default_make_tool\r\n    return Workflow(toolpath_object, loadingContext)\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/workflow.py\", line 531, in __init__\r\n    loadingContext.prov_obj))\r\n  File \"/home/jeremiah/.virtualenvs/cwl20180912090223/lib/python3.6/site-packages/cwltool/workflow.py\", line 625, in __init__\r\n    (toolpath_object[\"run\"], validate.indent(str(vexc))))\r\ncwltool.errors.WorkflowException: Tool definition file:///home/jeremiah/cwl-schemadef-subworkflow/fastq_clean_pe.cwl failed validation:\r\nfastq_clean_pe.cwl:5:1:   checking field `requirements`\r\nfastq_clean_pe.cwl:7:5:     checking item\r\nfastq_clean_pe.cwl:8:5:       checking field `types`\r\nfastq_clean_pe.cwl:9:9:         checking object `readgroup_meta_type`\r\nreadgroup.yml:3:5:           checking field `fields`\r\nreadgroup.yml:3:5:             checking object `DS`\r\nreadgroup.yml:7:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `DT`\r\nreadgroup.yml:9:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `FO`\r\nreadgroup.yml:11:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `KS`\r\nreadgroup.yml:15:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `PI`\r\nreadgroup.yml:19:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `PM`\r\nreadgroup.yml:23:9:               `type` field is list, expected string, list, or a dict.\r\nreadgroup.yml:3:5:             checking object `PU`\r\nreadgroup.yml:25:9:               `type` field is list, expected string, list, or a dict.\r\nfastq_clean_pe.cwl:9:9:         checking object `readgroup_fastq_pe_file`\r\nreadgroup.yml:31:5:           checking field `fields`\r\nreadgroup.yml:31:5:             checking object `readgroup_meta_pe_file`\r\nreadgroup.yml:37:9:               Field `type` references unknown identifier `readgroup_meta_type`, tried readgroup_meta_pe_file#readgroup_meta_type\r\n(cwl20180912090223) [jeremiah@localhost cwl-schemadef-subworkflow]$ \r\n```\r\n\r\n1.0.20180906112546:\r\n```\r\n$ cwltool transform.cwl transform.yml \r\n/home/jeremiah/.virtualenvs/cwl20180906112546/bin/cwltool 1.0.20180906112546\r\nResolved 'transform.cwl' to 'file:///home/jeremiah/cwl-schemadef-subworkflow/transform.cwl'\r\n[workflow ] start\r\n[workflow ] starting step fastq_clean_pe\r\n[step fastq_clean_pe] start\r\n[workflow fastq_clean_pe] start\r\n[workflow fastq_clean_pe] starting step fastq_cleaner_pe\r\n[step fastq_cleaner_pe] start\r\n['docker', 'pull', 'alpine']\r\nUsing default tag: latest\r\nTrying to pull repository docker.io/library/alpine ... \r\nsha256:621c2f39f8133acb8e64023a94dbdf0d5ca81896102b9e57c0dc184cadaf5528: Pulling from docker.io/library/alpine\r\nDigest: sha256:621c2f39f8133acb8e64023a94dbdf0d5ca81896102b9e57c0dc184cadaf5528\r\nStatus: Image is up to date for docker.io/alpine:latest\r\n[job fastq_cleaner_pe] /tmp/tmp7lwn0_kc$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/tmp/tmp7lwn0_kc:/var/spool/cwl:rw \\\r\n    --volume=/tmp/tmpoxltf5zu:/tmp:rw \\\r\n    --volume=/home/jeremiah/cwl-schemadef-subworkflow/L001_R1_001.fastq.gz:/var/lib/cwl/stgd7d52eab-c4c3-4fdb-b402-5e6695e7251a/L001_R1_001.fastq.gz:ro \\\r\n    --volume=/home/jeremiah/cwl-schemadef-subworkflow/L001_R2_001.fastq.gz:/var/lib/cwl/stg7674ce9c-378b-4dad-8190-4fd1b3105e3f/L001_R2_001.fastq.gz:ro \\\r\n    --workdir=/var/spool/cwl \\\r\n    --read-only=true \\\r\n    --user=1000:1000 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/var/spool/cwl \\\r\n    alpine \\\r\n    touch \\\r\n    fastq1 \\\r\n    fastq2\r\n[job fastq_cleaner_pe] completed success\r\n[step fastq_cleaner_pe] completed success\r\n[workflow fastq_clean_pe] completed success\r\n[step fastq_clean_pe] completed success\r\n[workflow ] completed success\r\n{}\r\nFinal process status is success\r\n$ \r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/908", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/908/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/908/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/908/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/908", "id": 360833786, "node_id": "MDU6SXNzdWUzNjA4MzM3ODY=", "number": 908, "title": "Explicitly defined empty scatter in workflow step fails validation without ScatterFeatureRequirement", "user": {"login": "AleksandrSl", "id": 15820496, "node_id": "MDQ6VXNlcjE1ODIwNDk2", "avatar_url": "https://avatars0.githubusercontent.com/u/15820496?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AleksandrSl", "html_url": "https://github.com/AleksandrSl", "followers_url": "https://api.github.com/users/AleksandrSl/followers", "following_url": "https://api.github.com/users/AleksandrSl/following{/other_user}", "gists_url": "https://api.github.com/users/AleksandrSl/gists{/gist_id}", "starred_url": "https://api.github.com/users/AleksandrSl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AleksandrSl/subscriptions", "organizations_url": "https://api.github.com/users/AleksandrSl/orgs", "repos_url": "https://api.github.com/users/AleksandrSl/repos", "events_url": "https://api.github.com/users/AleksandrSl/events{/privacy}", "received_events_url": "https://api.github.com/users/AleksandrSl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-17T11:54:24Z", "updated_at": "2018-09-18T07:43:29Z", "closed_at": "2018-09-18T07:42:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nResolved 'example.cwl' to 'file:///home/experimental/example.cwl'\r\nexample.cwl is valid CWL.\r\n\r\n## Actual Behavior\r\nResolved 'example.cwl' to 'file:///home/experimental/example.cwl'\r\nTool definition failed initialization:\r\nWorkflow contains scatter but ScatterFeatureRequirement not in requirements\r\n\r\n## Workflow Code\r\n```\r\nclass: \"Workflow\"\r\ncwlVersion: \"v1.0\"\r\nhints: []\r\ninputs:\r\n  - doc: []\r\n    format: []\r\n    id: \"input_reads_forward\"\r\n    secondaryFiles: []\r\n    streamable: false\r\n    type: \"File\"\r\noutputs: []\r\nrequirements: []\r\nsteps:\r\n  - id: \"first\"\r\n    in:\r\n      - id: \"input_reads_forward\"\r\n        source:\r\n          - \"input_reads_forward\"\r\n    out:\r\n      - id: \"output\"\r\n    run: \"required.cwl\"\r\n    scatter: []  # this one causes problem\r\n```\r\n\r\n## Your Environment\r\n* cwltool version:  1.0.20180912090223\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/907", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/907/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/907/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/907/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/907", "id": 360447103, "node_id": "MDU6SXNzdWUzNjA0NDcxMDM=", "number": 907, "title": "Error when workflow calls tool w/custom type twice", "user": {"login": "johnbradley", "id": 1024463, "node_id": "MDQ6VXNlcjEwMjQ0NjM=", "avatar_url": "https://avatars1.githubusercontent.com/u/1024463?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johnbradley", "html_url": "https://github.com/johnbradley", "followers_url": "https://api.github.com/users/johnbradley/followers", "following_url": "https://api.github.com/users/johnbradley/following{/other_user}", "gists_url": "https://api.github.com/users/johnbradley/gists{/gist_id}", "starred_url": "https://api.github.com/users/johnbradley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johnbradley/subscriptions", "organizations_url": "https://api.github.com/users/johnbradley/orgs", "repos_url": "https://api.github.com/users/johnbradley/repos", "events_url": "https://api.github.com/users/johnbradley/events{/privacy}", "received_events_url": "https://api.github.com/users/johnbradley/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-09-14T20:38:27Z", "updated_at": "2018-09-24T05:57:28Z", "closed_at": "2018-09-24T05:57:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected Behavior\r\nUsers should be able to validate/run workflows that use tools with custom types.\r\n\r\n## Actual Behavior\r\nRunning command: \r\n```\r\ncwltool --validate myworkflow.cwl\r\n```\r\nResults in this error:\r\n```\r\nI'm sorry, I couldn't load this CWL file, try again with --debug for more information.\r\nThe error was: Expected CommentedMap or CommentedSeq, got <type 'list'>: \r\n`[u'file:///private/tmp/bugtest/mytypes.yml#table_type/item1', \r\nu'file:///private/tmp/bugtest/mytypes.yml#table_type/item2']`\r\n```\r\n\r\n## Workflow Code\r\nFile: `myworkflow.yml`\r\n```\r\ncwlVersion: v1.0\r\nclass: Workflow\r\nrequirements:\r\n  - $import: mytypes.yml\r\ninputs:\r\n  table_type:\r\n    type: mytypes.yml#table_type\r\noutputs: []\r\nsteps:\r\n  first_time:\r\n    run: mytool.cwl\r\n    in:\r\n      table_type: table_type\r\n    out: []\r\n  second_time:\r\n    run: mytool.cwl\r\n    in:\r\n      table_type: table_type\r\n    out: []\r\n```\r\n\r\n## Tool Code\r\nFile: `mytool.yml`\r\n```\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nbaseCommand: echo\r\nrequirements:\r\n  - $import: mytypes.yml\r\ninputs:\r\n  table_type:\r\n    type: mytypes.yml#table_type\r\noutputs: []\r\n```\r\n\r\n## Custom Types\r\nFile: `mytypes.yml`\r\n```\r\nclass: SchemaDefRequirement\r\ntypes:\r\n  - name: table_type\r\n    type: enum\r\n    symbols:\r\n      - item1\r\n      - item2\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\nTraceback (most recent call last):\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/cwltool/main.py\", line 605, in main\r\n    metadata, uri, loadingContext)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/cwltool/load_tool.py\", line 346, in make_tool\r\n    tool = loadingContext.construct_tool_object(processobj, loadingContext)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/cwltool/workflow.py\", line 54, in default_make_tool\r\n    return Workflow(toolpath_object, loadingContext)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/cwltool/workflow.py\", line 531, in __init__\r\n    loadingContext.prov_obj))\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/cwltool/workflow.py\", line 619, in __init__\r\n    toolpath_object[\"run\"], loadingContext)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/cwltool/load_tool.py\", line 372, in load_tool\r\n    metadata=loadingContext.metadata)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/cwltool/load_tool.py\", line 284, in validate_document\r\n    workflowobj, fileuri, checklinks=do_validate)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 873, in resolve_all\r\n    val, base_url+subscope, file_base=file_base, checklinks=False)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 903, in resolve_all\r\n    val, base_url, file_base=file_base, checklinks=False)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 873, in resolve_all\r\n    val, base_url+subscope, file_base=file_base, checklinks=False)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 903, in resolve_all\r\n    val, base_url, file_base=file_base, checklinks=False)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 873, in resolve_all\r\n    val, base_url+subscope, file_base=file_base, checklinks=False)\r\n  File \"/private/tmp/bugtest/env/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 814, in resolve_all\r\n    raise Exception(\"Expected CommentedMap or CommentedSeq, got %s: `%s`\" % (type(document), document))\r\n```\r\n\r\n## Your Environment\r\nmacOS Sierra 10.12.6\r\nPython 2.7.14\r\ncwltool  1.0.20180912090223\r\n\r\n## NOTES\r\nI tested with the previous cwltool version(1.0.20180906112546) and I didn't have this issue.\r\n If I install the previous version then install the latest version you don't have this problem.\r\nThis problem seems to be related to `ruamel.yaml==0.15.66`. If you have `ruamel.yaml==0.15.51` it works fine.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/905", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/905/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/905/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/905/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/905", "id": 359793362, "node_id": "MDU6SXNzdWUzNTk3OTMzNjI=", "number": 905, "title": "Tools unable to write files inside Docker containers", "user": {"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-09-13T08:28:30Z", "updated_at": "2018-09-19T09:46:32Z", "closed_at": "2018-09-19T09:46:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Under some circumstances the directories used for the volume mounts are not created before running a tool in a Docker container.\r\n\r\nThis forces the Docker daemon to create those directories, with the unfortunate choice of creating them with the uid and guid of the `root` user. This causes the tool to be unable to write files to the output directory.\r\n\r\nI discovered this using the kernel audit, but I doubt it'd be useful to see.\r\n\r\nFor reference, this is the type of command that cwltool creates when triggering this behaviour:\r\n\r\n```\r\ndocker \\\r\n         run \\\r\n         -i \\\r\n         --volume=/tmp/non-existant-directory:/var/spool/cwl:rw \\\r\n         --volume=/tmp/another-non-existant-folder:/tmp:rw \\\r\n         --workdir=/var/spool/cwl \\\r\n         --read-only=true \\\r\n         --user=1000:1000 \\\r\n         --rm \\\r\n         --env=TMPDIR=/tmp \\\r\n         --env=HOME=/var/spool/cwl \\\r\n         ebiwp/ebitools-container \\\r\n         ncbiblast_lwp.pl \\\r\n         --jobid \\\r\n         ncbiblast-R20180905-104903-0467-36809650-p1m \\\r\n         --outformat \\\r\n         xml \\\r\n         --polljob\r\n```\r\noutput:\r\n```\r\nCreating result file: ncbiblast-R20180905-104903-0467-36809650-p1m.xml.xml\r\nError: unable to open output file ncbiblast-R20180905-104903-0467-36809650-p1m.xml.xml (Permission denied) at /usr/src/ebitools/ncbiblast_lwp.pl line 1214.\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/904", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/904/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/904/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/904/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/904", "id": 359792816, "node_id": "MDU6SXNzdWUzNTk3OTI4MTY=", "number": 904, "title": "Tools unable to write files inside docker container", "user": {"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-13T08:26:44Z", "updated_at": "2018-09-13T10:03:31Z", "closed_at": "2018-09-13T10:03:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Under some circumstances the directories used for the volume mounts are not created before running a tool in a Docker container.\r\n\r\nThis forces the Docker daemon to create those directories, with the unfortunate choice of creating them with the uid and guid of the `root` user. This causes the tool to be unable to write files to the output directory.\r\n\r\nI discovered this using the kernel audit, but I doubt it'd be useful to see.\r\n\r\nFor reference, this is the type of command that cwltool creates when triggering this behaviour:\r\n\r\n```\r\ndocker \\\r\n         run \\\r\n         -i \\\r\n         --volume=/tmp/non-existant-directory:/var/spool/cwl:rw \\\r\n         --volume=/tmp/another-non-existant-folder:/tmp:rw \\\r\n         --workdir=/var/spool/cwl \\\r\n         --read-only=true \\\r\n         --user=1000:1000 \\\r\n         --rm \\\r\n         --env=TMPDIR=/tmp \\\r\n         --env=HOME=/var/spool/cwl \\\r\n         ebiwp/ebitools-container \\\r\n         ncbiblast_lwp.pl \\\r\n         --jobid \\\r\n         ncbiblast-R20180905-104903-0467-36809650-p1m \\\r\n         --outformat \\\r\n         xml \\\r\n         --polljob\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/892", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/892/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/892/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/892/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/892", "id": 356734817, "node_id": "MDU6SXNzdWUzNTY3MzQ4MTc=", "number": 892, "title": "Output directories containing files don't get cleaned up", "user": {"login": "sersorrel", "id": 9433472, "node_id": "MDQ6VXNlcjk0MzM0NzI=", "avatar_url": "https://avatars1.githubusercontent.com/u/9433472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sersorrel", "html_url": "https://github.com/sersorrel", "followers_url": "https://api.github.com/users/sersorrel/followers", "following_url": "https://api.github.com/users/sersorrel/following{/other_user}", "gists_url": "https://api.github.com/users/sersorrel/gists{/gist_id}", "starred_url": "https://api.github.com/users/sersorrel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sersorrel/subscriptions", "organizations_url": "https://api.github.com/users/sersorrel/orgs", "repos_url": "https://api.github.com/users/sersorrel/repos", "events_url": "https://api.github.com/users/sersorrel/events{/privacy}", "received_events_url": "https://api.github.com/users/sersorrel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-09-04T09:51:46Z", "updated_at": "2018-09-07T14:33:32Z", "closed_at": "2018-09-07T14:33:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected Behavior\r\n\r\ncwltool should remove (or have an option to remove) intermediate output directories once they're no longer needed.\r\n\r\n## Actual Behavior\r\n\r\nOutput directories that have files in them (whether that's because the tool generated extra files that weren't included in the output, or because cwltool left the files in place for the next step to use them) are never deleted, meaning that long workflows can consume large amounts of disk and eventually run out of space...\r\n\r\nThis looks intentional, but I don't understand why it's desirable to leave behind huge numbers of directories containing the output from intermediate steps.\r\n\r\nhttps://github.com/common-workflow-language/cwltool/blob/c27774b2fcfc66497ee22e08b309fd8a542f139b/cwltool/executors.py#L98-L99\r\n\r\nhttps://github.com/common-workflow-language/cwltool/blob/c27774b2fcfc66497ee22e08b309fd8a542f139b/cwltool/process.py#L375-L379\r\n\r\nhttps://github.com/common-workflow-language/cwltool/blob/c27774b2fcfc66497ee22e08b309fd8a542f139b/cwltool/process.py#L799-L801\r\n\r\n## Workflow Code\r\n\r\nwf.cwl:\r\n```cwl\r\ncwlVersion: v1.0\r\nclass: Workflow\r\n\r\ninputs:\r\n- id: workflow_input\r\n  type: File\r\n\r\nsteps:\r\n- id: workflow_step_one\r\n  run: step_one.cwl\r\n  in:\r\n    step_one_input: workflow_input\r\n  out:\r\n  - step_one_output\r\n- id: workflow_step_two\r\n  run: step_two.cwl\r\n  in:\r\n    step_two_input: workflow_step_one/step_one_output\r\n  out:\r\n  - step_two_output\r\n\r\noutputs:\r\n- id: workflow_output\r\n  type: File\r\n  outputSource: workflow_step_two/step_two_output\r\n```\r\n\r\nstep_one.cwl:\r\n```cwl\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\n\r\nbaseCommand: [\"touch\", \"step1\", \"step1_other\"]\r\n\r\ninputs:\r\n- id: step_one_input\r\n  type: File\r\n\r\noutputs:\r\n- id: step_one_output\r\n  type: File\r\n  outputBinding:\r\n    glob: \"step1\"\r\n```\r\n\r\nstep_two.cwl:\r\n```cwl\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\n\r\nbaseCommand: [\"touch\", \"step2\", \"step2_other\"]\r\n\r\ninputs:\r\n- id: step_two_input\r\n  type: File\r\n\r\noutputs:\r\n- id: step_two_output\r\n  type: File\r\n  outputBinding:\r\n    glob: \"step2\"\r\n```\r\n\r\njob.yml:\r\n```yaml\r\nworkflow_input:\r\n  class: File\r\n  path: input_file # this is just an empty file\r\n```\r\n\r\n## Full Traceback\r\n\r\n```console\r\n$ cwltool --debug wf.cwl job.yml \r\n/Users/jh36/venv/bin/cwltool 1.0.20180819175200\r\nResolved 'wf.cwl' to 'file:///Users/jh36/cwl/tmpfiles/wf.cwl'\r\n[workflow ] initialized from file:///Users/jh36/cwl/tmpfiles/wf.cwl\r\n[workflow ] start\r\n[workflow ] {\r\n    \"workflow_input\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/jh36/cwl/tmpfiles/input_file\",\r\n        \"size\": 11,\r\n        \"basename\": \"input_file\",\r\n        \"nameroot\": \"input_file\",\r\n        \"nameext\": \"\"\r\n    }\r\n}\r\n[workflow ] job step file:///Users/jh36/cwl/tmpfiles/wf.cwl#workflow_step_two not ready\r\n[workflow ] starting step workflow_step_one\r\n[job step workflow_step_one] job input {\r\n    \"file:///Users/jh36/cwl/tmpfiles/wf.cwl#workflow_step_one/step_one_input\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/jh36/cwl/tmpfiles/input_file\",\r\n        \"size\": 11,\r\n        \"basename\": \"input_file\",\r\n        \"nameroot\": \"input_file\",\r\n        \"nameext\": \"\"\r\n    }\r\n}\r\n[job step workflow_step_one] evaluated job input to {\r\n    \"file:///Users/jh36/cwl/tmpfiles/wf.cwl#workflow_step_one/step_one_input\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/jh36/cwl/tmpfiles/input_file\",\r\n        \"size\": 11,\r\n        \"basename\": \"input_file\",\r\n        \"nameroot\": \"input_file\",\r\n        \"nameext\": \"\"\r\n    }\r\n}\r\n[step workflow_step_one] start\r\n[job workflow_step_one] initializing from file:///Users/jh36/cwl/tmpfiles/step_one.cwl as part of step workflow_step_one\r\n[job workflow_step_one] {\r\n    \"step_one_input\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/jh36/cwl/tmpfiles/input_file\",\r\n        \"size\": 11,\r\n        \"basename\": \"input_file\",\r\n        \"nameroot\": \"input_file\",\r\n        \"nameext\": \"\"\r\n    }\r\n}\r\n[job workflow_step_one] path mappings is {\r\n    \"file:///Users/jh36/cwl/tmpfiles/input_file\": [\r\n        \"/Users/jh36/cwl/tmpfiles/input_file\",\r\n        \"/private/var/folders/9n/vrwpqrl91gl4ft1v0vdghcx0000ggv/T/tmpjk2r7hwx/stg5a3a6b3b-1596-489f-a871-6d6716e98192/input_file\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\n[job workflow_step_one] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ],\r\n        \"datum\": \"touch\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            1\r\n        ],\r\n        \"datum\": \"step1\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            2\r\n        ],\r\n        \"datum\": \"step1_other\"\r\n    }\r\n]\r\n[job workflow_step_one] /private/tmp/docker_tmp6dsu5gil$ touch \\\r\n    step1 \\\r\n    step1_other\r\n[job workflow_step_one] completed success\r\n[job workflow_step_one] {\r\n    \"step_one_output\": {\r\n        \"location\": \"file:///private/tmp/docker_tmp6dsu5gil/step1\",\r\n        \"basename\": \"step1\",\r\n        \"nameroot\": \"step1\",\r\n        \"nameext\": \"\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[step workflow_step_one] produced output {\r\n    \"file:///Users/jh36/cwl/tmpfiles/wf.cwl#workflow_step_one/step_one_output\": {\r\n        \"location\": \"file:///private/tmp/docker_tmp6dsu5gil/step1\",\r\n        \"basename\": \"step1\",\r\n        \"nameroot\": \"step1\",\r\n        \"nameext\": \"\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[step workflow_step_one] completed success\r\n[job workflow_step_one] Removing input staging directory /private/var/folders/9n/vrwpqrl91gl4ft1v0vdghcx0000ggv/T/tmpjk2r7hwx\r\n[job workflow_step_one] Removing temporary directory /private/var/folders/9n/vrwpqrl91gl4ft1v0vdghcx0000ggv/T/tmpl9_nygt_\r\n[workflow ] starting step workflow_step_two\r\n[job step workflow_step_two] job input {\r\n    \"file:///Users/jh36/cwl/tmpfiles/wf.cwl#workflow_step_two/step_two_input\": {\r\n        \"location\": \"file:///private/tmp/docker_tmp6dsu5gil/step1\",\r\n        \"basename\": \"step1\",\r\n        \"nameroot\": \"step1\",\r\n        \"nameext\": \"\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[job step workflow_step_two] evaluated job input to {\r\n    \"file:///Users/jh36/cwl/tmpfiles/wf.cwl#workflow_step_two/step_two_input\": {\r\n        \"location\": \"file:///private/tmp/docker_tmp6dsu5gil/step1\",\r\n        \"basename\": \"step1\",\r\n        \"nameroot\": \"step1\",\r\n        \"nameext\": \"\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[step workflow_step_two] start\r\n[job workflow_step_two] initializing from file:///Users/jh36/cwl/tmpfiles/step_two.cwl as part of step workflow_step_two\r\n[job workflow_step_two] {\r\n    \"step_two_input\": {\r\n        \"location\": \"file:///private/tmp/docker_tmp6dsu5gil/step1\",\r\n        \"basename\": \"step1\",\r\n        \"nameroot\": \"step1\",\r\n        \"nameext\": \"\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[job workflow_step_two] path mappings is {\r\n    \"file:///private/tmp/docker_tmp6dsu5gil/step1\": [\r\n        \"/private/tmp/docker_tmp6dsu5gil/step1\",\r\n        \"/private/var/folders/9n/vrwpqrl91gl4ft1v0vdghcx0000ggv/T/tmpc8es5f5v/stge5b03988-2b54-4b5a-91b2-fa54099e2b7b/step1\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\n[job workflow_step_two] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ],\r\n        \"datum\": \"touch\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            1\r\n        ],\r\n        \"datum\": \"step2\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            2\r\n        ],\r\n        \"datum\": \"step2_other\"\r\n    }\r\n]\r\n[job workflow_step_two] /private/tmp/docker_tmpe9ti48xo$ touch \\\r\n    step2 \\\r\n    step2_other\r\n[job workflow_step_two] completed success\r\n[job workflow_step_two] {\r\n    \"step_two_output\": {\r\n        \"location\": \"file:///private/tmp/docker_tmpe9ti48xo/step2\",\r\n        \"basename\": \"step2\",\r\n        \"nameroot\": \"step2\",\r\n        \"nameext\": \"\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[step workflow_step_two] produced output {\r\n    \"file:///Users/jh36/cwl/tmpfiles/wf.cwl#workflow_step_two/step_two_output\": {\r\n        \"location\": \"file:///private/tmp/docker_tmpe9ti48xo/step2\",\r\n        \"basename\": \"step2\",\r\n        \"nameroot\": \"step2\",\r\n        \"nameext\": \"\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[step workflow_step_two] completed success\r\n[workflow ] completed success\r\n[workflow ] {\r\n    \"workflow_output\": {\r\n        \"location\": \"file:///private/tmp/docker_tmpe9ti48xo/step2\",\r\n        \"basename\": \"step2\",\r\n        \"nameroot\": \"step2\",\r\n        \"nameext\": \"\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[job workflow_step_two] Removing input staging directory /private/var/folders/9n/vrwpqrl91gl4ft1v0vdghcx0000ggv/T/tmpc8es5f5v\r\n[job workflow_step_two] Removing temporary directory /private/var/folders/9n/vrwpqrl91gl4ft1v0vdghcx0000ggv/T/tmpk82h0lu3\r\nMoving /private/tmp/docker_tmpe9ti48xo/step2 to /Users/jh36/cwl/tmpfiles/step2\r\nRemoving intermediate output directory /private/tmp/docker_tmpzyyjmen_\r\n{\r\n    \"workflow_output\": {\r\n        \"location\": \"file:///Users/jh36/cwl/tmpfiles/step2\",\r\n        \"basename\": \"step2\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"path\": \"/Users/jh36/cwl/tmpfiles/step2\"\r\n    }\r\n}\r\nFinal process status is success\r\n$ # these are `JobExecutor.output_dirs`\r\n$ ls /private/tmp/docker_tmpe9ti48xo /private/tmp/docker_tmp6dsu5gil /private/tmp/docker_tmpzyyjmen_\r\nls: /private/tmp/docker_tmpzyyjmen_: No such file or directory\r\n/private/tmp/docker_tmp6dsu5gil:\r\nstep1       step1_other\r\n\r\n/private/tmp/docker_tmpe9ti48xo:\r\nstep2_other\r\n```\r\n\r\n## Your Environment\r\n\r\n* cwltool version: 1.0.20180819175200", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/891", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/891/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/891/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/891/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/891", "id": 356446870, "node_id": "MDU6SXNzdWUzNTY0NDY4NzA=", "number": 891, "title": "MultipleInput: single item array is implicitly converted to single value resulting in sink mismatch", "user": {"login": "maitai", "id": 578509, "node_id": "MDQ6VXNlcjU3ODUwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/578509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maitai", "html_url": "https://github.com/maitai", "followers_url": "https://api.github.com/users/maitai/followers", "following_url": "https://api.github.com/users/maitai/following{/other_user}", "gists_url": "https://api.github.com/users/maitai/gists{/gist_id}", "starred_url": "https://api.github.com/users/maitai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maitai/subscriptions", "organizations_url": "https://api.github.com/users/maitai/orgs", "repos_url": "https://api.github.com/users/maitai/repos", "events_url": "https://api.github.com/users/maitai/events{/privacy}", "received_events_url": "https://api.github.com/users/maitai/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-09-03T10:26:17Z", "updated_at": "2018-09-03T10:52:20Z", "closed_at": "2018-09-03T10:52:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nThe `myfiles` input to the example step `concatenateFiles` (see below) is of type `File[]` as long as it contains **at least two** elements. I expect it to _still_ be of type `File[]` even when it only contains **one** element.\r\n\r\n## Actual Behavior\r\nWhen the `myfiles` input of type `File[]` only contains a single element it is _somehow_ **changed** to type `File` resulting in the error message below.\r\nThis makes it impossible to use a CommandLineTool for input file arrays of variable length because the edge case of having the array contain only a single file crashes the workflow.\r\nThe problem is not specific to the type `File[]` but affects e.g. the type `string[]` as well.\r\n\r\n## Workflow Code\r\n```\r\ncwlVersion: v1.0\r\nclass: Workflow\r\nrequirements:\r\n  - class: MultipleInputFeatureRequirement\r\n\r\ninputs: []\r\noutputs: []\r\n\r\nsteps:\r\n  createFile1:\r\n    in: []\r\n    out:\r\n      - myfile\r\n    run:\r\n      cwlVersion: v1.0\r\n      class: CommandLineTool\r\n      baseCommand: echo\r\n      arguments:\r\n        - \"foo\"\r\n      inputs: []\r\n      outputs:\r\n        myfile: stdout\r\n\r\n  createFile2:\r\n    in: []\r\n    out:\r\n      - myfile\r\n    run:\r\n      cwlVersion: v1.0\r\n      class: CommandLineTool\r\n      baseCommand: echo\r\n      arguments:\r\n        - \"bar\"\r\n      inputs: []\r\n      outputs:\r\n        myfile: stdout\r\n\r\n  concatenateFiles:\r\n    in:\r\n      myfiles: \r\n        - createFile1/myfile\r\n#        - createFile2/myfile\r\n    out: []\r\n    run:\r\n      cwlVersion: v1.0\r\n      class: CommandLineTool\r\n      baseCommand: cat\r\n      inputs:\r\n        myfiles: File[]\r\n      outputs: []\r\n```\r\n\r\n## Full Traceback\r\n```\r\n/usr/bin/cwltool 1.0.20180820141117\r\nResolved 'main.cwl' to 'file:///XXXXX/main.cwl'\r\nTool definition failed validation:\r\nmain.cwl:13:9: Source 'myfile' of type \"File\" is incompatible\r\nmain.cwl:40:7:   with sink 'myfiles' of type {\"type\": \"array\", \"items\": \"File\"}\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n`/usr/bin/cwltool 1.0.20180820141117`\r\n* Python version:\r\n`Python 3.7.0`\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/885", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/885/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/885/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/885/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/885", "id": 354693374, "node_id": "MDU6SXNzdWUzNTQ2OTMzNzQ=", "number": 885, "title": "Remove unittest dependency for tests", "user": {"login": "psafont", "id": 5189409, "node_id": "MDQ6VXNlcjUxODk0MDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5189409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psafont", "html_url": "https://github.com/psafont", "followers_url": "https://api.github.com/users/psafont/followers", "following_url": "https://api.github.com/users/psafont/following{/other_user}", "gists_url": "https://api.github.com/users/psafont/gists{/gist_id}", "starred_url": "https://api.github.com/users/psafont/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psafont/subscriptions", "organizations_url": "https://api.github.com/users/psafont/orgs", "repos_url": "https://api.github.com/users/psafont/repos", "events_url": "https://api.github.com/users/psafont/events{/privacy}", "received_events_url": "https://api.github.com/users/psafont/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 269875291, "node_id": "MDU6TGFiZWwyNjk4NzUyOTE=", "url": "https://api.github.com/repos/common-workflow-language/cwltool/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 269875292, "node_id": "MDU6TGFiZWwyNjk4NzUyOTI=", "url": "https://api.github.com/repos/common-workflow-language/cwltool/labels/help%20wanted", "name": "help wanted", "color": "159818", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-28T11:44:43Z", "updated_at": "2018-09-10T10:58:40Z", "closed_at": "2018-09-10T10:58:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Right now the tests depend on unittest because they are coded in unittest style and on pytestm because they are run on pytest.\r\n\r\nThis is unnecessary since pytest can take care of everything.\r\n\r\nLet's remove the unittest dependency from the test suite and track the progress here.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/883", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/883/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/883/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/883/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/883", "id": 354278842, "node_id": "MDU6SXNzdWUzNTQyNzg4NDI=", "number": 883, "title": "--provenance should incorporate input files via hardlinks, if possible", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "stain", "id": 253413, "node_id": "MDQ6VXNlcjI1MzQxMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/253413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stain", "html_url": "https://github.com/stain", "followers_url": "https://api.github.com/users/stain/followers", "following_url": "https://api.github.com/users/stain/following{/other_user}", "gists_url": "https://api.github.com/users/stain/gists{/gist_id}", "starred_url": "https://api.github.com/users/stain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stain/subscriptions", "organizations_url": "https://api.github.com/users/stain/orgs", "repos_url": "https://api.github.com/users/stain/repos", "events_url": "https://api.github.com/users/stain/events{/privacy}", "received_events_url": "https://api.github.com/users/stain/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stain", "id": 253413, "node_id": "MDQ6VXNlcjI1MzQxMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/253413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stain", "html_url": "https://github.com/stain", "followers_url": "https://api.github.com/users/stain/followers", "following_url": "https://api.github.com/users/stain/following{/other_user}", "gists_url": "https://api.github.com/users/stain/gists{/gist_id}", "starred_url": "https://api.github.com/users/stain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stain/subscriptions", "organizations_url": "https://api.github.com/users/stain/orgs", "repos_url": "https://api.github.com/users/stain/repos", "events_url": "https://api.github.com/users/stain/events{/privacy}", "received_events_url": "https://api.github.com/users/stain/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-08-27T11:18:54Z", "updated_at": "2018-09-25T11:56:54Z", "closed_at": "2018-09-25T11:56:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/882", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/882/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/882/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/882/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/882", "id": 354278350, "node_id": "MDU6SXNzdWUzNTQyNzgzNTA=", "number": 882, "title": "--provenance doesn't capture the final output YAML/JSON object", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "stain", "id": 253413, "node_id": "MDQ6VXNlcjI1MzQxMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/253413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stain", "html_url": "https://github.com/stain", "followers_url": "https://api.github.com/users/stain/followers", "following_url": "https://api.github.com/users/stain/following{/other_user}", "gists_url": "https://api.github.com/users/stain/gists{/gist_id}", "starred_url": "https://api.github.com/users/stain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stain/subscriptions", "organizations_url": "https://api.github.com/users/stain/orgs", "repos_url": "https://api.github.com/users/stain/repos", "events_url": "https://api.github.com/users/stain/events{/privacy}", "received_events_url": "https://api.github.com/users/stain/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stain", "id": 253413, "node_id": "MDQ6VXNlcjI1MzQxMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/253413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stain", "html_url": "https://github.com/stain", "followers_url": "https://api.github.com/users/stain/followers", "following_url": "https://api.github.com/users/stain/following{/other_user}", "gists_url": "https://api.github.com/users/stain/gists{/gist_id}", "starred_url": "https://api.github.com/users/stain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stain/subscriptions", "organizations_url": "https://api.github.com/users/stain/orgs", "repos_url": "https://api.github.com/users/stain/repos", "events_url": "https://api.github.com/users/stain/events{/privacy}", "received_events_url": "https://api.github.com/users/stain/received_events", "type": "User", "site_admin": false}, {"login": "FarahZKhan", "id": 14935568, "node_id": "MDQ6VXNlcjE0OTM1NTY4", "avatar_url": "https://avatars1.githubusercontent.com/u/14935568?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FarahZKhan", "html_url": "https://github.com/FarahZKhan", "followers_url": "https://api.github.com/users/FarahZKhan/followers", "following_url": "https://api.github.com/users/FarahZKhan/following{/other_user}", "gists_url": "https://api.github.com/users/FarahZKhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/FarahZKhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FarahZKhan/subscriptions", "organizations_url": "https://api.github.com/users/FarahZKhan/orgs", "repos_url": "https://api.github.com/users/FarahZKhan/repos", "events_url": "https://api.github.com/users/FarahZKhan/events{/privacy}", "received_events_url": "https://api.github.com/users/FarahZKhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-08-27T11:17:10Z", "updated_at": "2018-09-07T13:47:26Z", "closed_at": "2018-09-07T13:47:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "It would be great if this had a predictable file name instead of a checksum based file name\r\n\r\nI think the output object that is sent to stdout should also match (that is, the path/location should point within the generated RO folder)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/881", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/881/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/881/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/881/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/881", "id": 353099068, "node_id": "MDU6SXNzdWUzNTMwOTkwNjg=", "number": 881, "title": "InitialWorkDirRequirement with Expression in listing", "user": {"login": "wgerlach", "id": 835536, "node_id": "MDQ6VXNlcjgzNTUzNg==", "avatar_url": "https://avatars3.githubusercontent.com/u/835536?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wgerlach", "html_url": "https://github.com/wgerlach", "followers_url": "https://api.github.com/users/wgerlach/followers", "following_url": "https://api.github.com/users/wgerlach/following{/other_user}", "gists_url": "https://api.github.com/users/wgerlach/gists{/gist_id}", "starred_url": "https://api.github.com/users/wgerlach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wgerlach/subscriptions", "organizations_url": "https://api.github.com/users/wgerlach/orgs", "repos_url": "https://api.github.com/users/wgerlach/repos", "events_url": "https://api.github.com/users/wgerlach/events{/privacy}", "received_events_url": "https://api.github.com/users/wgerlach/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-22T19:51:06Z", "updated_at": "2018-08-23T06:56:58Z", "closed_at": "2018-08-22T20:02:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n## Expected Behavior\r\ncwltool should parse an array of Expressions in the lisiting field of InitialWorkDirRequirement as specified in\r\n[https://www.commonwl.org/v1.0/CommandLineTool.html#InitialWorkDirRequirement](https://www.commonwl.org/v1.0/CommandLineTool.html#InitialWorkDirRequirement)\r\n\r\n\r\n## Actual Behavior\r\nI get: `WorkflowException: 'list' object has no attribute 'get'`\r\n\r\nIt seems the cwltool does not expect an array in the listing field.\r\n\r\n\r\n## Workflow Code\r\nworking compliance test v1.0/dir5.cwl\r\n```\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\nrequirements:\r\n  - class: ShellCommandRequirement\r\n  - class: InitialWorkDirRequirement\r\n    listing: $(inputs.indir.listing)\r\ninputs:\r\n  indir: Directory\r\noutputs:\r\n  outlist:\r\n    type: File\r\n    outputBinding:\r\n      glob: output.txt\r\narguments: [\"find\", \"-L\", \".\", \"!\", \"-path\", \"*.txt\",\r\n  {shellQuote: false, valueFrom: \"|\"},\r\n  \"sort\"]\r\nstdout: output.txt\r\n```\r\nvs\r\n\r\nmodified compliance test v1.0/dir5.cwl , listing is now an array:\r\n```\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\nrequirements:\r\n  - class: ShellCommandRequirement\r\n  - class: InitialWorkDirRequirement\r\n    listing: \r\n      - $(inputs.indir.listing)\r\ninputs:\r\n  indir: Directory\r\noutputs:\r\n  outlist:\r\n    type: File\r\n    outputBinding:\r\n      glob: output.txt\r\narguments: [\"find\", \"-L\", \".\", \"!\", \"-path\", \"*.txt\",\r\n  {shellQuote: false, valueFrom: \"|\"},\r\n  \"sort\"]\r\nstdout: output.txt\r\n```\r\n\r\n\r\n\r\n## Full Traceback\r\n```pytb\r\nGot workflow error\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/cwltool/executors.py\", line 110, in run_jobs\r\n    for job in jobiter:\r\n  File \"/usr/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 430, in job\r\n    self.updatePathmap(builder.outdir, builder.pathmapper, l)\r\n  File \"/usr/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 258, in updatePathmap\r\n    for sf in fn.get(\"secondaryFiles\", []):\r\nAttributeError: 'list' object has no attribute 'get'\r\nWorkflow error:\r\n'list' object has no attribute 'get'\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/site-packages/cwltool/main.py\", line 588, in main\r\n    logger=_logger)\r\n  File \"/usr/lib/python2.7/site-packages/cwltool/executors.py\", line 34, in __call__\r\n    return self.execute(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/site-packages/cwltool/executors.py\", line 83, in execute\r\n    self.run_jobs(process, job_order_object, logger, runtimeContext)\r\n  File \"/usr/lib/python2.7/site-packages/cwltool/executors.py\", line 124, in run_jobs\r\n    raise WorkflowException(Text(e))\r\nWorkflowException: 'list' object has no attribute 'get'\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n1.0.20180622214234\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/878", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/878/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/878/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/878/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/878", "id": 352336415, "node_id": "MDU6SXNzdWUzNTIzMzY0MTU=", "number": 878, "title": "passing environment variables to docker", "user": {"login": "SooLee", "id": 964460, "node_id": "MDQ6VXNlcjk2NDQ2MA==", "avatar_url": "https://avatars3.githubusercontent.com/u/964460?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SooLee", "html_url": "https://github.com/SooLee", "followers_url": "https://api.github.com/users/SooLee/followers", "following_url": "https://api.github.com/users/SooLee/following{/other_user}", "gists_url": "https://api.github.com/users/SooLee/gists{/gist_id}", "starred_url": "https://api.github.com/users/SooLee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SooLee/subscriptions", "organizations_url": "https://api.github.com/users/SooLee/orgs", "repos_url": "https://api.github.com/users/SooLee/repos", "events_url": "https://api.github.com/users/SooLee/events{/privacy}", "received_events_url": "https://api.github.com/users/SooLee/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-20T23:56:39Z", "updated_at": "2018-08-21T18:41:28Z", "closed_at": "2018-08-21T18:41:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Is there a way to pass an environment variable to docker while using cwltool?\r\n\r\nI tried two ways but neither one worked.\r\n1. runtime `--perserve-enrivonment ENVNAME` option of `cwltool`\r\n2. Inside CWL: \r\n```\r\nrequirements:\r\n  EnvVarRequirement:\r\n    envDef:\r\n      HELLO: $(inputs.message)\r\n```\r\n(as suggested by http://www.commonwl.org/user_guide/12-env/)\r\n\r\nI want to be able to pass an environmental variable to docker using `docker run -e` option and I don't want to put that variable inside the docker image because it is related to security token.\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/872", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/872/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/872/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/872/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/872", "id": 351537595, "node_id": "MDU6SXNzdWUzNTE1Mzc1OTU=", "number": 872, "title": "pip install cwltool failed with mypy-extension==0.4.0", "user": {"login": "inutano", "id": 221804, "node_id": "MDQ6VXNlcjIyMTgwNA==", "avatar_url": "https://avatars1.githubusercontent.com/u/221804?v=4", "gravatar_id": "", "url": "https://api.github.com/users/inutano", "html_url": "https://github.com/inutano", "followers_url": "https://api.github.com/users/inutano/followers", "following_url": "https://api.github.com/users/inutano/following{/other_user}", "gists_url": "https://api.github.com/users/inutano/gists{/gist_id}", "starred_url": "https://api.github.com/users/inutano/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/inutano/subscriptions", "organizations_url": "https://api.github.com/users/inutano/orgs", "repos_url": "https://api.github.com/users/inutano/repos", "events_url": "https://api.github.com/users/inutano/events{/privacy}", "received_events_url": "https://api.github.com/users/inutano/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2018-08-17T10:14:17Z", "updated_at": "2018-08-21T10:51:09Z", "closed_at": "2018-08-21T10:51:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\n`pip install cwltool` will give you `cwltool`\r\n\r\n## Actual Behavior\r\n`pip install cwltool` failed with error of `Downloading/unpacking mypy-extensions`.\r\n\r\nI guess the recent version of `mypy-extension==0.4.0` will cause the problem, since `pip install mypy-extension==0.3.0` followed by `pip install cwltool` goes fine.\r\n\r\n## Full Traceback\r\n\r\nThis Dockerfile\r\n\r\n```\r\nFROM debian:jessie-slim\r\nRUN apt-get update -qq\r\nRUN apt-get install -y python-dev python-pip libxml2-dev libxslt1-dev zlib1g-dev\r\nRUN pip install cwltool\r\n```\r\n\r\nFailed.\r\n\r\n```\r\nStep 4/4 : RUN pip install cwltool\r\n ---> Running in c7d559c034e2\r\nDownloading/unpacking cwltool\r\nDownloading/unpacking bagit>=1.6.4 (from cwltool)\r\n  Downloading bagit-1.7.0-py2.py3-none-any.whl\r\nDownloading/unpacking subprocess32>=3.5.0 (from cwltool)\r\n  Running setup.py (path:/tmp/pip-build-67BGbi/subprocess32/setup.py) egg_info for package subprocess32\r\n    /usr/lib/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: 'python_requires'\r\n      warnings.warn(msg)\r\n\r\n    no previously-included directories found matching 'build'\r\n    no previously-included directories found matching 'dist'\r\n    no previously-included directories found matching 'config.*'\r\n    no previously-included directories found matching '*.pyc'\r\nDownloading/unpacking mypy-extensions (from cwltool)\r\n  Downloading mypy_extensions-0.4.0.tar.gz\r\n  Running setup.py (path:/tmp/pip-build-67BGbi/mypy-extensions/setup.py) egg_info for package mypy-extensions\r\n    error in mypy_extensions setup command: 'install_requires' must be a string or list of strings containing valid project/version requirement specifiers\r\n    Complete output from command python setup.py egg_info:\r\n    error in mypy_extensions setup command: 'install_requires' must be a string or list of strings containing valid project/version requirement specifiers\r\n\r\n----------------------------------------\r\nCleaning up...\r\nCommand python setup.py egg_info failed with error code 1 in /tmp/pip-build-67BGbi/mypy-extensions\r\nStoring debug log for failure in /root/.pip/pip.log\r\nThe command '/bin/sh -c pip install cwltool' returned a non-zero code: 1\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: without version specification in `pip install`\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/870", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/870/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/870/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/870/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/870", "id": 351139119, "node_id": "MDU6SXNzdWUzNTExMzkxMTk=", "number": 870, "title": "Glob with brace expression not working", "user": {"login": "bogdang989", "id": 24608085, "node_id": "MDQ6VXNlcjI0NjA4MDg1", "avatar_url": "https://avatars2.githubusercontent.com/u/24608085?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bogdang989", "html_url": "https://github.com/bogdang989", "followers_url": "https://api.github.com/users/bogdang989/followers", "following_url": "https://api.github.com/users/bogdang989/following{/other_user}", "gists_url": "https://api.github.com/users/bogdang989/gists{/gist_id}", "starred_url": "https://api.github.com/users/bogdang989/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bogdang989/subscriptions", "organizations_url": "https://api.github.com/users/bogdang989/orgs", "repos_url": "https://api.github.com/users/bogdang989/repos", "events_url": "https://api.github.com/users/bogdang989/events{/privacy}", "received_events_url": "https://api.github.com/users/bogdang989/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-08-16T10:06:13Z", "updated_at": "2018-08-16T14:56:20Z", "closed_at": "2018-08-16T14:56:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected Behavior\r\nglob: {\\*.txt,\\*.png} should match all of the braced patterns.\r\n\r\n## Actual Behavior\r\nNothing is returned.\r\n\r\n## Workflow Code\r\n```\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\nbaseCommand:\r\n  - ls\r\ninputs:\r\n  - id: input\r\n    type: string?\r\noutputs:\r\n  - id: output\r\n    type: File[]\r\n    outputBinding:\r\n      glob: '{*.png,*.txt}'\r\nrequirements:\r\n  - class: DockerRequirement\r\n    dockerPull: 'ubuntu:16.04'\r\n  - class: InitialWorkDirRequirement\r\n    listing:\r\n      - entryname: a.txt\r\n        entry: a\r\n      - entryname: b.png\r\n        entry: b\r\nstdout: b.txt\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180721142728\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/863", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/863/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/863/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/863/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/863", "id": 349229336, "node_id": "MDU6SXNzdWUzNDkyMjkzMzY=", "number": 863, "title": "All of cwltool v1.0 travis tests are suddenly failing today", "user": {"login": "SooLee", "id": 964460, "node_id": "MDQ6VXNlcjk2NDQ2MA==", "avatar_url": "https://avatars3.githubusercontent.com/u/964460?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SooLee", "html_url": "https://github.com/SooLee", "followers_url": "https://api.github.com/users/SooLee/followers", "following_url": "https://api.github.com/users/SooLee/following{/other_user}", "gists_url": "https://api.github.com/users/SooLee/gists{/gist_id}", "starred_url": "https://api.github.com/users/SooLee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SooLee/subscriptions", "organizations_url": "https://api.github.com/users/SooLee/orgs", "repos_url": "https://api.github.com/users/SooLee/repos", "events_url": "https://api.github.com/users/SooLee/events{/privacy}", "received_events_url": "https://api.github.com/users/SooLee/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-09T17:55:45Z", "updated_at": "2019-04-26T07:46:17Z", "closed_at": "2019-04-26T07:46:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "\r\n## Expected Behavior\r\nWe have been running these CWLs and input json with no problems until yesterday. Suddenly they're failing, when we install a new version of `cwltool`.\r\n\r\n## Actual Behavior\r\n```\r\nTool definition failed initialization:\r\nSyntax error while parsing a flow mapping\r\n  in \"file:///home/travis/build/4dn-dcic/pipelines-cwl/tests/test_input_json/hi-c-processing-pairs.input.json\", line 1, column 1\r\nexpected ',' or '}', but got '<scalar>'\r\n  in \"file:///home/travis/build/4dn-dcic/pipelines-cwl/tests/test_input_json/hi-c-processing-pairs.input.json\", line 16, column 15\r\nTraceback (most recent call last):\r\n  File \"/home/travis/virtualenv/python2.7.14/lib/python2.7/site-packages/cwltool/main.py\", line 491, in main\r\n    loadingContext.overrides_list, tool_file_uri)\r\n  File \"/home/travis/virtualenv/python2.7.14/lib/python2.7/site-packages/cwltool/main.py\", line 166, in load_job_order\r\n    job_order_object, _ = loader.resolve_ref(job_order_file, checklinks=False)\r\n  File \"/home/travis/virtualenv/python2.7.14/lib/python2.7/site-packages/schema_salad/ref_resolver.py\", line 572, in resolve_ref\r\n    doc = self.fetch(doc_url, inject_ids=(not mixin))\r\n  File \"/home/travis/virtualenv/python2.7.14/lib/python2.7/site-packages/schema_salad/sourceline.py\", line 164, in __exit__\r\n    raise self.makeError(six.text_type(exc_value))\r\nRuntimeError: Syntax error while parsing a flow mapping\r\n  in \"file:///home/travis/build/4dn-dcic/pipelines-cwl/tests/test_input_json/hi-c-processing-pairs.input.json\", line 1, column 1\r\nexpected ',' or '}', but got '<scalar>'\r\n  in \"file:///home/travis/build/4dn-dcic/pipelines-cwl/tests/test_input_json/hi-c-processing-pairs.input.json\", line 16, column 15\r\nTraceback (most recent call last):\r\n  File \"/home/travis/build/4dn-dcic/pipelines-cwl/tests/json_null_test.py\", line 9, in <module>\r\n    s = json.load(sys.stdin)\r\n  File \"/opt/python/2.7.14/lib/python2.7/json/__init__.py\", line 291, in load\r\n    **kw)\r\n  File \"/opt/python/2.7.14/lib/python2.7/json/__init__.py\", line 339, in loads\r\n    return _default_decoder.decode(s)\r\n  File \"/opt/python/2.7.14/lib/python2.7/json/decoder.py\", line 364, in decode\r\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\r\n  File \"/opt/python/2.7.14/lib/python2.7/json/decoder.py\", line 382, in raw_decode\r\n    raise ValueError(\"No JSON object could be decoded\")\r\nValueError: No JSON object could be decoded\r\n```\r\n\r\n## Workflow Code\r\nThe input json file `file:///home/travis/build/4dn-dcic/pipelines-cwl/tests/test_input_json/hi-c-processing-pairs.input.json` looks as below\r\n```\r\n{ \r\n    \"chromsizes\": {\r\n        \"class\": \"File\", \r\n        \"path\": \"../test_files/hg38.mainonly.chrom.sizes\"\r\n    }, \r\n    \"input_pairs\": [\r\n        {\r\n            \"class\": \"File\", \r\n            \"path\": \"../test_files/test2.pairs.gz\"\r\n        }\r\n    ], \r\n    \"restriction_file\": {\r\n        \"class\": \"File\", \r\n        \"path\": \"../test_files/hg38_HindIII_new.+chr.txt\"\r\n    },\r\n    \"nthreads\":1,\r\n    \"min_res\":500000,\r\n    \"custom_res\": \"500000,1000000,2000000\",\r\n    \"maxmem\":\"2g\",\r\n    \"chunksize\":10000000,\r\n    \"mapqfilter_juicer\": 30\r\n}\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: v1.0\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/861", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/861/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/861/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/861/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/861", "id": 349049666, "node_id": "MDU6SXNzdWUzNDkwNDk2NjY=", "number": 861, "title": "Validation suddenly fails", "user": {"login": "lunactic", "id": 3973381, "node_id": "MDQ6VXNlcjM5NzMzODE=", "avatar_url": "https://avatars2.githubusercontent.com/u/3973381?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lunactic", "html_url": "https://github.com/lunactic", "followers_url": "https://api.github.com/users/lunactic/followers", "following_url": "https://api.github.com/users/lunactic/following{/other_user}", "gists_url": "https://api.github.com/users/lunactic/gists{/gist_id}", "starred_url": "https://api.github.com/users/lunactic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lunactic/subscriptions", "organizations_url": "https://api.github.com/users/lunactic/orgs", "repos_url": "https://api.github.com/users/lunactic/repos", "events_url": "https://api.github.com/users/lunactic/events{/privacy}", "received_events_url": "https://api.github.com/users/lunactic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-08-09T09:31:44Z", "updated_at": "2018-09-06T14:29:51Z", "closed_at": "2018-09-06T14:29:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nThe validation of the echo.cwl test job executes successfully.\r\n\r\n## Actual Behavior\r\nThe validation fails with the error:\r\n\r\n```\r\n/usr/bin/cwltool 1.0.20180808165120\r\nResolved 'tests/echo.cwl' to 'file:///home/lunactic/DEV/cwltool_orig/tests/echo.cwl'\r\nI'm sorry, I couldn't load this CWL file, try again with --debug for more information.\r\nThe error was: workflowjobj must be a dict, got '<class 'ruamel.yaml.comments.CommentedMap'>': ordereddict([('cwlVersion', 'v1.0'), ('class', 'CommandLineTool'), ('inputs', [ordereddict([('id', 'inp'), ('type', 'string'), ('inputBinding', ordereddict())])]), ('outputs', [ordereddict([('id', 'out'), ('type', 'string'), ('outputBinding', ordereddict([('glob', 'out.txt'), ('loadContents', True), ('outputEval', '$(self[0].contents)')]))])]), ('baseCommand', 'echo'), ('stdout', 'out.txt'), ('id', 'file:///home/lunactic/DEV/cwltool_orig/tests/echo.cwl')])\r\n```\r\n\r\n## Workflow Code\r\n```\r\ncwtool --validate tests/echo.cwl\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\n/usr/bin/cwltool 1.0.20180808165120\r\nResolved 'tests/echo.cwl' to 'file:///home/lunactic/DEV/cwltool_orig/tests/echo.cwl'\r\nI'm sorry, I couldn't load this CWL file, try again with --debug for more information.\r\nThe error was: workflowjobj must be a dict, got '<class 'ruamel.yaml.comments.CommentedMap'>': ordereddict([('cwlVersion', 'v1.0'), ('class', 'CommandLineTool'), ('inputs', [ordereddict([('id', 'inp'), ('type', 'string'), ('inputBinding', ordereddict())])]), ('outputs', [ordereddict([('id', 'out'), ('type', 'string'), ('outputBinding', ordereddict([('glob', 'out.txt'), ('loadContents', True), ('outputEval', '$(self[0].contents)')]))])]), ('baseCommand', 'echo'), ('stdout', 'out.txt'), ('id', 'file:///home/lunactic/DEV/cwltool_orig/tests/echo.cwl')])\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180808165120\r\n* python version: 3.7 (tested with 3.5 as well)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/846", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/846/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/846/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/846/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/846", "id": 345165324, "node_id": "MDU6SXNzdWUzNDUxNjUzMjQ=", "number": 846, "title": "WorkflowStepInput.valueFrom: listing missing if self is type `Directory`", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-07-27T09:57:25Z", "updated_at": "2018-07-27T12:34:01Z", "closed_at": "2018-07-27T12:34:01Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected Behavior\r\n`$ cwltool single_file_from_dir.cwl dir3-job.yml`  # from within common-workflow-language/v1.0/v1.0\r\n\r\nNo errors\r\n\r\n## Actual Behavior\r\n\r\nThe Directory object is missing the `listing` attribute \u2192 `permanentFail`\r\n\r\n## Workflow Code\r\n``` cwl\r\n#!/usr/bin/env cwl-runner\r\ncwlVersion: v1.0\r\nclass: Workflow\r\n\r\nrequirements:\r\n  StepInputExpressionRequirement: {}\r\n  InlineJavascriptRequirement: {}\r\n\r\ninputs:\r\n  inf: File  # tarfile\r\noutputs:\r\n  output:\r\n    type: File\r\n    outputSource: second/output\r\n\r\nsteps:\r\n  first:\r\n    run: dir3.cwl\r\n    in:\r\n      inf: inf\r\n    out: [ outdir ]\r\n  second:\r\n    run: cat-tool.cwl\r\n    in:\r\n      file1:\r\n        source: first/outdir\r\n        valueFrom: $(self.listing[0])\r\n    out: [ output ]\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\n/home/mcrusoe/cwltool/env3/bin/cwltool 1.0.20180726173438\r\nResolved 'single_file_from_dir.cwl' to 'file:///home/mcrusoe/common-workflow-language/v1.0/v1.0/single_file_from_dir.cwl'\r\n[workflow ] start\r\n[workflow ] starting step first\r\n[step first] start\r\n[job first] /tmp/tmp_ii7bplq$ tar \\\r\n    xvf \\\r\n    /tmp/tmp053wbxxe/stgd669db5e-dc51-447f-8575-f71ff465692c/hello.tar\r\nhello.txt\r\ngoodbye.txt\r\n[job first] completed success\r\n[step first] completed success\r\n[workflow ] starting step second\r\n[step second] Cannot make job: Expression evaluation error:\r\nExpecting value: line 1 column 1 (char 0)\r\nscript was:\r\n01 \"use strict\";\r\n02 var inputs = {\r\n03     \"file1\": {\r\n04         \"location\": \"file:///tmp/tmp_ii7bplq\",\r\n05         \"basename\": \"tmp_ii7bplq\",\r\n06         \"nameroot\": \"tmp_ii7bplq\",\r\n07         \"nameext\": \"\",\r\n08         \"class\": \"Directory\"\r\n09     }\r\n10 };\r\n11 var self = {\r\n12     \"location\": \"file:///tmp/tmp_ii7bplq\",\r\n13     \"basename\": \"tmp_ii7bplq\",\r\n14     \"nameroot\": \"tmp_ii7bplq\",\r\n15     \"nameext\": \"\",\r\n16     \"class\": \"Directory\"\r\n17 };\r\n18 var runtime = {\r\n19     \"tmpdir\": null,\r\n20     \"outdir\": null\r\n21 };\r\n22 (function(){return ((self.listing[0]));})()\r\nstdout was: ''\r\nstderr was: 'evalmachine.<anonymous>:22\r\n(function(){return ((self.listing[0]));})()\r\n                                 ^\r\n\r\nTypeError: Cannot read property '0' of undefined\r\n    at evalmachine.<anonymous>:22:34\r\n    at evalmachine.<anonymous>:22:42\r\n    at ContextifyScript.Script.runInContext (vm.js:59:29)\r\n    at ContextifyScript.Script.runInNewContext (vm.js:65:15)\r\n    at Object.runInNewContext (vm.js:135:38)\r\n    at Socket.<anonymous> ([eval]:11:57)\r\n    at emitOne (events.js:116:13)\r\n    at Socket.emit (events.js:211:7)\r\n    at addChunk (_stream_readable.js:263:12)\r\n    at readableAddChunk (_stream_readable.js:246:13)'\r\n\r\n[workflow ] completed permanentFail\r\n{\r\n    \"output\": null\r\n}\r\nFinal process status is permanentFail\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180726173438\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/838", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/838/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/838/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/838/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/838", "id": 343492141, "node_id": "MDU6SXNzdWUzNDM0OTIxNDE=", "number": 838, "title": "[Regression] --record-container-id causes internal exception", "user": {"login": "tom-tan", "id": 4450141, "node_id": "MDQ6VXNlcjQ0NTAxNDE=", "avatar_url": "https://avatars2.githubusercontent.com/u/4450141?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tom-tan", "html_url": "https://github.com/tom-tan", "followers_url": "https://api.github.com/users/tom-tan/followers", "following_url": "https://api.github.com/users/tom-tan/following{/other_user}", "gists_url": "https://api.github.com/users/tom-tan/gists{/gist_id}", "starred_url": "https://api.github.com/users/tom-tan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tom-tan/subscriptions", "organizations_url": "https://api.github.com/users/tom-tan/orgs", "repos_url": "https://api.github.com/users/tom-tan/repos", "events_url": "https://api.github.com/users/tom-tan/events{/privacy}", "received_events_url": "https://api.github.com/users/tom-tan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-07-23T05:27:09Z", "updated_at": "2018-07-24T07:32:14Z", "closed_at": "2018-07-24T07:32:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When we run `cwltool` with `--record-container-id` to execute a workflows that use docker, the execution fails due to the internal exception.\r\nThis issue was introduced by #835 (commit: 8ddb82d81daf165442d90f73926838972612739d).\r\n\r\n## Expected Behavior\r\n```console\r\n$ mkdir -p tmp\r\n$ python -mcwltool.main --record-container-id --outdir $PWD/tmp cwltool/schemas/v1.0/v1.0/search.cwl cwltool/schemas/v1.0/v1.0/search-job.json\r\n...\r\nFinal process status is success\r\n```\r\n\r\n## Actual Behavior\r\n```console\r\n$ mkdir -p tmp\r\n$ python -mcwltool.main --record-container-id --outdir $PWD/tmp cwltool/schemas/v1.0/v1.0/search.cwl cwltool/schemas/v1.0/v1.0/search-job.json\r\n...\r\n[workflow ] start\r\n[workflow ] starting step index\r\n[step index] start\r\nGot workflow error\r\nTraceback (most recent call last):\r\n  File \"/Users/tom-tan/cwltool/cwltool/executors.py\", line 162, in run_jobs\r\n    job.run(runtime_context)\r\n  File \"/Users/tom-tan/cwltool/cwltool/job.py\", line 484, in run\r\n    runtime = self.create_runtime(env, runtimeContext)\r\n  File \"/Users/tom-tan/cwltool/cwltool/docker.py\", line 337, in create_runtime\r\n    cidfile_dir = runtimeContext.cidfile_\r\nAttributeError: 'RuntimeContext' object has no attribute 'cidfile_'\r\nWorkflow error, try again with --debug for more information:\r\n'RuntimeContext' object has no attribute 'cidfile_'\r\n```\r\n\r\n\r\n## Workflow Code\r\n[search.cwl in this repository](https://github.com/common-workflow-language/cwltool/blob/master/cwltool/schemas/v1.0/v1.0/search.cwl) is an example that can reproduce this issue.\r\nI also confirm that it can be reproduced with another workflow that uses `DockerRequirement`.\r\n\r\n## Full Traceback\r\n```pytb\r\n/Users/tom-tan/cwltool/cwltool/main.py 1.0.20180720074456\r\nResolved 'cwltool/schemas/v1.0/v1.0/search.cwl' to 'file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/search.cwl'\r\nWorkflow checker warning:\r\ncwltool/schemas/v1.0/v1.0/search.cwl:108:9:  Sink 'file'\r\ncwltool/schemas/v1.0/v1.0/search.cwl:57:7:     expects secondaryFiles: ['.idx1', '^.idx2',\r\n                                               '$(self.basename).idx3', '${ return\r\n                                               self.basename+\".idx4\"; }',\r\n                                               '$(self.nameroot).idx6$(self.nameext)', '${ return\r\n                                               [self.basename+\".idx7\"]; }', '_idx8'] but\r\ncwltool/schemas/v1.0/v1.0/search.cwl:103:13:   source 'result' has secondaryFiles ['.idx1',\r\n                                               '^.idx2', '$(self.basename).idx3', '${ return\r\n                                               self.basename+\".idx4\"; }', '$({\"path\":\r\n                                               self.path+\".idx5\", \"class\": \"File\"})',\r\n                                               '$(self.nameroot).idx6$(self.nameext)', '${ return\r\n                                               [self.basename+\".idx7\", inputs.secondfile]; }',\r\n                                               '_idx8'].\r\n                                               To fix, add secondaryFiles: ['.idx1', '^.idx2',\r\n                                               '$(self.basename).idx3', '${ return\r\n                                               self.basename+\".idx4\"; }',\r\n                                               '$(self.nameroot).idx6$(self.nameext)', '${ return\r\n                                               [self.basename+\".idx7\"]; }', '_idx8'] to definition of\r\n                                               'result'.\r\n[workflow ] initialized from file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/search.cwl#main\r\n[workflow ] start\r\n[workflow ] {\r\n    \"infile\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/whale.txt\",\r\n        \"size\": 1111,\r\n        \"basename\": \"whale.txt\",\r\n        \"nameroot\": \"whale\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"secondfile\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/hello.txt\",\r\n        \"size\": 13,\r\n        \"basename\": \"hello.txt\",\r\n        \"nameroot\": \"hello\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"term\": \"find\"\r\n}\r\n[workflow ] job step file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/search.cwl#main/search not ready\r\n[workflow ] starting step index\r\n[job step index] job input {\r\n    \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/search.cwl#main/index/file\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/whale.txt\",\r\n        \"size\": 1111,\r\n        \"basename\": \"whale.txt\",\r\n        \"nameroot\": \"whale\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/search.cwl#main/index/secondfile\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/hello.txt\",\r\n        \"size\": 13,\r\n        \"basename\": \"hello.txt\",\r\n        \"nameroot\": \"hello\",\r\n        \"nameext\": \".txt\"\r\n    }\r\n}\r\n[job step index] evaluated job input to {\r\n    \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/search.cwl#main/index/file\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/whale.txt\",\r\n        \"size\": 1111,\r\n        \"basename\": \"whale.txt\",\r\n        \"nameroot\": \"whale\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/search.cwl#main/index/secondfile\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/hello.txt\",\r\n        \"size\": 13,\r\n        \"basename\": \"hello.txt\",\r\n        \"nameroot\": \"hello\",\r\n        \"nameext\": \".txt\"\r\n    }\r\n}\r\n[step index] start\r\n[job index] initializing from file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/search.cwl#index as part of step index\r\n[job index] {\r\n    \"file\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/whale.txt\",\r\n        \"size\": 1111,\r\n        \"basename\": \"whale.txt\",\r\n        \"nameroot\": \"whale\",\r\n        \"nameext\": \".txt\"\r\n    },\r\n    \"secondfile\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/hello.txt\",\r\n        \"size\": 13,\r\n        \"basename\": \"hello.txt\",\r\n        \"nameroot\": \"hello\",\r\n        \"nameext\": \".txt\"\r\n    }\r\n}\r\n[job index] path mappings is {\r\n    \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/whale.txt\": [\r\n        \"/Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/whale.txt\",\r\n        \"/var/spool/cwl/input.txt\",\r\n        \"File\",\r\n        false\r\n    ],\r\n    \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/index.py\": [\r\n        \"/Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/index.py\",\r\n        \"/var/lib/cwl/stg8fac6d5c-2d45-49d6-919f-60abae6f127f/index.py\",\r\n        \"File\",\r\n        true\r\n    ],\r\n    \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/hello.txt\": [\r\n        \"/Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/hello.txt\",\r\n        \"/var/lib/cwl/stg6fd9bd87-88b6-4ca0-9cc3-451c217be017/hello.txt\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\n[job index] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ],\r\n        \"datum\": \"python\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            0,\r\n            \"index.py\"\r\n        ],\r\n        \"datum\": {\r\n            \"class\": \"File\",\r\n            \"location\": \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/index.py\",\r\n            \"basename\": \"index.py\",\r\n            \"nameroot\": \"index\",\r\n            \"nameext\": \".py\",\r\n            \"path\": \"/var/lib/cwl/stg8fac6d5c-2d45-49d6-919f-60abae6f127f/index.py\",\r\n            \"dirname\": \"/var/lib/cwl/stg8fac6d5c-2d45-49d6-919f-60abae6f127f\"\r\n        }\r\n    },\r\n    {\r\n        \"valueFrom\": \"input.txt\",\r\n        \"position\": [\r\n            1,\r\n            0\r\n        ]\r\n    }\r\n]\r\n[job index] initial work dir {\r\n    \"file:///Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/whale.txt\": [\r\n        \"/Users/tom-tan/cwltool/cwltool/schemas/v1.0/v1.0/whale.txt\",\r\n        \"/var/spool/cwl/input.txt\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\nGot workflow error\r\nTraceback (most recent call last):\r\n  File \"/Users/tom-tan/cwltool/cwltool/executors.py\", line 162, in run_jobs\r\n    job.run(runtime_context)\r\n  File \"/Users/tom-tan/cwltool/cwltool/job.py\", line 484, in run\r\n    runtime = self.create_runtime(env, runtimeContext)\r\n  File \"/Users/tom-tan/cwltool/cwltool/docker.py\", line 337, in create_runtime\r\n    cidfile_dir = runtimeContext.cidfile_\r\nAttributeError: 'RuntimeContext' object has no attribute 'cidfile_'\r\nWorkflow error:\r\n'RuntimeContext' object has no attribute 'cidfile_'\r\nTraceback (most recent call last):\r\n  File \"/Users/tom-tan/cwltool/cwltool/executors.py\", line 162, in run_jobs\r\n    job.run(runtime_context)\r\n  File \"/Users/tom-tan/cwltool/cwltool/job.py\", line 484, in run\r\n    runtime = self.create_runtime(env, runtimeContext)\r\n  File \"/Users/tom-tan/cwltool/cwltool/docker.py\", line 337, in create_runtime\r\n    cidfile_dir = runtimeContext.cidfile_\r\nAttributeError: 'RuntimeContext' object has no attribute 'cidfile_'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/tom-tan/cwltool/cwltool/main.py\", line 606, in main\r\n    logger=_logger)\r\n  File \"/Users/tom-tan/cwltool/cwltool/executors.py\", line 39, in __call__\r\n    return self.execute(*args, **kwargs)\r\n  File \"/Users/tom-tan/cwltool/cwltool/executors.py\", line 89, in execute\r\n    self.run_jobs(process, job_order_object, logger, runtime_context)\r\n  File \"/Users/tom-tan/cwltool/cwltool/executors.py\", line 170, in run_jobs\r\n    raise WorkflowException(Text(e))\r\ncwltool.errors.WorkflowException: 'RuntimeContext' object has no attribute 'cidfile_'\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n```console\r\n$ cwltool --version\r\n/Users/tom-tan/.pyenv/versions/3.6.5/bin/cwltool 1.0.20180720132017\r\n```\r\n\r\n## Note\r\nDuring executing the workflow, I saw the following warning message but it seems not related to this issue.\r\n\r\n```console\r\n$ python -mcwltool.main --record-container-id --outdir $PWD/tmp cwltool/schemas/v1.0/v1.0/search.cwl cwltool/schemas/v1.0/v1.0/search-job.json\r\n...\r\nWorkflow checker warning:\r\ncwltool/schemas/v1.0/v1.0/search.cwl:108:9:  Sink 'file'\r\ncwltool/schemas/v1.0/v1.0/search.cwl:57:7:     expects secondaryFiles: ['.idx1', '^.idx2',\r\n                                               '$(self.basename).idx3', '${ return\r\n                                               self.basename+\".idx4\"; }',\r\n                                               '$(self.nameroot).idx6$(self.nameext)', '${ return\r\n                                               [self.basename+\".idx7\"]; }', '_idx8'] but\r\ncwltool/schemas/v1.0/v1.0/search.cwl:103:13:   source 'result' has secondaryFiles ['.idx1',\r\n                                               '^.idx2', '$(self.basename).idx3', '${ return\r\n                                               self.basename+\".idx4\"; }', '$({\"path\":\r\n                                               self.path+\".idx5\", \"class\": \"File\"})',\r\n                                               '$(self.nameroot).idx6$(self.nameext)', '${ return\r\n                                               [self.basename+\".idx7\", inputs.secondfile]; }',\r\n                                               '_idx8'].\r\n                                               To fix, add secondaryFiles: ['.idx1', '^.idx2',\r\n                                               '$(self.basename).idx3', '${ return\r\n                                               self.basename+\".idx4\"; }',\r\n                                               '$(self.nameroot).idx6$(self.nameext)', '${ return\r\n                                               [self.basename+\".idx7\"]; }', '_idx8'] to definition of\r\n                                               'result'.\r\n...\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/833", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/833/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/833/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/833/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/833", "id": 342344976, "node_id": "MDU6SXNzdWUzNDIzNDQ5NzY=", "number": 833, "title": "Kill node.js process when cwltool exits", "user": {"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-18T14:08:29Z", "updated_at": "2018-07-26T16:53:30Z", "closed_at": "2018-07-26T16:53:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "At the moment the node.js process spawned by cwltool for executing JavaScript expressions and validation of JavaScript doesn't get killed when cwltool exits. It would be nice if this happened.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/832", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/832/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/832/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/832/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/832", "id": 342344044, "node_id": "MDU6SXNzdWUzNDIzNDQwNDQ=", "number": 832, "title": "Feature: kill child tasks when CWL exits", "user": {"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-07-18T14:06:16Z", "updated_at": "2018-07-26T16:53:30Z", "closed_at": "2018-07-26T16:53:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If cwltool exists, because of a user interrupting cwltool, a bug in cwltool or an error in a workflow, child tasks which cwltool has run are not killed. It would be nice if cwltool killed these tasks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/830", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/830/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/830/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/830/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/830", "id": 341859684, "node_id": "MDU6SXNzdWUzNDE4NTk2ODQ=", "number": 830, "title": "--memory being set when neither ramMin and ramMax are set", "user": {"login": "Karhide", "id": 6711199, "node_id": "MDQ6VXNlcjY3MTExOTk=", "avatar_url": "https://avatars1.githubusercontent.com/u/6711199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Karhide", "html_url": "https://github.com/Karhide", "followers_url": "https://api.github.com/users/Karhide/followers", "following_url": "https://api.github.com/users/Karhide/following{/other_user}", "gists_url": "https://api.github.com/users/Karhide/gists{/gist_id}", "starred_url": "https://api.github.com/users/Karhide/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Karhide/subscriptions", "organizations_url": "https://api.github.com/users/Karhide/orgs", "repos_url": "https://api.github.com/users/Karhide/repos", "events_url": "https://api.github.com/users/Karhide/events{/privacy}", "received_events_url": "https://api.github.com/users/Karhide/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-07-17T10:28:37Z", "updated_at": "2018-07-23T19:59:24Z", "closed_at": "2018-07-23T19:59:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "If I roll back to the previous version, the default --memory flag is not used, but on 1.0.20180711112827 we are seeing '--memory=1024' applied by default.\r\n\r\nNote this was experienced running containerised tools. Have not tested similar effects in locally installed tools.\r\n\r\nThanks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/824", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/824/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/824/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/824/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/824", "id": 341472965, "node_id": "MDU6SXNzdWUzNDE0NzI5NjU=", "number": 824, "title": "Crash with caret in secondaryFiles when there's no extension to remove", "user": {"login": "sersorrel", "id": 9433472, "node_id": "MDQ6VXNlcjk0MzM0NzI=", "avatar_url": "https://avatars1.githubusercontent.com/u/9433472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sersorrel", "html_url": "https://github.com/sersorrel", "followers_url": "https://api.github.com/users/sersorrel/followers", "following_url": "https://api.github.com/users/sersorrel/following{/other_user}", "gists_url": "https://api.github.com/users/sersorrel/gists{/gist_id}", "starred_url": "https://api.github.com/users/sersorrel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sersorrel/subscriptions", "organizations_url": "https://api.github.com/users/sersorrel/orgs", "repos_url": "https://api.github.com/users/sersorrel/repos", "events_url": "https://api.github.com/users/sersorrel/events{/privacy}", "received_events_url": "https://api.github.com/users/sersorrel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-16T10:56:17Z", "updated_at": "2019-04-22T18:47:08Z", "closed_at": "2019-04-22T18:47:08Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected Behavior\r\n\r\n> If string begins with one or more caret ^ characters, for each caret, remove the last file extension from the path (the last period . and all following characters). If there are no file extensions, the path is unchanged.\r\n\r\nIf the primary file has no extension, or its extension has been removed by previous caret(s), then extra carets in secondaryFiles should have no effect.\r\n\r\n## Actual Behavior\r\n\r\nIf there are more carets in an entry of secondaryFiles than there are extensions in the primary file's path, cwltool crashes.\r\n\r\n## Workflow Code\r\n\r\n```yaml\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nbaseCommand: echo\r\ninputs:\r\n  args:\r\n    type: File\r\n    inputBinding:\r\n      position: 1\r\n    secondaryFiles:\r\n    - ^.abc\r\noutputs: []\r\n```\r\n\r\njob:\r\n\r\n```yaml\r\nargs:\r\n  class: File\r\n  path: foo\r\n```\r\n\r\n## Full Traceback\r\n\r\n```pytb\r\n/Users/jh36/venv/bin/cwltool 1.0.20180711112827\r\nResolved 'tool.cwl' to 'file:///Users/jh36/tool.cwl'\r\nGot workflow error\r\nTraceback (most recent call last):\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/executors.py\", line 141, in run_jobs\r\n    for job in jobiter:\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/command_line_tool.py\", line 373, in job\r\n    builder = self._init_job(job_order, runtimeContext)\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/process.py\", line 654, in _init_job\r\n    discover_secondaryFiles=getdefault(runtimeContext.toplevel, False)))\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/builder.py\", line 260, in bind_input\r\n    bindings.extend(self.bind_input(f, datum[f[\"name\"]], lead_pos=lead_pos, tail_pos=f[\"name\"], discover_secondaryFiles=discover_secondaryFiles))\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/builder.py\", line 294, in bind_input\r\n    sfpath = substitute(datum[\"basename\"], sf)\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/builder.py\", line 32, in substitute\r\n    return substitute(value[0:value.rindex('.')], replace[1:])\r\nValueError: substring not found\r\nWorkflow error:\r\nsubstring not found\r\nTraceback (most recent call last):\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/executors.py\", line 141, in run_jobs\r\n    for job in jobiter:\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/command_line_tool.py\", line 373, in job\r\n    builder = self._init_job(job_order, runtimeContext)\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/process.py\", line 654, in _init_job\r\n    discover_secondaryFiles=getdefault(runtimeContext.toplevel, False)))\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/builder.py\", line 260, in bind_input\r\n    bindings.extend(self.bind_input(f, datum[f[\"name\"]], lead_pos=lead_pos, tail_pos=f[\"name\"], discover_secondaryFiles=discover_secondaryFiles))\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/builder.py\", line 294, in bind_input\r\n    sfpath = substitute(datum[\"basename\"], sf)\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/builder.py\", line 32, in substitute\r\n    return substitute(value[0:value.rindex('.')], replace[1:])\r\nValueError: substring not found\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/main.py\", line 605, in main\r\n    logger=_logger)\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/executors.py\", line 39, in __call__\r\n    return self.execute(*args, **kwargs)\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/executors.py\", line 89, in execute\r\n    self.run_jobs(process, job_order_object, logger, runtime_context)\r\n  File \"/Users/jh36/venv/lib/python3.6/site-packages/cwltool/executors.py\", line 170, in run_jobs\r\n    raise WorkflowException(Text(e))\r\ncwltool.errors.WorkflowException: substring not found\r\n```\r\n\r\n## Your Environment\r\n\r\n* cwltool version: 1.0.20180711112827", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/823", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/823/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/823/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/823/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/823", "id": 341470411, "node_id": "MDU6SXNzdWUzNDE0NzA0MTE=", "number": 823, "title": "Fail to get the file contents when using string interpolation", "user": {"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-07-16T10:47:08Z", "updated_at": "2018-07-27T10:10:40Z", "closed_at": "2018-07-27T10:10:40Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`print_file.cwl`:\r\n```\r\nclass: CommandLineTool\r\noutputs:\r\n  - id: file_contents\r\n    type: File\r\n    outputBinding:\r\n      outputEval: $(inputs.file.contents) |\r\ncwlVersion: v1.0\r\ninputs:\r\n - id: file\r\n   inputBinding:\r\n    loadContents: true\r\n   type: File\r\narguments:\r\n  - echo\r\n```\r\n\r\n```\r\n$ cwltool --debug print_file.cwl --file test_file\r\n/Users/th10/checkouts/cwltool/venv/bin/cwltool 1.0.20180713105522\r\nResolved 'print_file.cwl' to 'file:///Users/th10/checkouts/cwltool/print_file.cwl'\r\nParsed job order from command line: {\r\n    \"id\": \"print_file.cwl\",\r\n    \"file\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/th10/checkouts/cwltool/test_file\"\r\n    }\r\n}\r\n[job print_file.cwl] initializing from file:///Users/th10/checkouts/cwltool/print_file.cwl\r\n[job print_file.cwl] {\r\n    \"file\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///Users/th10/checkouts/cwltool/test_file\",\r\n        \"size\": 10,\r\n        \"basename\": \"test_file\",\r\n        \"nameroot\": \"test_file\",\r\n        \"nameext\": \"\"\r\n    }\r\n}\r\n[job print_file.cwl] path mappings is {\r\n    \"file:///Users/th10/checkouts/cwltool/test_file\": [\r\n        \"/Users/th10/checkouts/cwltool/test_file\",\r\n        \"/private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpc51sboiq/stg81d346d1-c851-455f-b497-655fd4c73054/test_file\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\nGot workflow error\r\nTraceback (most recent call last):\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/executors.py\", line 141, in run_jobs\r\n    for job in jobiter:\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/command_line_tool.py\", line 472, in job\r\n    json_dumps(builder.bindings, indent=4))\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/utils.py\", line 252, in json_dumps\r\n    return json.dumps(obj, **kwargs)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/__init__.py\", line 238, in dumps\r\n    **kw).encode(obj)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 201, in encode\r\n    chunks = list(chunks)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 429, in _iterencode\r\n    yield from _iterencode_list(o, _current_indent_level)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 325, in _iterencode_list\r\n    yield from chunks\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 405, in _iterencode_dict\r\n    yield from chunks\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 405, in _iterencode_dict\r\n    yield from chunks\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 438, in _iterencode\r\n    o = _default(o)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 179, in default\r\n    raise TypeError(f'Object of type {o.__class__.__name__} '\r\nTypeError: Object of type bytes is not JSON serializable\r\nWorkflow error:\r\nObject of type bytes is not JSON serializable\r\nTraceback (most recent call last):\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/executors.py\", line 141, in run_jobs\r\n    for job in jobiter:\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/command_line_tool.py\", line 472, in job\r\n    json_dumps(builder.bindings, indent=4))\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/utils.py\", line 252, in json_dumps\r\n    return json.dumps(obj, **kwargs)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/__init__.py\", line 238, in dumps\r\n    **kw).encode(obj)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 201, in encode\r\n    chunks = list(chunks)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 429, in _iterencode\r\n    yield from _iterencode_list(o, _current_indent_level)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 325, in _iterencode_list\r\n    yield from chunks\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 405, in _iterencode_dict\r\n    yield from chunks\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 405, in _iterencode_dict\r\n    yield from chunks\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 438, in _iterencode\r\n    o = _default(o)\r\n  File \"/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/lib/python3.7/json/encoder.py\", line 179, in default\r\n    raise TypeError(f'Object of type {o.__class__.__name__} '\r\nTypeError: Object of type bytes is not JSON serializable\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/main.py\", line 605, in main\r\n    logger=_logger)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/executors.py\", line 39, in __call__\r\n    return self.execute(*args, **kwargs)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/executors.py\", line 89, in execute\r\n    self.run_jobs(process, job_order_object, logger, runtime_context)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/executors.py\", line 170, in run_jobs\r\n    raise WorkflowException(Text(e))\r\ncwltool.errors.WorkflowException: Object of type bytes is not JSON serializable\r\n\r\n```\r\n\r\nI think this is due not converting the contents property to unicode and not converting the whole input object to unicode in expression.py. I'll PR these fixes now.  ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/822", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/822/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/822/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/822/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/822", "id": 341029229, "node_id": "MDU6SXNzdWUzNDEwMjkyMjk=", "number": 822, "title": "cwltool fails to install in python3.7", "user": {"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-07-13T13:57:24Z", "updated_at": "2018-07-19T11:23:39Z", "closed_at": "2018-07-19T11:23:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\n$ docker run -it python:3.7 /bin/bash\r\nroot@0b95bcccdca4:/# pip install cwltool\r\nCollecting cwltool\r\n  Downloading https://files.pythonhosted.org/packages/a4/4c/2e4034c9dc7f32bd0a4bf86cbf0dd9eeff4e10c1611e4d92aad73b28d5c5/cwltool-1.0.20180711112827-py2.py3-none-any.whl (666kB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 675kB 11.3MB/s\r\nCollecting bagit>=1.6.4 (from cwltool)\r\n  Downloading https://files.pythonhosted.org/packages/bd/d6/7f505929284541705c6acf83726eb5c74b092e7eaed3a166bc428215bb89/bagit-1.7.0-py2.py3-none-any.whl\r\nCollecting six>=1.8.0 (from cwltool)\r\n  Downloading https://files.pythonhosted.org/packages/67/4b/141a581104b1f6397bfa78ac9d43d8ad29a7ca43ea90a2d863fe3056e86a/six-1.11.0-py2.py3-none-any.whl\r\nCollecting typing>=3.5.3 (from cwltool)\r\n  Downloading https://files.pythonhosted.org/packages/05/2b/2b05bf1d5a9dd450447c9a5df3e118a465e5d3cb12b73b7220a5064a403f/typing-3.6.4-py3-none-any.whl\r\nCollecting schema-salad<3,>=2.6.20170927145003 (from cwltool)\r\n  Downloading https://files.pythonhosted.org/packages/37/eb/9ed3748d0cc19acb4ac4d17893a647d70103cb37668aa5182fe2ee3f54ba/schema_salad-2.7.20180611133406-py2.py3-none-any.whl (380kB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 389kB 13.4MB/s\r\nCollecting subprocess32>=3.5.0; os_name == \"posix\" (from cwltool)\r\n  Downloading https://files.pythonhosted.org/packages/c3/5f/7117737fc7114061837a4f51670d863dd7f7f9c762a6546fa8a0dcfe61c8/subprocess32-3.5.2.tar.gz (96kB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 102kB 6.0MB/s\r\nCollecting shellescape<3.5,>=3.4.1 (from cwltool)\r\n  Downloading https://files.pythonhosted.org/packages/51/b6/986c99a10040beaaefca1ad6c93bd7738cb8e4f52f6caed13d3ed1caa7e4/shellescape-3.4.1-py2.py3-none-any.whl\r\nCollecting requests>=2.4.3 (from cwltool)\r\n  Downloading https://files.pythonhosted.org/packages/65/47/7e02164a2a3db50ed6d8a6ab1d6d60b69c4c3fdf57a284257925dfc12bda/requests-2.19.1-py2.py3-none-any.whl (91kB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92kB 9.1MB/s\r\nCollecting ruamel.yaml<0.15,>=0.12.4 (from cwltool)\r\n  Downloading https://files.pythonhosted.org/packages/cf/86/7ef6c24317e20e6cef0eab407520d49f3d3836e454d5377bdcbcf03d385c/ruamel.yaml-0.14.12.tar.gz (242kB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 245kB 12.3MB/s\r\n    Complete output from command python setup.py egg_info:\r\n    Warning: 'keywords' should be a list, got type 'NoneType'\r\n    sys.argv ['-c', 'egg_info', '--egg-base', 'pip-egg-info']\r\n    test compiling test_ruamel_yaml\r\n    Traceback (most recent call last):\r\n      File \"<string>\", line 1, in <module>\r\n      File \"/tmp/pip-install-j620vg4m/ruamel.yaml/setup.py\", line 858, in <module>\r\n        main()\r\n      File \"/tmp/pip-install-j620vg4m/ruamel.yaml/setup.py\", line 847, in main\r\n        setup(**kw)\r\n      File \"/usr/local/lib/python3.7/site-packages/setuptools/__init__.py\", line 129, in setup\r\n        return distutils.core.setup(**attrs)\r\n      File \"/usr/local/lib/python3.7/distutils/core.py\", line 108, in setup\r\n        _setup_distribution = dist = klass(attrs)\r\n      File \"/usr/local/lib/python3.7/site-packages/setuptools/dist.py\", line 370, in __init__\r\n        k: v for k, v in attrs.items()\r\n      File \"/usr/local/lib/python3.7/distutils/dist.py\", line 267, in __init__\r\n        getattr(self.metadata, \"set_\" + key)(val)\r\n      File \"/usr/local/lib/python3.7/distutils/dist.py\", line 1203, in set_keywords\r\n        self.keywords = _ensure_list(value, 'keywords')\r\n      File \"/usr/local/lib/python3.7/distutils/dist.py\", line 40, in _ensure_list\r\n        value = list(value)\r\n    TypeError: 'NoneType' object is not iterable\r\n\r\n    ----------------------------------------\r\nCommand \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-install-j620vg4m/ruamel.yaml/\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/812", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/812/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/812/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/812/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/812", "id": 338486761, "node_id": "MDU6SXNzdWUzMzg0ODY3NjE=", "number": 812, "title": "Some mounted docker paths are referenced as /var instead of /var/private in Mac Serina", "user": {"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-05T09:04:18Z", "updated_at": "2018-07-13T10:55:26Z", "closed_at": "2018-07-13T10:55:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Example: the 90th conformance test. When executing this actual command is executed without the quiet flag, the following happens:\r\n```\r\n$ /Users/th10/checkouts/cwltool/venv/bin/cwltool --outdir=/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpy3_of70y ../common-workflow-language/v1.0/v1.0/cat3-tool.cwl ../common-workflow-language/v1.0/v1.0/file-literal.yml\r\n/Users/th10/checkouts/cwltool/venv/bin/cwltool 1.0.20180703025338\r\nResolved '../common-workflow-language/v1.0/v1.0/cat3-tool.cwl' to 'file:///Users/th10/checkouts/common-workflow-language/v1.0/v1.0/cat3-tool.cwl'\r\n[job cat3-tool.cwl] /private/tmp/docker_tmpldgg2u5f$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/private/tmp/docker_tmpldgg2u5f:/private/var/spool/cwl:rw \\\r\n    --volume=/private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpeuf451sm:/tmp:rw \\\r\n    --volume=/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpeuf451sm/tmpjsh0kge1:/private/var/lib/cwl/stg15c81a0c-99ab-4202-b300-953e76cfc7d8/21bdddd8-b055-41d7-b6c1-e57713e784c1:rw \\\r\n    --workdir=/private/var/spool/cwl \\\r\n    --read-only=true \\\r\n    --log-driver=none \\\r\n    --user=16442:1312 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/private/var/spool/cwl \\\r\n    debian:stretch-slim \\\r\n    cat \\\r\n    /private/var/lib/cwl/stg15c81a0c-99ab-4202-b300-953e76cfc7d8/21bdddd8-b055-41d7-b6c1-e57713e784c1 > /private/tmp/docker_tmpldgg2u5f/output.txt\r\ndocker: Error response from daemon: Mounts denied:\r\nThe path /var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpeuf451sm/tmpjsh0kge1\r\nis not shared from OS X and is not known to Docker.\r\nYou can configure shared paths from Docker -> Preferences... -> File Sharing.\r\nSee https://docs.docker.com/docker-for-mac/osxfs/#namespaces for more info.\r\n.\r\nERRO[0000] error waiting for container: context canceled\r\n[job cat3-tool.cwl] completed permanentFail\r\n{\r\n    \"output_file\": {\r\n        \"location\": \"file:///var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpy3_of70y/output.txt\",\r\n        \"basename\": \"output.txt\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"path\": \"/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpy3_of70y/output.txt\"\r\n    }\r\n}\r\nFinal process status is permanentFail\r\n```\r\n\r\nAs you can see from the 3rd `--volume`, `/var` is not being expanded to `/var/private`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/808", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/808/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/808/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/808/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/808", "id": 337837208, "node_id": "MDU6SXNzdWUzMzc4MzcyMDg=", "number": 808, "title": "--disable-js-validation not working", "user": {"login": "vladimirkovacevic", "id": 16796045, "node_id": "MDQ6VXNlcjE2Nzk2MDQ1", "avatar_url": "https://avatars3.githubusercontent.com/u/16796045?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vladimirkovacevic", "html_url": "https://github.com/vladimirkovacevic", "followers_url": "https://api.github.com/users/vladimirkovacevic/followers", "following_url": "https://api.github.com/users/vladimirkovacevic/following{/other_user}", "gists_url": "https://api.github.com/users/vladimirkovacevic/gists{/gist_id}", "starred_url": "https://api.github.com/users/vladimirkovacevic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vladimirkovacevic/subscriptions", "organizations_url": "https://api.github.com/users/vladimirkovacevic/orgs", "repos_url": "https://api.github.com/users/vladimirkovacevic/repos", "events_url": "https://api.github.com/users/vladimirkovacevic/events{/privacy}", "received_events_url": "https://api.github.com/users/vladimirkovacevic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-07-03T10:24:20Z", "updated_at": "2018-07-05T13:28:40Z", "closed_at": "2018-07-04T15:27:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n---\r\n\r\n## Expected Behavior\r\nWhen cwltool is run with --disable-js-validation it still validates javascript snippets inside json and reports errors.\r\n\r\n## Actual Behavior\r\ncwltool should skip validating js code\r\n\r\n## Workflow Code\r\nPart of it:\r\n```\r\n\"stdout\": \"${\r\n    filename = ''\r\n    if (inputs.input_file instanceof Array)\r\n        filename = inputs.input_file[0].path\r\n    else\r\n        filename = inputs.input_file.path\r\n\r\n    paths = filename.split('/')\r\n    names = filename.split('/')[paths.length - 1].split('.')\r\n\r\n    nn = ''\r\n    if (inputs.decompress) {\r\n        lind = names.length - 1\r\n    } else if ((filename.charAt(filename.length - 3) + filename.charAt(filename.length - 2) + filename.charAt(filename.length - 1)) ==\r\n        '.gz' && (inputs.decompress == false || inputs.decompress == undefined))\r\n\r\n    {\r\n        lind = names.length - 1\r\n    } else {\r\n        lind = names.length\r\n    }\r\n    for (i = 0; i < lind; i++) {\r\n        if (i != 0)\r\n            nn += '.'\r\n        nn += names[i]\r\n        if ((filename.charAt(filename.length - 3) + filename.charAt(filename.length - 2) + filename.charAt(filename.length - 1)) ==\r\n            '.gz' && (inputs.decompress == false || inputs.decompress == undefined) && i == 0)\r\n            nn += '.tab'\r\n        else if ((inputs.decompress == false || inputs.decompress == undefined) && i == 0)\r\n            nn += '.tab'\r\n    }\r\n\r\n    if (inputs.decompress) {\r\n        return nn\r\n    } else {\r\n        return nn + '.gz'\r\n    }\r\n}\",\r\n\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\n/Users/boris_majic/Documents/SBG/Yellow/venv/bin/cwltool 1.0.20180622214234\r\nResolved 'gatk4_wgs_cwl1_edited.json' to 'file:///Users/boris_majic/PycharmProjects/parse_cwl/gatk4_wgs_cwl1_edited.json'\r\ngatk4_wgs_cwl1_edited.json:137:9:   checking item\r\ngatk4_wgs_cwl1_edited.json:138:13:     Field `class` contains undefined reference to `https://sevenbridges.comAWSInstanceType`\r\ngatk4_wgs_cwl1_edited.json:141:9:   checking item\r\ngatk4_wgs_cwl1_edited.json:142:13:     Field `class` contains undefined reference to `https://sevenbridges.comGoogleInstanceType`\r\ngatk4_wgs_cwl1_edited.json:137:9: Unknown hint https://sevenbridges.comAWSInstanceType\r\ngatk4_wgs_cwl1_edited.json:141:9: Unknown hint https://sevenbridges.comGoogleInstanceType\r\ngatk4_wgs_cwl1_edited.json:2551:17: JSHINT:     filename = ''\r\ngatk4_wgs_cwl1_edited.json:2551:17: JSHINT:     ^\r\ngatk4_wgs_cwl1_edited.json:2551:17: JSHINT: W117: 'filename' is not defined.\r\ngatk4_wgs_cwl1_edited.json:2551:17: JSHINT:         filename = inputs.input_file[0].path\r\ngatk4_wgs_cwl1_edited.json:2551:17: JSHINT:         ^\r\ngatk4_wgs_cwl1_edited.json:2551:17: JSHINT: W117: 'filename' is not defined.\r\ngatk4_wgs_cwl1_edited.json:2551:17: JSHINT:         filename = inputs.input_file.path\r\ngatk4_wgs_cwl1_edited.json:2551:17: JSHINT:         ^\r\n...\r\n[cwltool.log](https://github.com/common-workflow-language/cwltool/files/2158785/cwltool.log)\r\n\r\n\r\n\r\n## Your Environment\r\ncwltool 1.0.20180622214234\r\n\r\nFYI @Chandralinjo\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/806", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/806/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/806/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/806/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/806", "id": 337307106, "node_id": "MDU6SXNzdWUzMzczMDcxMDY=", "number": 806, "title": "Workflow with no inputs fails validation", "user": {"login": "kaushik-work", "id": 6299530, "node_id": "MDQ6VXNlcjYyOTk1MzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6299530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaushik-work", "html_url": "https://github.com/kaushik-work", "followers_url": "https://api.github.com/users/kaushik-work/followers", "following_url": "https://api.github.com/users/kaushik-work/following{/other_user}", "gists_url": "https://api.github.com/users/kaushik-work/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaushik-work/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaushik-work/subscriptions", "organizations_url": "https://api.github.com/users/kaushik-work/orgs", "repos_url": "https://api.github.com/users/kaushik-work/repos", "events_url": "https://api.github.com/users/kaushik-work/events{/privacy}", "received_events_url": "https://api.github.com/users/kaushik-work/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-01T17:25:03Z", "updated_at": "2018-07-01T18:41:30Z", "closed_at": "2018-07-01T18:41:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\ncwltool --version\r\n1.0.20180628043715\r\n```\r\n\r\nWhen \r\n```\r\ncwltool --validate generated.cwl\r\n```\r\n\r\nis run on the following CWL document\r\n\r\n```\r\nclass: Workflow\r\ncwlVersion: v1.0\r\nid: _:1216fd9f-6ffd-42c0-bb03-7c0ad7d01017\r\ninputs: []\r\noutputs:\r\n- id: '#Myout'\r\n  outputSource: '#A/p2'\r\n  type:\r\n    items: File\r\n    type: array\r\nsteps:\r\n- id: '#A'\r\n  in: []\r\n  out:\r\n  - id: '#A/p2'\r\n  run: a.cwl\r\n```\r\nIt complains. \r\n\r\n```\r\nTool definition failed validation:\r\ngenerated.cwl:13:3: Step is missing required parameter 'p1'\r\n```\r\nBut it is quite possible to have a workflow with no external inputs. Or is there something else wrong with this document?\r\n\r\nRabix Composer shows this correctly.\r\n\r\nThanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/795", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/795/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/795/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/795/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/795", "id": 332917683, "node_id": "MDU6SXNzdWUzMzI5MTc2ODM=", "number": 795, "title": "master broken on OS X", "user": {"login": "kaushik-work", "id": 6299530, "node_id": "MDQ6VXNlcjYyOTk1MzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6299530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaushik-work", "html_url": "https://github.com/kaushik-work", "followers_url": "https://api.github.com/users/kaushik-work/followers", "following_url": "https://api.github.com/users/kaushik-work/following{/other_user}", "gists_url": "https://api.github.com/users/kaushik-work/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaushik-work/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaushik-work/subscriptions", "organizations_url": "https://api.github.com/users/kaushik-work/orgs", "repos_url": "https://api.github.com/users/kaushik-work/repos", "events_url": "https://api.github.com/users/kaushik-work/events{/privacy}", "received_events_url": "https://api.github.com/users/kaushik-work/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-06-15T21:21:46Z", "updated_at": "2018-06-30T23:21:03Z", "closed_at": "2018-06-30T23:21:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\nMaster commit (24a3493603623ac) should not break any existing workflows on macOS\r\n\r\n## Actual Behavior\r\nThe attached workflow breaks with the latest version of CWLtool. \r\n\r\n## Workflow Code\r\n[Archive.zip](https://github.com/common-workflow-language/cwltool/files/2107501/Archive.zip)\r\n\r\n\r\n## Full Traceback\r\n```\r\npython cwltool.py --debug test/simple-wf.cwl test/inputs.yaml \r\ncwltool.py 1.0.20180613204649\r\nResolved 'test/simple-wf.cwl' to 'file:///Users/kghose/Code/cwltool/test/simple-wf.cwl'\r\ntest/simple-wf.cwl:8:5: unrecognized extension field `https://www.sevenbridges.comexposed`.  Did you include a $schemas section?\r\nforeign properties set()\r\ntest/simple-wf.cwl:12:5: unrecognized extension field `https://www.sevenbridges.comx`.  Did you include a $schemas section?\r\nforeign properties set()\r\ntest/simple-wf.cwl:12:5: unrecognized extension field `https://www.sevenbridges.comy`.  Did you include a $schemas section?\r\nforeign properties set()\r\ntest/simple-wf.cwl:19:5: unrecognized extension field `https://www.sevenbridges.comx`.  Did you include a $schemas section?\r\nforeign properties set()\r\ntest/simple-wf.cwl:19:5: unrecognized extension field `https://www.sevenbridges.comy`.  Did you include a $schemas section?\r\nforeign properties set()\r\ntest/simple-wf.cwl:29:5: unrecognized extension field `https://www.sevenbridges.comx`.  Did you include a $schemas section?\r\nforeign properties set()\r\ntest/simple-wf.cwl:29:5: unrecognized extension field `https://www.sevenbridges.comy`.  Did you include a $schemas section?\r\nforeign properties set()\r\n[workflow ] initialized from file:///Users/kghose/Code/cwltool/test/simple-wf.cwl\r\n[workflow ] start\r\n[workflow ] job step file:///Users/kghose/Code/cwltool/test/simple-wf.cwl#str_cwl not ready\r\n[workflow ] starting step multi_out\r\n[job step multi_out] job input {\r\n    \"file:///Users/kghose/Code/cwltool/test/simple-wf.cwl#multi_out/input\": 4\r\n}\r\n[job step multi_out] evaluated job input to {\r\n    \"file:///Users/kghose/Code/cwltool/test/simple-wf.cwl#multi_out/input\": 4\r\n}\r\n[step multi_out] start\r\n[job multi_out] initializing from file:///Users/kghose/Code/cwltool/test/multi-out.cwl as part of step multi_out\r\n[job multi_out] {\r\n    \"input\": 4\r\n}\r\n[job multi_out] path mappings is {}\r\n[job multi_out] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ],\r\n        \"datum\": \"/bin/sh\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            0,\r\n            0\r\n        ],\r\n        \"prefix\": \"\",\r\n        \"separate\": false,\r\n        \"shellQuote\": false,\r\n        \"valueFrom\": \"script.sh\"\r\n    }\r\n]\r\n[job multi_out] initial work dir {\r\n    \"_:c02ef544-7377-45ab-8254-a6758589bc94\": [\r\n        \"for V in $(seq 1 4)\\ndo\\n  echo ${V} > abc.${V}.txt\\ndone\",\r\n        \"/private/var/spool/cwl/script.sh\",\r\n        \"CreateFile\",\r\n        true\r\n    ]\r\n}\r\n[job multi_out] /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/private/var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b:/private/var/spool/cwl:rw \\\r\n    --volume=/private/var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0gw86z0h:/tmp:rw \\\r\n    --workdir=/private/var/spool/cwl \\\r\n    --read-only=true \\\r\n    --user=501:20 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/private/var/spool/cwl \\\r\n    alpine \\\r\n    /bin/sh \\\r\n    -c \\\r\n    '/bin/sh' script.sh\r\n[job multi_out] completed success\r\n[job multi_out] {\r\n    \"output\": [\r\n        {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.1.txt\",\r\n            \"basename\": \"abc.1.txt\",\r\n            \"nameroot\": \"abc.1\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        },\r\n        {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.2.txt\",\r\n            \"basename\": \"abc.2.txt\",\r\n            \"nameroot\": \"abc.2\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$7448d8798a4380162d4b56f9b452e2f6f9e24e7a\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        },\r\n        {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.3.txt\",\r\n            \"basename\": \"abc.3.txt\",\r\n            \"nameroot\": \"abc.3\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$a3db5c13ff90a36963278c6a39e4ee3c22e2a436\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        },\r\n        {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.4.txt\",\r\n            \"basename\": \"abc.4.txt\",\r\n            \"nameroot\": \"abc.4\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$9c6b057a2b9d96a4067a749ee3b3b0158d390cf1\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        }\r\n    ]\r\n}\r\n[step multi_out] produced output {\r\n    \"file:///Users/kghose/Code/cwltool/test/simple-wf.cwl#multi_out/output\": [\r\n        {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.1.txt\",\r\n            \"basename\": \"abc.1.txt\",\r\n            \"nameroot\": \"abc.1\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        },\r\n        {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.2.txt\",\r\n            \"basename\": \"abc.2.txt\",\r\n            \"nameroot\": \"abc.2\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$7448d8798a4380162d4b56f9b452e2f6f9e24e7a\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        },\r\n        {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.3.txt\",\r\n            \"basename\": \"abc.3.txt\",\r\n            \"nameroot\": \"abc.3\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$a3db5c13ff90a36963278c6a39e4ee3c22e2a436\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        },\r\n        {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.4.txt\",\r\n            \"basename\": \"abc.4.txt\",\r\n            \"nameroot\": \"abc.4\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$9c6b057a2b9d96a4067a749ee3b3b0158d390cf1\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        }\r\n    ]\r\n}\r\n[step multi_out] completed success\r\n[job multi_out] Removing input staging directory /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmpnsdq7h9e\r\n[job multi_out] Removing temporary directory /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0gw86z0h\r\n[workflow ] starting step str_cwl\r\n[step str_cwl] start\r\n[job str_cwl] initializing from file:///Users/kghose/Code/cwltool/test/file2file.cwl as part of step str_cwl\r\n[job str_cwl] {\r\n    \"input\": {\r\n        \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.1.txt\",\r\n        \"basename\": \"abc.1.txt\",\r\n        \"nameroot\": \"abc.1\",\r\n        \"nameext\": \".txt\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n        \"size\": 2,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[job str_cwl] path mappings is {\r\n    \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.1.txt\": [\r\n        \"/var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.1.txt\",\r\n        \"/private/var/lib/cwl/stg19abd386-12ce-4671-b3ea-8fa0b97d088d/abc.1.txt\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\n[job str_cwl] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ],\r\n        \"datum\": \"cat\"\r\n    },\r\n    {\r\n        \"position\": [\r\n            0,\r\n            0\r\n        ]\r\n    },\r\n    {\r\n        \"position\": [\r\n            0,\r\n            \"input\"\r\n        ],\r\n        \"valueFrom\": \"$(inputs.input.path)\",\r\n        \"datum\": {\r\n            \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.1.txt\",\r\n            \"basename\": \"abc.1.txt\",\r\n            \"nameroot\": \"abc.1\",\r\n            \"nameext\": \".txt\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$e5fa44f2b31c1fb553b6021e7360d07d5d91ff5e\",\r\n            \"size\": 2,\r\n            \"http://commonwl.org/cwltool#generation\": 0,\r\n            \"path\": \"/private/var/lib/cwl/stg19abd386-12ce-4671-b3ea-8fa0b97d088d/abc.1.txt\",\r\n            \"dirname\": \"/private/var/lib/cwl/stg19abd386-12ce-4671-b3ea-8fa0b97d088d\"\r\n        }\r\n    }\r\n]\r\n[job str_cwl] /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmpta08ypiu$ docker \\\r\n    run \\\r\n    -i \\\r\n    --volume=/private/var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmpta08ypiu:/private/var/spool/cwl:rw \\\r\n    --volume=/private/var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmphk1mlxpq:/tmp:rw \\\r\n    --volume=/var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.1.txt:/private/var/lib/cwl/stg19abd386-12ce-4671-b3ea-8fa0b97d088d/abc.1.txt:ro \\\r\n    --workdir=/private/var/spool/cwl \\\r\n    --read-only=true \\\r\n    --log-driver=none \\\r\n    --user=501:20 \\\r\n    --rm \\\r\n    --env=TMPDIR=/tmp \\\r\n    --env=HOME=/private/var/spool/cwl \\\r\n    alpine \\\r\n    cat \\\r\n    /private/var/lib/cwl/stg19abd386-12ce-4671-b3ea-8fa0b97d088d/abc.1.txt > /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmpta08ypiu/abc.1.txt.out.txt\r\ndocker: Error response from daemon: Mounts denied: \r\nThe path /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp0wtqnb9b/abc.1.txt\r\nis not shared from OS X and is not known to Docker.\r\nYou can configure shared paths from Docker -> Preferences... -> File Sharing.\r\nSee https://docs.docker.com/docker-for-mac/osxfs/#namespaces for more info.\r\n.\r\nERRO[0000] error waiting for container: context canceled \r\n[job str_cwl] completed permanentFail\r\n[job str_cwl] {\r\n    \"output\": {\r\n        \"location\": \"file:///var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmpta08ypiu/abc.1.txt.out.txt\",\r\n        \"basename\": \"abc.1.txt.out.txt\",\r\n        \"nameroot\": \"abc.1.txt.out\",\r\n        \"nameext\": \".txt\",\r\n        \"class\": \"File\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"size\": 0,\r\n        \"http://commonwl.org/cwltool#generation\": 0\r\n    }\r\n}\r\n[job str_cwl] Removing input staging directory /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp18swj9ni\r\n[job str_cwl] Removing temporary directory /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmphk1mlxpq\r\nWorkflow cannot make any more progress.\r\nRemoving intermediate output directory /var/folders/l7/wx3r7wbx6q3_1rv_mvv069h00000gn/T/tmp87eavwgg\r\nFinal process status is permanentFail\r\n```\r\n\r\nMay have something to do with https://docs.docker.com/docker-for-mac/osxfs/#namespaces\r\n\r\nWorkflow runs successfully with a500e8f\r\n\r\n## Your Environment\r\n* cwltool version: \r\nCheck using ``cwltool --version``\r\n~1.0.20180613204649~\r\ncwltool.py 1.0.20180615183820\r\n\r\n# Request\r\nI do have a request - when we have a set of major changes like this could we push first to `development` and then to `master` only after folks have had a chance to check things?\r\n\r\nThanks so much!\r\n-Kaushik", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/791", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/791/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/791/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/791/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/791", "id": 332044549, "node_id": "MDU6SXNzdWUzMzIwNDQ1NDk=", "number": 791, "title": "cwltool fails to run with an input of record and an InlineJavascriptRequirement", "user": {"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-06-13T15:21:11Z", "updated_at": "2018-08-06T14:22:42Z", "closed_at": "2018-08-06T14:22:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`test.cwl`\r\n```\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nrequirements:\r\n  - class: InlineJavascriptRequirement\r\nbaseCommand: ['echo']\r\n\r\ninputs:\r\n  - id: input\r\n    type:\r\n      type: record\r\n      fields: []\r\n\r\noutputs: []\r\n```\r\nfails with:\r\n```\r\n/Users/th10/checkouts/cwltool/venv/bin/cwltool 1.0.20180611202326\r\nResolved 'test.cwl' to 'file:///Users/th10/checkouts/cwltool/test.cwl'\r\nI'm sorry, I couldn't load this CWL file.  The error was:\r\nTraceback (most recent call last):\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/main.py\", line 527, in main\r\n    job_script_provider, make_tool_kwds)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/load_tool.py\", line 351, in make_tool\r\n    job_script_provider=job_script_provider, **kwargs)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/workflow.py\", line 51, in default_make_tool\r\n    force_docker_pull, job_script_provider, **kwargs)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/command_line_tool.py\", line 224, in __init__\r\n    force_docker_pull, job_script_provider, **kwargs)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/process.py\", line 568, in __init__\r\n    validate_js_expressions(cast(CommentedMap, toolpath_object), self.doc_schema.names[toolpath_object[\"class\"]], validate_js_options)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/validate_js.py\", line 181, in validate_js_expressions\r\n    expressions = get_expressions(tool, schema)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/validate_js.py\", line 76, in get_expressions\r\n    SourceLine(tool, schema_field.name)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/validate_js.py\", line 62, in get_expressions\r\n    map(lambda x: get_expressions(x[1], schema.items, SourceLine(tool, x[0])), enumerate(tool))  # type: ignore # https://github.com/python/mypy/issues/4679\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/validate_js.py\", line 62, in <lambda>\r\n    map(lambda x: get_expressions(x[1], schema.items, SourceLine(tool, x[0])), enumerate(tool))  # type: ignore # https://github.com/python/mypy/issues/4679\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/validate_js.py\", line 76, in get_expressions\r\n    SourceLine(tool, schema_field.name)\r\n  File \"/Users/th10/checkouts/cwltool/cwltool/validate_js.py\", line 55, in get_expressions\r\n    assert valid_schema is not None\r\nAssertionError\r\n```\r\nas https://github.com/common-workflow-language/cwltool/blob/886a6ac41c685f20d39e352f9c657e59f3312265/cwltool/validate_js.py#L51-L52 is parsing using strict validation and earlier parts of the code are setting the \"name\" attribute of records and arrays. This will also produce an error when someone is not strict validating a CWL script and a CWL warning would appear. A quick fix for this would be to get rid of the `strict=True` parameter.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/784", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/784/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/784/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/784/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/784", "id": 330875795, "node_id": "MDU6SXNzdWUzMzA4NzU3OTU=", "number": 784, "title": "mypy bug reference", "user": {"login": "kaushik-work", "id": 6299530, "node_id": "MDQ6VXNlcjYyOTk1MzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6299530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaushik-work", "html_url": "https://github.com/kaushik-work", "followers_url": "https://api.github.com/users/kaushik-work/followers", "following_url": "https://api.github.com/users/kaushik-work/following{/other_user}", "gists_url": "https://api.github.com/users/kaushik-work/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaushik-work/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaushik-work/subscriptions", "organizations_url": "https://api.github.com/users/kaushik-work/orgs", "repos_url": "https://api.github.com/users/kaushik-work/repos", "events_url": "https://api.github.com/users/kaushik-work/events{/privacy}", "received_events_url": "https://api.github.com/users/kaushik-work/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-06-09T10:47:11Z", "updated_at": "2018-06-11T20:24:08Z", "closed_at": "2018-06-11T20:24:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/common-workflow-language/cwltool/blob/65203c767d89d9ec779848a2ee80ab0a3c21de06/cwltool/workflow.py#L319\r\n\r\nHi @tetron , @gijzelaerr,\r\n\r\nI was going over the cwltool code (nice code, BTW. A joy to read and explore!) and I was exploring scatter and I found this reference to a mypy bug. This mypy bug is now closed. Was the current code a workaround? Can this workaround be dropped? (forgive me, I'm unfamiliar with mypy)\r\n\r\nThanks!\r\n-Kaushik", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/775", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/775/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/775/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/775/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/775", "id": 327016037, "node_id": "MDU6SXNzdWUzMjcwMTYwMzc=", "number": 775, "title": "--singularity with InitialWorkDirRequirement are not functional", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-28T12:50:31Z", "updated_at": "2018-10-11T19:25:17Z", "closed_at": "2018-10-11T19:25:17Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "See https://github.com/singularityware/singularity/issues/1607\r\nWe should document this this outside this issue", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/764", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/764/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/764/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/764/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/764", "id": 325038732, "node_id": "MDU6SXNzdWUzMjUwMzg3MzI=", "number": 764, "title": "cwltool --singularity failure with `ERROR  : Could not create /dev/loopX: Permission denied`", "user": {"login": "pvanheus", "id": 4154788, "node_id": "MDQ6VXNlcjQxNTQ3ODg=", "avatar_url": "https://avatars0.githubusercontent.com/u/4154788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvanheus", "html_url": "https://github.com/pvanheus", "followers_url": "https://api.github.com/users/pvanheus/followers", "following_url": "https://api.github.com/users/pvanheus/following{/other_user}", "gists_url": "https://api.github.com/users/pvanheus/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvanheus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvanheus/subscriptions", "organizations_url": "https://api.github.com/users/pvanheus/orgs", "repos_url": "https://api.github.com/users/pvanheus/repos", "events_url": "https://api.github.com/users/pvanheus/events{/privacy}", "received_events_url": "https://api.github.com/users/pvanheus/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-05-21T19:54:16Z", "updated_at": "2018-06-27T16:24:49Z", "closed_at": "2018-06-27T16:24:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected Behavior\r\n`cwltool --singularity` should work the same as without `--singularity`\r\n\r\n(Surprisingly (to me) `cwltoil` version 3.15.0 works correctly despite seeming to use the same version of `cwltool`)\r\n\r\n## Actual Behavior\r\n`cwltool --singularity reverse/reverse.cwl input.json` (CWL and  input JSON below) fails with an error:\r\n`ERROR  : Could not create /dev/loop10: Permission denied`\r\n\r\n## Workflow Code\r\n\r\n```\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\n\r\nhints:\r\n  DockerRequirement:\r\n    dockerPull: pvanheus/reverse:latest\r\n\r\nbaseCommand: reverse.py\r\n\r\ninputs:\r\n  dnafile:\r\n    type: File\r\n    inputBinding:\r\n      position: 1\r\n\r\nstdout: $(inputs.dnafile.nameroot)_reversed$(inputs.dnafile.nameext)\r\n\r\noutputs:\r\n  rev_dnafile:\r\n    type: stdout\r\n```\r\nwith input.json:\r\n```json\r\ndnafile:\r\n  class: File\r\n  path: data/dna.txt\r\n```\r\n\r\nwhere `dna/dna.txt` is simply a text file with the string `GATACCA`.\r\n\r\n## Full Traceback\r\n```pytb\r\n$ cwltool --singularity --debug reverse/reverse.cwl input.json\r\n/home/pvh/anaconda3/bin/cwltool 1.0.20180518123035\r\nResolved 'reverse/reverse.cwl' to 'file:///home/pvh/Documents/SANBI/biocourse2017/cwltutorial/reverse/reverse.cwl'\r\n[job reverse.cwl] initializing from file:///home/pvh/Documents/SANBI/biocourse2017/cwltutorial/reverse/reverse.cwl\r\n[job reverse.cwl] {\r\n    \"dnafile\": {\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///home/pvh/Documents/SANBI/biocourse2017/cwltutorial/data/dna.txt\",\r\n        \"size\": 8,\r\n        \"basename\": \"dna.txt\",\r\n        \"nameroot\": \"dna\",\r\n        \"nameext\": \".txt\"\r\n    }\r\n}\r\n[job reverse.cwl] path mappings is {\r\n    \"file:///home/pvh/Documents/SANBI/biocourse2017/cwltutorial/data/dna.txt\": [\r\n        \"/home/pvh/Documents/SANBI/biocourse2017/cwltutorial/data/dna.txt\",\r\n        \"/var/lib/cwl/stgf6ec8e0d-317b-4ea4-947f-39cb93d45be7/dna.txt\",\r\n        \"File\",\r\n        true\r\n    ]\r\n}\r\n[job reverse.cwl] command line bindings is [\r\n    {\r\n        \"datum\": \"reverse.py\",\r\n        \"position\": [\r\n            -1000000,\r\n            0\r\n        ]\r\n    },\r\n    {\r\n        \"position\": [\r\n            1,\r\n            \"dnafile\"\r\n        ],\r\n        \"datum\": {\r\n            \"class\": \"File\",\r\n            \"location\": \"file:///home/pvh/Documents/SANBI/biocourse2017/cwltutorial/data/dna.txt\",\r\n            \"size\": 8,\r\n            \"basename\": \"dna.txt\",\r\n            \"nameroot\": \"dna\",\r\n            \"nameext\": \".txt\",\r\n            \"path\": \"/var/lib/cwl/stgf6ec8e0d-317b-4ea4-947f-39cb93d45be7/dna.txt\",\r\n            \"dirname\": \"/var/lib/cwl/stgf6ec8e0d-317b-4ea4-947f-39cb93d45be7\"\r\n        }\r\n    }\r\n]\r\nUsing local copy of Singularity image found in /home/pvh/Documents/SANBI/biocourse2017/cwltutorial\r\n[job reverse.cwl] /tmp/tmp7og2_8lt$ singularity \\\r\n    --quiet \\\r\n    exec \\\r\n    --contain \\\r\n    --pid \\\r\n    --ipc \\\r\n    --userns \\\r\n    --bind \\\r\n    /tmp/tmp7og2_8lt:/var/spool/cwl:rw \\\r\n    --bind \\\r\n    /tmp/tmpzrruu5fi:/tmp:rw \\\r\n    --bind \\\r\n    /home/pvh/Documents/SANBI/biocourse2017/cwltutorial/data/dna.txt:/var/lib/cwl/stgf6ec8e0d-317b-4ea4-947f-39cb93d45be7/dna.txt:ro \\\r\n    --pwd \\\r\n    /var/spool/cwl \\\r\n    /home/pvh/Documents/SANBI/biocourse2017/cwltutorial/pvanheus-reverse-latest.img \\\r\n    reverse.py \\\r\n    /var/lib/cwl/stgf6ec8e0d-317b-4ea4-947f-39cb93d45be7/dna.txt > /tmp/tmp7og2_8lt/dna_reversed.txt\r\nERROR  : Could not create /dev/loop10: Permission denied\r\nABORT  : Retval = 255\r\n[job reverse.cwl] completed permanentFail\r\n[job reverse.cwl] {\r\n    \"rev_dnafile\": {\r\n        \"http://commonwl.org/cwltool#generation\": 0,\r\n        \"nameext\": \".txt\",\r\n        \"class\": \"File\",\r\n        \"location\": \"file:///tmp/tmp7og2_8lt/dna_reversed.txt\",\r\n        \"nameroot\": \"dna_reversed\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"basename\": \"dna_reversed.txt\",\r\n        \"size\": 0\r\n    }\r\n}\r\n[job reverse.cwl] Removing input staging directory /tmp/tmpfrhy46i2\r\n[job reverse.cwl] Removing temporary directory /tmp/tmpzrruu5fi\r\nMoving /tmp/tmp7og2_8lt/dna_reversed.txt to /home/pvh/Documents/SANBI/biocourse2017/cwltutorial/dna_reversed.txt\r\nRemoving intermediate output directory /tmp/tmp7og2_8lt\r\n{\r\n    \"rev_dnafile\": {\r\n        \"class\": \"File\",\r\n        \"path\": \"/home/pvh/Documents/SANBI/biocourse2017/cwltutorial/dna_reversed.txt\",\r\n        \"location\": \"file:///home/pvh/Documents/SANBI/biocourse2017/cwltutorial/dna_reversed.txt\",\r\n        \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n        \"basename\": \"dna_reversed.txt\",\r\n        \"size\": 0\r\n    }\r\n}\r\nFinal process status is permanentFail\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180518123035\r\n* singularity version: 2.5.1-dist\r\n* operating system version: Ubuntu 16.04.4 LTS\r\n* kernel version: 4.4.0-124-generic #148-Ubuntu\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/760", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/760/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/760/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/760/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/760", "id": 324310393, "node_id": "MDU6SXNzdWUzMjQzMTAzOTM=", "number": 760, "title": "default fill in fail for dynamic resource requirements: optional input connected to step with required input File that has a default value", "user": {"login": "mr-c", "id": 1330696, "node_id": "MDQ6VXNlcjEzMzA2OTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1330696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-c", "html_url": "https://github.com/mr-c", "followers_url": "https://api.github.com/users/mr-c/followers", "following_url": "https://api.github.com/users/mr-c/following{/other_user}", "gists_url": "https://api.github.com/users/mr-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-c/subscriptions", "organizations_url": "https://api.github.com/users/mr-c/orgs", "repos_url": "https://api.github.com/users/mr-c/repos", "events_url": "https://api.github.com/users/mr-c/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-c/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-05-18T08:06:51Z", "updated_at": "2018-05-18T12:16:00Z", "closed_at": "2018-05-18T12:16:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Same test case as in https://github.com/common-workflow-language/cwltool/issues/759\r\nHere's the output minus the erroneous warning reported there:\r\n```\r\n/home/mcrusoe/src/toil/venv/bin/cwltool 1.0.20180508202931\r\nResolved 'v1.0/dynresreq-workflow.cwl' to 'file:///home/mcrusoe/common-workflow-language/v1.0/v1.0/dynresreq-workflow.cwl'\r\nParsed job order from command line: {\r\n    \"special_file\": null, \r\n    \"id\": \"v1.0/dynresreq-workflow.cwl\"\r\n}\r\n[workflow dynresreq-workflow.cwl] initialized from file:///home/mcrusoe/common-workflow-language/v1.0/v1.0/dynresreq-workflow.cwl\r\n[workflow dynresreq-workflow.cwl] start\r\n[workflow dynresreq-workflow.cwl] starting step count\r\n[job step count] job input {\r\n    \"file:///home/mcrusoe/common-workflow-language/v1.0/v1.0/dynresreq-workflow.cwl#count/special_file\": {\r\n        \"class\": \"File\", \r\n        \"location\": \"file:///home/mcrusoe/common-workflow-language/v1.0/v1.0/special_file\"\r\n    }\r\n}\r\n[job step count] evaluated job input to {\r\n    \"file:///home/mcrusoe/common-workflow-language/v1.0/v1.0/dynresreq-workflow.cwl#count/special_file\": {\r\n        \"class\": \"File\", \r\n        \"location\": \"file:///home/mcrusoe/common-workflow-language/v1.0/v1.0/special_file\"\r\n    }\r\n}\r\n[step count] start\r\nException on step 'count'\r\n[step count] Cannot make job: Expression evaluation error:\r\nSyntax error in parameter reference 'inputs.special_file.size': inputs.special_file.size does not contain key 'size'. This could be due to using Javascript code without specifying InlineJavascriptRequirement.\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/workflow.py\", line 400, in job\r\n    for newjob in step.iterable:\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/workflow.py\", line 347, in try_make_job\r\n    for j in jobs:\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/workflow.py\", line 169, in job\r\n    for j in self.step.job(joborder, output_callback, **kwargs):\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/workflow.py\", line 646, in job\r\n    **kwargs):\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/command_line_tool.py\", line 341, in job\r\n    builder = self._init_job(job_order, **kwargs)\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/process.py\", line 672, in _init_job\r\n    builder.resources = self.evalResources(builder, kwargs)\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/process.py\", line 695, in evalResources\r\n    mn = builder.do_eval(resourceReq[a + \"Min\"])\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/builder.py\", line 337, in do_eval\r\n    strip_whitespace=strip_whitespace)\r\n  File \"/home/mcrusoe/src/toil/venv/local/lib/python2.7/site-packages/cwltool/expression.py\", line 261, in do_eval\r\n    raise WorkflowException(\"Expression evaluation error:\\n%s\" % e)\r\nWorkflowException: Expression evaluation error:\r\nSyntax error in parameter reference 'inputs.special_file.size': inputs.special_file.size does not contain key 'size'. This could be due to using Javascript code without specifying InlineJavascriptRequirement.\r\n[workflow dynresreq-workflow.cwl] completed permanentFail\r\nRemoving intermediate output directory /tmp/tmpQtgo_k\r\n{\r\n    \"cores\": null\r\n}\r\nFinal process status is permanentFail\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/754", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/754/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/754/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/754/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/754", "id": 324013040, "node_id": "MDU6SXNzdWUzMjQwMTMwNDA=", "number": 754, "title": "singularity image pull triggered for every step when using beegfs", "user": {"login": "gijzelaerr", "id": 326308, "node_id": "MDQ6VXNlcjMyNjMwOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/326308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gijzelaerr", "html_url": "https://github.com/gijzelaerr", "followers_url": "https://api.github.com/users/gijzelaerr/followers", "following_url": "https://api.github.com/users/gijzelaerr/following{/other_user}", "gists_url": "https://api.github.com/users/gijzelaerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gijzelaerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gijzelaerr/subscriptions", "organizations_url": "https://api.github.com/users/gijzelaerr/orgs", "repos_url": "https://api.github.com/users/gijzelaerr/repos", "events_url": "https://api.github.com/users/gijzelaerr/events{/privacy}", "received_events_url": "https://api.github.com/users/gijzelaerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-17T13:02:04Z", "updated_at": "2018-05-17T15:35:34Z", "closed_at": "2018-05-17T15:35:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/752", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/752/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/752/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/752/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/752", "id": 324012051, "node_id": "MDU6SXNzdWUzMjQwMTIwNTE=", "number": 752, "title": "Permission denied: '/var/spool/cwl' while running with singularity with writable dir & without inplace update", "user": {"login": "gijzelaerr", "id": 326308, "node_id": "MDQ6VXNlcjMyNjMwOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/326308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gijzelaerr", "html_url": "https://github.com/gijzelaerr", "followers_url": "https://api.github.com/users/gijzelaerr/followers", "following_url": "https://api.github.com/users/gijzelaerr/following{/other_user}", "gists_url": "https://api.github.com/users/gijzelaerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gijzelaerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gijzelaerr/subscriptions", "organizations_url": "https://api.github.com/users/gijzelaerr/orgs", "repos_url": "https://api.github.com/users/gijzelaerr/repos", "events_url": "https://api.github.com/users/gijzelaerr/events{/privacy}", "received_events_url": "https://api.github.com/users/gijzelaerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-17T12:59:29Z", "updated_at": "2018-05-17T17:23:10Z", "closed_at": "2018-05-17T17:23:10Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "while running toil with singularity we run into troubles:\r\n\r\nrepo: https://github.com/gijzelaerr/spiel/\r\ncommand: make srun\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/users/gijs/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/executors.py\", line 108, in run_jobs\r\n    r.run(**kwargs)\r\n  File \"/users/gijs/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/job.py\", line 404, in run\r\n    runtime = self.create_runtime(env, rm_container, record_container_id, cidfile_dir, cidfile_prefix, **kwargs)\r\n  File \"/users/gijs/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/singularity.py\", line 232, in create_runtime\r\n    self.add_volumes(self.generatemapper, runtime, stage_output=True)\r\n  File \"/users/gijs/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/singularity.py\", line 198, in add_volumes\r\n    shutil.copytree(vol.resolved, vol.target)\r\n  File \"/usr/lib/python2.7/shutil.py\", line 177, in copytree\r\n    os.makedirs(dst)\r\n  File \"/users/gijs/spiel/.virtualenv/lib/python2.7/os.py\", line 150, in makedirs\r\n    makedirs(head, mode)\r\n  File \"/users/gijs/spiel/.virtualenv/lib/python2.7/os.py\", line 157, in makedirs\r\n    mkdir(name, mode)\r\nOSError: [Errno 13] Permission denied: '/var/spool/cwl'\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/749", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/749/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/749/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/749/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/749", "id": 323117217, "node_id": "MDU6SXNzdWUzMjMxMTcyMTc=", "number": 749, "title": "File entries of listing in a directory input do not have size filled in", "user": {"login": "pkp124", "id": 1933465, "node_id": "MDQ6VXNlcjE5MzM0NjU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1933465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pkp124", "html_url": "https://github.com/pkp124", "followers_url": "https://api.github.com/users/pkp124/followers", "following_url": "https://api.github.com/users/pkp124/following{/other_user}", "gists_url": "https://api.github.com/users/pkp124/gists{/gist_id}", "starred_url": "https://api.github.com/users/pkp124/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pkp124/subscriptions", "organizations_url": "https://api.github.com/users/pkp124/orgs", "repos_url": "https://api.github.com/users/pkp124/repos", "events_url": "https://api.github.com/users/pkp124/events{/privacy}", "received_events_url": "https://api.github.com/users/pkp124/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 269875289, "node_id": "MDU6TGFiZWwyNjk4NzUyODk=", "url": "https://api.github.com/repos/common-workflow-language/cwltool/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-05-15T08:33:34Z", "updated_at": "2018-05-15T13:55:26Z", "closed_at": "2018-05-15T13:47:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nThe file entries in the listing field of a directory input only fills in the location and basename fields.\r\nPlease see https://github.com/common-workflow-language/cwltool/blob/33c2358a76c57ae06888203a2384c869b87e369e/cwltool/pathmapper.py#L132\r\n\r\nFilling in the other fields of the file structure may be helpful. For now, I have the use case of using the \"size\" field for resource calculations. \r\n\r\nThanks\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/743", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/743/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/743/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/743/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/743", "id": 322053867, "node_id": "MDU6SXNzdWUzMjIwNTM4Njc=", "number": 743, "title": "Searching for node/nodejs in sandboxjs.py broken", "user": {"login": "slottad", "id": 474527, "node_id": "MDQ6VXNlcjQ3NDUyNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/474527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/slottad", "html_url": "https://github.com/slottad", "followers_url": "https://api.github.com/users/slottad/followers", "following_url": "https://api.github.com/users/slottad/following{/other_user}", "gists_url": "https://api.github.com/users/slottad/gists{/gist_id}", "starred_url": "https://api.github.com/users/slottad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/slottad/subscriptions", "organizations_url": "https://api.github.com/users/slottad/orgs", "repos_url": "https://api.github.com/users/slottad/repos", "events_url": "https://api.github.com/users/slottad/events{/privacy}", "received_events_url": "https://api.github.com/users/slottad/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-05-10T19:28:46Z", "updated_at": "2018-05-18T12:30:35Z", "closed_at": "2018-05-18T12:30:35Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected Behavior\r\nChecking for the existence of nodejs or node should not throw an exception.\r\n\r\n## Actual Behavior\r\nThe code that checks for the presence of node/nodejs does not catch the correct exception when a given binary is not present. It should just gracefully catch the exception an move on with its life.\r\n\r\n## Proposed fix\r\nChange line 81 of sandboxjs.py from:\r\n```python\r\n        except OSError as e:\r\n            if e.errno == errno.ENOENT:\r\n                pass\r\n            else:\r\n                raise\r\n```\r\nto:\r\n```python\r\n        except OSError as e:\r\n            if e.errno == errno.ENOENT or e.errno == errno.EACCES:                                                                                                                                                          \r\n                pass\r\n            else:\r\n                raise\r\n```\r\n\r\n## Workflow Code\r\nRunning part 13 of the tutorial on CentOS 7, with nodejs-6.11.1-1.el7.x86_64 installed is sufficient  (i.e. node, not nodejs is the name of the binary).\r\n\r\n## Full Traceback\r\n```pytb\r\n(cwl) [gpdock02]~/cloud/test/cwl_experiments$ cwltool --debug expression.cwl empty.yml \r\n/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/bin/cwltool 1.0.20180508202931\r\nResolved 'expression.cwl' to 'file:///panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/test/cwl_experiments/expression.cwl'\r\nI'm sorry, I couldn't load this CWL file.  The error was:\r\nTraceback (most recent call last):\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/main.py\", line 502, in main\r\n    makeTool, make_tool_kwds)\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/load_tool.py\", line 341, in make_tool\r\n    tool = makeTool(processobj, **kwargs)\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/workflow.py\", line 40, in defaultMakeTool\r\n    return command_line_tool.CommandLineTool(toolpath_object, **kwargs)\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/command_line_tool.py\", line 200, in __init__\r\n    super(CommandLineTool, self).__init__(toolpath_object, **kwargs)\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/process.py\", line 527, in __init__\r\n    validate_js_expressions(cast(CommentedMap, toolpath_object), self.doc_schema.names[toolpath_object[\"class\"]], validate_js_options)\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/validate_js.py\", line 187, in validate_js_expressions\r\n    expression_errors, _ = jshint_js(code_fragment_js, js_globals, jshint_options)\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/validate_js.py\", line 113, in jshint_js\r\n    context=jshint_functions_text\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/sandboxjs.py\", line 162, in exec_js_process\r\n    new_proc = new_js_proc(js_engine_code, force_docker_pull=force_docker_pull)\r\n  File \"/panfs/pan1.be-md.ncbi.nlm.nih.gov/gpipe/home/slottad/cloud/virtenvs/cwl/lib/python3.6/site-packages/cwltool/sandboxjs.py\", line 68, in new_js_proc\r\n    if subprocess.check_output([n, \"--eval\", \"process.stdout.write('t')\"]).decode('utf-8') != \"t\":\r\n  File \"/opt/python-3.6/lib/python3.6/subprocess.py\", line 336, in check_output\r\n    **kwargs).stdout\r\n  File \"/opt/python-3.6/lib/python3.6/subprocess.py\", line 403, in run\r\n    with Popen(*popenargs, **kwargs) as process:\r\n  File \"/opt/python-3.6/lib/python3.6/subprocess.py\", line 707, in __init__\r\n    restore_signals, start_new_session)\r\n  File \"/opt/python-3.6/lib/python3.6/subprocess.py\", line 1333, in _execute_child\r\n    raise child_exception_type(errno_num, err_msg)\r\nPermissionError: [Errno 13] Permission denied\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180508202931\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/740", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/740/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/740/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/740/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/740", "id": 321524994, "node_id": "MDU6SXNzdWUzMjE1MjQ5OTQ=", "number": 740, "title": "Caching fails to work properly when using the same dockerised tool in different steps", "user": {"login": "ThomasHickman", "id": 6304200, "node_id": "MDQ6VXNlcjYzMDQyMDA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6304200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasHickman", "html_url": "https://github.com/ThomasHickman", "followers_url": "https://api.github.com/users/ThomasHickman/followers", "following_url": "https://api.github.com/users/ThomasHickman/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasHickman/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasHickman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasHickman/subscriptions", "organizations_url": "https://api.github.com/users/ThomasHickman/orgs", "repos_url": "https://api.github.com/users/ThomasHickman/repos", "events_url": "https://api.github.com/users/ThomasHickman/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasHickman/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-09T10:59:32Z", "updated_at": "2018-05-10T06:56:13Z", "closed_at": "2018-05-10T06:56:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "https://github.com/common-workflow-language/cwltool/blob/9e3e720ffc18ade0a19fdbb2bea1bed25e9662ae/cwltool/command_line_tool.py#L299-L302\r\n\r\nThis uses self.requirement and self.hints, which are mutated when a tool is run:\r\n\r\nhttps://github.com/common-workflow-language/cwltool/blob/9e3e720ffc18ade0a19fdbb2bea1bed25e9662ae/cwltool/docker.py#L39-L40\r\n\r\nIf a workflow uses the same tool multiple times, whether a cache hit occurs for a step will depend on whether the same tool has been run before or not.\r\n\r\n## Example\r\n\r\n### Inputs\r\n\r\n<details><summary>test_workflow.cwl</summary>\r\n<p>\r\n\r\n    #!/usr/bin/env cwl-runner\r\n\r\n    cwlVersion: v1.0\r\n    class: Workflow\r\n\r\n    inputs: []\r\n    outputs: []\r\n\r\n    steps:\r\n    task1:\r\n        run: test_tool.cwl\r\n        in:\r\n        message:\r\n            default: one\r\n        out: []\r\n    task2:\r\n        run: test_tool.cwl\r\n        in:\r\n        message:\r\n            default: two\r\n        out: []\r\n</p>\r\n</details>\r\n\r\n<details><summary>test_tool.cwl</summary>\r\n<p>\r\n\r\n    #!/usr/bin/env cwl-runner\r\n\r\n    cwlVersion: v1.0\r\n    class: CommandLineTool\r\n    baseCommand: touch\r\n    requirements:\r\n    DockerRequirement:\r\n        dockerPull: alpine\r\n    inputs:\r\n    message:\r\n        type: string\r\n        inputBinding:\r\n        position: 1\r\n    outputs:\r\n    - id: out\r\n        type: File\r\n        outputBinding:\r\n        glob: \"*\"\r\n</p>\r\n</details>\r\n\r\n### Runs\r\n\r\n<details><summary>Run 1</summary>\r\n<p>\r\n\r\n    $ python -m cwltool --debug --cachedir test_cache test_workflow.cwl\r\n    /Users/th10/checkouts/cwltool/cwltool/__main__.py 1.0.20180324152842\r\n    Resolved 'test_workflow.cwl' to 'file:///Users/th10/checkouts/cwltool/test_workflow.cwl'\r\n    Parsed job order from command line: {\r\n        \"id\": \"test_workflow.cwl\"\r\n    }\r\n    [workflow test_workflow.cwl] initialized from file:///Users/th10/checkouts/cwltool/test_workflow.cwl\r\n    [workflow test_workflow.cwl] start\r\n    [workflow test_workflow.cwl] starting step task1\r\n    [job step task1] job input {\r\n        \"file:///Users/th10/checkouts/cwltool/test_workflow.cwl#task1/message\": \"one\"\r\n    }\r\n    [job step task1] evaluated job input to {\r\n        \"file:///Users/th10/checkouts/cwltool/test_workflow.cwl#task1/message\": \"one\"\r\n    }\r\n    [step task1] start\r\n    [job task1] keydictstr is {\"DockerRequirement\":{\"class\":\"DockerRequirement\",\"dockerPull\":\"alpine\"},\"cmdline\":[\"docker\",\"run\",\"alpine\",\"touch\",\"one\"]} -> 3a88555659d51a9ec2330d04380240f8\r\n    [job task1] Output of job will be cached in /Users/th10/checkouts/cwltool/test_cache/3a88555659d51a9ec2330d04380240f8\r\n    [job task1] initializing from file:///Users/th10/checkouts/cwltool/test_tool.cwl as part of step task1\r\n    [job task1] {\r\n        \"message\": \"one\"\r\n    }\r\n    [job task1] path mappings is {}\r\n    [job task1] command line bindings is [\r\n        {\r\n            \"position\": [\r\n                -1000000,\r\n                0\r\n            ],\r\n            \"datum\": \"touch\"\r\n        },\r\n        {\r\n            \"position\": [\r\n                1,\r\n                \"message\"\r\n            ],\r\n            \"datum\": \"one\"\r\n        }\r\n    ]\r\n    [job task1] /Users/th10/checkouts/cwltool/test_cache/3a88555659d51a9ec2330d04380240f8$ docker \\\r\n        run \\\r\n        -i \\\r\n        --volume=/Users/th10/checkouts/cwltool/test_cache/3a88555659d51a9ec2330d04380240f8:/private/var/spool/cwl:rw \\\r\n        --volume=/private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmp2l4eeu6t:/tmp:rw \\\r\n        --workdir=/private/var/spool/cwl \\\r\n        --read-only=true \\\r\n        --user=16442:1312 \\\r\n        --rm \\\r\n        --env=TMPDIR=/tmp \\\r\n        --env=HOME=/private/var/spool/cwl \\\r\n        alpine \\\r\n        touch \\\r\n        one\r\n    [job task1] completed success\r\n    [job task1] {\r\n        \"out\": {\r\n            \"location\": \"file:///Users/th10/checkouts/cwltool/test_cache/3a88555659d51a9ec2330d04380240f8/one\",\r\n            \"basename\": \"one\",\r\n            \"nameroot\": \"one\",\r\n            \"nameext\": \"\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n            \"size\": 0,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        }\r\n    }\r\n    [step task1] produced output {}\r\n    [step task1] completed success\r\n    [job task1] Removing input staging directory /private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpdnakizoe\r\n    [job task1] Removing temporary directory /private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmp2l4eeu6t\r\n    [workflow test_workflow.cwl] starting step task2\r\n    [job step task2] job input {\r\n        \"file:///Users/th10/checkouts/cwltool/test_workflow.cwl#task2/message\": \"two\"\r\n    }\r\n    [job step task2] evaluated job input to {\r\n        \"file:///Users/th10/checkouts/cwltool/test_workflow.cwl#task2/message\": \"two\"\r\n    }\r\n    [step task2] start\r\n    [job task2] keydictstr is {\"DockerRequirement\":{\"class\":\"DockerRequirement\",\"dockerImageId\":\"alpine\",\"dockerPull\":\"alpine\"},\"cmdline\":[\"docker\",\"run\",\"alpine\",\"touch\",\"two\"]} -> 6cfa521e843e7c924b71f93e1156b7d5\r\n    [job task2] Output of job will be cached in /Users/th10/checkouts/cwltool/test_cache/6cfa521e843e7c924b71f93e1156b7d5\r\n    [job task2] initializing from file:///Users/th10/checkouts/cwltool/test_tool.cwl as part of step task2\r\n    [job task2] {\r\n        \"message\": \"two\"\r\n    }\r\n    [job task2] path mappings is {}\r\n    [job task2] command line bindings is [\r\n        {\r\n            \"position\": [\r\n                -1000000,\r\n                0\r\n            ],\r\n            \"datum\": \"touch\"\r\n        },\r\n        {\r\n            \"position\": [\r\n                1,\r\n                \"message\"\r\n            ],\r\n            \"datum\": \"two\"\r\n        }\r\n    ]\r\n    [job task2] /Users/th10/checkouts/cwltool/test_cache/6cfa521e843e7c924b71f93e1156b7d5$ docker \\\r\n        run \\\r\n        -i \\\r\n        --volume=/Users/th10/checkouts/cwltool/test_cache/6cfa521e843e7c924b71f93e1156b7d5:/private/var/spool/cwl:rw \\\r\n        --volume=/private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmp18ovy8e_:/tmp:rw \\\r\n        --workdir=/private/var/spool/cwl \\\r\n        --read-only=true \\\r\n        --user=16442:1312 \\\r\n        --rm \\\r\n        --env=TMPDIR=/tmp \\\r\n        --env=HOME=/private/var/spool/cwl \\\r\n        alpine \\\r\n        touch \\\r\n        two\r\n    [job task2] completed success\r\n    [job task2] {\r\n        \"out\": {\r\n            \"location\": \"file:///Users/th10/checkouts/cwltool/test_cache/6cfa521e843e7c924b71f93e1156b7d5/two\",\r\n            \"basename\": \"two\",\r\n            \"nameroot\": \"two\",\r\n            \"nameext\": \"\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n            \"size\": 0,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        }\r\n    }\r\n    [step task2] produced output {}\r\n    [step task2] completed success\r\n    [workflow test_workflow.cwl] completed success\r\n    [job task2] Removing input staging directory /private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmp3hswvlmo\r\n    [job task2] Removing temporary directory /private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmp18ovy8e_\r\n    Removing intermediate output directory /Users/th10/checkouts/cwltool/test_cache/mmtlw31b\r\n    {}\r\n    Final process status is success\r\n\r\n</p>\r\n</details>\r\n\r\n<details><summary>Run 2</summary>\r\n<p>\r\n\r\n    $ python -m cwltool --debug --cachedir test_cache test_workflow.cwl\r\n    /Users/th10/checkouts/cwltool/cwltool/__main__.py 1.0.20180324152842\r\n    Resolved 'test_workflow.cwl' to 'file:///Users/th10/checkouts/cwltool/test_workflow.cwl'\r\n    Parsed job order from command line: {\r\n        \"id\": \"test_workflow.cwl\"\r\n    }\r\n    [workflow test_workflow.cwl] initialized from file:///Users/th10/checkouts/cwltool/test_workflow.cwl\r\n    [workflow test_workflow.cwl] start\r\n    [workflow test_workflow.cwl] starting step task1\r\n    [job step task1] job input {\r\n        \"file:///Users/th10/checkouts/cwltool/test_workflow.cwl#task1/message\": \"one\"\r\n    }\r\n    [job step task1] evaluated job input to {\r\n        \"file:///Users/th10/checkouts/cwltool/test_workflow.cwl#task1/message\": \"one\"\r\n    }\r\n    [step task1] start\r\n    [job task1] keydictstr is {\"DockerRequirement\":{\"class\":\"DockerRequirement\",\"dockerPull\":\"alpine\"},\"cmdline\":[\"docker\",\"run\",\"alpine\",\"touch\",\"one\"]} -> 3a88555659d51a9ec2330d04380240f8\r\n    [job task1] Using cached output in /Users/th10/checkouts/cwltool/test_cache/3a88555659d51a9ec2330d04380240f8\r\n    [step task1] produced output {}\r\n    [step task1] completed success\r\n    [workflow test_workflow.cwl] starting step task2\r\n    [job step task2] job input {\r\n        \"file:///Users/th10/checkouts/cwltool/test_workflow.cwl#task2/message\": \"two\"\r\n    }\r\n    [job step task2] evaluated job input to {\r\n        \"file:///Users/th10/checkouts/cwltool/test_workflow.cwl#task2/message\": \"two\"\r\n    }\r\n    [step task2] start\r\n    [job task2] keydictstr is {\"DockerRequirement\":{\"class\":\"DockerRequirement\",\"dockerPull\":\"alpine\"},\"cmdline\":[\"docker\",\"run\",\"alpine\",\"touch\",\"two\"]} -> 5115cb5a928586f413deadf8090375a9\r\n    [job task2] Output of job will be cached in /Users/th10/checkouts/cwltool/test_cache/5115cb5a928586f413deadf8090375a9\r\n    [job task2] initializing from file:///Users/th10/checkouts/cwltool/test_tool.cwl as part of step task2\r\n    [job task2] {\r\n        \"message\": \"two\"\r\n    }\r\n    [job task2] path mappings is {}\r\n    [job task2] command line bindings is [\r\n        {\r\n            \"position\": [\r\n                -1000000,\r\n                0\r\n            ],\r\n            \"datum\": \"touch\"\r\n        },\r\n        {\r\n            \"position\": [\r\n                1,\r\n                \"message\"\r\n            ],\r\n            \"datum\": \"two\"\r\n        }\r\n    ]\r\n    [job task2] /Users/th10/checkouts/cwltool/test_cache/5115cb5a928586f413deadf8090375a9$ docker \\\r\n        run \\\r\n        -i \\\r\n        --volume=/Users/th10/checkouts/cwltool/test_cache/5115cb5a928586f413deadf8090375a9:/private/var/spool/cwl:rw \\\r\n        --volume=/private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmph12do9a5:/tmp:rw \\\r\n        --workdir=/private/var/spool/cwl \\\r\n        --read-only=true \\\r\n        --user=16442:1312 \\\r\n        --rm \\\r\n        --env=TMPDIR=/tmp \\\r\n        --env=HOME=/private/var/spool/cwl \\\r\n        alpine \\\r\n        touch \\\r\n        two\r\n    [job task2] completed success\r\n    [job task2] {\r\n        \"out\": {\r\n            \"location\": \"file:///Users/th10/checkouts/cwltool/test_cache/5115cb5a928586f413deadf8090375a9/two\",\r\n            \"basename\": \"two\",\r\n            \"nameroot\": \"two\",\r\n            \"nameext\": \"\",\r\n            \"class\": \"File\",\r\n            \"checksum\": \"sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709\",\r\n            \"size\": 0,\r\n            \"http://commonwl.org/cwltool#generation\": 0\r\n        }\r\n    }\r\n    [step task2] produced output {}\r\n    [step task2] completed success\r\n    [workflow test_workflow.cwl] completed success\r\n    [job task2] Removing input staging directory /private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmpkma3bhie\r\n    [job task2] Removing temporary directory /private/var/folders/5p/p6z8hhy174q_ctt3pn7mx5_c000h1t/T/tmph12do9a5\r\n    Removing intermediate output directory /Users/th10/checkouts/cwltool/test_cache/025t0_5x\r\n    {}\r\n    Final process status is success\r\n</p>\r\n</details>\r\n\r\n---\r\n\r\nFrom the above output, you can see that task2 doesn't have a cache hit, as task1 didn't run, due to it being cached.\r\n\r\nA simple way to fix this is to add a `original_requirements` and `original_hints` property, which doesn't get mutated by cwltool - this can be used for cache decisions. I can have a look at submitting a PR for this.\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180324152842", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/728", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/728/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/728/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/728/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/728", "id": 317593476, "node_id": "MDU6SXNzdWUzMTc1OTM0NzY=", "number": 728, "title": "Using a singularity image", "user": {"login": "SpheMakh", "id": 6624280, "node_id": "MDQ6VXNlcjY2MjQyODA=", "avatar_url": "https://avatars3.githubusercontent.com/u/6624280?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SpheMakh", "html_url": "https://github.com/SpheMakh", "followers_url": "https://api.github.com/users/SpheMakh/followers", "following_url": "https://api.github.com/users/SpheMakh/following{/other_user}", "gists_url": "https://api.github.com/users/SpheMakh/gists{/gist_id}", "starred_url": "https://api.github.com/users/SpheMakh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SpheMakh/subscriptions", "organizations_url": "https://api.github.com/users/SpheMakh/orgs", "repos_url": "https://api.github.com/users/SpheMakh/repos", "events_url": "https://api.github.com/users/SpheMakh/events{/privacy}", "received_events_url": "https://api.github.com/users/SpheMakh/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-04-25T11:49:01Z", "updated_at": "2018-04-26T12:07:15Z", "closed_at": "2018-04-26T12:07:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "---\r\n\r\n## Expected Behavior\r\nRun software inside a singularity container specified via `DockerRequirement.dockerImageId` using an existing image.\r\n\r\n## Actual Behavior\r\ncwltool cannot find the image\r\n\r\n## Workflow Code\r\n```\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\n\r\nhints:\r\n  DockerRequirement:\r\n      dockerImageId: gijzelaerr/spiel\r\n\r\nbaseCommand: [echo, hello]\r\n\r\ninputs:\r\n  []\r\n\r\noutputs:\r\n  []\r\n\r\n```\r\n\r\n## Full Traceback\r\n```pytb\r\nsphe@master001:~/spiel$ .virtualenv/bin/cwltool --debug --singularity singularity-run.cwl\r\n.virtualenv/bin/cwltool 1.0.20180403145700\r\nResolved 'singularity-run.cwl' to 'file:///users/sphe/spiel/singularity-run.cwl'\r\nParsed job order from command line: {\r\n    \"id\": \"singularity-run.cwl\"\r\n}\r\n[job singularity-run.cwl] initializing from file:///users/sphe/spiel/singularity-run.cwl\r\n[job singularity-run.cwl] {}\r\n[job singularity-run.cwl] path mappings is {}\r\n[job singularity-run.cwl] command line bindings is [\r\n    {\r\n        \"position\": [\r\n            -1000000, \r\n            0\r\n        ], \r\n        \"datum\": \"echo\"\r\n    }, \r\n    {\r\n        \"position\": [\r\n            -1000000, \r\n            1\r\n        ], \r\n        \"datum\": \"hello\"\r\n    }\r\n]\r\nSingularity error\r\nTraceback (most recent call last):\r\n  File \"/users/sphe/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/job.py\", line 376, in run\r\n    img_id = str(self.get_from_requirements(docker_req, True, pull_image, force_pull=kwargs.get(\"force_docker_pull\")))\r\n  File \"/users/sphe/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/singularity.py\", line 98, in get_from_requirements\r\n    raise WorkflowException(u\"Container image %s not found\" % r[\"dockerImageId\"])\r\nWorkflowException: Container image gijzelaerr/spiel not found\r\nWorkflow error, try again with --debug for more information:\r\nSingularity is not available for this tool, try --no-container to disable Singularity, or install a user space Docker replacement like uDocker with --user-space-docker-cmd.: Container image gijzelaerr/spiel not found\r\nTraceback (most recent call last):\r\n  File \"/users/sphe/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/main.py\", line 606, in main\r\n    **vars(args))\r\n  File \"/users/sphe/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/executors.py\", line 29, in __call__\r\n    return self.execute(*args, **kwargs)\r\n  File \"/users/sphe/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/executors.py\", line 70, in execute\r\n    self.run_jobs(t, job_order_object, logger, **kwargs)\r\n  File \"/users/sphe/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/executors.py\", line 106, in run_jobs\r\n    r.run(**kwargs)\r\n  File \"/users/sphe/spiel/.virtualenv/local/lib/python2.7/site-packages/cwltool/job.py\", line 397, in run\r\n    \"--user-space-docker-cmd.: {1}\".format(container, e))\r\nWorkflowException: Singularity is not available for this tool, try --no-container to disable Singularity, or install a user space Docker replacement like uDocker with --user-space-docker-cmd.: Container image gijzelaerr/spiel not found\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n1.0.2018040314570\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/725", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/725/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/725/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/725/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/725", "id": 316329928, "node_id": "MDU6SXNzdWUzMTYzMjk5Mjg=", "number": 725, "title": "\"Missing required secondary file\" for workflow execution ", "user": {"login": "yuankunzhu", "id": 4965924, "node_id": "MDQ6VXNlcjQ5NjU5MjQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/4965924?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuankunzhu", "html_url": "https://github.com/yuankunzhu", "followers_url": "https://api.github.com/users/yuankunzhu/followers", "following_url": "https://api.github.com/users/yuankunzhu/following{/other_user}", "gists_url": "https://api.github.com/users/yuankunzhu/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuankunzhu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuankunzhu/subscriptions", "organizations_url": "https://api.github.com/users/yuankunzhu/orgs", "repos_url": "https://api.github.com/users/yuankunzhu/repos", "events_url": "https://api.github.com/users/yuankunzhu/events{/privacy}", "received_events_url": "https://api.github.com/users/yuankunzhu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-04-20T16:18:34Z", "updated_at": "2018-04-24T15:59:57Z", "closed_at": "2018-04-24T15:59:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "---\r\n\r\n## Expected Behavior\r\ninput secondaryFiles doesn't have to be declared again at the workflow level\r\n\r\n## Actual Behavior\r\nthe latest release [1.0.20180403145700](https://github.com/common-workflow-language/cwltool/tree/1.0.20180403145700) will fail and error out like: \"Cannot make job: Missing required secondary file\", even when the secondaryFiles has already been declared on the CommandLineTool level. all previous release works fine with such cases. \r\n\r\n\r\n## Example Code\r\n### 1. tool.cwl\r\n```\r\ncwlVersion: v1.0\r\nclass: CommandLineTool\r\nrequirements:\r\n  - class: ShellCommandRequirement\r\nbaseCommand: []\r\narguments:\r\n  - position: 0\r\n    shellQuote: false\r\n    valueFrom: echo $(inputs.ref.path)\r\ninputs:\r\n  ref: { type: File, secondaryFiles: [.fai] }\r\noutputs:\r\n  output: stdout\r\n```\r\nrun tool along\r\n```\r\n$ cwltool tool.cwl --ref /vol/dev/broad-references/Homo_sapiens_assembly38.fasta\r\n/vol/venv/workflow-dev/bin/cwltool 1.0.20180326152342\r\nResolved 'tool.cwl' to 'file:///vol/dev/yuankun/debug-new-workflow/new/workflows/tool.cwl'\r\n[job tool.cwl] /tmp/tmp4UfUEW$ /bin/sh \\\r\n    -c \\\r\n    echo /tmp/tmpEkJep_/stg19fcc510-80fe-4446-9ea8-96964f40edc9/Homo_sapiens_assembly38.fasta > /tmp/tmp4UfUEW/0dfb339b948eaf6673c1089f8364172c01340b6b\r\n[job tool.cwl] completed success\r\n{\r\n    \"output\": {\r\n        \"checksum\": \"sha1$ac141583df098eef28e77b14a59571c8eaec24e9\",\r\n        \"basename\": \"0dfb339b948eaf6673c1089f8364172c01340b6b\",\r\n        \"location\": \"file:///vol/dev/yuankun/debug-new-workflow/new/workflows/0dfb339b948eaf6673c1089f8364172c01340b6b\",\r\n        \"path\": \"/vol/dev/yuankun/debug-new-workflow/new/workflows/0dfb339b948eaf6673c1089f8364172c01340b6b\",\r\n        \"class\": \"File\",\r\n        \"size\": 85\r\n    }\r\n}\r\nFinal process status is success\r\n```\r\n### 2. workflow\r\n```\r\ncwlVersion: v1.0\r\nclass: Workflow\r\ninputs:\r\n  ref: File\r\noutputs: []\r\nsteps:\r\n  tool:\r\n    run: tool.cwl\r\n    in:\r\n      ref: ref\r\n    out: [output]\r\n```\r\n2.1 run workflow with [1.0.20180326152342](https://github.com/common-workflow-language/cwltool/tree/1.0.20180326152342)\r\n```\r\n$ cwltool workflow.cwl --ref /vol/dev/broad-references/Homo_sapiens_assembly38.fasta\r\n/vol/venv/workflow-dev/bin/cwltool 1.0.20180326152342\r\nResolved 'workflow.cwl' to 'file:///vol/dev/yuankun/debug-new-workflow/new/workflows/workflow.cwl'\r\n[workflow workflow.cwl] start\r\n[step tool] start\r\n[job tool] /tmp/tmp3iNFjf$ /bin/sh \\\r\n    -c \\\r\n    echo /tmp/tmpl2R0AD/stg6a8eaa99-8407-4272-a03a-71c77b5cb57a/Homo_sapiens_assembly38.fasta > /tmp/tmp3iNFjf/0dfb339b948eaf6673c1089f8364172c01340b6b\r\n[job tool] completed success\r\n[step tool] completed success\r\n[workflow workflow.cwl] completed success\r\n```\r\n2.2 run workflow with [1.0.20180403145700](https://github.com/common-workflow-language/cwltool/tree/1.0.20180403145700)\r\n```\r\n$ cwltool workflow.cwl --ref /vol/dev/broad-references/Homo_sapiens_assembly38.fasta\r\n/vol/venv/workflow-dev/bin/cwltool 1.0.20180403145700\r\nResolved 'workflow.cwl' to 'file:///vol/dev/yuankun/debug-new-workflow/new/workflows/workflow.cwl'\r\n[workflow workflow.cwl] start\r\n[step tool] start\r\nException on step 'tool'\r\n[step tool] Cannot make job: Missing required secondary file 'Homo_sapiens_assembly38.fasta.fai' from file object: {\r\n    \"basename\": \"Homo_sapiens_assembly38.fasta\",\r\n    \"nameroot\": \"Homo_sapiens_assembly38\",\r\n    \"nameext\": \".fasta\",\r\n    \"location\": \"file:///vol/dev/broad-references/Homo_sapiens_assembly38.fasta\",\r\n    \"secondaryFiles\": [],\r\n    \"class\": \"File\",\r\n    \"size\": 3249912778\r\n}\r\n[workflow workflow.cwl] completed permanentFail\r\n{}\r\nFinal process status is permanentFail\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/712", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/712/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/712/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/712/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/712", "id": 310854102, "node_id": "MDU6SXNzdWUzMTA4NTQxMDI=", "number": 712, "title": "Type property \"ordereddict([('type', 'array'), ('items', 'array')])\" not a valid Avro schema:", "user": {"login": "gijzelaerr", "id": 326308, "node_id": "MDQ6VXNlcjMyNjMwOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/326308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gijzelaerr", "html_url": "https://github.com/gijzelaerr", "followers_url": "https://api.github.com/users/gijzelaerr/followers", "following_url": "https://api.github.com/users/gijzelaerr/following{/other_user}", "gists_url": "https://api.github.com/users/gijzelaerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gijzelaerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gijzelaerr/subscriptions", "organizations_url": "https://api.github.com/users/gijzelaerr/orgs", "repos_url": "https://api.github.com/users/gijzelaerr/repos", "events_url": "https://api.github.com/users/gijzelaerr/events{/privacy}", "received_events_url": "https://api.github.com/users/gijzelaerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-04-03T14:12:13Z", "updated_at": "2018-04-19T06:30:34Z", "closed_at": "2018-04-19T06:30:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "https://github.com/ska-sa/den/blob/9858bd1b76ea1793e855d13fed488e9a0cd456c0/steps/casa_applycal.cwl\r\n\r\n```\r\n$ .venv2/bin/cwltool main.cwl\r\n.venv2/bin/cwltool 1.0.20180330141240\r\nResolved 'main.cwl' to 'file:///Users/gijs/Work/den/main.cwl'\r\nTool definition failed initialization:\r\nTool definition file:///Users/gijs/Work/den/steps/casa_applycal.cwl failed validation:\r\n  Got error 'Type property \"ordereddict([('type', 'array'), ('items', 'array')])\" not a valid Avro schema: Items schema (array) not a valid Avro schema: Cou\r\nld not make an Avro Schema object from array. (known names: [u'applymode361d19c1-d901-456f-a104-dd35a2feea68', u'File_class', 'File', 'Directory', 'input_re\r\ncord_schema', u'Directory_class', 'Any'])' while processing inputs of file:///Users/gijs/Work/den/steps/casa_applycal.cwl:\r\n[...]\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/709", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/709/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/709/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/709/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/709", "id": 310812491, "node_id": "MDU6SXNzdWUzMTA4MTI0OTE=", "number": 709, "title": "TypeError: 'NoneType' object is not iterable", "user": {"login": "gijzelaerr", "id": 326308, "node_id": "MDQ6VXNlcjMyNjMwOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/326308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gijzelaerr", "html_url": "https://github.com/gijzelaerr", "followers_url": "https://api.github.com/users/gijzelaerr/followers", "following_url": "https://api.github.com/users/gijzelaerr/following{/other_user}", "gists_url": "https://api.github.com/users/gijzelaerr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gijzelaerr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gijzelaerr/subscriptions", "organizations_url": "https://api.github.com/users/gijzelaerr/orgs", "repos_url": "https://api.github.com/users/gijzelaerr/repos", "events_url": "https://api.github.com/users/gijzelaerr/events{/privacy}", "received_events_url": "https://api.github.com/users/gijzelaerr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-04-03T12:18:23Z", "updated_at": "2018-04-03T13:31:39Z", "closed_at": "2018-04-03T13:31:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "https://github.com/ska-sa/den/tree/1c9e1f28bd06c07e808a82fd86f0cc25d08be251\r\n\r\n```\r\n$ cwltool --debug main.cwl\r\ncwltool 1.0.20180330141240\r\nResolved 'main.cwl' to 'file:///Users/gijs/Work/den/main.cwl'\r\nI'm sorry, I couldn't load this CWL file.  The error was:\r\nTraceback (most recent call last):\r\n[...]\r\n  File \"/Users/gijs/Work/den/.venv2/lib/python2.7/site-packages/cwltool/load_tool.py\", line 126, in _convert_stdstreams_to_files\r\n    for out in workflowobj.get('outputs', []):\r\nTypeError: 'NoneType' object is not iterable\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/704", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/704/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/704/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/704/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/704", "id": 310173939, "node_id": "MDU6SXNzdWUzMTAxNzM5Mzk=", "number": 704, "title": "Regression in handling enum type option", "user": {"login": "partha-edico", "id": 25355947, "node_id": "MDQ6VXNlcjI1MzU1OTQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/25355947?v=4", "gravatar_id": "", "url": "https://api.github.com/users/partha-edico", "html_url": "https://github.com/partha-edico", "followers_url": "https://api.github.com/users/partha-edico/followers", "following_url": "https://api.github.com/users/partha-edico/following{/other_user}", "gists_url": "https://api.github.com/users/partha-edico/gists{/gist_id}", "starred_url": "https://api.github.com/users/partha-edico/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/partha-edico/subscriptions", "organizations_url": "https://api.github.com/users/partha-edico/orgs", "repos_url": "https://api.github.com/users/partha-edico/repos", "events_url": "https://api.github.com/users/partha-edico/events{/privacy}", "received_events_url": "https://api.github.com/users/partha-edico/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-03-30T21:33:56Z", "updated_at": "2018-11-29T11:17:08Z", "closed_at": "2018-11-29T11:17:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected Behavior\r\ncwltool should handle an input type such as the following:\r\n    type:\r\n    - 'null'\r\n    - type: enum\r\n      symbols: ['across', 'commas','long']\r\n\r\n## Actual Behavior\r\nAs of release 1.0.20180322194411 (NOTE: Previous release 1.0.20180306163216 worked OK), we get cwltool parsing errors:\r\n=> cwl_test.yaml:13:7: invalid field `name`, expected one of: 'symbols', 'type', 'label', 'inputBinding'\r\n\r\n## Workflow Code\r\n### cwl_tool.yaml\r\n```\r\nbaseCommand: /bin/ls\r\nclass: CommandLineTool\r\ncwlVersion: v1.0\r\nhints: []\r\nrequirements:\r\n- {class: InlineJavascriptRequirement}\r\ninputs:\r\n  ls_format:\r\n    type:\r\n    - 'null'\r\n    - type: enum\r\n      symbols: ['across','commas','long']\r\n    label: Format type\r\n    inputBinding: {position: 3, prefix: --format, itemSeparator: '='}\r\noutputs:\r\n  bam_output:\r\n    type: File?\r\n    outputBinding: {glob: '*.bam'}\r\nstderr: stderr.txt\r\nstdout: stdout.txt\r\n```\r\n### test_input.yaml\r\n```\r\nls_format: 'long'\r\n```\r\n\r\n## Full Traceback\r\nNo exception\r\n\r\n## Your Environment\r\n* cwltool version: 1.0.20180322194411\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/703", "repository_url": "https://api.github.com/repos/common-workflow-language/cwltool", "labels_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/703/labels{/name}", "comments_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/703/comments", "events_url": "https://api.github.com/repos/common-workflow-language/cwltool/issues/703/events", "html_url": "https://github.com/common-workflow-language/cwltool/issues/703", "id": 308777174, "node_id": "MDU6SXNzdWUzMDg3NzcxNzQ=", "number": 703, "title": "Missing baseCommand arguments in log file", "user": {"login": "ionox0", "id": 6385646, "node_id": "MDQ6VXNlcjYzODU2NDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/6385646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ionox0", "html_url": "https://github.com/ionox0", "followers_url": "https://api.github.com/users/ionox0/followers", "following_url": "https://api.github.com/users/ionox0/following{/other_user}", "gists_url": "https://api.github.com/users/ionox0/gists{/gist_id}", "starred_url": "https://api.github.com/users/ionox0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ionox0/subscriptions", "organizations_url": "https://api.github.com/users/ionox0/orgs", "repos_url": "https://api.github.com/users/ionox0/repos", "events_url": "https://api.github.com/users/ionox0/events{/privacy}", "received_events_url": "https://api.github.com/users/ionox0/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-03-27T00:09:16Z", "updated_at": "2018-04-06T15:47:36Z", "closed_at": "2018-03-28T09:36:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected Behavior\r\n\r\nI would expect this line from the logs:\r\n```\r\n'cwl_tools/gatk/FindCoveredIntervals.cwl' /bin/java 9/c/jobIzwEOZ    INFO:cwltool:[job FindCoveredIntervals.cwl] outputsFolder/out_tmpdirJt302e$ /bin/sh \\\r\ncwl_tools/gatk/FindCoveredIntervals.cwl' /bin/java 9/c/jobIzwEOZ        -c \\\r\n'cwl_tools/gatk/FindCoveredIntervals.cwl' /bin/java 9/c/jobIzwEOZ        '/bin/java' '-Xmx20g' '-Djava.io.tmpdir=/scratch' '-jar' '/gatk/GenomeAnalysisTK-3.3-0/GenomeAnalysisTK.jar' '-T' 'FindCoveredIntervals' '--input_file' 'outptutsFolder/tmpekb9aU/stgac11f40d-71d9-4e1b-a50e-c62e7a149adb/PR_pt27_BCN01_IGO_05500_DY_15_S13_standard_RG_MD.bam' '--reference_sequence' '/ifs/depot/resources/dmp/data/pubdata/hg-fasta/VERSIONS/hg19/Homo_sapiens_assembly19.fasta' '--input_file' 'outputsFolder/tmpekb9aU/stg80c2aa37-d915-4847-92fa-992aff0d0f1d/PR_pt27_CF01_IGO_05500_DY_32_S35_standard_RG_MD.bam' '--coverage_threshold' '20' '--minBaseQuality' '20' '--minMappingQuality' '20' '--out' 'PR_pt27.fci.list' --read_filter FailsVendorQualityCheck -rf BadMate -rf UnmappedRead -rf BadCigar\r\n```\r\nTo appear for all jobs\r\n\r\n## Actual Behavior\r\nI see two types of log files (there are many that are created, as I'm running with the `--logDebug` paramter set). One of the two contains:\r\n```\r\n---\r\nINFO:toil.worker:---TOIL WORKER OUTPUT LOG---\r\nDEBUG:toil.worker:Next available file descriptor: 5\r\nINFO:toil:Running Toil version 3.14.0-b91dbf9bf6116879952f0a70f9a2fbbcae7e51b6.\r\nDEBUG:toil:Configuration: {'rescueJobsFrequency': 3600, 'logLevel': 'DEBUG', 'minNodes': None, 'maxMemory': 9223372036854775807, 'jobStore': 'outputdFolder/tmp/jobstore-aa65c5be-2d81-11e8-84ba-645106ef9e4c', 'disableHotDeployment': False, 'linkImports': True, 'nodeOptions': None, 'nodeTypes': [], 'servicePollingInterval': 60, 'workDir': 'outputsFolder/tmp', 'stats': True, 'disableCaching': True, 'maxPreemptableServiceJobs': 9223372036854775807, 'environment': {}, 'parasolMaxBatches': 10000, 'cleanWorkDir': 'onSuccess', 'maxCores': 9223372036854775807, 'sseKey': None, 'maxDisk': 9223372036854775807, 'scaleInterval': 30, 'deadlockWait': 60, 'defaultPreemptable': False, 'clusterStats': None, 'defaultCores': 1, 'cseKey': None, 'betaInertia': 1.2, 'metrics': False, 'maxNodes': [10], 'scale': 1, 'writeLogs': 'outputsFOlder/log', 'badWorker': 0.0, 'defaultDisk': 10737418240, 'mesosMasterAddress': '140.163.153.177:5050', 'restart': False, 'useAsync': True, 'preemptableCompensation': 0.0, 'parasolCommand': 'parasol', 'workflowID': 'dc46d39d-30ab-4bd2-9361-5678c767ca93', 'alphaPacking': 0.8, 'maxServiceJobs': 9223372036854775807, 'readGlobalFileMutableByDefault': False, 'badWorkerFailInterval': 0.01, 'statePollingWait': 1, 'debugWorker': False, 'maxLogFileSize': 64000, 'defaultMemory': 10737418240, 'workflowAttemptNumber': 0, 'maxJobDuration': 9223372036854775807, 'clean': 'never', 'provisioner': None, 'batchSystem': 'lsf', 'retryCount': 1, 'writeLogsGzip': None, 'nodeStorage': 50}\r\nDEBUG:toil.worker:Parsed job wrapper\r\nDEBUG:toil.worker:Wrapper has no user job to run.\r\nDEBUG:toil.worker:Cleaned up any references to completed successor jobs\r\nDEBUG:toil.worker:No user job to run, so finishing\r\nINFO:toil.worker:Worker log can be found at outputsFolder/tmp/toil-dc46d39d-30ab-4bd2-9361-5678c767ca93-30a824f465bf5808577c894a00000017/tmpnaaS5q. Set --cleanWorkDir to retain this log\r\nINFO:toil.worker:Finished running the chain of jobs on this node, we ran for a total of 0.000238 seconds\r\n```\r\nand the other which contains:\r\n```\r\n/ian/abra_scratch__Pan_Cancer_F4/X_74802700_74803100_contigs.fasta_k43, 1\r\nElapsed_msecs_in_NativeAssembler\tRegion:\tX_74802700_74803100\tLength:\t400\tReadCount:\t1891\tElapsed\t663\tAssembled\ttrue\t43\r\nThu Mar 22 10:18:02 EDT 2018 : Processing region: X_74803900_74804300\r\nAbra JNI entry point v0.92, prefix: X_74803700_74804100, read_length: 122, kmer_size: 43, min_node_freq: 2, min_base_qual: 60, min_edge_ratio 0.020000\r\nAssembling: -> /temp/abra_scratch__Pan_Cancer_F4/X_74803700_74804100_contigs.fasta_k43\r\nDone assembling(1): /temp/abra_scratch__Pan_Cancer_F4/X_74803300_74803700_contigs.fasta_k43, 1\r\nElapsed_msecs_in_NativeAssembler\tRegion:\tX_74803300_74803700\tLength:\t400\tReadCount:\t2007\tElapsed\t537\tAssembled\ttrue\t43\r\nThu Mar 22 10:18:02 EDT 2018 : Processing region: X_74804100_74804500\r\nAbra JNI entry point v0.92, prefix: X_74804100_74804500, read_length: 122, kmer_size: 43, min_node_freq: 2, min_base_qual: 60, min_edge_ratio 0.020000\r\nAssembling: -> /temp/abra_scratch__Pan_Cancer_F4/X_74804100_74804500_contigs.fasta_k43\r\n```\r\nBut neither of which contain the parameters that were supplied to the jar.\r\n\r\nAny suggestions would be helpful, could this be related to the `ShellCommandRequirement` parameter? Or are there any known instances when these parameters don't get logged?\r\n\r\nI know that this logging happens in this code from `cwltool`, but I don't see why it wouldn't get logged for every cwl tool:\r\n```\r\n_logger.info(u\"[job %s] %s$ %s%s%s%s\",\r\n             self.name,\r\n             self.outdir,\r\n             \" \\\\\\n    \".join([shellescape.quote(Text(arg)) if shouldquote(Text(arg)) else Text(arg) for arg in\r\n                                       (runtime + self.command_line)]),\r\n             u' < %s' % self.stdin if self.stdin else '',\r\n             u' > %s' % os.path.join(self.outdir, self.stdout) if self.stdout else '',\r\n             u' 2> %s' % os.path.join(self.outdir, self.stderr) if self.stderr else '')\r\n```\r\n\r\nThank you!\r\n\r\n\r\n## Workflow Code\r\n\r\n### workflow.cwl\r\n```\r\n\r\n  abra:\r\n    run: ../cwl_tools/abra/abra.cwl\r\n    in:\r\n      input_bams: bams\r\n      targets: list2bed/output_file\r\n\r\n      abra_scratch: abra__scratch\r\n      patient_id: patient_id\r\n      working_directory:\r\n        valueFrom: ${ return inputs.abra_scratch + '__' + inputs.patient_id }\r\n\r\n      reference_fasta: reference_fasta\r\n      kmer: abra__kmers\r\n      mad: abra__mad\r\n      threads:\r\n        valueFrom: ${ return 5 }\r\n      out:\r\n        valueFrom: |\r\n          ${ return inputs.input_bams.map(function(b){ return b.basename.replace(\".bam\", \"_IR.bam\"); }); }\r\n    out:\r\n      [bams]\r\n```\r\n\r\n### abra.cwl\r\n``` \r\n#!/usr/bin/env cwl-runner\r\n\r\ncwlVersion: v1.0\r\n\r\nclass: CommandLineTool\r\n\r\nbaseCommand:\r\n- /bin/java\r\n\r\narguments:\r\n- -Xmx60g\r\n- -Djava.io.tmpdir=/scratch\r\n- -jar\r\n- /home/johnsoni/Innovation-Pipeline/vendor_tools/abra-0.92-SNAPSHOT-jar-with-dependencies.jar\r\n\r\nrequirements:\r\n  InlineJavascriptRequirement: {}\r\n  ResourceRequirement:\r\n    ramMin: 62000\r\n    coresMin: 8\r\n\r\ndoc: |\r\n  None\r\n\r\ninputs:\r\n\r\n  input_bams:\r\n    type:\r\n      type: array\r\n      items: File\r\n    inputBinding:\r\n      prefix: --in\r\n      itemSeparator: ','\r\n    secondaryFiles:\r\n    - ^.bai\r\n\r\n  # Todo: see if these can be referenced in outer workflow instead\r\n  abra_scratch:\r\n    type: string\r\n  patient_id:\r\n    type: string\r\n\r\n  working_directory:\r\n    type: string\r\n    inputBinding:\r\n      prefix: --working\r\n\r\n  reference_fasta:\r\n    type: string\r\n    inputBinding:\r\n      prefix: --ref\r\n\r\n  targets:\r\n    type: File\r\n    inputBinding:\r\n      prefix: --targets\r\n\r\n  threads:\r\n    type: int\r\n    inputBinding:\r\n      prefix: --threads\r\n\r\n  kmer:\r\n    type: string\r\n    inputBinding:\r\n      prefix: --kmer\r\n\r\n  mad:\r\n    type: int\r\n    inputBinding:\r\n      prefix: --mad\r\n\r\n  out:\r\n    type:\r\n      type: array\r\n      items: string\r\n    inputBinding:\r\n      itemSeparator: ','\r\n      prefix: --out\r\n\r\noutputs:\r\n\r\n  bams:\r\n    type: File[]\r\n    outputBinding:\r\n      # Todo: Only specify in one place.\r\n      glob: '*_IR.bam'\r\n```\r\n\r\n## Your Environment\r\n* cwltool version: \r\n`1.0.20180130110340`\r\n* Toil version:\r\n`3.14.0`\r\n", "performed_via_github_app": null, "score": 1.0}]}