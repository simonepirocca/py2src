{"total_count": 4, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/10", "repository_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization", "labels_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/10/labels{/name}", "comments_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/10/comments", "events_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/10/events", "html_url": "https://github.com/madman-bob/python-dataclasses-serialization/issues/10", "id": 617168269, "node_id": "MDU6SXNzdWU2MTcxNjgyNjk=", "number": 10, "title": "default none values throws an exception", "user": {"login": "DanielleFundbox", "id": 18901671, "node_id": "MDQ6VXNlcjE4OTAxNjcx", "avatar_url": "https://avatars0.githubusercontent.com/u/18901671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DanielleFundbox", "html_url": "https://github.com/DanielleFundbox", "followers_url": "https://api.github.com/users/DanielleFundbox/followers", "following_url": "https://api.github.com/users/DanielleFundbox/following{/other_user}", "gists_url": "https://api.github.com/users/DanielleFundbox/gists{/gist_id}", "starred_url": "https://api.github.com/users/DanielleFundbox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DanielleFundbox/subscriptions", "organizations_url": "https://api.github.com/users/DanielleFundbox/orgs", "repos_url": "https://api.github.com/users/DanielleFundbox/repos", "events_url": "https://api.github.com/users/DanielleFundbox/events{/privacy}", "received_events_url": "https://api.github.com/users/DanielleFundbox/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-13T06:05:07Z", "updated_at": "2020-05-13T09:20:22Z", "closed_at": "2020-05-13T09:20:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "```@dataclass\r\nclass InfoWithNone:\r\n    status: str\r\n    product_types: List[str]\r\n    id: int = None\r\n\r\ninfo = InfoWithNone(status='active', product_types=['p1','p2'])\r\nserialized_info = JSONSerializer.serialize(info)\r\ndeserialized_info = JSONSerializer.deserialize(InfoWithNone, serialized_info)\r\n\r\nthis throws\r\ndataclasses_serialization.serializer_base.DeserializationError: Missing one or more required fields to deserialize\r\n {'status': 'active', 'product_types': ['p1', 'p2'], 'id': None} as <class 'tests.test_dataclasses_serialization.InfoWithNone'>\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/8", "repository_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization", "labels_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/8/labels{/name}", "comments_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/8/comments", "events_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/8/events", "html_url": "https://github.com/madman-bob/python-dataclasses-serialization/issues/8", "id": 610725814, "node_id": "MDU6SXNzdWU2MTA3MjU4MTQ=", "number": 8, "title": "Deserializing exact type", "user": {"login": "kitschen", "id": 3657877, "node_id": "MDQ6VXNlcjM2NTc4Nzc=", "avatar_url": "https://avatars0.githubusercontent.com/u/3657877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kitschen", "html_url": "https://github.com/kitschen", "followers_url": "https://api.github.com/users/kitschen/followers", "following_url": "https://api.github.com/users/kitschen/following{/other_user}", "gists_url": "https://api.github.com/users/kitschen/gists{/gist_id}", "starred_url": "https://api.github.com/users/kitschen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kitschen/subscriptions", "organizations_url": "https://api.github.com/users/kitschen/orgs", "repos_url": "https://api.github.com/users/kitschen/repos", "events_url": "https://api.github.com/users/kitschen/events{/privacy}", "received_events_url": "https://api.github.com/users/kitschen/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-01T12:23:31Z", "updated_at": "2020-05-21T16:10:31Z", "closed_at": "2020-05-21T16:10:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "When writing a deserializer you might get bitten by unwanted/unexpected type hierarchies.\r\nExample you want to write a deserializer for `datetime.date` (that you get in a string format) and another for `datetime.datetime` that you get as an int representing millis since epoch.\r\n```\r\n@JSONSerializer.register_deserializer(datetime.date)\r\ndef date_deserializer(cls, d: str) -> datetime.date:\r\n    try:\r\n        return datetime.datetime.strptime(d, \"%Y%m%d\").date()\r\n    except Exception as e:\r\n        raise DeserializationError(e)\r\n\r\n@JSONSerializer.register_deserializer(datetime.datetime)\r\ndef datetime_deserializer(cls, d: int) -> datetime.datetime:\r\n    try:\r\n        return datetime.fromtimestamp(timestamp / 1000.0, tz=pytz.utc)\r\n    except Exception as e:\r\n        raise DeserializationError(e)\r\n```\r\n\r\nUnfortunately, this will fail when receiving a millisecond timestamp. The reason is, that `datetime.datetime` is a subclass of `datetime.date` and thus the first deserializer is chosen which expects a string.\r\n\r\nOne workaround is to reverse the order of the two deserializers, so the more narrow one (for `datetime`) is registered first and thus found first. I suppose this is ugly (also, is this always the case? isn't a `dict` used with unpredictable iteration order?)\r\n\r\nAnother workaround is to specifiy the type in a Final way.\r\n```\r\n@JSONSerializer.register_deserializer(Final[datetime.date])\r\ndef date_deserializer(cls, d: str) -> datetime.date:\r\n    try:\r\n        return datetime.datetime.strptime(d, \"%Y%m%d\").date()\r\n    except Exception as e:\r\n        raise DeserializationError(e)\r\n```\r\n\r\nThis fact might be interesting to add to the documentation.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/5", "repository_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization", "labels_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/5/comments", "events_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/5/events", "html_url": "https://github.com/madman-bob/python-dataclasses-serialization/issues/5", "id": 511079943, "node_id": "MDU6SXNzdWU1MTEwNzk5NDM=", "number": 5, "title": "Dose BSONSerializer support None?", "user": {"login": "KindRoach", "id": 17931052, "node_id": "MDQ6VXNlcjE3OTMxMDUy", "avatar_url": "https://avatars2.githubusercontent.com/u/17931052?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KindRoach", "html_url": "https://github.com/KindRoach", "followers_url": "https://api.github.com/users/KindRoach/followers", "following_url": "https://api.github.com/users/KindRoach/following{/other_user}", "gists_url": "https://api.github.com/users/KindRoach/gists{/gist_id}", "starred_url": "https://api.github.com/users/KindRoach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KindRoach/subscriptions", "organizations_url": "https://api.github.com/users/KindRoach/orgs", "repos_url": "https://api.github.com/users/KindRoach/repos", "events_url": "https://api.github.com/users/KindRoach/events{/privacy}", "received_events_url": "https://api.github.com/users/KindRoach/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-23T05:18:58Z", "updated_at": "2019-10-23T13:18:27Z", "closed_at": "2019-10-23T13:18:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, your package helps me a lot. However, I notice that BSONSerializer doesn't support None.\r\nHere is a sample code.\r\n```python\r\nfrom dataclasses import dataclass\r\n\r\nfrom bson import ObjectId\r\nfrom dataclasses_serialization.bson import BSONSerializer\r\n\r\n\r\n@dataclass\r\nclass MyClass:\r\n    x: str\r\n    y: str\r\n\r\n\r\nbson1 = {'_id': ObjectId('5dafdce12fc3ba50eb0c3779'), 'x': '1', 'y': '1'}\r\nprint(BSONSerializer.deserialize(MyClass, bson1))  # it's OK\r\n\r\nbson2 = {'_id': ObjectId('5dafdce12fc3ba50eb0c3779'), 'x': None, 'y': '1'}\r\nprint(BSONSerializer.deserialize(MyClass, bson2))  # Error rising\r\n```\r\n\r\n\r\nHere is error details.\r\n```\r\ndataclasses_serialization.serializer_base.DeserializationError: Missing one or more required fields to deserialize {'_id': ObjectId('5dafdce12fc3ba50eb0c3779'), 'x': None, 'y': '1'} as <class '__main__.MyClass'>\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/3", "repository_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization", "labels_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/3/labels{/name}", "comments_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/3/comments", "events_url": "https://api.github.com/repos/madman-bob/python-dataclasses-serialization/issues/3/events", "html_url": "https://github.com/madman-bob/python-dataclasses-serialization/issues/3", "id": 492759607, "node_id": "MDU6SXNzdWU0OTI3NTk2MDc=", "number": 3, "title": "Bug for deserialising fields of type Optional[Dataclass]", "user": {"login": "FilipDeleersnijder", "id": 5584211, "node_id": "MDQ6VXNlcjU1ODQyMTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5584211?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FilipDeleersnijder", "html_url": "https://github.com/FilipDeleersnijder", "followers_url": "https://api.github.com/users/FilipDeleersnijder/followers", "following_url": "https://api.github.com/users/FilipDeleersnijder/following{/other_user}", "gists_url": "https://api.github.com/users/FilipDeleersnijder/gists{/gist_id}", "starred_url": "https://api.github.com/users/FilipDeleersnijder/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FilipDeleersnijder/subscriptions", "organizations_url": "https://api.github.com/users/FilipDeleersnijder/orgs", "repos_url": "https://api.github.com/users/FilipDeleersnijder/repos", "events_url": "https://api.github.com/users/FilipDeleersnijder/events{/privacy}", "received_events_url": "https://api.github.com/users/FilipDeleersnijder/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-12T11:58:33Z", "updated_at": "2019-09-14T13:13:45Z", "closed_at": "2019-09-14T13:13:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Whenever you want to serialise/deserialise a dataclass that has as one of its field an Optional[T] with T being another dataclass, deserialising fails.\r\n\r\nCode to reproduce: \r\n\r\n```\r\nfrom typing import Optional\r\nfrom unittest import TestCase\r\n\r\nfrom dataclasses import dataclass\r\nfrom dataclasses_serialization.json import JSONSerializer\r\n\r\nclass TestDeleteme(TestCase):\r\n\r\n    def test_one(self):\r\n\r\n        dc1 = DC1()\r\n        dc2 = DC2()\r\n\r\n        JSONSerializer.deserialize(DC1, JSONSerializer.serialize(dc1))\r\n        serialised_value = JSONSerializer.serialize(dc2)\r\n        JSONSerializer.deserialize(DC2, serialised_value)\r\n\r\n@dataclass\r\nclass DC1:\r\n    value: Optional[float] = None\r\n\r\n@dataclass\r\nclass DC2:\r\n    optional_dc1: Optional[DC1] = None\r\n\r\n```\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}]}