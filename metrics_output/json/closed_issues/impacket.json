{"total_count": 457, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/920", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/920/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/920/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/920/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/920", "id": 680542737, "node_id": "MDU6SXNzdWU2ODA1NDI3Mzc=", "number": 920, "title": "ntlmrelayx.p", "user": {"login": "zezomehdawi", "id": 52613449, "node_id": "MDQ6VXNlcjUyNjEzNDQ5", "avatar_url": "https://avatars2.githubusercontent.com/u/52613449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zezomehdawi", "html_url": "https://github.com/zezomehdawi", "followers_url": "https://api.github.com/users/zezomehdawi/followers", "following_url": "https://api.github.com/users/zezomehdawi/following{/other_user}", "gists_url": "https://api.github.com/users/zezomehdawi/gists{/gist_id}", "starred_url": "https://api.github.com/users/zezomehdawi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zezomehdawi/subscriptions", "organizations_url": "https://api.github.com/users/zezomehdawi/orgs", "repos_url": "https://api.github.com/users/zezomehdawi/repos", "events_url": "https://api.github.com/users/zezomehdawi/events{/privacy}", "received_events_url": "https://api.github.com/users/zezomehdawi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-17T21:41:05Z", "updated_at": "2020-08-18T12:50:27Z", "closed_at": "2020-08-18T12:50:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "i have faced this issue lately \r\nanyone can help....\r\n\r\nroot@kali:/home/kali/ ntlmrelayx.py -tf /home/kali/target.txt -smb2support\r\nImpacket v0.9.22.dev1+20200813.221956.1c893884 - Copyright 2020 SecureAuth Corporation\r\n\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client HTTPS loaded..\r\n[*] Protocol Client RPC loaded..\r\n[*] Protocol Client SMTP loaded..\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client SMB loaded..\r\n[*] Running in relay mode to hosts in targetfile\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/ntlmrelayx.py\", line 4, in <module>\r\n    __import__('pkg_resources').run_script('impacket==0.9.22.dev1+20200813.221956.1c893884', 'ntlmrelayx.py')\r\n  File \"/usr/lib/python3/dist-packages/pkg_resources/__init__.py\", line 667, in run_script\r\n    self.require(requires)[0].run_script(script_name, ns)\r\n  File \"/usr/lib/python3/dist-packages/pkg_resources/__init__.py\", line 1464, in run_script\r\n    exec(code, namespace, namespace)\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket-0.9.22.dev1+20200813.221956.1c893884-py3.8.egg/EGG-INFO/scripts/ntlmrelayx.py\", line 385, in <module>\r\n    c = start_servers(options, threads)\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket-0.9.22.dev1+20200813.221956.1c893884-py3.8.egg/EGG-INFO/scripts/ntlmrelayx.py\", line 180, in start_servers\r\n    s = server(c)\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket-0.9.22.dev1+20200813.221956.1c893884-py3.8.egg/impacket/examples/ntlmrelayx/servers/smbrelayserver.py\", line 92, in __init__\r\n    self.server = SMBSERVER((config.interfaceIp,smbport), config_parser = smbConfig)\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket-0.9.22.dev1+20200813.221956.1c893884-py3.8.egg/impacket/smbserver.py\", line 3746, in __init__\r\n    socketserver.TCPServer.__init__(self, server_address, handler_class)\r\n  File \"/usr/lib/python3.8/socketserver.py\", line 452, in __init__\r\n    self.server_bind()\r\n  File \"/usr/lib/python3.8/socketserver.py\", line 466, in server_bind\r\n    self.socket.bind(self.server_address)\r\nOSError: [Errno 98] Address already in use\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/919", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/919/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/919/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/919/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/919", "id": 679662441, "node_id": "MDU6SXNzdWU2Nzk2NjI0NDE=", "number": 919, "title": "psexec Something wen't wrong connecting the pipes", "user": {"login": "ffcommax", "id": 52239529, "node_id": "MDQ6VXNlcjUyMjM5NTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/52239529?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ffcommax", "html_url": "https://github.com/ffcommax", "followers_url": "https://api.github.com/users/ffcommax/followers", "following_url": "https://api.github.com/users/ffcommax/following{/other_user}", "gists_url": "https://api.github.com/users/ffcommax/gists{/gist_id}", "starred_url": "https://api.github.com/users/ffcommax/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ffcommax/subscriptions", "organizations_url": "https://api.github.com/users/ffcommax/orgs", "repos_url": "https://api.github.com/users/ffcommax/repos", "events_url": "https://api.github.com/users/ffcommax/events{/privacy}", "received_events_url": "https://api.github.com/users/ffcommax/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-16T00:09:54Z", "updated_at": "2020-08-18T12:48:18Z", "closed_at": "2020-08-18T12:48:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "psexec - connecting to pipes error\r\n\r\nLog:\r\n\r\nImpacket v0.9.19 - Copyright 2019 SecureAuth Corporation\r\n\r\n[*] Requesting shares on 10.10.10.10.....\r\n[*] Found writable share ADMIN$\r\n[*] Uploading file NZNFAXvY.exe\r\n[*] Opening SVCManager on 10.10.10.10.....\r\n[*] Creating service Gdwb on 10.10.10.10.....\r\n[*] Starting service Gdwb.....\r\n[*] Opening SVCManager on 10.10.10.10.....\r\n[-] Something wen't wrong connecting the pipes(<class '__main__.RemoteStdInPipe'>), try again\r\n[!] Press help for extra shell commands\r\n[*] Stopping service Gdwb.....\r\n[*] Removing service Gdwb.....\r\n[-] Something wen't wrong connecting the pipes(<class '__main__.RemoteStdOutPipe'>), try again\r\n[*] Removing file NZNFAXvY.exe.....\r\n[-] Error performing the uninstallation, cleaning up\r\n[-] Something wen't wrong connecting the pipes(<class '__main__.RemoteStdErrPipe'>), try again", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/910", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/910/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/910/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/910/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/910", "id": 668123593, "node_id": "MDU6SXNzdWU2NjgxMjM1OTM=", "number": 910, "title": "too many errors when trying to execute impacket related python files", "user": {"login": "metasploit-ruined-my-life", "id": 62478273, "node_id": "MDQ6VXNlcjYyNDc4Mjcz", "avatar_url": "https://avatars2.githubusercontent.com/u/62478273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/metasploit-ruined-my-life", "html_url": "https://github.com/metasploit-ruined-my-life", "followers_url": "https://api.github.com/users/metasploit-ruined-my-life/followers", "following_url": "https://api.github.com/users/metasploit-ruined-my-life/following{/other_user}", "gists_url": "https://api.github.com/users/metasploit-ruined-my-life/gists{/gist_id}", "starred_url": "https://api.github.com/users/metasploit-ruined-my-life/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/metasploit-ruined-my-life/subscriptions", "organizations_url": "https://api.github.com/users/metasploit-ruined-my-life/orgs", "repos_url": "https://api.github.com/users/metasploit-ruined-my-life/repos", "events_url": "https://api.github.com/users/metasploit-ruined-my-life/events{/privacy}", "received_events_url": "https://api.github.com/users/metasploit-ruined-my-life/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-07-29T20:18:34Z", "updated_at": "2020-07-30T18:05:06Z", "closed_at": "2020-07-30T18:05:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "hello,\r\n\r\nfirst of all i did my research. also posted on reddit but been told to use metasploit.... i did tried pip uninstall impacket > pip install impacket, pip uninstall impacket > git clone > pip install . also tried to install cryptodome with different styles | i really don't know how to get over it and i need your help. i started to solve windows machines today with really huge excitement then it turns into disappointment because i can't progress because of this.. problem occurs in impacket related python exploits.\r\n\r\npython exp.py\r\n\r\n> Traceback (most recent call last):\r\n>   File \"exp.py\", line 25, in <module>\r\n>     from impacket import smbserver, version\r\n>   File \"/usr/local/lib/python2.7/dist-packages/impacket/smbserver.py\", line 47, in <module>\r\n>     from impacket import smb, nmb, ntlm, uuid\r\n>   File \"/usr/local/lib/python2.7/dist-packages/impacket/smb.py\", line 54, in <module>\r\n>     from impacket.krb5.gssapi import KRB5_AP_REQ\r\n>   File \"/usr/local/lib/python2.7/dist-packages/impacket/krb5/gssapi.py\", line 20, in <module>\r\n>     from Cryptodome.Hash import HMAC, MD5\r\n>   File \"/usr/lib/python3/dist-packages/Cryptodome/Hash/HMAC.py\", line 38, in <module>\r\n>     from Cryptodome.Hash import MD5\r\n>   File \"/usr/lib/python3/dist-packages/Cryptodome/Hash/MD5.py\", line 47, in <module>\r\n>     \"\"\")\r\n>   File \"/usr/lib/python3/dist-packages/Cryptodome/Util/_raw_api.py\", line 303, in load_pycryptodome_raw_lib\r\n>     raise OSError(\"Cannot load native module '%s': %s\" % (name, \", \".join(attempts)))\r\n> OSError: Cannot load native module 'Cryptodome.Hash._MD5': Trying '_MD5.x86_64-linux-gnu.so': /usr/lib/python3/dist-packages/Cryptodome/Util/../Hash/_MD5.x86_64-linux-gnu.so: cannot open shared object file: No such file or directory, Trying '_MD5.so': /usr/lib/python3/dist-packages/Cryptodome/Util/../Hash/_MD5.so: cannot open shared object file: No such file or directory, Trying '_MD5module.so': /usr/lib/python3/dist-packages/Cryptodome/Util/../Hash/_MD5module.so: cannot open shared object file: No such file or directory\r\n\r\nexp.py is:\r\nhttps://github.com/wildkindcc/CVE-2018-9276/blob/master/CVE-2018-9276.py", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/908", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/908/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/908/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/908/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/908", "id": 667460785, "node_id": "MDU6SXNzdWU2Njc0NjA3ODU=", "number": 908, "title": "DPAPI Decrypt MK using System and SAM hives", "user": {"login": "darkoperator", "id": 521246, "node_id": "MDQ6VXNlcjUyMTI0Ng==", "avatar_url": "https://avatars0.githubusercontent.com/u/521246?v=4", "gravatar_id": "", "url": "https://api.github.com/users/darkoperator", "html_url": "https://github.com/darkoperator", "followers_url": "https://api.github.com/users/darkoperator/followers", "following_url": "https://api.github.com/users/darkoperator/following{/other_user}", "gists_url": "https://api.github.com/users/darkoperator/gists{/gist_id}", "starred_url": "https://api.github.com/users/darkoperator/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/darkoperator/subscriptions", "organizations_url": "https://api.github.com/users/darkoperator/orgs", "repos_url": "https://api.github.com/users/darkoperator/repos", "events_url": "https://api.github.com/users/darkoperator/events{/privacy}", "received_events_url": "https://api.github.com/users/darkoperator/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-29T00:20:33Z", "updated_at": "2020-07-29T01:20:19Z", "closed_at": "2020-07-29T01:20:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.22.dev1+20200713.100928.1e84ad60\r\nPython version:  Python 3.8.2\r\nTarget OS:  Registry Hives from Windows 10 1903, Impacket Running on Ubuntu 20.04\r\n\r\n### Debug Output With Command String  \r\n\r\n```\r\ncarlos@ubuntu:~/Desktop/impacket/examples$ python2 ./dpapi.py masterkey -f ./9217d96e-b282-4f6a-b382-c41d938c4e81 -security /home/carlos/Desktop/SAM -system /home/carlos/Desktop/system\r\nImpacket v0.9.21 - Copyright 2020 SecureAuth Corporation\r\n\r\n[MASTERKEYFILE]\r\nVersion     :        2 (2)\r\nGuid        : 9217d96e-b282-4f6a-b382-c41d938c4e81\r\nFlags       :        0 (0)\r\nPolicy      :        0 (0)\r\nMasterKeyLen: 00000088 (136)\r\nBackupKeyLen: 00000068 (104)\r\nCredHistLen : 00000000 (0)\r\nDomainKeyLen: 00000174 (372)\r\n\r\n[*] Target system bootKey: 0x251700480d3e5cdd6b92fc762a5f3187\r\n[*] Dumping LSA Secrets\r\n'NoneType' object has no attribute '__getitem__'\r\ncarlos@ubuntu:~/Desktop/impacket/examples$ python3 ./dpapi.py masterkey -f ./9217d96e-b282-4f6a-b382-c41d938c4e81 -security /home/carlos/Desktop/SAM -system /home/carlos/Desktop/system\r\nImpacket v0.9.22.dev1+20200713.100928.1e84ad60 - Copyright 2020 SecureAuth Corporation\r\n\r\n[MASTERKEYFILE]\r\nVersion     :        2 (2)\r\nGuid        : 9217d96e-b282-4f6a-b382-c41d938c4e81\r\nFlags       :        0 (0)\r\nPolicy      :        0 (0)\r\nMasterKeyLen: 00000088 (136)\r\nBackupKeyLen: 00000068 (104)\r\nCredHistLen : 00000000 (0)\r\nDomainKeyLen: 00000174 (372)\r\n\r\n[*] Target system bootKey: 0x251700480d3e5cdd6b92fc762a5f3187\r\n[*] Dumping LSA Secrets\r\n'NoneType' object is not subscriptable\r\n\r\n```\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/905", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/905/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/905/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/905/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/905", "id": 659726383, "node_id": "MDU6SXNzdWU2NTk3MjYzODM=", "number": 905, "title": "ImportError: No module named ldap", "user": {"login": "thiago6826", "id": 68448841, "node_id": "MDQ6VXNlcjY4NDQ4ODQx", "avatar_url": "https://avatars3.githubusercontent.com/u/68448841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thiago6826", "html_url": "https://github.com/thiago6826", "followers_url": "https://api.github.com/users/thiago6826/followers", "following_url": "https://api.github.com/users/thiago6826/following{/other_user}", "gists_url": "https://api.github.com/users/thiago6826/gists{/gist_id}", "starred_url": "https://api.github.com/users/thiago6826/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thiago6826/subscriptions", "organizations_url": "https://api.github.com/users/thiago6826/orgs", "repos_url": "https://api.github.com/users/thiago6826/repos", "events_url": "https://api.github.com/users/thiago6826/events{/privacy}", "received_events_url": "https://api.github.com/users/thiago6826/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-17T23:18:20Z", "updated_at": "2020-07-21T18:18:35Z", "closed_at": "2020-07-21T18:18:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  \r\nPython version:  3.8.2-3\r\nTarget OS:  Windows AD - SAUNA hack the box\r\n\r\n### Debug Output With Command String  \r\n\r\nroot@kali:~/Desktop/SAUNA# python GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile users.txt -format john -outputfile sauna.txt -dc-ip 10.10.10.175\r\nTraceback (most recent call last):\r\n  File \"GetNPUsers.py\", line 45, in <module>\r\n    from impacket.ldap import ldap, ldapasn1\r\nImportError: No module named ldap\r\nroot@kali:~/Desktop/SAUNA# \r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/903", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/903/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/903/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/903/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/903", "id": 655684358, "node_id": "MDU6SXNzdWU2NTU2ODQzNTg=", "number": 903, "title": "Getting error while installing through pip: \"Building wheels for collected packages: future\"", "user": {"login": "hash30", "id": 54507991, "node_id": "MDQ6VXNlcjU0NTA3OTkx", "avatar_url": "https://avatars0.githubusercontent.com/u/54507991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hash30", "html_url": "https://github.com/hash30", "followers_url": "https://api.github.com/users/hash30/followers", "following_url": "https://api.github.com/users/hash30/following{/other_user}", "gists_url": "https://api.github.com/users/hash30/gists{/gist_id}", "starred_url": "https://api.github.com/users/hash30/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hash30/subscriptions", "organizations_url": "https://api.github.com/users/hash30/orgs", "repos_url": "https://api.github.com/users/hash30/repos", "events_url": "https://api.github.com/users/hash30/events{/privacy}", "received_events_url": "https://api.github.com/users/hash30/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-13T09:11:50Z", "updated_at": "2020-07-13T13:01:09Z", "closed_at": "2020-07-13T13:01:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "`Building wheel for future (setup.py) ... error\r\n  ERROR: Command errored out with exit status 1:\r\n   command: /usr/bin/python -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/tmp/pip-install-D36jfE/future/setup.py'\"'\"'; __file__='\"'\"'/tmp/pip-install-D36jfE/future/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' bdist_wheel -d /tmp/pip-wheel-UqC0z4                                                            \r\n       cwd: /tmp/pip-install-D36jfE/future/                                               \r\n  Complete output (6 lines):                                                              \r\n  usage: setup.py [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]                   \r\n     or: setup.py --help [cmd1 cmd2 ...]                                                  \r\n     or: setup.py --help-commands                                                         \r\n     or: setup.py cmd --help                                                              \r\n                                                                                          \r\n  error: invalid command 'bdist_wheel'                                                    \r\n  ----------------------------------------                                                \r\n  ERROR: Failed building wheel for future\r\n`\r\nPlease help me out!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/902", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/902/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/902/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/902/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/902", "id": 655602660, "node_id": "MDU6SXNzdWU2NTU2MDI2NjA=", "number": 902, "title": "secretsdump.py: 'LSA hashes extraction failed: can only concatenate str (not \"bytes\") to str'", "user": {"login": "corsch", "id": 12086321, "node_id": "MDQ6VXNlcjEyMDg2MzIx", "avatar_url": "https://avatars3.githubusercontent.com/u/12086321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/corsch", "html_url": "https://github.com/corsch", "followers_url": "https://api.github.com/users/corsch/followers", "following_url": "https://api.github.com/users/corsch/following{/other_user}", "gists_url": "https://api.github.com/users/corsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/corsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/corsch/subscriptions", "organizations_url": "https://api.github.com/users/corsch/orgs", "repos_url": "https://api.github.com/users/corsch/repos", "events_url": "https://api.github.com/users/corsch/events{/privacy}", "received_events_url": "https://api.github.com/users/corsch/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-07-13T05:57:00Z", "updated_at": "2020-07-28T16:50:57Z", "closed_at": "2020-07-28T16:50:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  Impacket v0.9.22.dev1+20200629.145357.5d4ad6cc\r\nPython version:  Python 3.8.3\r\nTarget OS:  KALI 2020\r\n\r\n### Debug Output With Command String  \r\n\r\nsecretsdump.py administrator@<TARGETIP> -hashes <LMHASH>:<NTHASH> -pwd-last-set -user-status -history -debug -ts\r\n```\r\npython3 /usr/share/doc/python3-impacket/examples/secretsdump.py administrator@<TARGETIP> -hashes <LMHASH>:<NTHASH> -pwd-last-set -user-status -history -debug -ts\r\nImpacket v0.9.22.dev1+20200629.145357.5d4ad6cc - Copyright 2020 SecureAuth Corporation\r\n\r\n[2020-07-13 07:45:36] [+] Impacket Library Installation Path: /usr/local/lib/python3.8/dist-packages/impacket\r\n[2020-07-13 07:45:38] [+] Service RemoteRegistry is already running\r\n[2020-07-13 07:45:39] [+] Retrieving class info for JD\r\n[2020-07-13 07:45:41] [+] Retrieving class info for Skew1\r\n[2020-07-13 07:45:42] [+] Retrieving class info for GBG\r\n[2020-07-13 07:45:43] [+] Retrieving class info for Data\r\n[2020-07-13 07:45:44] [*] Target system bootKey: <BOOTKEY>\r\n[2020-07-13 07:45:44] [+] Checking NoLMHash Policy\r\n[2020-07-13 07:45:45] [+] LMHashes are being stored\r\n[2020-07-13 07:45:45] [+] Saving remote SAM database\r\n[2020-07-13 07:45:48] [*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\r\n[2020-07-13 07:45:48] [+] Calculating HashedBootKey from SAM\r\n[2020-07-13 07:46:02] [+] NewStyle hashes is: False\r\nAdministrator:500:<LMHASH>:<NTHASH>:::\r\n[2020-07-13 07:46:41] [+] Saving remote SECURITY database\r\n[2020-07-13 07:46:43] [*] Dumping cached domain logon information (domain/username:hash)\r\n[2020-07-13 07:46:50] [+] Decrypting LSA Key\r\n[2020-07-13 07:46:52] [+] PolEKList not found, trying PolSecretEncryptionKey\r\n[2020-07-13 07:46:54] [+] Decrypting NL$KM\r\nTraceback (most recent call last):\r\n  File \"/usr/share/doc/python3-impacket/examples/secretsdump.py\", line 183, in dump\r\n    self.__LSASecrets.dumpCachedHashes()\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/secretsdump.py\", line 1414, in dumpCachedHashes\r\n    self.__getNLKMSecret()\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/secretsdump.py\", line 1376, in __getNLKMSecret\r\n    self.__NKLMKey = self.__decryptSecret(self.__LSAKey, value[1])\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/secretsdump.py\", line 1314, in __decryptSecret\r\n    plainText += Crypt1.decrypt(cipherText)\r\nTypeError: can only concatenate str (not \"bytes\") to str\r\n[2020-07-13 07:46:58] [-] LSA hashes extraction failed: can only concatenate str (not \"bytes\") to str\r\n[2020-07-13 07:46:59] [+] Exiting NTDSHashes.dump() because SAMR SessionError: code: 0xc00000df - STATUS_NO_SUCH_DOMAIN - The specified domain did not exist.\r\n[2020-07-13 07:46:59] [*] Cleaning up...\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/900", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/900/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/900/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/900/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/900", "id": 654903729, "node_id": "MDU6SXNzdWU2NTQ5MDM3Mjk=", "number": 900, "title": "[Python3 Migration] TypeError in ntlm.py", "user": {"login": "Si0uL", "id": 26586210, "node_id": "MDQ6VXNlcjI2NTg2MjEw", "avatar_url": "https://avatars3.githubusercontent.com/u/26586210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Si0uL", "html_url": "https://github.com/Si0uL", "followers_url": "https://api.github.com/users/Si0uL/followers", "following_url": "https://api.github.com/users/Si0uL/following{/other_user}", "gists_url": "https://api.github.com/users/Si0uL/gists{/gist_id}", "starred_url": "https://api.github.com/users/Si0uL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Si0uL/subscriptions", "organizations_url": "https://api.github.com/users/Si0uL/orgs", "repos_url": "https://api.github.com/users/Si0uL/repos", "events_url": "https://api.github.com/users/Si0uL/events{/privacy}", "received_events_url": "https://api.github.com/users/Si0uL/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-10T16:41:47Z", "updated_at": "2020-07-21T18:30:04Z", "closed_at": "2020-07-21T18:30:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration \r\nimpacket version:  0.9.21\r\nPython version:  3.6.9\r\nTarget OS:  Ubuntu\r\n\r\n### Debug Output With Command String\r\nFrom custom script, after using:\r\n\r\n```\r\nfrom impacket.smbconnection import SMBConnection\r\nfrmo impacket.smb import SMB_DIALECT\r\n\r\nsmbconn = SMBConnection(ip, ip, preferedDialect=SMB_DIALECT)\r\nsmbconn.login('', '')\r\n```\r\n\r\nStacktrace:\r\n```\r\nTraceback (most recent call last):\r\n  File \"xxx\", line 55, in xxx\r\n    smb.login('' , '')\r\n  File \"/home/auditor/.local/lib/python3.6/site-packages/impacket/smbconnection.py\", line 269, in login\r\n    return self._SMBConnection.login(user, password, domain, lmhash, nthash, ntlmFallback)\r\n  File \"/home/auditor/.local/lib/python3.6/site-packages/impacket/smb.py\", line 3427, in login\r\n    self.login_extended(user, password, domain, lmhash, nthash, use_ntlmv2 = False)\r\n  File \"/home/auditor/.local/lib/python3.6/site-packages/impacket/smb.py\", line 3331, in login_extended\r\n    type3, exportedSessionKey = ntlm.getNTLMSSPType3(auth, respToken['ResponseToken'], user, password, domain, lmhash, nthash, use_ntlmv2 = use_ntlmv2)\r\n  File \"/home/auditor/.local/lib/python3.6/site-packages/impacket/ntlm.py\", line 656, in getNTLMSSPType3\r\n    lmhash, nthash, use_ntlmv2)\r\n  File \"/home/auditor/.local/lib/python3.6/site-packages/impacket/ntlm.py\", line 864, in KXKEY\r\n    keyExchangeKey = hmac_md5(sessionBaseKey, serverChallenge + lmChallengeResponse[:8])\r\nTypeError: can't concat str to bytes\r\n```\r\n\r\nThis looks like a simple python3 migration problem, caused by change of `str` type to `bytes` (similar to #691). As it only happens after using `login` with empty credentials, it looks like an initialization problem.\r\n\r\nFix looks trivial in first approach, and would be to initialize `lmChallengeResponse` as an empty `bytes` object instead of `str`. See: \r\nhttps://github.com/SecureAuthCorp/impacket/blob/master/impacket/ntlm.py#L719\r\nhttps://github.com/SecureAuthCorp/impacket/blob/master/impacket/ntlm.py#L932", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/897", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/897/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/897/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/897/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/897", "id": 652398875, "node_id": "MDU6SXNzdWU2NTIzOTg4NzU=", "number": 897, "title": "mssqlclient.py \"Unpacked data doesn't match constant value\" / NTLMSSP", "user": {"login": "corsch", "id": 12086321, "node_id": "MDQ6VXNlcjEyMDg2MzIx", "avatar_url": "https://avatars3.githubusercontent.com/u/12086321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/corsch", "html_url": "https://github.com/corsch", "followers_url": "https://api.github.com/users/corsch/followers", "following_url": "https://api.github.com/users/corsch/following{/other_user}", "gists_url": "https://api.github.com/users/corsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/corsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/corsch/subscriptions", "organizations_url": "https://api.github.com/users/corsch/orgs", "repos_url": "https://api.github.com/users/corsch/repos", "events_url": "https://api.github.com/users/corsch/events{/privacy}", "received_events_url": "https://api.github.com/users/corsch/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-07T15:04:06Z", "updated_at": "2020-07-08T12:51:22Z", "closed_at": "2020-07-08T12:51:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.9.21\r\nPython version:  3.8.3\r\nTarget OS:  KALI_2020.2 / Windows Server 2008R2 & 2012R2 (Both with SQL Server)\r\n\r\n### Debug Output With Command String  \r\nproxychains python3 mssqlclient.py -debug DOMAIN/USER@10.10.10.2 -p 53231 -windows-auth -no-pass\r\n\r\nProxyChains-3.1 (http://proxychains.sf.net)\r\nImpacket v0.9.21 - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: /usr/lib/python3/dist-packages/impacket\r\n|S-chain|-<>-127.0.0.1:1080-<><>-10.10.10.2:53231-<><>-OK\r\n[+] Exception:\r\nTraceback (most recent call last):\r\n  File \"mssqlclient.py\", line 179, in <module>\r\n    res = ms_sql.login(options.db, username, password, domain, options.hashes, options.windows_auth)\r\n  File \"/usr/lib/python3/dist-packages/impacket/tds.py\", line 972, in login\r\n    type3, exportedSessionKey = ntlm.getNTLMSSPType3(auth, serverChallenge, username, password, domain, lmhash, nthash)\r\n  File \"/usr/lib/python3/dist-packages/impacket/ntlm.py\", line 618, in getNTLMSSPType3\r\n    ntlmChallenge = NTLMAuthChallenge(type2)\r\n  File \"/usr/lib/python3/dist-packages/impacket/structure.py\", line 84, in __init__\r\n    self.fromString(data)\r\n  File \"/usr/lib/python3/dist-packages/impacket/ntlm.py\", line 371, in fromString\r\n    Structure.fromString(self,data)\r\n  File \"/usr/lib/python3/dist-packages/impacket/structure.py\", line 149, in fromString\r\n    self[field[0]] = self.unpack(field[1], data[:size], dataClassOrCode = dataClassOrCode, field = field[0])\r\n  File \"/usr/lib/python3/dist-packages/impacket/structure.py\", line 312, in unpack\r\n    raise Exception(\"Unpacked data doesn't match constant value '%r' should be '%r'\" % (data, answer))\r\nException: (\"Unpacked data doesn't match constant value 'b'\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00'' should be ''NTLMSSP\\\\x00''\", 'When unpacking field \\' | \"NTLMSSP\\x00 | b\\'\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\'[:8]\\'')\r\n[-] (\"Unpacked data doesn't match constant value 'b'\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00'' should be ''NTLMSSP\\\\x00''\", 'When unpacking field \\' | \"NTLMSSP\\x00 | b\\'\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\'[:8]\\'')\r\n\r\n\r\n\r\n### Additional context  \r\nWorks on KALI Linux with Impacket v0.9.20\r\n=> Won't work after upgrade to Impacket v0.9.21\r\n\r\n\"SQL NTLM Stealer\" => ntlmrelayx => proxychains mssqlclient\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/894", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/894/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/894/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/894/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/894", "id": 649999874, "node_id": "MDU6SXNzdWU2NDk5OTk4NzQ=", "number": 894, "title": "i cant install . impacket", "user": {"login": "EdgeLord69-something", "id": 67232432, "node_id": "MDQ6VXNlcjY3MjMyNDMy", "avatar_url": "https://avatars3.githubusercontent.com/u/67232432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EdgeLord69-something", "html_url": "https://github.com/EdgeLord69-something", "followers_url": "https://api.github.com/users/EdgeLord69-something/followers", "following_url": "https://api.github.com/users/EdgeLord69-something/following{/other_user}", "gists_url": "https://api.github.com/users/EdgeLord69-something/gists{/gist_id}", "starred_url": "https://api.github.com/users/EdgeLord69-something/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EdgeLord69-something/subscriptions", "organizations_url": "https://api.github.com/users/EdgeLord69-something/orgs", "repos_url": "https://api.github.com/users/EdgeLord69-something/repos", "events_url": "https://api.github.com/users/EdgeLord69-something/events{/privacy}", "received_events_url": "https://api.github.com/users/EdgeLord69-something/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-02T15:00:49Z", "updated_at": "2020-07-02T16:16:21Z", "closed_at": "2020-07-02T15:05:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "when i try to pip install . it give me an error can someone please explain why this happens.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/890", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/890/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/890/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/890/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/890", "id": 643155818, "node_id": "MDU6SXNzdWU2NDMxNTU4MTg=", "number": 890, "title": "The 'pycryptodomex' distribution was not found and is required by impacket", "user": {"login": "kaizen-dry", "id": 62895723, "node_id": "MDQ6VXNlcjYyODk1NzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/62895723?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaizen-dry", "html_url": "https://github.com/kaizen-dry", "followers_url": "https://api.github.com/users/kaizen-dry/followers", "following_url": "https://api.github.com/users/kaizen-dry/following{/other_user}", "gists_url": "https://api.github.com/users/kaizen-dry/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaizen-dry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaizen-dry/subscriptions", "organizations_url": "https://api.github.com/users/kaizen-dry/orgs", "repos_url": "https://api.github.com/users/kaizen-dry/repos", "events_url": "https://api.github.com/users/kaizen-dry/events{/privacy}", "received_events_url": "https://api.github.com/users/kaizen-dry/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-22T15:17:17Z", "updated_at": "2020-06-24T14:36:24Z", "closed_at": "2020-06-24T14:36:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Command: **sudo smbserver.py -smb2support -debug -comment \"test\" data /home/janak/smbserver**\r\n\r\nActually any command related to smbserver.py gives me same error as below:\r\n\r\n`File \"/usr/local/bin/smbserver.py\", line 4, in <module>\r\n    __import__('pkg_resources').run_script('impacket==0.9.22.dev1+20200520.120526.3f1e7ddd', 'smbserver.py')\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 3251, in <module>\r\n    @_call_aside\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 3235, in _call_aside\r\n    f(*args, **kwargs)\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 3264, in _initialize_master_working_set\r\n    working_set = WorkingSet._build_master()\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 583, in _build_master\r\n    ws.require(__requires__)\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 900, in require\r\n    needed = self.resolve(parse_requirements(requirements))\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 786, in resolve\r\n    raise DistributionNotFound(req, requirers)\r\npkg_resources.DistributionNotFound: The 'pycryptodomex' distribution was not found and is required by impacket`\r\n\r\n pycryptodomex:\r\n```\r\npip install pycryptodomex                                                                                                                                                               \r\nDefaulting to user installation because normal site-packages is not writeable                                                                                                                 \r\nRequirement already satisfied: pycryptodomex in /usr/lib/python3/dist-packages (3.9.7)\r\n```\r\npycryptodome:\r\n```\r\npip install pycryptodome\r\nDefaulting to user installation because normal site-packages is not writeable\r\nRequirement already satisfied: pycryptodome in /home/janak/.local/lib/python3.8/site-packages (3.9.7)\r\n```\r\nimpacket version:\r\n`python3-impacket/rolling,rolling,now 0.9.20-5 all [installed]`\r\n\r\nI was following this article where he creates UNC path pointing towards his smbserver, so his smbserver can transfer files from this path. Following is from article itself : \r\n\r\n_Tomcat interprets the UNC path and is trying to install an application from the \u201cdatatest\u201d folder. We will oblige it and create the \u201cdatatest\u201d folder, and add a little WAR file in which we insert a backdoor that will enable us to take over the server from our C&C._\r\n\r\nhttps://www.certilience.fr/2019/03/tomcat-exploit-variant-host-manager/", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/889", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/889/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/889/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/889/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/889", "id": 642352624, "node_id": "MDU6SXNzdWU2NDIzNTI2MjQ=", "number": 889, "title": "Python 3 warnings when installing a packaged version", "user": {"login": "maaaaz", "id": 1863158, "node_id": "MDQ6VXNlcjE4NjMxNTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1863158?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maaaaz", "html_url": "https://github.com/maaaaz", "followers_url": "https://api.github.com/users/maaaaz/followers", "following_url": "https://api.github.com/users/maaaaz/following{/other_user}", "gists_url": "https://api.github.com/users/maaaaz/gists{/gist_id}", "starred_url": "https://api.github.com/users/maaaaz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maaaaz/subscriptions", "organizations_url": "https://api.github.com/users/maaaaz/orgs", "repos_url": "https://api.github.com/users/maaaaz/repos", "events_url": "https://api.github.com/users/maaaaz/events{/privacy}", "received_events_url": "https://api.github.com/users/maaaaz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-20T10:36:42Z", "updated_at": "2020-06-24T14:38:18Z", "closed_at": "2020-06-24T14:38:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello there,\r\n\r\nSome warnings when installing a packaged version:\r\n```\r\n$ apt install python3-impacket\r\n...\r\nSetting up python3-impacket (0.9.21-1) ...\r\n/usr/lib/python3/dist-packages/impacket/smbserver.py:2464: SyntaxWarning: \"is not\" with a literal. Did you mean \"!=\"?\r\n  if jtr_dump_path is not '':\r\n/usr/lib/python3/dist-packages/impacket/smbserver.py:2500: SyntaxWarning: \"is not\" with a literal. Did you mean \"!=\"?\r\n  if jtr_dump_path is not '':\r\n/usr/lib/python3/dist-packages/impacket/smbserver.py:2842: SyntaxWarning: \"is not\" with a literal. Did you mean \"!=\"?\r\n  if jtr_dump_path is not '':\r\n/usr/lib/python3/dist-packages/impacket/smbserver.py:4416: SyntaxWarning: \"is not\" with a literal. Did you mean \"!=\"?\r\n  if credentials_fname is not \"\":\r\n```\r\n\r\n* `Linux 5.6.0-kali2-amd64 x86_64`\r\n* `Kali GNU/Linux Rolling`\r\n* `Python 3.8.3`\r\n\r\nCheers !", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/888", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/888/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/888/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/888/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/888", "id": 641156715, "node_id": "MDU6SXNzdWU2NDExNTY3MTU=", "number": 888, "title": "ACCESS_MASK GENERIC_WRITE seems incorrect", "user": {"login": "AaronRobson", "id": 5177808, "node_id": "MDQ6VXNlcjUxNzc4MDg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5177808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AaronRobson", "html_url": "https://github.com/AaronRobson", "followers_url": "https://api.github.com/users/AaronRobson/followers", "following_url": "https://api.github.com/users/AaronRobson/following{/other_user}", "gists_url": "https://api.github.com/users/AaronRobson/gists{/gist_id}", "starred_url": "https://api.github.com/users/AaronRobson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AaronRobson/subscriptions", "organizations_url": "https://api.github.com/users/AaronRobson/orgs", "repos_url": "https://api.github.com/users/AaronRobson/repos", "events_url": "https://api.github.com/users/AaronRobson/events{/privacy}", "received_events_url": "https://api.github.com/users/AaronRobson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-18T12:11:24Z", "updated_at": "2020-06-29T17:55:03Z", "closed_at": "2020-06-29T17:55:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version: 0.9.21 (master)\r\nPython version: Any\r\nTarget OS: Any\r\n\r\n### Additional context  \r\nAs seen here: https://github.com/SecureAuthCorp/impacket/blob/429f97a894d35473d478cbacff5919739ae409b4/impacket/dcerpc/v5/dtypes.py#L478\r\nAnd here: https://github.com/SecureAuthCorp/impacket/blob/429f97a894d35473d478cbacff5919739ae409b4/impacket/ldap/ldaptypes.py#L192\r\n\r\nThey match the documentation here: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/7a53f60e-e730-4dfe-bbe9-b21b62eb790b\r\n\r\nHowever the GENERIC_WRITE is `0x4000000` (7 hex digits) whereas based on the ordering and the zero padding of other values it should be `0x40000000` (8 hex digits)\r\n\r\nOther similar values: https://github.com/SecureAuthCorp/impacket/blob/429f97a894d35473d478cbacff5919739ae409b4/impacket/dcerpc/v5/rprn.py#L84\r\nAnd documentation: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-samr/262970b7-cd4a-41f4-8c4d-5a27f0092aaa\r\nAppear to agree with my findings.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/886", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/886/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/886/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/886/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/886", "id": 641094075, "node_id": "MDU6SXNzdWU2NDEwOTQwNzU=", "number": 886, "title": "RPC_SID.fromCanonical sets the 'IdentifierAuthority' key redundantly.", "user": {"login": "AaronRobson", "id": 5177808, "node_id": "MDQ6VXNlcjUxNzc4MDg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5177808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AaronRobson", "html_url": "https://github.com/AaronRobson", "followers_url": "https://api.github.com/users/AaronRobson/followers", "following_url": "https://api.github.com/users/AaronRobson/following{/other_user}", "gists_url": "https://api.github.com/users/AaronRobson/gists{/gist_id}", "starred_url": "https://api.github.com/users/AaronRobson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AaronRobson/subscriptions", "organizations_url": "https://api.github.com/users/AaronRobson/orgs", "repos_url": "https://api.github.com/users/AaronRobson/repos", "events_url": "https://api.github.com/users/AaronRobson/events{/privacy}", "received_events_url": "https://api.github.com/users/AaronRobson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-18T10:27:42Z", "updated_at": "2020-06-24T14:52:43Z", "closed_at": "2020-06-24T14:52:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.21 (master)\r\nPython version:  Any\r\nTarget OS:  Any\r\n\r\n### Additional context  \r\nI suspected that this was due to a copy paste introduced issue but it seems to be a confusion of the type (`RPC_SID_IDENTIFIER_AUTHORITY`) and the value.\r\nFound using SonarQube L465.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/882", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/882/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/882/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/882/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/882", "id": 640188156, "node_id": "MDU6SXNzdWU2NDAxODgxNTY=", "number": 882, "title": "by default hElfrReadELW does not accept offset", "user": {"login": "spinenkoia", "id": 7285025, "node_id": "MDQ6VXNlcjcyODUwMjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/7285025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spinenkoia", "html_url": "https://github.com/spinenkoia", "followers_url": "https://api.github.com/users/spinenkoia/followers", "following_url": "https://api.github.com/users/spinenkoia/following{/other_user}", "gists_url": "https://api.github.com/users/spinenkoia/gists{/gist_id}", "starred_url": "https://api.github.com/users/spinenkoia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spinenkoia/subscriptions", "organizations_url": "https://api.github.com/users/spinenkoia/orgs", "repos_url": "https://api.github.com/users/spinenkoia/repos", "events_url": "https://api.github.com/users/spinenkoia/events{/privacy}", "received_events_url": "https://api.github.com/users/spinenkoia/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-06-17T06:52:05Z", "updated_at": "2020-08-14T01:20:40Z", "closed_at": "2020-08-14T01:20:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.21\r\nPython version:  3.7\r\nTarget OS:  Arch Linux 5.4.6\r\n\r\n### Additional context  \r\nFrom the Readeventlog documentation, if EVENTLOG_SEEK_READ is omitted, offset is ignored, as a result, all events are returned from the beginning, instead of the necessary ones.\r\n\r\n\r\nYou must set readFlags=EVENTLOG_SEEK_READ|EVENT LOG_FORWARD_READ by default", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/876", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/876/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/876/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/876/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/876", "id": 635048110, "node_id": "MDU6SXNzdWU2MzUwNDgxMTA=", "number": 876, "title": "Commando Impacket VM issue", "user": {"login": "Chantal2019", "id": 64367270, "node_id": "MDQ6VXNlcjY0MzY3Mjcw", "avatar_url": "https://avatars3.githubusercontent.com/u/64367270?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Chantal2019", "html_url": "https://github.com/Chantal2019", "followers_url": "https://api.github.com/users/Chantal2019/followers", "following_url": "https://api.github.com/users/Chantal2019/following{/other_user}", "gists_url": "https://api.github.com/users/Chantal2019/gists{/gist_id}", "starred_url": "https://api.github.com/users/Chantal2019/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Chantal2019/subscriptions", "organizations_url": "https://api.github.com/users/Chantal2019/orgs", "repos_url": "https://api.github.com/users/Chantal2019/repos", "events_url": "https://api.github.com/users/Chantal2019/events{/privacy}", "received_events_url": "https://api.github.com/users/Chantal2019/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-09T01:54:56Z", "updated_at": "2020-06-09T01:56:52Z", "closed_at": "2020-06-09T01:56:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "C:\\Tools\\impacket-examples-windows>smbserver test .\r\nImpacket v0.9.17 - Copyright 2002-2018 Core Security Technologies\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"smbserver.py\", line 63, in <module>\r\n  File \"build\\bdist.win32\\egg\\impacket\\smbserver.py\", line 4564, in __init__\r\n  File \"build\\bdist.win32\\egg\\impacket\\smbserver.py\", line 3706, in __init__\r\n  File \"SocketServer.py\", line 417, in __init__\r\n  File \"SocketServer.py\", line 431, in server_bind\r\n  File \"socket.py\", line 228, in meth\r\nsocket.error: [Errno 10013] An attempt was made to access a socket in a way forbidden by its access permissions\r\n[2984] Failed to execute script smbserver\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/874", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/874/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/874/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/874/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/874", "id": 633600889, "node_id": "MDU6SXNzdWU2MzM2MDA4ODk=", "number": 874, "title": "mssqlclient.py    pkg_resources.DistributionNotFound:", "user": {"login": "aymenamer691", "id": 66565974, "node_id": "MDQ6VXNlcjY2NTY1OTc0", "avatar_url": "https://avatars2.githubusercontent.com/u/66565974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aymenamer691", "html_url": "https://github.com/aymenamer691", "followers_url": "https://api.github.com/users/aymenamer691/followers", "following_url": "https://api.github.com/users/aymenamer691/following{/other_user}", "gists_url": "https://api.github.com/users/aymenamer691/gists{/gist_id}", "starred_url": "https://api.github.com/users/aymenamer691/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aymenamer691/subscriptions", "organizations_url": "https://api.github.com/users/aymenamer691/orgs", "repos_url": "https://api.github.com/users/aymenamer691/repos", "events_url": "https://api.github.com/users/aymenamer691/events{/privacy}", "received_events_url": "https://api.github.com/users/aymenamer691/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-07T17:30:19Z", "updated_at": "2020-06-10T19:15:01Z", "closed_at": "2020-06-10T19:15:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello SecureAuthCorp I Wanna Ask For SOme Help When i run mssqlclient and try login to some smb i put the password but i got this problem\r\n\r\nroot@kali:~# mssqlclient.py ARCHETYPE\\sql_svc@10.10.10.27 -windows-auth\r\nImpacket v0.9.22.dev1+20200605.133909.874d7ae4 - Copyright 2020 SecureAuth Corporation\r\n\r\nPassword:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/mssqlclient.py\", line 4, in <module>\r\n    __import__('pkg_resources').run_script('impacket==0.9.22.dev1+20200605.133909.874d7ae4', 'mssqlclient.py')\r\n  File \"/usr/local/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 666, in run_script\r\n    self.require(requires)[0].run_script(script_name, ns)\r\n  File \"/usr/local/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 1462, in run_script\r\n    exec(code, namespace, namespace)\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket-0.9.22.dev1+20200605.133909.874d7ae4-py2.7.egg/EGG-INFO/scripts/mssqlclient.py\", line 173, in <module>\r\n    ms_sql.connect()\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket-0.9.22.dev1+20200605.133909.874d7ae4-py2.7.egg/impacket/tds.py\", line 532, in connect\r\n    sock.connect(sa)\r\n  File \"/usr/lib/python2.7/socket.py\", line 228, in meth\r\n    return getattr(self._sock,name)(*args)\r\nsocket.error: [Errno 110] Connection timed out\r\nroot@kali:~#\r\n\r\nor i got time out some time i hope some one can help me and thanks", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/867", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/867/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/867/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/867/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/867", "id": 627464536, "node_id": "MDU6SXNzdWU2Mjc0NjQ1MzY=", "number": 867, "title": "Calling getMethods() on a IWbemClassObject from ExecQuery() always returns an empty set", "user": {"login": "vevhook", "id": 65199189, "node_id": "MDQ6VXNlcjY1MTk5MTg5", "avatar_url": "https://avatars0.githubusercontent.com/u/65199189?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vevhook", "html_url": "https://github.com/vevhook", "followers_url": "https://api.github.com/users/vevhook/followers", "following_url": "https://api.github.com/users/vevhook/following{/other_user}", "gists_url": "https://api.github.com/users/vevhook/gists{/gist_id}", "starred_url": "https://api.github.com/users/vevhook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vevhook/subscriptions", "organizations_url": "https://api.github.com/users/vevhook/orgs", "repos_url": "https://api.github.com/users/vevhook/repos", "events_url": "https://api.github.com/users/vevhook/events{/privacy}", "received_events_url": "https://api.github.com/users/vevhook/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-05-29T18:41:24Z", "updated_at": "2020-05-29T23:25:30Z", "closed_at": "2020-05-29T23:25:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "There may be something I'm missing from WMI as a whole, but I'm trying to do something fairly simple. Given a WQL query to get running processes on a remote system, run the `GetOwner()` method on each entry returned. Here's my code (mostly ripped from `wmiquery.py`):\r\n\r\n```\r\ndcom = DCOMConnection(address, username, password, domain, lmhash, nthash, options.aesKey, oxidResolver=True, doKerberos=options.k, kdcHost=options.dc_ip)\r\n\r\niInterface = dcom.CoCreateInstanceEx(wmi.CLSID_WbemLevel1Login,wmi.IID_IWbemLevel1Login)\r\niWbemLevel1Login = wmi.IWbemLevel1Login(iInterface)\r\niWbemServices= iWbemLevel1Login.NTLMLogin(options.namespace, NULL, NULL)\r\niWbemLevel1Login.RemRelease()\r\n\r\niEnum = iWbemServices.ExecQuery('select * from win32_process')\r\n\r\nfirst_entry = iEnum.Next(0xffffffff,1)[0]\r\nprint(first_entry.getMethods())  # prints ()\r\nprint(first_entry.GetOwner())  # GetOwner doesn't exist\r\n```\r\n\r\nI've cross-referenced my code with `wmiexec.py`, which calls `Create` on `Win32_Process` and the only difference I can see is that the instance of `IWbemClassObject` is from a call to `GetObject` instead of `ExecQuery`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/866", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/866/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/866/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/866/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/866", "id": 625266107, "node_id": "MDU6SXNzdWU2MjUyNjYxMDc=", "number": 866, "title": "OpenSSL.SSL.Error: [('SSL routines', 'state_machine', 'internal error')]", "user": {"login": "francoataffarel", "id": 26504139, "node_id": "MDQ6VXNlcjI2NTA0MTM5", "avatar_url": "https://avatars1.githubusercontent.com/u/26504139?v=4", "gravatar_id": "", "url": "https://api.github.com/users/francoataffarel", "html_url": "https://github.com/francoataffarel", "followers_url": "https://api.github.com/users/francoataffarel/followers", "following_url": "https://api.github.com/users/francoataffarel/following{/other_user}", "gists_url": "https://api.github.com/users/francoataffarel/gists{/gist_id}", "starred_url": "https://api.github.com/users/francoataffarel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/francoataffarel/subscriptions", "organizations_url": "https://api.github.com/users/francoataffarel/orgs", "repos_url": "https://api.github.com/users/francoataffarel/repos", "events_url": "https://api.github.com/users/francoataffarel/events{/privacy}", "received_events_url": "https://api.github.com/users/francoataffarel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-26T23:35:47Z", "updated_at": "2020-07-05T18:30:50Z", "closed_at": "2020-07-05T18:30:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:   Impacket v0.9.21\r\nPython version:  3.8.3\r\nTarget OS:  sql server\r\n\r\n### Debug Output With Command String  \r\n\r\nImpacket v0.9.21 - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: /usr/local/lib/python3.8/dist-packages/impacket\r\n[*] Encryption required, switching to TLS\r\n[+] Exception:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/mssqlclient.py\", line 179, in <module>\r\n    res = ms_sql.login(options.db, username, password, domain, options.hashes, options.windows_auth)\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/tds.py\", line 917, in login\r\n    tls.do_handshake()\r\n  File \"/usr/local/lib/python3.8/dist-packages/OpenSSL/SSL.py\", line 1638, in do_handshake\r\n    self._raise_ssl_error(self._ssl, result)\r\n  File \"/usr/local/lib/python3.8/dist-packages/OpenSSL/SSL.py\", line 1378, in _raise_ssl_error\r\n    _raise_current_error()\r\n  File \"/usr/local/lib/python3.8/dist-packages/OpenSSL/_util.py\", line 54, in exception_from_error_queue\r\n    raise exception_type(errors)\r\n\r\n\r\nOpenSSL.SSL.Error: [('SSL routines', 'state_machine', 'internal error')]\r\n[-] [('SSL routines', 'state_machine', 'internal error')]\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/865", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/865/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/865/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/865/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/865", "id": 623808353, "node_id": "MDU6SXNzdWU2MjM4MDgzNTM=", "number": 865, "title": "setup.py return error", "user": {"login": "evantoday", "id": 25822267, "node_id": "MDQ6VXNlcjI1ODIyMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/25822267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/evantoday", "html_url": "https://github.com/evantoday", "followers_url": "https://api.github.com/users/evantoday/followers", "following_url": "https://api.github.com/users/evantoday/following{/other_user}", "gists_url": "https://api.github.com/users/evantoday/gists{/gist_id}", "starred_url": "https://api.github.com/users/evantoday/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/evantoday/subscriptions", "organizations_url": "https://api.github.com/users/evantoday/orgs", "repos_url": "https://api.github.com/users/evantoday/repos", "events_url": "https://api.github.com/users/evantoday/events{/privacy}", "received_events_url": "https://api.github.com/users/evantoday/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-24T06:52:17Z", "updated_at": "2020-06-10T19:24:19Z", "closed_at": "2020-06-10T19:24:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "$ sudo python setup.py install\r\n\r\nWriting /tmp/easy_install-7pFYve/Jinja2-3.0.0a1/setup.cfg\r\nRunning Jinja2-3.0.0a1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-7pFYve/Jinja2-3.0.0a1/egg-dist-tmp-frmw4s\r\nTraceback (most recent call last):\r\n  File \"setup.py\", line 69, in <module>\r\n    \"Programming Language :: Python :: 2.6\",\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/__init__.py\", line 145, in setup\r\n    return distutils.core.setup(**attrs)\r\n  File \"/usr/lib/python2.7/distutils/core.py\", line 151, in setup\r\n    dist.run_commands()\r\n  File \"/usr/lib/python2.7/distutils/dist.py\", line 953, in run_commands\r\n    self.run_command(cmd)\r\n  File \"/usr/lib/python2.7/distutils/dist.py\", line 972, in run_command\r\n    cmd_obj.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/install.py\", line 67, in run\r\n    self.do_egg_install()\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/install.py\", line 117, in do_egg_install\r\n    cmd.run(show_deprecation=False)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 424, in run\r\n    self.easy_install(spec, not self.no_deps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 666, in easy_install\r\n    return self.install_item(None, spec, tmpdir, deps, True)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 713, in install_item\r\n    self.process_distribution(spec, dist, deps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 758, in process_distribution\r\n    [requirement], self.local_index, self.easy_install\r\n  File \"/usr/local/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 782, in resolve\r\n    replace_conflicting=replace_conflicting\r\n  File \"/usr/local/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 1065, in best_match\r\n    return self.obtain(req, installer)\r\n  File \"/usr/local/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 1077, in obtain\r\n    return installer(requirement)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 685, in easy_install\r\n    return self.install_item(spec, dist.location, tmpdir, deps)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 711, in install_item\r\n    dists = self.install_eggs(spec, download, tmpdir)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 896, in install_eggs\r\n    return self.build_and_install(setup_script, setup_base)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 1164, in build_and_install\r\n    self.run_setup(setup_script, setup_base, args)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/command/easy_install.py\", line 1150, in run_setup\r\n    run_setup(setup_script, args)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 253, in run_setup\r\n    raise\r\n  File \"/usr/lib/python2.7/contextlib.py\", line 35, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 195, in setup_context\r\n    yield\r\n  File \"/usr/lib/python2.7/contextlib.py\", line 35, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 166, in save_modules\r\n    saved_exc.resume()\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 141, in resume\r\n    six.reraise(type, exc, self._tb)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 154, in save_modules\r\n    yield saved\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 195, in setup_context\r\n    yield\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 250, in run_setup\r\n    _execfile(setup_script, ns)\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 45, in _execfile\r\n    exec(code, globals, locals)\r\n  File \"/tmp/easy_install-7pFYve/Jinja2-3.0.0a1/setup.py\", line 6, in <module>\r\n    import platform\r\n  File \"/usr/local/lib/python2.7/dist-packages/setuptools/sandbox.py\", line 419, in _open\r\n    return _open(path, mode, *args, **kw)\r\nTypeError: 'encoding' is an invalid keyword argument for this function\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/864", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/864/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/864/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/864/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/864", "id": 623687404, "node_id": "MDU6SXNzdWU2MjM2ODc0MDQ=", "number": 864, "title": "ntlmrelayx.py --help ERROR:root:", "user": {"login": "biogesic", "id": 47657356, "node_id": "MDQ6VXNlcjQ3NjU3MzU2", "avatar_url": "https://avatars3.githubusercontent.com/u/47657356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/biogesic", "html_url": "https://github.com/biogesic", "followers_url": "https://api.github.com/users/biogesic/followers", "following_url": "https://api.github.com/users/biogesic/following{/other_user}", "gists_url": "https://api.github.com/users/biogesic/gists{/gist_id}", "starred_url": "https://api.github.com/users/biogesic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/biogesic/subscriptions", "organizations_url": "https://api.github.com/users/biogesic/orgs", "repos_url": "https://api.github.com/users/biogesic/repos", "events_url": "https://api.github.com/users/biogesic/events{/privacy}", "received_events_url": "https://api.github.com/users/biogesic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-23T15:50:58Z", "updated_at": "2020-06-10T19:26:05Z", "closed_at": "2020-06-10T19:26:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nThis issue was encountered while i'm trying to use the 'ntlmrelayx.py' tool.\r\n---\r\n# ntlmrelayx.py --help\r\nImpacket v0.9.22.dev1+20200520.120526.3f1e7ddd - Copyright 2020 SecureAuth Corporation\r\n\r\nERROR:root:\r\n---\r\n \r\nBut the previous version of Impacket didn't have this kind of issue.\r\n\r\n---\r\n# ntlmrelayx.py --help\r\nImpacket v0.9.22.dev1+20200428.191254.96c7a512 - Copyright 2020 SecureAuth Corporation\r\n\r\nusage: ntlmrelayx.py [-h] [-ts] [-debug] [-t TARGET] [-tf TARGETSFILE] [-w]\r\n                     [-i] [-ip INTERFACE_IP]\r\n                     [--no-smb-server | --no-http-server]\r\n[...snip...]\r\n---\r\n\r\nHas anyone is experiencing it as well?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/862", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/862/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/862/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/862/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/862", "id": 623095605, "node_id": "MDU6SXNzdWU2MjMwOTU2MDU=", "number": 862, "title": "ntlmrelayx.py: not working when clients block unauthenticated guest access", "user": {"login": "kcirtapw", "id": 865549, "node_id": "MDQ6VXNlcjg2NTU0OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/865549?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kcirtapw", "html_url": "https://github.com/kcirtapw", "followers_url": "https://api.github.com/users/kcirtapw/followers", "following_url": "https://api.github.com/users/kcirtapw/following{/other_user}", "gists_url": "https://api.github.com/users/kcirtapw/gists{/gist_id}", "starred_url": "https://api.github.com/users/kcirtapw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kcirtapw/subscriptions", "organizations_url": "https://api.github.com/users/kcirtapw/orgs", "repos_url": "https://api.github.com/users/kcirtapw/repos", "events_url": "https://api.github.com/users/kcirtapw/events{/privacy}", "received_events_url": "https://api.github.com/users/kcirtapw/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-22T09:57:18Z", "updated_at": "2020-06-10T19:28:43Z", "closed_at": "2020-06-10T19:28:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.9.22.dev1+20200428.191254.96c7a512\r\nPython version:  3.6.9\r\nTarget OS:  Windows 2016+ (10.0 Build 14393)\r\n\r\n### Debug Output With Command String  \r\n```\r\nntlmrelayx.py -t mssql://server123:4567 --no-http-server  -smb2support -debug\r\nImpacket v0.9.22.dev1+20200428.191254.96c7a512 - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: /home/me/impacket/venv/lib/python3.6/site-packages/impacket\r\n[*] Protocol Client SMTP loaded..\r\n[*] Protocol Client SMB loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client HTTPS loaded..\r\n[+] Protocol Attack LDAP loaded..\r\n[+] Protocol Attack LDAPS loaded..\r\n[+] Protocol Attack IMAP loaded..\r\n[+] Protocol Attack IMAPS loaded..\r\n[+] Protocol Attack SMB loaded..\r\n[+] Protocol Attack HTTP loaded..\r\n[+] Protocol Attack HTTPS loaded..\r\n[+] Protocol Attack MSSQL loaded..\r\n[*] Running in relay mode to single host\r\n[*] Setting up SMB Server\r\n\r\n[*] Servers started, waiting for connections\r\n```\r\n\r\nNothing happens then.\r\n\r\n### Additional context  \r\nClient side error message from a .NET application:\r\n\"System.IO.IOException: You can't access this shared folder because your organization's security policies block unauthenticated quest access. These polocies help protect your PC from unsafe or malicious devices on the network\"\r\n(Oh noes! These darn Hackers!!)\r\n\r\nOn impacket_0_9_20 this was working fine. Bysecting it, I  found that commit 955e88747fce6b125c075ffe993de6b6e6ee6ee1 introduced breaking changes.\r\n\r\nFrom what I understood, the way how incomming connections are handled was changed to support relaying to multiple targets at once. While this is impressive and overcomes a previously huge limitation from ntlmrelaying, it required the client to be authed to local with a guest session. Unfortunately, in situations where unauthed guest access is forbidden client-side, this prevents ntlmrelaying completely.\r\n\r\nI am not sure if the STATUS_NETWORK_SESSION_EXPIRED trick is usable on unauthenticated sessions and the feature could be improved to work under such scenarios. Otherwise, a cmdline flag to revert to the old behavior would be desirable.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/854", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/854/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/854/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/854/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/854", "id": 617120681, "node_id": "MDU6SXNzdWU2MTcxMjA2ODE=", "number": 854, "title": "rdp check raise\u3000\u3000no attribute 'NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY'", "user": {"login": "CptGuo", "id": 21232470, "node_id": "MDQ6VXNlcjIxMjMyNDcw", "avatar_url": "https://avatars1.githubusercontent.com/u/21232470?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CptGuo", "html_url": "https://github.com/CptGuo", "followers_url": "https://api.github.com/users/CptGuo/followers", "following_url": "https://api.github.com/users/CptGuo/following{/other_user}", "gists_url": "https://api.github.com/users/CptGuo/gists{/gist_id}", "starred_url": "https://api.github.com/users/CptGuo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CptGuo/subscriptions", "organizations_url": "https://api.github.com/users/CptGuo/orgs", "repos_url": "https://api.github.com/users/CptGuo/repos", "events_url": "https://api.github.com/users/CptGuo/events{/privacy}", "received_events_url": "https://api.github.com/users/CptGuo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-13T03:55:30Z", "updated_at": "2020-06-01T02:02:47Z", "closed_at": "2020-06-01T02:02:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  last\r\nPython version:  2.7\r\nTarget OS:  Windows 7\r\n\r\n### Debug Output With Command String  \r\nrdp_check.py\r\n```\r\n 'module' object has no attribute 'NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY'\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/853", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/853/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/853/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/853/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/853", "id": 615217180, "node_id": "MDU6SXNzdWU2MTUyMTcxODA=", "number": 853, "title": "bash: pip: command not found", "user": {"login": "Shiva20200", "id": 65028165, "node_id": "MDQ6VXNlcjY1MDI4MTY1", "avatar_url": "https://avatars0.githubusercontent.com/u/65028165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Shiva20200", "html_url": "https://github.com/Shiva20200", "followers_url": "https://api.github.com/users/Shiva20200/followers", "following_url": "https://api.github.com/users/Shiva20200/following{/other_user}", "gists_url": "https://api.github.com/users/Shiva20200/gists{/gist_id}", "starred_url": "https://api.github.com/users/Shiva20200/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Shiva20200/subscriptions", "organizations_url": "https://api.github.com/users/Shiva20200/orgs", "repos_url": "https://api.github.com/users/Shiva20200/repos", "events_url": "https://api.github.com/users/Shiva20200/events{/privacy}", "received_events_url": "https://api.github.com/users/Shiva20200/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-09T16:53:31Z", "updated_at": "2020-06-10T19:28:51Z", "closed_at": "2020-06-10T19:28:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "How do i fix this?\r\n![Kazam_screenshot_00001](https://user-images.githubusercontent.com/65028165/81479860-ba4d4b00-922e-11ea-9262-a973c9a67972.png)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/850", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/850/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/850/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/850/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/850", "id": 614441027, "node_id": "MDU6SXNzdWU2MTQ0NDEwMjc=", "number": 850, "title": "mssqlclient.py  -- Missing required parameter 'digestmod'", "user": {"login": "natv", "id": 1175232, "node_id": "MDQ6VXNlcjExNzUyMzI=", "avatar_url": "https://avatars3.githubusercontent.com/u/1175232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/natv", "html_url": "https://github.com/natv", "followers_url": "https://api.github.com/users/natv/followers", "following_url": "https://api.github.com/users/natv/following{/other_user}", "gists_url": "https://api.github.com/users/natv/gists{/gist_id}", "starred_url": "https://api.github.com/users/natv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/natv/subscriptions", "organizations_url": "https://api.github.com/users/natv/orgs", "repos_url": "https://api.github.com/users/natv/repos", "events_url": "https://api.github.com/users/natv/events{/privacy}", "received_events_url": "https://api.github.com/users/natv/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2020-05-08T01:26:31Z", "updated_at": "2020-06-30T13:06:33Z", "closed_at": "2020-05-11T15:56:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  impacket 0.9.21\r\nPython version:  tried in python3.7 and 3.8\r\nTarget OS:  Kali Linux 2020:\r\nLinux kali 5.5.0-kali2-amd64 #1 SMP Debian 5.5.17-1kali1 (2020-04-21) x86_64 GNU/Linux\r\n\r\n### Debug Output With Command String  \r\n\r\n\r\n$ sudo python3.8 mssqlclient.py -p 1433 sql_svc@10.10.10.27 -windows-auth\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n\r\nPassword:\r\n[*] Encryption required, switching to TLS\r\n[-] Missing required parameter 'digestmod'.\r\n\r\n\r\n\r\n\r\n$ sudo python3.7 mssqlclient.py -p 1433 sql_svc@10.10.10.27 -windows-auth\r\nTraceback (most recent call last):\r\n  File \"mssqlclient.py\", line 25, in <module>\r\n    from impacket import version, tds\r\n  File \"/usr/lib/python3/dist-packages/impacket/tds.py\", line 35, in <module>\r\n    from OpenSSL import SSL\r\n  File \"/usr/lib/python3/dist-packages/OpenSSL/__init__.py\", line 8, in <module>\r\n    from OpenSSL import crypto, SSL\r\n  File \"/usr/lib/python3/dist-packages/OpenSSL/crypto.py\", line 12, in <module>\r\n    from cryptography import x509\r\n  File \"/usr/lib/python3/dist-packages/cryptography/x509/__init__.py\", line 8, in <module>\r\n    from cryptography.x509.base import (\r\n  File \"/usr/lib/python3/dist-packages/cryptography/x509/base.py\", line 18, in <module>\r\n    from cryptography.x509.extensions import Extension, ExtensionType\r\n  File \"/usr/lib/python3/dist-packages/cryptography/x509/extensions.py\", line 20, in <module>\r\n    from cryptography.hazmat.primitives import constant_time, serialization\r\n  File \"/usr/lib/python3/dist-packages/cryptography/hazmat/primitives/constant_time.py\", line 11, in <module>\r\n    from cryptography.hazmat.bindings._constant_time import lib\r\nModuleNotFoundError: No module named '_cffi_backend'\r\n\r\n\r\n\r\n### Additional context  \r\n\r\nThis worked some time ago from this same system, so I suspect the latest Kali updates perhaps changed something.\r\n\r\nThanks\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/847", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/847/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/847/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/847/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/847", "id": 611344192, "node_id": "MDU6SXNzdWU2MTEzNDQxOTI=", "number": 847, "title": "how can i display mysql content using 2 for loops is flask jinja2", "user": {"login": "akashb12", "id": 62464624, "node_id": "MDQ6VXNlcjYyNDY0NjI0", "avatar_url": "https://avatars2.githubusercontent.com/u/62464624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akashb12", "html_url": "https://github.com/akashb12", "followers_url": "https://api.github.com/users/akashb12/followers", "following_url": "https://api.github.com/users/akashb12/following{/other_user}", "gists_url": "https://api.github.com/users/akashb12/gists{/gist_id}", "starred_url": "https://api.github.com/users/akashb12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akashb12/subscriptions", "organizations_url": "https://api.github.com/users/akashb12/orgs", "repos_url": "https://api.github.com/users/akashb12/repos", "events_url": "https://api.github.com/users/akashb12/events{/privacy}", "received_events_url": "https://api.github.com/users/akashb12/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-03T06:25:36Z", "updated_at": "2020-06-10T19:35:45Z", "closed_at": "2020-06-10T19:35:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have written a code in flask in which users are allowed to upload images and along with image they can ask questions\r\nfor taking user questions i have created a form and on submitting form user questions are stored into the database\r\nI am able to retrieve the question from database and images and diplay them in HTML using jinja2\r\nWhat I want is to display the image and below that display its comment\r\n\r\n```\r\nfrom flask import Flask,request,render_template,redirect,url_for,session,logging,flash,send_from_directory\r\nfrom flask_sqlalchemy import SQLAlchemy\r\nimport pymysql\r\npymysql.install_as_MySQLdb()\r\nfrom flask_mail import Mail\r\napp = Flask(__name__)\r\nimport os\r\n\r\napp.config['SQLALCHEMY_DATABASE_URI'] = 'mysql://root:@localhost/akashauto'\r\ndb = SQLAlchemy(app)    \r\nclass Upload_tb(db.Model):\r\n    snob = db.Column(db.Integer, primary_key=True)\r\n    commentb = db.Column(db.String(20), unique=True, nullable=False)\r\n    datab = db.Column(db.String(20), unique=True, nullable=False)\r\n\r\nAPP_ROOT=os.path.dirname(os.path.abspath(__file__))\r\n@app.route(\"/plcpro\")\r\ndef problem():\r\n    return  render_template(\"plcpro.html\")\r\n\r\n\r\n\r\n\r\n@app.route(\"/uploader\",methods=[\"GET\",\"POST\"])\r\ndef uploader():\r\n    target=os.path.join(APP_ROOT,\"images/\")\r\n    print(target)\r\n    if not os.path.isdir(target):  #if folder does not exist . create a folder\r\n        os.mkdir(target)\r\n    if(request.method=='POST'):\r\n        f=request.files['file1']\r\n        text=request.form.get('comment')\r\n        filename=f.filename\r\n        f.save(os.path.join(target,filename))\r\n        image=os.listdir('./images')\r\n        existing_entry=Upload_tb.query.filter_by(commentb=text).first()\r\n        if existing_entry:\r\n            # flash('Email already exist','danger')\r\n            return redirect(url_for(\"plcove\"))\r\n        new_entry=Upload_tb(commentb=text,datab=filename)\r\n        db.session.add(new_entry)\r\n        db.session.commit()\r\n        question=Upload_tb.query.all()\r\n    return render_template('ans.html',file=filename,text=text,image=image,question=question)\r\n@app.route(\"/uploader/<filename>\")\r\ndef send_img(filename):\r\n    return send_from_directory(\"images\",filename)\r\n\r\n```\r\nThis is the Form code\r\n\r\n```\r\n      <form id=\"upload-form\" action=\"/uploader\" method=\"POST\" enctype=\"multipart/form-data\" onsubmit=\" return askvalidateform()\">\r\n        <div class=\"form-group\">\r\n            <label for=\"name\">Enter Name:</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"name\" name=\"name\" placeholder=\"Enter your name\">\r\n            <span id=\"nameerror\" class=\"text-danger\"></span>\r\n          </div>\r\n         \r\n          <div class=\"form-group\">\r\n            <label for=\"comment\">Ask Your Question: </label>\r\n            <textarea rows=\"5\" cols=\"30\" class=\"form-control \" id=\"comment\" name=\"comment\"\r\n              placeholder=\"Ask Question\"></textarea>\r\n            <span id=\"commenterror\" class=\"text-danger\"></span>\r\n          </div>\r\n        <input type=\"file\" name=\"file1\" accept=\"image/\" multiple>\r\n        <input type=\"submit\" value=\"send\">\r\n        </form>\r\n```\r\ndisplay code\r\n```\r\n  {% for image_name in image %}\r\n             <li class=\"list\"><img src=\"{{url_for('send_img',filename=image_name)}}\"></li>\r\n{%endfor%}\r\n<p class=\"para\">{% for user in question %}</p>\r\n             <li class=\"list\">Comment - {{user.commentb}}</li>\r\n              \r\n{% endfor %}\r\n```\r\nThe output i am getting is\r\n[enter image description here][1]\r\n\r\n1st images are displayed and then comments what i want to display is image and its comment together so can i do some changes in for loop?Any help will be appriciated\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/OFqRP.png", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/845", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/845/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/845/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/845/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/845", "id": 609800906, "node_id": "MDU6SXNzdWU2MDk4MDA5MDY=", "number": 845, "title": "wmiexec.py cannot execute command on remote host", "user": {"login": "v1c5anchez", "id": 56432864, "node_id": "MDQ6VXNlcjU2NDMyODY0", "avatar_url": "https://avatars3.githubusercontent.com/u/56432864?v=4", "gravatar_id": "", "url": "https://api.github.com/users/v1c5anchez", "html_url": "https://github.com/v1c5anchez", "followers_url": "https://api.github.com/users/v1c5anchez/followers", "following_url": "https://api.github.com/users/v1c5anchez/following{/other_user}", "gists_url": "https://api.github.com/users/v1c5anchez/gists{/gist_id}", "starred_url": "https://api.github.com/users/v1c5anchez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/v1c5anchez/subscriptions", "organizations_url": "https://api.github.com/users/v1c5anchez/orgs", "repos_url": "https://api.github.com/users/v1c5anchez/repos", "events_url": "https://api.github.com/users/v1c5anchez/events{/privacy}", "received_events_url": "https://api.github.com/users/v1c5anchez/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-30T10:29:56Z", "updated_at": "2020-05-05T07:42:01Z", "closed_at": "2020-05-05T07:42:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  **0.9.22.dev1+20200428.191254.96c7a512**\r\nPython version:  **3.7.4**\r\nTarget OS:  **Windows 10 Enterprise (64 bits)**\r\n\r\n### Debug Output With Command String  \r\n\r\n```\r\n$ python3 examples/wmiexec.py user:12345@10.0.2.5 \"product get name,version\" -debug\r\nImpacket v0.9.22.dev1+20200428.191254.96c7a512 - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: /home/myuser/fuente/impacket/env/lib/python3.7/site-packages/impacket\r\n[*] SMBv3.0 dialect used\r\n[+] Target system is 10.0.2.5 and isFDQN is False\r\n[+] StringBinding: \\\\\\\\WINDEV1907EVAL[\\\\PIPE\\\\atsvc]\r\n[+] StringBinding: WinDev1907Eval[49667]\r\n[+] StringBinding: 10.0.2.5[49667]\r\n[+] StringBinding chosen: ncacn_ip_tcp:10.0.2.5[49667]\r\nTraceback (most recent call last):\r\n  File \"examples/wmiexec.py\", line 87, in run\r\n    iWbemServices= iWbemLevel1Login.NTLMLogin('//./root/cimv2', NULL, NULL)\r\n  File \"/home/myuser/fuente/impacket/env/lib/python3.7/site-packages/impacket/dcerpc/v5/dcom/wmi.py\", line 3165, in NTLMLogin\r\n    resp = self.request(request, iid = self._iid, uuid = self.get_iPid())\r\n  File \"/home/myuser/fuente/impacket/env/lib/python3.7/site-packages/impacket/dcerpc/v5/dcomrt.py\", line 1315, in request\r\n    resp = dce.request(req, uuid)\r\n  File \"/home/myuser/fuente/impacket/env/lib/python3.7/site-packages/impacket/dcerpc/v5/rpcrt.py\", line 878, in request\r\n    raise exception\r\nimpacket.dcerpc.v5.dcom.wmi.DCERPCSessionError: WMI Session Error: code: 0x80041003 - WBEM_E_ACCESS_DENIED\r\n[-] WMI Session Error: code: 0x80041003 - WBEM_E_ACCESS_DENIED\r\n```\r\n\r\n\r\n### Additional context  \r\nI am currently trying to retrieve the list of installed software in a remote Windows 10 machine.\r\n\r\nI am also using VirtualBox, where:\r\nHost: **Arch Linux**\r\nGuest: **Windows 10**\r\n\r\nFor some unknown reason, the query successfully identifies the hostname **WINDEV1907EVAL** (the machine is _visible_), but it raises the WBEM_E_ACCESS_DENIED error code.\r\n\r\nMaybe is it related with some service not running in the Windows box?\r\n\r\nI appreciate your help.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/844", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/844/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/844/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/844/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/844", "id": 609515927, "node_id": "MDU6SXNzdWU2MDk1MTU5Mjc=", "number": 844, "title": "ImportError: No module named server", "user": {"login": "samuelkneppel", "id": 22039017, "node_id": "MDQ6VXNlcjIyMDM5MDE3", "avatar_url": "https://avatars1.githubusercontent.com/u/22039017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samuelkneppel", "html_url": "https://github.com/samuelkneppel", "followers_url": "https://api.github.com/users/samuelkneppel/followers", "following_url": "https://api.github.com/users/samuelkneppel/following{/other_user}", "gists_url": "https://api.github.com/users/samuelkneppel/gists{/gist_id}", "starred_url": "https://api.github.com/users/samuelkneppel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samuelkneppel/subscriptions", "organizations_url": "https://api.github.com/users/samuelkneppel/orgs", "repos_url": "https://api.github.com/users/samuelkneppel/repos", "events_url": "https://api.github.com/users/samuelkneppel/events{/privacy}", "received_events_url": "https://api.github.com/users/samuelkneppel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-30T02:28:11Z", "updated_at": "2020-04-30T12:43:17Z", "closed_at": "2020-04-30T12:43:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "OS Version:\r\n```\r\nvlgngrbrdmn@kali:~$ uname -a`\r\nLinux kali 5.5.0-kali2-amd64 #1 SMP Debian 5.5.17-1kali1 (2020-04-21) x86_64 GNU/Linux\r\n```\r\n\r\nInstall method:\r\n`vlgngrbrdmn@kali:~$ sudo apt install crackmapexec`\r\n\r\nIssue:\r\nI receive the following error when I run `crackmapexec`:\r\n```\r\nvlgngrbrdmn@kali:~$ crackmapexec \r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/crackmapexec\", line 11, in <module>\r\n    load_entry_point('crackmapexec==5.0.1.dev0', 'console_scripts', 'crackmapexec')()\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 489, in load_entry_point\r\n    return get_distribution(dist).load_entry_point(group, name)\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 2852, in load_entry_point\r\n    return ep.load()\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 2443, in load\r\n    return self.resolve()\r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 2449, in resolve\r\n    module = __import__(self.module_name, fromlist=['__name__'], level=0)\r\n  File \"/usr/local/lib/python2.7/dist-packages/crackmapexec-5.0.1.dev0-py2.7.egg/cme/crackmapexec.py\", line 14, in <module>\r\n    from cme.servers.http import CMEServer\r\n  File \"/usr/local/lib/python2.7/dist-packages/gevent-20.4.0-py2.7-linux-x86_64.egg/gevent/builtins.py\", line 96, in __import__\r\n    result = _import(*args, **kwargs)\r\n  File \"/usr/local/lib/python2.7/dist-packages/crackmapexec-5.0.1.dev0-py2.7.egg/cme/servers/http.py\", line 1, in <module>\r\n    import http.server\r\n  File \"/usr/local/lib/python2.7/dist-packages/gevent-20.4.0-py2.7-linux-x86_64.egg/gevent/builtins.py\", line 96, in __import__\r\n    result = _import(*args, **kwargs)\r\nImportError: No module named server\r\n```\r\n\r\nTroubleshooting steps taken so far:\r\n\r\n- Uninstalled via `apt`, rebooted, and installed via `apt` again\r\n- Tried manually installing but ran into some issues with setting up `pipenv`; reverted changes\r\n\r\nHas anyone seen this error before? Any help would be much appreciated!\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/837", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/837/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/837/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/837/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/837", "id": 607007852, "node_id": "MDU6SXNzdWU2MDcwMDc4NTI=", "number": 837, "title": "SMB auth: ACCESS_DENIED on second authentication using same host with SMB signing enabled", "user": {"login": "mpgn", "id": 5891788, "node_id": "MDQ6VXNlcjU4OTE3ODg=", "avatar_url": "https://avatars2.githubusercontent.com/u/5891788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpgn", "html_url": "https://github.com/mpgn", "followers_url": "https://api.github.com/users/mpgn/followers", "following_url": "https://api.github.com/users/mpgn/following{/other_user}", "gists_url": "https://api.github.com/users/mpgn/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpgn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpgn/subscriptions", "organizations_url": "https://api.github.com/users/mpgn/orgs", "repos_url": "https://api.github.com/users/mpgn/repos", "events_url": "https://api.github.com/users/mpgn/events{/privacy}", "received_events_url": "https://api.github.com/users/mpgn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-26T13:04:03Z", "updated_at": "2020-06-10T19:45:25Z", "closed_at": "2020-06-10T19:45:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.22\r\nPython version:  3.7/3.8\r\nTarget OS:  Windows 10/2016 with SMB signing enabled\r\n\r\nWe have an issue on Crackmapexec when we try multiple connections on the same host when SMB signing is enabled (Required). All auth after the first one  failed with an ACCESS_DENIED.\r\n\r\nhttps://github.com/byt3bl33d3r/CrackMapExec/issues/321\r\n\r\n### Debug Output With Command String  \r\n\r\nRunning two authentications on the same host failed with SMB signing enabled, PoC with the following Python code\r\n```python\r\nfrom impacket.smbconnection import SMBConnection, SessionError\r\n\r\nhost_smb_signing_disabled = '192.168.255.135'\r\nhost_smb_signing_enabled = '192.168.255.131'\r\n\r\ndef auth(ip):\r\n    try:\r\n        conn.login('administrator', 'Password@123', 'GOLD.LOCAL')\r\n        print('[+] AUTH OK', ip)\r\n    except SessionError as e:\r\n        error, desc = e.getErrorString()\r\n        print(\"[-] AUTH NOK\", ip, \"with error\", error)\r\n\r\n\r\nconn = SMBConnection(host_smb_signing_enabled, host_smb_signing_enabled, None, 445)\r\nif conn.isSigningRequired():\r\n    print(\"SMB SIGNING ENABLED: SECOND AUTH FAILED\")\r\n    auth(host_smb_signing_enabled)\r\n    auth(host_smb_signing_enabled)\r\n\r\nprint('')\r\nconn = SMBConnection(host_smb_signing_disabled, host_smb_signing_disabled, None, 445)\r\nif conn.isSigningRequired() == False:\r\n    print(\"SMB SIGNING DISABLED: SECOND AUTH OK\")\r\n    auth(host_smb_signing_disabled)\r\n    auth(host_smb_signing_disabled)\r\n```\r\n\r\nResult:\r\n\r\n```ruby\r\nbonclay@kali:~/impacket$ python3 /tmp/demo.py \r\nSMB SIGNING ENABLED: SECOND AUTH FAILED\r\n[+] AUTH OK 192.168.255.131\r\n[-] AUTH NOK 192.168.255.131 with error STATUS_ACCESS_DENIED\r\n\r\nSMB SIGNING DISABLED: SECOND AUTH OK\r\n[+] AUTH OK 192.168.255.131\r\n[+] AUTH OK 192.168.255.131\r\n```\r\n\r\n## Additional infos\r\n\r\nStarting point (and probably related to SMBsign function)\r\nhttps://github.com/SecureAuthCorp/impacket/blob/f2546a0bc54e9df11b3a7f225af069125218d359/impacket/smb.py#L3231", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/836", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/836/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/836/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/836/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/836", "id": 606798533, "node_id": "MDU6SXNzdWU2MDY3OTg1MzM=", "number": 836, "title": "'HTTPMessage' object has no attribute 'getheader'", "user": {"login": "mpgn", "id": 5891788, "node_id": "MDQ6VXNlcjU4OTE3ODg=", "avatar_url": "https://avatars2.githubusercontent.com/u/5891788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpgn", "html_url": "https://github.com/mpgn", "followers_url": "https://api.github.com/users/mpgn/followers", "following_url": "https://api.github.com/users/mpgn/following{/other_user}", "gists_url": "https://api.github.com/users/mpgn/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpgn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpgn/subscriptions", "organizations_url": "https://api.github.com/users/mpgn/orgs", "repos_url": "https://api.github.com/users/mpgn/repos", "events_url": "https://api.github.com/users/mpgn/events{/privacy}", "received_events_url": "https://api.github.com/users/mpgn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-25T15:53:18Z", "updated_at": "2020-05-18T12:20:39Z", "closed_at": "2020-05-18T12:20:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  Impacket v0.9.22.dev1+20200424.150528.c44901d1\r\nPython version:  3.8\r\nTarget OS:  Windows\r\n\r\n### Debug Output With Command String  \r\n\r\n```\r\nsudo ntlmrelayx.py -smb2support -t smb://192.168.255.131  -debug\r\n\r\n[*] HTTPD: Received connection from 192.168.255.135, attacking target smb://192.168.255.131\r\n[+] Exception:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 75, in handle_one_request\r\n    http.server.SimpleHTTPRequestHandler.handle_one_request(self)\r\n  File \"/usr/lib/python3.8/http/server.py\", line 415, in handle_one_request\r\n    method()\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 143, in do_PROPFIND\r\n    if self.headers.getheader('Authorization') is None:\r\nAttributeError: 'HTTPMessage' object has no attribute 'getheader'\r\n\r\n```\r\n\r\n### Additional context  \r\n\r\nIn python3, `getheader()` should be `get()`\r\n\r\nFix should be something like this for example with this code https://github.com/SecureAuthCorp/impacket/blob/master/impacket/examples/ntlmrelayx/servers/httprelayserver.py#L143\r\n\r\n```diff\r\n--- a/impacket/examples/ntlmrelayx/servers/httprelayserver.py\r\n+++ b/impacket/examples/ntlmrelayx/servers/httprelayserver.py\r\n@@ -140,11 +140,15 @@ class HTTPRelayServer(Thread):\r\n \r\n             messageType = 0\r\n-            if self.headers.getheader('Authorization') is None:\r\n+            if hasattr(self.headers, 'getheader'):\r\n+                header = self.headers.getheader('Authorization')\r\n+            else:\r\n+                header = self.headers.get('Authorization')\r\n+            if header is None:\r\n                 self.do_AUTHHEAD(message='NTLM')\r\n                 pass\r\n             else:\r\n-                typeX = self.headers.getheader('Authorization')\r\n+                typeX = header\r\n                 try:\r\n                     _, blob = typeX.split('NTLM')\r\n                     token = base64.b64decode(blob.strip())\r\n```\r\n\r\nIt's not very elegant but the only solution to keep python2 and python3 version.\r\n\r\nThere are multiple files that use `getheader()` so this is not just one file to patch. If you want PR, I will submit one.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/834", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/834/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/834/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/834/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/834", "id": 606476763, "node_id": "MDU6SXNzdWU2MDY0NzY3NjM=", "number": 834, "title": "No any output file after -i and -of command", "user": {"login": "rejon77", "id": 49464878, "node_id": "MDQ6VXNlcjQ5NDY0ODc4", "avatar_url": "https://avatars2.githubusercontent.com/u/49464878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rejon77", "html_url": "https://github.com/rejon77", "followers_url": "https://api.github.com/users/rejon77/followers", "following_url": "https://api.github.com/users/rejon77/following{/other_user}", "gists_url": "https://api.github.com/users/rejon77/gists{/gist_id}", "starred_url": "https://api.github.com/users/rejon77/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rejon77/subscriptions", "organizations_url": "https://api.github.com/users/rejon77/orgs", "repos_url": "https://api.github.com/users/rejon77/repos", "events_url": "https://api.github.com/users/rejon77/events{/privacy}", "received_events_url": "https://api.github.com/users/rejon77/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-24T17:39:11Z", "updated_at": "2020-06-10T19:46:59Z", "closed_at": "2020-06-10T19:46:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "i haven't seen any output file after i ran -i and -of command\r\nImpacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation\r\n\r\nkali@kali:~/impacket$ sudo ntlmrelayx.py -t ldaps://example.com -wh attacker-wpad --delegate-access -l /home/kali/tmp/New.txt\r\n\r\nkali@kali:~/impacket$ sudo ntlmrelayx.py -t ldaps://example.com -wh attacker-wpad --delegate-access -of /home/kali/tmp/New.txt\r\n\r\nsudo ntlmrelayx.py -smb2support -t 192.168.* ** --output-file /tmp/testtt\r\n\r\n\r\nkali@kali:~/impacket$ sudo ntlmrelayx.py -t ldaps://example.com -wh attacker-wpad -of /home/kali/tmp/New.txt --delegate-access\r\n\r\nkali@kali:~/impacket$ sudo ntlmrelayx.py -t ldaps://example.com -wh attacker-wpad -l /home/kali/tmp/New.txt --delegate-access", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/831", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/831/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/831/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/831/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/831", "id": 604888527, "node_id": "MDU6SXNzdWU2MDQ4ODg1Mjc=", "number": 831, "title": "Where i can find ntlmrelax last ran stored logs files  ", "user": {"login": "rejon77", "id": 49464878, "node_id": "MDQ6VXNlcjQ5NDY0ODc4", "avatar_url": "https://avatars2.githubusercontent.com/u/49464878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rejon77", "html_url": "https://github.com/rejon77", "followers_url": "https://api.github.com/users/rejon77/followers", "following_url": "https://api.github.com/users/rejon77/following{/other_user}", "gists_url": "https://api.github.com/users/rejon77/gists{/gist_id}", "starred_url": "https://api.github.com/users/rejon77/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rejon77/subscriptions", "organizations_url": "https://api.github.com/users/rejon77/orgs", "repos_url": "https://api.github.com/users/rejon77/repos", "events_url": "https://api.github.com/users/rejon77/events{/privacy}", "received_events_url": "https://api.github.com/users/rejon77/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-22T16:21:41Z", "updated_at": "2020-04-22T19:14:27Z", "closed_at": "2020-04-22T17:52:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "Can some one help me where can i find the last log files or db for ntlmrelax in impacket.\r\nI ran like this; \r\nkali@***:~/impacket$ sudo ntlmrelayx.py -t ldaps://example.com --add-computer\r\n\r\n[*] HTTPD: Client requested path: http://*****************/configuration/getagentserverinfo\r\n[*] HTTPD: Received connection from 10.1.**.**, but there are no more targets left!\r\n[*] HTTPD: Received connection from 10.1.**.**, attacking target ldaps://example.com\r\n\r\nSo, where i can find this log stored?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/829", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/829/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/829/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/829/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/829", "id": 604045954, "node_id": "MDU6SXNzdWU2MDQwNDU5NTQ=", "number": 829, "title": "Connection failed: Unable to fetch correct smb version for 2019 Windows Datacenter RODC", "user": {"login": "aniket-prajapati", "id": 46114123, "node_id": "MDQ6VXNlcjQ2MTE0MTIz", "avatar_url": "https://avatars0.githubusercontent.com/u/46114123?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aniket-prajapati", "html_url": "https://github.com/aniket-prajapati", "followers_url": "https://api.github.com/users/aniket-prajapati/followers", "following_url": "https://api.github.com/users/aniket-prajapati/following{/other_user}", "gists_url": "https://api.github.com/users/aniket-prajapati/gists{/gist_id}", "starred_url": "https://api.github.com/users/aniket-prajapati/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aniket-prajapati/subscriptions", "organizations_url": "https://api.github.com/users/aniket-prajapati/orgs", "repos_url": "https://api.github.com/users/aniket-prajapati/repos", "events_url": "https://api.github.com/users/aniket-prajapati/events{/privacy}", "received_events_url": "https://api.github.com/users/aniket-prajapati/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-04-21T14:31:38Z", "updated_at": "2020-04-27T07:07:13Z", "closed_at": "2020-04-27T07:07:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.14\r\nPython version:  2.7.6\r\nTarget OS:  Windows Datacenter 2019 RODC\r\n\r\n### Debug Output With Command String  \r\ni.e.  \r\nWMIEXEC(\"systeminfo\", username, password, domain, None, None, 'ADMIN$', False, False).run(ip)\r\n```\r\n/opt/meridian/dc/embedded/lib/python2.7/site-packages/cryptography/hazmat/primitives/constant_time.py:26: CryptographyDeprecationWarning: Support for your Python version is deprecated. The next version of cryptography will remove support. Please upgrade to a release (2.7.7+) that supports hmac.compare_digest as soon as possible.\r\n  utils.PersistentlyDeprecated2018,\r\nTraceback (most recent call last):\r\n  File \"wmitest.py\", line 3, in <module>\r\n    executer.run('192.168.1.1')\r\n  File \"/opt/meridian/dc/embedded/lib/python2.7/site-packages/meridian_connectors/windows/wmiexec.py\", line 68, in run\r\n    smbConnection.login(self.__username, self.__password, self.__domain, self.__lmhash, self.__nthash)\r\n  File \"/opt/meridian/dc/embedded/lib/python2.7/site-packages/impacket/smbconnection.py\", line 215, in login\r\n    raise SessionError(e.get_error_code())\r\nimpacket.smbconnection.SessionError: SMB SessionError: STATUS_USER_SESSION_DELETED(The remote user session has been deleted.)\r\n```\r\n\r\n### Additional context  \r\nAbove execution failed, as it somehow fetched wrong smb version, i.e, smb3.0 and tried to connect, hence SMB SessionError: STATUS_USER_SESSION_DELETED(The remote user session has been deleted.)\r\nWhile, remote server is configured to accept smb2.1 connections, not smb3.0\r\nWe checked by running this commands:\r\nfrom impacket.smbconnection import *\r\nUSERNAME = 'Administrator'\r\nPASSWORD = 'admin'\r\nTARGET = '192.168.1.1'\r\ns2 = SMBConnection(TARGET, TARGET, preferredDialect=SMB2_DIALECT_21)\r\ns2.login(USERNAME, PASSWORD)\r\nprint \"ALL GOOD\"\r\n\r\nOutput of above script was success and it did connect with SMB2.1 Dialect, while it failed when trying to connect via WMIEXEC class.\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/826", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/826/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/826/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/826/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/826", "id": 600917609, "node_id": "MDU6SXNzdWU2MDA5MTc2MDk=", "number": 826, "title": "Jinja2>2.10.1 distribution not found and is required by flask", "user": {"login": "chrismetz", "id": 16770430, "node_id": "MDQ6VXNlcjE2NzcwNDMw", "avatar_url": "https://avatars1.githubusercontent.com/u/16770430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrismetz", "html_url": "https://github.com/chrismetz", "followers_url": "https://api.github.com/users/chrismetz/followers", "following_url": "https://api.github.com/users/chrismetz/following{/other_user}", "gists_url": "https://api.github.com/users/chrismetz/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrismetz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrismetz/subscriptions", "organizations_url": "https://api.github.com/users/chrismetz/orgs", "repos_url": "https://api.github.com/users/chrismetz/repos", "events_url": "https://api.github.com/users/chrismetz/events{/privacy}", "received_events_url": "https://api.github.com/users/chrismetz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-04-16T10:11:49Z", "updated_at": "2020-06-10T19:51:50Z", "closed_at": "2020-06-10T19:51:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.22\r\nPython version:  2.7\r\nTarget OS:  Kali 2020.2\r\n\r\n### Debug Output With Command String\r\nTraceback (most recent call last):                                                                                                                                                                               \r\n  File \"/usr/local/bin/psexec.py\", line 4, in <module>                                                                                                                                                           \r\n    __import__('pkg_resources').run_script('impacket==0.9.22.dev1+20200327.103853.7e505892', 'psexec.py')                                                                                                        \r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 3251, in <module>                                                                                                                      \r\n    @_call_aside                                                                                                                                                                                                 \r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 3235, in _call_aside                                                                                                                   \r\n    f(*args, **kwargs)                                                                                                                                                                                           \r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 3264, in _initialize_master_working_set                                                                                                \r\n    working_set = WorkingSet._build_master()                                                                                                                                                                     \r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 583, in _build_master                                                                                                                  \r\n    ws.require(__requires__)                                                                                                                                                                                     \r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 900, in require                                                                                                                        \r\n    needed = self.resolve(parse_requirements(requirements))                                                                                                                                                      \r\n  File \"/usr/lib/python2.7/dist-packages/pkg_resources/__init__.py\", line 786, in resolve                                                                                                                        \r\n    raise DistributionNotFound(req, requirers)                                                                                                                                                                   \r\npkg_resources.DistributionNotFound: The 'Jinja2>=2.10.1' distribution was not found and is required by flask\r\n\r\n### Additional context  \r\ninstalled python-pip-whl version 20.0.2-4 as python-pip not available in kali package repository\r\ninstalled python3-pip\r\nran pip3 install . from git repo root directory and impacket installed correctly\r\nwhen running psexec.py I get the above error\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/825", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/825/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/825/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/825/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/825", "id": 600698883, "node_id": "MDU6SXNzdWU2MDA2OTg4ODM=", "number": 825, "title": "Module not found  !! impacket.krb5.keytab", "user": {"login": "Rajchowdhury420", "id": 30806882, "node_id": "MDQ6VXNlcjMwODA2ODgy", "avatar_url": "https://avatars1.githubusercontent.com/u/30806882?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rajchowdhury420", "html_url": "https://github.com/Rajchowdhury420", "followers_url": "https://api.github.com/users/Rajchowdhury420/followers", "following_url": "https://api.github.com/users/Rajchowdhury420/following{/other_user}", "gists_url": "https://api.github.com/users/Rajchowdhury420/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rajchowdhury420/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rajchowdhury420/subscriptions", "organizations_url": "https://api.github.com/users/Rajchowdhury420/orgs", "repos_url": "https://api.github.com/users/Rajchowdhury420/repos", "events_url": "https://api.github.com/users/Rajchowdhury420/events{/privacy}", "received_events_url": "https://api.github.com/users/Rajchowdhury420/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-16T02:20:32Z", "updated_at": "2020-04-16T06:30:24Z", "closed_at": "2020-04-16T02:34:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "not working as pip install too !", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/821", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/821/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/821/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/821/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/821", "id": 599372232, "node_id": "MDU6SXNzdWU1OTkzNzIyMzI=", "number": 821, "title": "ntlmrelayx : LDAP bind error with COMPUTER account", "user": {"login": "mpgn", "id": 5891788, "node_id": "MDQ6VXNlcjU4OTE3ODg=", "avatar_url": "https://avatars2.githubusercontent.com/u/5891788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpgn", "html_url": "https://github.com/mpgn", "followers_url": "https://api.github.com/users/mpgn/followers", "following_url": "https://api.github.com/users/mpgn/following{/other_user}", "gists_url": "https://api.github.com/users/mpgn/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpgn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpgn/subscriptions", "organizations_url": "https://api.github.com/users/mpgn/orgs", "repos_url": "https://api.github.com/users/mpgn/repos", "events_url": "https://api.github.com/users/mpgn/events{/privacy}", "received_events_url": "https://api.github.com/users/mpgn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-14T07:57:21Z", "updated_at": "2020-04-25T10:10:52Z", "closed_at": "2020-04-14T13:32:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When using an COMPUTER account to relay credentials, for example with the printerbug, there is an error with the LDAP bind.\r\n\r\nSame problem as #686 but the initial problem is not correct since it's not related to remove-mic option\r\n\r\n### Configuration  \r\nimpacket version:  \r\n- Impacket v0.9.22.dev1+20200327.103853.7e505892 \r\n- Impacket v0.9.21\r\n\r\nPython version:  3.8\r\nTarget OS:  Kali\r\n\r\n### Debug Output With Command String  \r\n\r\n```\r\nbonclay@kali:~/impacket$ sudo ntlmrelayx.py -t ldaps://192.168.255.131 --delegate-access -debug --remove-mic -smb2support\r\nImpacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: /usr/local/lib/python3.8/dist-packages/impacket\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client HTTPS loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client SMTP loaded..\r\n[*] Protocol Client SMB loaded..\r\n[+] Protocol Attack HTTP loaded..\r\n[+] Protocol Attack HTTPS loaded..\r\n[+] Protocol Attack MSSQL loaded..\r\n[+] Protocol Attack LDAP loaded..\r\n[+] Protocol Attack LDAPS loaded..\r\n[+] Protocol Attack IMAP loaded..\r\n[+] Protocol Attack IMAPS loaded..\r\n[+] Protocol Attack SMB loaded..\r\n[*] Running in relay mode to single host\r\n[*] Setting up SMB Server\r\n[*] Setting up HTTP Server\r\n\r\n[*] Servers started, waiting for connections\r\n[*] SMBD-Thread-3: Connection from GOLD/ZORO$@192.168.255.132 controlled, attacking target ldaps://192.168.255.131\r\n[*] Authenticating against ldaps://192.168.255.131 as GOLD/ZORO$ SUCCEED\r\n[*] Enumerating relayed user's privileges. This may take a while on large domains\r\n[*] SMBD-Thread-3: Connection from GOLD/ZORO$@192.168.255.132 controlled, but there are no more targets left!\r\n[+] User is a member of: []\r\nException in thread Thread-4:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.8/threading.py\", line 932, in _bootstrap_inner\r\n    self.run()\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 564, in run\r\n    userSid, privs = self.validatePrivileges(self.username, domainDumper)\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 386, in validatePrivileges\r\n    self.client.search(domainDumper.root, '(objectClass=domain)', attributes=['objectSid'])\r\n  File \"/usr/lib/python3/dist-packages/ldap3/core/connection.py\", line 782, in search\r\n    response = self.post_send_search(self.send('searchRequest', request, controls))\r\n  File \"/usr/lib/python3/dist-packages/ldap3/strategy/base.py\", line 289, in send\r\n    raise LDAPSASLBindInProgressError(self.connection.last_error)\r\nldap3.core.exceptions.LDAPSASLBindInProgressError: cannot send operation requests while SASL bind is in progress\r\n^Cbonclay@kali:~/impacket$ sudo ntlmrelayx.py -t ldap://192.168.255.131 --escalate-user ntu -debug --remove-mic -smb2support\r\nImpacket v0.9.22.dev1+20200327.103853.7e505892 - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: /usr/local/lib/python3.8/dist-packages/impacket\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client HTTPS loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client SMTP loaded..\r\n[*] Protocol Client SMB loaded..\r\n[+] Protocol Attack HTTP loaded..\r\n[+] Protocol Attack HTTPS loaded..\r\n[+] Protocol Attack MSSQL loaded..\r\n[+] Protocol Attack LDAP loaded..\r\n[+] Protocol Attack LDAPS loaded..\r\n[+] Protocol Attack IMAP loaded..\r\n[+] Protocol Attack IMAPS loaded..\r\n[+] Protocol Attack SMB loaded..\r\n[*] Running in relay mode to single host\r\n[*] Setting up SMB Server\r\n[*] Setting up HTTP Server\r\n\r\n[*] Servers started, waiting for connections\r\n[*] SMBD-Thread-3: Connection from GOLD/ZORO$@192.168.255.132 controlled, attacking target ldap://192.168.255.131\r\n[*] Authenticating against ldap://192.168.255.131 as GOLD/ZORO$ SUCCEED\r\n[*] Enumerating relayed user's privileges. This may take a while on large domains\r\n[*] SMBD-Thread-3: Connection from GOLD/ZORO$@192.168.255.132 controlled, but there are no more targets left!\r\n[+] User is a member of: []\r\nException in thread Thread-4:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.8/threading.py\", line 932, in _bootstrap_inner\r\n    self.run()\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 564, in run\r\n    userSid, privs = self.validatePrivileges(self.username, domainDumper)\r\n  File \"/usr/local/lib/python3.8/dist-packages/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 386, in validatePrivileges\r\n    self.client.search(domainDumper.root, '(objectClass=domain)', attributes=['objectSid'])\r\n  File \"/usr/lib/python3/dist-packages/ldap3/core/connection.py\", line 782, in search\r\n    response = self.post_send_search(self.send('searchRequest', request, controls))\r\n  File \"/usr/lib/python3/dist-packages/ldap3/strategy/base.py\", line 289, in send\r\n    raise LDAPSASLBindInProgressError(self.connection.last_error)\r\nldap3.core.exceptions.LDAPSASLBindInProgressError: cannot send operation requests while SASL bind is in progress\r\n^Cbonclay@kali:~/impacket$ \r\n```\r\n\r\n### PCAP  \r\n\r\n![image](https://user-images.githubusercontent.com/5891788/79199816-cd3e4c80-7e35-11ea-800e-0a93fee9f4c4.png)\r\n\r\nA second authentification with user '' is also use in ntlmrelayx which cause the LDAP bind error\r\n\r\n![image](https://user-images.githubusercontent.com/5891788/79199791-c6173e80-7e35-11ea-83f8-0a0ac5a07aba.png)\r\n\r\n\r\n### Additional context  \r\n\r\nWith a user account, no bind error since only one bind is done\r\n\r\n![image](https://user-images.githubusercontent.com/5891788/79200028-1ee6d700-7e36-11ea-8cf0-837f56139d2e.png)\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/820", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/820/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/820/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/820/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/820", "id": 599215533, "node_id": "MDU6SXNzdWU1OTkyMTU1MzM=", "number": 820, "title": "cant run ntlmrelayx.py ", "user": {"login": "bryanweielio", "id": 54826294, "node_id": "MDQ6VXNlcjU0ODI2Mjk0", "avatar_url": "https://avatars2.githubusercontent.com/u/54826294?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bryanweielio", "html_url": "https://github.com/bryanweielio", "followers_url": "https://api.github.com/users/bryanweielio/followers", "following_url": "https://api.github.com/users/bryanweielio/following{/other_user}", "gists_url": "https://api.github.com/users/bryanweielio/gists{/gist_id}", "starred_url": "https://api.github.com/users/bryanweielio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bryanweielio/subscriptions", "organizations_url": "https://api.github.com/users/bryanweielio/orgs", "repos_url": "https://api.github.com/users/bryanweielio/repos", "events_url": "https://api.github.com/users/bryanweielio/events{/privacy}", "received_events_url": "https://api.github.com/users/bryanweielio/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-04-14T00:30:31Z", "updated_at": "2020-04-16T18:37:37Z", "closed_at": "2020-04-16T18:37:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "here's the output if i run ntlmrelayx.py with python 2.7 \r\n\r\nTraceback (most recent call last):\r\n  File \"ntlmrelayx.py\", line 321, in <module>\r\n    from impacket.examples.ntlmrelayx.clients import PROTOCOL_CLIENTS\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket/examples/ntlmrelayx/clients/__init__.py\", line 106, in <module>\r\n    __import__(package + '.' + os.path.splitext(file)[0])\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket/examples/ntlmrelayx/clients/ldaprelayclient.py\", line 22, in <module>\r\n    from ldap3 import Server, Connection, ALL, NTLM, MODIFY_ADD\r\n  File \"/usr/local/lib/python2.7/dist-packages/ldap3/__init__.py\", line 139, in <module>\r\n    from .core.connection import Connection\r\n  File \"/usr/local/lib/python2.7/dist-packages/ldap3/core/connection.py\", line 44, in <module>\r\n    from ..operation.compare import compare_operation, compare_request_to_dict\r\n  File \"/usr/local/lib/python2.7/dist-packages/ldap3/operation/compare.py\", line 28, in <module>\r\n    from ..operation.search import ava_to_dict\r\n  File \"/usr/local/lib/python2.7/dist-packages/ldap3/operation/search.py\", line 41, in <module>\r\n    from pyasn1.error import PyAsn1UnicodeDecodeError\r\nImportError: cannot import name PyAsn1UnicodeDecodeError\r\n\r\nI had ran pip install . and the setup script. Please help!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/819", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/819/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/819/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/819/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/819", "id": 598672605, "node_id": "MDU6SXNzdWU1OTg2NzI2MDU=", "number": 819, "title": "Can't install impacket", "user": {"login": "Trixelit", "id": 36838998, "node_id": "MDQ6VXNlcjM2ODM4OTk4", "avatar_url": "https://avatars1.githubusercontent.com/u/36838998?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Trixelit", "html_url": "https://github.com/Trixelit", "followers_url": "https://api.github.com/users/Trixelit/followers", "following_url": "https://api.github.com/users/Trixelit/following{/other_user}", "gists_url": "https://api.github.com/users/Trixelit/gists{/gist_id}", "starred_url": "https://api.github.com/users/Trixelit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Trixelit/subscriptions", "organizations_url": "https://api.github.com/users/Trixelit/orgs", "repos_url": "https://api.github.com/users/Trixelit/repos", "events_url": "https://api.github.com/users/Trixelit/events{/privacy}", "received_events_url": "https://api.github.com/users/Trixelit/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-13T04:54:00Z", "updated_at": "2020-04-29T19:45:15Z", "closed_at": "2020-04-29T19:45:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying to run `sudo python setup.py install` after running `sudo python setup.py build` I get an error saying `AttributeError: 'NoneType' has no attribute 'clone'`\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/817", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/817/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/817/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/817/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/817", "id": 596210852, "node_id": "MDU6SXNzdWU1OTYyMTA4NTI=", "number": 817, "title": "getMachineName in GetNPUsers/GetADUsers/GetUserSPNs fails on Windows 2019/NTLM Auth Disabled", "user": {"login": "Meatballs1", "id": 1854557, "node_id": "MDQ6VXNlcjE4NTQ1NTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1854557?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Meatballs1", "html_url": "https://github.com/Meatballs1", "followers_url": "https://api.github.com/users/Meatballs1/followers", "following_url": "https://api.github.com/users/Meatballs1/following{/other_user}", "gists_url": "https://api.github.com/users/Meatballs1/gists{/gist_id}", "starred_url": "https://api.github.com/users/Meatballs1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Meatballs1/subscriptions", "organizations_url": "https://api.github.com/users/Meatballs1/orgs", "repos_url": "https://api.github.com/users/Meatballs1/repos", "events_url": "https://api.github.com/users/Meatballs1/events{/privacy}", "received_events_url": "https://api.github.com/users/Meatballs1/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-04-07T23:29:57Z", "updated_at": "2020-04-14T13:15:15Z", "closed_at": "2020-04-13T20:19:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nTarget OS:  Windows 2019 - NTLM Auth Disabled\r\nVersion: 7e505892 - Fri March 27th\r\n\r\n### Debug Output With Command String  \r\n\r\nKRB5CCNAME=/tmp/krb5cc_0 python3 examples/GetUserSPNs.py -k -no-pass TEST.ORG/testuser -debug\r\n```\r\nSMB SessionError:STATUS_NOT_SUPPORTED\r\n```\r\nIt appears the s.login('','') to do a basic connection fails. I've worked around this by hardcoding the machine name as the return value, but could maybe use a `--target` option. Using `dc-ip` and `target-domain` dont help. ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/815", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/815/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/815/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/815/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/815", "id": 594122584, "node_id": "MDU6SXNzdWU1OTQxMjI1ODQ=", "number": 815, "title": "finddelegations.py cannot connect to DC", "user": {"login": "basketas", "id": 16399561, "node_id": "MDQ6VXNlcjE2Mzk5NTYx", "avatar_url": "https://avatars1.githubusercontent.com/u/16399561?v=4", "gravatar_id": "", "url": "https://api.github.com/users/basketas", "html_url": "https://github.com/basketas", "followers_url": "https://api.github.com/users/basketas/followers", "following_url": "https://api.github.com/users/basketas/following{/other_user}", "gists_url": "https://api.github.com/users/basketas/gists{/gist_id}", "starred_url": "https://api.github.com/users/basketas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/basketas/subscriptions", "organizations_url": "https://api.github.com/users/basketas/orgs", "repos_url": "https://api.github.com/users/basketas/repos", "events_url": "https://api.github.com/users/basketas/events{/privacy}", "received_events_url": "https://api.github.com/users/basketas/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-04-04T21:59:05Z", "updated_at": "2020-04-13T20:19:50Z", "closed_at": "2020-04-13T20:19:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.21-dev\r\nPython version:  3.7.7\r\nTarget OS:  Windows Server 2016\r\n\r\n### Debug Output With Command String  \r\ni.e.  \r\n```\r\nfinddelegation.py -debug lab/sale:sale@192.168.23.10\r\nImpacket v0.9.21.dev1 - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: C:\\Users\\sale\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\impacket\r\n[+] Connecting to lab, port 389, SSL False\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sale\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\impacket\\ldap\\ldap.py\", line 107, in __init__\r\n    af, socktype, proto, _, sa = socket.getaddrinfo(targetHost, self._dstPort, 0, socket.SOCK_STREAM)[0]\r\n  File \"C:\\Users\\sale\\AppData\\Local\\Programs\\Python\\Python37\\lib\\socket.py\", line 752, in getaddrinfo\r\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\r\nsocket.gaierror: [Errno 11001] getaddrinfo failed\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"c:\\users\\sale\\appdata\\local\\programs\\python\\python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\EGG-INFO\\scripts\\findDelegation.py\", line 297, in <module>\r\n    executer.run()\r\n  File \"c:\\users\\sale\\appdata\\local\\programs\\python\\python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\EGG-INFO\\scripts\\findDelegation.py\", line 110, in run\r\n    ldapConnection = ldap.LDAPConnection('ldap://%s' % target, self.baseDN, self.__kdcHost)\r\n  File \"C:\\Users\\sale\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\impacket\\ldap\\ldap.py\", line 110, in __init__\r\n    raise socket.error('Connection error (%s:%d)' % (targetHost, 88), e)\r\nOSError: [Errno Connection error (lab:88)] [Errno 11001] getaddrinfo failed\r\n[-] [Errno Connection error (lab:88)] [Errno 11001] getaddrinfo failed\r\n```\r\n\r\n```\r\nfinddelegation.py -debug lab.local/sale:sale@192.168.23.10\r\nImpacket v0.9.21.dev1 - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: C:\\Users\\sale\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\impacket\r\n[+] Connecting to lab.local, port 389, SSL False\r\nTraceback (most recent call last):\r\n  File \"c:\\users\\sale\\appdata\\local\\programs\\python\\python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\EGG-INFO\\scripts\\findDelegation.py\", line 297, in <module>\r\n    executer.run()\r\n  File \"c:\\users\\sale\\appdata\\local\\programs\\python\\python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\EGG-INFO\\scripts\\findDelegation.py\", line 112, in run\r\n    ldapConnection.login(self.__username, self.__password, self.__domain, self.__lmhash, self.__nthash)\r\n  File \"C:\\Users\\sale\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\impacket-0.9.21.dev1-py3.7.egg\\impacket\\ldap\\ldap.py\", line 343, in login\r\n    response['bindResponse']['diagnosticMessage'])\r\nimpacket.ldap.ldap.LDAPSessionError: Error in bindRequest -> invalidCredentials: 8009030C: LdapErr: DSID-0C0906C1, comment: AcceptSecurityContext error, data 52e, v3839\r\n[-] Error in bindRequest -> invalidCredentials: 8009030C: LdapErr: DSID-0C0906C1, comment: AcceptSecurityContext error, data 52e, v3839\r\n```\r\n\r\n\r\n### Additional context  \r\nI can't connect to LDAP on DC(Server 2016)... I am trying with the Domain Admin credentials(username is same as password btw).\r\nTried with Python 3.7 and 2.7, from both Linux and Windows.. With both \"pip install impacket\" and manual download of the latest impacket version from github..\r\n\r\nCould it be because the domain contains \".local\" ?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/814", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/814/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/814/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/814/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/814", "id": 593516403, "node_id": "MDU6SXNzdWU1OTM1MTY0MDM=", "number": 814, "title": "now versions relay problem", "user": {"login": "zsirlev", "id": 63117148, "node_id": "MDQ6VXNlcjYzMTE3MTQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/63117148?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zsirlev", "html_url": "https://github.com/zsirlev", "followers_url": "https://api.github.com/users/zsirlev/followers", "following_url": "https://api.github.com/users/zsirlev/following{/other_user}", "gists_url": "https://api.github.com/users/zsirlev/gists{/gist_id}", "starred_url": "https://api.github.com/users/zsirlev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zsirlev/subscriptions", "organizations_url": "https://api.github.com/users/zsirlev/orgs", "repos_url": "https://api.github.com/users/zsirlev/repos", "events_url": "https://api.github.com/users/zsirlev/events{/privacy}", "received_events_url": "https://api.github.com/users/zsirlev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-04-03T16:57:15Z", "updated_at": "2020-04-29T19:28:40Z", "closed_at": "2020-04-29T19:28:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "impacket version: 0.9.20 and 0.9.21 including the actual master\r\npython 3.7.7\r\nos: kali (fully updated, the included impacket-ntlmrelayx has the same issue for me)\r\nrelayed os: between two windows 2019 server, on virtualbox VM.\r\n\r\nHello!\r\n\r\nI have a problem with the ntlmrelayx, with the version 0.9.20 and 0.9.21, the highest version works fine is the version 0.9.19 (python 2.7.17). The relay never successful, I always get failure (the -debug do not give any error message).\r\n\r\nI did some network monitoring, and found the following: \r\n- In the not working version the relayed packet is smaller than the one it got (706 bytes versus 731 bytes)\r\nThe difference is coming from some differences in the Security BLOB, here are the copy of what it got, and what it forwarded as security BLOB:\r\n\r\ngot:\r\na182024530820241a0030a0101a2820224048202204e544c4d5353500003000000180018009000000068016801a800000012001200580000001a001a006a0000000c000c00840000001000100010020000158288e20a0063450000000fc2f2a16c7ea7d9956a4bd1ca5f74a0884d00590043004f004d00500041004e005900410064006d0069006e006900730074007200610074006f0072004400430032004b00310039000000000000000000000000000000000000000000000000001f9fd2b23debbe35a62858ad255e760c0101000000000000dc0db935fab3d4017d8e846bbd43c27400000000020012004d00590043004f004d00500041004e0059000100140053004500520056004500520032004b003100390004001e006d00790063006f006d00700061006e0079002e006c006f00630061006c000300340053006500720076006500720032006b00310039002e006d00790063006f006d00700061006e0079002e006c006f00630061006c0005001e006d00790063006f006d00700061006e0079002e006c006f00630061006c0007000800dc0db935fab3d401060004000200000008003000300000000000000000000000003000007241af7c907fdafa5e01074aac6f0516acbcb827ee6c95163292be9f79ba3c000a001000000000000000000000000000000000000900260063006900660073002f003100390032002e003100360038002e003100360038002e00370037000000000000000000000000007b37b56a767123dbde536bfdccf327c6a3120410010000004a996e31adf3e49800000000\r\n\r\nforwarded\r\na182022c30820228xxxxxxxxxxa2820224048202204e544c4d5353500003000000180018009000000068016801a800000012001200580000001a001a006a0000000c000c00840000001000100010020000158288e20a0063450000000fc2f2a16c7ea7d9956a4bd1ca5f74a0884d00590043004f004d00500041004e005900410064006d0069006e006900730074007200610074006f0072004400430032004b00310039000000000000000000000000000000000000000000000000001f9fd2b23debbe35a62858ad255e760c0101000000000000dc0db935fab3d4017d8e846bbd43c27400000000020012004d00590043004f004d00500041004e0059000100140053004500520056004500520032004b003100390004001e006d00790063006f006d00700061006e0079002e006c006f00630061006c000300340053006500720076006500720032006b00310039002e006d00790063006f006d00700061006e0079002e006c006f00630061006c0005001e006d00790063006f006d00700061006e0079002e006c006f00630061006c0007000800dc0db935fab3d401060004000200000008003000300000000000000000000000003000007241af7c907fdafa5e01074aac6f0516acbcb827ee6c95163292be9f79ba3c000a001000000000000000000000000000000000000900260063006900660073002f003100390032002e003100360038002e003100360038002e00370037000000000000000000000000007b37b56a767123dbde536bfdccf327c6xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\r\n\r\nFrom the forwarded blob the following things are missing:\r\n- negResult (it got 01, but did not forward it)\r\n- 4 bytes before the negResult (wireshark do not name these bytes, for me it was a0030a01)\r\n- the mechListMIC (16 bytes, for me 010000004a996e31adf3e49800000000)\r\n- four bytes before the mechListMIC (the wireshark do not name these bytes, for me a3120410)\r\n\r\nI attached 2 wireshark capture: good.pcapng is from version 0.9.19 as it works\r\nbad.pcapng: with version 0.9.21 not works (for example packets 27 and 29 are the ones I wrote about)\r\n\r\n[captures.zip](https://github.com/SecureAuthCorp/impacket/files/4428695/captures.zip)\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/812", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/812/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/812/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/812/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/812", "id": 590379893, "node_id": "MDU6SXNzdWU1OTAzNzk4OTM=", "number": 812, "title": "OSError: [Errno 98] Address already in use", "user": {"login": "kaizen-dry", "id": 62895723, "node_id": "MDQ6VXNlcjYyODk1NzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/62895723?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaizen-dry", "html_url": "https://github.com/kaizen-dry", "followers_url": "https://api.github.com/users/kaizen-dry/followers", "following_url": "https://api.github.com/users/kaizen-dry/following{/other_user}", "gists_url": "https://api.github.com/users/kaizen-dry/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaizen-dry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaizen-dry/subscriptions", "organizations_url": "https://api.github.com/users/kaizen-dry/orgs", "repos_url": "https://api.github.com/users/kaizen-dry/repos", "events_url": "https://api.github.com/users/kaizen-dry/events{/privacy}", "received_events_url": "https://api.github.com/users/kaizen-dry/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-30T15:25:09Z", "updated_at": "2020-03-30T17:39:26Z", "closed_at": "2020-03-30T17:39:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n**COMMAND:**impacket-smbserver Pleasework $(pwd) -smb2support -user root -password root\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/share/doc/python3-impacket/examples/smbserver.py\", line 64, in <module>\r\n    server = smbserver.SimpleSMBServer(listenAddress=options.interface_address, listenPort=int(options.port))\r\n  File \"/usr/lib/python3/dist-packages/impacket/smbserver.py\", line 4621, in __init__\r\n    self.__server = SMBSERVER((listenAddress,listenPort), config_parser = self.__smbConfig)\r\n  File \"/usr/lib/python3/dist-packages/impacket/smbserver.py\", line 3747, in __init__\r\n    socketserver.TCPServer.__init__(self, server_address, handler_class)\r\n  File \"/usr/lib/python3.7/socketserver.py\", line 452, in __init__\r\n    self.server_bind()\r\n  File \"/usr/lib/python3.7/socketserver.py\", line 466, in server_bind\r\n    self.socket.bind(self.server_address)\r\nOSError: [Errno 98] Address already in use", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/811", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/811/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/811/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/811/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/811", "id": 589903891, "node_id": "MDU6SXNzdWU1ODk5MDM4OTE=", "number": 811, "title": "psexec.py Keytab module missing", "user": {"login": "almemar8719", "id": 62858406, "node_id": "MDQ6VXNlcjYyODU4NDA2", "avatar_url": "https://avatars0.githubusercontent.com/u/62858406?v=4", "gravatar_id": "", "url": "https://api.github.com/users/almemar8719", "html_url": "https://github.com/almemar8719", "followers_url": "https://api.github.com/users/almemar8719/followers", "following_url": "https://api.github.com/users/almemar8719/following{/other_user}", "gists_url": "https://api.github.com/users/almemar8719/gists{/gist_id}", "starred_url": "https://api.github.com/users/almemar8719/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/almemar8719/subscriptions", "organizations_url": "https://api.github.com/users/almemar8719/orgs", "repos_url": "https://api.github.com/users/almemar8719/repos", "events_url": "https://api.github.com/users/almemar8719/events{/privacy}", "received_events_url": "https://api.github.com/users/almemar8719/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-03-29T22:47:24Z", "updated_at": "2020-06-25T10:10:29Z", "closed_at": "2020-04-13T20:21:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi all, \r\nI've tried previous versions, all got an error or so. However, the latest one resolved those errors but got missing module. \r\nam getting this error\r\n--------------\r\nFile \"psexec.py\", line 33, in <module>\r\n    from impacket.krb5.keytab import Keytab\r\nImportError: No module named keytab\r\n---------------\r\n\r\nAppreciate if you guide me to stable version. \r\n\r\nI've backed to six older version. all got issues", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/810", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/810/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/810/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/810/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/810", "id": 589676789, "node_id": "MDU6SXNzdWU1ODk2NzY3ODk=", "number": 810, "title": "SMBClient SMB3 doesn't support KRB5CC?", "user": {"login": "Meatballs1", "id": 1854557, "node_id": "MDQ6VXNlcjE4NTQ1NTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1854557?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Meatballs1", "html_url": "https://github.com/Meatballs1", "followers_url": "https://api.github.com/users/Meatballs1/followers", "following_url": "https://api.github.com/users/Meatballs1/following{/other_user}", "gists_url": "https://api.github.com/users/Meatballs1/gists{/gist_id}", "starred_url": "https://api.github.com/users/Meatballs1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Meatballs1/subscriptions", "organizations_url": "https://api.github.com/users/Meatballs1/orgs", "repos_url": "https://api.github.com/users/Meatballs1/repos", "events_url": "https://api.github.com/users/Meatballs1/events{/privacy}", "received_events_url": "https://api.github.com/users/Meatballs1/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-28T23:03:58Z", "updated_at": "2020-03-28T23:26:38Z", "closed_at": "2020-03-28T23:26:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/SecureAuthCorp/impacket/blob/7e50589280b07ce6814adf97a0492917dc5a6620/impacket/smb3.py#L633-L654\r\n\r\nIt appears checking the KRB5CC cache for tickets in the SMB3 code doesn't exist at the moment? \r\n\r\nThink it might cause auth requests with a null password and may lead to lockouts...", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/809", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/809/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/809/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/809/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/809", "id": 589672884, "node_id": "MDU6SXNzdWU1ODk2NzI4ODQ=", "number": 809, "title": "GetNPUsers - unable to enumerate targets with kerberos KRB5CC", "user": {"login": "Meatballs1", "id": 1854557, "node_id": "MDQ6VXNlcjE4NTQ1NTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/1854557?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Meatballs1", "html_url": "https://github.com/Meatballs1", "followers_url": "https://api.github.com/users/Meatballs1/followers", "following_url": "https://api.github.com/users/Meatballs1/following{/other_user}", "gists_url": "https://api.github.com/users/Meatballs1/gists{/gist_id}", "starred_url": "https://api.github.com/users/Meatballs1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Meatballs1/subscriptions", "organizations_url": "https://api.github.com/users/Meatballs1/orgs", "repos_url": "https://api.github.com/users/Meatballs1/repos", "events_url": "https://api.github.com/users/Meatballs1/events{/privacy}", "received_events_url": "https://api.github.com/users/Meatballs1/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-28T22:34:16Z", "updated_at": "2020-05-13T13:14:07Z", "closed_at": "2020-05-13T13:14:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/SecureAuthCorp/impacket/blob/7e50589280b07ce6814adf97a0492917dc5a6620/examples/GetNPUsers.py#L215-L221\r\n\r\nIf you are using a `KRB5CC` cache file to authenticate with `-k -nopass` then this module will not enumerate users and only checks the `target` user. \r\n\r\nYou have to remove the `-nopass` arg and enter the password. But if you don't know the password you are stuffed :) \r\n\r\nIt would be nice to be able to enumerate users even when `-nopass` is used.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/807", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/807/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/807/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/807/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/807", "id": 588947577, "node_id": "MDU6SXNzdWU1ODg5NDc1Nzc=", "number": 807, "title": "Does secretsdump authenticate with nthash?", "user": {"login": "a6avind", "id": 11615112, "node_id": "MDQ6VXNlcjExNjE1MTEy", "avatar_url": "https://avatars2.githubusercontent.com/u/11615112?v=4", "gravatar_id": "", "url": "https://api.github.com/users/a6avind", "html_url": "https://github.com/a6avind", "followers_url": "https://api.github.com/users/a6avind/followers", "following_url": "https://api.github.com/users/a6avind/following{/other_user}", "gists_url": "https://api.github.com/users/a6avind/gists{/gist_id}", "starred_url": "https://api.github.com/users/a6avind/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/a6avind/subscriptions", "organizations_url": "https://api.github.com/users/a6avind/orgs", "repos_url": "https://api.github.com/users/a6avind/repos", "events_url": "https://api.github.com/users/a6avind/events{/privacy}", "received_events_url": "https://api.github.com/users/a6avind/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-03-27T07:43:15Z", "updated_at": "2020-04-01T16:30:18Z", "closed_at": "2020-03-27T13:37:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/805", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/805/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/805/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/805/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/805", "id": 586598981, "node_id": "MDU6SXNzdWU1ODY1OTg5ODE=", "number": 805, "title": "[-] Exception in HTTP request handler: 'HTTPMessage' object has no attribute 'getheader'", "user": {"login": "BalaDeveloper2094", "id": 18625950, "node_id": "MDQ6VXNlcjE4NjI1OTUw", "avatar_url": "https://avatars3.githubusercontent.com/u/18625950?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BalaDeveloper2094", "html_url": "https://github.com/BalaDeveloper2094", "followers_url": "https://api.github.com/users/BalaDeveloper2094/followers", "following_url": "https://api.github.com/users/BalaDeveloper2094/following{/other_user}", "gists_url": "https://api.github.com/users/BalaDeveloper2094/gists{/gist_id}", "starred_url": "https://api.github.com/users/BalaDeveloper2094/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BalaDeveloper2094/subscriptions", "organizations_url": "https://api.github.com/users/BalaDeveloper2094/orgs", "repos_url": "https://api.github.com/users/BalaDeveloper2094/repos", "events_url": "https://api.github.com/users/BalaDeveloper2094/events{/privacy}", "received_events_url": "https://api.github.com/users/BalaDeveloper2094/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-03-24T00:13:27Z", "updated_at": "2020-03-25T19:18:15Z", "closed_at": "2020-03-25T19:10:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.9.21\r\nPython version:  3.7.7\r\nTarget OS:  Kali linux\r\n\r\n### Debug Output With Command String  root\r\nImpacket v0.9.21.dev1+20200313.160519.0056b61c - Copyright 2020 SecureAuth Corporation\r\n[+] Impacket Library Installation Path: /usr/local/lib/python3.7/dist-packages/impacket\r\n[*] Protocol Client SMB loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client HTTPS loaded..\r\n[*] Protocol Client SMTP loaded..\r\n[+] Protocol Attack MSSQL loaded..\r\n[+] Protocol Attack SMB loaded..\r\n[+] Protocol Attack HTTP loaded..\r\n[+] Protocol Attack HTTPS loaded..\r\n[+] Protocol Attack LDAP loaded..\r\n[+] Protocol Attack LDAPS loaded..\r\n[+] Protocol Attack IMAP loaded..\r\n[+] Protocol Attack IMAPS loaded..\r\n[*] Running in relay mode to single host\r\n[*] Setting up SMB Server\r\n[*] Setting up HTTP Server\r\n\r\n[*] Servers started, waiting for connections\r\n[*] HTTPD: Received connection from 192.168.203.134, attacking target smb://192.168.203.135\r\n[*] HTTPD: Received connection from 192.168.203.134, but there are no more targets left!\r\n[*] HTTPD: Received connection from 192.168.203.134, attacking target smb://192.168.203.135\r\n[+] Exception:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/dist-packages/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 75, in handle_one_request\r\n    http.server.SimpleHTTPRequestHandler.handle_one_request(self)\r\n  File \"/usr/lib/python3.7/http/server.py\", line 414, in handle_one_request\r\n    method()\r\n  File \"/usr/local/lib/python3.7/dist-packages/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 143, in do_PROPFIND\r\n    if self.headers.getheader('Authorization') is None:\r\nAttributeError: 'HTTPMessage' object has no attribute 'getheader'\r\n[-] Exception in HTTP request handler: 'HTTPMessage' object has no attribute 'getheader'\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/804", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/804/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/804/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/804/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/804", "id": 586198243, "node_id": "MDU6SXNzdWU1ODYxOTgyNDM=", "number": 804, "title": "dpapi.py does not have a -no-pass option", "user": {"login": "aconite33", "id": 3675886, "node_id": "MDQ6VXNlcjM2NzU4ODY=", "avatar_url": "https://avatars2.githubusercontent.com/u/3675886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aconite33", "html_url": "https://github.com/aconite33", "followers_url": "https://api.github.com/users/aconite33/followers", "following_url": "https://api.github.com/users/aconite33/following{/other_user}", "gists_url": "https://api.github.com/users/aconite33/gists{/gist_id}", "starred_url": "https://api.github.com/users/aconite33/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aconite33/subscriptions", "organizations_url": "https://api.github.com/users/aconite33/orgs", "repos_url": "https://api.github.com/users/aconite33/repos", "events_url": "https://api.github.com/users/aconite33/events{/privacy}", "received_events_url": "https://api.github.com/users/aconite33/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-23T13:12:50Z", "updated_at": "2020-07-29T01:17:14Z", "closed_at": "2020-07-29T01:17:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.9.21.dev1+20200313.160519.0056b61c\r\nPython version:  3\r\nTarget OS:  Windows server 2016\r\n\r\ndpapi.py works with -k option when dealing with tickets, however it does not have a -no-pass option. While it still works, it does requires the user to enter a blank password for the authentication.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/801", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/801/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/801/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/801/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/801", "id": 584999403, "node_id": "MDU6SXNzdWU1ODQ5OTk0MDM=", "number": 801, "title": "KRB_AP_ERR_BAD_INTEGRITY with self-generated Gold Ticket", "user": {"login": "Donlouigi", "id": 34136130, "node_id": "MDQ6VXNlcjM0MTM2MTMw", "avatar_url": "https://avatars0.githubusercontent.com/u/34136130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Donlouigi", "html_url": "https://github.com/Donlouigi", "followers_url": "https://api.github.com/users/Donlouigi/followers", "following_url": "https://api.github.com/users/Donlouigi/following{/other_user}", "gists_url": "https://api.github.com/users/Donlouigi/gists{/gist_id}", "starred_url": "https://api.github.com/users/Donlouigi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Donlouigi/subscriptions", "organizations_url": "https://api.github.com/users/Donlouigi/orgs", "repos_url": "https://api.github.com/users/Donlouigi/repos", "events_url": "https://api.github.com/users/Donlouigi/events{/privacy}", "received_events_url": "https://api.github.com/users/Donlouigi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-03-20T11:15:20Z", "updated_at": "2020-03-31T06:34:05Z", "closed_at": "2020-03-31T06:34:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  Impacket v0.9.21.dev1+20200313.160519.0056b61c\r\nPython version:  2.7.17\r\nTarget OS:  Windows Server 2019\r\n\r\n### Debug Output With Command String  \r\n```\r\nroot@kali:~# python impacket/examples/psexec.py testdomain.de/Administrator@DC1.testdomain.de -k -no-pass -debug\r\nImpacket v0.9.21.dev1+20200313.160519.0056b61c - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: /usr/local/lib/python2.7/dist-packages/impacket\r\n[+] StringBinding ncacn_np:DC1.testdomain.de[\\pipe\\svcctl]\r\n[+] Using Kerberos Cache: /root/impacket/examples/Administrator.ccache\r\n[+] SPN CIFS/DC1.TESTDOMAIN.DE@TESTDOMAIN.DE not found in cache\r\n[+] AnySPN is True, looking for another suitable SPN\r\n[+] Returning cached credential for KRBTGT/TESTDOMAIN.DE@TESTDOMAIN.DE\r\n[+] Using TGT from cache\r\n[+] Trying to connect to KDC at TESTDOMAIN.DE\r\nTraceback (most recent call last):\r\n  File \"impacket/examples/psexec.py\", line 119, in doStuff\r\n    dce.connect()\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket/dcerpc/v5/rpcrt.py\", line 800, in connect\r\n    return self._transport.connect()\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket/dcerpc/v5/transport.py\", line 410, in connect\r\n    TGS=self._TGS)\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket/smbconnection.py\", line 361, in kerberosLogin\r\n    raise e\r\nKerberosError: Kerberos SessionError: KRB_AP_ERR_BAD_INTEGRITY(Integrity check on decrypted field failed)\r\n[-] Kerberos SessionError: KRB_AP_ERR_BAD_INTEGRITY(Integrity check on decrypted field failed)\r\n\r\n```\r\n\r\n### Additional context  \r\nI generated a golden Ticket with impacket, i got the hash directly from the machine. Then i exported the ccache and tried the command above at Debug Output. klist shows the exported TGT. I could use the hash for a pass the hash attack with msfconsole. Does anyone have any idea why I get this error message?\r\n```\r\nroot@kali:~/impacket/examples# python ticketer.py -nthash 96fea1e975ed1c7507ec7cdb36473c46 -domain-sid S-1-5-21-2581937525-1282777070-2486761147 -domain testdomain.de Administrator -debug\r\nImpacket v0.9.21.dev1+20200313.160519.0056b61c - Copyright 2020 SecureAuth Corporation\r\n\r\n[+] Impacket Library Installation Path: /usr/local/lib/python2.7/dist-packages/impacket\r\n[*] Creating basic skeleton ticket and PAC Infos\r\n[*] Customizing ticket for testdomain.de/Administrator\r\n[+] VALIDATION_INFO after making it gold\r\nVALIDATION_INFO \r\nCommonHeader:                   \r\n    Version:                         1 \r\n    Endianness:                      16 \r\n    CommonHeaderLength:              8 \r\n    Filler:                          3435973836 \r\nPrivateHeader:                  \r\n    ObjectBufferLength:              444 \r\n    Filler:                          3435973836 \r\nData:                           \r\n    LogonTime:                      \r\n        dwLowDateTime:                   3199577984 \r\n        dwHighDateTime:                  30801571 \r\n    LogoffTime:                     \r\n        dwLowDateTime:                   4294967295 \r\n        dwHighDateTime:                  2147483647 \r\n    KickOffTime:                    \r\n        dwLowDateTime:                   4294967295 \r\n        dwHighDateTime:                  2147483647 \r\n    PasswordLastSet:                \r\n        dwLowDateTime:                   3199577984 \r\n        dwHighDateTime:                  30801571 \r\n    PasswordCanChange:              \r\n        dwLowDateTime:                   0 \r\n        dwHighDateTime:                  0 \r\n    PasswordMustChange:             \r\n        dwLowDateTime:                   4294967295 \r\n        dwHighDateTime:                  2147483647 \r\n    EffectiveName:                   u'Administrator' \r\n    FullName:                        u'' \r\n    LogonScript:                     u'' \r\n    ProfilePath:                     u'' \r\n    HomeDirectory:                   u'' \r\n    HomeDirectoryDrive:              u'' \r\n    LogonCount:                      500 \r\n    BadPasswordCount:                0 \r\n    UserId:                          500 \r\n    PrimaryGroupId:                  513 \r\n    GroupCount:                      5 \r\n    GroupIds:                       \r\n        [\r\n             \r\n            RelativeId:                      513 \r\n            Attributes:                      7 ,\r\n             \r\n            RelativeId:                      512 \r\n            Attributes:                      7 ,\r\n             \r\n            RelativeId:                      520 \r\n            Attributes:                      7 ,\r\n             \r\n            RelativeId:                      518 \r\n            Attributes:                      7 ,\r\n             \r\n            RelativeId:                      519 \r\n            Attributes:                      7 ,\r\n        ] \r\n    UserFlags:                       0 \r\n    UserSessionKey:                 \r\n        Data:                            '\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' \r\n    LogonServer:                     u'' \r\n    LogonDomainName:                 u'TESTDOMAIN.DE' \r\n    LogonDomainId:                  \r\n        Revision:                        1 \r\n        SubAuthorityCount:               4 \r\n        IdentifierAuthority:             '\\x00\\x00\\x00\\x00\\x00\\x05' \r\n        SubAuthority:                   \r\n            [\r\n                 21,\r\n                 2581937525,\r\n                 1282777070,\r\n                 2486761147,\r\n            ] \r\n    LMKey:                           '\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' \r\n    UserAccountControl:              528 \r\n    SubAuthStatus:                   0 \r\n    LastSuccessfulILogon:           \r\n        dwLowDateTime:                   0 \r\n        dwHighDateTime:                  0 \r\n    LastFailedILogon:               \r\n        dwLowDateTime:                   0 \r\n        dwHighDateTime:                  0 \r\n    FailedILogonCount:               0 \r\n    Reserved3:                       0 \r\n    SidCount:                        0 \r\n    ExtraSids:                       NULL \r\n    ResourceGroupDomainSid:          NULL \r\n    ResourceGroupCount:              0 \r\n    ResourceGroupIds:                NULL \r\n\r\n[*]     PAC_LOGON_INFO\r\n[*]     PAC_CLIENT_INFO_TYPE\r\n[*]     EncTicketPart\r\n[*]     EncAsRepPart\r\n[*] Signing/Encrypting final ticket\r\n[*]     PAC_SERVER_CHECKSUM\r\n[*]     PAC_PRIVSVR_CHECKSUM\r\n[+] Customized EncTicketPart\r\nEncTicketPart:\r\n flags=1356857344\r\n key=EncryptionKey:\r\n  keytype=23\r\n  keyvalue=tSvZesihgCKfjPsC\r\n\r\n crealm=TESTDOMAIN.DE\r\n cname=PrincipalName:\r\n  name-type=1\r\n  name-string=SequenceOf:\r\n   Administrator\r\n\r\n transited=TransitedEncoding:\r\n  tr-type=0\r\n  contents=\r\n\r\n authtime=20200320103851Z\r\n starttime=20200320103851Z\r\n endtime=20300318103851Z\r\n renew-till=20300318103851Z\r\n authorization-data=AuthorizationData:\r\n  Sequence:\r\n   ad-type=1\r\n   ad-data=0x308202823082027ea00402020080a182027404820270040000000000000001000000cc01000048000000000000000a000000240000001802000000000000060000001400000040020000000000000700000014000000580200000000000001100800ccccccccbc010000cccccccc9f08000080afb5bea3fed501ffffffffffffff7fffffffffffffff7f80afb5bea3fed5010000000000000000ffffffffffffff7f1a001a00039a000000000000206f0000000000006dad000000000000e3810000000000006d450000000000009abb0000f4010000f40100000102000005000000249a00000000000000000000000000000000000000000000000000000fdd00001a001a00ace00000671300000000000000000000100200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d000000000000000d000000410064006d0069006e006900730074007200610074006f007200abab00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000010200000700000000020000070000000802000007000000060200000700000007020000070000000000000000000000000000000d000000000000000d000000540045005300540044004f004d00410049004e002e0044004500eeee04000000010400000000000515000000753de599ee9f754cbbf638940000000080afb5bea3fed5011a00410064006d0069006e006900730074007200610074006f0072000000000076ffffffedaa5880ae3bd4769b241c2db334e4cb0000000076fffffffa7cda509f2f9ce4f555f295eba52a3100000000\r\n\r\n\r\n\r\n\r\n[*]     EncTicketPart\r\n[*]     EncASRepPart\r\n[+] Final Golden Ticket\r\nAS_REP:\r\n pvno=5\r\n msg-type=11\r\n crealm=TESTDOMAIN.DE\r\n cname=PrincipalName:\r\n  name-type=1\r\n  name-string=SequenceOf:\r\n   Administrator\r\n\r\n ticket=Ticket:\r\n  tkt-vno=5\r\n  realm=TESTDOMAIN.DE\r\n  sname=PrincipalName:\r\n   name-type=2\r\n   name-string=SequenceOf:\r\n    krbtgt    TESTDOMAIN.DE\r\n\r\n  enc-part=EncryptedData:\r\n   etype=23\r\n   kvno=2\r\n   cipher=0x8342d38f22f56fe20b9cf9e9b47fc1dbcef5ef026cc0ded4e12a76d51e56b0c281cec30470bec9b3188b81d8a2330bcc82e61d3300f9e3d8a9431860043f9208b6f0e82a316073e5abebc8810279a7c3235f9571081283d604997c4c4c453a031824ad2a2b816a505790362ac541d8fec0f65190e957124dc27653d0a6c2941919cee184465cc80ee81bbae1838821d84431fd01f8462907aba02639b28da62a6ca49ed492a46c2df2573b71bc039350df1407863d3795fdc2f0c0882f9f8914810eacc5d13230f6f938c5d05b94a52adab434c8bbd749035ce3824065189cb1516c70ebc37518bf7c7b6b5e66a2f733f141bd2d9c0fe384c14d97fbaf3474329ab9cdb0843ff5384467abf1afa864969b456d1215acbd355bde8d1d1a934986ab9ef5e2c2ed3c3ab50b1f847cfeb4f5c24c487a5648965e581c9691c451ff57ddcc2ca2b4b9709e00c202f28f2ffbf621eb50266b5c90b681eb7f240539293be5c784b154d2eec7d8758d3e04cdce69468838b602b348aacdf6eff41c9660e82eb98c96c90f9a03543b93613c7df4f3a827f2d27c50c1eb1ff05494c545ce9b58b509f43014a094dabb950511527e8182e66a59861af5af83b650dbc984f09dfdc3120e826ef6c0692d04820b2c87978e1abe78fe1c63a91297a79f950f309a90dd22f15e48f162c686e6a67fce55b2bd7a92af444b196345213b290e6c5085bc7913d637ed516e07f52b7b28f8b6051b66135752527a0e6a2404b2d203faef6af53b5bd5147a6acc225bab588f5edd518dd6b1c39387a8d18dec490845311c89130745ec3ae9b569ef8ac227523c0a7be052bc215bdc0da418cc778ae5caf4b9a759b44e0e27c102b77e2645800c4696271f6d1c39c8302cc90ebfffc57ee11ea6d20e2654cd74137d0e3e4fb0d995d08d084395c4eb245afb4cd73b7bf1184124bb8d58b9b96344f3d5075722aba4c8f60ac141da73b8ea5ca14a7dde54da37e5468eab4cf541ae175b9c300c0c7939375088a9f3b8986f4fbbc2c1f1b6cd007877f0292efcbd12b49cdf74dbd1e6ae816f23ae8b62979300f4c2422efabf1ac7d9c610fc0e952f6fd5740b2107282c3de9868b193110f84712c77e017631bed4a39894434c8ba7cce2ca0629106cd6665e14e100f5be48887c31c72709fce4348590712fa18fa05798a3aaf4e0cb17323fef23b08a8c0633215e05565d0bc1c6ac2288a59896fee171\r\n\r\n\r\n enc-part=EncryptedData:\r\n  etype=23\r\n  kvno=1\r\n  cipher=0x20a761a485f6e390f28947cece55fe3bfcd0741032108b4af8878b95a0127a982dd5193be8c1d566b323780e84207f4bc775542ccc89b150520d3d0797dd69b0e0002562a692e9412d8c7884f805a4a487b20e0156133305d2f3432925c416f206cb80311de641f3e32b56115b9f251a08df5be3b8a718975fe662d2436d2ce4c5c0b498c2d3b3b7c61a78e6b07515078bf6aac7c3ca2b1110db9832c2f430afa76510da3bdf902c3ea1a2653ce4b814626f10f8b6792073054f19ad37e15554632443170bcc411067824eec0296b476c9d942e12af7f122418137dd9148fd3a2de8ed5cea66241cf43c532448fa8e058b62953ae7b06c1a447b28f37dfc\r\n\r\n\r\n\r\n\r\n[*] Saving ticket in Administrator.ccache\r\nroot@kali:~/impacket/examples# export KRB5CCNAME=/root/impacket/examples/Administrator.ccache\r\n\r\nroot@kali:~# klist -l\r\nPrincipal name                 Cache name\r\n--------------                 ----------\r\nAdministrator@TESTDOMAIN.DE    FILE:/root/impacket/examples/Administrator.ccache\r\n\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/800", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/800/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/800/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/800/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/800", "id": 584627488, "node_id": "MDU6SXNzdWU1ODQ2Mjc0ODg=", "number": 800, "title": "Bug in GetNPUsers.py TypeError: init() takes 0 positional arguments but 1 was given", "user": {"login": "bLackCat-79", "id": 56641399, "node_id": "MDQ6VXNlcjU2NjQxMzk5", "avatar_url": "https://avatars2.githubusercontent.com/u/56641399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bLackCat-79", "html_url": "https://github.com/bLackCat-79", "followers_url": "https://api.github.com/users/bLackCat-79/followers", "following_url": "https://api.github.com/users/bLackCat-79/following{/other_user}", "gists_url": "https://api.github.com/users/bLackCat-79/gists{/gist_id}", "starred_url": "https://api.github.com/users/bLackCat-79/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bLackCat-79/subscriptions", "organizations_url": "https://api.github.com/users/bLackCat-79/orgs", "repos_url": "https://api.github.com/users/bLackCat-79/repos", "events_url": "https://api.github.com/users/bLackCat-79/events{/privacy}", "received_events_url": "https://api.github.com/users/bLackCat-79/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-19T18:53:20Z", "updated_at": "2020-03-25T19:19:58Z", "closed_at": "2020-03-25T19:19:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.20\r\nPython version:  2.7 3.6\r\nTarget OS:  windows 10\r\n\r\n### Debug Output With Command String  \r\npython GetNPUsers.py -usersfile users.txt -dc-ip 1.1.1.1  -no-pass -request -outputfile out somethin/\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n\r\nTraceback (most recent call last):\r\n  File \"GetNPUsers.py\", line 397, in <module>\r\n    logger.init(options.ts)\r\nTypeError: init() takes 0 positional arguments but 1 was given\r\n\r\nAnd yes, I did pip install impacket and I ran python setup install\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/799", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/799/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/799/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/799/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/799", "id": 584331969, "node_id": "MDU6SXNzdWU1ODQzMzE5Njk=", "number": 799, "title": "[Chore] Next release?", "user": {"login": "noraj", "id": 16578570, "node_id": "MDQ6VXNlcjE2NTc4NTcw", "avatar_url": "https://avatars3.githubusercontent.com/u/16578570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/noraj", "html_url": "https://github.com/noraj", "followers_url": "https://api.github.com/users/noraj/followers", "following_url": "https://api.github.com/users/noraj/following{/other_user}", "gists_url": "https://api.github.com/users/noraj/gists{/gist_id}", "starred_url": "https://api.github.com/users/noraj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/noraj/subscriptions", "organizations_url": "https://api.github.com/users/noraj/orgs", "repos_url": "https://api.github.com/users/noraj/repos", "events_url": "https://api.github.com/users/noraj/events{/privacy}", "received_events_url": "https://api.github.com/users/noraj/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-19T11:05:33Z", "updated_at": "2020-03-21T13:24:38Z", "closed_at": "2020-03-19T12:59:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "Python 3.8 introduced a warning.\r\n\r\nIt's already fixed:\r\n\r\nhttps://github.com/SecureAuthCorp/impacket/blob/0056b61ca52e13acf05d101518976980f1592d85/examples/GetUserSPNs.py#L445\r\n\r\nLast release was 09/2019, is a release planned soon ?\r\n\r\n### Configuration \r\n\r\nimpacket version:  v0.9.20\r\nPython version:  3.8\r\nTarget OS:  ArchLinux\r\n\r\n### Debug Output With Command String  \r\n\r\n```\r\n$ GetUserSPNs.py --help\r\n/usr/bin/GetUserSPNs.py:438: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n  if userDomain is '':\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n...\r\n```\r\n\r\nSimilar in all other scripts.\r\n\r\n### Additional context  \r\nSpace for additional context, investigative results, suspected issue.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/798", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/798/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/798/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/798/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/798", "id": 581842451, "node_id": "MDU6SXNzdWU1ODE4NDI0NTE=", "number": 798, "title": "setup.py is missing install requirement six", "user": {"login": "mback2k", "id": 231943, "node_id": "MDQ6VXNlcjIzMTk0Mw==", "avatar_url": "https://avatars0.githubusercontent.com/u/231943?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mback2k", "html_url": "https://github.com/mback2k", "followers_url": "https://api.github.com/users/mback2k/followers", "following_url": "https://api.github.com/users/mback2k/following{/other_user}", "gists_url": "https://api.github.com/users/mback2k/gists{/gist_id}", "starred_url": "https://api.github.com/users/mback2k/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mback2k/subscriptions", "organizations_url": "https://api.github.com/users/mback2k/orgs", "repos_url": "https://api.github.com/users/mback2k/repos", "events_url": "https://api.github.com/users/mback2k/events{/privacy}", "received_events_url": "https://api.github.com/users/mback2k/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-15T22:00:07Z", "updated_at": "2020-04-14T08:32:21Z", "closed_at": "2020-04-14T08:32:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  impacket-0.9.20\r\nPython version:  Python 3.7.7\r\nTarget OS:  MacOS\r\n\r\n### Debug Output With Command String  \r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"curl/tests/smbserver.py\", line 46, in <module>\r\n    from impacket import smbserver as imp_smbserver\r\n  File \"/usr/local/lib/python3.7/site-packages/impacket/smbserver.py\", line 44, in <module>\r\n    from six import PY2, b, text_type\r\nModuleNotFoundError: No module named 'six'\r\n```\r\n\r\nI am trying to port our `smbserver.py` in the curl project to Python 3.\r\nNow I noticed that your `setup.py` seems to be missing the requirement `six`.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/797", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/797/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/797/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/797/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/797", "id": 581749683, "node_id": "MDU6SXNzdWU1ODE3NDk2ODM=", "number": 797, "title": "smbrelayx.py init() errors", "user": {"login": "zZJH0222", "id": 43672032, "node_id": "MDQ6VXNlcjQzNjcyMDMy", "avatar_url": "https://avatars3.githubusercontent.com/u/43672032?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zZJH0222", "html_url": "https://github.com/zZJH0222", "followers_url": "https://api.github.com/users/zZJH0222/followers", "following_url": "https://api.github.com/users/zZJH0222/following{/other_user}", "gists_url": "https://api.github.com/users/zZJH0222/gists{/gist_id}", "starred_url": "https://api.github.com/users/zZJH0222/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zZJH0222/subscriptions", "organizations_url": "https://api.github.com/users/zZJH0222/orgs", "repos_url": "https://api.github.com/users/zZJH0222/repos", "events_url": "https://api.github.com/users/zZJH0222/events{/privacy}", "received_events_url": "https://api.github.com/users/zZJH0222/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-03-15T17:14:45Z", "updated_at": "2020-03-16T12:51:35Z", "closed_at": "2020-03-16T12:51:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is what I always report when I run this program. i have no idea about it.thinks\r\n\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n\r\nTraceback (most recent call last):\r\n  File \"smbrelayx.py\", line 1152, in <module>\r\n    logger.init(options.ts)\r\nTypeError: init() takes 0 positional arguments but 1 was given\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/795", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/795/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/795/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/795/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/795", "id": 580609688, "node_id": "MDU6SXNzdWU1ODA2MDk2ODg=", "number": 795, "title": "Does not seem to support Chinese echo results, can you help update?", "user": {"login": "klionsec", "id": 19607711, "node_id": "MDQ6VXNlcjE5NjA3NzEx", "avatar_url": "https://avatars3.githubusercontent.com/u/19607711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klionsec", "html_url": "https://github.com/klionsec", "followers_url": "https://api.github.com/users/klionsec/followers", "following_url": "https://api.github.com/users/klionsec/following{/other_user}", "gists_url": "https://api.github.com/users/klionsec/gists{/gist_id}", "starred_url": "https://api.github.com/users/klionsec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klionsec/subscriptions", "organizations_url": "https://api.github.com/users/klionsec/orgs", "repos_url": "https://api.github.com/users/klionsec/repos", "events_url": "https://api.github.com/users/klionsec/events{/privacy}", "received_events_url": "https://api.github.com/users/klionsec/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-13T13:43:32Z", "updated_at": "2020-03-13T19:36:28Z", "closed_at": "2020-03-13T19:36:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "msf5 auxiliary(scanner/smb/impacket/wmiexec) > show options \r\n\r\nModule options (auxiliary/scanner/smb/impacket/wmiexec):\r\n\r\n   Name       Current Setting  Required  Description\r\n   ----       ---------------  --------  -----------\r\n   COMMAND    whoami           yes       The command to execute\r\n   OUTPUT     true             yes       Get the output of the executed command\r\n   RHOSTS     192.168.159.131  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'\r\n   SMBDomain  motoo            no        The Windows domain to use for authentication\r\n   SMBPass    admin123!@#45    yes       The password for the specified username\r\n   SMBUser    administrator    yes       The username to authenticate as\r\n   THREADS    1                yes       The number of concurrent threads (max one per host)\r\n\r\nmsf5 auxiliary(scanner/smb/impacket/wmiexec) > run\r\n\r\n[*] Running for 192.168.159.131...\r\n[*] 192.168.159.131 - SMBv3.0 dialect used\r\n[*] motoo\\administrator\r\n\r\n[*] Scanned 1 of 1 hosts (100% complete)\r\n[*] Auxiliary module execution completed\r\nmsf5 auxiliary(scanner/smb/impacket/wmiexec) > set command whoami /user\r\ncommand => whoami /user\r\nmsf5 auxiliary(scanner/smb/impacket/wmiexec) > run\r\n\r\n[*] Running for 192.168.159.131...\r\n[*] 192.168.159.131 - SMBv3.0 dialect used\r\n[-] 192.168.159.131 - 'utf8' codec can't decode byte 0xd3 in position 2: invalid continuation byte\r\n[*] Scanned 1 of 1 hosts (100% complete)\r\n[*] Auxiliary module execution completed\r\nmsf5 auxiliary(scanner/smb/impacket/wmiexec) >", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/794", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/794/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/794/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/794/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/794", "id": 580601752, "node_id": "MDU6SXNzdWU1ODA2MDE3NTI=", "number": 794, "title": "ntlmrelayx.py error when relaying to LDAP", "user": {"login": "riflon", "id": 3855658, "node_id": "MDQ6VXNlcjM4NTU2NTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/3855658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/riflon", "html_url": "https://github.com/riflon", "followers_url": "https://api.github.com/users/riflon/followers", "following_url": "https://api.github.com/users/riflon/following{/other_user}", "gists_url": "https://api.github.com/users/riflon/gists{/gist_id}", "starred_url": "https://api.github.com/users/riflon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/riflon/subscriptions", "organizations_url": "https://api.github.com/users/riflon/orgs", "repos_url": "https://api.github.com/users/riflon/repos", "events_url": "https://api.github.com/users/riflon/events{/privacy}", "received_events_url": "https://api.github.com/users/riflon/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-03-13T13:29:37Z", "updated_at": "2020-04-30T14:38:21Z", "closed_at": "2020-04-29T19:46:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  Impacket v0.9.21.dev1+20200309.134159.0b46f198\r\nPython version:  Python 2.7.17\r\nTarget OS:  Windows Server 2016\r\n\r\n### ntlmrelayx.py issue when relaying to LDAP  \r\nThe error obtained after relaying to LDAP to a second DC (this was in the context of a printerbug exploitation) was the following:  \r\n```\r\npython ntlmrelayx.py -t ldaps://10.10.10.10 --remove-mic --delegate-access --add-computer 'NEWCOMPUTER$' -smb2support\r\n\r\nProxyChains-3.1 (http://proxychains.sf.net)\r\nImpacket v0.9.21.dev1+20200309.134159.0b46f198 - Copyright 2020 SecureAuth Corporation\r\n\r\n[*] Protocol Client SMTP loaded..\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Protocol Client SMB loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Running in relay mode to single host\r\n[*] Setting up SMB Server\r\n\r\n[*] Servers started, waiting for connections\r\n[*] Setting up HTTP Server\r\n[*] SMBD-Thread-3: Connection from DOMAIN/DC1$@xx.xx.xx.xx controlled, attacking target ldaps://10.10.10.10\r\n[*] Authenticating against ldaps://10.10.10.10 as DOMAIN/DC1$@xx.xx.xx.xx\r\n[*] Enumerating relayed user's privileges. This may take a while on large domains\r\n[*] SMBD-Thread-3: Connection from DOMAIN/DC1$@xx.xx.xx.xx controlled, but there are no more targets left!\r\nException in thread Thread-4:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/threading.py\", line 801, in __bootstrap_inner\r\n    self.run()\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 563, in run\r\n    userSid, privs = self.validatePrivileges(self.username, domainDumper)\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 386, in validatePrivileges\r\n    domainsid = self.client.entries[0]['objectSid'].value\r\n  File \"/usr/local/lib/python2.7/dist-packages/ldap3-2.5.1-py2.7.egg/ldap3/core/connection.py\", line 1459, in entries\r\n    self._entries = self._get_entries(self.response)\r\n  File \"/usr/local/lib/python2.7/dist-packages/ldap3-2.5.1-py2.7.egg/ldap3/core/connection.py\", line 1487, in _get_entries\r\n    Reader(self, object_def, self.request['base'], self.request['filter'], attributes=attr_set) if self.strategy.sync else Reader(self, object_def, '', '', attributes=attr_set))\r\nKeyError: 'base'\r\n```\r\n\r\nApparently there is an error in the context of ```connection.py``` and/or ```ldapattack.py``` libraries.\r\n\r\n### Additional context  \r\nWe were able to successfuly run the command specified before with an older version of Impacket. Specifically with the version released on September 25th, 2019 (Impacket version 0.9.20). So apparenlty this bug was added in a recent commit.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/793", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/793/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/793/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/793/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/793", "id": 580564085, "node_id": "MDU6SXNzdWU1ODA1NjQwODU=", "number": 793, "title": "Chinese system garbled please", "user": {"login": "klionsec", "id": 19607711, "node_id": "MDQ6VXNlcjE5NjA3NzEx", "avatar_url": "https://avatars3.githubusercontent.com/u/19607711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klionsec", "html_url": "https://github.com/klionsec", "followers_url": "https://api.github.com/users/klionsec/followers", "following_url": "https://api.github.com/users/klionsec/following{/other_user}", "gists_url": "https://api.github.com/users/klionsec/gists{/gist_id}", "starred_url": "https://api.github.com/users/klionsec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klionsec/subscriptions", "organizations_url": "https://api.github.com/users/klionsec/orgs", "repos_url": "https://api.github.com/users/klionsec/repos", "events_url": "https://api.github.com/users/klionsec/events{/privacy}", "received_events_url": "https://api.github.com/users/klionsec/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-13T12:15:53Z", "updated_at": "2020-03-13T19:37:42Z", "closed_at": "2020-03-13T19:37:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Can you help solve the problem that the Chinese system cannot display the execution results properly?\r\n\r\nmsf5 auxiliary(scanner/smb/impacket/wmiexec) > set command whoami /user\r\ncommand => whoami /user\r\nmsf5 auxiliary(scanner/smb/impacket/wmiexec) > run\r\n\r\n[*] Running for 192.168.159.149...\r\n[*] 192.168.159.149 - SMBv2.1 dialect used\r\n[-] 192.168.159.149 - 'utf8' codec can't decode byte 0xa8 in position 40: invalid start byte\r\n[*] Scanned 1 of 1 hosts (100% complete)\r\n[*] Auxiliary module execution completed", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/791", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/791/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/791/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/791/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/791", "id": 580378501, "node_id": "MDU6SXNzdWU1ODAzNzg1MDE=", "number": 791, "title": "smb3.1.1 does not seem to be supported", "user": {"login": "Lcys", "id": 8945364, "node_id": "MDQ6VXNlcjg5NDUzNjQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/8945364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lcys", "html_url": "https://github.com/Lcys", "followers_url": "https://api.github.com/users/Lcys/followers", "following_url": "https://api.github.com/users/Lcys/following{/other_user}", "gists_url": "https://api.github.com/users/Lcys/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lcys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lcys/subscriptions", "organizations_url": "https://api.github.com/users/Lcys/orgs", "repos_url": "https://api.github.com/users/Lcys/repos", "events_url": "https://api.github.com/users/Lcys/events{/privacy}", "received_events_url": "https://api.github.com/users/Lcys/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-13T05:21:48Z", "updated_at": "2020-03-13T19:04:27Z", "closed_at": "2020-03-13T19:03:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.20\r\nPython version:  3.7\r\nTarget OS:  Windows10 Build 18363\r\n\r\nTraceback (most recent call last):\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/nmb.py\", line 983, in non_polling_read\r\n    received = self._sock.recv(bytes_left)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/gevent/_socket3.py\", line 378, in recv\r\n    return _socket.socket.recv(self._sock, *args)\r\nConnectionResetError: [Errno 54] Connection reset by peer\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/Lcy/PycharmProjects/quake_vscan/quake_vscan/protocols/smb2.py\", line 64, in list_smb_dialects\r\n    timeout=5, preferredDialect=dialect)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/smbconnection.py\", line 77, in __init__\r\n    self.negotiateSession(preferredDialect)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/smbconnection.py\", line 128, in negotiateSession\r\n    self._sess_port, self._timeout)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/smb.py\", line 2427, in __init__\r\n    self.neg_session()\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/smb.py\", line 2642, in neg_session\r\n    smb = self.recvSMB()\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/smb.py\", line 2506, in recvSMB\r\n    r = self._sess.recv_packet(self.__timeout)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/nmb.py\", line 914, in recv_packet\r\n    data = self.__read(timeout)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/nmb.py\", line 996, in __read\r\n    data = self.read_function(4, timeout)\r\n  File \"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/impacket/nmb.py\", line 990, in non_polling_read\r\n    if ex[0] != errno.EINTR and ex[0] != errno.EAGAIN:\r\nTypeError: 'ConnectionResetError' object is not subscriptable\r\n\r\nPossible solution: https://github.com/nmap/nmap/blob/cd4da05e380367ffff204e919fdad51f26a899af/nselib/smb2.lua#L261", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/790", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/790/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/790/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/790/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/790", "id": 580326652, "node_id": "MDU6SXNzdWU1ODAzMjY2NTI=", "number": 790, "title": "Log records in ntlmrelayx", "user": {"login": "marevalo10", "id": 19642437, "node_id": "MDQ6VXNlcjE5NjQyNDM3", "avatar_url": "https://avatars1.githubusercontent.com/u/19642437?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marevalo10", "html_url": "https://github.com/marevalo10", "followers_url": "https://api.github.com/users/marevalo10/followers", "following_url": "https://api.github.com/users/marevalo10/following{/other_user}", "gists_url": "https://api.github.com/users/marevalo10/gists{/gist_id}", "starred_url": "https://api.github.com/users/marevalo10/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marevalo10/subscriptions", "organizations_url": "https://api.github.com/users/marevalo10/orgs", "repos_url": "https://api.github.com/users/marevalo10/repos", "events_url": "https://api.github.com/users/marevalo10/events{/privacy}", "received_events_url": "https://api.github.com/users/marevalo10/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-13T02:14:10Z", "updated_at": "2020-03-13T03:26:30Z", "closed_at": "2020-03-13T03:26:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.20\r\nPython version:  3.7.6\r\nTarget OS:  Linux Kali20 5.4.0\r\n\r\n### Debug Output With Command String  \r\nThis is the command I run:\r\npython3 /usr/share/doc/python3-impacket/examples/ntlmrelayx.py -tf SMBtarget.txt -c 'command'\r\n\r\n### PCAP  \r\nIf applicable, add a packet capture to help explain your problem.\r\n\r\n### Additional context  \r\nI used this command to conduct a test in a network pentest an some problems arise so I'm trying to get the logs and time of the events to figure out if the command execution caused the problem. Is there a way to get logs of the actions executed by ntlmrelayx?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/789", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/789/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/789/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/789/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/789", "id": 579152348, "node_id": "MDU6SXNzdWU1NzkxNTIzNDg=", "number": 789, "title": "Impacket Slack Workspace - JOIN US!", "user": {"login": "chenerlich", "id": 17673075, "node_id": "MDQ6VXNlcjE3NjczMDc1", "avatar_url": "https://avatars1.githubusercontent.com/u/17673075?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chenerlich", "html_url": "https://github.com/chenerlich", "followers_url": "https://api.github.com/users/chenerlich/followers", "following_url": "https://api.github.com/users/chenerlich/following{/other_user}", "gists_url": "https://api.github.com/users/chenerlich/gists{/gist_id}", "starred_url": "https://api.github.com/users/chenerlich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chenerlich/subscriptions", "organizations_url": "https://api.github.com/users/chenerlich/orgs", "repos_url": "https://api.github.com/users/chenerlich/repos", "events_url": "https://api.github.com/users/chenerlich/events{/privacy}", "received_events_url": "https://api.github.com/users/chenerlich/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-11T10:19:33Z", "updated_at": "2020-03-13T13:41:54Z", "closed_at": "2020-03-11T14:07:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi everyone,\r\n\r\nSince i'm using Impacket on a daily basis (so as other thousands of people and projects), I decided to start an Impacket Slack workspace to be used as a platform for asking questions, sharing helpful snippets, proposing new features and and more!\r\n\r\n\r\nI believe it can make our community even bigger and enrich this awesome project.\r\n\r\nYou are more than welcome to join!\r\nhttps://join.slack.com/t/impacket/shared_invite/zt-cieq209u-rx0aDugIErL_2Fh04NC78w\r\n\r\nChen.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/788", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/788/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/788/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/788/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/788", "id": 578390527, "node_id": "MDU6SXNzdWU1NzgzOTA1Mjc=", "number": 788, "title": "LDAPSearchError: Error in searchRequest -> referral: 0000202B", "user": {"login": "FuckAllWorld", "id": 42711299, "node_id": "MDQ6VXNlcjQyNzExMjk5", "avatar_url": "https://avatars2.githubusercontent.com/u/42711299?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FuckAllWorld", "html_url": "https://github.com/FuckAllWorld", "followers_url": "https://api.github.com/users/FuckAllWorld/followers", "following_url": "https://api.github.com/users/FuckAllWorld/following{/other_user}", "gists_url": "https://api.github.com/users/FuckAllWorld/gists{/gist_id}", "starred_url": "https://api.github.com/users/FuckAllWorld/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FuckAllWorld/subscriptions", "organizations_url": "https://api.github.com/users/FuckAllWorld/orgs", "repos_url": "https://api.github.com/users/FuckAllWorld/repos", "events_url": "https://api.github.com/users/FuckAllWorld/events{/privacy}", "received_events_url": "https://api.github.com/users/FuckAllWorld/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-03-10T07:38:59Z", "updated_at": "2020-03-10T07:49:04Z", "closed_at": "2020-03-10T07:49:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "python GetUserSPNs.py testlab/administrator -dc-ip 100.100.100.1 -debug\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"GetUserSPNs.py\", line 466, in <module>\r\n    executer.run()\r\n  File \"GetUserSPNs.py\", line 290, in run\r\n    sizeLimit=999)\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket-0.9.21.dev1+20200309.134159.0b46f19-py2.7.egg/impacket/ldap/ldap.py\", line 384, in search\r\n    answers=answers\r\nLDAPSearchError: Error in searchRequest -> referral: 0000202B: RefErr: DSID-031007F3, data 0, 1 access points\r\n\tref 1: 'testlab'\r\n\r\n[-] Error in searchRequest -> referral: 0000202B: RefErr: DSID-031007F3, data 0, 1 access points\r\n\tref 1: 'testlab'\r\n\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/787", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/787/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/787/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/787/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/787", "id": 577457286, "node_id": "MDU6SXNzdWU1Nzc0NTcyODY=", "number": 787, "title": "WMI PutInstance using impersonation level impersonate", "user": {"login": "tshmul", "id": 20788268, "node_id": "MDQ6VXNlcjIwNzg4MjY4", "avatar_url": "https://avatars2.githubusercontent.com/u/20788268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tshmul", "html_url": "https://github.com/tshmul", "followers_url": "https://api.github.com/users/tshmul/followers", "following_url": "https://api.github.com/users/tshmul/following{/other_user}", "gists_url": "https://api.github.com/users/tshmul/gists{/gist_id}", "starred_url": "https://api.github.com/users/tshmul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tshmul/subscriptions", "organizations_url": "https://api.github.com/users/tshmul/orgs", "repos_url": "https://api.github.com/users/tshmul/repos", "events_url": "https://api.github.com/users/tshmul/events{/privacy}", "received_events_url": "https://api.github.com/users/tshmul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 199974009, "node_id": "MDU6TGFiZWwxOTk5NzQwMDk=", "url": "https://api.github.com/repos/SecureAuthCorp/impacket/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 199974010, "node_id": "MDU6TGFiZWwxOTk5NzQwMTA=", "url": "https://api.github.com/repos/SecureAuthCorp/impacket/labels/help%20wanted", "name": "help wanted", "color": "159818", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-03-08T07:11:41Z", "updated_at": "2020-06-07T13:01:53Z", "closed_at": "2020-06-07T13:01:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.20\r\nPython version:  3.7.5\r\nTarget OS:  Windows\r\n\r\n### Debug Output With Command String  \r\n## Sample test script: ##\r\n```\r\nfrom impacket.dcerpc.v5.dcomrt import DCOMConnection\r\nfrom impacket.dcerpc.v5.dcom import wmi\r\nfrom impacket.dcerpc.v5.dtypes import NULL\r\n\r\nserver_name = 'server.domain.com'\r\nuser_name = 'user@domain.com'\r\npassword = '123456'\r\ndomain = 'domain.com'\r\nnamespace = '//./root/cimv2'\r\nwmi_class = 'class'\r\nnew_instance_name = 'mytestinstance'\r\n\r\nconnection = DCOMConnection(server_name, username=user_name, password=password, domain=domain, doKerberos=True, oxidResolver=True)\r\niInterface = connection.CoCreateInstanceEx(wmi.CLSID_WbemLevel1Login, wmi.IID_IWbemLevel1Login)\r\niWbemLevel1Login = wmi.IWbemLevel1Login(iInterface)\r\niWbemServices = iWbemLevel1Login.NTLMLogin(namespace, NULL, NULL)\r\nobj = iWbemServices.GetObject(wmi_class)[0]\r\nnew_instance = obj.SpawnInstance()\r\n\r\nnew_instance.Name = new_instance_name\r\ninstance = new_instance.marshalMe()\r\niWbemServices.PutInstance(instance)\r\n```\r\n\r\n## Error: ##\r\n    iWbemServices.PutInstance(instance)\r\n  File \"c:\\temp\\python-3.7.5-embed-amd64\\lib\\impacket\\dcerpc\\v5\\dcom\\wmi.py\", li\r\nne 2998, in PutInstance\r\n    resp = self.request(request, iid = self._iid, uuid = self.get_iPid())\r\n  File \"c:\\temp\\python-3.7.5-embed-amd64\\lib\\impacket\\dcerpc\\v5\\dcomrt.py\", line\r\n 1311, in request\r\n    resp = dce.request(req, uuid)\r\n  File \"c:\\temp\\python-3.7.5-embed-amd64\\lib\\impacket\\dcerpc\\v5\\rpcrt.py\", line\r\n857, in request\r\n    answer = self.recv()\r\n  File \"c:\\temp\\python-3.7.5-embed-amd64\\lib\\impacket\\dcerpc\\v5\\rpcrt.py\", line\r\n1328, in recv\r\n    raise DCERPCException('%s - %s' % (error_msg_short, error_msg_verbose))\r\nimpacket.dcerpc.v5.rpcrt.DCERPCException: E_FAIL - Unspecified error.\r\n\r\n### Additional context  ###\r\nI'm able to putInstance with wmic or wbemtest, and I saw I get a similar error when impersonation level set to delegate/anonymous\r\n\r\nI also used API monitor to monitor the API usages by wmic or wbemtest, and I saw them both using https://docs.microsoft.com/en-us/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket to set impersonation level.\r\n\r\nIs there any equivalent way to set the impersonation level to wbemservices?\r\n\r\nThanks.\r\nTomer\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/781", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/781/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/781/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/781/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/781", "id": 572330162, "node_id": "MDU6SXNzdWU1NzIzMzAxNjI=", "number": 781, "title": "Unexpected keyword argument 'randomize'", "user": {"login": "squid22", "id": 54685018, "node_id": "MDQ6VXNlcjU0Njg1MDE4", "avatar_url": "https://avatars1.githubusercontent.com/u/54685018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/squid22", "html_url": "https://github.com/squid22", "followers_url": "https://api.github.com/users/squid22/followers", "following_url": "https://api.github.com/users/squid22/following{/other_user}", "gists_url": "https://api.github.com/users/squid22/gists{/gist_id}", "starred_url": "https://api.github.com/users/squid22/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/squid22/subscriptions", "organizations_url": "https://api.github.com/users/squid22/orgs", "repos_url": "https://api.github.com/users/squid22/repos", "events_url": "https://api.github.com/users/squid22/events{/privacy}", "received_events_url": "https://api.github.com/users/squid22/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-27T20:11:21Z", "updated_at": "2020-02-28T15:53:41Z", "closed_at": "2020-02-28T15:53:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client SMB loaded..\r\n[*] Protocol Client SMTP loaded..\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client HTTPS loaded..\r\n[*] Running in relay mode to single host\r\nTraceback (most recent call last):\r\n  File \"ntlmrelayx.py\", line 332, in <module>\r\n    targetSystem = TargetsProcessor(singleTarget=options.target, protocolClients=PROTOCOL_CLIENTS, randomize=options.random)\r\nTypeError: __init__() got an unexpected keyword argument 'randomize'\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/779", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/779/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/779/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/779/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/779", "id": 568982418, "node_id": "MDU6SXNzdWU1Njg5ODI0MTg=", "number": 779, "title": "psexec.py TGS (silver) ticket issue", "user": {"login": "Q1984", "id": 50952023, "node_id": "MDQ6VXNlcjUwOTUyMDIz", "avatar_url": "https://avatars3.githubusercontent.com/u/50952023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Q1984", "html_url": "https://github.com/Q1984", "followers_url": "https://api.github.com/users/Q1984/followers", "following_url": "https://api.github.com/users/Q1984/following{/other_user}", "gists_url": "https://api.github.com/users/Q1984/gists{/gist_id}", "starred_url": "https://api.github.com/users/Q1984/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Q1984/subscriptions", "organizations_url": "https://api.github.com/users/Q1984/orgs", "repos_url": "https://api.github.com/users/Q1984/repos", "events_url": "https://api.github.com/users/Q1984/events{/privacy}", "received_events_url": "https://api.github.com/users/Q1984/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-02-21T14:18:09Z", "updated_at": "2020-07-31T20:32:57Z", "closed_at": "2020-03-05T21:05:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  Impacket v0.9.21-dev\r\nPython version:  2.7\r\nTarget OS:  kali\r\n\r\n(TGS generated by ticketer previously)\r\nklist: Ticket cache: FILE:admin.ccache\r\nDefault principal: admin@redacted.local\r\n\r\nValid starting       Expires              Service principal\r\n2020-02-21 15:07:08  2030-02-18 15:07:08  cifs/fserv.redacted.local@redacted.local\r\n\trenew until 2030-02-18 15:07:08\r\n\r\npsexec.py redacted.local/admin@fserv.redacted.local -k -n -debug\r\n\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\n[+] StringBinding ncacn_np:fserv.redacted.local[\\pipe\\svcctl]\r\n[+] Using Kerberos Cache: admin.ccache\r\n[+] Returning cached credential for CIFS/fserv.redacted.local@redacted.local\r\n[+] Using TGS from cache\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python2.7/dist-packages/impacket-0.9.21.dev0-py2.7.egg/EGG-INFO/scripts/psexec.py\", line 118, in doStuff\r\n  File \"build/bdist.linux-x86_64/egg/impacket/dcerpc/v5/rpcrt.py\", line 800, in connect\r\n    return self._transport.connect()\r\n  File \"build/bdist.linux-x86_64/egg/impacket/dcerpc/v5/transport.py\", line 410, in connect\r\n    TGS=self._TGS)\r\n  File \"build/bdist.linux-x86_64/egg/impacket/smbconnection.py\", line 348, in kerberosLogin\r\n    raise SessionError(e.get_error_code(), e.get_error_packet())\r\nSessionError: SMB SessionError: STATUS_MORE_PROCESSING_REQUIRED({Still Busy} The specified I/O request packet (IRP) cannot be disposed of because the I/O operation is not complete.)\r\n[-] SMB SessionError: STATUS_MORE_PROCESSING_REQUIRED({Still Busy} The specified I/O request packet (IRP) cannot be disposed of because the I/O operation is not complete.)\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/776", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/776/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/776/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/776/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/776", "id": 567628240, "node_id": "MDU6SXNzdWU1Njc2MjgyNDA=", "number": 776, "title": "problem when starting exe in c: \\ windows", "user": {"login": "rafaelgov95", "id": 14832467, "node_id": "MDQ6VXNlcjE0ODMyNDY3", "avatar_url": "https://avatars3.githubusercontent.com/u/14832467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rafaelgov95", "html_url": "https://github.com/rafaelgov95", "followers_url": "https://api.github.com/users/rafaelgov95/followers", "following_url": "https://api.github.com/users/rafaelgov95/following{/other_user}", "gists_url": "https://api.github.com/users/rafaelgov95/gists{/gist_id}", "starred_url": "https://api.github.com/users/rafaelgov95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rafaelgov95/subscriptions", "organizations_url": "https://api.github.com/users/rafaelgov95/orgs", "repos_url": "https://api.github.com/users/rafaelgov95/repos", "events_url": "https://api.github.com/users/rafaelgov95/events{/privacy}", "received_events_url": "https://api.github.com/users/rafaelgov95/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-19T14:57:39Z", "updated_at": "2020-02-20T21:41:40Z", "closed_at": "2020-02-20T18:46:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.20\r\nPython version:  3.7\r\nTarget OS:  Arch Linux\r\n\r\n### BUG\r\nI need to run PsExec to upload the exe, not in c: \\ windoows as usual, I need it installed in% Temp%. PsExec Tools works, when trying to use this from the impacket it creates in C: \\ windows and my kaspersky is blocking it! Need help!\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/774", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/774/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/774/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/774/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/774", "id": 567537213, "node_id": "MDU6SXNzdWU1Njc1MzcyMTM=", "number": 774, "title": "Line creating error on examples/X.py files", "user": {"login": "Etienne-Lebrard", "id": 36295807, "node_id": "MDQ6VXNlcjM2Mjk1ODA3", "avatar_url": "https://avatars2.githubusercontent.com/u/36295807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Etienne-Lebrard", "html_url": "https://github.com/Etienne-Lebrard", "followers_url": "https://api.github.com/users/Etienne-Lebrard/followers", "following_url": "https://api.github.com/users/Etienne-Lebrard/following{/other_user}", "gists_url": "https://api.github.com/users/Etienne-Lebrard/gists{/gist_id}", "starred_url": "https://api.github.com/users/Etienne-Lebrard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Etienne-Lebrard/subscriptions", "organizations_url": "https://api.github.com/users/Etienne-Lebrard/orgs", "repos_url": "https://api.github.com/users/Etienne-Lebrard/repos", "events_url": "https://api.github.com/users/Etienne-Lebrard/events{/privacy}", "received_events_url": "https://api.github.com/users/Etienne-Lebrard/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-19T12:30:47Z", "updated_at": "2020-02-19T12:34:28Z", "closed_at": "2020-02-19T12:34:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.20\r\nPython version:  3.7.3\r\nTarget OS:  MacOS\r\n\r\n### Debug Output With Command String  \r\npython3 wmiexec.py domain/administrator:password@X.X.X.X -debug\r\n```\r\npython3 wmiexec.py domain/administrator:password@X.X.X.X -debug\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n\r\nTraceback (most recent call last):\r\n  File \"wmiexec.py\", line 373, in <module>\r\n    logger.init(options.ts)\r\nTypeError: init() takes 0 positional arguments but 1 was given  \r\n```\r\n\r\n### Additional context  \r\nI got this error on many (if it's not all of them) of the examples/X.py files.\r\nResolved by adding comment to the ligne. ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/763", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/763/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/763/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/763/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/763", "id": 560525312, "node_id": "MDU6SXNzdWU1NjA1MjUzMTI=", "number": 763, "title": "GetADUsers.py - TypeError: init() takes no arguments", "user": {"login": "Chaplin-Sec", "id": 53953368, "node_id": "MDQ6VXNlcjUzOTUzMzY4", "avatar_url": "https://avatars2.githubusercontent.com/u/53953368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Chaplin-Sec", "html_url": "https://github.com/Chaplin-Sec", "followers_url": "https://api.github.com/users/Chaplin-Sec/followers", "following_url": "https://api.github.com/users/Chaplin-Sec/following{/other_user}", "gists_url": "https://api.github.com/users/Chaplin-Sec/gists{/gist_id}", "starred_url": "https://api.github.com/users/Chaplin-Sec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Chaplin-Sec/subscriptions", "organizations_url": "https://api.github.com/users/Chaplin-Sec/orgs", "repos_url": "https://api.github.com/users/Chaplin-Sec/repos", "events_url": "https://api.github.com/users/Chaplin-Sec/events{/privacy}", "received_events_url": "https://api.github.com/users/Chaplin-Sec/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-05T17:36:42Z", "updated_at": "2020-02-05T18:41:01Z", "closed_at": "2020-02-05T17:40:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Configuration**\r\nOS: Kali 2020.1\r\nPython Version: 3.7.6\r\n\r\nI keep getting errors when trying to run GetADUsers.py against a box.\r\n\r\nI am typing the following in my terminal:\r\n\r\n`./GetADUsers.py -all domain\\useraccount:password -dc-ip 1.1.1.1`\r\n\r\nand\r\n\r\n`./GetADUsers.py -all domain\\user -dc-ip 1.1.1.1`\r\n\r\nI receive the following output:\r\n\r\n`Traceback (most recent call last):\r\n     File \"./GetADUsers.py\", line 213, in <module>\r\n     logger.init(options.ts)\r\nTypeError: init() takes no arguments (1 given)\r\n`\r\n\r\nI have triple checked the documentation and seen others use it on blogs and videos but my script fails to work and I have no idea why, am I being idiot or is there something wrong with the tool?\r\n\r\nI am currently running Kali 2020.1\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/760", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/760/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/760/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/760/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/760", "id": 559376863, "node_id": "MDU6SXNzdWU1NTkzNzY4NjM=", "number": 760, "title": "Version information is often ambiguous/un-updated", "user": {"login": "jsherwood0", "id": 185633, "node_id": "MDQ6VXNlcjE4NTYzMw==", "avatar_url": "https://avatars1.githubusercontent.com/u/185633?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsherwood0", "html_url": "https://github.com/jsherwood0", "followers_url": "https://api.github.com/users/jsherwood0/followers", "following_url": "https://api.github.com/users/jsherwood0/following{/other_user}", "gists_url": "https://api.github.com/users/jsherwood0/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsherwood0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsherwood0/subscriptions", "organizations_url": "https://api.github.com/users/jsherwood0/orgs", "repos_url": "https://api.github.com/users/jsherwood0/repos", "events_url": "https://api.github.com/users/jsherwood0/events{/privacy}", "received_events_url": "https://api.github.com/users/jsherwood0/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-03T22:37:21Z", "updated_at": "2020-03-09T20:43:41Z", "closed_at": "2020-03-09T20:43:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.9.21-dev\r\nPython version:  v2.7.16+ and v3.7.4\r\nTarget OS:  Kali Linux x64 2019.3\r\n\r\n### Debug Output With Command String  \r\nN/A\r\n\r\n### PCAP  \r\nN/A\r\n\r\n### Additional context  \r\nSince the version number is not frequently updated, we've often run into the case where two versions (installed and git pull) do not have unambiguously different version numbers.  I will submit a pull request that fixes this by doing the following:\r\n* Single source the version number so that the version in setup.py is used for the banner\r\n* Standardize on Symantic + Pre-Release + Local versioning (see https://bit.ly/36QdfJX )\r\n* Make setup.py detect whether it is in a git directory, and if so set the Local version to a date/time stamp corresponding to the last commit timestamp\r\n* If not in a git directory, setup.py will not utilize the Local portion of the versioning\r\n\r\nThis ensures that no two git pulls will display the same version in the banner.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/759", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/759/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/759/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/759/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/759", "id": 558968162, "node_id": "MDU6SXNzdWU1NTg5NjgxNjI=", "number": 759, "title": "ValueError: chr() arg not in range(256)", "user": {"login": "Onefivefournine", "id": 18087962, "node_id": "MDQ6VXNlcjE4MDg3OTYy", "avatar_url": "https://avatars1.githubusercontent.com/u/18087962?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Onefivefournine", "html_url": "https://github.com/Onefivefournine", "followers_url": "https://api.github.com/users/Onefivefournine/followers", "following_url": "https://api.github.com/users/Onefivefournine/following{/other_user}", "gists_url": "https://api.github.com/users/Onefivefournine/gists{/gist_id}", "starred_url": "https://api.github.com/users/Onefivefournine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Onefivefournine/subscriptions", "organizations_url": "https://api.github.com/users/Onefivefournine/orgs", "repos_url": "https://api.github.com/users/Onefivefournine/repos", "events_url": "https://api.github.com/users/Onefivefournine/events{/privacy}", "received_events_url": "https://api.github.com/users/Onefivefournine/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-03T09:54:51Z", "updated_at": "2020-03-02T14:31:46Z", "closed_at": "2020-03-02T14:31:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.21.dev0\r\nPython version:  2.7.17\r\nTarget OS:  Ubuntu 18.04\r\n\r\n### Debug Output With Command String  \r\n./secretsdump.py -debug -just-dc-ntlm domain/user:password@127.0.0.1  \r\n```\r\n[+] Entering NTDSHashes.__decryptHash\r\n[+] ValueError exception on [67, 78, 61, 208, 159, 208, 190, 208, 187, 209, 140, 208, 183, 208, 190, 208, 178, 208, 176, 209, 130, 208, 181, 208, 187, 209, 140, 44, 79, 85, 61, 208, 146, 208, 189, 208, 181, 209, 136, 208, 189, 208, 184, 208, 181, 32, 208, 191, 208, 190, 208, 187, 209, 140, 208, 183, 208, 190, 208, 178, 208, 176, 209, 130, 208, 181, 208, 187, 208, 184, 44, 79, 85, 61, 208, 154, 208, 190, 208, 188, 208, 191, 208, 176, 208, 189, 208, 184, 209, 143, 44, 68, 67, 61, 100, 111, 109, 97, 105, 110, 44, 68, 67, 61, 104, 111, 115, 116, 44, 68, 67, 61, 99, 111, 109]\r\n[+] Switching to unichr()\r\n[-] Error while processing user!\r\n[+] Exception\r\nTraceback (most recent call last):\r\n  File \"/home/user/.local/lib/python2.7/site-packages/impacket/examples/secretsdump.py\", line 2489, in dump\r\n    hashesOutputFile)\r\n  File \"/home/user/.local/lib/python2.7/site-packages/impacket/examples/secretsdump.py\", line 2167, in __decryptHash\r\n    LOG.debug('Decrypting hash for user: %s' % record['pmsgOut'][replyVersion]['pNC']['StringName'][:-1])\r\n  File \"/home/user/.local/lib/python2.7/site-packages/impacket/dcerpc/v5/ndr.py\", line 136, in __getitem__\r\n    return self.fields[key]['Data']\r\n  File \"/home/user/.local/lib/python2.7/site-packages/impacket/dcerpc/v5/drsuapi.py\", line 616, in __getitem__\r\n    return ''.join([chr(i) for i in self.fields[key]])\r\nValueError: chr() arg not in range(256)\r\n[-] chr() arg not in range(256)\r\n```\r\n\r\n### Additional context  \r\nWhen dumping non-latin characters parser should switch to `unichr` instead of `chr`, but there is the same return statement as in `try` scope:\r\n`impacket/dcerpc/v5/drsuapi.py` lines 611 through 616:\r\n```python\r\ntry:\r\n    return ''.join([chr(i) for i in self.fields[key]])\r\nexcept ValueError:\r\n    # We might have Unicode chars in here, let's use unichr instead\r\n    LOG.debug('ValueError exception on %s' % self.fields[key])\r\n    LOG.debug('Switching to unichr()')\r\n    return ''.join([chr(i) for i in self.fields[key]])\r\n```\r\n\r\nReplace `chr` to `unichr` at line 616 and all works fine!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/757", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/757/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/757/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/757/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/757", "id": 555230171, "node_id": "MDU6SXNzdWU1NTUyMzAxNzE=", "number": 757, "title": "--add-computer flag needed with --delegate-access", "user": {"login": "fsacer", "id": 2059352, "node_id": "MDQ6VXNlcjIwNTkzNTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/2059352?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fsacer", "html_url": "https://github.com/fsacer", "followers_url": "https://api.github.com/users/fsacer/followers", "following_url": "https://api.github.com/users/fsacer/following{/other_user}", "gists_url": "https://api.github.com/users/fsacer/gists{/gist_id}", "starred_url": "https://api.github.com/users/fsacer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fsacer/subscriptions", "organizations_url": "https://api.github.com/users/fsacer/orgs", "repos_url": "https://api.github.com/users/fsacer/repos", "events_url": "https://api.github.com/users/fsacer/events{/privacy}", "received_events_url": "https://api.github.com/users/fsacer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 199974009, "node_id": "MDU6TGFiZWwxOTk5NzQwMDk=", "url": "https://api.github.com/repos/SecureAuthCorp/impacket/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-26T13:41:54Z", "updated_at": "2020-02-14T14:16:27Z", "closed_at": "2020-02-14T14:16:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  Impacket v0.9.21-dev\r\nPython version:  python2/3\r\nTarget OS:  kali\r\n\r\n### Debug Output With Command String  \r\nFollowing the guide https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/ and command `ntlmrelayx.py -t ldaps://icorp-dc.internal.corp -wh attacker-wpad --delegate-access` I got an error:\r\n\r\n[*] Enumerating relayed user's privileges. This may take a while on large domains\r\nException in thread Thread-6:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.7/threading.py\", line 926, in _bootstrap_inner\r\n    self.run()\r\n  File \"/usr/local/lib/python3.7/dist-packages/impacket-0.9.21.dev0-py3.7.egg/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 583, in run\r\n    self.delegateAttack(self.config.escalateuser, self.username, domainDumper, self.config.sid)\r\n  File \"/usr/local/lib/python3.7/dist-packages/impacket-0.9.21.dev0-py3.7.egg/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 197, in delegateAttack\r\n    usersam = self.addComputer('CN=Computers,%s' % domainDumper.root, domainDumper)\r\n  File \"/usr/local/lib/python3.7/dist-packages/impacket-0.9.21.dev0-py3.7.egg/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 95, in addComputer\r\n    newComputer = computerName if computerName.endswith('$') else computerName + '$'\r\nAttributeError: 'NoneType' object has no attribute 'endswith'\r\n\r\nBy adding --add-computer flag the command worked `ntlmrelayx.py -t ldaps://icorp-dc.internal.corp  --delegate-access -wh attacker-wpad --add-computer`.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/756", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/756/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/756/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/756/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/756", "id": 555155668, "node_id": "MDU6SXNzdWU1NTUxNTU2Njg=", "number": 756, "title": "logger.init(options.ts) : init() takes no arguments", "user": {"login": "thomaslc66", "id": 9827392, "node_id": "MDQ6VXNlcjk4MjczOTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/9827392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomaslc66", "html_url": "https://github.com/thomaslc66", "followers_url": "https://api.github.com/users/thomaslc66/followers", "following_url": "https://api.github.com/users/thomaslc66/following{/other_user}", "gists_url": "https://api.github.com/users/thomaslc66/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomaslc66/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomaslc66/subscriptions", "organizations_url": "https://api.github.com/users/thomaslc66/orgs", "repos_url": "https://api.github.com/users/thomaslc66/repos", "events_url": "https://api.github.com/users/thomaslc66/events{/privacy}", "received_events_url": "https://api.github.com/users/thomaslc66/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-25T23:55:51Z", "updated_at": "2020-01-26T17:21:28Z", "closed_at": "2020-01-26T17:21:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  \r\nPython version:  \r\nTarget OS:  \r\n\r\n### Debug Output With Command String  \r\ni.e.  \r\nsamrdump 127.0.0.1\r\n// and all other script with this logger.init() line  \r\n```\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n\r\nTraceback (most recent call last):\r\n  File \"samrdump.py\", line 234, in <module>\r\n    logger.init(options.ts)\r\nTypeError: init() takes no arguments (1 given)\r\n\r\n```\r\n\r\n### PCAP  \r\nIf applicable, add a packet capture to help explain your problem.\r\n\r\n### Additional context  \r\nSpace for additional context, investigative results, suspected issue.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/755", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/755/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/755/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/755/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/755", "id": 555091158, "node_id": "MDU6SXNzdWU1NTUwOTExNTg=", "number": 755, "title": "Parsing NDRUniConformantArray", "user": {"login": "Gilks", "id": 11075149, "node_id": "MDQ6VXNlcjExMDc1MTQ5", "avatar_url": "https://avatars1.githubusercontent.com/u/11075149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Gilks", "html_url": "https://github.com/Gilks", "followers_url": "https://api.github.com/users/Gilks/followers", "following_url": "https://api.github.com/users/Gilks/following{/other_user}", "gists_url": "https://api.github.com/users/Gilks/gists{/gist_id}", "starred_url": "https://api.github.com/users/Gilks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Gilks/subscriptions", "organizations_url": "https://api.github.com/users/Gilks/orgs", "repos_url": "https://api.github.com/users/Gilks/repos", "events_url": "https://api.github.com/users/Gilks/events{/privacy}", "received_events_url": "https://api.github.com/users/Gilks/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-25T14:24:10Z", "updated_at": "2020-01-27T23:40:08Z", "closed_at": "2020-01-27T23:40:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm looking at reading event logs remotely. The test cases use the following code, which perfectly retrieves the event log from your target.\r\n\r\n```\r\nrequest = even.ElfrReadELW()\r\nrequest['LogHandle'] = resp['LogHandle']\r\nrequest['ReadFlags'] = even.EVENTLOG_SEQUENTIAL_READ | even.EVENTLOG_FORWARDS_READ\r\nrequest['RecordOffset'] = 0\r\nrequest['NumberOfBytesToRead'] = even.MAX_BATCH_BUFF\r\nresp = dce.request(request)\r\n```\r\n\r\nThen when you perform a `resp.dump()` you will see the raw NDRUniConformantArray printed to the screen. The information that is returned needs to be parsed in order to make use of it.\r\n\r\nIs there a way to parse NDRUniConformantArray's in impacket? If so, is there an example somewhere in the code base? I've been looking around but can't seem to find any examples.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/754", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/754/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/754/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/754/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/754", "id": 555011459, "node_id": "MDU6SXNzdWU1NTUwMTE0NTk=", "number": 754, "title": "TypeError: init() takes no arguments (1 given)", "user": {"login": "InfoSecMalang", "id": 6963584, "node_id": "MDQ6VXNlcjY5NjM1ODQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6963584?v=4", "gravatar_id": "", "url": "https://api.github.com/users/InfoSecMalang", "html_url": "https://github.com/InfoSecMalang", "followers_url": "https://api.github.com/users/InfoSecMalang/followers", "following_url": "https://api.github.com/users/InfoSecMalang/following{/other_user}", "gists_url": "https://api.github.com/users/InfoSecMalang/gists{/gist_id}", "starred_url": "https://api.github.com/users/InfoSecMalang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/InfoSecMalang/subscriptions", "organizations_url": "https://api.github.com/users/InfoSecMalang/orgs", "repos_url": "https://api.github.com/users/InfoSecMalang/repos", "events_url": "https://api.github.com/users/InfoSecMalang/events{/privacy}", "received_events_url": "https://api.github.com/users/InfoSecMalang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-25T00:11:41Z", "updated_at": "2020-01-30T17:58:36Z", "closed_at": "2020-01-30T17:58:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "After the git pull i am receiving this error \"TypeError: init() takes no arguments (1 given)\" for all scripts. ./scriptname.py -h runs fine.\r\n\r\nI cloned the repo from git and not installed through apt.\r\n\r\nany suggestions? ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/753", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/753/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/753/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/753/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/753", "id": 552935180, "node_id": "MDU6SXNzdWU1NTI5MzUxODA=", "number": 753, "title": "Pipe not ready, aborting", "user": {"login": "rafaelgov95", "id": 14832467, "node_id": "MDQ6VXNlcjE0ODMyNDY3", "avatar_url": "https://avatars3.githubusercontent.com/u/14832467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rafaelgov95", "html_url": "https://github.com/rafaelgov95", "followers_url": "https://api.github.com/users/rafaelgov95/followers", "following_url": "https://api.github.com/users/rafaelgov95/following{/other_user}", "gists_url": "https://api.github.com/users/rafaelgov95/gists{/gist_id}", "starred_url": "https://api.github.com/users/rafaelgov95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rafaelgov95/subscriptions", "organizations_url": "https://api.github.com/users/rafaelgov95/orgs", "repos_url": "https://api.github.com/users/rafaelgov95/repos", "events_url": "https://api.github.com/users/rafaelgov95/events{/privacy}", "received_events_url": "https://api.github.com/users/rafaelgov95/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-21T15:05:29Z", "updated_at": "2020-01-23T12:45:29Z", "closed_at": "2020-01-23T12:45:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.9.20\r\nPython version:  3.7 and 2.7\r\nTarget OS:  Windows 10\r\npsexec.py -debug rafael.viana@172.23.64.74\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n\r\nPassword:\r\n[+] StringBinding ncacn_np:172.23.64.74[\\pipe\\svcctl]\r\n[*] Requesting shares on 172.23.64.74.....\r\n[*] Found writable share ADMIN$\r\n[*] Uploading file MPaaQMYz.exe\r\n[*] Opening SVCManager on 172.23.64.74.....\r\n[*] Creating service NtYm on 172.23.64.74.....\r\n[*] Starting service NtYm.....\r\nTraceback (most recent call last):\r\n  File \"/home/rafael/.local/bin/psexec.py\", line 156, in doStuff\r\n    fid_main = self.openPipe(s,tid,r'\\RemCom_communicaton',0x12019f)\r\n  File \"/home/rafael/.local/bin/psexec.py\", line 106, in openPipe\r\n    raise Exception('Pipe not ready, aborting')\r\nException: Pipe not ready, aborting\r\n[+] Pipe not ready, aborting\r\n[*] Opening SVCManager on 172.23.64.74.....\r\n[*] Stopping service NtYm.....\r\n[*] Removing service NtYm.....\r\n[*] Removing file MPaaQMYz.exe.....\r\n[-] Error performing the uninstallation, cleaning up\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/744", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/744/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/744/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/744/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/744", "id": 548057132, "node_id": "MDU6SXNzdWU1NDgwNTcxMzI=", "number": 744, "title": "ntlmrelayx.py: [-] Exception in HTTP request handler: '>=' not supported between instances of 'int' and 'NoneType' ", "user": {"login": "AdrianVollmer", "id": 26064811, "node_id": "MDQ6VXNlcjI2MDY0ODEx", "avatar_url": "https://avatars2.githubusercontent.com/u/26064811?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdrianVollmer", "html_url": "https://github.com/AdrianVollmer", "followers_url": "https://api.github.com/users/AdrianVollmer/followers", "following_url": "https://api.github.com/users/AdrianVollmer/following{/other_user}", "gists_url": "https://api.github.com/users/AdrianVollmer/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdrianVollmer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdrianVollmer/subscriptions", "organizations_url": "https://api.github.com/users/AdrianVollmer/orgs", "repos_url": "https://api.github.com/users/AdrianVollmer/repos", "events_url": "https://api.github.com/users/AdrianVollmer/events{/privacy}", "received_events_url": "https://api.github.com/users/AdrianVollmer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-10T12:37:54Z", "updated_at": "2020-01-10T14:18:26Z", "closed_at": "2020-01-10T14:18:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.9.20\r\nPython version:  3.7.4+\r\nTarget OS:  Kali Rolling\r\n\r\n### Debug Output With Command String  \r\n```\r\n$ ~/.local/bin/ntlmrelayx.py  -t ldaps://dc01.pentest.lab -wh attacker-wpad --delegate-access -debug                                                                                           \r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation                                                                                                                                       \r\n                                                                                                                                                                                               \r\n[*] Protocol Client LDAP loaded..                                                                                                                                                              \r\n[*] Protocol Client LDAPS loaded..                                                                                                                                                             \r\n[*] Protocol Client SMTP loaded..                                                                                                                                                              \r\n[*] Protocol Client MSSQL loaded..                                                                                                                                                             \r\n[*] Protocol Client SMB loaded..                                                                                                                                                               \r\n[*] Protocol Client IMAPS loaded..                                                                                                                                                             \r\n[*] Protocol Client IMAP loaded..                                                                                                                                                              \r\n[*] Protocol Client HTTP loaded..                                                                                                                                                              \r\n[*] Protocol Client HTTPS loaded..                                                                                                                                                             \r\n[+] Protocol Attack MSSQL loaded..                                                                                                                                                             \r\n[+] Protocol Attack HTTP loaded..                                                                                                                                                              \r\n[+] Protocol Attack HTTPS loaded..                                                                                                                                                             \r\n[+] Protocol Attack SMB loaded..                                                                                                                                                               \r\n[+] Protocol Attack IMAP loaded..                                                                                                                                                              \r\n[+] Protocol Attack IMAPS loaded..                                                                                                                                                             \r\n[+] Protocol Attack LDAP loaded..                                                                                                                                                              \r\n[+] Protocol Attack LDAPS loaded..                                                                                                                                                             \r\n[*] Running in relay mode to single host                                                                                                                                                       \r\n[*] Setting up SMB Server                                                                                                                                                                      \r\n[*] Setting up HTTP Server                                                                                                                                                                     \r\n                                                                                                                                                                                               \r\n[*] Servers started, waiting for connections                                                                                                                                                   \r\n[*] HTTPD: Received connection from 10.40.1.9, attacking target ldaps://dc01.pentest.lab                                                                                                       \r\n[*] HTTPD: Client requested path: /wpad.dat                                                                                                                                                    \r\n[+] Exception:                                                                                                                                                                                 \r\nTraceback (most recent call last):                                                                                                                                                             \r\n  File \"/home/avollmer/.local/lib/python3.7/site-packages/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 72, in handle_one_request                                             \r\n    http.server.SimpleHTTPRequestHandler.handle_one_request(self)                                                                                                                              \r\n  File \"/usr/lib/python3.7/http/server.py\", line 414, in handle_one_request                                                                                                                    \r\n    method()                                                                                                                                                                                   \r\n  File \"/home/avollmer/.local/lib/python3.7/site-packages/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 226, in do_GET                                                        \r\n    if self.path.lower() == '/wpad.dat' and self.server.config.serve_wpad and self.should_serve_wpad(self.client_address[0]):                                                                  \r\n  File \"/home/avollmer/.local/lib/python3.7/site-packages/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 104, in should_serve_wpad                                             \r\n    if num >= self.server.config.wpad_auth_num:                                                                                                                                                \r\nTypeError: '>=' not supported between instances of 'int' and 'NoneType'                                                                                                                        \r\n[-] Exception in HTTP request handler: '>=' not supported between instances of 'int' and 'NoneType' \r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/743", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/743/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/743/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/743/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/743", "id": 547763235, "node_id": "MDU6SXNzdWU1NDc3NjMyMzU=", "number": 743, "title": "TypeError: setLDAPOptions() takes exactly 5 arguments (8 given)", "user": {"login": "M4ximuss", "id": 46607768, "node_id": "MDQ6VXNlcjQ2NjA3NzY4", "avatar_url": "https://avatars0.githubusercontent.com/u/46607768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/M4ximuss", "html_url": "https://github.com/M4ximuss", "followers_url": "https://api.github.com/users/M4ximuss/followers", "following_url": "https://api.github.com/users/M4ximuss/following{/other_user}", "gists_url": "https://api.github.com/users/M4ximuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/M4ximuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/M4ximuss/subscriptions", "organizations_url": "https://api.github.com/users/M4ximuss/orgs", "repos_url": "https://api.github.com/users/M4ximuss/repos", "events_url": "https://api.github.com/users/M4ximuss/events{/privacy}", "received_events_url": "https://api.github.com/users/M4ximuss/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-09T22:37:17Z", "updated_at": "2020-01-30T18:02:07Z", "closed_at": "2020-01-30T18:02:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  it should be 0.9.20 as thats the latest version and i did a git clone https://github.com/SecureAuthCorp/impacket.git but for whatever reason the changelog (in the root directory) says 0.9.15 (see https://github.com/SecureAuthCorp/impacket/blob/master/ChangeLog)\r\nPython version:  2.7.17\r\nTarget OS:  kali linux\r\n\r\n### Debug Output With Command String  \r\n\r\n```\r\n sudo ./ntlmrelayx.py -debug\r\nTraceback (most recent call last):\r\n  File \"./ntlmrelayx.py\", line 357, in <module>\r\n    c = start_servers(options, threads)\r\n  File \"./ntlmrelayx.py\", line 148, in start_servers\r\n    c.setLDAPOptions(options.no_dump, options.no_da, options.no_acl, options.no_validate_privs, options.escalate_user, options.add_computer, options.delegate_access)\r\nTypeError: setLDAPOptions() takes exactly 5 arguments (8 given)\r\n\r\n```\r\n\r\n### Additional context  \r\nExact steps taken:\r\n1. git clone https://github.com/SecureAuthCorp/impacket.git\r\n2. cd impacket\r\n3. pip install .\r\n4. cd examples\r\n5. sudo ./ntlmrelayx.py\r\n\r\nalso tried with a valid command such as \r\n`sudo ./ntlmrelayx.py -t ldap://dchere --delegate-access --escalate-user MACHINEHERE$ --serve-image ./test.jpg`\r\nbut getting same error.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/742", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/742/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/742/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/742/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/742", "id": 547014922, "node_id": "MDU6SXNzdWU1NDcwMTQ5MjI=", "number": 742, "title": "Loosen requirement on ldap3 version", "user": {"login": "exploide", "id": 5670236, "node_id": "MDQ6VXNlcjU2NzAyMzY=", "avatar_url": "https://avatars0.githubusercontent.com/u/5670236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/exploide", "html_url": "https://github.com/exploide", "followers_url": "https://api.github.com/users/exploide/followers", "following_url": "https://api.github.com/users/exploide/following{/other_user}", "gists_url": "https://api.github.com/users/exploide/gists{/gist_id}", "starred_url": "https://api.github.com/users/exploide/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/exploide/subscriptions", "organizations_url": "https://api.github.com/users/exploide/orgs", "repos_url": "https://api.github.com/users/exploide/repos", "events_url": "https://api.github.com/users/exploide/events{/privacy}", "received_events_url": "https://api.github.com/users/exploide/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-08T17:52:38Z", "updated_at": "2020-01-30T18:02:46Z", "closed_at": "2020-01-30T18:02:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "It seems impacket inherited the requirement on the ldap3 dependency from ldapdomaindump. Hence it is pinned to `ldap3==2.5.1`.\r\n\r\nThis causes conflicts in some package managers which already contain newer versions.\r\n\r\nSince ldap3 v2.6.1 contains fixes for the compatibility issues and the recently published ldapdomaindump v0.6.2 is fine with modern ldap3 versions again, I propose to also loosen the requirements here for impacket.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/736", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/736/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/736/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/736/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/736", "id": 544649040, "node_id": "MDU6SXNzdWU1NDQ2NDkwNDA=", "number": 736, "title": "RRP Bug with Python 3 and certain packed value types", "user": {"login": "MaxNad", "id": 3847037, "node_id": "MDQ6VXNlcjM4NDcwMzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3847037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MaxNad", "html_url": "https://github.com/MaxNad", "followers_url": "https://api.github.com/users/MaxNad/followers", "following_url": "https://api.github.com/users/MaxNad/following{/other_user}", "gists_url": "https://api.github.com/users/MaxNad/gists{/gist_id}", "starred_url": "https://api.github.com/users/MaxNad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MaxNad/subscriptions", "organizations_url": "https://api.github.com/users/MaxNad/orgs", "repos_url": "https://api.github.com/users/MaxNad/repos", "events_url": "https://api.github.com/users/MaxNad/events{/privacy}", "received_events_url": "https://api.github.com/users/MaxNad/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-02T16:28:19Z", "updated_at": "2020-01-10T16:36:45Z", "closed_at": "2020-01-10T16:36:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  0.9.21-dev\r\nPython version:  Python 3.8.1 (default, Dec 21 2019, 20:57:38)\r\nTarget OS:  Linux 5.4.2-arch1-1\r\n\r\n### Debug Output With Command String  \r\n```\r\n\u256d\u2500netprint at ricoh in ~/dev/impacket/examples on master\r\n\u2570\u2500\u00b1 python reg.py -debug ./IEUser@192.168.151.139 query -keyName \"HKU\\\\Environment\" -v TEMP\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\nPassword:\r\n[*] Service RemoteRegistry is in stopped state\r\n[*] Starting service RemoteRegistry\r\nHKU\\Environment\r\n[-] sequence item 0: expected str instance, bytes found\r\n[*] Stopping service RemoteRegistry\r\n```\r\n\r\n### Additional context  \r\nThe commit #596 ported the rrp.py class to Python 3. However, some bytes to string conversions were missed and this causes problems when certain key types are encountered when using Python 3.\r\n\r\n```\r\ndef unpackValue(valueType, value):\r\n    if valueType == REG_DWORD:\r\n        retData = unpack('<L', b''.join(value))[0]\r\n    elif valueType == REG_DWORD_BIG_ENDIAN:\r\n        retData = unpack('>L', ''.join(value))[0]\r\n    elif valueType == REG_EXPAND_SZ:\r\n        retData = ''.join(value).decode('utf-16le')\r\n    elif valueType == REG_MULTI_SZ:\r\n        retData = ''.join(value).decode('utf-16le')\r\n    elif valueType == REG_QWORD:\r\n        retData = unpack('<Q', ''.join(value))[0]\r\n    elif valueType == REG_QWORD_LITTLE_ENDIAN:\r\n        retData = unpack('>Q', ''.join(value))[0]\r\n    elif valueType == REG_SZ:\r\n        retData = b''.join(value).decode('utf-16le')\r\n    else:\r\n        retData = b''.join(value)\r\n\r\n    return retData\r\n```\r\n\r\nIf the strings are converted to bytes, the problem is fixed:\r\n```\r\n\u256d\u2500netprint at ricoh in ~/dev/impacket/examples on master\u2718\r\n\u2570\u2500\u00b1 python reg.py -debug ./IEUser@192.168.151.139 query -keyName \"HKU\\\\Environment\" -v TEMP\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\nPassword:\r\n[*] Service RemoteRegistry is in stopped state\r\n[*] Starting service RemoteRegistry\r\nHKU\\Environment\r\n\tTEMP\tREG_EXPAND_SZ\t %USERPROFILE%\\AppData\\Local\\Temp\r\n[*] Stopping service RemoteRegistry\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/735", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/735/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/735/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/735/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/735", "id": 544396735, "node_id": "MDU6SXNzdWU1NDQzOTY3MzU=", "number": 735, "title": "Ntlmrelayx + Printerbug to exploit RBCD", "user": {"login": "ferreirasc", "id": 4137088, "node_id": "MDQ6VXNlcjQxMzcwODg=", "avatar_url": "https://avatars3.githubusercontent.com/u/4137088?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ferreirasc", "html_url": "https://github.com/ferreirasc", "followers_url": "https://api.github.com/users/ferreirasc/followers", "following_url": "https://api.github.com/users/ferreirasc/following{/other_user}", "gists_url": "https://api.github.com/users/ferreirasc/gists{/gist_id}", "starred_url": "https://api.github.com/users/ferreirasc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ferreirasc/subscriptions", "organizations_url": "https://api.github.com/users/ferreirasc/orgs", "repos_url": "https://api.github.com/users/ferreirasc/repos", "events_url": "https://api.github.com/users/ferreirasc/events{/privacy}", "received_events_url": "https://api.github.com/users/ferreirasc/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-01T20:41:26Z", "updated_at": "2020-01-09T10:46:20Z", "closed_at": "2020-01-09T10:46:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi guys,\r\n\r\nI am trying to reproduce an attack involving Resource-Based Constrained Delegation on my lab. I'm simply executing ntlmrelayx with `--remove-mic` parameter (CVE-2019-1040) to relay SMB to LDAP from the connection I receive with printerbug... as mentioned on Attack #2 at https://dirkjanm.io/exploiting-CVE-2019-1040-relay-vulnerabilities-for-rce-and-domain-admin/. \r\n\r\nOn my attackerbox:\r\n\r\n`ntlmrelayx.py --delegate-access --escalate-user rbcdTest\\$ -t ldap://dc01lab.lab.local --remove-mic`\r\n\r\nAnother tab:\r\n\r\n`python printerbug.py lab.local/sbob:AnyPassword@servicea.lab.local attackerbox.lab.local`\r\n\r\nThe point is that I am always getting the status:\r\n\r\n```\r\n[*] SMBD-Thread-3: Received connection from 172.31.44.3, attacking target ldap://dc01lab.lab.local\r\n[-] Authenticating against ldap://dc01lab.lab.local as LAB\\SERVICEA$ FAILED\r\n```\r\n\r\nIf then I decide to force an SMB connection as `LAB\\ServiceA$` on another tab from my attacker box towards itself ... something like:\r\n\r\n```\r\nroot@ip-172-31-38-141:/home/ubuntu/tools/krbrelayx# crackmapexec 172.31.38.141 -u 'SERVICEA$' -H '0fcacaaa7bbc864f27d1d4bfcf84115d'\r\nCME          172.31.38.141:445 DC01LAB         [*] UNIX (name:DC01LAB) (domain:LAB)\r\nCME          172.31.38.141:445 DC01LAB         [-] LAB\\SERVICEA$ 0fcacaaa7bbc864f27d1d4bfcf84115d STATUS_NO_SUCH_FILE\r\n```\r\n\r\nThe relay seems to work:\r\n\r\n```\r\n[*] SMBD-Thread-7: Received connection from 172.31.38.141, attacking target ldap://dc01lab.lab.local\r\n[*] Authenticating against ldap://dc01lab.lab.local as LAB\\SERVICEA$ SUCCEED\r\n[*] Enumerating relayed user's privileges. This may take a while on large domains\r\n[*] Delegation rights modified succesfully!\r\n[*] rbcdTest$ can now impersonate users on SERVICEA$ via S4U2Proxy\r\n```\r\n\r\nI decided to investigate why authentication doesn't work when I receive the auth via printerbug ... I was able to confirm that LDAP traffic arrives but returns \"Invalid Credentials\":\r\n\r\n``` \r\nLDAPMessage bindResponse(5) invalidCredentials (80090308: LdapErr: DSID-0C0906A1, comment: AcceptSecurityContext error, data 57, v3839)\r\n```\r\n\r\nI am using ntlmrelayx.py on the latest version of impacket and printerbug.py from https://github.com/dirkjanm/krbrelayx/blob/master/printerbug.py.\r\n\r\nCould anyone have an idea why the attack didn't work via printerbug? Is there any way to check if my domain controller is vulnerable to CVE-2019-1040? Also ... if it's not vulnerable ... why if I force an SMB auth from my attacker box, does the relay for LDAP seem to happen? :|\r\n\r\nThank you in advance!\r\n    \r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/733", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/733/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/733/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/733/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/733", "id": 543705189, "node_id": "MDU6SXNzdWU1NDM3MDUxODk=", "number": 733, "title": "Error when Getting TGT (GetNPUsers.com)", "user": {"login": "JohnEarle", "id": 2362840, "node_id": "MDQ6VXNlcjIzNjI4NDA=", "avatar_url": "https://avatars3.githubusercontent.com/u/2362840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnEarle", "html_url": "https://github.com/JohnEarle", "followers_url": "https://api.github.com/users/JohnEarle/followers", "following_url": "https://api.github.com/users/JohnEarle/following{/other_user}", "gists_url": "https://api.github.com/users/JohnEarle/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnEarle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnEarle/subscriptions", "organizations_url": "https://api.github.com/users/JohnEarle/orgs", "repos_url": "https://api.github.com/users/JohnEarle/repos", "events_url": "https://api.github.com/users/JohnEarle/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnEarle/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-30T03:23:00Z", "updated_at": "2020-01-30T18:10:30Z", "closed_at": "2020-01-30T18:10:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I Receiving the following error after Getting TGT\r\n[*] Getting TGT for *******\r\n[-] <ConstraintsIntersection object at 0xb7555f2c consts <ConstraintsUnion object at 0xb7555dac consts <SingleValueConstraint object at 0xb7555d6c consts 10>, <SingleValueConstraint object at 0xb7555d8c consts 12>>> failed at: ValueConstraintError('<ConstraintsUnion object at 0xb7555dac consts <SingleValueConstraint object at 0xb7555d6c consts 10>, <SingleValueConstraint object at 0xb7555d8c consts 12>> failed at: ValueConstraintError(\\'all of (<SingleValueConstraint object at 0xb7555d6c consts 10>, <SingleValueConstraint object at 0xb7555d8c consts 12>) failed for \"11\"\\',)',) at Integer", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/729", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/729/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/729/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/729/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/729", "id": 540705638, "node_id": "MDU6SXNzdWU1NDA3MDU2Mzg=", "number": 729, "title": "impacket.dcerpc.v5.tsch.hSchRpcEnumInstances throws struct.error", "user": {"login": "jx6f", "id": 4547981, "node_id": "MDQ6VXNlcjQ1NDc5ODE=", "avatar_url": "https://avatars2.githubusercontent.com/u/4547981?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jx6f", "html_url": "https://github.com/jx6f", "followers_url": "https://api.github.com/users/jx6f/followers", "following_url": "https://api.github.com/users/jx6f/following{/other_user}", "gists_url": "https://api.github.com/users/jx6f/gists{/gist_id}", "starred_url": "https://api.github.com/users/jx6f/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jx6f/subscriptions", "organizations_url": "https://api.github.com/users/jx6f/orgs", "repos_url": "https://api.github.com/users/jx6f/repos", "events_url": "https://api.github.com/users/jx6f/events{/privacy}", "received_events_url": "https://api.github.com/users/jx6f/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-20T02:25:40Z", "updated_at": "2020-01-30T18:16:51Z", "closed_at": "2020-01-30T18:16:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Configuration  \r\nimpacket version:  v0.9.21-dev(commit f2546a0bc54e9df11b3a7f225af069125218d359)\r\nPython version:  3.7.4\r\nTarget OS:  Windows 2008 R2\r\n\r\n### Debug Output With Command String  \r\n\r\n```\r\n$ ipython\r\nPython 3.7.4 (default, Oct  4 2019, 06:57:26) \r\nType 'copyright', 'credits' or 'license' for more information\r\nIPython 7.9.0 -- An enhanced Interactive Python. Type '?' for help.\r\n\r\nIn [1]: from impacket.dcerpc.v5 import tsch, transport \r\n   ...:  \r\n   ...: stringbinding = r'ncacn_np:%s[\\pipe\\atsvc]' % '192.168.56.50' \r\n   ...: rpctransport = transport.DCERPCTransportFactory(stringbinding) \r\n   ...: rpctransport.set_credentials('administrator', 'password', '','','','') \r\n   ...: dce = rpctransport.get_dce_rpc() \r\n   ...: dce.set_credentials(*rpctransport.get_credentials()) \r\n   ...: dce.connect() \r\n   ...: dce.bind(tsch.MSRPC_UUID_TSCHS) \r\n\r\nIn [2]: tsch.hSchRpcEnumInstances(dce, 'some_running_task')\r\n---------------------------------------------------------------------------\r\nerror                                     Traceback (most recent call last)\r\n<ipython-input-2-cfd30146b84f> in <module>\r\n----> 1 tsch.hSchRpcEnumInstances(dce, 'some_running_task')\r\n\r\n/impacket/impacket/dcerpc/v5/tsch.py in hSchRpcEnumInstances(dce, path, flags)\r\n    671     schRpcEnumInstances['path'] = checkNullString(path)\r\n    672     schRpcEnumInstances['flags'] = flags\r\n--> 673     return dce.request(schRpcEnumInstances)\r\n    674 \r\n    675 def hSchRpcGetInstanceInfo(dce, guid):\r\n\r\n/impacket/impacket/dcerpc/v5/rpcrt.py in request(self, request, uuid, checkError)\r\n    877             raise exception\r\n    878         else:\r\n--> 879             response =  respClass(answer, isNDR64 = isNDR64)\r\n    880             return response\r\n    881 \r\n\r\n/impacket/impacket/dcerpc/v5/ndr.py in __init__(self, data, isNDR64)\r\n   1661 \r\n   1662         if data is not None:\r\n-> 1663             self.fromString(data)\r\n   1664 \r\n   1665     def dump(self, msg = None, indent = 0):\r\n\r\n/impacket/impacket/dcerpc/v5/ndr.py in fromString(self, data, soFar)\r\n   1728                     data = data[advanceStream:]\r\n   1729 \r\n-> 1730                 size = self.unpack(fieldName, fieldTypeOrClass, data, soFar)\r\n   1731 \r\n   1732                 # Any referent information to unpack?\r\n\r\n/impacket/impacket/dcerpc/v5/ndr.py in unpack(self, fieldName, fieldTypeOrClass, data, soFar)\r\n    301         data = data[:size]\r\n    302         if isinstance(self.fields[fieldName], NDR):\r\n--> 303             return self.fields[fieldName].fromString(data, soFar)\r\n    304 \r\n    305         # code specifier\r\n\r\n/impacket/impacket/dcerpc/v5/ndr.py in fromString(self, data, soFar)\r\n    257                     data = data[pad:]\r\n    258 \r\n--> 259                 size = self.unpack(fieldName, fieldTypeOrClass, data, soFar)\r\n    260 \r\n    261                 data = data[size:]\r\n\r\n/impacket/impacket/dcerpc/v5/ndr.py in unpack(self, fieldName, fieldTypeOrClass, data, soFar)\r\n    306         two = fieldTypeOrClass.split('=')\r\n    307         if len(two) >= 2:\r\n--> 308             return self.unpack(fieldName,two[0], data, soFar)\r\n    309 \r\n    310         # literal specifier\r\n\r\n/impacket/impacket/dcerpc/v5/ndr.py in unpack(self, fieldName, fieldTypeOrClass, data, soFar)\r\n    318 \r\n    319         # struct like specifier\r\n--> 320         self.fields[fieldName] = unpack(fieldTypeOrClass, data)[0]\r\n    321         return size\r\n    322 \r\n\r\nerror: unpack requires a buffer of 4 bytes\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/726", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/726/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/726/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/726/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/726", "id": 538663354, "node_id": "MDU6SXNzdWU1Mzg2NjMzNTQ=", "number": 726, "title": "Feature Request - raiseChild.py target IPs", "user": {"login": "mubix", "id": 679319, "node_id": "MDQ6VXNlcjY3OTMxOQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/679319?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mubix", "html_url": "https://github.com/mubix", "followers_url": "https://api.github.com/users/mubix/followers", "following_url": "https://api.github.com/users/mubix/following{/other_user}", "gists_url": "https://api.github.com/users/mubix/gists{/gist_id}", "starred_url": "https://api.github.com/users/mubix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mubix/subscriptions", "organizations_url": "https://api.github.com/users/mubix/orgs", "repos_url": "https://api.github.com/users/mubix/repos", "events_url": "https://api.github.com/users/mubix/events{/privacy}", "received_events_url": "https://api.github.com/users/mubix/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-16T21:15:01Z", "updated_at": "2019-12-17T02:19:07Z", "closed_at": "2019-12-17T02:11:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "It would be nice to have target IPs for the child DC and forest/parent DC so that it can easily be tunneled", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/717", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/717/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/717/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/717/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/717", "id": 532006481, "node_id": "MDU6SXNzdWU1MzIwMDY0ODE=", "number": 717, "title": "lookupsid.py - digestmod is required", "user": {"login": "Reelix", "id": 289404, "node_id": "MDQ6VXNlcjI4OTQwNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/289404?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Reelix", "html_url": "https://github.com/Reelix", "followers_url": "https://api.github.com/users/Reelix/followers", "following_url": "https://api.github.com/users/Reelix/following{/other_user}", "gists_url": "https://api.github.com/users/Reelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/Reelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Reelix/subscriptions", "organizations_url": "https://api.github.com/users/Reelix/orgs", "repos_url": "https://api.github.com/users/Reelix/repos", "events_url": "https://api.github.com/users/Reelix/events{/privacy}", "received_events_url": "https://api.github.com/users/Reelix/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-12-03T14:01:26Z", "updated_at": "2020-03-19T12:57:02Z", "closed_at": "2020-01-07T20:41:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Python: 3.8.0\r\nImpacket: v0.9.20\r\n\r\nSyntax: python lookupsid.py 'user:pass'@{iphere}\r\n\r\nlookupsid.py fails on line 79 - https://github.com/SecureAuthCorp/impacket/blob/master/examples/lookupsid.py#L79 - With the error\r\n```\r\n[*] Brute forcing SIDs at {iphere}\r\n[*] StringBinding ncacn_np:{iphere}[\\pipe\\lsarpc]\r\n[-] `digestmod` is required.\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/715", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/715/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/715/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/715/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/715", "id": 531343092, "node_id": "MDU6SXNzdWU1MzEzNDMwOTI=", "number": 715, "title": "Feature Request - Timestamped Output for Examples", "user": {"login": "mubix", "id": 679319, "node_id": "MDQ6VXNlcjY3OTMxOQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/679319?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mubix", "html_url": "https://github.com/mubix", "followers_url": "https://api.github.com/users/mubix/followers", "following_url": "https://api.github.com/users/mubix/following{/other_user}", "gists_url": "https://api.github.com/users/mubix/gists{/gist_id}", "starred_url": "https://api.github.com/users/mubix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mubix/subscriptions", "organizations_url": "https://api.github.com/users/mubix/orgs", "repos_url": "https://api.github.com/users/mubix/repos", "events_url": "https://api.github.com/users/mubix/events{/privacy}", "received_events_url": "https://api.github.com/users/mubix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 199974009, "node_id": "MDU6TGFiZWwxOTk5NzQwMDk=", "url": "https://api.github.com/repos/SecureAuthCorp/impacket/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-02T17:40:05Z", "updated_at": "2020-01-30T18:18:03Z", "closed_at": "2020-01-30T18:18:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I would love to see an option to have timestamps outputted every time. I currently use a command like this:\r\n```\r\nroot@kali:~/impacket/examples# smbserver.py -smb2support -comment share -debug sharename sharename/ | ts '[%Y-%m-%d %H:%M:%S]' | tee -a /opt/smbserver.log\r\n```\r\n\r\nTo get output like this:\r\n```\r\n[2019-12-02 17:38:43] [*] Connecting Share(1:IPC$)\r\n[2019-12-02 17:38:44] [*] Incoming connection (171.14.123.198,52436)\r\n[2019-12-02 17:38:45] [*] Incoming connection (202.153.34.139,65337)\r\n[2019-12-02 17:38:45] [*] AUTHENTICATE_MESSAGE (\\\\\\,)\r\n[2019-12-02 17:38:45] [*] User \\\\\\ authenticated successfully\r\n[2019-12-02 17:38:45] [*] \\\\:::4141414141414141:4852b4ace2ca4172cc00cd950b60fa54:010100000000000080407a5837a9d5014a4a583864516a3800000000010010006c004b006500420056004400560048000200100079006700450077006800500058005100030010006c004b0065004200560044005600480004001000790067004500770068005000580051000700080080407a5837a9d50109001a0063006900660073002f006c004b006500420056004400560048000000000000000000\r\n[2019-12-02 17:38:45] [*] Connecting Share(1:IPC$)\r\n[2019-12-02 17:38:46] [*] Incoming connection (171.14.123.198,52538)\r\n```\r\n\r\nThe reasoning is to help with timelines and writing up results from pentests\r\n\r\nMaybe just have it be an extra argument:\r\n```\r\nsmbserver.py -smb2support -ts -comment share -debug sharename sharename/\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/710", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/710/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/710/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/710/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/710", "id": 529865585, "node_id": "MDU6SXNzdWU1Mjk4NjU1ODU=", "number": 710, "title": "secretsdump fails to get SAM hashes on Windows Server 2019", "user": {"login": "NEXUS2345", "id": 4030870, "node_id": "MDQ6VXNlcjQwMzA4NzA=", "avatar_url": "https://avatars3.githubusercontent.com/u/4030870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NEXUS2345", "html_url": "https://github.com/NEXUS2345", "followers_url": "https://api.github.com/users/NEXUS2345/followers", "following_url": "https://api.github.com/users/NEXUS2345/following{/other_user}", "gists_url": "https://api.github.com/users/NEXUS2345/gists{/gist_id}", "starred_url": "https://api.github.com/users/NEXUS2345/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NEXUS2345/subscriptions", "organizations_url": "https://api.github.com/users/NEXUS2345/orgs", "repos_url": "https://api.github.com/users/NEXUS2345/repos", "events_url": "https://api.github.com/users/NEXUS2345/events{/privacy}", "received_events_url": "https://api.github.com/users/NEXUS2345/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 199974009, "node_id": "MDU6TGFiZWwxOTk5NzQwMDk=", "url": "https://api.github.com/repos/SecureAuthCorp/impacket/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-28T11:49:13Z", "updated_at": "2020-04-01T14:24:47Z", "closed_at": "2020-04-01T14:24:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm working on updating the tool keimpx and ran into an issue when dealing with secretsdump when testing against Windows Server 2019. Here is the stack trace:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/consultant/tools/scanning/keimpx-dev/keimpx/lib/secretsdump.py\", line 429, in dumpSAM\r\n    encNTHash = SAM_HASH_AES(V[userAccount['NTHashOffset']:][:userAccount['NTHashLength']])\r\n  File \"/home/consultant/tools/scanning/keimpx-dev/keimpx/lib/python2.7/site-packages/impacket/structure.py\", line 84, in __init__\r\n    self.fromString(data)\r\n  File \"/home/consultant/tools/scanning/keimpx-dev/keimpx/lib/python2.7/site-packages/impacket/structure.py\", line 149, in fromString\r\n    self[field[0]] = self.unpack(field[1], data[:size], dataClassOrCode = dataClassOrCode, field = field[0])\r\n  File \"/home/consultant/tools/scanning/keimpx-dev/keimpx/lib/python2.7/site-packages/impacket/structure.py\", line 321, in unpack\r\n    return self.unpack(two[0],data)\r\n  File \"/home/consultant/tools/scanning/keimpx-dev/keimpx/lib/python2.7/site-packages/impacket/structure.py\", line 380, in unpack\r\n    return unpack(format, data)[0]\r\nerror: ('unpack requires a string argument of length 2', \"When unpacking field 'PekID | <H=0 | ''[:2]'\")\r\n```\r\n\r\nI thought it might be something in my code, but after comparing it to your examples from which the code is based on, they are basically identical. I then decided to test your example against the same server and got this output:\r\n```\r\n[+] Service RemoteRegistry is already running\r\n[+] Retrieving class info for JD\r\n[+] Retrieving class info for Skew1\r\n[+] Retrieving class info for GBG\r\n[+] Retrieving class info for Data\r\n[*] Target system bootKey: REDACTED\r\n[+] Checking NoLMHash Policy\r\n[+] LMHashes are NOT being stored\r\n[+] Saving remote SAM database\r\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\r\n[+] Calculating HashedBootKey from SAM\r\n[+] NewStyle hashes is: True\r\nAdministrator:500:REDACTED:REDACTED:::\r\n[+] NewStyle hashes is: True\r\nGuest:501:REDACTED:REDACTED:::\r\n[+] NewStyle hashes is: True\r\nDefaultAccount:503:REDACTED:REDACTED:::\r\n[-] SAM hashes extraction failed: string index out of range\r\n```\r\n\r\nThe issues here sound similar, but I can't be sure if they are identical or not. Both were tested on Python 2.7.17, one with Impacket 0.9.20 from pypi and the other (the latter) direct from source on this repo. The source for my updates to keimpx is located here: https://github.com/NEXUS2345/keimpx/tree/impacket-0.9.20\r\n\r\nAny help/insight is much appreciated.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/709", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/709/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/709/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/709/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/709", "id": 529709613, "node_id": "MDU6SXNzdWU1Mjk3MDk2MTM=", "number": 709, "title": "kerberos authentication failed on secretsdump.py when disable RC4_HMAC_MD5", "user": {"login": "tuian", "id": 9986910, "node_id": "MDQ6VXNlcjk5ODY5MTA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9986910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tuian", "html_url": "https://github.com/tuian", "followers_url": "https://api.github.com/users/tuian/followers", "following_url": "https://api.github.com/users/tuian/following{/other_user}", "gists_url": "https://api.github.com/users/tuian/gists{/gist_id}", "starred_url": "https://api.github.com/users/tuian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tuian/subscriptions", "organizations_url": "https://api.github.com/users/tuian/orgs", "repos_url": "https://api.github.com/users/tuian/repos", "events_url": "https://api.github.com/users/tuian/events{/privacy}", "received_events_url": "https://api.github.com/users/tuian/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-28T05:58:43Z", "updated_at": "2019-11-29T15:12:07Z", "closed_at": "2019-11-29T15:12:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "# kerberos authentication failed on secretsdump.py when disable RC4_HMAC_MD5\r\n\r\n### 0x01 Disable rc4-hmac\r\n- [Disable RC4-HMAC (And Others) in Active Directory](http://www.myotherpcisacloud.com/post/disable-rc4hmac-and-others-in-active-directory)\r\n![image](https://user-images.githubusercontent.com/9986910/69780273-c778ff00-11e5-11ea-869b-5c3da14a0086.png)\r\n\r\n### 0x02  Dump fail\r\n\r\n![image](https://user-images.githubusercontent.com/9986910/69780458-5be36180-11e6-11ea-855b-c095000169c8.png)\r\n\r\n```c\r\ngetST.py -spn HOST/DC.****.corp '****.corp/autogetn$' -dc-ip 192.168.44.150  -impersonate DC$\r\nexport KRB5CCNAME=DC\\$.ccache\r\nsecretsdump.py -just-dc  -k -no-pass  -just-dc-user krbtgt dc.****.corp -debug\r\n```\r\nDC$.ccache is a `DES-CBC-MD5` ticket rather than a `rc4-hmac-MD5` ticket\r\n\r\nSo, `secretsdump.py` can not work.\r\n\r\n```c\r\nDES-CBC-MD5 kerberos authentication ticket\r\nSomething wen't wrong with the DRSUAPI approach\r\n```\r\n### 0x03 debug info\r\n\r\n```c\r\n\u279c  disable_rc4 getST.py -spn HOST/DC.****.corp '****.corp/dcadmin' -dc-ip 192.168.44.150  -impersonate DC$\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\nPassword:\r\n[*] Getting TGT for user\r\n[*] Impersonating DC$\r\n[*] \tRequesting S4U2self\r\n[*] \tRequesting S4U2Proxy\r\n[*] Saving ticket in DC$.ccache\r\n\u279c  disable_rc4 export KRB5CCNAME=DC\\$.ccache\r\n\u279c  disable_rc4 secretsdump.py -just-dc  -k -no-pass  -just-dc-user krbtgt dc.****.corp -debug\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\n[+] Using Kerberos Cache: DC$.ccache\r\n[+] Domain retrieved from CCache: ****.corp\r\n[+] SPN CIFS/DC.****.corp@****.corp not found in cache\r\n[+] AnySPN is True, looking for another suitable SPN\r\n[+] Returning cached credential for HOST/DC.****.corp@****.corp\r\n[+] Changing sname from HOST/DC.****.corp@****.corp to cifs/DC.****.corp@****.corp and hoping for the best\r\n[+] Using TGS from cache\r\n[+] Username retrieved from CCache: DC$\r\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\r\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\r\nTraceback (most recent call last):\r\n  File \"/Library/Python/2.7/site-packages/impacket-0.9.21.dev0-py2.7.egg/EGG-INFO/scripts/secretsdump.py\", line 210, in dump\r\n  File \"build/bdist.macosx-10.15-x86_64/egg/impacket/examples/secretsdump.py\", line 2419, in dump\r\n    name=self.__justUser)\r\n  File \"build/bdist.macosx-10.15-x86_64/egg/impacket/examples/secretsdump.py\", line 502, in DRSCrackNames\r\n    self.__connectDrds()\r\n  File \"build/bdist.macosx-10.15-x86_64/egg/impacket/examples/secretsdump.py\", line 437, in __connectDrds\r\n    self.__drsr.bind(drsuapi.MSRPC_UUID_DRSUAPI)\r\n  File \"build/bdist.macosx-10.15-x86_64/egg/impacket/dcerpc/v5/rpcrt.py\", line 1086, in bind\r\n    bindResp['auth_data'])\r\n  File \"build/bdist.macosx-10.15-x86_64/egg/impacket/krb5/kerberosv5.py\", line 481, in getKerberosType3\r\n    plainText = cipher.decrypt(sessionKey, 12, cipherText)\r\n  File \"build/bdist.macosx-10.15-x86_64/egg/impacket/krb5/crypto.py\", line 269, in decrypt\r\n    if not _mac_equal(mac, expmac):\r\n  File \"build/bdist.macosx-10.15-x86_64/egg/impacket/krb5/crypto.py\", line 103, in _mac_equal\r\n    res |= x ^ y\r\nTypeError: unsupported operand type(s) for ^: 'str' and 'str'\r\n[-] unsupported operand type(s) for ^: 'str' and 'str'\r\n[*] Something wen't wrong with the DRSUAPI approach. Try again with -use-vss parameter\r\n[*] Cleaning up...\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/708", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/708/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/708/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/708/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/708", "id": 529246832, "node_id": "MDU6SXNzdWU1MjkyNDY4MzI=", "number": 708, "title": "UnicodeDecodeError in smbexec.py", "user": {"login": "exploide", "id": 5670236, "node_id": "MDQ6VXNlcjU2NzAyMzY=", "avatar_url": "https://avatars0.githubusercontent.com/u/5670236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/exploide", "html_url": "https://github.com/exploide", "followers_url": "https://api.github.com/users/exploide/followers", "following_url": "https://api.github.com/users/exploide/following{/other_user}", "gists_url": "https://api.github.com/users/exploide/gists{/gist_id}", "starred_url": "https://api.github.com/users/exploide/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/exploide/subscriptions", "organizations_url": "https://api.github.com/users/exploide/orgs", "repos_url": "https://api.github.com/users/exploide/repos", "events_url": "https://api.github.com/users/exploide/events{/privacy}", "received_events_url": "https://api.github.com/users/exploide/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-27T10:13:17Z", "updated_at": "2019-12-03T15:56:17Z", "closed_at": "2019-12-03T15:56:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When running `smbexec.py` (today's master version) and executing any command, an `UnicodeDecodeError` occurs. This is maybe due to some German umlauts, e.g. in `Dom\u00e4nen-Admins`. But perhaps it is just another issue with the `AttributeError: 'RemoteShell' object has no attribute 'do_net'`.\r\n\r\n```\r\n> smbexec.py -debug 'domain/user:pass@192.168.1.1'\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\n[+] StringBinding ncacn_np:192.168.1.1[\\pipe\\svcctl]\r\n[+] Executing %COMSPEC% /Q /c echo cd  ^> \\\\127.0.0.1\\C$\\__output 2^>^&1 > %TEMP%\\execute.bat & %COMSPEC% /Q /c %TEMP%\\execute.bat & del %TEMP%\\execute.bat\r\n[!] Launching semi-interactive shell - Careful what you execute\r\nC:\\Windows\\system32>net group\r\n[+] Executing %COMSPEC% /Q /c echo net group ^> \\\\127.0.0.1\\C$\\__output 2^>^&1 > %TEMP%\\execute.bat & %COMSPEC% /Q /c %TEMP%\\execute.bat & del %TEMP%\\execute.bat\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.7/cmd.py\", line 214, in onecmd\r\n    func = getattr(self, 'do_' + cmd)\r\nAttributeError: 'RemoteShell' object has no attribute 'do_net'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/jvieten/Repos/impacket/venv/bin/smbexec.py\", line 152, in run\r\n    self.shell.cmdloop()\r\n  File \"/usr/lib64/python3.7/cmd.py\", line 138, in cmdloop\r\n    stop = self.onecmd(line)\r\n  File \"/usr/lib64/python3.7/cmd.py\", line 216, in onecmd\r\n    return self.default(line)\r\n  File \"/home/jvieten/Repos/impacket/venv/bin/smbexec.py\", line 241, in default\r\n    self.send_data(line)\r\n  File \"/home/jvieten/Repos/impacket/venv/bin/smbexec.py\", line 278, in send_data\r\n    print(self.__outputBuffer.decode())\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 17: invalid start byte\r\n[-] 'utf-8' codec can't decode byte 0x81 in position 17: invalid start byte\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/705", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/705/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/705/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/705/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/705", "id": 528325707, "node_id": "MDU6SXNzdWU1MjgzMjU3MDc=", "number": 705, "title": "0x73,SMB SessionError: STATUS_UNSUCCESSFUL", "user": {"login": "tacticthreat", "id": 21228150, "node_id": "MDQ6VXNlcjIxMjI4MTUw", "avatar_url": "https://avatars2.githubusercontent.com/u/21228150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tacticthreat", "html_url": "https://github.com/tacticthreat", "followers_url": "https://api.github.com/users/tacticthreat/followers", "following_url": "https://api.github.com/users/tacticthreat/following{/other_user}", "gists_url": "https://api.github.com/users/tacticthreat/gists{/gist_id}", "starred_url": "https://api.github.com/users/tacticthreat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tacticthreat/subscriptions", "organizations_url": "https://api.github.com/users/tacticthreat/orgs", "repos_url": "https://api.github.com/users/tacticthreat/repos", "events_url": "https://api.github.com/users/tacticthreat/events{/privacy}", "received_events_url": "https://api.github.com/users/tacticthreat/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-11-25T20:42:26Z", "updated_at": "2019-12-12T03:00:32Z", "closed_at": "2019-12-12T03:00:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have an attacker machine (kali) relaying against a target with smb signing disabled or not enforced. From a separate server I initiate an SMB connection to my attacker machine. Here are the details:\r\n\r\nAttacker Machine:\r\n`smbrelayx.py -h TargetIP -c \"ipconfig\"`\r\nOR also tried\r\n`smbrelayx.py -h TargetIP -e smbrev.exe`  (where the payload is also configured with a MSF listener)\r\n\r\nAfter initiating a connection to my attacker machine from a server,\r\n[*] SMBD: Received connection from **ServerIP**, attacking target **TargetIP**\r\n[-] SessionSetup Error!\r\n[-] processRequest (0x73,SMB SessionError: STATUS_UNSUCCESSFUL({Operation Failed} The requested operation was unsuccessful.))\r\n\r\nIn the connecting Server to the Attacker host I receive the error:\r\n\"The specified network name is no longer available\"\r\n\r\nWhat is the issue?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/702", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/702/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/702/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/702/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/702", "id": 527602252, "node_id": "MDU6SXNzdWU1Mjc2MDIyNTI=", "number": 702, "title": "ValueError('`digestmod` is required.') in Pytthon3.8", "user": {"login": "Unitiser", "id": 7543526, "node_id": "MDQ6VXNlcjc1NDM1MjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/7543526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Unitiser", "html_url": "https://github.com/Unitiser", "followers_url": "https://api.github.com/users/Unitiser/followers", "following_url": "https://api.github.com/users/Unitiser/following{/other_user}", "gists_url": "https://api.github.com/users/Unitiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/Unitiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Unitiser/subscriptions", "organizations_url": "https://api.github.com/users/Unitiser/orgs", "repos_url": "https://api.github.com/users/Unitiser/repos", "events_url": "https://api.github.com/users/Unitiser/events{/privacy}", "received_events_url": "https://api.github.com/users/Unitiser/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-11-23T20:04:47Z", "updated_at": "2019-11-29T07:46:26Z", "closed_at": "2019-11-28T21:00:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "According to my research, `hmac.py` was updated in python3.8 and requires the `digestmod` to be set explicitly. This issue has been addressed in `ldap3` 2.6.0.\r\n\r\nhttps://github.com/cannatag/ldap3/blob/master/_changelog.txt\r\n\r\nOn my machine I forced updated that version and it seamed to fix the issue.\r\n\r\nEdit : \r\nToday, I did a bit more digging. I was still getting the error from `ntlm.py`. I identified occurrences of `hmac` without explicit `digestmod` in the following files : \r\n\r\n```\r\n./impacket/ntlm.py\r\n./impacket/dcerpc/v5/nrpc.py\r\n./impacket/examples/secretsdump.py\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/701", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/701/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/701/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/701/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/701", "id": 527077102, "node_id": "MDU6SXNzdWU1MjcwNzcxMDI=", "number": 701, "title": "bash: pip: command not found", "user": {"login": "Mweo-Bruce", "id": 58066792, "node_id": "MDQ6VXNlcjU4MDY2Nzky", "avatar_url": "https://avatars2.githubusercontent.com/u/58066792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mweo-Bruce", "html_url": "https://github.com/Mweo-Bruce", "followers_url": "https://api.github.com/users/Mweo-Bruce/followers", "following_url": "https://api.github.com/users/Mweo-Bruce/following{/other_user}", "gists_url": "https://api.github.com/users/Mweo-Bruce/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mweo-Bruce/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mweo-Bruce/subscriptions", "organizations_url": "https://api.github.com/users/Mweo-Bruce/orgs", "repos_url": "https://api.github.com/users/Mweo-Bruce/repos", "events_url": "https://api.github.com/users/Mweo-Bruce/events{/privacy}", "received_events_url": "https://api.github.com/users/Mweo-Bruce/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-22T09:13:57Z", "updated_at": "2020-01-16T15:42:52Z", "closed_at": "2019-11-26T15:31:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm unable to install the source execute. Using Linux debian. Need help.\r\nThanks...", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/691", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/691/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/691/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/691/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/691", "id": 522130152, "node_id": "MDU6SXNzdWU1MjIxMzAxNTI=", "number": 691, "title": "list_path function -> TypeError: can't concat str to bytes", "user": {"login": "mpgn", "id": 5891788, "node_id": "MDQ6VXNlcjU4OTE3ODg=", "avatar_url": "https://avatars2.githubusercontent.com/u/5891788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpgn", "html_url": "https://github.com/mpgn", "followers_url": "https://api.github.com/users/mpgn/followers", "following_url": "https://api.github.com/users/mpgn/following{/other_user}", "gists_url": "https://api.github.com/users/mpgn/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpgn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpgn/subscriptions", "organizations_url": "https://api.github.com/users/mpgn/orgs", "repos_url": "https://api.github.com/users/mpgn/repos", "events_url": "https://api.github.com/users/mpgn/events{/privacy}", "received_events_url": "https://api.github.com/users/mpgn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-11-13T11:02:47Z", "updated_at": "2019-12-03T15:27:01Z", "closed_at": "2019-12-03T15:27:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "There is an encoding error on the function [list_path](https://github.com/SecureAuthCorp/impacket/blob/master/impacket/smb.py#L3807)\r\n\r\n```\r\n  File \"/root/impacket/impacket/smbconnection.py\", line 421, in listPath\r\n    return self._SMBConnection.list_path(shareName, path, password)\r\n  File \"/root/impacket/impacket/smb.py\", line 3873, in list_path\r\n    findNextParameter['FileName'] = resume_filename + '\\x00'\r\nTypeError: can't concat str to bytes\r\n```\r\n\r\nFrom this line: https://github.com/SecureAuthCorp/impacket/blob/master/impacket/smb.py#L3872\r\n\r\nI did a print before the assignment line 3873\r\n\r\n```\r\nprint(resume_filename, type(resume_filename))\r\n=> b'Classic_{40419485-c444-4567-851a-2dd7bfa1684d}.settingcontent-ms\\x00' <class 'bytes'>\r\n```\r\n\r\nThe folder path contains this type of files from: `Users/Administrator/AppData/Local/Packages/windows.immersivecontrolpanel_cw5n1h2txyewy/LocalState/Indexed/Settings/en-US/*`\r\n\r\n![image](https://user-images.githubusercontent.com/5891788/68758042-57775000-060d-11ea-952a-1b1c3e5352f2.png)\r\n\r\nI'm using the master branch\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/688", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/688/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/688/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/688/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/688", "id": 516053157, "node_id": "MDU6SXNzdWU1MTYwNTMxNTc=", "number": 688, "title": "ntlmrelayx.py missing python module 'readline' on windows", "user": {"login": "antonioCoco", "id": 19797064, "node_id": "MDQ6VXNlcjE5Nzk3MDY0", "avatar_url": "https://avatars0.githubusercontent.com/u/19797064?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antonioCoco", "html_url": "https://github.com/antonioCoco", "followers_url": "https://api.github.com/users/antonioCoco/followers", "following_url": "https://api.github.com/users/antonioCoco/following{/other_user}", "gists_url": "https://api.github.com/users/antonioCoco/gists{/gist_id}", "starred_url": "https://api.github.com/users/antonioCoco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antonioCoco/subscriptions", "organizations_url": "https://api.github.com/users/antonioCoco/orgs", "repos_url": "https://api.github.com/users/antonioCoco/repos", "events_url": "https://api.github.com/users/antonioCoco/events{/privacy}", "received_events_url": "https://api.github.com/users/antonioCoco/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-01T11:15:50Z", "updated_at": "2019-11-05T18:38:34Z", "closed_at": "2019-11-05T18:38:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Just tried to install and use ntlmrelayx on windows.\r\nI have Python 2.7.16 on my win10 and after running \"pip install .\" everything installed correctly.\r\nBut when i run ntlmrelayx.py i have the following error:\r\n\r\n```\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client HTTPS loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Protocol Client SMB loaded..\r\n[*] Protocol Client SMTP loaded..\r\nTraceback (most recent call last):\r\n  File \"ntlmrelayx.py\", line 309, in <module>\r\n    from impacket.examples.ntlmrelayx.attacks import PROTOCOL_ATTACKS\r\n  File \"C:\\Python27\\lib\\site-packages\\impacket\\examples\\ntlmrelayx\\attacks\\__init__.py\", line 57, in <module>\r\n    __import__(package + '.' + os.path.splitext(file)[0])\r\n  File \"C:\\Python27\\lib\\site-packages\\impacket\\examples\\ntlmrelayx\\attacks\\smbattack.py\", line 24, in <module>\r\n    from impacket.examples.smbclient import MiniImpacketShell\r\n  File \"C:\\Python27\\lib\\site-packages\\impacket\\examples\\smbclient.py\", line 37, in <module>\r\n    import readline\r\nImportError: No module named readline\r\n```\r\n\r\nAnyway i managed to solve this issue by running:\r\n\r\n```\r\npip install pyreadline\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/687", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/687/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/687/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/687/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/687", "id": 514917970, "node_id": "MDU6SXNzdWU1MTQ5MTc5NzA=", "number": 687, "title": "Windows Server 2016 DCSync issues", "user": {"login": "ltdenard", "id": 2850858, "node_id": "MDQ6VXNlcjI4NTA4NTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/2850858?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ltdenard", "html_url": "https://github.com/ltdenard", "followers_url": "https://api.github.com/users/ltdenard/followers", "following_url": "https://api.github.com/users/ltdenard/following{/other_user}", "gists_url": "https://api.github.com/users/ltdenard/gists{/gist_id}", "starred_url": "https://api.github.com/users/ltdenard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ltdenard/subscriptions", "organizations_url": "https://api.github.com/users/ltdenard/orgs", "repos_url": "https://api.github.com/users/ltdenard/repos", "events_url": "https://api.github.com/users/ltdenard/events{/privacy}", "received_events_url": "https://api.github.com/users/ltdenard/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-10-30T19:12:41Z", "updated_at": "2020-01-30T18:55:06Z", "closed_at": "2020-01-30T18:55:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "On 2016, it doesn't give me anything, but this:\r\n\r\npython secretsdump.py -just-dc-ntlm -user-status -pwd-last-set -outputfile hashes.tmp svc-test:passwordhere@192.168.100.100\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\n[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\r\n[*] Cleaning up...\r\n \r\nIt's windows server 2016 standard with the latest patches. Anything else you want to know, I'll try to answer about my setup. Anyone else having this same issue?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/686", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/686/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/686/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/686/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/686", "id": 513437586, "node_id": "MDU6SXNzdWU1MTM0Mzc1ODY=", "number": 686, "title": "Fail to parse user with --remove-mic", "user": {"login": "S3cur3Th1sSh1t", "id": 27858067, "node_id": "MDQ6VXNlcjI3ODU4MDY3", "avatar_url": "https://avatars3.githubusercontent.com/u/27858067?v=4", "gravatar_id": "", "url": "https://api.github.com/users/S3cur3Th1sSh1t", "html_url": "https://github.com/S3cur3Th1sSh1t", "followers_url": "https://api.github.com/users/S3cur3Th1sSh1t/followers", "following_url": "https://api.github.com/users/S3cur3Th1sSh1t/following{/other_user}", "gists_url": "https://api.github.com/users/S3cur3Th1sSh1t/gists{/gist_id}", "starred_url": "https://api.github.com/users/S3cur3Th1sSh1t/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/S3cur3Th1sSh1t/subscriptions", "organizations_url": "https://api.github.com/users/S3cur3Th1sSh1t/orgs", "repos_url": "https://api.github.com/users/S3cur3Th1sSh1t/repos", "events_url": "https://api.github.com/users/S3cur3Th1sSh1t/events{/privacy}", "received_events_url": "https://api.github.com/users/S3cur3Th1sSh1t/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-28T17:07:33Z", "updated_at": "2020-04-24T18:05:29Z", "closed_at": "2020-04-24T18:05:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nWhen relaying a DC01$ Hash to a seccond DC over ldap or ldaps with option --remove-mic i got the following error:\r\n\r\n```\r\nntlmrelayx.py -t ldap://x.x.x.x --remove-mic\r\nImpacket v0.9.20 - Copyright 2019 SecureAuth Corporation\r\n\r\n[*] Protocol Client LDAPS loaded..\r\n[*] Protocol Client LDAP loaded..\r\n[*] Protocol Client HTTPS loaded..\r\n[*] Protocol Client HTTP loaded..\r\n[*] Protocol Client IMAP loaded..\r\n[*] Protocol Client IMAPS loaded..\r\n[*] Protocol Client SMTP loaded..\r\n[*] Protocol Client SMB loaded..\r\n[*] Protocol Client MSSQL loaded..\r\n[*] Running in relay mode to single host\r\n[*] Setting up SMB Server\r\n[*] Setting up HTTP Server\r\n\r\n[*] Servers started, waiting for connections\r\n[*] SMBD-Thread-3: Received connection from x.x.x.x, attacking target ldap://x.x.x.x\r\n[*] Authenticating against ldap://x.x.x.x as DOMAIN\\DC02$ SUCCEED\r\n[*] Enumerating relayed user's privileges. This may take a while on large domains\r\nException in thread Thread-4:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python2.7/threading.py\", line 801, in __bootstrap_inner\r\n    self.run()\r\n  File \"/root/.local/share/virtualenvs/cme-CHct9Ewc/local/lib/python2.7/site-packages/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 500, in run\r\n    userSid, privs = self.validatePrivileges(self.username, domainDumper)\r\n  File \"/root/.local/share/virtualenvs/cme-CHct9Ewc/local/lib/python2.7/site-packages/impacket/examples/ntlmrelayx/attacks/ldapattack.py\", line 331, in validatePrivileges\r\n    self.client.search(domainDumper.root, '(objectClass=domain)', attributes=['objectSid'])\r\n  File \"/root/.local/share/virtualenvs/cme-CHct9Ewc/local/lib/python2.7/site-packages/ldap3/core/connection.py\", line 782, in search\r\n    response = self.post_send_search(self.send('searchRequest', request, controls))\r\n  File \"/root/.local/share/virtualenvs/cme-CHct9Ewc/local/lib/python2.7/site-packages/ldap3/strategy/base.py\", line 289, in send\r\n    raise LDAPSASLBindInProgressError(self.connection.last_error)\r\nLDAPSASLBindInProgressError: cannot send operation requests while SASL bind is in progress\r\n```\r\nCould not figure out what the cause is but it looks like the DCs attributes cannot be looked up?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/685", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/685/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/685/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/685/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/685", "id": 511600736, "node_id": "MDU6SXNzdWU1MTE2MDA3MzY=", "number": 685, "title": "Help with NTLMRelayx and SMB to SMB relay", "user": {"login": "kimoppalfens", "id": 21669488, "node_id": "MDQ6VXNlcjIxNjY5NDg4", "avatar_url": "https://avatars2.githubusercontent.com/u/21669488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kimoppalfens", "html_url": "https://github.com/kimoppalfens", "followers_url": "https://api.github.com/users/kimoppalfens/followers", "following_url": "https://api.github.com/users/kimoppalfens/following{/other_user}", "gists_url": "https://api.github.com/users/kimoppalfens/gists{/gist_id}", "starred_url": "https://api.github.com/users/kimoppalfens/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kimoppalfens/subscriptions", "organizations_url": "https://api.github.com/users/kimoppalfens/orgs", "repos_url": "https://api.github.com/users/kimoppalfens/repos", "events_url": "https://api.github.com/users/kimoppalfens/events{/privacy}", "received_events_url": "https://api.github.com/users/kimoppalfens/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-10-23T22:17:43Z", "updated_at": "2020-01-30T18:56:56Z", "closed_at": "2020-01-30T18:56:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a setup where I can connect to a machine running ntlmrelayx.py using HTTP and have the credentials relayed just fine.\r\n\r\nUsing the exact same machines, fails when the connection is initiated over SMB.\r\n[*] SMBD-Thread-150: Received connection from 172.30.20.40, attacking target smb://172.30.10.139\r\n[-] Authenticating against smb://172.30.1.139 as Domain\\administrator FAILED", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/681", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/681/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/681/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/681/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/681", "id": 503158425, "node_id": "MDU6SXNzdWU1MDMxNTg0MjU=", "number": 681, "title": " global name 'DES' is not defined", "user": {"login": "jagdishmohite", "id": 16448416, "node_id": "MDQ6VXNlcjE2NDQ4NDE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16448416?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jagdishmohite", "html_url": "https://github.com/jagdishmohite", "followers_url": "https://api.github.com/users/jagdishmohite/followers", "following_url": "https://api.github.com/users/jagdishmohite/following{/other_user}", "gists_url": "https://api.github.com/users/jagdishmohite/gists{/gist_id}", "starred_url": "https://api.github.com/users/jagdishmohite/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jagdishmohite/subscriptions", "organizations_url": "https://api.github.com/users/jagdishmohite/orgs", "repos_url": "https://api.github.com/users/jagdishmohite/repos", "events_url": "https://api.github.com/users/jagdishmohite/events{/privacy}", "received_events_url": "https://api.github.com/users/jagdishmohite/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-06T20:46:25Z", "updated_at": "2019-10-06T22:51:35Z", "closed_at": "2019-10-06T22:50:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nI updated Impacket, and while using mssqlclient.py,  I get below\r\n\r\nmssqlclient.py -p 1433 reporting@querier.htb -windows-auth\r\nImpacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation\r\n\r\nPassword:\r\n[*] Encryption required, switching to TLS\r\n[-] global name 'DES' is not defined\r\n\r\nnot sure what is wrong?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/678", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/678/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/678/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/678/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/678", "id": 501765013, "node_id": "MDU6SXNzdWU1MDE3NjUwMTM=", "number": 678, "title": "Feature Request - raiseChild.py RID flag", "user": {"login": "mubix", "id": 679319, "node_id": "MDQ6VXNlcjY3OTMxOQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/679319?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mubix", "html_url": "https://github.com/mubix", "followers_url": "https://api.github.com/users/mubix/followers", "following_url": "https://api.github.com/users/mubix/following{/other_user}", "gists_url": "https://api.github.com/users/mubix/gists{/gist_id}", "starred_url": "https://api.github.com/users/mubix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mubix/subscriptions", "organizations_url": "https://api.github.com/users/mubix/orgs", "repos_url": "https://api.github.com/users/mubix/repos", "events_url": "https://api.github.com/users/mubix/events{/privacy}", "received_events_url": "https://api.github.com/users/mubix/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-02T22:50:55Z", "updated_at": "2020-02-17T13:24:51Z", "closed_at": "2020-02-17T13:24:51Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Being able to specify a specific RID/SID to dump automatically instead of the default 500 would be nice in situations where a user might want to pull a different account.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/676", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/676/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/676/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/676/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/676", "id": 498620742, "node_id": "MDU6SXNzdWU0OTg2MjA3NDI=", "number": 676, "title": "dcomexec.py will always return None", "user": {"login": "Explorer1092", "id": 32663226, "node_id": "MDQ6VXNlcjMyNjYzMjI2", "avatar_url": "https://avatars1.githubusercontent.com/u/32663226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Explorer1092", "html_url": "https://github.com/Explorer1092", "followers_url": "https://api.github.com/users/Explorer1092/followers", "following_url": "https://api.github.com/users/Explorer1092/following{/other_user}", "gists_url": "https://api.github.com/users/Explorer1092/gists{/gist_id}", "starred_url": "https://api.github.com/users/Explorer1092/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Explorer1092/subscriptions", "organizations_url": "https://api.github.com/users/Explorer1092/orgs", "repos_url": "https://api.github.com/users/Explorer1092/repos", "events_url": "https://api.github.com/users/Explorer1092/events{/privacy}", "received_events_url": "https://api.github.com/users/Explorer1092/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-26T02:39:57Z", "updated_at": "2020-04-01T14:37:34Z", "closed_at": "2020-04-01T14:37:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/SecureAuthCorp/impacket/blob/master/examples/dcomexec.py#L171\r\n\r\nhttps://docs.python.org/2/library/cmd.html#cmd.Cmd.onecmd\r\n\r\n` If there is a do_*() method for the command str, the return value of that method is returned, otherwise the return value from the default() method is returned.`\r\n\r\nI can not find **return** with \"RemoteShell\" or \"RemoteShellMMC20\"", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/672", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/672/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/672/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/672/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/672", "id": 491600823, "node_id": "MDU6SXNzdWU0OTE2MDA4MjM=", "number": 672, "title": "HTTP to SMB Relay", "user": {"login": "bypass1", "id": 55138567, "node_id": "MDQ6VXNlcjU1MTM4NTY3", "avatar_url": "https://avatars2.githubusercontent.com/u/55138567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bypass1", "html_url": "https://github.com/bypass1", "followers_url": "https://api.github.com/users/bypass1/followers", "following_url": "https://api.github.com/users/bypass1/following{/other_user}", "gists_url": "https://api.github.com/users/bypass1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bypass1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bypass1/subscriptions", "organizations_url": "https://api.github.com/users/bypass1/orgs", "repos_url": "https://api.github.com/users/bypass1/repos", "events_url": "https://api.github.com/users/bypass1/events{/privacy}", "received_events_url": "https://api.github.com/users/bypass1/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-09-10T10:58:50Z", "updated_at": "2020-04-01T14:37:15Z", "closed_at": "2020-04-01T14:37:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "What does this means: 'NoneType' object has no attribute 'sendAuth'?\r\n\r\n[*] HTTPD: Received connection from 10.x.x.x, attacking target smb://10.x.x.x\r\n[*] HTTPD: Client requested path: /\r\n[+] Exception:\r\nTraceback (most recent call last):\r\n  File \"build/bdist.linux-x86_64/egg/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 72, in handle_one_request\r\n    http.server.SimpleHTTPRequestHandler.handle_one_request(self)\r\n  File \"/usr/lib/python2.7/BaseHTTPServer.py\", line 328, in handle_one_request\r\n    method()\r\n  File \"build/bdist.linux-x86_64/egg/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 209, in do_POST\r\n    return self.do_GET()\r\n  File \"build/bdist.linux-x86_64/egg/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 272, in do_GET\r\n    if not self.do_ntlm_auth(token,authenticateMessage):\r\n  File \"build/bdist.linux-x86_64/egg/impacket/examples/ntlmrelayx/servers/httprelayserver.py\", line 368, in do_ntlm_auth\r\n    clientResponse, errorCode = self.client.sendAuth(token)\r\nAttributeError: 'NoneType' object has no attribute 'sendAuth'\r\n[-] Exception in HTTP request handler: 'NoneType' object has no attribute 'sendAuth'", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/666", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/666/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/666/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/666/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/666", "id": 482970246, "node_id": "MDU6SXNzdWU0ODI5NzAyNDY=", "number": 666, "title": "wmiexec.py Unicode issue in Python 3", "user": {"login": "shellster", "id": 262451, "node_id": "MDQ6VXNlcjI2MjQ1MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/262451?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shellster", "html_url": "https://github.com/shellster", "followers_url": "https://api.github.com/users/shellster/followers", "following_url": "https://api.github.com/users/shellster/following{/other_user}", "gists_url": "https://api.github.com/users/shellster/gists{/gist_id}", "starred_url": "https://api.github.com/users/shellster/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shellster/subscriptions", "organizations_url": "https://api.github.com/users/shellster/orgs", "repos_url": "https://api.github.com/users/shellster/repos", "events_url": "https://api.github.com/users/shellster/events{/privacy}", "received_events_url": "https://api.github.com/users/shellster/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-20T16:45:33Z", "updated_at": "2019-08-27T18:03:22Z", "closed_at": "2019-08-27T18:03:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Python version is: 3.7.3\r\nRunning in pipenv so dedicated, clean python.\r\n\r\nKeep running into the following error:\r\n\r\n```\r\npython wmiexec.py -hashes <redacted> '<redacted>/<redacted>@<redacted>'\r\nImpacket v0.9.20-dev - Copyright 2019 SecureAuth Corporation\r\n\r\n[!] Launching semi-interactive shell - Careful what you execute\r\n[!] Press help for extra shell commands\r\nC:\\>D:\r\nb'D:\\\\>'\r\nb'D:\\\\>'cd whatever\r\n[-] 'ENCODED_STRING' object has no attribute 'isUnicode'\r\n```\r\n\r\nAt which point it crashes out.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/664", "repository_url": "https://api.github.com/repos/SecureAuthCorp/impacket", "labels_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/664/labels{/name}", "comments_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/664/comments", "events_url": "https://api.github.com/repos/SecureAuthCorp/impacket/issues/664/events", "html_url": "https://github.com/SecureAuthCorp/impacket/issues/664", "id": 478996434, "node_id": "MDU6SXNzdWU0Nzg5OTY0MzQ=", "number": 664, "title": "rpc_s_access_denied, very common issue with impacket scripts !", "user": {"login": "Spl0itx", "id": 43012373, "node_id": "MDQ6VXNlcjQzMDEyMzcz", "avatar_url": "https://avatars1.githubusercontent.com/u/43012373?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Spl0itx", "html_url": "https://github.com/Spl0itx", "followers_url": "https://api.github.com/users/Spl0itx/followers", "following_url": "https://api.github.com/users/Spl0itx/following{/other_user}", "gists_url": "https://api.github.com/users/Spl0itx/gists{/gist_id}", "starred_url": "https://api.github.com/users/Spl0itx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Spl0itx/subscriptions", "organizations_url": "https://api.github.com/users/Spl0itx/orgs", "repos_url": "https://api.github.com/users/Spl0itx/repos", "events_url": "https://api.github.com/users/Spl0itx/events{/privacy}", "received_events_url": "https://api.github.com/users/Spl0itx/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-09T13:47:49Z", "updated_at": "2019-09-10T18:27:50Z", "closed_at": "2019-09-10T18:27:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "I know there are many topics related to the same issue, I read every single post but there are no solutions fit with my problem. \r\n\r\nI have the same problem with wmiexec, smbexec, atexec, dcomexec,\r\n\r\nI am testing this on my local Windows 10 pro x64\r\n\r\n$ python /usr/share/doc/python-impacket/examples/wmiexec.py user2@192.168.31.131 \"whoami\"\r\nImpacket v0.9.19 - Copyright 2019 SecureAuth Corporation\r\n\r\nPassword:\r\n[*] SMBv3.0 dialect used\r\n[-] rpc_s_access_denied\r\n\r\n\r\nuser2 is in administrators group\r\n\r\nPORT     STATE SERVICE\r\n135/tcp  open  msrpc\r\n139/tcp  open  netbios-ssn\r\n445/tcp  open  microsoft-ds\r\n1539/tcp open  intellistor-lm\r\n\r\n\r\neven with some other scripts in Impacket like services.py\r\n\r\nuser@ubuntu:~/Desktop$ python /usr/share/doc/python-impacket/examples/services.py user2@192.168.31.131 list\r\nImpacket v0.9.19 - Copyright 2019 SecureAuth Corporation\r\n\r\nPassword:\r\n[-] DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied\r\n\r\nThank you all in advanced", "performed_via_github_app": null, "score": 1.0}]}