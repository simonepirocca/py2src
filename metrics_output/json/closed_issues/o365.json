{"total_count": 322, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/O365/python-o365/issues/504", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/504/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/504/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/504/events", "html_url": "https://github.com/O365/python-o365/issues/504", "id": 683091368, "node_id": "MDU6SXNzdWU2ODMwOTEzNjg=", "number": 504, "title": "web app form authentication error on steptwo - babydev needs help", "user": {"login": "mjuliefr", "id": 59387156, "node_id": "MDQ6VXNlcjU5Mzg3MTU2", "avatar_url": "https://avatars0.githubusercontent.com/u/59387156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mjuliefr", "html_url": "https://github.com/mjuliefr", "followers_url": "https://api.github.com/users/mjuliefr/followers", "following_url": "https://api.github.com/users/mjuliefr/following{/other_user}", "gists_url": "https://api.github.com/users/mjuliefr/gists{/gist_id}", "starred_url": "https://api.github.com/users/mjuliefr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mjuliefr/subscriptions", "organizations_url": "https://api.github.com/users/mjuliefr/orgs", "repos_url": "https://api.github.com/users/mjuliefr/repos", "events_url": "https://api.github.com/users/mjuliefr/events{/privacy}", "received_events_url": "https://api.github.com/users/mjuliefr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-20T20:56:57Z", "updated_at": "2020-08-22T05:54:34Z", "closed_at": "2020-08-22T05:54:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi\r\nI really love the work here!  \r\nI am a baby dev. and I would really appreciate some help. I spent a lot of time trying to make it work by myself but I am reaching my limits - really...\r\n\r\nI am trying to setup the webapp authentification with flask and I have hard time with steptwo route in flask.\r\nStepOne works since I am able to sign in and give my consent. Then the browser gives me back the result page url with the code and state section (same as in the console authentification).\r\nHowever, when I have tried to browse https://localhost:5000/steptwo, I have an internal server error and the following error message from flask execution:\r\nERROR:O365.connection:Unable to fetch auth token. Error: (missing_code) Missing code parameter in response.\r\nERROR:flask.app:Exception on /steptwo [GET]....\r\nTypeError: The view function did not return a valid response. The function either returned None or ended without a return statement.\r\nPlus, the token didn't save as in the console mode in stepone. Thus I tried to do it manually with FileSystemTokenBackend, but I did not have much success.   :'(\r\n\r\nThanks in advance for the help,\r\n\r\nJulie\r\n\r\n```\r\nfrom flask import Flask, request, redirect, url_for\r\nimport os\r\nimport logging\r\nimport argparse\r\nfrom O365 import Account, FileSystemTokenBackend\r\nclient_id = '***'  \r\nclient_secret = '***'  \r\ncredentials = (client_id, client_secret)\r\nmy_scopes=['offline_access', 'Files.ReadWrite.All','User.Read']\r\ntoken_backend = FileSystemTokenBackend(token_path='/home/mjulielu/myOtherModules/', token_filename='my_graphtoken.txt')\r\n\r\napp = Flask(__name__)\r\n\r\n@app.route('/stepone')\r\ndef auth_step_one():\r\n    callback = 'https://login.microsoftonline.com/common/oauth2/nativeclient'\r\n    account = Account(credentials, token_backend=token_backend)\r\n    url, state = account.con.get_authorization_url(requested_scopes=my_scopes,\r\n                                                   redirect_uri=callback)\r\n    f = open('nstate.txt', 'w') # I know this is ugly\r\n    f.write(state)\r\n    f.close()\r\n    return redirect(url)\r\n    \r\n@app.route('/steptwo')\r\ndef auth_step_two_callback():\r\n    # retreive the state saved in auth_step_one\r\n    f = open('nstate.txt', 'r') # I know this is ugly\r\n    my_saved_state = f.read() \r\n    f.close()\r\n    logging.warning(my_saved_state) \r\n    account = Account(credentials, token_backend=token_backend) \r\n    logging.warning(account) \r\n    # rebuild the redirect_uri used in auth_step_one\r\n    callback = 'https://login.microsoftonline.com/common/oauth2/nativeclient'\r\n    result = account.con.request_token(request.url, \r\n                                       state=my_saved_state,\r\n                                       redirect_uri=callback)\r\n    # if result is True, then authentication was succesful \r\n    #  and the auth token is stored in the token backend\r\n    if result:\r\n        return render_template('auth_complete.html')\r\n    # else ....\r\n\r\nif __name__ == \"__main__\":\r\n    app.run(ssl_context='adhoc')\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/501", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/501/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/501/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/501/events", "html_url": "https://github.com/O365/python-o365/issues/501", "id": 680347472, "node_id": "MDU6SXNzdWU2ODAzNDc0NzI=", "number": 501, "title": "How to retrieve the category of a calendar event", "user": {"login": "JonathanDyke", "id": 55844603, "node_id": "MDQ6VXNlcjU1ODQ0NjAz", "avatar_url": "https://avatars2.githubusercontent.com/u/55844603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JonathanDyke", "html_url": "https://github.com/JonathanDyke", "followers_url": "https://api.github.com/users/JonathanDyke/followers", "following_url": "https://api.github.com/users/JonathanDyke/following{/other_user}", "gists_url": "https://api.github.com/users/JonathanDyke/gists{/gist_id}", "starred_url": "https://api.github.com/users/JonathanDyke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JonathanDyke/subscriptions", "organizations_url": "https://api.github.com/users/JonathanDyke/orgs", "repos_url": "https://api.github.com/users/JonathanDyke/repos", "events_url": "https://api.github.com/users/JonathanDyke/events{/privacy}", "received_events_url": "https://api.github.com/users/JonathanDyke/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-17T16:05:30Z", "updated_at": "2020-08-18T07:33:16Z", "closed_at": "2020-08-18T07:33:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have retrieved information from calendar events using `calendar.get_events(limit=100, query=q, include_recurring=True, download_attachments=True)` however I can't find how to access the event's category. I've had a look through category.py but can't find what I need to use", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/496", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/496/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/496/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/496/events", "html_url": "https://github.com/O365/python-o365/issues/496", "id": 675739533, "node_id": "MDU6SXNzdWU2NzU3Mzk1MzM=", "number": 496, "title": "Web front end call to FlaskAPI with o365 authentication CORS issue", "user": {"login": "rayamoh", "id": 66139082, "node_id": "MDQ6VXNlcjY2MTM5MDgy", "avatar_url": "https://avatars2.githubusercontent.com/u/66139082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rayamoh", "html_url": "https://github.com/rayamoh", "followers_url": "https://api.github.com/users/rayamoh/followers", "following_url": "https://api.github.com/users/rayamoh/following{/other_user}", "gists_url": "https://api.github.com/users/rayamoh/gists{/gist_id}", "starred_url": "https://api.github.com/users/rayamoh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rayamoh/subscriptions", "organizations_url": "https://api.github.com/users/rayamoh/orgs", "repos_url": "https://api.github.com/users/rayamoh/repos", "events_url": "https://api.github.com/users/rayamoh/events{/privacy}", "received_events_url": "https://api.github.com/users/rayamoh/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-09T17:33:15Z", "updated_at": "2020-08-17T02:28:12Z", "closed_at": "2020-08-17T02:28:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi \r\nI built Flask API using python-o365 to download files from sharepoint using SQL server based token storage and \"On behalf of user\" (authorization authflow).  Works perfect when i call API from browser. Prompts user to login to Azure AD , stores token into dB , fetches token & download files successfully. \r\n  API code structure is same as sample given in README\r\n      -> Authstepone (redirect)\r\n      -> Authsteptwo  (Get token from MS Azure AD) & store token to backend for user/state combo\r\n\r\nBuilt Angular front end to send username & call above API. API is failing with CORS error while calling Microsoft endpoint. Tested with allowed origin=* as well in Flask API. But seems like Microsoft does not allow origin through this type of flow Angular -> Flask API -> redirect to MS login; it works directly Browser Flask API -> redirect to MS login  \r\n\r\nPlease suggest if there is any way to make this work. Angular uses MSAL package to get token (no issue here) , but i am not using it now to pass to Flask API.  \r\nShall i try using token from Angular , store in backend first and use it for pyo365 package? Is this suggested approach to resolve this issue?  But it could fail while refreshing expired tokens , not sure.  \r\nHelp is appreciated. Really love this package and don't want to switch to native GRAPH APIs to achieve downloads.  \r\n\r\n**CORS error:**\r\n```  Access to XMLHttpRequest at 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize?response_type=code&client_id=#####&redirect_uri=https%3A%2F%2Fflasko365APItest.com%2Fauthsteptwo&scope=https%3A%2F%2Fgraph.microsoft.com%2FSites.Read.All+https%3A%2F%2Fgraph.microsoft.com%2FGroup.Read.All&state=lujX6MXVgWDRy34ggexASFK7srP32M&access_type=offline' (redirected from 'https://flasko365APItest.com/coreengine?rootfolder=root&childfolder=jun2020&team=Team1&action=customhierarchy') from origin 'http://localhost:4200' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource.```\r\n\r\n**Endpoints:**\r\n```\r\nAngular URL : http://localhost:4200 \r\nFlask API endpoint : https://flasko365APItest.com/coreengine\r\nMicrosoft login endpoint : https://login.microsoftonline.com/common/oauth2/v2.0/authorize\r\n```\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/494", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/494/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/494/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/494/events", "html_url": "https://github.com/O365/python-o365/issues/494", "id": 670321322, "node_id": "MDU6SXNzdWU2NzAzMjEzMjI=", "number": 494, "title": "[Question] Is it possible to rename an attachment in a message?", "user": {"login": "lcvriend", "id": 43742775, "node_id": "MDQ6VXNlcjQzNzQyNzc1", "avatar_url": "https://avatars0.githubusercontent.com/u/43742775?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcvriend", "html_url": "https://github.com/lcvriend", "followers_url": "https://api.github.com/users/lcvriend/followers", "following_url": "https://api.github.com/users/lcvriend/following{/other_user}", "gists_url": "https://api.github.com/users/lcvriend/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcvriend/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcvriend/subscriptions", "organizations_url": "https://api.github.com/users/lcvriend/orgs", "repos_url": "https://api.github.com/users/lcvriend/repos", "events_url": "https://api.github.com/users/lcvriend/events{/privacy}", "received_events_url": "https://api.github.com/users/lcvriend/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-31T23:06:41Z", "updated_at": "2020-08-01T11:38:02Z", "closed_at": "2020-08-01T11:38:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "First of all, thank you for this very useful library!\r\n\r\nI am trying to create a simple script that will let me forward emails. However I am having a hard time manipulating the attachments connected to the message. One of my goals is to rename the attachment of a message before forwarding it. I have -- somewhat simplistically -- tried the following (there is one test message in the inbox and it has one attachment): \r\n\r\n```Python\r\nfor msg in inbox.get_messages():\r\n    fwd = msg.forward()\r\n    fwd.attachments.download_attachments()\r\n    for attachment in fwd.attachments:\r\n        attachment.name = 'bleep.bloop'\r\n    fwd.save_draft()\r\n```\r\n\r\nThis will create a forward that has the attachment. But it will not rename the attachment. I have also tried to remove the attachment (`fwd.attachments.clear()` and `fwd.attachments.remove(attachment.attachment_id`) in the hopes of re-adding it under a different name but even though I get no errors, the original attachment does not get deleted from the forward.\r\n\r\nIs it possible to achieve this task with this library? If so, could anyone give me some pointers on how I would do this?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/489", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/489/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/489/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/489/events", "html_url": "https://github.com/O365/python-o365/issues/489", "id": 666690376, "node_id": "MDU6SXNzdWU2NjY2OTAzNzY=", "number": 489, "title": "An error occurred while retrieving the body of the email", "user": {"login": "xiaocao162020", "id": 65652326, "node_id": "MDQ6VXNlcjY1NjUyMzI2", "avatar_url": "https://avatars1.githubusercontent.com/u/65652326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiaocao162020", "html_url": "https://github.com/xiaocao162020", "followers_url": "https://api.github.com/users/xiaocao162020/followers", "following_url": "https://api.github.com/users/xiaocao162020/following{/other_user}", "gists_url": "https://api.github.com/users/xiaocao162020/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiaocao162020/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiaocao162020/subscriptions", "organizations_url": "https://api.github.com/users/xiaocao162020/orgs", "repos_url": "https://api.github.com/users/xiaocao162020/repos", "events_url": "https://api.github.com/users/xiaocao162020/events{/privacy}", "received_events_url": "https://api.github.com/users/xiaocao162020/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-07-28T01:46:12Z", "updated_at": "2020-08-14T04:55:22Z", "closed_at": "2020-08-14T04:55:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm going to use this method to get the full text of the message.I want to get the body of an email given a subject, but I don't know how to write the code.Is our method wrong?Should I use the get_body_text method of message.py?But then it shows \r\n\r\n**Traceback (most recent call last):\r\n  File \"C:/PyJobs/O365-Client/Client.py\", line 52, in <module>\r\n    start.mail_or_calendar()\r\n  File \"C:/PyJobs/O365-Client/Client.py\", line 38, in mail_or_calendar\r\n    MailboxActions().read_email()\r\n  File \"C:\\PyJobs\\O365-Client\\mailboxactions.py\", line 60, in read_email\r\n    message.Message().get_body_text()\r\n  File \"C:\\Users\\77933\\AppData\\Local\\Programs\\Python\\Python38\\lib\\site-packages\\O365\\message.py\", line 247, in __init__\r\n    super().__init__(\r\n  File \"C:\\Users\\77933\\AppData\\Local\\Programs\\Python\\Python38\\lib\\site-packages\\O365\\utils\\utils.py\", line 331, in __init__\r\n    raise ValueError('Protocol not provided to Api Component')\r\nValueError: Protocol not provided to Api Component**\r\n\r\nHow do I get the Object ID and pass the get_message method from query to mailbox.py.\r\n\r\nHere's the code we've written:\r\n\r\n**if readbox == '1':\r\n    readbox = mailbox.inbox_folder()\r\n    message.Message().get_body_text()**", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/488", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/488/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/488/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/488/events", "html_url": "https://github.com/O365/python-o365/issues/488", "id": 666271729, "node_id": "MDU6SXNzdWU2NjYyNzE3Mjk=", "number": 488, "title": "Attaching Files to Messages", "user": {"login": "Lukehi", "id": 5360679, "node_id": "MDQ6VXNlcjUzNjA2Nzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/5360679?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lukehi", "html_url": "https://github.com/Lukehi", "followers_url": "https://api.github.com/users/Lukehi/followers", "following_url": "https://api.github.com/users/Lukehi/following{/other_user}", "gists_url": "https://api.github.com/users/Lukehi/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lukehi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lukehi/subscriptions", "organizations_url": "https://api.github.com/users/Lukehi/orgs", "repos_url": "https://api.github.com/users/Lukehi/repos", "events_url": "https://api.github.com/users/Lukehi/events{/privacy}", "received_events_url": "https://api.github.com/users/Lukehi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-07-27T12:54:24Z", "updated_at": "2020-07-27T13:32:56Z", "closed_at": "2020-07-27T13:32:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to attach a csv and pdf to a new_message. The documentation and code don't make it obvious is this is possible with O365. If it is an example would be appreciated.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/483", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/483/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/483/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/483/events", "html_url": "https://github.com/O365/python-o365/issues/483", "id": 657607969, "node_id": "MDU6SXNzdWU2NTc2MDc5Njk=", "number": 483, "title": "Recommended e-mail client to use with python-o365 integration?", "user": {"login": "maitra", "id": 6687675, "node_id": "MDQ6VXNlcjY2ODc2NzU=", "avatar_url": "https://avatars0.githubusercontent.com/u/6687675?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maitra", "html_url": "https://github.com/maitra", "followers_url": "https://api.github.com/users/maitra/followers", "following_url": "https://api.github.com/users/maitra/following{/other_user}", "gists_url": "https://api.github.com/users/maitra/gists{/gist_id}", "starred_url": "https://api.github.com/users/maitra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maitra/subscriptions", "organizations_url": "https://api.github.com/users/maitra/orgs", "repos_url": "https://api.github.com/users/maitra/repos", "events_url": "https://api.github.com/users/maitra/events{/privacy}", "received_events_url": "https://api.github.com/users/maitra/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-07-15T19:46:52Z", "updated_at": "2020-07-23T05:50:32Z", "closed_at": "2020-07-23T05:50:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I am very new to this and was wondering what e-mail client I should use that makes it easy for me to integrate it with python-o365? ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/481", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/481/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/481/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/481/events", "html_url": "https://github.com/O365/python-o365/issues/481", "id": 656184366, "node_id": "MDU6SXNzdWU2NTYxODQzNjY=", "number": 481, "title": "Disable Cert Verify at Account level", "user": {"login": "metalshanked", "id": 57646596, "node_id": "MDQ6VXNlcjU3NjQ2NTk2", "avatar_url": "https://avatars0.githubusercontent.com/u/57646596?v=4", "gravatar_id": "", "url": "https://api.github.com/users/metalshanked", "html_url": "https://github.com/metalshanked", "followers_url": "https://api.github.com/users/metalshanked/followers", "following_url": "https://api.github.com/users/metalshanked/following{/other_user}", "gists_url": "https://api.github.com/users/metalshanked/gists{/gist_id}", "starred_url": "https://api.github.com/users/metalshanked/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/metalshanked/subscriptions", "organizations_url": "https://api.github.com/users/metalshanked/orgs", "repos_url": "https://api.github.com/users/metalshanked/repos", "events_url": "https://api.github.com/users/metalshanked/events{/privacy}", "received_events_url": "https://api.github.com/users/metalshanked/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-07-13T22:21:52Z", "updated_at": "2020-08-17T13:08:20Z", "closed_at": "2020-07-20T19:30:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is there a way to pass in \"verify=False\" at the account level ?   I get the below errors at connection setup itselfCaused by SSLError(SSLError(\"bad handshake: Error([('SSL routines', 'tls_process_server_certificate', 'certificate verify failed')])\")))\r\n\r\nThanks in advance!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/479", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/479/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/479/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/479/events", "html_url": "https://github.com/O365/python-o365/issues/479", "id": 652120180, "node_id": "MDU6SXNzdWU2NTIxMjAxODA=", "number": 479, "title": "Multiple tokens for same app id, app secret", "user": {"login": "Muthukrishna17", "id": 10563861, "node_id": "MDQ6VXNlcjEwNTYzODYx", "avatar_url": "https://avatars0.githubusercontent.com/u/10563861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Muthukrishna17", "html_url": "https://github.com/Muthukrishna17", "followers_url": "https://api.github.com/users/Muthukrishna17/followers", "following_url": "https://api.github.com/users/Muthukrishna17/following{/other_user}", "gists_url": "https://api.github.com/users/Muthukrishna17/gists{/gist_id}", "starred_url": "https://api.github.com/users/Muthukrishna17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Muthukrishna17/subscriptions", "organizations_url": "https://api.github.com/users/Muthukrishna17/orgs", "repos_url": "https://api.github.com/users/Muthukrishna17/repos", "events_url": "https://api.github.com/users/Muthukrishna17/events{/privacy}", "received_events_url": "https://api.github.com/users/Muthukrishna17/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-07T08:33:22Z", "updated_at": "2020-08-16T16:48:41Z", "closed_at": "2020-08-16T16:48:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi @janscas \r\n\r\nOne (silly) question,\r\n\r\nCan we use one app id, app secret and generate multiple no. of tokens? Like say, if I have Dev environment and Production of the same application, can I use the same secret and two different redirect_uris (or same Uris)?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/475", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/475/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/475/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/475/events", "html_url": "https://github.com/O365/python-o365/issues/475", "id": 648948886, "node_id": "MDU6SXNzdWU2NDg5NDg4ODY=", "number": 475, "title": "Question on token expiry", "user": {"login": "Muthukrishna17", "id": 10563861, "node_id": "MDQ6VXNlcjEwNTYzODYx", "avatar_url": "https://avatars0.githubusercontent.com/u/10563861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Muthukrishna17", "html_url": "https://github.com/Muthukrishna17", "followers_url": "https://api.github.com/users/Muthukrishna17/followers", "following_url": "https://api.github.com/users/Muthukrishna17/following{/other_user}", "gists_url": "https://api.github.com/users/Muthukrishna17/gists{/gist_id}", "starred_url": "https://api.github.com/users/Muthukrishna17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Muthukrishna17/subscriptions", "organizations_url": "https://api.github.com/users/Muthukrishna17/orgs", "repos_url": "https://api.github.com/users/Muthukrishna17/repos", "events_url": "https://api.github.com/users/Muthukrishna17/events{/privacy}", "received_events_url": "https://api.github.com/users/Muthukrishna17/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-01T12:38:49Z", "updated_at": "2020-07-07T08:23:24Z", "closed_at": "2020-07-07T08:23:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello there,\r\n\r\nIs there anything that I should do every 90 days if I chose delegated permissions for Outlook365 Rest api or will the api handle it automatically?\r\n\r\nThanks", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/473", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/473/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/473/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/473/events", "html_url": "https://github.com/O365/python-o365/issues/473", "id": 644709312, "node_id": "MDU6SXNzdWU2NDQ3MDkzMTI=", "number": 473, "title": "Multiple inline images addition", "user": {"login": "Muthukrishna17", "id": 10563861, "node_id": "MDQ6VXNlcjEwNTYzODYx", "avatar_url": "https://avatars0.githubusercontent.com/u/10563861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Muthukrishna17", "html_url": "https://github.com/Muthukrishna17", "followers_url": "https://api.github.com/users/Muthukrishna17/followers", "following_url": "https://api.github.com/users/Muthukrishna17/following{/other_user}", "gists_url": "https://api.github.com/users/Muthukrishna17/gists{/gist_id}", "starred_url": "https://api.github.com/users/Muthukrishna17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Muthukrishna17/subscriptions", "organizations_url": "https://api.github.com/users/Muthukrishna17/orgs", "repos_url": "https://api.github.com/users/Muthukrishna17/repos", "events_url": "https://api.github.com/users/Muthukrishna17/events{/privacy}", "received_events_url": "https://api.github.com/users/Muthukrishna17/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-24T15:29:33Z", "updated_at": "2020-08-16T16:48:03Z", "closed_at": "2020-08-16T16:48:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "How to add multiple inline images within a HTML content as message?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/472", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/472/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/472/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/472/events", "html_url": "https://github.com/O365/python-o365/issues/472", "id": 643274988, "node_id": "MDU6SXNzdWU2NDMyNzQ5ODg=", "number": 472, "title": "Size larger than 4 MB even though the zip file size is 3.47 MB.", "user": {"login": "abhie-lp", "id": 26081193, "node_id": "MDQ6VXNlcjI2MDgxMTkz", "avatar_url": "https://avatars2.githubusercontent.com/u/26081193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhie-lp", "html_url": "https://github.com/abhie-lp", "followers_url": "https://api.github.com/users/abhie-lp/followers", "following_url": "https://api.github.com/users/abhie-lp/following{/other_user}", "gists_url": "https://api.github.com/users/abhie-lp/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhie-lp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhie-lp/subscriptions", "organizations_url": "https://api.github.com/users/abhie-lp/orgs", "repos_url": "https://api.github.com/users/abhie-lp/repos", "events_url": "https://api.github.com/users/abhie-lp/events{/privacy}", "received_events_url": "https://api.github.com/users/abhie-lp/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-22T18:23:48Z", "updated_at": "2020-06-24T13:37:16Z", "closed_at": "2020-06-24T13:37:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "i had send some excel files,  but sending them in one email was giving error of size > 4 MB. So i compressed them and now the size was 3.47 MB but still it is not sending them. Tried the MSGraphProtocol with beta api_version but still the same. Any help where i maybe doing wrong??\r\n\r\n ```\r\nmail.send()\r\n  File \"C:\\Users\\pxil\\anaconda3\\lib\\site-packages\\O365\\message.py\", line 694, in send\r\n    response = self.con.post(url, data=data)\r\n  File \"C:\\Users\\pxil\\anaconda3\\lib\\site-packages\\O365\\connection.py\", line 794, in post\r\n    return self.oauth_request(url, 'post', data=data, **kwargs)\r\n  File \"C:\\Users\\pxil\\anaconda3\\lib\\site-packages\\O365\\connection.py\", line 772, in oauth_request\r\n    return self._internal_request(self.session, url, method, **kwargs)\r\n  File \"C:\\Users\\pxil\\anaconda3\\lib\\site-packages\\O365\\connection.py\", line 734, in _internal_request\r\n    raise HTTPError('{} | Error Message: {}'.format(e.args[0], error_message), response=response) from None\r\nrequests.exceptions.HTTPError: 413 Client Error: Request Entity Too Large for url: https://graph.microsoft.com/v1.0/me/sendMail | Error Message: The maximum request length supported is 4MB.\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/470", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/470/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/470/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/470/events", "html_url": "https://github.com/O365/python-o365/issues/470", "id": 642512098, "node_id": "MDU6SXNzdWU2NDI1MTIwOTg=", "number": 470, "title": "Find API properties", "user": {"login": "riload35", "id": 17023381, "node_id": "MDQ6VXNlcjE3MDIzMzgx", "avatar_url": "https://avatars1.githubusercontent.com/u/17023381?v=4", "gravatar_id": "", "url": "https://api.github.com/users/riload35", "html_url": "https://github.com/riload35", "followers_url": "https://api.github.com/users/riload35/followers", "following_url": "https://api.github.com/users/riload35/following{/other_user}", "gists_url": "https://api.github.com/users/riload35/gists{/gist_id}", "starred_url": "https://api.github.com/users/riload35/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/riload35/subscriptions", "organizations_url": "https://api.github.com/users/riload35/orgs", "repos_url": "https://api.github.com/users/riload35/repos", "events_url": "https://api.github.com/users/riload35/events{/privacy}", "received_events_url": "https://api.github.com/users/riload35/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-21T07:26:07Z", "updated_at": "2020-06-23T18:39:38Z", "closed_at": "2020-06-23T17:53:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nI am a beginner in programming and I want to know where we can find the list of properties ('on_attributes' like 'created_date_time' for emails for example) of the Microsoft APIs in order to create filters. I searched unsuccessfully and I am currently working blind.\r\nThank you very much for your work !", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/469", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/469/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/469/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/469/events", "html_url": "https://github.com/O365/python-o365/issues/469", "id": 642000420, "node_id": "MDU6SXNzdWU2NDIwMDA0MjA=", "number": 469, "title": "something error", "user": {"login": "Micraow", "id": 48644801, "node_id": "MDQ6VXNlcjQ4NjQ0ODAx", "avatar_url": "https://avatars0.githubusercontent.com/u/48644801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Micraow", "html_url": "https://github.com/Micraow", "followers_url": "https://api.github.com/users/Micraow/followers", "following_url": "https://api.github.com/users/Micraow/following{/other_user}", "gists_url": "https://api.github.com/users/Micraow/gists{/gist_id}", "starred_url": "https://api.github.com/users/Micraow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Micraow/subscriptions", "organizations_url": "https://api.github.com/users/Micraow/orgs", "repos_url": "https://api.github.com/users/Micraow/repos", "events_url": "https://api.github.com/users/Micraow/events{/privacy}", "received_events_url": "https://api.github.com/users/Micraow/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-19T14:13:36Z", "updated_at": "2020-06-20T08:45:50Z", "closed_at": "2020-06-20T08:45:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Unable to fetch auth token. Error: (invalid_client) AADSTS700025: Client is public so neither 'client_assertion' nor 'client_secret' should be presented.\r\n\r\nTrace ID: 43d77fa0-0f4d-4b83-ac05-b05592320801\r\n\r\nCorrelation ID: 6f214225-c2c2-4b66-b2bb-232bd77f8e5d\r\n\r\nTimestamp: 2020-06-19 14:12:06Z", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/464", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/464/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/464/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/464/events", "html_url": "https://github.com/O365/python-o365/issues/464", "id": 630146623, "node_id": "MDU6SXNzdWU2MzAxNDY2MjM=", "number": 464, "title": "Exception when creatin an Attendee", "user": {"login": "waldo2188", "id": 841872, "node_id": "MDQ6VXNlcjg0MTg3Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/841872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/waldo2188", "html_url": "https://github.com/waldo2188", "followers_url": "https://api.github.com/users/waldo2188/followers", "following_url": "https://api.github.com/users/waldo2188/following{/other_user}", "gists_url": "https://api.github.com/users/waldo2188/gists{/gist_id}", "starred_url": "https://api.github.com/users/waldo2188/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/waldo2188/subscriptions", "organizations_url": "https://api.github.com/users/waldo2188/orgs", "repos_url": "https://api.github.com/users/waldo2188/repos", "events_url": "https://api.github.com/users/waldo2188/events{/privacy}", "received_events_url": "https://api.github.com/users/waldo2188/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268450, "node_id": "MDU6TGFiZWwxNzgyNjg0NTA=", "url": "https://api.github.com/repos/O365/python-o365/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-03T16:32:13Z", "updated_at": "2020-06-04T14:03:29Z", "closed_at": "2020-06-04T14:03:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to create an Attendee to add it to a new event, like the code bellow :\r\n\r\n` schedule = account.schedule()\r\n\r\ncalendar = schedule.get_default_calendar()\r\nnew_event= calendar.new_event()\r\n\r\nfrom O365.calendar import Attendee\r\nnew_attendee = Attendee('example@example.com',  attendee_type='required')\r\nnew_event.attendees.add(new_attendee )`\r\n\r\nBut this raise an exception : \r\n`Traceback (most recent call last):\r\n  File \"O365\\calendar.py\", line 562, in __init__\r\n    self.attendee_type = attendee_type\r\n  File \"O365\\calendar.py\", line 634, in attendee_type\r\n    self._track_changes()\r\n  File \"O365\\calendar.py\", line 608, in _track_changes\r\n    self._event._track_changes.add('attendees')\r\nAttributeError: 'NoneType' object has no attribute '_track_changes'`\r\n\r\nI'm pretty new with python, so maybe i'm missing something.\r\n\r\nBy the way, It's an awesome project \ud83d\udc4d", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/462", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/462/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/462/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/462/events", "html_url": "https://github.com/O365/python-o365/issues/462", "id": 626887864, "node_id": "MDU6SXNzdWU2MjY4ODc4NjQ=", "number": 462, "title": "Authentication flow to get a token no longer works", "user": {"login": "catichenor", "id": 6588198, "node_id": "MDQ6VXNlcjY1ODgxOTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/6588198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catichenor", "html_url": "https://github.com/catichenor", "followers_url": "https://api.github.com/users/catichenor/followers", "following_url": "https://api.github.com/users/catichenor/following{/other_user}", "gists_url": "https://api.github.com/users/catichenor/gists{/gist_id}", "starred_url": "https://api.github.com/users/catichenor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catichenor/subscriptions", "organizations_url": "https://api.github.com/users/catichenor/orgs", "repos_url": "https://api.github.com/users/catichenor/repos", "events_url": "https://api.github.com/users/catichenor/events{/privacy}", "received_events_url": "https://api.github.com/users/catichenor/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-28T23:32:05Z", "updated_at": "2020-05-29T22:19:26Z", "closed_at": "2020-05-29T22:19:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "A recent server-side authentication error appears to have invalidated all of the API access tokens that we have at my company, so I need to generate a new one as noted in the documentation at https://o365.github.io/python-o365/latest/html/usage/account.html#authenticating-your-account . \r\n\r\nFollowing the instructions in the docs, the page to authenticate no longer has the URL in the correct format. There is a note on that page that \"If the url is simply https://outlook.office.com/owa/?realm=blahblah, and nothing else after that.. then you are currently on new Outlook look, revert back to old look and try the authentication flow again\". This appears to be the case. But, the old Outlook look is [no longer available as of September 2019](https://answers.microsoft.com/en-us/msoffice/forum/all/revert-to-previous-version-of-officeoutlook-365/c0662da4-3d7f-4343-b148-833fccba8dbc). \r\n\r\nIs there any way to work around this?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/454", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/454/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/454/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/454/events", "html_url": "https://github.com/O365/python-o365/issues/454", "id": 623093108, "node_id": "MDU6SXNzdWU2MjMwOTMxMDg=", "number": 454, "title": "Improvement: useful links in Readme.md", "user": {"login": "stardust85", "id": 3637559, "node_id": "MDQ6VXNlcjM2Mzc1NTk=", "avatar_url": "https://avatars0.githubusercontent.com/u/3637559?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stardust85", "html_url": "https://github.com/stardust85", "followers_url": "https://api.github.com/users/stardust85/followers", "following_url": "https://api.github.com/users/stardust85/following{/other_user}", "gists_url": "https://api.github.com/users/stardust85/gists{/gist_id}", "starred_url": "https://api.github.com/users/stardust85/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stardust85/subscriptions", "organizations_url": "https://api.github.com/users/stardust85/orgs", "repos_url": "https://api.github.com/users/stardust85/repos", "events_url": "https://api.github.com/users/stardust85/events{/privacy}", "received_events_url": "https://api.github.com/users/stardust85/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1330339915, "node_id": "MDU6TGFiZWwxMzMwMzM5OTE1", "url": "https://api.github.com/repos/O365/python-o365/labels/documentation", "name": "documentation", "color": "d4c5f9", "default": true, "description": "enhance documentation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-22T09:52:34Z", "updated_at": "2020-05-22T10:28:43Z", "closed_at": "2020-05-22T10:27:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Something easy to start with :)\r\n\r\nI like the quick links and status information some projects have in Readme.md like link to PYPI, python versions, build status, coverage etc. Gonna start w/ link to PYPI if you don't mind :)\r\n\r\nBasically I'm gonna steal it from https://github.com/vgrem/Office365-REST-Python-Client/blob/master/README.md from paragraph Status :-D", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/453", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/453/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/453/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/453/events", "html_url": "https://github.com/O365/python-o365/issues/453", "id": 619854889, "node_id": "MDU6SXNzdWU2MTk4NTQ4ODk=", "number": 453, "title": "Multi user application (Question)", "user": {"login": "mohanrkrishna", "id": 14855986, "node_id": "MDQ6VXNlcjE0ODU1OTg2", "avatar_url": "https://avatars0.githubusercontent.com/u/14855986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mohanrkrishna", "html_url": "https://github.com/mohanrkrishna", "followers_url": "https://api.github.com/users/mohanrkrishna/followers", "following_url": "https://api.github.com/users/mohanrkrishna/following{/other_user}", "gists_url": "https://api.github.com/users/mohanrkrishna/gists{/gist_id}", "starred_url": "https://api.github.com/users/mohanrkrishna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mohanrkrishna/subscriptions", "organizations_url": "https://api.github.com/users/mohanrkrishna/orgs", "repos_url": "https://api.github.com/users/mohanrkrishna/repos", "events_url": "https://api.github.com/users/mohanrkrishna/events{/privacy}", "received_events_url": "https://api.github.com/users/mohanrkrishna/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-18T01:58:40Z", "updated_at": "2020-05-20T04:42:22Z", "closed_at": "2020-05-20T04:42:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi \r\nCurious to know how FileSystemTokenBackend works with multi users accessing Flask/Python web app using this package. \r\n\r\nTo be able to have token file based on each user , have to find principal id or email first. But principal id can be retrieved only after request_token method is called.  I am planning to implement SQL server based TokenBackend in future, even for that need to know principal id first to check token exists or not before requesting new token. \r\n\r\nCan you please share best way to implement multi-users scenario. Thanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/447", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/447/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/447/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/447/events", "html_url": "https://github.com/O365/python-o365/issues/447", "id": 618608931, "node_id": "MDU6SXNzdWU2MTg2MDg5MzE=", "number": 447, "title": "Authenticate Web : Store state question", "user": {"login": "mohanrkrishna", "id": 14855986, "node_id": "MDQ6VXNlcjE0ODU1OTg2", "avatar_url": "https://avatars0.githubusercontent.com/u/14855986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mohanrkrishna", "html_url": "https://github.com/mohanrkrishna", "followers_url": "https://api.github.com/users/mohanrkrishna/followers", "following_url": "https://api.github.com/users/mohanrkrishna/following{/other_user}", "gists_url": "https://api.github.com/users/mohanrkrishna/gists{/gist_id}", "starred_url": "https://api.github.com/users/mohanrkrishna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mohanrkrishna/subscriptions", "organizations_url": "https://api.github.com/users/mohanrkrishna/orgs", "repos_url": "https://api.github.com/users/mohanrkrishna/repos", "events_url": "https://api.github.com/users/mohanrkrishna/events{/privacy}", "received_events_url": "https://api.github.com/users/mohanrkrishna/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-15T00:09:18Z", "updated_at": "2020-08-20T04:15:37Z", "closed_at": "2020-05-15T15:11:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi - Following Web authentication schemes, trying flask code. Have below question, please assist. \r\nAfter getting state in step#1 , it is mentioned to store the state (below code.store_state). Please elaborate how to use FileSystemTokenBackend and implement \".store_state\"  & \".get_state()\" functions. Thanks very much!   \r\n\r\nmy_db.store_state(state)\r\n\r\nFileSystemTokenBackend ===>\r\ntoken_backend = FileSystemTokenBackend(token_path='my_folder', token_filename='my_token.txt')\r\naccount = Account(credentials, token_backend=token_backend)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/442", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/442/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/442/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/442/events", "html_url": "https://github.com/O365/python-o365/issues/442", "id": 615500798, "node_id": "MDU6SXNzdWU2MTU1MDA3OTg=", "number": 442, "title": "Flask redirect uri", "user": {"login": "victorawogbemi", "id": 21068868, "node_id": "MDQ6VXNlcjIxMDY4ODY4", "avatar_url": "https://avatars3.githubusercontent.com/u/21068868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/victorawogbemi", "html_url": "https://github.com/victorawogbemi", "followers_url": "https://api.github.com/users/victorawogbemi/followers", "following_url": "https://api.github.com/users/victorawogbemi/following{/other_user}", "gists_url": "https://api.github.com/users/victorawogbemi/gists{/gist_id}", "starred_url": "https://api.github.com/users/victorawogbemi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/victorawogbemi/subscriptions", "organizations_url": "https://api.github.com/users/victorawogbemi/orgs", "repos_url": "https://api.github.com/users/victorawogbemi/repos", "events_url": "https://api.github.com/users/victorawogbemi/events{/privacy}", "received_events_url": "https://api.github.com/users/victorawogbemi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-10T23:31:10Z", "updated_at": "2020-05-15T03:38:20Z", "closed_at": "2020-05-12T01:02:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I use my absolute uri for step 2 i.e http://127.0.0.1:5000/steptwo I get this error\r\n\r\nWe're unable to complete your request\r\ninvalid_request: The provided value for the input parameter 'redirect_uri' is not valid. The expected value is a URI which matches a redirect URI registered for this client application.\r\n\r\nThen when I replace request uri with the registered uri in the azure app the screen doesn't load and I get some scope errors in the uri box i.e \r\n\r\nhttps://login.microsoftonline.com/common/oauth2/nativeclient?error=invalid_scope&error_description=The%20provided%20value%20for%20the%20input%20parameter%20%27scope%27%20is%20not%20valid.%20The%20scope%20%27https://graph.microsoft.com/Mail.ReadWrite%20https://graph.microsoft.com/Mail.Send%20https://graph.microsoft.com/Offline.Access%20https://graph.microsoft.com/User.Read%27%20does%20not%20exist.&state=R0epKg06vBim3wdfjjfR0HtX2rFeNg", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/440", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/440/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/440/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/440/events", "html_url": "https://github.com/O365/python-o365/issues/440", "id": 613378738, "node_id": "MDU6SXNzdWU2MTMzNzg3Mzg=", "number": 440, "title": "Delete expired token?", "user": {"login": "jdejoode", "id": 10449733, "node_id": "MDQ6VXNlcjEwNDQ5NzMz", "avatar_url": "https://avatars2.githubusercontent.com/u/10449733?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdejoode", "html_url": "https://github.com/jdejoode", "followers_url": "https://api.github.com/users/jdejoode/followers", "following_url": "https://api.github.com/users/jdejoode/following{/other_user}", "gists_url": "https://api.github.com/users/jdejoode/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdejoode/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdejoode/subscriptions", "organizations_url": "https://api.github.com/users/jdejoode/orgs", "repos_url": "https://api.github.com/users/jdejoode/repos", "events_url": "https://api.github.com/users/jdejoode/events{/privacy}", "received_events_url": "https://api.github.com/users/jdejoode/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-06T14:46:32Z", "updated_at": "2020-05-13T12:33:29Z", "closed_at": "2020-05-13T12:33:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi\r\n\r\nI have a case where a token was expired (I didn't renew it within 90 days). When I try to redo the authentication process for that user, however, graph keeps on giving me that exact expired token. I go through the authentication steps 1 and 2 but I get the same token.\r\n\r\nIs there a way to delete a token that is expired so that a new token (meaning a new auth connection) can be received?\r\n\r\nThanks", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/437", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/437/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/437/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/437/events", "html_url": "https://github.com/O365/python-o365/issues/437", "id": 611292169, "node_id": "MDU6SXNzdWU2MTEyOTIxNjk=", "number": 437, "title": "PersonalNotes support in Contacts", "user": {"login": "jgrigera", "id": 231562, "node_id": "MDQ6VXNlcjIzMTU2Mg==", "avatar_url": "https://avatars3.githubusercontent.com/u/231562?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jgrigera", "html_url": "https://github.com/jgrigera", "followers_url": "https://api.github.com/users/jgrigera/followers", "following_url": "https://api.github.com/users/jgrigera/following{/other_user}", "gists_url": "https://api.github.com/users/jgrigera/gists{/gist_id}", "starred_url": "https://api.github.com/users/jgrigera/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jgrigera/subscriptions", "organizations_url": "https://api.github.com/users/jgrigera/orgs", "repos_url": "https://api.github.com/users/jgrigera/repos", "events_url": "https://api.github.com/users/jgrigera/events{/privacy}", "received_events_url": "https://api.github.com/users/jgrigera/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 198099888, "node_id": "MDU6TGFiZWwxOTgwOTk4ODg=", "url": "https://api.github.com/repos/O365/python-o365/labels/Feature%20Request", "name": "Feature Request", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-02T23:04:46Z", "updated_at": "2020-05-04T10:52:53Z", "closed_at": "2020-05-04T10:52:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "Could I request to have PersonalNotes retrieved and written in address_book/Contacts? They are called 'notes' in OWA and PersonalNotes in the API call. I could try a pull request but I am not familiar with the code yet.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/435", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/435/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/435/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/435/events", "html_url": "https://github.com/O365/python-o365/issues/435", "id": 609147652, "node_id": "MDU6SXNzdWU2MDkxNDc2NTI=", "number": 435, "title": "Message Protection - send encrypted email", "user": {"login": "Jaguar25", "id": 20666341, "node_id": "MDQ6VXNlcjIwNjY2MzQx", "avatar_url": "https://avatars2.githubusercontent.com/u/20666341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jaguar25", "html_url": "https://github.com/Jaguar25", "followers_url": "https://api.github.com/users/Jaguar25/followers", "following_url": "https://api.github.com/users/Jaguar25/following{/other_user}", "gists_url": "https://api.github.com/users/Jaguar25/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jaguar25/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jaguar25/subscriptions", "organizations_url": "https://api.github.com/users/Jaguar25/orgs", "repos_url": "https://api.github.com/users/Jaguar25/repos", "events_url": "https://api.github.com/users/Jaguar25/events{/privacy}", "received_events_url": "https://api.github.com/users/Jaguar25/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-29T15:26:48Z", "updated_at": "2020-04-29T21:39:48Z", "closed_at": "2020-04-29T21:27:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is this capable of sending o365 email using Message Protection functionality.\r\n\r\nE.g. now, using simple Outlook O365, i can simply send email with subject line containing word \"(encrypt)\" and that would enable o365 to use Message Protection. \r\nI tried that with this library/python and it did not work for me.\r\n\r\nIs this in functionality (maybe i'm missing something) or in dev pipeline?\r\n\r\nThanks ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/432", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/432/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/432/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/432/events", "html_url": "https://github.com/O365/python-o365/issues/432", "id": 608678195, "node_id": "MDU6SXNzdWU2MDg2NzgxOTU=", "number": 432, "title": "Teams meetings joinUrl not exposed in Event", "user": {"login": "TimoteusRuotsalainen", "id": 8692463, "node_id": "MDQ6VXNlcjg2OTI0NjM=", "avatar_url": "https://avatars1.githubusercontent.com/u/8692463?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TimoteusRuotsalainen", "html_url": "https://github.com/TimoteusRuotsalainen", "followers_url": "https://api.github.com/users/TimoteusRuotsalainen/followers", "following_url": "https://api.github.com/users/TimoteusRuotsalainen/following{/other_user}", "gists_url": "https://api.github.com/users/TimoteusRuotsalainen/gists{/gist_id}", "starred_url": "https://api.github.com/users/TimoteusRuotsalainen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TimoteusRuotsalainen/subscriptions", "organizations_url": "https://api.github.com/users/TimoteusRuotsalainen/orgs", "repos_url": "https://api.github.com/users/TimoteusRuotsalainen/repos", "events_url": "https://api.github.com/users/TimoteusRuotsalainen/events{/privacy}", "received_events_url": "https://api.github.com/users/TimoteusRuotsalainen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268452, "node_id": "MDU6TGFiZWwxNzgyNjg0NTI=", "url": "https://api.github.com/repos/O365/python-o365/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-28T23:27:31Z", "updated_at": "2020-04-30T09:00:21Z", "closed_at": "2020-04-30T09:00:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "I noticed that onlineMeetingUrl is used here\r\nhttps://github.com/O365/python-o365/blob/master/O365/calendar.py#L868\r\n\r\nThis provides None when the calendar event is a teams for business online meeting.\r\n\r\nAccording to https://docs.microsoft.com/en-us/graph/outlook-calendar-online-meetings?tabs=http#code-try-0\r\n> Access the URL to join a meeting using joinUrl, available via the onlineMeeting property of the event. Do not use the onlineMeetingUrl property of the event because onlineMeetingUrl will soon be deprecated. \r\n\r\nI tested just adding this and it seemed to work.\r\n`self.online_meeting = cloud_data.get(cc('onlineMeeting'), None)`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/431", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/431/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/431/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/431/events", "html_url": "https://github.com/O365/python-o365/issues/431", "id": 607192172, "node_id": "MDU6SXNzdWU2MDcxOTIxNzI=", "number": 431, "title": "Question: Event Unique ID?", "user": {"login": "yanicakj", "id": 20134674, "node_id": "MDQ6VXNlcjIwMTM0Njc0", "avatar_url": "https://avatars0.githubusercontent.com/u/20134674?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yanicakj", "html_url": "https://github.com/yanicakj", "followers_url": "https://api.github.com/users/yanicakj/followers", "following_url": "https://api.github.com/users/yanicakj/following{/other_user}", "gists_url": "https://api.github.com/users/yanicakj/gists{/gist_id}", "starred_url": "https://api.github.com/users/yanicakj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yanicakj/subscriptions", "organizations_url": "https://api.github.com/users/yanicakj/orgs", "repos_url": "https://api.github.com/users/yanicakj/repos", "events_url": "https://api.github.com/users/yanicakj/events{/privacy}", "received_events_url": "https://api.github.com/users/yanicakj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268455, "node_id": "MDU6TGFiZWwxNzgyNjg0NTU=", "url": "https://api.github.com/repos/O365/python-o365/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-27T02:52:20Z", "updated_at": "2020-05-04T22:58:49Z", "closed_at": "2020-05-04T22:58:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi Alejandro,\r\n\r\nDo events returned from `calendar.get_events(...)` have a unique ID?\r\n\r\nFor example, if there are 3 different programs using `get_events(...)`, is there some unique ID for each event that can always be used to identify the events uniquely (globally) on calendar?\r\n\r\nLooking at the `event.to_api_data()` function returns a lot of useful data but can't find unique ID (most likely managed by MSFT?)\r\n\r\nWas experimenting with `event.ical_uid` and `event.object_id` but not sure if these will always be the same across all programs using the API?\r\n\r\nThank you for the great library,\r\nJacob\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/427", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/427/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/427/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/427/events", "html_url": "https://github.com/O365/python-o365/issues/427", "id": 604080335, "node_id": "MDU6SXNzdWU2MDQwODAzMzU=", "number": 427, "title": "Error The provided request must include a 'scope' input parameter. when using helpers and account", "user": {"login": "ajwillo", "id": 24481217, "node_id": "MDQ6VXNlcjI0NDgxMjE3", "avatar_url": "https://avatars1.githubusercontent.com/u/24481217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ajwillo", "html_url": "https://github.com/ajwillo", "followers_url": "https://api.github.com/users/ajwillo/followers", "following_url": "https://api.github.com/users/ajwillo/following{/other_user}", "gists_url": "https://api.github.com/users/ajwillo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ajwillo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ajwillo/subscriptions", "organizations_url": "https://api.github.com/users/ajwillo/orgs", "repos_url": "https://api.github.com/users/ajwillo/repos", "events_url": "https://api.github.com/users/ajwillo/events{/privacy}", "received_events_url": "https://api.github.com/users/ajwillo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-04-21T15:16:31Z", "updated_at": "2020-04-24T10:41:56Z", "closed_at": "2020-04-24T10:41:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello,\r\n\r\nim running o365-2.0.9 and am coming across an issue authenticating scopes, the output is below: -\r\n\r\n```\r\n>>> creds = get_credentials('365 api')\r\n>>> account = Account((creds.username, creds.password), auth_flow_type='credentials', tenant_id='*************1')\r\n>>> my_desired_scopes = ['message_all','calendar_all','basic']\r\n>>> account.authenticate(scopes=my_desired_scopes)\r\nUnable to fetch auth token. Error: (invalid_scope) AADSTS70011: The provided request must include a 'scope' input parameter. The provided value for the input parameter 'scope' is not valid. The scope message_all calendar_all basic is not valid.\r\nTrace ID: 6f127854-04f1-4cef-b8af-d1d7bca71c00\r\nCorrelation ID: a602ff13-87c3-4ad0-9e29-ae212d6c9388\r\nTimestamp: 2020-04-21 15:07:30Z\r\nFalse\r\n>>>\r\n```\r\n\r\nauth without scope works but then I cannot query the mailbox\r\n\r\n```\r\n>>> account.authenticate()\r\nTrue\r\n>>>\r\n>>> messages = mailbox.get_messages(query=query)\r\nClient Error: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/mailbox@mydomain.com/messages?%24top=25&%24filter=contains%28from%2FemailAddress%2Faddress%2C+%27%40mydomain.com%27%29+and+subject+eq+%27who%27+and+isRead+eq+false | Error Message: The token contains no permissions, or permissions can not be understood.\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.7/site-packages/O365/mailbox.py\", line 212, in get_messages\r\n    response = self.con.get(url, params=params)\r\n  File \"/usr/local/lib/python3.7/site-packages/O365/connection.py\", line 783, in get\r\n    return self.oauth_request(url, 'get', params=params, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/O365/connection.py\", line 772, in oauth_request\r\n    return self._internal_request(self.session, url, method, **kwargs)\r\n  File \"/usr/local/lib/python3.7/site-packages/O365/connection.py\", line 734, in _internal_request\r\n    raise HTTPError('{} | Error Message: {}'.format(e.args[0], error_message), response=response) from None\r\nrequests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/users/mailbox l@mydomain.com/messages?%24top=25&%24filter=contains%28from%2FemailAddress%2Faddress%2C+%27%40mydomain.com%27%29+and+subject+eq+%27who%27+and+isRead+eq+false | Error Message: The token contains no permissions, or permissions can not be understood.\r\n```\r\n\r\ntoken data\r\n\r\n```\r\n{\r\n \"token_type\": \"Bearer\",\r\n \"expires_in\": 3599,\r\n \"ext_expires_in\": 3599,\r\n \"access_token\": \"ey...\",\r\n \"expires_at\": 1587485648.0909579\r\n}\r\n```\r\nthanks for your help", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/423", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/423/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/423/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/423/events", "html_url": "https://github.com/O365/python-o365/issues/423", "id": 599526510, "node_id": "MDU6SXNzdWU1OTk1MjY1MTA=", "number": 423, "title": "Create Permanent/90 Day Token and access it", "user": {"login": "Zeakles", "id": 48458367, "node_id": "MDQ6VXNlcjQ4NDU4MzY3", "avatar_url": "https://avatars2.githubusercontent.com/u/48458367?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zeakles", "html_url": "https://github.com/Zeakles", "followers_url": "https://api.github.com/users/Zeakles/followers", "following_url": "https://api.github.com/users/Zeakles/following{/other_user}", "gists_url": "https://api.github.com/users/Zeakles/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zeakles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zeakles/subscriptions", "organizations_url": "https://api.github.com/users/Zeakles/orgs", "repos_url": "https://api.github.com/users/Zeakles/repos", "events_url": "https://api.github.com/users/Zeakles/events{/privacy}", "received_events_url": "https://api.github.com/users/Zeakles/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-14T12:12:33Z", "updated_at": "2020-04-15T01:43:13Z", "closed_at": "2020-04-15T01:43:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello i have currently the following code:\r\n\r\n`from O365 import Account\r\nfrom O365.excel import WorkBook\r\n\r\ncredentials = ('****', '****')\r\nscopes = ['Files.ReadWrite.All','Files.ReadWrite','Files.Read.All','Files.Read','onedrive','basic'] \r\n\r\naccount = Account(credentials)\r\n\r\naccount.authenticate(scopes=scopes) \r\n\r\nstorage = account.storage()\r\n\r\nmy_drive = storage.get_default_drive()\r\n\r\nroot_folder = my_drive.get_root_folder()\r\n\r\nfor item in root_folder.get_items(limit=25):\r\n    if item.is_file:\r\n        file = item\r\n        print(file)\r\n        break\r\nexcel_file = WorkBook(file)`\r\n\r\nNow i want that this code works automatically without any user input every day. What do i have to change or configure to make this feature possible?\r\n\r\nThe manuell authentification is currently the biggest problem for my automation.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/421", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/421/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/421/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/421/events", "html_url": "https://github.com/O365/python-o365/issues/421", "id": 598090211, "node_id": "MDU6SXNzdWU1OTgwOTAyMTE=", "number": 421, "title": "Can't get file from a shared OneDrive folder", "user": {"login": "blanning19", "id": 5015877, "node_id": "MDQ6VXNlcjUwMTU4Nzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5015877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blanning19", "html_url": "https://github.com/blanning19", "followers_url": "https://api.github.com/users/blanning19/followers", "following_url": "https://api.github.com/users/blanning19/following{/other_user}", "gists_url": "https://api.github.com/users/blanning19/gists{/gist_id}", "starred_url": "https://api.github.com/users/blanning19/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blanning19/subscriptions", "organizations_url": "https://api.github.com/users/blanning19/orgs", "repos_url": "https://api.github.com/users/blanning19/repos", "events_url": "https://api.github.com/users/blanning19/events{/privacy}", "received_events_url": "https://api.github.com/users/blanning19/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268450, "node_id": "MDU6TGFiZWwxNzgyNjg0NTA=", "url": "https://api.github.com/repos/O365/python-o365/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-04-10T20:53:24Z", "updated_at": "2020-07-20T12:26:41Z", "closed_at": "2020-04-15T21:55:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I am trying to pull and push files into and Shared folder but get a 404 error.\r\nCode snippet:\r\naccount = O365.Account(credentials)\r\nstorage = account.storage() \r\nmy_drive = storage.get_default_drive()\r\nshared_folder = my_drive.get_shared_with_me()\r\n\r\nfor item in shared_folder:\r\n\r\n    if str(item) == \"File: JasonEcarTest.xlsx\":\r\n        onedrive_file = my_drive.get_item(item.object_id)\r\n\r\nThis will return an error:\r\nHTTPError: 404 Client Error: Not Found for url: https://graph.microsoft.com/v1.0/me/drive/items/017WW2JUGHVHU6BYOV7ZB2YZP6BTEWKU5P | Error Message: The resource could not be found.\r\n\r\nI think this is because get_item() looks at my drives not my shared.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/420", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/420/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/420/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/420/events", "html_url": "https://github.com/O365/python-o365/issues/420", "id": 596777721, "node_id": "MDU6SXNzdWU1OTY3Nzc3MjE=", "number": 420, "title": "Can O365 be used with an Azure Function app?", "user": {"login": "khibma", "id": 2514926, "node_id": "MDQ6VXNlcjI1MTQ5MjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/2514926?v=4", "gravatar_id": "", "url": "https://api.github.com/users/khibma", "html_url": "https://github.com/khibma", "followers_url": "https://api.github.com/users/khibma/followers", "following_url": "https://api.github.com/users/khibma/following{/other_user}", "gists_url": "https://api.github.com/users/khibma/gists{/gist_id}", "starred_url": "https://api.github.com/users/khibma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/khibma/subscriptions", "organizations_url": "https://api.github.com/users/khibma/orgs", "repos_url": "https://api.github.com/users/khibma/repos", "events_url": "https://api.github.com/users/khibma/events{/privacy}", "received_events_url": "https://api.github.com/users/khibma/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-08T18:37:56Z", "updated_at": "2020-04-09T12:32:01Z", "closed_at": "2020-04-09T12:32:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "When creating an Azure Function app, and debugging, it runs in its own environment that needs to be activated. Once you're in this environment, you seemingly cannot interact with prompts, such as the prompt \r\n\r\n> [2020-04-08 6:20:43 PM] Visit the following url to give consent:\r\n> [2020-04-08 6:20:43 PM] https://login.microsoftonline.com/common/oauth2/v2.0/authorize?response_type=code&..........\r\n\r\nBesides working in this environment, once the app has been posted to Azure, it'll be impossible to provide the authenticated URL.\r\n\r\nDoes this mean, I need to authenticate using the `\"with your own identity\"` mechanism? If that's the case, I'll need to setup permissions and find/request an administrator to allow this (which seems unlikely for me)\r\n\r\nOR... if because each of the above scenarios will not work for their own reasons..., I'll need to perform the steps under **DIFFERENT AUTHENTICATION INTERFACES** -- having my application handle the callback? If this becomes the only workable situation for me, can you explain how I need to store the token? Is this connection/callback something that everytime the app runs it must do? Or do I need to look into a storage mechanism for Azure Function apps to save the token into?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/416", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/416/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/416/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/416/events", "html_url": "https://github.com/O365/python-o365/issues/416", "id": 590544116, "node_id": "MDU6SXNzdWU1OTA1NDQxMTY=", "number": 416, "title": "\"Error Message: The requested user 'email@domain.com' is invalid.\" For email", "user": {"login": "axk7812", "id": 40435241, "node_id": "MDQ6VXNlcjQwNDM1MjQx", "avatar_url": "https://avatars3.githubusercontent.com/u/40435241?v=4", "gravatar_id": "", "url": "https://api.github.com/users/axk7812", "html_url": "https://github.com/axk7812", "followers_url": "https://api.github.com/users/axk7812/followers", "following_url": "https://api.github.com/users/axk7812/following{/other_user}", "gists_url": "https://api.github.com/users/axk7812/gists{/gist_id}", "starred_url": "https://api.github.com/users/axk7812/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/axk7812/subscriptions", "organizations_url": "https://api.github.com/users/axk7812/orgs", "repos_url": "https://api.github.com/users/axk7812/repos", "events_url": "https://api.github.com/users/axk7812/events{/privacy}", "received_events_url": "https://api.github.com/users/axk7812/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-30T19:43:32Z", "updated_at": "2020-03-31T14:22:03Z", "closed_at": "2020-03-31T14:22:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am attempting to use this library to run a background process to connect to an email box and read the contents. I've registered the App in Azure and provided user.read.all and mail.read admin permissions. Here is the below code i'm using \r\n\r\n ```\r\nfrom O365 import Account, FileSystemTokenBackend\r\n\r\nclient_id = \"x\"\r\nclient_secret = \"x\"\r\ntenant_id = \"x\"\r\naddress = \"myemail@domain.com\"\r\n\r\ncredentials = (client_id, client_secret)\r\n\r\n# the default protocol will be Microsoft Graph\r\n\r\ntoken_backend = FileSystemTokenBackend(token_path='token_folder', token_filename='my_token.txt')\r\n\r\naccount = Account(credentials, auth_flow_type='credentials', tenant_id=tenant_id, token_backend=token_backend)\r\n\r\nif account.authenticate():\r\n    print('Authenticated!')\r\n\r\nmailbox = account.mailbox(resource=address)\r\n\r\ninbox = mailbox.inbox_folder()\r\n\r\nfor message in inbox.get_messages():\r\n    print(message)\r\n```\r\n\r\nThe app tells me it authenticates, however, I get the below error (I've replaced my actual email with the dummy email address) :\r\n\r\n```\r\n\r\nClient Error: 404 Client Error: Not Found for url: https://graph.microsoft.com/v1.0/users/myemail@domain.com/mailFolders/Inbox/messages?%24top=25 | Error Message: The requested user 'myemail@domain.com' is invalid.\r\nTraceback (most recent call last):\r\n  File \"C:/Users/axk7812/Documents/Work/general-data/voip/run.py\", line 94, in <module>\r\n    email_5()\r\n  File \"C:/Users/axk7812/Documents/Work/general-data/voip/run.py\", line 89, in email_5\r\n    for message in inbox.get_messages():\r\n  File \"C:\\Users\\axk7812\\AppData\\Local\\Continuum\\anaconda3\\envs\\voip\\lib\\site-packages\\O365\\mailbox.py\", line 212, in get_messages\r\n    response = self.con.get(url, params=params)\r\n  File \"C:\\Users\\axk7812\\AppData\\Local\\Continuum\\anaconda3\\envs\\voip\\lib\\site-packages\\O365\\connection.py\", line 778, in get\r\n    return self.oauth_request(url, 'get', params=params, **kwargs)\r\n  File \"C:\\Users\\axk7812\\AppData\\Local\\Continuum\\anaconda3\\envs\\voip\\lib\\site-packages\\O365\\connection.py\", line 767, in oauth_request\r\n    return self._internal_request(self.session, url, method, **kwargs)\r\n  File \"C:\\Users\\axk7812\\AppData\\Local\\Continuum\\anaconda3\\envs\\voip\\lib\\site-packages\\O365\\connection.py\", line 729, in _internal_request\r\n    raise HTTPError('{} | Error Message: {}'.format(e.args[0], error_message), response=response) from None\r\nrequests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://graph.microsoft.com/v1.0/users/myemail@domain.com/mailFolders/Inbox/messages?%24top=25 | Error Message: The requested user 'myemail@domain.com' is invalid.\r\n```\r\n\r\nFor reference, I'm using Windows 10, python 3.8.1 and O365 2.0.7\r\n\r\nAny hints as to what may be going on here?\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/415", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/415/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/415/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/415/events", "html_url": "https://github.com/O365/python-o365/issues/415", "id": 589773381, "node_id": "MDU6SXNzdWU1ODk3NzMzODE=", "number": 415, "title": "Confused newbie", "user": {"login": "cgarmstr", "id": 7409913, "node_id": "MDQ6VXNlcjc0MDk5MTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/7409913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cgarmstr", "html_url": "https://github.com/cgarmstr", "followers_url": "https://api.github.com/users/cgarmstr/followers", "following_url": "https://api.github.com/users/cgarmstr/following{/other_user}", "gists_url": "https://api.github.com/users/cgarmstr/gists{/gist_id}", "starred_url": "https://api.github.com/users/cgarmstr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cgarmstr/subscriptions", "organizations_url": "https://api.github.com/users/cgarmstr/orgs", "repos_url": "https://api.github.com/users/cgarmstr/repos", "events_url": "https://api.github.com/users/cgarmstr/events{/privacy}", "received_events_url": "https://api.github.com/users/cgarmstr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-29T11:44:03Z", "updated_at": "2020-04-07T07:20:15Z", "closed_at": "2020-04-06T21:42:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have taken your onedrive_example.py and substituted my own client_id and secret_id. When I run is I get a request for a url to give consent, to which I pasted in https://login.microsoftonline.com/common/oauth2/nativeclient\r\nThe complete dialogue is below.\r\n\r\nPS E:\\users\\cecil\\OneDrive\\Cecil\\My Documents\\Software\\python\\OneDrive\\OneDrive\\examples> python onedrive_example.py    Visit the following url to give consent:\r\nhttps://login.microsoftonline.com/common/oauth2/v2.0/authorize?response_type=code&client_id=d20c656c-9b97-425f-8206-34f20d6765f4&redirect_uri=https%3A%2F%2Flogin.microsoftonline.com%2Fcommon%2Foauth2%2Fnativeclient&scope=https%3A%2F%2Fgraph.microsoft.com%2FFiles.ReadWrite.All+offline_access+https%3A%2F%2Fgraph.microsoft.com%2FUser.Read&state=QCV8kYQsKP9L3QwdzlRdFVZ64Xb3RL&access_type=offline\r\nPaste the authenticated url here:\r\nhttps://login.microsoftonline.com/common/oauth2/nativeclient\r\nUnable to fetch auth token. Error: (missing_code) Missing code parameter in response.\r\nSomething go wrong. Please try again.\r\nClient Error: 401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/me/drives?%24top=999 | Error Message: Access token is empty.\r\n\r\nThis is a screen shot of my app permission settings\r\n![image](https://user-images.githubusercontent.com/7409913/77847721-23b15700-71b7-11ea-98bf-ccbe3e986fbb.png)\r\n\r\nApologies for wasting your time with this.\r\n\r\nCecil", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/414", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/414/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/414/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/414/events", "html_url": "https://github.com/O365/python-o365/issues/414", "id": 588567763, "node_id": "MDU6SXNzdWU1ODg1Njc3NjM=", "number": 414, "title": "DeprecationWarning importing from collections instead of from collections.abc", "user": {"login": "omac777", "id": 3756368, "node_id": "MDQ6VXNlcjM3NTYzNjg=", "avatar_url": "https://avatars2.githubusercontent.com/u/3756368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omac777", "html_url": "https://github.com/omac777", "followers_url": "https://api.github.com/users/omac777/followers", "following_url": "https://api.github.com/users/omac777/following{/other_user}", "gists_url": "https://api.github.com/users/omac777/gists{/gist_id}", "starred_url": "https://api.github.com/users/omac777/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omac777/subscriptions", "organizations_url": "https://api.github.com/users/omac777/orgs", "repos_url": "https://api.github.com/users/omac777/repos", "events_url": "https://api.github.com/users/omac777/events{/privacy}", "received_events_url": "https://api.github.com/users/omac777/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-03-26T16:48:25Z", "updated_at": "2020-04-30T11:55:00Z", "closed_at": "2020-04-30T09:20:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "On Archlinux, I did the following:\r\n```\r\npacman -S extra/python-pip\r\npip install O365\r\n```\r\n\r\nThen I ran the example a tweak a bit with basic and message_all scopes.\r\n```\r\nfrom O365 import Account\r\ncredentials = ('client_id', 'client_secret')\r\naccount = Account(credentials)\r\n\r\nif account.authenticate(scopes=['basic', 'message_all']):\r\n   print('Authenticated!')\r\n\r\nm = account.new_message()\r\nm.to.add('to_example@example.com')\r\nm.subject = 'Testing!'\r\nm.body = \"George Best quote: I've stopped drinking, but only while I'm asleep.\"\r\nm.send()\r\n```\r\n\r\nIt sent the message successfully after supplying the authenticated url.\r\n\r\n\r\nBUT it did give the following error/warning output:\r\n```\r\nAuthentication Flow Completed. \r\nOauth Access Token Stored. You can now use the API.\r\nAuthenticated!\r\n/usr/lib/python3.8/site-packages/html5lib/_trie/_base.py:3: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working from collections import Mapping\r\n```\r\n\r\nThank you for listening.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/409", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/409/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/409/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/409/events", "html_url": "https://github.com/O365/python-o365/issues/409", "id": 578732369, "node_id": "MDU6SXNzdWU1Nzg3MzIzNjk=", "number": 409, "title": "How to upload a file into a SharePoint?", "user": {"login": "pigna90", "id": 11518618, "node_id": "MDQ6VXNlcjExNTE4NjE4", "avatar_url": "https://avatars3.githubusercontent.com/u/11518618?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pigna90", "html_url": "https://github.com/pigna90", "followers_url": "https://api.github.com/users/pigna90/followers", "following_url": "https://api.github.com/users/pigna90/following{/other_user}", "gists_url": "https://api.github.com/users/pigna90/gists{/gist_id}", "starred_url": "https://api.github.com/users/pigna90/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pigna90/subscriptions", "organizations_url": "https://api.github.com/users/pigna90/orgs", "repos_url": "https://api.github.com/users/pigna90/repos", "events_url": "https://api.github.com/users/pigna90/events{/privacy}", "received_events_url": "https://api.github.com/users/pigna90/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-03-10T17:07:10Z", "updated_at": "2020-03-19T13:55:04Z", "closed_at": "2020-03-11T09:30:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've been using O365 for a few days and I'm trying to understand how to upload a new file into a SharePoint.\r\n\r\nI've tried to call [this method](https://github.com/O365/python-o365/blob/6093b15000824ec7529c25ae8cd535d6129afa38/O365/sharepoint.py#L526) on a `O365.sharepoint.Site` object but I don't know if this is the right way.\r\n\r\nAny advice? :)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/408", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/408/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/408/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/408/events", "html_url": "https://github.com/O365/python-o365/issues/408", "id": 575477548, "node_id": "MDU6SXNzdWU1NzU0Nzc1NDg=", "number": 408, "title": "Turn off logging", "user": {"login": "ChrisMellor68", "id": 31180432, "node_id": "MDQ6VXNlcjMxMTgwNDMy", "avatar_url": "https://avatars3.githubusercontent.com/u/31180432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisMellor68", "html_url": "https://github.com/ChrisMellor68", "followers_url": "https://api.github.com/users/ChrisMellor68/followers", "following_url": "https://api.github.com/users/ChrisMellor68/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisMellor68/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisMellor68/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisMellor68/subscriptions", "organizations_url": "https://api.github.com/users/ChrisMellor68/orgs", "repos_url": "https://api.github.com/users/ChrisMellor68/repos", "events_url": "https://api.github.com/users/ChrisMellor68/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisMellor68/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-04T15:03:27Z", "updated_at": "2020-03-04T15:36:37Z", "closed_at": "2020-03-04T15:36:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi\r\n\r\nHow can I turn off logging (except for HTTP Errors) from the API?\r\n\r\nI keep getting lots of lines like:\r\nINFO:O365.connection:Request parameters: {'params': {'$top': 100}, 'allow_redirects': True}\r\nINFO:O365.connection:Received response (200) from URL https://graph.microsoft.com/v1.0/users/xxxxxxxxxxxxxx/mailFolders/Inbox/messages?%24top=100\r\n\r\n(xxxxxxxxxxxxxx was mailbox)\r\n\r\nI've tried setting raise_http_errors=False but that doesn't do what I want.\r\n\r\nI've also looked into source for connection but I'm not much the wiser from that.\r\n\r\nAny ideas?\r\n\r\nMany thanks\r\n\r\nChris", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/407", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/407/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/407/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/407/events", "html_url": "https://github.com/O365/python-o365/issues/407", "id": 573040487, "node_id": "MDU6SXNzdWU1NzMwNDA0ODc=", "number": 407, "title": "authentication issue when authenticating on behalf of a user", "user": {"login": "billchen8888", "id": 57732714, "node_id": "MDQ6VXNlcjU3NzMyNzE0", "avatar_url": "https://avatars1.githubusercontent.com/u/57732714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/billchen8888", "html_url": "https://github.com/billchen8888", "followers_url": "https://api.github.com/users/billchen8888/followers", "following_url": "https://api.github.com/users/billchen8888/following{/other_user}", "gists_url": "https://api.github.com/users/billchen8888/gists{/gist_id}", "starred_url": "https://api.github.com/users/billchen8888/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/billchen8888/subscriptions", "organizations_url": "https://api.github.com/users/billchen8888/orgs", "repos_url": "https://api.github.com/users/billchen8888/repos", "events_url": "https://api.github.com/users/billchen8888/events{/privacy}", "received_events_url": "https://api.github.com/users/billchen8888/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-28T22:28:58Z", "updated_at": "2020-02-29T23:55:09Z", "closed_at": "2020-02-29T23:55:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Probably what I am running into is not an issue of O365 itself. But I really don't know what causes it -\r\n\r\nI am using \"authenticate on behalf of a user\".  The following is the code:\r\n\r\n`from O365 import Account\r\n\r\ncredentials = ('my_client_id_data', 'my_secret')\r\n\r\nscopes=['https://graph.microsoft.com/Mail.Read']\r\naccount = Account(credentials,scopes=scopes)\r\nif account.authenticate():\r\n   print('Authenticated!')\r\n`\r\n\r\nand I run it, on the terminal console, I get:\r\n\r\nVisit the following url to give consent:\r\nhttps://login.microsoftonline.com/common/oauth2/v2.0/authorize?response_type=code&client_id=##############&redirect_uri=https%3A%2F%2Flogin.microsoftonline.com%2Fcommon%2Foauth2%2Fnativeclient&scope=https%3A%2F%2Fgraph.microsoft.com%2FMail.Read&state=###########&access_type=offline\r\n\r\n(I replace the client ID info  with ##### for privacy)\r\n\r\nSo I go to the URL in a browser, I got a login page, then I signed in, I get \r\nhttps://login.microsoftonline.com/common/oauth2/nativeclient?error=invalid_request&error_description=AADSTS50194%3a+Application+%2########$+is+not+configured+as+a+multi-tenant+application.+Usage+of+the+%2fcommon+endpoint+is+not+supported+for+such+applications+created+after+%2710%2f15%2f2018%27.+Use+a+tenant-specific+endpoint+or+configure+the+application+to+be+multi-tenant-#######\r\n\r\nSo it seems complaining the Account type(?).    \"the registered application is not configured as a multi-tenant+application. Usage of he common endpoint is not supported for such applications created after '10/15/2018'. Use a tenant-specific endpoint or configure the application to be multi-tenant\"\r\n\r\nSince this is a company's Off365, I am told to use \r\nAccounts in this organizational directory only (YOURCOMPANY only - Single tenant)\r\nWe are not allowed to use multi-tenant account type\r\n\r\nAdditional info:  When I access the Azure portal from the company's laptop, the browser uses some sort of federation for SSO), not sure whether this causes my problem.\r\n\r\nThanks for any hint or info.\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/406", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/406/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/406/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/406/events", "html_url": "https://github.com/O365/python-o365/issues/406", "id": 572375194, "node_id": "MDU6SXNzdWU1NzIzNzUxOTQ=", "number": 406, "title": "self signed certificate in certificate chain ?", "user": {"login": "billchen8888", "id": 57732714, "node_id": "MDQ6VXNlcjU3NzMyNzE0", "avatar_url": "https://avatars1.githubusercontent.com/u/57732714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/billchen8888", "html_url": "https://github.com/billchen8888", "followers_url": "https://api.github.com/users/billchen8888/followers", "following_url": "https://api.github.com/users/billchen8888/following{/other_user}", "gists_url": "https://api.github.com/users/billchen8888/gists{/gist_id}", "starred_url": "https://api.github.com/users/billchen8888/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/billchen8888/subscriptions", "organizations_url": "https://api.github.com/users/billchen8888/orgs", "repos_url": "https://api.github.com/users/billchen8888/repos", "events_url": "https://api.github.com/users/billchen8888/events{/privacy}", "received_events_url": "https://api.github.com/users/billchen8888/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-27T21:37:06Z", "updated_at": "2020-07-22T17:20:20Z", "closed_at": "2020-02-28T19:47:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "This might not be really an issue, but I don't know whethere the problem is and how I can get around it...\r\n\r\nI am testing the O365 from my Mac laptop, I set up a virtual python, Python 3.7.4\r\nI have the following code:\r\n\r\n`#!/usr/bin/env python\r\n\r\nfrom O365 import Account\r\nimport requests\r\nimport ssl\r\n\r\ncredentials = ('some_client_id', 'some_secret')\r\n\r\ncafile=requests.certs.where()\r\nprint(cafile)\r\n\r\naccount = Account(credentials,auth_flow_type='credentials', tenant_id='some_tenent_id')\r\nif account.authenticate():\r\n   print('Authenticated!')`\r\n\r\nwhen I run it, it gives the following message:\r\n\r\n/Users/user01/myvirtualpython3/lib/python3.7/site-packages/certifi/cacert.pem\r\nUnable to fetch auth token. Error: HTTPSConnectionPool(host='login.microsoftonline.com', port=443): Max retries exceeded with url: /050b6c67-a550-4315-9cb2-1ac8b84a3418/oauth2/v2.0/token (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: self signed certificate in certificate chain (_ssl.c:1076)')))\r\n\r\nOn the machine, I tried to get the whole certificate chain by running the following command:\r\n`openssl  s_client -showcerts -connect login.microsoftonline.com:443`\r\n\r\nIt gives the following result:\r\n\r\nCONNECTED(00000006)\r\ndepth=2 C = IE, O = Baltimore, OU = CyberTrust, CN = Baltimore CyberTrust Root\r\nverify return:1\r\ndepth=1 C = US, ST = Washington, L = Redmond, O = Microsoft Corporation, OU = Microsoft IT, CN = Microsoft IT TLS CA 2\r\nverify return:1\r\ndepth=0 CN = graph.windows.net\r\nverify return:1\r\n---\r\nCertificate chain\r\n 0 s:/CN=graph.windows.net\r\n   i:/C=US/ST=Washington/L=Redmond/O=Microsoft Corporation/OU=Microsoft IT/CN=Microsoft IT TLS CA 2\r\n-----BEGIN CERTIFICATE-----\r\nMIIOrzCCDJegAwIBAgITHAASWu1Z0VfoCNWtowAAABJa7TANBgkqhkiG9w0BAQsF\r\nADCBizELMAkGA1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcT\r\nB1JlZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEVMBMGA1UE\r\nCxMMTWljcm9zb2Z0IElUMR4wHAYDVQQDExVNaWNyb3NvZnQgSVQgVExTIENBIDIw\r\nHhcNMjAwMjIwMTk1OTU3WhcNMjIwMjIwMTk1OTU3WjAcMRowGAYDVQQDExFncmFw\r\naC53aW5kb3dzLm5ldDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKyZ\r\nkLwwRIXX4HEVCBxpYs8y8SwyL+Ju94bG9XtahWpbCgBhkmSTrJyiEMwUlZybDyJa\r\nZVxILo8CB7XXfoH+a9AeEEAvXB0VxG6thbphupvnNFEDxWBxBrGSLhB8zZn5gmrT\r\n2tsDyC29MUK86mwKF2p2LLRDXsh2eKB7Z2USDEik8xZRNffR8KTo21tTKJJSw23Z\r\ndGwEAdUJxJn7gsc6nCflIb6YFtPHA0UT0pfIbhd38fnI3hJN3A4ctZoD7Kf/7Oc2\r\njQZrzMfSLVV5SB7U2mrZIvovP7puV/RXrWAALLRuCvPe3JwscgC3JM9VbnmWK32/\r\nvrfLe8pNABCeSyNlnBECAwEAAaOCCngwggp0MIIBfgYKKwYBBAHWeQIEAgSCAW4E\r\nggFqAWgAdgCkuQmQtBhYFIe7E6LMZ3AKPDWYBPkb37jjd80OyA3cEAAAAXBkOLMv\r\nAAAEAwBHMEUCIGHrbiJ8s5GKw3tNoxK6/IW07yvdscawYdOnm6Yy7WlYAiEA+A59\r\nBw8wmfTLno618zprxhPnqCJOqcd52qKPL1z2FEEAdgBVgdTCFpA2AUrqC5tXPFPw\r\nwOQ4eHAlCBcvo6odBxPTDAAAAXBkOLMbAAAEAwBHMEUCICsQYMccglLMgqiblxkK\r\nTozxkOKO4aJspT3tAVeclHJQAiEArMo4+44T73wcnZsEekWiIzIzQPYskjt1yzTH\r\nQcuQKnIAdgAiRUUHWVUkVpY/oS/x922G4CMmY63AS39dxoNcbuIPAgAAAXBkOLRx\r\nAAAEAwBHMEUCIAlW7ycgMnEFrnLpamjNBo/GlhLc3qhVfwI0eoqFj+cJAiEAxSlx\r\n/DdDm7IxawHhG+3vtY+pw9S8ODbcj+lbUXLi9TswJwYJKwYBBAGCNxUKBBowGDAK\r\nBggrBgEFBQcDAjAKBggrBgEFBQcDATA+BgkrBgEEAYI3FQcEMTAvBicrBgEEAYI3\r\nFQiH2oZ1g+7ZAYLJhRuBtZ5hhfTrYIFdhNLfQoLnk3oCAWQCAR0wgYUGCCsGAQUF\r\nBwEBBHkwdzBRBggrBgEFBQcwAoZFaHR0cDovL3d3dy5taWNyb3NvZnQuY29tL3Br\r\naS9tc2NvcnAvTWljcm9zb2Z0JTIwSVQlMjBUTFMlMjBDQSUyMDIuY3J0MCIGCCsG\r\nAQUFBzABhhZodHRwOi8vb2NzcC5tc29jc3AuY29tMB0GA1UdDgQWBBTm1OCIgDa3\r\nAFxFqukwXwuvlVSKUzALBgNVHQ8EBAMCBLAwggaTBgNVHREEggaKMIIGhoIbKi5h\r\nY2Nlc3Njb250cm9sLndpbmRvd3MubmV0gh8qLmFjY2Vzc2NvbnRyb2wud2luZG93\r\ncy1wcGUubmV0gg4qLmIyY2xvZ2luLmNvbYISKi5jcGltLndpbmRvd3MubmV0ghgq\r\nLm1pY3Jvc29mdGFpay5henVyZS5uZXSCICoubWljcm9zb2Z0YWlrLWludC5henVy\r\nZS1pbnQubmV0ghEqLndpbmRvd3MtcHBlLm5ldIIQYWFkZy53aW5kb3dzLm5ldIIW\r\nYWFkZ3Y2LnBwZS53aW5kb3dzLm5ldIISYWFkZ3Y2LndpbmRvd3MubmV0ghBhY2Nv\r\ndW50LmxpdmUuY29tghRhY2NvdW50LmxpdmUtaW50LmNvbYIXYXBpLnBhc3N3b3Jk\r\nLmNjc2N0cC5jb22CJWFwaS5wYXNzd29yZHJlc2V0Lm1pY3Jvc29mdG9ubGluZS5j\r\nb22CImF1dG9sb2dvbi5taWNyb3NvZnRhenVyZWFkLXNzby5jb22CEGJlY3dzLmNj\r\nc2N0cC5jb22CImNsaWVudGNvbmZpZy5taWNyb3NvZnRvbmxpbmUtcC5uZXSCJmNs\r\naWVudGNvbmZpZy5taWNyb3NvZnRvbmxpbmUtcC1pbnQubmV0ghljb21wYW55bWFu\r\nYWdlci5jY3NjdHAuY29tgiJjb21wYW55bWFuYWdlci5taWNyb3NvZnRvbmxpbmUu\r\nY29tghBjcGltLndpbmRvd3MubmV0giBkZXZpY2UubG9naW4ubWljcm9zb2Z0b25s\r\naW5lLmNvbYIcZGV2aWNlLmxvZ2luLndpbmRvd3MtcHBlLm5ldIIeZGlyZWN0b3J5\r\ncHJveHkucHBlLndpbmRvd3MubmV0ghpkaXJlY3Rvcnlwcm94eS53aW5kb3dzLm5l\r\ndIIVZ3JhcGgucHBlLndpbmRvd3MubmV0ghFncmFwaC53aW5kb3dzLm5ldIIWZ3Jh\r\ncGhzdG9yZS53aW5kb3dzLm5ldIIObG9naW4ubGl2ZS5jb22CEmxvZ2luLmxpdmUt\r\naW50LmNvbYITbG9naW4ubWljcm9zb2Z0LmNvbYIZbG9naW4ubWljcm9zb2Z0b25s\r\naW5lLmNvbYIbbG9naW4ubWljcm9zb2Z0b25saW5lLXAuY29tgh1sb2dpbi5taWNy\r\nb3NvZnRvbmxpbmUtcHN0LmNvbYIXbG9naW4ubWljcm9zb2Z0LXBwZS5jb22CEWxv\r\nZ2luLndpbmRvd3MubmV0gh1sb2dpbmNlcnQubWljcm9zb2Z0b25saW5lLmNvbYIh\r\nbG9naW5jZXJ0Lm1pY3Jvc29mdG9ubGluZS1pbnQuY29tghxsb2dpbi11cy5taWNy\r\nb3NvZnRvbmxpbmUuY29tghZtaWNyb3NvZnRhaWsuYXp1cmUubmV0gh5taWNyb3Nv\r\nZnRhaWstaW50LmF6dXJlLWludC5uZXSCG25leHVzLm1pY3Jvc29mdG9ubGluZS1w\r\nLmNvbYIfbmV4dXMubWljcm9zb2Z0b25saW5lLXAtaW50LmNvbYIPcGFzLndpbmRv\r\nd3MubmV0ghNwYXMud2luZG93cy1wcGUubmV0ghNwYXNzd29yZC5jY3NjdHAuY29t\r\ngi1wYXNzd29yZHJlc2V0LmFjdGl2ZWRpcmVjdG9yeS53aW5kb3dzYXp1cmUudXOC\r\nIXBhc3N3b3JkcmVzZXQubWljcm9zb2Z0b25saW5lLmNvbYIgcHJvdmlzaW9uaW5n\r\nLm1pY3Jvc29mdG9ubGluZS5jb22CD3NpZ251cC5saXZlLmNvbYITc2lnbnVwLmxp\r\ndmUtaW50LmNvbYIPc3RzLndpbmRvd3MubmV0ghJ4bWwubG9naW4ubGl2ZS5jb22C\r\nFnhtbC5sb2dpbi5saXZlLWludC5jb22CGyoubG9naW4ubWljcm9zb2Z0b25saW5l\r\nLmNvbYIdbG9naW4ubWljcm9zb2Z0b25saW5lLWludC5jb22CJWFjY2Vzc2NvbnRy\r\nb2wuYWFkdHN0My53aW5kb3dzLWludC5uZXSCJyouYWNjZXNzY29udHJvbC5hYWR0\r\nc3QzLndpbmRvd3MtaW50Lm5ldIIdYXBpLmxvZ2luLm1pY3Jvc29mdG9ubGluZS5j\r\nb22CHSouci5sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tghcqLnIubG9naW4ubWlj\r\ncm9zb2Z0LmNvbYIVKi5sb2dpbi5taWNyb3NvZnQuY29tMIGsBgNVHR8EgaQwgaEw\r\ngZ6ggZuggZiGS2h0dHA6Ly9tc2NybC5taWNyb3NvZnQuY29tL3BraS9tc2NvcnAv\r\nY3JsL01pY3Jvc29mdCUyMElUJTIwVExTJTIwQ0ElMjAyLmNybIZJaHR0cDovL2Ny\r\nbC5taWNyb3NvZnQuY29tL3BraS9tc2NvcnAvY3JsL01pY3Jvc29mdCUyMElUJTIw\r\nVExTJTIwQ0ElMjAyLmNybDBNBgNVHSAERjBEMEIGCSsGAQQBgjcqATA1MDMGCCsG\r\nAQUFBwIBFidodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL21zY29ycC9jcHMw\r\nHwYDVR0jBBgwFoAUkZ47RGw9V5xCdyo010/RzEqXLNowHQYDVR0lBBYwFAYIKwYB\r\nBQUHAwIGCCsGAQUFBwMBMA0GCSqGSIb3DQEBCwUAA4ICAQAq/p89icn3p3IHqyaI\r\nkkkTsBTT8j0qZZZYApotXEmtEVlZV5WSCmbtaMjCV3wxpewQDlNggaTfDltBml7e\r\nN4W4GoYzA0ftSUs2qZfDA+N/DyyCoX+yy0hWLyDM3LMev1xeLIir1X2HK6k1kXKg\r\npiO+B9CbanOoHl5SomZ1QqYriWHpL6RhSGk1ucbpt4Sg4D+0HDsmXrY4PEjbMgiV\r\nbZ8K0vJCM21dGhusSBGnoirGDXCoOk9K9NjpYRjodBQAyk8PiAy2kttDUbYqRnBJ\r\nOAcdEI9der9BPQUvQnuXaCRMvh8U5+Et46jphFd6mBVC3iaX2uFThnvJLhE8ACx+\r\n8epXNIhQ/kxUZMe7LzN5fWzCiQPGo9ek2kubtrXWahiktx96gUxe6BwvyR/Dc3Gj\r\n3AYOOPe0HzIRRhzlQvJFvO0i75LUdsgRz+qU6kvYjXKhBq0Obp6xVeRviAbk/cG5\r\n37kB2ClkCm3viSt3w47KfX7K1a+6/C3vtEFMbAkr5vIPhBI//f9r5WYTlpxGVVhb\r\nci/RJcVE9nQeNobOylwAreOEEqGfZo8hM1u1KIfLqW6dcNLr4LVr1a0MbwzU1vGP\r\nsnayWT9+JfLdXl37JHVGt7vESSI+xYJJZd1CsGmckL3M8cAKZVTd1bnhI+YByxT/\r\nio4V1Pjs0ZU1nAxqHQV/4nWm6w==\r\n-----END CERTIFICATE-----\r\n 1 s:/C=US/ST=Washington/L=Redmond/O=Microsoft Corporation/OU=Microsoft IT/CN=Microsoft IT TLS CA 2\r\n   i:/C=IE/O=Baltimore/OU=CyberTrust/CN=Baltimore CyberTrust Root\r\n-----BEGIN CERTIFICATE-----\r\nMIIFtDCCBJygAwIBAgIQDywQyVsGwJN/uNRJ+D6FaTANBgkqhkiG9w0BAQsFADBa\r\nMQswCQYDVQQGEwJJRTESMBAGA1UEChMJQmFsdGltb3JlMRMwEQYDVQQLEwpDeWJl\r\nclRydXN0MSIwIAYDVQQDExlCYWx0aW1vcmUgQ3liZXJUcnVzdCBSb290MB4XDTE2\r\nMDUyMDEyNTE1N1oXDTI0MDUyMDEyNTE1N1owgYsxCzAJBgNVBAYTAlVTMRMwEQYD\r\nVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNy\r\nb3NvZnQgQ29ycG9yYXRpb24xFTATBgNVBAsTDE1pY3Jvc29mdCBJVDEeMBwGA1UE\r\nAxMVTWljcm9zb2Z0IElUIFRMUyBDQSAyMIICIjANBgkqhkiG9w0BAQEFAAOCAg8A\r\nMIICCgKCAgEAnqoVwRuhY1/mURjFFrsR3AtNm5EKukBJK9zWBgvFd1ksNEJFC06o\r\nyRbwKPMflpW/HtOfzIeBliGk57MwZq18bgASr70sPUWuoD917HUgBfxBYoF8zA7Z\r\nIe5zAHODFboJL7Fg/apgbQs/GiZZNCi0QkQUWzw0nTUmVSNQ0mz6pCu95Dv1WMsL\r\nGyPGfdN9zD3Q/QEDyJ695QgjRIxYA1DUE+54ti2k6r0ycKFQYkyWwZ25HD1h2kYt\r\n3ovW85vF6y7tjTqUEcLbgKUCB81/955hdLLsbFd6f9o2PkU8xuOc3U+bUedvv6Sb\r\ntvGjBEZeFyH8/CaQhzlsKMH0+OPOFv/bMqcLarPw1V1sOV1bl4W9vi2278niblzI\r\nbEHt7nN888p4KNIwqCcXaGhbtS4tjn3NKI6v1d2XRyxIvCJDjgoZ09zF39Pyoe92\r\nsSRikZh7xns4tQEQ8BCs4o5NBSx8UxEsgyzNSskWGEWqsIjt+7+A1skDDZv6k2o8\r\nVCHNbTLFKS7d72wMI4ErpzVsBIicxaG2ezuMBBuqThxIiJ+G9zfoP9lxim/9rvJA\r\nxbh3nujA1VJfkOYTJIojEAYCxR3QjEoGdapJmBle97AfqEBnwoJsu2wav8h9v+po\r\nDL4h6dRzRUxY1DHypcFlXGoHu/REQgFLq2IN30/AhQLN90Pj9TT2RQECAwEAAaOC\r\nAUIwggE+MB0GA1UdDgQWBBSRnjtEbD1XnEJ3KjTXT9HMSpcs2jAfBgNVHSMEGDAW\r\ngBTlnVkwgkdYzKz6CFQ2hns6tQRN8DASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1Ud\r\nDwEB/wQEAwIBhjAnBgNVHSUEIDAeBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUF\r\nBwMJMDQGCCsGAQUFBwEBBCgwJjAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGln\r\naWNlcnQuY29tMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0\r\nLmNvbS9PbW5pcm9vdDIwMjUuY3JsMD0GA1UdIAQ2MDQwMgYEVR0gADAqMCgGCCsG\r\nAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BTMA0GCSqGSIb3DQEB\r\nCwUAA4IBAQBsf+pqb89rW8E0rP/cDuB9ixMX4C9OWQ7EA7n0BSllR64ZmuhU9mTV\r\n2L0G4HEiGXvOmt15i99wJ0ho2/dvMxm1ZeufkAfMuEc5fQ9RE5ENgNR2UCuFB2Bt\r\nbVmaKUAWxscN4GpXS4AJv+/HS0VXs5Su19J0DA8Bg+lo8ekCl4dq2G1m1WsCvFBI\r\noLIjd4neCLlGoxT2jA43lj2JpQ/SMkLkLy9DXj/JHdsqJDR5ogcij4VIX8V+bVD0\r\nNCw7kQa6Ulq9Zo0jDEq1at4zSeH4mV2PMM3LwIXBA2xo5sda1cnUWJo3Pq4uMgcL\r\ne0t+fCut38NMkTl8F0arflspaqUVVUov\r\n-----END CERTIFICATE-----\r\n---\r\nServer certificate\r\nsubject=/CN=graph.windows.net\r\nissuer=/C=US/ST=Washington/L=Redmond/O=Microsoft Corporation/OU=Microsoft IT/CN=Microsoft IT TLS CA 2\r\n---\r\nNo client certificate CA names sent\r\nServer Temp Key: ECDH, P-256, 256 bits\r\n---\r\nSSL handshake has read 5714 bytes and written 326 bytes\r\n---\r\nNew, TLSv1/SSLv3, Cipher is ECDHE-RSA-AES256-GCM-SHA384\r\nServer public key is 2048 bit\r\nSecure Renegotiation IS supported\r\nCompression: NONE\r\nExpansion: NONE\r\nNo ALPN negotiated\r\nSSL-Session:\r\n    Protocol  : TLSv1.2\r\n    Cipher    : ECDHE-RSA-AES256-GCM-SHA384\r\n    Session-ID: CB4C0000E5BACDDD72DE038007C26CF04589D848F61F5C462A5E8CA41021EAE1\r\n    Session-ID-ctx: \r\n    Master-Key: 00107B6008200AFF6BF2DEEE9BE15DCD37A69BE9E3AC42088CB893A900F26966EC7BD654A78F3FAED3C0A12DD74AE717\r\n    Start Time: 1582838937\r\n    Timeout   : 7200 (sec)\r\n    Verify return code: 0 (ok)\r\n---\r\n\r\n\r\nI checked the  /Users/user01/myvirtualpython3/lib/python3.7/site-packages/certifi/cacert.pem, it doesn't have the  cert for \"CN=Baltimore CyberTrust Root\".   I downloaded this CA and added this cert into /Users/user01/myvirtualpython3/lib/python3.7/site-packages/certifi/cacert.pem, but still get the same error.\r\n\r\nI don't know what else I missed. Can someone help me what goes wrong with my testing?\r\n\r\nThanks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/405", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/405/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/405/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/405/events", "html_url": "https://github.com/O365/python-o365/issues/405", "id": 569543698, "node_id": "MDU6SXNzdWU1Njk1NDM2OTg=", "number": 405, "title": "DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc'", "user": {"login": "davaffy", "id": 58271442, "node_id": "MDQ6VXNlcjU4MjcxNDQy", "avatar_url": "https://avatars2.githubusercontent.com/u/58271442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davaffy", "html_url": "https://github.com/davaffy", "followers_url": "https://api.github.com/users/davaffy/followers", "following_url": "https://api.github.com/users/davaffy/following{/other_user}", "gists_url": "https://api.github.com/users/davaffy/gists{/gist_id}", "starred_url": "https://api.github.com/users/davaffy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davaffy/subscriptions", "organizations_url": "https://api.github.com/users/davaffy/orgs", "repos_url": "https://api.github.com/users/davaffy/repos", "events_url": "https://api.github.com/users/davaffy/events{/privacy}", "received_events_url": "https://api.github.com/users/davaffy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-23T19:19:37Z", "updated_at": "2020-02-23T19:42:58Z", "closed_at": "2020-02-23T19:42:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI'm receiving the following warning \r\n\r\n/usr/lib/python3/dist-packages/html5lib/_trie/_base.py:3: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working\r\n  from collections import Mapping\r\n\r\nThis occurs after the the following statement when sending a mail\r\n\r\nm = account.new_message()\r\n\r\nI'm running the latest version of o365 / Python 3.7.3\r\n\r\nIs this a problem once I'm upgrading to 3.8 (and will the functionality stop working or does the o365 needs to be fixed?\r\n\r\nthx", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/403", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/403/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/403/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/403/events", "html_url": "https://github.com/O365/python-o365/issues/403", "id": 567365714, "node_id": "MDU6SXNzdWU1NjczNjU3MTQ=", "number": 403, "title": "API endpoint Support for the 21Vianet(China)", "user": {"login": "sidkang", "id": 6175895, "node_id": "MDQ6VXNlcjYxNzU4OTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/6175895?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sidkang", "html_url": "https://github.com/sidkang", "followers_url": "https://api.github.com/users/sidkang/followers", "following_url": "https://api.github.com/users/sidkang/following{/other_user}", "gists_url": "https://api.github.com/users/sidkang/gists{/gist_id}", "starred_url": "https://api.github.com/users/sidkang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sidkang/subscriptions", "organizations_url": "https://api.github.com/users/sidkang/orgs", "repos_url": "https://api.github.com/users/sidkang/repos", "events_url": "https://api.github.com/users/sidkang/events{/privacy}", "received_events_url": "https://api.github.com/users/sidkang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-02-19T07:19:38Z", "updated_at": "2020-02-20T01:41:11Z", "closed_at": "2020-02-20T01:41:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I'm currently using the o365 and the o365 operated by 21Vianet(China). According to this site: https://docs.microsoft.com/en-us/previous-versions/office/office-365-api/api/o365-china-endpoints, the main difference between the o365 international version and 21Vianet version is the api endpoint. Would it possible to add the option to use the library for the 21Vianet version of o365?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/401", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/401/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/401/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/401/events", "html_url": "https://github.com/O365/python-o365/issues/401", "id": 562322390, "node_id": "MDU6SXNzdWU1NjIzMjIzOTA=", "number": 401, "title": "Identify event invitation messages", "user": {"login": "RandomNameUser", "id": 59767384, "node_id": "MDQ6VXNlcjU5NzY3Mzg0", "avatar_url": "https://avatars3.githubusercontent.com/u/59767384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RandomNameUser", "html_url": "https://github.com/RandomNameUser", "followers_url": "https://api.github.com/users/RandomNameUser/followers", "following_url": "https://api.github.com/users/RandomNameUser/following{/other_user}", "gists_url": "https://api.github.com/users/RandomNameUser/gists{/gist_id}", "starred_url": "https://api.github.com/users/RandomNameUser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RandomNameUser/subscriptions", "organizations_url": "https://api.github.com/users/RandomNameUser/orgs", "repos_url": "https://api.github.com/users/RandomNameUser/repos", "events_url": "https://api.github.com/users/RandomNameUser/events{/privacy}", "received_events_url": "https://api.github.com/users/RandomNameUser/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-02-10T04:49:28Z", "updated_at": "2020-02-19T08:40:13Z", "closed_at": "2020-02-19T08:40:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "Whenever I get an event invitation, I get an empty message in the API, and I can't find any way to identify it as an invitation, nor can I get a reference to the event that is being invited to.\r\n\r\nIs there a way to identify a message as an invitation, and to find the event that the invitation is for? \r\n\r\nThanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/399", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/399/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/399/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/399/events", "html_url": "https://github.com/O365/python-o365/issues/399", "id": 557374735, "node_id": "MDU6SXNzdWU1NTczNzQ3MzU=", "number": 399, "title": "Cannot send mail to own tenant?", "user": {"login": "johanovic", "id": 1271171, "node_id": "MDQ6VXNlcjEyNzExNzE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1271171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johanovic", "html_url": "https://github.com/johanovic", "followers_url": "https://api.github.com/users/johanovic/followers", "following_url": "https://api.github.com/users/johanovic/following{/other_user}", "gists_url": "https://api.github.com/users/johanovic/gists{/gist_id}", "starred_url": "https://api.github.com/users/johanovic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johanovic/subscriptions", "organizations_url": "https://api.github.com/users/johanovic/orgs", "repos_url": "https://api.github.com/users/johanovic/repos", "events_url": "https://api.github.com/users/johanovic/events{/privacy}", "received_events_url": "https://api.github.com/users/johanovic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-30T09:42:57Z", "updated_at": "2020-04-21T14:04:52Z", "closed_at": "2020-04-21T14:04:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have an error with sendMail. I can send emails to anyone outside of the tenant (someone@somewhereelse.com) from an email address within the tenant (so someone@tenant.com), but any emails to other accounts in the tenant fail to arrive (someoneelse@tenant.com). \r\n\r\nAlthough they are successfully send and end up in the someone@tenants sent emails, they do not appear in the someoneelse@tenant.com mailbox. Any ideas what could be causing this?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/398", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/398/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/398/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/398/events", "html_url": "https://github.com/O365/python-o365/issues/398", "id": 556590398, "node_id": "MDU6SXNzdWU1NTY1OTAzOTg=", "number": 398, "title": "MFA authentication", "user": {"login": "mrh610", "id": 50149920, "node_id": "MDQ6VXNlcjUwMTQ5OTIw", "avatar_url": "https://avatars1.githubusercontent.com/u/50149920?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrh610", "html_url": "https://github.com/mrh610", "followers_url": "https://api.github.com/users/mrh610/followers", "following_url": "https://api.github.com/users/mrh610/following{/other_user}", "gists_url": "https://api.github.com/users/mrh610/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrh610/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrh610/subscriptions", "organizations_url": "https://api.github.com/users/mrh610/orgs", "repos_url": "https://api.github.com/users/mrh610/repos", "events_url": "https://api.github.com/users/mrh610/events{/privacy}", "received_events_url": "https://api.github.com/users/mrh610/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-29T01:48:53Z", "updated_at": "2020-04-30T09:19:41Z", "closed_at": "2020-04-30T09:19:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have been using O365 for ~1 year with oauth2 authentication.  Yesterday my company switched our outlook to MFA authentication and now I receive the error:  oauthlib.oauth2.rfc6749.errors.InvalidGrantError: (invalid_grant) AADSTS50076: Due to a configuration change made by your administrator, or because you moved to a new location, you must use multi-factor authentication to access.  I've researched ways of resolving this but I'm unable to find any.  I have also checked on the Azure portal to attempt to authenticate again.  It is entirely possible that I am missing something simple, but I am hoping that someone can point me in the right direction.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/396", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/396/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/396/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/396/events", "html_url": "https://github.com/O365/python-o365/issues/396", "id": 554977203, "node_id": "MDU6SXNzdWU1NTQ5NzcyMDM=", "number": 396, "title": "Attempting to authenticate just gives me a blank page", "user": {"login": "mflage", "id": 837316, "node_id": "MDQ6VXNlcjgzNzMxNg==", "avatar_url": "https://avatars3.githubusercontent.com/u/837316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mflage", "html_url": "https://github.com/mflage", "followers_url": "https://api.github.com/users/mflage/followers", "following_url": "https://api.github.com/users/mflage/following{/other_user}", "gists_url": "https://api.github.com/users/mflage/gists{/gist_id}", "starred_url": "https://api.github.com/users/mflage/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mflage/subscriptions", "organizations_url": "https://api.github.com/users/mflage/orgs", "repos_url": "https://api.github.com/users/mflage/repos", "events_url": "https://api.github.com/users/mflage/events{/privacy}", "received_events_url": "https://api.github.com/users/mflage/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-24T22:06:26Z", "updated_at": "2020-01-24T22:14:02Z", "closed_at": "2020-01-24T22:14:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have the following very simple code:\r\n\r\n```\r\nfrom O365 import Account\r\n\r\ncredentials = ('XXXXXXXXXX',\r\n               'YYYYYYYYYYY')\r\n\r\nscopes = ['basic', 'calendar', 'calendar_shared']\r\n\r\naccount = Account(credentials)\r\n\r\nif account.authenticate(scopes=scopes):\r\n    print(\"Authenticated!\")\r\n```\r\n\r\nThis runs and then outputs the following:\r\n\r\n```\r\nVisit the following url to give consent:\r\nhttps://login.microsoftonline.com/common/oauth2/v2.0/authorize?response_type=code&client_id=XXXXXXXXXXXXXXX&redirect_uri=https%3A%2F%2Flogin.microsoftonline.com%2Fcommon%2Foauth2%2Fnativeclient&scope=https%3A%2F%2Fgraph.microsoft.com%2FUser.Read+offline_access+https%3A%2F%2Fgraph.microsoft.com%2FCalendars.Read.Shared+https%3A%2F%2Fgraph.microsoft.com%2FCalendars.Read&state=bVf3ewNnBHJAYPxEtZdsEbSFDHKB7z&access_type=offline\r\nPaste the authenticated url here:\r\n```\r\nIf I then try to access that page I'm only returned a blank, empty response. What am I doing wrong? I've followed the howto under \"Authentication steps\" and I've also added the permissions offline_access, Calendars.Read and Calendars.Read.Shared along with the predefined User.Read.\r\n\r\nI thought this was going to be easy. Is there something my admin needs to do to allow this?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/394", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/394/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/394/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/394/events", "html_url": "https://github.com/O365/python-o365/issues/394", "id": 553779096, "node_id": "MDU6SXNzdWU1NTM3NzkwOTY=", "number": 394, "title": "Manual calculations in Excel", "user": {"login": "dtorres-sf", "id": 30841716, "node_id": "MDQ6VXNlcjMwODQxNzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/30841716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtorres-sf", "html_url": "https://github.com/dtorres-sf", "followers_url": "https://api.github.com/users/dtorres-sf/followers", "following_url": "https://api.github.com/users/dtorres-sf/following{/other_user}", "gists_url": "https://api.github.com/users/dtorres-sf/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtorres-sf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtorres-sf/subscriptions", "organizations_url": "https://api.github.com/users/dtorres-sf/orgs", "repos_url": "https://api.github.com/users/dtorres-sf/repos", "events_url": "https://api.github.com/users/dtorres-sf/events{/privacy}", "received_events_url": "https://api.github.com/users/dtorres-sf/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-22T20:36:53Z", "updated_at": "2020-01-25T23:52:57Z", "closed_at": "2020-01-25T23:52:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "If a workbook is in manual calculation mode it needs to have the calculate endpoint called. This is on the workbook application object inside of the excel graph APIs.\r\n\r\nWe have created an enhancement to provide this feature.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/393", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/393/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/393/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/393/events", "html_url": "https://github.com/O365/python-o365/issues/393", "id": 553643625, "node_id": "MDU6SXNzdWU1NTM2NDM2MjU=", "number": 393, "title": "Filtering SharePoint lists", "user": {"login": "jrmatchett", "id": 6579155, "node_id": "MDQ6VXNlcjY1NzkxNTU=", "avatar_url": "https://avatars1.githubusercontent.com/u/6579155?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrmatchett", "html_url": "https://github.com/jrmatchett", "followers_url": "https://api.github.com/users/jrmatchett/followers", "following_url": "https://api.github.com/users/jrmatchett/following{/other_user}", "gists_url": "https://api.github.com/users/jrmatchett/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrmatchett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrmatchett/subscriptions", "organizations_url": "https://api.github.com/users/jrmatchett/orgs", "repos_url": "https://api.github.com/users/jrmatchett/repos", "events_url": "https://api.github.com/users/jrmatchett/events{/privacy}", "received_events_url": "https://api.github.com/users/jrmatchett/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-22T16:12:17Z", "updated_at": "2020-01-27T17:16:45Z", "closed_at": "2020-01-27T17:16:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm needing to filter items when querying a SharePoint list. I first tried defining a query like this\r\n```\r\nquery = my_list.q().expand('fields').select('Field1', 'Field2', 'Field3')\r\nquery.chain().on_attribute('Field3').equals(0)   # Field3 is a boolean value\r\nitems = my_list.get_items(query=query)\r\n```\r\nThat produces `Error Message: Invalid filter clause`.  Looking through the Microsoft Graph API documentation, it indicates that `fields/` should come before the attribute and, in my testing, the field name is case sensitive. So in my example the filter expression should evaluate to `fields/Field3 eq 0` , whereas `on_attribute` produces `fields3 eq 0`. So, I added a method named `on_list_field` to the `Query` class, defined as:\r\n```\r\n@fluent\r\ndef on_list_field(self, field):\r\n    \"\"\" Apply query on a list field, to be used along with chain()\r\n    :param str field: field name (note: name is case sensitive)\r\n    :rtype: Query\r\n    \"\"\"\r\n    self._attribute = 'fields/' + field\r\n    return self\r\n```\r\nDoes that seem reasonable, or am I overlooking something in the package's existing functionality?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/392", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/392/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/392/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/392/events", "html_url": "https://github.com/O365/python-o365/issues/392", "id": 553445421, "node_id": "MDU6SXNzdWU1NTM0NDU0MjE=", "number": 392, "title": "CheckOut a SharePoint file?", "user": {"login": "Vincethevince", "id": 31211429, "node_id": "MDQ6VXNlcjMxMjExNDI5", "avatar_url": "https://avatars1.githubusercontent.com/u/31211429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vincethevince", "html_url": "https://github.com/Vincethevince", "followers_url": "https://api.github.com/users/Vincethevince/followers", "following_url": "https://api.github.com/users/Vincethevince/following{/other_user}", "gists_url": "https://api.github.com/users/Vincethevince/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vincethevince/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vincethevince/subscriptions", "organizations_url": "https://api.github.com/users/Vincethevince/orgs", "repos_url": "https://api.github.com/users/Vincethevince/repos", "events_url": "https://api.github.com/users/Vincethevince/events{/privacy}", "received_events_url": "https://api.github.com/users/Vincethevince/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-22T10:25:59Z", "updated_at": "2020-01-22T13:20:18Z", "closed_at": "2020-01-22T13:20:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi\r\nLast days I tried to CheckOut a SharePoint file and now I found this package. Is it possible to do this with the API? ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/390", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/390/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/390/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/390/events", "html_url": "https://github.com/O365/python-o365/issues/390", "id": 550377994, "node_id": "MDU6SXNzdWU1NTAzNzc5OTQ=", "number": 390, "title": "Ability to interact with WorkbookApplications", "user": {"login": "icgranger9", "id": 8990597, "node_id": "MDQ6VXNlcjg5OTA1OTc=", "avatar_url": "https://avatars0.githubusercontent.com/u/8990597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/icgranger9", "html_url": "https://github.com/icgranger9", "followers_url": "https://api.github.com/users/icgranger9/followers", "following_url": "https://api.github.com/users/icgranger9/following{/other_user}", "gists_url": "https://api.github.com/users/icgranger9/gists{/gist_id}", "starred_url": "https://api.github.com/users/icgranger9/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/icgranger9/subscriptions", "organizations_url": "https://api.github.com/users/icgranger9/orgs", "repos_url": "https://api.github.com/users/icgranger9/repos", "events_url": "https://api.github.com/users/icgranger9/events{/privacy}", "received_events_url": "https://api.github.com/users/icgranger9/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 198099888, "node_id": "MDU6TGFiZWwxOTgwOTk4ODg=", "url": "https://api.github.com/repos/O365/python-o365/labels/Feature%20Request", "name": "Feature Request", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-01-15T19:16:33Z", "updated_at": "2020-01-25T23:54:05Z", "closed_at": "2020-01-25T23:54:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hey,\r\n\r\nIs there any plan to add the functionality to get / interact with [workbookApplications](https://docs.microsoft.com/en-us/graph/api/resources/workbookapplication?view=graph-rest-1.0). This would enable us to see the calculation status of a workbook, and run calculations in a workbook.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/388", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/388/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/388/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/388/events", "html_url": "https://github.com/O365/python-o365/issues/388", "id": 548620470, "node_id": "MDU6SXNzdWU1NDg2MjA0NzA=", "number": 388, "title": "Settings for connection json dumps encoder", "user": {"login": "dtorres-sf", "id": 30841716, "node_id": "MDQ6VXNlcjMwODQxNzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/30841716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtorres-sf", "html_url": "https://github.com/dtorres-sf", "followers_url": "https://api.github.com/users/dtorres-sf/followers", "following_url": "https://api.github.com/users/dtorres-sf/following{/other_user}", "gists_url": "https://api.github.com/users/dtorres-sf/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtorres-sf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtorres-sf/subscriptions", "organizations_url": "https://api.github.com/users/dtorres-sf/orgs", "repos_url": "https://api.github.com/users/dtorres-sf/repos", "events_url": "https://api.github.com/users/dtorres-sf/events{/privacy}", "received_events_url": "https://api.github.com/users/dtorres-sf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268452, "node_id": "MDU6TGFiZWwxNzgyNjg0NTI=", "url": "https://api.github.com/repos/O365/python-o365/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-12T20:11:47Z", "updated_at": "2020-01-15T00:20:22Z", "closed_at": "2020-01-15T00:20:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I am having an issue when trying to send date and datetime to an excel worksheet, since they are not json serializable. The problem is the json.dumps in the Connection:\r\n\r\nhttps://github.com/O365/python-o365/blob/master/O365/connection.py#L658\r\n\r\nIf this would allow for a custom `cls` then it would work since we could set the encoder to use for dumping json before the request.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/387", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/387/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/387/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/387/events", "html_url": "https://github.com/O365/python-o365/issues/387", "id": 548522289, "node_id": "MDU6SXNzdWU1NDg1MjIyODk=", "number": 387, "title": "upload file to onedrive failed for file name invalid", "user": {"login": "mengyyy", "id": 10589755, "node_id": "MDQ6VXNlcjEwNTg5NzU1", "avatar_url": "https://avatars1.githubusercontent.com/u/10589755?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mengyyy", "html_url": "https://github.com/mengyyy", "followers_url": "https://api.github.com/users/mengyyy/followers", "following_url": "https://api.github.com/users/mengyyy/following{/other_user}", "gists_url": "https://api.github.com/users/mengyyy/gists{/gist_id}", "starred_url": "https://api.github.com/users/mengyyy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mengyyy/subscriptions", "organizations_url": "https://api.github.com/users/mengyyy/orgs", "repos_url": "https://api.github.com/users/mengyyy/repos", "events_url": "https://api.github.com/users/mengyyy/events{/privacy}", "received_events_url": "https://api.github.com/users/mengyyy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-12T05:09:27Z", "updated_at": "2020-03-20T15:27:51Z", "closed_at": "2020-03-20T15:27:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello:\r\n   I have a file wich name is `5 - More Smiles\\x81, More Happiness.mp3` in os.listdir \r\n   But in `ls` cmd it show `5 - More Smiles'$'\\302\\201'', More Happiness.mp3`\r\n   I try to set item_name in upload_file but also get \r\n```HTTPError: 400 Client Error: Bad Request for url: https://graph.microsoft.com/v1.0/me/drive/items/0XXXXXXXXXXXXXXXXXXXXXXXXX:/5%20-%20More%20Smiles%C2%81%2C%20More%20Happiness.mp3:/createUploadSession```\r\n   Could any one tell me how to rename this file?\r\nThank you", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/385", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/385/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/385/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/385/events", "html_url": "https://github.com/O365/python-o365/issues/385", "id": 547576948, "node_id": "MDU6SXNzdWU1NDc1NzY5NDg=", "number": 385, "title": "Token refresh seems to work but get an error saying the access_token is empty", "user": {"login": "davidwynter", "id": 3639277, "node_id": "MDQ6VXNlcjM2MzkyNzc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3639277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidwynter", "html_url": "https://github.com/davidwynter", "followers_url": "https://api.github.com/users/davidwynter/followers", "following_url": "https://api.github.com/users/davidwynter/following{/other_user}", "gists_url": "https://api.github.com/users/davidwynter/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidwynter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidwynter/subscriptions", "organizations_url": "https://api.github.com/users/davidwynter/orgs", "repos_url": "https://api.github.com/users/davidwynter/repos", "events_url": "https://api.github.com/users/davidwynter/events{/privacy}", "received_events_url": "https://api.github.com/users/davidwynter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-09T16:14:13Z", "updated_at": "2020-01-15T08:58:39Z", "closed_at": "2020-01-15T08:58:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I run under debug and inspect the account.con.token_backend.token.access_token object being used it is there. `{'token_type': 'Bearer', 'expires_in': 3599, 'ext_expires_in': 3599, 'access_token': 'eyJ0e...493Sp_Q', 'expires_at': 1578586873.5086055}`\r\n\r\nexpiration_datetime  is \r\n\r\n    2020-01-09 16:20:13.508605\r\n\r\nBut I get this error response:\r\n\r\n    error | \u00a0\r\n    code | \"InvalidAuthenticationToken\"\r\n    message | \"Access token is empty.\"\r\n    innerError | \u00a0\r\n    request-id | \"b999e9f5-0c1b-4191-9bc8-6d271c89228b\"\r\n    date | \"2020-01-09T16:04:13\"\r\n\r\nAny ideas?\r\n\r\nUPDATE: Code used\r\n\r\n    def send_0365(self, caller, subject, attachments):\r\n        credentials = (tuple(self.credentials365))\r\n        logging.getLogger(\"O365\").setLevel(logging.WARNING)\r\n        account = O365.Account(credentials, auth_flow_type='credentials', tenant_id=self.tenant_id)\r\n        if not account.is_authenticated:  # will check if there is a token and has not expired\r\n            # ask for a login\r\n            # console based authentication See Authentication for other flows\r\n            account.authenticate()\r\n\r\n        mailbox = account.mailbox(self.from_address)\r\n        m = mailbox.new_message()\r\n        for to in self.to:\r\n            m.to.add(to)\r\n\r\n        m.subject = subject\r\n        if hasattr(self, 'errormsg'):\r\n            m.body = self.errormsg[caller]\r\n\r\n        else:\r\n            m.body = 'No message body set for this message, check store_error_msg has been called prior to sending'\r\n\r\n        i = 0\r\n        for attachment in attachments:\r\n            if isinstance(attachment, tuple):\r\n                m.attachments.add(attachment)\r\n            else:\r\n                m.attachments.add(attachment, 'name' + str(i))\r\n                i = i+1\r\n\r\n        m.send()\r\n\r\nMinimum case for the code above is where attachments == [] and it produces the same error\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/384", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/384/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/384/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/384/events", "html_url": "https://github.com/O365/python-o365/issues/384", "id": 547464344, "node_id": "MDU6SXNzdWU1NDc0NjQzNDQ=", "number": 384, "title": "O365 not installing using virtual environment", "user": {"login": "davidwynter", "id": 3639277, "node_id": "MDQ6VXNlcjM2MzkyNzc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3639277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidwynter", "html_url": "https://github.com/davidwynter", "followers_url": "https://api.github.com/users/davidwynter/followers", "following_url": "https://api.github.com/users/davidwynter/following{/other_user}", "gists_url": "https://api.github.com/users/davidwynter/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidwynter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidwynter/subscriptions", "organizations_url": "https://api.github.com/users/davidwynter/orgs", "repos_url": "https://api.github.com/users/davidwynter/repos", "events_url": "https://api.github.com/users/davidwynter/events{/privacy}", "received_events_url": "https://api.github.com/users/davidwynter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-09T13:02:10Z", "updated_at": "2020-01-09T13:08:35Z", "closed_at": "2020-01-09T13:08:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a venv with python 3.7.3. When I activate it and run the following:\r\n\r\n    pip install --user O356\r\n    ERROR: Could not find a version that satisfies the requirement O356 (from versions: none)\r\n    ERROR: No matching distribution found for O356\r\n\r\nI also tried it without the `--user`\r\n\r\nI intend to use this with my conda environment from within PyCharm using the conda interop as follows:\r\n\r\n    conda config --set pip_interop_enabled True\r\n\r\nAny ideas why this does not work? How do we get O365 added to the conda repo to save all this hassle?\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/383", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/383/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/383/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/383/events", "html_url": "https://github.com/O365/python-o365/issues/383", "id": 545363270, "node_id": "MDU6SXNzdWU1NDUzNjMyNzA=", "number": 383, "title": "File Referencing on onedrive", "user": {"login": "rtusa7", "id": 30362585, "node_id": "MDQ6VXNlcjMwMzYyNTg1", "avatar_url": "https://avatars2.githubusercontent.com/u/30362585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rtusa7", "html_url": "https://github.com/rtusa7", "followers_url": "https://api.github.com/users/rtusa7/followers", "following_url": "https://api.github.com/users/rtusa7/following{/other_user}", "gists_url": "https://api.github.com/users/rtusa7/gists{/gist_id}", "starred_url": "https://api.github.com/users/rtusa7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rtusa7/subscriptions", "organizations_url": "https://api.github.com/users/rtusa7/orgs", "repos_url": "https://api.github.com/users/rtusa7/repos", "events_url": "https://api.github.com/users/rtusa7/events{/privacy}", "received_events_url": "https://api.github.com/users/rtusa7/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-05T03:29:19Z", "updated_at": "2020-01-07T04:54:21Z", "closed_at": "2020-01-07T04:54:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "This may be a simple question.  I am using the O365 package to read an excel file.  I can log-in to my OneDrive, and see my file system.  However, I am unable to reference my file.\r\n\r\nI have followed the tutorial, authenticated and referenced my drives successfully using these commands.  \r\nfrom O365 import Account\r\ncredentials = (my_client_id, my_client_secret)\r\nscopes = ['basic','onedrive']\r\naccount = Account(credentials, scopes=scopes)\r\naccount.authenticate()\r\nstorage=account.storage()\r\nmy_drive=storage.get_default_drive()\r\ndocfolder=my_drive.get_special_folder('Documents')\r\n\r\nI can see the .xlsx file in the Documents directory, but I do not know how to reference it.  For example:\r\nfile=<need the syntax here>filename.xlsx\r\n\r\nHelp would be greatly appreciated.  I could not see an example staement in the documentation or anywhere online.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/381", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/381/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/381/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/381/events", "html_url": "https://github.com/O365/python-o365/issues/381", "id": 544420179, "node_id": "MDU6SXNzdWU1NDQ0MjAxNzk=", "number": 381, "title": "Reasons a setup could fail on production?", "user": {"login": "johanovic", "id": 1271171, "node_id": "MDQ6VXNlcjEyNzExNzE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1271171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johanovic", "html_url": "https://github.com/johanovic", "followers_url": "https://api.github.com/users/johanovic/followers", "following_url": "https://api.github.com/users/johanovic/following{/other_user}", "gists_url": "https://api.github.com/users/johanovic/gists{/gist_id}", "starred_url": "https://api.github.com/users/johanovic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johanovic/subscriptions", "organizations_url": "https://api.github.com/users/johanovic/orgs", "repos_url": "https://api.github.com/users/johanovic/repos", "events_url": "https://api.github.com/users/johanovic/events{/privacy}", "received_events_url": "https://api.github.com/users/johanovic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-01-02T01:23:19Z", "updated_at": "2020-01-06T11:46:35Z", "closed_at": "2020-01-06T09:57:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "I slightly different question.\r\n\r\nI have a full setup that works in development (with a localhost callback, custom token backend, and credentials and scopes, etc.), but when I deploy it on a server it does not work anymore. What is the best way to debug this? The server runs nginx.\r\n\r\nThanks", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/380", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/380/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/380/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/380/events", "html_url": "https://github.com/O365/python-o365/issues/380", "id": 544349324, "node_id": "MDU6SXNzdWU1NDQzNDkzMjQ=", "number": 380, "title": "onedrive upload file requests uri invalid", "user": {"login": "mengyyy", "id": 10589755, "node_id": "MDQ6VXNlcjEwNTg5NzU1", "avatar_url": "https://avatars1.githubusercontent.com/u/10589755?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mengyyy", "html_url": "https://github.com/mengyyy", "followers_url": "https://api.github.com/users/mengyyy/followers", "following_url": "https://api.github.com/users/mengyyy/following{/other_user}", "gists_url": "https://api.github.com/users/mengyyy/gists{/gist_id}", "starred_url": "https://api.github.com/users/mengyyy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mengyyy/subscriptions", "organizations_url": "https://api.github.com/users/mengyyy/orgs", "repos_url": "https://api.github.com/users/mengyyy/repos", "events_url": "https://api.github.com/users/mengyyy/events{/privacy}", "received_events_url": "https://api.github.com/users/mengyyy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-01T12:00:14Z", "updated_at": "2020-01-01T15:19:25Z", "closed_at": "2020-01-01T15:19:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello:\r\n    I get a file which name is `\u3061\u306f\u3084\u3075\u308b : \u30b5\u30f3\u30c8\u30e9.jpg`\r\n    Its name has some Japanese characters.\r\n    And hehe is what i get when i try to upload it:\r\n```python\r\nERROR:O365.connection:Client Error: 400 Client Error: Bad Request for url: https://graph.microsoft.com/v1.0/me/drive/items/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX:/%E3%81%A1%E3%81%AF%E3%82%84%E3%81%B5%E3%82%8B%20%3A%20%E3%82%B5%E3%83%B3%E3%83%88%E3%83%A9.jpg:/content | Error Message: The request URI is not valid. The bound function binding to 'microsoft.graph.driveItem' does not support the escape function annotation.\r\nFile <ipython-input-23-728f2e0fc659>, line 2, in <module>\r\n    1    try:\r\n--> 2       file_item = parent_item.upload_file(file_path, item_name=file_name.strip())\r\n    3    except :\r\n    ..................................................\r\n     file_item = File: None\r\n     parent_item.upload_file = <method 'Folder.upload_file' of Folder: \u3061\u306f\u3084\u3075\u308b \u30aa\u30ea\u30b7\u3099\u30ca\u30eb\u30fb\u30b5\u30a6\u30f3\u30c8\u3099\u30c8\u30e9\r\n                                \u30c3\u30af drive.py:1168>\r\n     file_path = '/home/onetest/\u3061\u306f\u3084\u3075\u308b \u30aa\u30ea\u30b7\u3099\u30ca\u30eb\u30fb\u30b5\u30a6\u30f3\u30c8\u3099\u30c8\u30e9\u30c3\u30af/\u3061\u306f\u3084\u3075\u308b : \u30b5\u30f3\u30c8\u30e9.jpg'\r\n    ..................................................\r\n\r\nFile /usr/local/lib/python3.8/dist-packages/O365/drive.py, line 1205, in upload_file\r\n    1168  def upload_file(self, item, item_name=None, chunk_size=DEFAULT_UPLOAD_CHUNK_SIZE,\r\n    1169                  upload_in_chunks=False):\r\n (...)\r\n    1201          # headers = None\r\n    1202          with item.open(mode='rb') as file:\r\n    1203              data = file.read()\r\n    1204\r\n--> 1205          response = self.con.put(url, headers=headers, data=data)\r\n    1206          if not response:\r\n    ..................................................\r\n     self = Folder: \u3061\u306f\u3084\u3075\u308b \u30aa\u30ea\u30b7\u3099\u30ca\u30eb\u30fb\u30b5\u30a6\u30f3\u30c8\u3099\u30c8\u30e9\u30c3\u30af\r\n     item = PosixPath('/home/onetest/\u3061\u306f\u3084\u3075\u308b \u30aa\u30ea\u30b7\u3099\u30ca\u30eb\u30fb\u30b5\u30a6\u30f3\u30c8\u3099\u30c8\u30e9\u30c3\u30af/\u3061\u306f\u3084\u3075\u308b : \u30b5\u30f3\r\n             \u30c8\u30e9.jpg')\r\n     item_name = '\u3061\u306f\u3084\u3075\u308b : \u30b5\u30f3\u30c8\u30e9.jpg'\r\n     chunk_size = 5242880\r\n     DEFAULT_UPLOAD_CHUNK_SIZE = 5242880\r\n     upload_in_chunks = False\r\n     item.open = <method 'Path.open' of /home/onetest/\u3061\u306f\u3084\u3075\u308b \u30aa\u30ea\u30b7\u3099\u30ca\u30eb\u30fb\u30b5\u30a6\u30f3\u30c8\u3099\u30c8\u30e9\u30c3\r\n                  \u30af/\u3061\u306f\u3084\u3075\u308b : \u30b5\u30f3\u30c8\u30e9.jpg pathlib.py:1207>\r\n     file = <_io.BufferedReader name='/home/onetest/\u3061\u306f\u3084\u3075\u308b \u30aa\u30ea\u30b7\u3099\u30ca\u30eb\u30fb\u30b5\u30a6\u30f3\u30c8\u3099\r\n             \u30c8\u30e9\u30c3\u30af/\u3061\u306f\u3084\u3075\u308b : \u30b5\u30f3\u30c8\u30e9.jpg'>\r\n     data = b'\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x00\\x00\\x01\\x00\\x\r\n             01\\x00\\x00\\xff\\xdb\\x00C\\x00\\x05\\x03\\x04\\x04\\x04\\x03\\x05\\x04\\\r\n             x04\\x04\\x05\\x05\\x05\\x06\\x07\\x0c\\x08\\x07\\x07\\x07\\x07\\x0f\\x0b\\\r\n             x0b\\t\\x0c\\x11\\x0f\\x12\\x12\\x11\\x0f\\x11\\x11\\x13\\x16\\x1c\\x17\\x1\r\n             3\\x14\\x1a\\x15\\x11\\x11\\x18!\\x18\\x1a\\x1d\\x1d\\x1f\\x1f\\x1f\\x13\\x\r\n             17\"$\"\\x1e$\\x1c\\x1e\\x1f\\x1e\\xff\\xdb\\x00C\\x01\\x05\\x05\\x05\\x07\\\r\n             x06\\x07\\x0e\\x08\\x08\\x0e\\x1e\\x14\\x11\\x14\\x1e\\x1e\\x1e\\x1e\\x1e\\\r\n             x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\\r\n             x1e\\x1e\\x1e\\x1e\\x1e\\...\r\n     self.con.put = <method 'Connection.put' of <O365.connection.Connection obje\r\n                     ct at 0x7f26cb7b7670> connection.py:789>\r\n     url = 'https://graph.microsoft.com/v1.0/me/drive/items/XXXXXXXXXXXXXX\r\n            XXXXXXXXXXXXXXXXX:/%E3%81%A1%E3%81%AF%E3%82%84%E3%81%B\r\n            5%E3%82%8B%20%3A%20%E3%82%B5%E3%83%B3%E3%83%88%E3%83%A9.jpg:\r\n            /content'\r\n     headers = {'Content-type': 'application/octet-stream',\r\n                'Authorization': 'Bearer abcdefgacbdegdgagcabgcc...\r\n    ..................................................\r\n\r\nFile /usr/local/lib/python3.8/dist-packages/O365/connection.py, line 798, in put\r\n    789  def put(self, url, data=None, **kwargs):\r\n (...)\r\n    794      :param kwargs: extra params to send to request api\r\n    795      :return: Response of the request\r\n    796      :rtype: requests.Response\r\n    797      \"\"\"\r\n--> 798      return self.oauth_request(url, 'put', data=data, **kwargs)\r\n    ..................................................\r\n     self = <O365.connection.Connection object at 0x7f26cb7b7670>\r\n     url = 'https://graph.microsoft.com/v1.0/me/drive/items/XXXXXXXXXXXXXX\r\n            XXXXXXXXXXXXXXXXX:/%E3%81%A1%E3%81%AF%E3%82%84%E3%81%B\r\n            5%E3%82%8B%20%3A%20%E3%82%B5%E3%83%B3%E3%83%88%E3%83%A9.jpg:\r\n            /content'\r\n     data = b'\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x00\\x00\\x01\\x00\\x\r\n             01\\x00\\x00\\xff\\xdb\\x00C\\x00\\x05\\x03\\x04\\x04\\x04\\x03\\x05\\x04\\\r\n             x04\\x04\\x05\\x05\\x05\\x06\\x07\\x0c\\x08\\x07\\x07\\x07\\x07\\x0f\\x0b\\\r\n             x0b\\t\\x0c\\x11\\x0f\\x12\\x12\\x11\\x0f\\x11\\x11\\x13\\x16\\x1c\\x17\\x1\r\n             3\\x14\\x1a\\x15\\x11\\x11\\x18!\\x18\\x1a\\x1d\\x1d\\x1f\\x1f\\x1f\\x13\\x\r\n             17\"$\"\\x1e$\\x1c\\x1e\\x1f\\x1e\\xff\\xdb\\x00C\\x01\\x05\\x05\\x05\\x07\\\r\n             x06\\x07\\x0e\\x08\\x08\\x0e\\x1e\\x14\\x11\\x14\\x1e\\x1e\\x1e\\x1e\\x1e\\\r\n             x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\\r\n             x1e\\x1e\\x1e\\x1e\\x1e\\...\r\n     kwargs = {'headers': {'Content-type': 'application/octet-stream',\r\n                           'Authorization': 'Bearer abcdefgacbdegdgagcabgcc...\r\n     self.oauth_request = <method 'Connection.oauth_request' of <O365.connection.Conne\r\n                           ction object at 0x7f26cb7b7670> connection.py:752>\r\n    ..................................................\r\n\r\nFile /usr/local/lib/python3.8/dist-packages/O365/connection.py, line 765, in oauth_request\r\n    752  def oauth_request(self, url, method, **kwargs):\r\n (...)\r\n    761      # oauth authentication\r\n    762      if self.session is None:\r\n    763          self.session = self.get_session(load_token=True)\r\n    764\r\n--> 765      return self._internal_request(self.session, url, method, **kwargs)\r\n    ..................................................\r\n     self = <O365.connection.Connection object at 0x7f26cb7b7670>\r\n     url = 'https://graph.microsoft.com/v1.0/me/drive/items/XXXXXXXXXXXXXX\r\n            XXXXXXXXXXXXXXXXX:/%E3%81%A1%E3%81%AF%E3%82%84%E3%81%B\r\n            5%E3%82%8B%20%3A%20%E3%82%B5%E3%83%B3%E3%83%88%E3%83%A9.jpg:\r\n            /content'\r\n     method = 'put'\r\n     kwargs = {'data': b'\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x00\\x00\\\r\n               x01\\x00\\x01\\x00\\x00\\xff\\xdb\\x00C\\x00\\x05\\x03\\x04\\x04\\x04\\x03\r\n               \\x05\\x04\\x04\\x04\\x05\\x05\\x05\\x06\\x07\\x0c\\x08\\x07\\x07\\x07\\x07\r\n               \\x0f\\x0b\\x0b\\t\\x0c\\x11\\x0f\\x12\\x12\\x11\\x0f\\x11\\x11\\x13\\x16\\x\r\n               1c\\x17\\x13\\x14\\x1a\\x15\\x11\\x11\\x18!\\x18\\x1a\\x1d\\x1d\\x1f\\x1f\\\r\n               x1f\\x13\\x17\"$\"\\x1e$\\x1c\\x1e\\x1f\\x1e\\xff\\xdb\\x00C\\x01\\x05\\x05\r\n               \\x05\\x07\\x06\\x07\\x0e\\x08\\x08\\x0e\\x1e\\x14\\x11\\x14\\x1e\\x1e\\x1e\r\n               \\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\r\n               \\x1e\\x1e\\x1e\\x1e\\x1e...\r\n     self.session = <requests_oauthlib.oauth2_session.OAuth2Session object at 0x\r\n                     7f26f918d310>\r\n     self.get_session = <method 'Connection.get_session' of <O365.connection.Connect\r\n                         ion object at 0x7f26cb7b7670> connection.py:510>\r\n     self._internal_request = <method 'Connection._internal_request' of <O365.connection.C\r\n                               onnection object at 0x7f26cb7b7670> connection.py:635>\r\n    ..................................................\r\n\r\nFile /usr/local/lib/python3.8/dist-packages/O365/connection.py, line 727, in _internal_request\r\n    635  def _internal_request(self, request_obj, url, method, **kwargs):\r\n (...)\r\n    723                  # Server Error\r\n    724                  log.debug('Server Error: {}'.format(str(e)))\r\n    725              if self.raise_http_errors:\r\n    726                  if error_message:\r\n--> 727                      raise HTTPError('{} | Error Message: {}'.format(e.args[0], error_message), response=response) from None\r\n    728                  else:\r\n    ..................................................\r\n     self = <O365.connection.Connection object at 0x7f26cb7b7670>\r\n     request_obj = <requests_oauthlib.oauth2_session.OAuth2Session object at 0x\r\n                    7f26f918d310>\r\n     url = 'https://graph.microsoft.com/v1.0/me/drive/items/XXXXXXXXXXXXXX\r\n            XXXXXXXXXXXXXXXXX:/%E3%81%A1%E3%81%AF%E3%82%84%E3%81%B\r\n            5%E3%82%8B%20%3A%20%E3%82%B5%E3%83%B3%E3%83%88%E3%83%A9.jpg:\r\n            /content'\r\n     method = 'put'\r\n     kwargs = {'data': b'\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x00\\x00\\\r\n               x01\\x00\\x01\\x00\\x00\\xff\\xdb\\x00C\\x00\\x05\\x03\\x04\\x04\\x04\\x03\r\n               \\x05\\x04\\x04\\x04\\x05\\x05\\x05\\x06\\x07\\x0c\\x08\\x07\\x07\\x07\\x07\r\n               \\x0f\\x0b\\x0b\\t\\x0c\\x11\\x0f\\x12\\x12\\x11\\x0f\\x11\\x11\\x13\\x16\\x\r\n               1c\\x17\\x13\\x14\\x1a\\x15\\x11\\x11\\x18!\\x18\\x1a\\x1d\\x1d\\x1f\\x1f\\\r\n               x1f\\x13\\x17\"$\"\\x1e$\\x1c\\x1e\\x1f\\x1e\\xff\\xdb\\x00C\\x01\\x05\\x05\r\n               \\x05\\x07\\x06\\x07\\x0e\\x08\\x08\\x0e\\x1e\\x14\\x11\\x14\\x1e\\x1e\\x1e\r\n               \\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\\x1e\r\n               \\x1e\\x1e\\x1e\\x1e\\x1e...\r\n     log.debug = <method 'Logger.debug' of <Logger O365.connection (WARNING)>\r\n                   __init__.py:1412>\r\n     self.raise_http_errors = True\r\n     error_message = \"The request URI is not valid. The bound function binding to\r\n                       'microsoft.graph.driveItem' does not support the escape fun\r\n                      ction annotation.\"\r\n     HTTPError = <class 'requests.exceptions.HTTPError'>\r\n     response = <Response [400]>\r\n    ..................................................\r\n\r\n---- (full traceback above) ----\r\nFile <ipython-input-23-728f2e0fc659>, line 2, in <module>\r\n    file_item = parent_item.upload_file(file_path, item_name=file_name.strip())\r\nFile /usr/local/lib/python3.8/dist-packages/O365/drive.py, line 1205, in upload_file\r\n    response = self.con.put(url, headers=headers, data=data)\r\nFile /usr/local/lib/python3.8/dist-packages/O365/connection.py, line 798, in put\r\n    return self.oauth_request(url, 'put', data=data, **kwargs)\r\nFile /usr/local/lib/python3.8/dist-packages/O365/connection.py, line 765, in oauth_request\r\n    return self._internal_request(self.session, url, method, **kwargs)\r\nFile /usr/local/lib/python3.8/dist-packages/O365/connection.py, line 727, in _internal_request\r\n    raise HTTPError('{} | Error Message: {}'.format(e.args[0], error_message), response=response) from None\r\n\r\nHTTPError: 400 Client Error: Bad Request for url: https://graph.microsoft.com/v1.0/me/drive/items/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX:/%E3%81%A1%E3%81%AF%E3%82%84%E3%81%B5%E3%82%8B%20%3A%20%E3%82%B5%E3%83%B3%E3%83%88%E3%83%A9.jpg:/content | Error Message: The request URI is not valid. The bound function binding to 'microsoft.graph.driveItem' does not support the escape function annotation.\r\n```\r\n\r\nBut when i change the item_name to normal ascii character like  `dd.jpg`  i did not get any error\r\n\r\nHere is My system Info\r\n    Ubuntu 18.04\r\n    Python 3.8.1 X64\r\n    O365==2.0.6\r\n\r\nThank you", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/379", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/379/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/379/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/379/events", "html_url": "https://github.com/O365/python-o365/issues/379", "id": 542807676, "node_id": "MDU6SXNzdWU1NDI4MDc2NzY=", "number": 379, "title": "Python 3.6 required, documentation needs to be updated", "user": {"login": "markkuleinio", "id": 25136274, "node_id": "MDQ6VXNlcjI1MTM2Mjc0", "avatar_url": "https://avatars0.githubusercontent.com/u/25136274?v=4", "gravatar_id": "", "url": "https://api.github.com/users/markkuleinio", "html_url": "https://github.com/markkuleinio", "followers_url": "https://api.github.com/users/markkuleinio/followers", "following_url": "https://api.github.com/users/markkuleinio/following{/other_user}", "gists_url": "https://api.github.com/users/markkuleinio/gists{/gist_id}", "starred_url": "https://api.github.com/users/markkuleinio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/markkuleinio/subscriptions", "organizations_url": "https://api.github.com/users/markkuleinio/orgs", "repos_url": "https://api.github.com/users/markkuleinio/repos", "events_url": "https://api.github.com/users/markkuleinio/events{/privacy}", "received_events_url": "https://api.github.com/users/markkuleinio/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268450, "node_id": "MDU6TGFiZWwxNzgyNjg0NTA=", "url": "https://api.github.com/repos/O365/python-o365/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-27T09:17:31Z", "updated_at": "2020-02-06T15:14:12Z", "closed_at": "2020-02-06T15:14:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "In `README.md`:\r\n```\r\nRequirements: >= Python 3.4\r\n```\r\n\r\nHowever, in `category.py` there is `from enum import Enum, auto`, and `auto` is only available since Python 3.6. Reference: https://docs.python.org/3/library/enum.html#enum.auto", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/377", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/377/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/377/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/377/events", "html_url": "https://github.com/O365/python-o365/issues/377", "id": 541327909, "node_id": "MDU6SXNzdWU1NDEzMjc5MDk=", "number": 377, "title": "Getting the response after sending a msg", "user": {"login": "johanovic", "id": 1271171, "node_id": "MDQ6VXNlcjEyNzExNzE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1271171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johanovic", "html_url": "https://github.com/johanovic", "followers_url": "https://api.github.com/users/johanovic/followers", "following_url": "https://api.github.com/users/johanovic/following{/other_user}", "gists_url": "https://api.github.com/users/johanovic/gists{/gist_id}", "starred_url": "https://api.github.com/users/johanovic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johanovic/subscriptions", "organizations_url": "https://api.github.com/users/johanovic/orgs", "repos_url": "https://api.github.com/users/johanovic/repos", "events_url": "https://api.github.com/users/johanovic/events{/privacy}", "received_events_url": "https://api.github.com/users/johanovic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268452, "node_id": "MDU6TGFiZWwxNzgyNjg0NTI=", "url": "https://api.github.com/repos/O365/python-o365/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-21T13:38:00Z", "updated_at": "2020-02-06T15:31:50Z", "closed_at": "2020-02-06T15:31:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "I want to access the web_link for a message that I have sent. \r\n\r\nAccording to the graph docs, this is part of the response (https://docs.microsoft.com/en-us/graph/api/user-post-messages?view=graph-rest-1.0&tabs=http), but the property is not updated on the instance of a messages created via account.mailbox().new_message().\r\n\r\nA) is it possible to access the actual response given by graph\r\nB) can the web_link attribute be updated after sending the message?\r\n\r\nThanks", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/376", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/376/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/376/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/376/events", "html_url": "https://github.com/O365/python-o365/issues/376", "id": 540973238, "node_id": "MDU6SXNzdWU1NDA5NzMyMzg=", "number": 376, "title": "EventRecurrence end_date property in calendar", "user": {"login": "lindera-steffen", "id": 34647250, "node_id": "MDQ6VXNlcjM0NjQ3MjUw", "avatar_url": "https://avatars2.githubusercontent.com/u/34647250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lindera-steffen", "html_url": "https://github.com/lindera-steffen", "followers_url": "https://api.github.com/users/lindera-steffen/followers", "following_url": "https://api.github.com/users/lindera-steffen/following{/other_user}", "gists_url": "https://api.github.com/users/lindera-steffen/gists{/gist_id}", "starred_url": "https://api.github.com/users/lindera-steffen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lindera-steffen/subscriptions", "organizations_url": "https://api.github.com/users/lindera-steffen/orgs", "repos_url": "https://api.github.com/users/lindera-steffen/repos", "events_url": "https://api.github.com/users/lindera-steffen/events{/privacy}", "received_events_url": "https://api.github.com/users/lindera-steffen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268450, "node_id": "MDU6TGFiZWwxNzgyNjg0NTA=", "url": "https://api.github.com/repos/O365/python-o365/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-20T12:32:59Z", "updated_at": "2020-01-05T15:46:40Z", "closed_at": "2019-12-21T23:16:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "The Getter doesn't seem right:\r\n\r\n    @property\r\n    def end_date(self):\r\n        \"\"\" End date of repetition\r\n        :getter: get the end date\r\n        :setter: set the end date\r\n        :type: date\r\n        \"\"\"\r\n        return self.__start_date\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/374", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/374/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/374/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/374/events", "html_url": "https://github.com/O365/python-o365/issues/374", "id": 540476468, "node_id": "MDU6SXNzdWU1NDA0NzY0Njg=", "number": 374, "title": "Can we add Message Attachments using StringIO?", "user": {"login": "davidwynter", "id": 3639277, "node_id": "MDQ6VXNlcjM2MzkyNzc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3639277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidwynter", "html_url": "https://github.com/davidwynter", "followers_url": "https://api.github.com/users/davidwynter/followers", "following_url": "https://api.github.com/users/davidwynter/following{/other_user}", "gists_url": "https://api.github.com/users/davidwynter/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidwynter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidwynter/subscriptions", "organizations_url": "https://api.github.com/users/davidwynter/orgs", "repos_url": "https://api.github.com/users/davidwynter/repos", "events_url": "https://api.github.com/users/davidwynter/events{/privacy}", "received_events_url": "https://api.github.com/users/davidwynter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-12-19T18:20:09Z", "updated_at": "2020-01-09T16:04:51Z", "closed_at": "2020-01-09T16:04:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a couple of Pandas dataframes I want to attach to an email. Do I have to save them to a physical file before attaching or can I pass something like this\r\n\r\n        removed = self.export_csv(df_removed)\r\n        added = self.export_csv(df_added)\r\n        for filename in [removed, added]:\r\n            m.attachments.add(filename)\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/373", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/373/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/373/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/373/events", "html_url": "https://github.com/O365/python-o365/issues/373", "id": 539125180, "node_id": "MDU6SXNzdWU1MzkxMjUxODA=", "number": 373, "title": "With own identity auth 400 error", "user": {"login": "davidwynter", "id": 3639277, "node_id": "MDQ6VXNlcjM2MzkyNzc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3639277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidwynter", "html_url": "https://github.com/davidwynter", "followers_url": "https://api.github.com/users/davidwynter/followers", "following_url": "https://api.github.com/users/davidwynter/following{/other_user}", "gists_url": "https://api.github.com/users/davidwynter/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidwynter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidwynter/subscriptions", "organizations_url": "https://api.github.com/users/davidwynter/orgs", "repos_url": "https://api.github.com/users/davidwynter/repos", "events_url": "https://api.github.com/users/davidwynter/events{/privacy}", "received_events_url": "https://api.github.com/users/davidwynter/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-17T15:06:36Z", "updated_at": "2019-12-19T16:21:04Z", "closed_at": "2019-12-19T16:21:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is the debug output:\r\n\r\n    DEBUG:requests_oauthlib.oauth2_session:Requesting url https://login.microsoftonline.com/<tenant_id>/oauth2/v2.0/token using method POST.\r\n\tDEBUG:requests_oauthlib.oauth2_session:Supplying headers {'Accept': 'application/json', 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'} and data {'grant_type': 'client_credentials', 'client_id': '<client_id>', 'client_secret': '<client_secret>', 'scope': 'https://graph.microsoft.com/.default', 'redirect_uri': 'https://login.microsoftonline.com/common/oauth2/nativeclient'}\r\n    DEBUG:requests_oauthlib.oauth2_session:Passing through key word arguments {'json': None, 'timeout': None, 'auth': None, 'verify': True, 'proxies': None}.\r\n     DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): login.microsoftonline.com:443\r\n     DEBUG:urllib3.connectionpool:https://login.microsoftonline.com:443 \"POST /<tenant_id>/oauth2/v2.0/token HTTP/1.1\" 200 1427\r\n     DEBUG:requests_oauthlib.oauth2_session:Prepared fetch token request body grant_type=client_credentials&client_id=<client_id>&client_secret=<client_secret>%3F&scope=https%3A%2F%2Fgraph.microsoft.com%2F.default&redirect_uri=https%3A%2F%2Flogin.microsoftonline.com%2Fcommon%2Foauth2%2Fnativeclient\r\n     DEBUG:requests_oauthlib.oauth2_session:Request to fetch token completed with status 200.\r\n     DEBUG:requests_oauthlib.oauth2_session:Request headers were {'User-Agent': 'python-requests/2.22.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'application/json', 'Connection': 'keep-alive', 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8', 'Content-Length': '266'}\r\n     DEBUG:requests_oauthlib.oauth2_session:Request body was grant_type=client_credentials&client_id=<client_id>&client_secret=<client_secret>%3F&scope=https%3A%2F%2Fgraph.microsoft.com%2F.default&redirect_uri=https%3A%2F%2Flogin.microsoftonline.com%2Fcommon%2Foauth2%2Fnativeclient\r\n     DEBUG:requests_oauthlib.oauth2_session:Response headers were {'Cache-Control': 'no-cache, no-store', 'Pragma': 'no-cache', 'Content-Type': 'application/json; charset=utf-8', 'Expires': '-1', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains', 'X-Content-Type-Options': 'nosniff', 'x-ms-request-id': '044d2fc4-2672-457e-bc4d-79c8083d1000', 'x-ms-ests-server': '2.1.9767.22 - DUB2 ProdSlices', 'P3P': 'CP=\"DSP CUR OTPi IND OTRi ONL FIN\"', 'Set-Cookie': 'fpc=AsdJ1jwimFFJhCftFhf5OpqRjr2_AQAAAHQ4jdUOAAAA; expires=Sat, 18-Jan-2020 09:23:00 GMT; path=/; secure; HttpOnly; SameSite=None, x-ms-gateway-slice=prod; path=/; SameSite=None; secure; HttpOnly, stsservicecookie=ests; path=/; SameSite=None; secure; HttpOnly', 'Date': 'Thu, 19 Dec 2019 09:23:00 GMT', 'Content-Length': '1427'} and content {\"token_type\":\"Bearer\",\"expires_in\":3599,\"ext_expires_in\":3599,\"access_token\":\"<snip>\"}.\r\n     DEBUG:requests_oauthlib.oauth2_session:Invoking 0 token response hooks.\r\n     DEBUG:requests_oauthlib.oauth2_session:Obtained token {'token_type': 'Bearer', 'expires_in': 3599, 'ext_expires_in': 3599, 'access_token': '<snip>', 'expires_at': 1576750979.7527802}.\r\n     INFO:O365.connection:Requesting (POST) URL: https://graph.microsoft.com/v1.0/sendMail\r\n     INFO:O365.connection:Request parameters: {'data': '{\"message\": {\"subject\": \"Error file for client - test_managedlist yaml_group Values added to the list test are in the attached file named core_added_test.csv. Values removed from the list test are in the attached file named core_removed_test.csv\", \"body\": {\"contentType\": \"HTML\", \"content\": \"No message body set for this message, check store_error_msg has been called prior to sending\"}, \"importance\": \"normal\", \"flag\": {\"flagStatus\": \"notFlagged\"}, \"isReadReceiptRequested\": false, \"isDeliveryReceiptRequested\": false, \"toRecipients\": [{\"emailAddress\": {\"address\": \"david<snip>\"}}], \"attachments\": [{\"@odata.type\": \"#microsoft.graph.fileAttachment\", \"name\": \",test\\\\n0,test1\\\\n1,test2\\\\n\", \"contentBytes\": null}, {\"@odata.type\": \"#microsoft.graph.fileAttachment\", \"name\": \",test\\\\n0,test3\\\\n1,test4\\\\n\", \"contentBytes\": null}]}}', 'headers': {'Content-type': 'application/json'}}\r\n     DEBUG:requests_oauthlib.oauth2_session:Invoking 0 protected resource request hooks.\r\n     DEBUG:requests_oauthlib.oauth2_session:Adding token {'token_type': 'Bearer', 'expires_in': 3599, 'ext_expires_in': 3599, 'access_token': '<snip>', 'expires_at': 1576750979.7527802} to request.\r\n     DEBUG:requests_oauthlib.oauth2_session:Requesting url https://graph.microsoft.com/v1.0/sendMail using method post.\r\n     DEBUG:requests_oauthlib.oauth2_session:Supplying headers {'Content-type': 'application/json', 'Authorization': 'Bearer <snip>'} and data {\"message\": {\"subject\": \"Error file for client - test_managedlist yaml_group Values added to the list test are in the attached file named core_added_test.csv. Values removed from the list test are in the attached file named core_removed_test.csv\", \"body\": {\"contentType\": \"HTML\", \"content\": \"No message body set for this message, check store_error_msg has been called prior to sending\"}, \"importance\": \"normal\", \"flag\": {\"flagStatus\": \"notFlagged\"}, \"isReadReceiptRequested\": false, \"isDeliveryReceiptRequested\": false, \"toRecipients\": [{\"emailAddress\": {\"address\": \"david<snip>\"}}], \"attachments\": [{\"@odata.type\": \"#microsoft.graph.fileAttachment\", \"name\": \",test\\n0,test1\\n1,test2\\n\", \"contentBytes\": null}, {\"@odata.type\": \"#microsoft.graph.fileAttachment\", \"name\": \",test\\n0,test3\\n1,test4\\n\", \"contentBytes\": null}]}}\r\n     DEBUG:requests_oauthlib.oauth2_session:Passing through key word arguments {}.\r\n     DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): graph.microsoft.com:443\r\n     DEBUG:urllib3.connectionpool:https://graph.microsoft.com:443 \"POST /v1.0/sendMail HTTP/1.1\" 400 242\r\n     ERROR:O365.connection:Client Error: 400 Client Error: Bad Request for url: https://graph.microsoft.com/v1.0/sendMail | Error Message: Resource not found for the segment 'sendMail'.\r\n\r\nHere is the code:\r\n\r\n        credentials = (tuple(self.credentials365))\r\n        account = Account(credentials, auth_flow_type='credentials', tenant_id=self.tenant_id)\r\n        if not account.is_authenticated:  # will check if there is a token and has not expired\r\n            # ask for a login\r\n            # console based authentication See Authentication for other flows\r\n            account.authenticate()\r\n\r\n        m = account.new_message()\r\n        for to in self.to:\r\n            m.to.add(to)\r\n        m.subject = self.subject_prefix + caller + ' yaml_group ' + yaml_grp\r\n        if hasattr(self, 'errormsg'):\r\n            m.body = self.errormsg[caller]\r\n        else:\r\n            m.body = 'No message body set for this message, check store_error_msg has been called prior to sending'\r\n\r\n        for filename in filenames:\r\n            m.attachments.add(filename)\r\n\r\n        m.send()\r\n\r\nI have a o365token.txt file in the same directory as the code above is placed. \r\n\r\nI have an additional question. If we are going to deploy to > 1 servers can we just distribute the same o365token.txt across multiple servers that run our web application (where the emails are sent from)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/372", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/372/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/372/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/372/events", "html_url": "https://github.com/O365/python-o365/issues/372", "id": 535750832, "node_id": "MDU6SXNzdWU1MzU3NTA4MzI=", "number": 372, "title": "User Properties", "user": {"login": "nishizawa-jpn", "id": 58421648, "node_id": "MDQ6VXNlcjU4NDIxNjQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/58421648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nishizawa-jpn", "html_url": "https://github.com/nishizawa-jpn", "followers_url": "https://api.github.com/users/nishizawa-jpn/followers", "following_url": "https://api.github.com/users/nishizawa-jpn/following{/other_user}", "gists_url": "https://api.github.com/users/nishizawa-jpn/gists{/gist_id}", "starred_url": "https://api.github.com/users/nishizawa-jpn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nishizawa-jpn/subscriptions", "organizations_url": "https://api.github.com/users/nishizawa-jpn/orgs", "repos_url": "https://api.github.com/users/nishizawa-jpn/repos", "events_url": "https://api.github.com/users/nishizawa-jpn/events{/privacy}", "received_events_url": "https://api.github.com/users/nishizawa-jpn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-12-10T14:03:52Z", "updated_at": "2019-12-11T20:43:50Z", "closed_at": "2019-12-11T20:43:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following code, i could get user properties.\r\n```\r\ndirectory=account.directory()\r\nuser_query=directory.q().on_attribute('display_name').startswith(\"TestUser\")\r\nusers=directory.get_users(query=user_query)\r\nfor user in users:\r\n    print(user.display_name)\r\n    print(user.given_name)\r\n    print(user.surname)\r\n    print(user.mail) \r\n    print(user.business_phones)\r\n    print(user.office_location)\r\n```\r\n\r\n> TestUser\r\n> Test\r\n> User\r\n> test01@domain.com\r\n> ['+1 1111111111']\r\n> office\r\n> ja-JP\r\n\r\nbut I could not get detail properties.Is there anything missing from this code?\r\n```\r\nfor user in users:\r\n    print(user.preferred_language)\r\n    print(user.city)\r\n    print(user.company_name)\r\n    print(user.country)\r\n    print(user.department)\r\n```\r\n\r\n> None\r\n> None\r\n> None\r\n> None\r\n> None", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/371", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/371/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/371/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/371/events", "html_url": "https://github.com/O365/python-o365/issues/371", "id": 535268851, "node_id": "MDU6SXNzdWU1MzUyNjg4NTE=", "number": 371, "title": "Feedback", "user": {"login": "johanovic", "id": 1271171, "node_id": "MDQ6VXNlcjEyNzExNzE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1271171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johanovic", "html_url": "https://github.com/johanovic", "followers_url": "https://api.github.com/users/johanovic/followers", "following_url": "https://api.github.com/users/johanovic/following{/other_user}", "gists_url": "https://api.github.com/users/johanovic/gists{/gist_id}", "starred_url": "https://api.github.com/users/johanovic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johanovic/subscriptions", "organizations_url": "https://api.github.com/users/johanovic/orgs", "repos_url": "https://api.github.com/users/johanovic/repos", "events_url": "https://api.github.com/users/johanovic/events{/privacy}", "received_events_url": "https://api.github.com/users/johanovic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268455, "node_id": "MDU6TGFiZWwxNzgyNjg0NTU=", "url": "https://api.github.com/repos/O365/python-o365/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-12-09T20:24:03Z", "updated_at": "2020-05-18T04:04:43Z", "closed_at": "2019-12-11T10:21:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am a bit confused by the amount of 'automagical' things that take place. For instance, the way the token backend saves tokens, it is just insufficiently unclear to me. I have to read almost all the code to understand what is going on. Do you maybe want to add some more detail? And a number of examples? \r\n\r\nI'll give a usecase. I want to store connections based on a user_principal_name. I want to store user_principal_name + token. To get that user_principal_name I first need to request the token, but I can't store it yet because I first have to get user_principal_name. So the automatic parts (storing a token, refreshing it, etc.) could really do with more documentation, I think.\r\n\r\nThanks", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/370", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/370/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/370/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/370/events", "html_url": "https://github.com/O365/python-o365/issues/370", "id": 533845805, "node_id": "MDU6SXNzdWU1MzM4NDU4MDU=", "number": 370, "title": "Django example?", "user": {"login": "johanovic", "id": 1271171, "node_id": "MDQ6VXNlcjEyNzExNzE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1271171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johanovic", "html_url": "https://github.com/johanovic", "followers_url": "https://api.github.com/users/johanovic/followers", "following_url": "https://api.github.com/users/johanovic/following{/other_user}", "gists_url": "https://api.github.com/users/johanovic/gists{/gist_id}", "starred_url": "https://api.github.com/users/johanovic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johanovic/subscriptions", "organizations_url": "https://api.github.com/users/johanovic/orgs", "repos_url": "https://api.github.com/users/johanovic/repos", "events_url": "https://api.github.com/users/johanovic/events{/privacy}", "received_events_url": "https://api.github.com/users/johanovic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-06T09:30:28Z", "updated_at": "2019-12-10T11:48:38Z", "closed_at": "2019-12-06T12:49:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to convert the Flask example to a django one, but I am running into an issue.\r\n\r\nI am running https://github.com/teddziuba/django-sslserver to get this working. Three separate views handle the process. In the second step, I do **not** get a result. Not sure why that is the case. Any insight? \r\n\r\n    from django.shortcuts import render, redirect, HttpResponseRedirect\r\n    from django.contrib.auth.decorators import user_passes_test\r\n\r\n    from O365 import Account, MSGraphProtocol\r\n\r\n    @user_passes_test(lambda u: u.is_superuser)\r\n    def authenticate_graph_step1(request):\r\n        print('Start the first view')\r\n\r\n        callback = 'https://localhost:8000/graph/step2/'\r\n        account = Account(credentials = ('bla', 'bla'),\r\n            scopes=['offline_access', 'Mail.Read'])\r\n        url, state = account.con.get_authorization_url(requested_scopes=['offline_access', 'Mail.Read'],\r\n                                                    redirect_uri=callback)\r\n        with open('state.txt', 'w') as statefile:\r\n            statefile.write(state)\r\n        return redirect(url)\r\n\r\n    def authenticate_graph_step2(request):\r\n        print('Start the second view')\r\n\r\n        with open('state.txt') as statefile:\r\n            state = statefile.read()\r\n        callback = 'https://localhost:8000/graph/step2/'\r\n        account = Account(credentials = (credentials = ('bla', 'bla'),\r\n            scopes=['offline_access', 'Mail.Read'])\r\n        request_uri = request.get_full_path()\r\n        result = account.con.request_token(request_uri, \r\n                                        state=state,\r\n                                        redirect_uri=callback)\r\n        if result:\r\n            return redirect('messages')\r\n        else:\r\n            print(\"George Best all the way\")\r\n\r\n    @user_passes_test(lambda u: u.is_superuser)\r\n    def messages(request):\r\n        print('Now handling the messages')\r\n\r\n        account = Account(credentials = (credentials = ('bla', 'bla'),\r\n            scopes=['offline_access', 'Mail.Read'])\r\n        mb = account.mailbox()\r\n        messages = mb.get_messages()\r\n        return render(request, 'connects/graph_george_best.html', {'messages':messages})\r\n\r\nThe error I get is `No auth token found. Authentication Flow needed`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/369", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/369/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/369/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/369/events", "html_url": "https://github.com/O365/python-o365/issues/369", "id": 533841915, "node_id": "MDU6SXNzdWU1MzM4NDE5MTU=", "number": 369, "title": "Documentation: step 3 of the flask example?", "user": {"login": "johanovic", "id": 1271171, "node_id": "MDQ6VXNlcjEyNzExNzE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1271171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johanovic", "html_url": "https://github.com/johanovic", "followers_url": "https://api.github.com/users/johanovic/followers", "following_url": "https://api.github.com/users/johanovic/following{/other_user}", "gists_url": "https://api.github.com/users/johanovic/gists{/gist_id}", "starred_url": "https://api.github.com/users/johanovic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johanovic/subscriptions", "organizations_url": "https://api.github.com/users/johanovic/orgs", "repos_url": "https://api.github.com/users/johanovic/repos", "events_url": "https://api.github.com/users/johanovic/events{/privacy}", "received_events_url": "https://api.github.com/users/johanovic/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-06T09:22:33Z", "updated_at": "2019-12-11T10:42:43Z", "closed_at": "2019-12-11T10:22:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "The README provides a Flask authentication logic, but it does not provide a step 3. Does a third view, for instance, one which shows the top 10 messages of the inbox, simply do the following?\r\n\r\n    account = Account(credentials = ('bla', 'bla'),\r\n        scopes=['offline_access', 'Mail.Read'])\r\n    mb = account.mailbox()\r\n    messages = mb.get_messages()\r\n\r\nIf it's the case that you don't need to authenticate explicitly (it happens automagically) that's lovely, but it might be worthwhile adding it to the docs.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/367", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/367/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/367/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/367/events", "html_url": "https://github.com/O365/python-o365/issues/367", "id": 532281773, "node_id": "MDU6SXNzdWU1MzIyODE3NzM=", "number": 367, "title": "No module named Account", "user": {"login": "umrashrf", "id": 652326, "node_id": "MDQ6VXNlcjY1MjMyNg==", "avatar_url": "https://avatars0.githubusercontent.com/u/652326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/umrashrf", "html_url": "https://github.com/umrashrf", "followers_url": "https://api.github.com/users/umrashrf/followers", "following_url": "https://api.github.com/users/umrashrf/following{/other_user}", "gists_url": "https://api.github.com/users/umrashrf/gists{/gist_id}", "starred_url": "https://api.github.com/users/umrashrf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/umrashrf/subscriptions", "organizations_url": "https://api.github.com/users/umrashrf/orgs", "repos_url": "https://api.github.com/users/umrashrf/repos", "events_url": "https://api.github.com/users/umrashrf/events{/privacy}", "received_events_url": "https://api.github.com/users/umrashrf/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-12-03T21:35:33Z", "updated_at": "2019-12-05T11:31:10Z", "closed_at": "2019-12-05T11:31:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "Fresh install O365 using pip but the README seems to be wrong. There is no Account module.\r\n\r\n```\r\n$ pip freeze | grep O365\r\nO365==0.9.16\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/366", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/366/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/366/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/366/events", "html_url": "https://github.com/O365/python-o365/issues/366", "id": 531865837, "node_id": "MDU6SXNzdWU1MzE4NjU4Mzc=", "number": 366, "title": "Mailbox Feature", "user": {"login": "rootsid", "id": 14955716, "node_id": "MDQ6VXNlcjE0OTU1NzE2", "avatar_url": "https://avatars3.githubusercontent.com/u/14955716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rootsid", "html_url": "https://github.com/rootsid", "followers_url": "https://api.github.com/users/rootsid/followers", "following_url": "https://api.github.com/users/rootsid/following{/other_user}", "gists_url": "https://api.github.com/users/rootsid/gists{/gist_id}", "starred_url": "https://api.github.com/users/rootsid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rootsid/subscriptions", "organizations_url": "https://api.github.com/users/rootsid/orgs", "repos_url": "https://api.github.com/users/rootsid/repos", "events_url": "https://api.github.com/users/rootsid/events{/privacy}", "received_events_url": "https://api.github.com/users/rootsid/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-12-03T10:03:44Z", "updated_at": "2019-12-03T17:44:54Z", "closed_at": "2019-12-03T11:15:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "From mailbox we can get the emails but it gives email subjects only, how can we get the body of the email ?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/365", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/365/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/365/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/365/events", "html_url": "https://github.com/O365/python-o365/issues/365", "id": 531019999, "node_id": "MDU6SXNzdWU1MzEwMTk5OTk=", "number": 365, "title": "Access to the Global Address List", "user": {"login": "nishizawa-jpn", "id": 58421648, "node_id": "MDQ6VXNlcjU4NDIxNjQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/58421648?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nishizawa-jpn", "html_url": "https://github.com/nishizawa-jpn", "followers_url": "https://api.github.com/users/nishizawa-jpn/followers", "following_url": "https://api.github.com/users/nishizawa-jpn/following{/other_user}", "gists_url": "https://api.github.com/users/nishizawa-jpn/gists{/gist_id}", "starred_url": "https://api.github.com/users/nishizawa-jpn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nishizawa-jpn/subscriptions", "organizations_url": "https://api.github.com/users/nishizawa-jpn/orgs", "repos_url": "https://api.github.com/users/nishizawa-jpn/repos", "events_url": "https://api.github.com/users/nishizawa-jpn/events{/privacy}", "received_events_url": "https://api.github.com/users/nishizawa-jpn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-12-02T10:05:10Z", "updated_at": "2019-12-05T11:31:21Z", "closed_at": "2019-12-05T11:31:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tried the sample. \r\n```\r\n address_book=account.address_book()\r\n global_address_list = account.address_book(address_book='gal')\r\n q=global_address_list.new_query('display_name')\r\n q.startswith('George Best')\r\n print(global_address_list.get_contacts(query=q))\r\n```\r\n>>AttributeError: 'Directory' object has no attribute 'get_contacts'\r\n\r\n  This sample is wrong?\r\n  I succeeded the following code.\r\n```\r\n print(global_address_list.get_current_user())\r\n```\r\n>>TestUser\r\n\r\nbut I cloud not get users list.\r\n```\r\nlists=global_address_list.get_users()\r\nlists.__next__()\r\n```\r\n>>StopIteration\r\n\r\nhow do i get users list?\r\ni'm sorry for my poor English.\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/363", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/363/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/363/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/363/events", "html_url": "https://github.com/O365/python-o365/issues/363", "id": 528070632, "node_id": "MDU6SXNzdWU1MjgwNzA2MzI=", "number": 363, "title": "application password support?", "user": {"login": "segalion", "id": 26971667, "node_id": "MDQ6VXNlcjI2OTcxNjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/26971667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segalion", "html_url": "https://github.com/segalion", "followers_url": "https://api.github.com/users/segalion/followers", "following_url": "https://api.github.com/users/segalion/following{/other_user}", "gists_url": "https://api.github.com/users/segalion/gists{/gist_id}", "starred_url": "https://api.github.com/users/segalion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segalion/subscriptions", "organizations_url": "https://api.github.com/users/segalion/orgs", "repos_url": "https://api.github.com/users/segalion/repos", "events_url": "https://api.github.com/users/segalion/events{/privacy}", "received_events_url": "https://api.github.com/users/segalion/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-11-25T12:59:29Z", "updated_at": "2019-11-28T10:05:18Z", "closed_at": "2019-11-28T10:05:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Some companies dont let external apps access to tenant at all, but let users create passwords for some legacy applications:\r\n\r\nhttps://docs.microsoft.com/es-es/azure/active-directory/user-help/multi-factor-authentication-end-user-app-passwords\r\n\r\nDo you know if python-o365 could use this kind of authentication?\r\nSure it works similar to basic-auth, because \"old apps\" works fine login with \"o365_user\" and \"legacy_app_password\"\r\n\r\nThanks in advance.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/362", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/362/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/362/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/362/events", "html_url": "https://github.com/O365/python-o365/issues/362", "id": 527706021, "node_id": "MDU6SXNzdWU1Mjc3MDYwMjE=", "number": 362, "title": "Token expired - sharepoint.get_sites doesn't work", "user": {"login": "newdoug55", "id": 46818712, "node_id": "MDQ6VXNlcjQ2ODE4NzEy", "avatar_url": "https://avatars1.githubusercontent.com/u/46818712?v=4", "gravatar_id": "", "url": "https://api.github.com/users/newdoug55", "html_url": "https://github.com/newdoug55", "followers_url": "https://api.github.com/users/newdoug55/followers", "following_url": "https://api.github.com/users/newdoug55/following{/other_user}", "gists_url": "https://api.github.com/users/newdoug55/gists{/gist_id}", "starred_url": "https://api.github.com/users/newdoug55/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/newdoug55/subscriptions", "organizations_url": "https://api.github.com/users/newdoug55/orgs", "repos_url": "https://api.github.com/users/newdoug55/repos", "events_url": "https://api.github.com/users/newdoug55/events{/privacy}", "received_events_url": "https://api.github.com/users/newdoug55/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-24T14:27:49Z", "updated_at": "2019-11-25T11:47:20Z", "closed_at": "2019-11-25T11:47:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have tried for days now to get this to work with no success.  I was getting an access_token but now I can't get the token anymore.  The token is expired.  I have tried refreshing the token with no success.  You can not refresh an access token that has no \"refresh_token\" available. Include \"offline_access\" scope when authenticating to get a \"refresh_token\".  I included 'basic' which includes 'offline_access'.  Once I was getting an access_token to use graph to get to the sharepoint site I was getting this error 'Open navigation properties are not supported on OpenTypes'\r\n\r\ncredentials = ('app_id', 'app_secret')\r\nprotocol_graph = MSGraphProtocol(default_resource=name@company.com')\r\nscopes_graph = protocol_graph.get_scopes_for(['basic', 'sharepoint_dl'])\r\n\r\ntoken_graph = FileSystemTokenBackend(token_path='C:\\work', token_filename='o365_token.txt')\r\naccount = Account(credentials, auth_flow_type='authorization', \\\r\n    tenant_id='tenant_id'),  scopes=scopes_graph, token_backend=token_graph)\r\nif Connection(credentials).refresh_token() is True:\r\n    print('authenicate')\r\n\r\nsp = Sharepoint(parent=account)\r\n\r\nsites = sp.get_site('company.sharepoint.com', https://company.sharepoint.com/sites/projectmanagement')\r\n\r\nAny help would be appreciated.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/361", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/361/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/361/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/361/events", "html_url": "https://github.com/O365/python-o365/issues/361", "id": 526611956, "node_id": "MDU6SXNzdWU1MjY2MTE5NTY=", "number": 361, "title": "Incorrect protocol url and scope prefix used for MSOffice365Protocol", "user": {"login": "rayeeskm", "id": 2072089, "node_id": "MDQ6VXNlcjIwNzIwODk=", "avatar_url": "https://avatars2.githubusercontent.com/u/2072089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rayeeskm", "html_url": "https://github.com/rayeeskm", "followers_url": "https://api.github.com/users/rayeeskm/followers", "following_url": "https://api.github.com/users/rayeeskm/following{/other_user}", "gists_url": "https://api.github.com/users/rayeeskm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rayeeskm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rayeeskm/subscriptions", "organizations_url": "https://api.github.com/users/rayeeskm/orgs", "repos_url": "https://api.github.com/users/rayeeskm/repos", "events_url": "https://api.github.com/users/rayeeskm/events{/privacy}", "received_events_url": "https://api.github.com/users/rayeeskm/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "Narcolapser", "id": 877475, "node_id": "MDQ6VXNlcjg3NzQ3NQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/877475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Narcolapser", "html_url": "https://github.com/Narcolapser", "followers_url": "https://api.github.com/users/Narcolapser/followers", "following_url": "https://api.github.com/users/Narcolapser/following{/other_user}", "gists_url": "https://api.github.com/users/Narcolapser/gists{/gist_id}", "starred_url": "https://api.github.com/users/Narcolapser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Narcolapser/subscriptions", "organizations_url": "https://api.github.com/users/Narcolapser/orgs", "repos_url": "https://api.github.com/users/Narcolapser/repos", "events_url": "https://api.github.com/users/Narcolapser/events{/privacy}", "received_events_url": "https://api.github.com/users/Narcolapser/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Narcolapser", "id": 877475, "node_id": "MDQ6VXNlcjg3NzQ3NQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/877475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Narcolapser", "html_url": "https://github.com/Narcolapser", "followers_url": "https://api.github.com/users/Narcolapser/followers", "following_url": "https://api.github.com/users/Narcolapser/following{/other_user}", "gists_url": "https://api.github.com/users/Narcolapser/gists{/gist_id}", "starred_url": "https://api.github.com/users/Narcolapser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Narcolapser/subscriptions", "organizations_url": "https://api.github.com/users/Narcolapser/orgs", "repos_url": "https://api.github.com/users/Narcolapser/repos", "events_url": "https://api.github.com/users/Narcolapser/events{/privacy}", "received_events_url": "https://api.github.com/users/Narcolapser/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-11-21T13:58:29Z", "updated_at": "2020-02-06T09:35:21Z", "closed_at": "2020-02-06T09:35:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using MSOffice365Protocol as the protocol, during authentication it always fails with error \r\n\r\n`Unable to fetch auth token. Error: (invalid_client) AADSTS700025: Client is public so neither 'client_assertion' nor 'client_secret' should be presented.`\r\n\r\nThe issue was found to be the following\r\n\r\n`    class MSOffice365Protocol(Protocol): `\r\n`    _protocol_url = 'https://outlook.office.com/api/'`\r\n`    _oauth_scope_prefix = 'https://outlook.office.com/'`\r\n\r\nAfter changing it to the following, it seems to work fine\r\n\r\n`    _protocol_url = 'https://outlook.office365.com/api/'`\r\n`    _oauth_scope_prefix = 'https://outlook.office365.com/'`\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/360", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/360/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/360/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/360/events", "html_url": "https://github.com/O365/python-o365/issues/360", "id": 526165732, "node_id": "MDU6SXNzdWU1MjYxNjU3MzI=", "number": 360, "title": "[Question] o365 limits number of emails you can process?", "user": {"login": "lia-cha-avalara", "id": 54375621, "node_id": "MDQ6VXNlcjU0Mzc1NjIx", "avatar_url": "https://avatars1.githubusercontent.com/u/54375621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lia-cha-avalara", "html_url": "https://github.com/lia-cha-avalara", "followers_url": "https://api.github.com/users/lia-cha-avalara/followers", "following_url": "https://api.github.com/users/lia-cha-avalara/following{/other_user}", "gists_url": "https://api.github.com/users/lia-cha-avalara/gists{/gist_id}", "starred_url": "https://api.github.com/users/lia-cha-avalara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lia-cha-avalara/subscriptions", "organizations_url": "https://api.github.com/users/lia-cha-avalara/orgs", "repos_url": "https://api.github.com/users/lia-cha-avalara/repos", "events_url": "https://api.github.com/users/lia-cha-avalara/events{/privacy}", "received_events_url": "https://api.github.com/users/lia-cha-avalara/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268455, "node_id": "MDU6TGFiZWwxNzgyNjg0NTU=", "url": "https://api.github.com/repos/O365/python-o365/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-11-20T20:19:24Z", "updated_at": "2020-08-16T12:09:53Z", "closed_at": "2020-02-06T15:14:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm not quite sure how to ask this question but I wrote a script that scrapes an inbox, writes the email subject, received date, sender, attachment names, and flag status depending on whatever parameters are passed in from jenkins.\r\n\r\nIt's been working well for 3-4 weeks but noticed recently it started reporting a HTTP 500 Internal Server error whenever it tried running the message.send() method. I can confirm the csv file it writes to has all the correct data, it just won't send the email.\r\n\r\nThe only thing I can think of is o365 is somehow throttling the number of calls you can make? If i enforce a limit on the number of messages it can retrieve to 500 to 3k, everything works as normal. The inbox previously had 16-18k messages while it was running okay. This week its hovering over 19k messages and I am now getting failures when attempting to send the report in an email. Any thoughts? helpful hints on how to work around this?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/359", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/359/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/359/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/359/events", "html_url": "https://github.com/O365/python-o365/issues/359", "id": 525406613, "node_id": "MDU6SXNzdWU1MjU0MDY2MTM=", "number": 359, "title": "Able to query on \"flagged\" emails?", "user": {"login": "lia-cha-avalara", "id": 54375621, "node_id": "MDQ6VXNlcjU0Mzc1NjIx", "avatar_url": "https://avatars1.githubusercontent.com/u/54375621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lia-cha-avalara", "html_url": "https://github.com/lia-cha-avalara", "followers_url": "https://api.github.com/users/lia-cha-avalara/followers", "following_url": "https://api.github.com/users/lia-cha-avalara/following{/other_user}", "gists_url": "https://api.github.com/users/lia-cha-avalara/gists{/gist_id}", "starred_url": "https://api.github.com/users/lia-cha-avalara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lia-cha-avalara/subscriptions", "organizations_url": "https://api.github.com/users/lia-cha-avalara/orgs", "repos_url": "https://api.github.com/users/lia-cha-avalara/repos", "events_url": "https://api.github.com/users/lia-cha-avalara/events{/privacy}", "received_events_url": "https://api.github.com/users/lia-cha-avalara/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-20T03:30:16Z", "updated_at": "2019-11-20T15:14:08Z", "closed_at": "2019-11-20T15:14:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I saw from the graph api that the filter flag/flagstatus-eq flagged was implemented but curious how we would chain that with an existing query. My existing query already is like this\r\n\r\nq = inbox.q().expand('attachments').select('name')\r\n\r\nI was thinking something like:\r\nq.chain('and').on_attribute('flag').equals('flagged)\r\n\r\nBut I have no idea if that's the right attribute/combo. In the MS examples I looked at it was using a filter statement.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/358", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/358/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/358/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/358/events", "html_url": "https://github.com/O365/python-o365/issues/358", "id": 525136473, "node_id": "MDU6SXNzdWU1MjUxMzY0NzM=", "number": 358, "title": "Create event in Group Calendars. ", "user": {"login": "isaactorres13", "id": 36905842, "node_id": "MDQ6VXNlcjM2OTA1ODQy", "avatar_url": "https://avatars0.githubusercontent.com/u/36905842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isaactorres13", "html_url": "https://github.com/isaactorres13", "followers_url": "https://api.github.com/users/isaactorres13/followers", "following_url": "https://api.github.com/users/isaactorres13/following{/other_user}", "gists_url": "https://api.github.com/users/isaactorres13/gists{/gist_id}", "starred_url": "https://api.github.com/users/isaactorres13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isaactorres13/subscriptions", "organizations_url": "https://api.github.com/users/isaactorres13/orgs", "repos_url": "https://api.github.com/users/isaactorres13/repos", "events_url": "https://api.github.com/users/isaactorres13/events{/privacy}", "received_events_url": "https://api.github.com/users/isaactorres13/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-11-19T16:54:45Z", "updated_at": "2020-02-06T15:33:44Z", "closed_at": "2020-02-06T15:33:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to create events in different groups of calendars such as \"shared\", \"other\" or \"rooms\" calendars but I have not found a way to get a list of them. All those names of Calendar Groups I have in my account.\r\nI hope there is a way to do it, thanks.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/355", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/355/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/355/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/355/events", "html_url": "https://github.com/O365/python-o365/issues/355", "id": 519788184, "node_id": "MDU6SXNzdWU1MTk3ODgxODQ=", "number": 355, "title": "Error Message: Some users in the request cannot be invited securely.", "user": {"login": "weasteam", "id": 6238854, "node_id": "MDQ6VXNlcjYyMzg4NTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6238854?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weasteam", "html_url": "https://github.com/weasteam", "followers_url": "https://api.github.com/users/weasteam/followers", "following_url": "https://api.github.com/users/weasteam/following{/other_user}", "gists_url": "https://api.github.com/users/weasteam/gists{/gist_id}", "starred_url": "https://api.github.com/users/weasteam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weasteam/subscriptions", "organizations_url": "https://api.github.com/users/weasteam/orgs", "repos_url": "https://api.github.com/users/weasteam/repos", "events_url": "https://api.github.com/users/weasteam/events{/privacy}", "received_events_url": "https://api.github.com/users/weasteam/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-08T05:31:01Z", "updated_at": "2020-04-30T09:12:30Z", "closed_at": "2020-04-30T09:12:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I do this:\r\n```\r\nfile.share_with_invite(recipients=viewers, send_email=False, share_type='view')\r\n```\r\n\r\nFor some of the emails, I got the above error. Other email works well. Not sure why. Please advise.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/351", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/351/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/351/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/351/events", "html_url": "https://github.com/O365/python-o365/issues/351", "id": 518985900, "node_id": "MDU6SXNzdWU1MTg5ODU5MDA=", "number": 351, "title": "Question:  Trying to access tasks for a given project plan", "user": {"login": "JeffChuSBX", "id": 57374701, "node_id": "MDQ6VXNlcjU3Mzc0NzAx", "avatar_url": "https://avatars1.githubusercontent.com/u/57374701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JeffChuSBX", "html_url": "https://github.com/JeffChuSBX", "followers_url": "https://api.github.com/users/JeffChuSBX/followers", "following_url": "https://api.github.com/users/JeffChuSBX/following{/other_user}", "gists_url": "https://api.github.com/users/JeffChuSBX/gists{/gist_id}", "starred_url": "https://api.github.com/users/JeffChuSBX/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JeffChuSBX/subscriptions", "organizations_url": "https://api.github.com/users/JeffChuSBX/orgs", "repos_url": "https://api.github.com/users/JeffChuSBX/repos", "events_url": "https://api.github.com/users/JeffChuSBX/events{/privacy}", "received_events_url": "https://api.github.com/users/JeffChuSBX/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-11-07T01:30:53Z", "updated_at": "2020-02-06T15:34:27Z", "closed_at": "2020-02-06T15:34:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to access all the tasks for a given plan id.  I have the route properly formed and believe I have all the permissions set properly (I've verified the route and access via MS Graph Explorer).  I'm authenticating with my own identity.  I'm guessing that since permissions only exist for Delegate Type, I can't access this route using the device authentication?  Just wanted to verify.\r\n\r\n**Error**\r\n401 Client Error: Unauthorized for url: https://graph.microsoft.com/v1.0/planner/plans/{group_id}/tasks\r\n\r\n**Permissions**\r\n![image](https://user-images.githubusercontent.com/57374701/68352340-1e525380-00d4-11ea-8dd0-cfca574cbd9c.png)\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/350", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/350/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/350/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/350/events", "html_url": "https://github.com/O365/python-o365/issues/350", "id": 518625216, "node_id": "MDU6SXNzdWU1MTg2MjUyMTY=", "number": 350, "title": "oauth token race condition?", "user": {"login": "riptusk331", "id": 6278002, "node_id": "MDQ6VXNlcjYyNzgwMDI=", "avatar_url": "https://avatars1.githubusercontent.com/u/6278002?v=4", "gravatar_id": "", "url": "https://api.github.com/users/riptusk331", "html_url": "https://github.com/riptusk331", "followers_url": "https://api.github.com/users/riptusk331/followers", "following_url": "https://api.github.com/users/riptusk331/following{/other_user}", "gists_url": "https://api.github.com/users/riptusk331/gists{/gist_id}", "starred_url": "https://api.github.com/users/riptusk331/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/riptusk331/subscriptions", "organizations_url": "https://api.github.com/users/riptusk331/orgs", "repos_url": "https://api.github.com/users/riptusk331/repos", "events_url": "https://api.github.com/users/riptusk331/events{/privacy}", "received_events_url": "https://api.github.com/users/riptusk331/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268452, "node_id": "MDU6TGFiZWwxNzgyNjg0NTI=", "url": "https://api.github.com/repos/O365/python-o365/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "janscas", "id": 7224106, "node_id": "MDQ6VXNlcjcyMjQxMDY=", "avatar_url": "https://avatars1.githubusercontent.com/u/7224106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janscas", "html_url": "https://github.com/janscas", "followers_url": "https://api.github.com/users/janscas/followers", "following_url": "https://api.github.com/users/janscas/following{/other_user}", "gists_url": "https://api.github.com/users/janscas/gists{/gist_id}", "starred_url": "https://api.github.com/users/janscas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janscas/subscriptions", "organizations_url": "https://api.github.com/users/janscas/orgs", "repos_url": "https://api.github.com/users/janscas/repos", "events_url": "https://api.github.com/users/janscas/events{/privacy}", "received_events_url": "https://api.github.com/users/janscas/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "janscas", "id": 7224106, "node_id": "MDQ6VXNlcjcyMjQxMDY=", "avatar_url": "https://avatars1.githubusercontent.com/u/7224106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janscas", "html_url": "https://github.com/janscas", "followers_url": "https://api.github.com/users/janscas/followers", "following_url": "https://api.github.com/users/janscas/following{/other_user}", "gists_url": "https://api.github.com/users/janscas/gists{/gist_id}", "starred_url": "https://api.github.com/users/janscas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janscas/subscriptions", "organizations_url": "https://api.github.com/users/janscas/orgs", "repos_url": "https://api.github.com/users/janscas/repos", "events_url": "https://api.github.com/users/janscas/events{/privacy}", "received_events_url": "https://api.github.com/users/janscas/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 20, "created_at": "2019-11-06T17:37:41Z", "updated_at": "2019-11-20T17:11:17Z", "closed_at": "2019-11-20T17:11:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I have run into a fairly interesting race condition problem using oauth tokens stored on the filesystem. At least it has the hallmarks of a race condition...\r\n\r\nI use O365 in a (Docker) containerized application I've developed that manages file encryption & SFTP transfers for my company. My application runs various download & upload jobs daily via **cron**, and sends out status e-mails when the jobs have completed. I have wrapped O365 in a separate module I created that takes care of all its initialization and allows my other modules to easily send preset e-mails depending on the job. Each job calls its own instance of this O365 wrapper.\r\n\r\nI have 2 jobs that run at the exact same time in the morning. The jobs take **_slightly_** different amounts of time to complete, on the order of milliseconds. When they're done, they both call the O365 wrapper, which starts the process of initializing O365 and sending the desired e-mails. At the time of these jobs, the last token was used over 60 min prior, so O365 has to fetch new oAuth tokens thru Graph.\r\n\r\nHere's where things get funky. Since the calls to O365 come within a few milliseconds of one another, it's not enough time for the first call to fetch and save down a new token **and** have the other call see this token before it goes and does the same thing. So both O365 calls think they need to get new tokens...which they do (successfully). Both jobs then send a POST request to the graph sendMail endpoint with my email content...and after about 20 seconds I get a 503 service unavailable error on both requests.\r\n\r\nTo make this a bit easier to understand - here is a very rough, simplified & scrubbed version of my logs, to indicate what's happening.\r\n\r\n```\r\n2019-11-06 07:00:01,236 - job1 - INFO - Job 1 Finishes\r\n2019-11-06 07:00:01,238 - O365.connection:_internal_request:618 - INFO - Requesting (POST) URL: https://graph.microsoft.com/v1.0/users/myemail@myemail.com/sendMail\r\n2019-11-06 07:00:01,238 - O365.connection:_internal_request:619 - INFO - Request parameters: {...job 1 graph json...}\r\n2019-11-06 07:00:01,238 - O365.connection:_internal_request:634 - INFO - Oauth Token is expired, fetching a new token\r\n2019-11-06 07:00:01,246 - job2 - INFO - Job 2 Finishes\r\n2019-11-06 07:00:01,248 - O365.connection:_internal_request:618 - INFO - Requesting (POST) URL: https://graph.microsoft.com/v1.0/users/myemail@myemail.com/sendMail\r\n2019-11-06 07:00:01,248 - O365.connection:_internal_request:619 - INFO - Request parameters: {...job 2 graph json...}\r\n2019-11-06 07:00:01,248 - O365.connection:_internal_request:634 - INFO - Oauth Token is expired, fetching a new token\r\n2019-11-06 07:00:01,669 - O365.connection:_internal_request:637 - INFO - New oauth token fetched\r\n2019-11-06 07:00:01,669 - O365.connection:_internal_request:618 - INFO - Requesting (POST) URL: https://graph.microsoft.com/v1.0/users/myemail@myemail.com/sendMail\r\n2019-11-06 07:00:01,669 - O365.connection:_internal_request:619 - INFO - Request parameters: {...job 1 graph json...}\r\n2019-11-06 07:00:01,734 - O365.connection:_internal_request:637 - INFO - New oauth token fetched\r\n2019-11-06 07:00:01,734 - O365.connection:_internal_request:618 - INFO - Requesting (POST) URL: https://graph.microsoft.com/v1.0/users/myemail@myemail.com/sendMail\r\n2019-11-06 07:00:01,735 - O365.connection:_internal_request:619 - INFO - Request parameters: {...job 2 graph json...}\r\n2019-11-06 07:00:24,354 - O365.connection:_internal_request:662 - DEBUG - Server Error: 503 Server Error: Service Unavailable for url: https://graph.microsoft.com/v1.0/users/myemail@myemail.com/sendMail\r\n2019-11-06 07:00:24,582 - O365.connection:_internal_request:662 - DEBUG - Server Error: 503 Server Error: Service Unavailable for url: https://graph.microsoft.com/v1.0/users/myemail@myemail.com/sendMail\r\n```\r\n\r\nI suspect the issue is coming from the first job sending a POST request to send the email while the graph server is still handling the second job's request for a new token. The 503 code on the MS documentation indicates the service is not available OR busy. But I'm not positive. MS server is definitely not down. I wanted to see if you had encountered this or something similar before, and had any suggestions.\r\n\r\nThe easiest solution is to just have the job's run a minute apart. Gives enough time to fetch and read new tokens. Or I thought of maybe using a token file name unique to the job? Currently, I use the same token file for everything.\r\n\r\nAny input would be appreciated. Thanks!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/349", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/349/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/349/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/349/events", "html_url": "https://github.com/O365/python-o365/issues/349", "id": 517951963, "node_id": "MDU6SXNzdWU1MTc5NTE5NjM=", "number": 349, "title": "Working with Calendar instances. AttributeError: 'NoneType' object has no attribute 'name'.", "user": {"login": "isaactorres13", "id": 36905842, "node_id": "MDQ6VXNlcjM2OTA1ODQy", "avatar_url": "https://avatars0.githubusercontent.com/u/36905842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isaactorres13", "html_url": "https://github.com/isaactorres13", "followers_url": "https://api.github.com/users/isaactorres13/followers", "following_url": "https://api.github.com/users/isaactorres13/following{/other_user}", "gists_url": "https://api.github.com/users/isaactorres13/gists{/gist_id}", "starred_url": "https://api.github.com/users/isaactorres13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isaactorres13/subscriptions", "organizations_url": "https://api.github.com/users/isaactorres13/orgs", "repos_url": "https://api.github.com/users/isaactorres13/repos", "events_url": "https://api.github.com/users/isaactorres13/events{/privacy}", "received_events_url": "https://api.github.com/users/isaactorres13/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-11-05T18:30:56Z", "updated_at": "2019-11-07T09:35:21Z", "closed_at": "2019-11-07T09:35:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nI am trying to create an event in another calendar (not the default one, but like the one of \"Birthday\") that I have in my Outlook account, but when replicating the tutorial to implement that type of events, it sends me the error:\r\n\r\ncalendar.name = 'Name_Calendar'\r\nAttributeError: 'NoneType' object has no attribute 'name'.\r\n\r\nCan you help me please? I already have the token stored and the consent permissions of my account, only this time I want to generate events in another calendar that they request. Thank you.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/348", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/348/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/348/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/348/events", "html_url": "https://github.com/O365/python-o365/issues/348", "id": 517440191, "node_id": "MDU6SXNzdWU1MTc0NDAxOTE=", "number": 348, "title": "Calendar functionality returns 400 error", "user": {"login": "JeffChuSBX", "id": 57374701, "node_id": "MDQ6VXNlcjU3Mzc0NzAx", "avatar_url": "https://avatars1.githubusercontent.com/u/57374701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JeffChuSBX", "html_url": "https://github.com/JeffChuSBX", "followers_url": "https://api.github.com/users/JeffChuSBX/followers", "following_url": "https://api.github.com/users/JeffChuSBX/following{/other_user}", "gists_url": "https://api.github.com/users/JeffChuSBX/gists{/gist_id}", "starred_url": "https://api.github.com/users/JeffChuSBX/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JeffChuSBX/subscriptions", "organizations_url": "https://api.github.com/users/JeffChuSBX/orgs", "repos_url": "https://api.github.com/users/JeffChuSBX/repos", "events_url": "https://api.github.com/users/JeffChuSBX/events{/privacy}", "received_events_url": "https://api.github.com/users/JeffChuSBX/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268455, "node_id": "MDU6TGFiZWwxNzgyNjg0NTU=", "url": "https://api.github.com/repos/O365/python-o365/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-11-04T22:26:54Z", "updated_at": "2019-11-04T22:36:32Z", "closed_at": "2019-11-04T22:36:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "Steps to reproduce:\r\n\r\n\r\n```\r\naccount = Account(credentials, auth_flow_type='credentials', tenant_id=dirID)\r\nif account.authenticate():\r\n   print('Authenticated!')\r\n\r\nschedule = account.schedule()\r\ncalendar = schedule.get_default_calendar()\r\n```\r\n\r\nReturns: \r\n`Client Error: 400 Client Error: Bad Request for url: https://graph.microsoft.com/v1.0/calendar | Error Message: Resource not found for the segment 'calendar'.`\r\n\r\nUsing Ms Graph explorer:\r\nThe rest API looks like `https://graph.microsoft.com/v1.0/me/calendars` so the above URL is missing \"me\" resource?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/347", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/347/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/347/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/347/events", "html_url": "https://github.com/O365/python-o365/issues/347", "id": 517213145, "node_id": "MDU6SXNzdWU1MTcyMTMxNDU=", "number": 347, "title": "Don't hardcode Connection class in Account constructor", "user": {"login": "matthewgdv", "id": 37582022, "node_id": "MDQ6VXNlcjM3NTgyMDIy", "avatar_url": "https://avatars1.githubusercontent.com/u/37582022?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewgdv", "html_url": "https://github.com/matthewgdv", "followers_url": "https://api.github.com/users/matthewgdv/followers", "following_url": "https://api.github.com/users/matthewgdv/following{/other_user}", "gists_url": "https://api.github.com/users/matthewgdv/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewgdv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewgdv/subscriptions", "organizations_url": "https://api.github.com/users/matthewgdv/orgs", "repos_url": "https://api.github.com/users/matthewgdv/repos", "events_url": "https://api.github.com/users/matthewgdv/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewgdv/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-04T15:06:45Z", "updated_at": "2019-11-04T20:09:04Z", "closed_at": "2019-11-04T20:09:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hiya, I was wondering if you could have `Account.__init__()` use a class attribute such as `Account.connection_constructor` to construct its `Connection` object, rather than using `Connection` directly. This would be similar to how classes like `Contact` have a `Contact.message_constructor` class attribute.\r\n\r\nThat way, implementing a subclass of `Connection` would be as easy as:\r\n\r\n```\r\nclass MyAmazingConnection(Connection):\r\n    # some code here\r\n\r\nclass MyAmazingAccount(Account):\r\n    connection_constructor = MyAmazingConnection\r\n```\r\n\r\nBecause the `Connection` gets passed around pretty much everywhere in this library it's a super useful class to piggyback off when subclassing, since if you want utility methods or persistent states that are accessible from literally everywhere (like say, a personal HTML signature for use in emails, events, etc.) you can save them in the `Connection` and just access them from the current object's `con` attribute.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/342", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/342/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/342/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/342/events", "html_url": "https://github.com/O365/python-o365/issues/342", "id": 513945770, "node_id": "MDU6SXNzdWU1MTM5NDU3NzA=", "number": 342, "title": "Token Validity", "user": {"login": "TheSanjo", "id": 48837268, "node_id": "MDQ6VXNlcjQ4ODM3MjY4", "avatar_url": "https://avatars3.githubusercontent.com/u/48837268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheSanjo", "html_url": "https://github.com/TheSanjo", "followers_url": "https://api.github.com/users/TheSanjo/followers", "following_url": "https://api.github.com/users/TheSanjo/following{/other_user}", "gists_url": "https://api.github.com/users/TheSanjo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheSanjo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheSanjo/subscriptions", "organizations_url": "https://api.github.com/users/TheSanjo/orgs", "repos_url": "https://api.github.com/users/TheSanjo/repos", "events_url": "https://api.github.com/users/TheSanjo/events{/privacy}", "received_events_url": "https://api.github.com/users/TheSanjo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-10-29T14:09:26Z", "updated_at": "2020-05-20T04:53:03Z", "closed_at": "2019-12-17T10:27:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi there\r\n\r\nI have a working flask site which successfully completes the OAuth authentication and stores the token in a database.  However, it seems to only receive a token for 1 hour.  \r\n\r\nI think my scopes are correct.  See below.  Is there anyway of getting a token that lasts longer?\r\n\r\n```\r\ndef auth_step_1(user):\r\n    # callback = 'my absolute url to auth_step_two_callback'\r\n    callback = config.callbackurl\r\n    protocol = MSGraphProtocol(api_version='beta')  # MSGraphProtocol defaults to v1.0 api version\r\n    account = Account(credentials, protocol=protocol)\r\n    # my_scopes = ['basic', 'message_all', 'calendar']\r\n    # scopes_graph = [protocol.get_scopes_for('basic'), protocol.get_scopes_for('message_all')]\r\n    basicscope = 'https://graph.microsoft.com/offline_access'\r\n    userscope = 'https://graph.microsoft.com/User.Read'\r\n    emailscope1 = 'https://graph.microsoft.com/Mail.Send'\r\n    emailscope2 = 'https://graph.microsoft.com/Mail.ReadWrite'\r\n\r\n    scopes_graph = [basicscope, userscope, emailscope1, emailscope2]\r\n    tokenbackend = SqliteTokenBackend(user_id=user)\r\n    url, state = account.con.get_authorization_url(requested_scopes=scopes_graph,\r\n                                                   redirect_uri=callback,\r\n                                                   token_backend=tokenbackend)\r\n    # Saving the state ...\r\n    Temp.delete().execute()\r\n    Temp.create(username=user, state=state)\r\n\r\n    return url\r\n```\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/341", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/341/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/341/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/341/events", "html_url": "https://github.com/O365/python-o365/issues/341", "id": 513139260, "node_id": "MDU6SXNzdWU1MTMxMzkyNjA=", "number": 341, "title": "Token Naming for multiple Account instances", "user": {"login": "teamoo", "id": 171527, "node_id": "MDQ6VXNlcjE3MTUyNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/171527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/teamoo", "html_url": "https://github.com/teamoo", "followers_url": "https://api.github.com/users/teamoo/followers", "following_url": "https://api.github.com/users/teamoo/following{/other_user}", "gists_url": "https://api.github.com/users/teamoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/teamoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/teamoo/subscriptions", "organizations_url": "https://api.github.com/users/teamoo/orgs", "repos_url": "https://api.github.com/users/teamoo/repos", "events_url": "https://api.github.com/users/teamoo/events{/privacy}", "received_events_url": "https://api.github.com/users/teamoo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-10-28T07:29:22Z", "updated_at": "2019-10-31T18:04:16Z", "closed_at": "2019-10-31T18:03:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I have a situation where different Azure Apps use different `Account` objects. In this case, the `is_authenticated` method does not seem to work correctly. The different `Account` objects cannot distinguish which `Account` is authenticated and which Token belongs to which `Account`. I guess if we changed the naming of the token file to include a ID specific to the client_id (?), it would be possible to differentiate the different `Account` instances.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/340", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/340/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/340/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/340/events", "html_url": "https://github.com/O365/python-o365/issues/340", "id": 512332636, "node_id": "MDU6SXNzdWU1MTIzMzI2MzY=", "number": 340, "title": "after copy operation, the function operation.get_item() produce errors", "user": {"login": "sidkang", "id": 6175895, "node_id": "MDQ6VXNlcjYxNzU4OTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/6175895?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sidkang", "html_url": "https://github.com/sidkang", "followers_url": "https://api.github.com/users/sidkang/followers", "following_url": "https://api.github.com/users/sidkang/following{/other_user}", "gists_url": "https://api.github.com/users/sidkang/gists{/gist_id}", "starred_url": "https://api.github.com/users/sidkang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sidkang/subscriptions", "organizations_url": "https://api.github.com/users/sidkang/orgs", "repos_url": "https://api.github.com/users/sidkang/repos", "events_url": "https://api.github.com/users/sidkang/events{/privacy}", "received_events_url": "https://api.github.com/users/sidkang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-10-25T06:39:48Z", "updated_at": "2019-12-05T12:51:56Z", "closed_at": "2019-12-05T12:51:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "The code is from the document example\r\n```python\r\n# copy a file to the documents special folder\r\n\r\ndocuments_folder = my_drive.get_special_folder('documents')\r\n\r\nfiles = my_drive.search('george best quotes', limit=1)\r\n\r\nif files:\r\n    george_best_quotes = files[0]\r\n    operation = george_best_quotes.copy(target=documents_folder)  # operation here is an instance of CopyOperation\r\n\r\n    # to check for the result just loop over check_status.\r\n    # check_status is a generator that will yield a new status and progress until the file is finally copied\r\n    for status, progress in operation.check_status():  # if it's an async operations, this will request to the api for the status in every loop\r\n        print('{} - {}'.format(status, progress))  # prints 'in progress - 77.3' until finally completed: 'completed - 100.0'\r\n    copied_item = operation.get_item()  # the copy operation is completed so you can get the item.\r\n    if copied_item:\r\n        copied_item.delete()  # ... oops!\r\n```\r\nBelow is the error message\r\n```\r\nClient Error: 404 Client Error: Not Found for url: https://graph.microsoft.com/v1.0/me/drives/*****/items/93aa1d5b-9b55-4c3e-92b4-******* | Error Message: The resource could not be found.\r\n---------------------------------------------------------------------------\r\nHTTPError                                 Traceback (most recent call last)\r\n<ipython-input-33-e75e04569d02> in <module>\r\n---->  copied_item = copy_operation.get_item()\r\n```\r\nThe error produces every time after I copy the original file and want to get the item using the get_item. Some id part of the error url is replaced. Am I misunderstanding the func?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/338", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/338/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/338/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/338/events", "html_url": "https://github.com/O365/python-o365/issues/338", "id": 511459435, "node_id": "MDU6SXNzdWU1MTE0NTk0MzU=", "number": 338, "title": "[Question] Able to just pull attachment names w/o download?", "user": {"login": "lia-cha-avalara", "id": 54375621, "node_id": "MDQ6VXNlcjU0Mzc1NjIx", "avatar_url": "https://avatars1.githubusercontent.com/u/54375621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lia-cha-avalara", "html_url": "https://github.com/lia-cha-avalara", "followers_url": "https://api.github.com/users/lia-cha-avalara/followers", "following_url": "https://api.github.com/users/lia-cha-avalara/following{/other_user}", "gists_url": "https://api.github.com/users/lia-cha-avalara/gists{/gist_id}", "starred_url": "https://api.github.com/users/lia-cha-avalara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lia-cha-avalara/subscriptions", "organizations_url": "https://api.github.com/users/lia-cha-avalara/orgs", "repos_url": "https://api.github.com/users/lia-cha-avalara/repos", "events_url": "https://api.github.com/users/lia-cha-avalara/events{/privacy}", "received_events_url": "https://api.github.com/users/lia-cha-avalara/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 198099888, "node_id": "MDU6TGFiZWwxOTgwOTk4ODg=", "url": "https://api.github.com/repos/O365/python-o365/labels/Feature%20Request", "name": "Feature Request", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-10-23T17:10:35Z", "updated_at": "2019-10-24T01:35:11Z", "closed_at": "2019-10-24T01:35:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "I did some testing and it looks like I'm only able to retrieve the attachment names when i use the download_attachments=True parameter (which makes sense). The problem I see with this is script execution time when there's massive amounts of emails with attachments.\r\n\r\nI've been testing this module to pull a report from shared mailboxes and it's been working great but found that on an inbox with 2300 emails, it took roughly 17mins to complete. We have others that have 15-17k emails in there and I'm just curious if there's a way to speed this up.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/336", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/336/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/336/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/336/events", "html_url": "https://github.com/O365/python-o365/issues/336", "id": 510119781, "node_id": "MDU6SXNzdWU1MTAxMTk3ODE=", "number": 336, "title": "Timeout Settings", "user": {"login": "hcallen", "id": 15605103, "node_id": "MDQ6VXNlcjE1NjA1MTAz", "avatar_url": "https://avatars2.githubusercontent.com/u/15605103?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hcallen", "html_url": "https://github.com/hcallen", "followers_url": "https://api.github.com/users/hcallen/followers", "following_url": "https://api.github.com/users/hcallen/following{/other_user}", "gists_url": "https://api.github.com/users/hcallen/gists{/gist_id}", "starred_url": "https://api.github.com/users/hcallen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hcallen/subscriptions", "organizations_url": "https://api.github.com/users/hcallen/orgs", "repos_url": "https://api.github.com/users/hcallen/repos", "events_url": "https://api.github.com/users/hcallen/events{/privacy}", "received_events_url": "https://api.github.com/users/hcallen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 198099888, "node_id": "MDU6TGFiZWwxOTgwOTk4ODg=", "url": "https://api.github.com/repos/O365/python-o365/labels/Feature%20Request", "name": "Feature Request", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-21T16:57:44Z", "updated_at": "2019-10-21T22:44:45Z", "closed_at": "2019-10-21T22:44:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello,\r\n\r\nI was wondering if there was an easy way to set a connection/query timeout. I have a script that polls a mailbox every 10 secs. It will work great for ~2 weeks, then unexpectedly hang when attempting to connect.\r\n\r\nI poked around a bit and didn't see a straight forward way to implement a timeout. I want to check if there is something I'm missing before I dug deeper.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/335", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/335/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/335/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/335/events", "html_url": "https://github.com/O365/python-o365/issues/335", "id": 509296844, "node_id": "MDU6SXNzdWU1MDkyOTY4NDQ=", "number": 335, "title": "[Question] Are we able to pull total number of emails in specific folder?", "user": {"login": "lia-cha-avalara", "id": 54375621, "node_id": "MDQ6VXNlcjU0Mzc1NjIx", "avatar_url": "https://avatars1.githubusercontent.com/u/54375621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lia-cha-avalara", "html_url": "https://github.com/lia-cha-avalara", "followers_url": "https://api.github.com/users/lia-cha-avalara/followers", "following_url": "https://api.github.com/users/lia-cha-avalara/following{/other_user}", "gists_url": "https://api.github.com/users/lia-cha-avalara/gists{/gist_id}", "starred_url": "https://api.github.com/users/lia-cha-avalara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lia-cha-avalara/subscriptions", "organizations_url": "https://api.github.com/users/lia-cha-avalara/orgs", "repos_url": "https://api.github.com/users/lia-cha-avalara/repos", "events_url": "https://api.github.com/users/lia-cha-avalara/events{/privacy}", "received_events_url": "https://api.github.com/users/lia-cha-avalara/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268455, "node_id": "MDU6TGFiZWwxNzgyNjg0NTU=", "url": "https://api.github.com/repos/O365/python-o365/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-18T20:32:08Z", "updated_at": "2019-10-23T17:06:24Z", "closed_at": "2019-10-23T17:06:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "When i run something like...\r\n\r\ninbox = mailbox.inbox_folder()\r\ntotal_emails = inbox.total_items_count\r\n\r\nthis returns the default value of 0. If i try to dig in deeper by using the get_messages() method, that returns a paginator obj which I can't just call len() on. I feel like writing a message property into a list and calling len() on that would just add more work. Am I just missing something simple?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/334", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/334/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/334/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/334/events", "html_url": "https://github.com/O365/python-o365/issues/334", "id": 508736461, "node_id": "MDU6SXNzdWU1MDg3MzY0NjE=", "number": 334, "title": "[Question] how do i pull the attachment name?", "user": {"login": "lia-cha-avalara", "id": 54375621, "node_id": "MDQ6VXNlcjU0Mzc1NjIx", "avatar_url": "https://avatars1.githubusercontent.com/u/54375621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lia-cha-avalara", "html_url": "https://github.com/lia-cha-avalara", "followers_url": "https://api.github.com/users/lia-cha-avalara/followers", "following_url": "https://api.github.com/users/lia-cha-avalara/following{/other_user}", "gists_url": "https://api.github.com/users/lia-cha-avalara/gists{/gist_id}", "starred_url": "https://api.github.com/users/lia-cha-avalara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lia-cha-avalara/subscriptions", "organizations_url": "https://api.github.com/users/lia-cha-avalara/orgs", "repos_url": "https://api.github.com/users/lia-cha-avalara/repos", "events_url": "https://api.github.com/users/lia-cha-avalara/events{/privacy}", "received_events_url": "https://api.github.com/users/lia-cha-avalara/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268455, "node_id": "MDU6TGFiZWwxNzgyNjg0NTU=", "url": "https://api.github.com/repos/O365/python-o365/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-17T21:44:21Z", "updated_at": "2019-10-18T07:58:15Z", "closed_at": "2019-10-18T07:58:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have something like this:\r\n\r\nprotocol = MSGraphProtocol(api_version='beta')\r\naccount = Account(credentials, protocol=protocol, auth_flow_type='credentials', tenant_id=tenant_id)\r\nmailbox = account.mailbox(resource='john.doe@mail.com')\r\ninbox = mailbox.inbox_folder()\r\nmessages = inbox.get_messages(limit=50, download_attachments=True)\r\nfor message in messages:\r\n    if message.has_attachments:\r\n        print(#print attachment name here)\r\n\r\nI'm not exactly sure how to access the name attribute or whatever attribute will pull the name. Inspecting the object it looks like there is a name attribute from the BaseAttachments class but if i try something like message.attachments.name it always tells me that attribute doesn't exist. \r\n\r\nTried looking through the source code but I can't figure it out. Any tips?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/332", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/332/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/332/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/332/events", "html_url": "https://github.com/O365/python-o365/issues/332", "id": 507927677, "node_id": "MDU6SXNzdWU1MDc5Mjc2Nzc=", "number": 332, "title": "get_message throws error with default parameters", "user": {"login": "NielsDebrier", "id": 25689518, "node_id": "MDQ6VXNlcjI1Njg5NTE4", "avatar_url": "https://avatars2.githubusercontent.com/u/25689518?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NielsDebrier", "html_url": "https://github.com/NielsDebrier", "followers_url": "https://api.github.com/users/NielsDebrier/followers", "following_url": "https://api.github.com/users/NielsDebrier/following{/other_user}", "gists_url": "https://api.github.com/users/NielsDebrier/gists{/gist_id}", "starred_url": "https://api.github.com/users/NielsDebrier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NielsDebrier/subscriptions", "organizations_url": "https://api.github.com/users/NielsDebrier/orgs", "repos_url": "https://api.github.com/users/NielsDebrier/repos", "events_url": "https://api.github.com/users/NielsDebrier/events{/privacy}", "received_events_url": "https://api.github.com/users/NielsDebrier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268450, "node_id": "MDU6TGFiZWwxNzgyNjg0NTA=", "url": "https://api.github.com/repos/O365/python-o365/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-16T15:28:42Z", "updated_at": "2019-10-16T16:09:50Z", "closed_at": "2019-10-16T16:09:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello,\r\n\r\nWhile using this library we came a cross the following bug.\r\n\r\nWhen using the method get_message from mailbox.py we get an error: 'NoneType' object has no attribute 'has_expands' when giving a valid object_id and leaving the rest on their default parameters.\r\n\r\nWhen expecting the code I encountered the bug on line: https://github.com/O365/python-o365/blob/master/O365/mailbox.py#L151\r\nIt seems that there are missing parentheses here.\r\nI think it should be: `query and (query.has_selects or query.has_expands):`\r\n\r\nThis is what happens:\r\nfirst it evaluates `query and query.has_selects` this returns False because query is None (default). Next it tries to evaluate `False or query.has_expands` but has expands doesn't exist on None. So it throws an error.\r\n\r\nif I have time I will try to make a pull request and link it here.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/331", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/331/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/331/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/331/events", "html_url": "https://github.com/O365/python-o365/issues/331", "id": 507203049, "node_id": "MDU6SXNzdWU1MDcyMDMwNDk=", "number": 331, "title": "Buggy behaviour in Query.get_order() causing errors", "user": {"login": "matthewgdv", "id": 37582022, "node_id": "MDQ6VXNlcjM3NTgyMDIy", "avatar_url": "https://avatars1.githubusercontent.com/u/37582022?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewgdv", "html_url": "https://github.com/matthewgdv", "followers_url": "https://api.github.com/users/matthewgdv/followers", "following_url": "https://api.github.com/users/matthewgdv/following{/other_user}", "gists_url": "https://api.github.com/users/matthewgdv/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewgdv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewgdv/subscriptions", "organizations_url": "https://api.github.com/users/matthewgdv/orgs", "repos_url": "https://api.github.com/users/matthewgdv/repos", "events_url": "https://api.github.com/users/matthewgdv/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewgdv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268450, "node_id": "MDU6TGFiZWwxNzgyNjg0NTA=", "url": "https://api.github.com/repos/O365/python-o365/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-15T12:11:07Z", "updated_at": "2019-10-16T16:38:46Z", "closed_at": "2019-10-16T16:38:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi there.\r\n\r\nSo first off, I'd like to drop this link here which explains how 'order_by' in the current version of the Outlook REST API is basically a trainwreck full of insane arbitrary rules. A hot mess. Just awful.\r\n\r\nhttps://developer.microsoft.com/en-us/office/blogs/update-to-filtering-and-sorting-rest-api/\r\n\r\nThe way I see it as a maintainer for this library that leaves you with 2 options:\r\n1) The user is on their own navigating this, and you don't attempt to sanitize their queries so that they meet the criteria discussed in the link above\r\n2) You attempt to abstract all this away and where possible do clever things to alter the queries (changing the ordering, adding in filters that are always true, etc.) so that they actually do work, even though they shouldn't.\r\n\r\nFrom what I can see based on the comments and code in the Query.get_order() method you've actually attempted to do a little bit of option 2. Particularly the first comment which states: 'first get the filtered attributes in order as they must appear in the order_by first'.\r\n\r\nHowever, the way this is handled currently is wrong. I'll give an example to explain\r\n\r\nStarting with this query:\r\n\r\n```\r\nquery = mailbox.new_query()\r\nquery.on_attribute(\"receivedDateTime\").greater(datetime.datetime(1990, 1, 1)).chain(\"and\").on_attribute(\"isRead\").equals(False)\r\n```\r\n\r\nIf you then chain an Query.order_by():\r\n\r\n```\r\nquery.order_by(\"receivedDateTime\", ascending=False)\r\n```\r\n\r\nThe repr then looks like:\r\n\r\n```\r\nFilter: receivedDateTime gt 1990-01-01T00:00:00+00:00 and isRead eq false\r\nOrder: receivedDateTime desc,isRead\r\nSelect: None\r\nExpand: None\r\nSearch: None\r\n```\r\n\r\nNotice the isRead that has worked its way into the order_by clause. This query will fail if you do:\r\n\r\n```\r\ninbox.get_messages(query=query)\r\n```\r\n\r\nbecause you cannot order by 'isRead'.\r\n\r\nHowever, if you don't chain the Query.order_by() method (if you only execute the first block of code), and then simply use the 'order_by' argument of Folder.get_messages(), like so:\r\n\r\n```\r\ninbox.get_messages(query=query, order_by=\"receivedDateTime desc\")\r\n```\r\n\r\nIt actually does work! I'm assuming that this is because this bypasses the Query.get_order() method completely.\r\n\r\nBasically, I'm highlighting a situation where the under-the-hood processing which the library is trying to do in order to be helpful is actually taking a valid query and breaking it.\r\n\r\nTrying to fully implement implement option 2 above will probably be very complex and tricky. It should theoretically be possible, but that is probably beyond the scope of this issue. That's something to maybe look at as a possible enhancement. However, at the very least it would be good if this particular bug gets resolved as a first step.\r\n\r\nTo reiterate, the reason for this bug is because the library is trying to include every attribute referenced in the filter clause into the order_by clause, despite the fact that the REST API doesn't actually require this at all! It only requires it the other way around (every element in the order_by clause must appear in the filter clause).\r\n\r\nThanks so much for all the awesome work on this library. You guys have been so good about continuing to add features and responding to issues. I'm really grateful.\r\n\r\nCheers.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/330", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/330/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/330/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/330/events", "html_url": "https://github.com/O365/python-o365/issues/330", "id": 506025558, "node_id": "MDU6SXNzdWU1MDYwMjU1NTg=", "number": 330, "title": "client credentials auth flow authentication problem", "user": {"login": "davidlpotter59", "id": 20128192, "node_id": "MDQ6VXNlcjIwMTI4MTky", "avatar_url": "https://avatars2.githubusercontent.com/u/20128192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidlpotter59", "html_url": "https://github.com/davidlpotter59", "followers_url": "https://api.github.com/users/davidlpotter59/followers", "following_url": "https://api.github.com/users/davidlpotter59/following{/other_user}", "gists_url": "https://api.github.com/users/davidlpotter59/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidlpotter59/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidlpotter59/subscriptions", "organizations_url": "https://api.github.com/users/davidlpotter59/orgs", "repos_url": "https://api.github.com/users/davidlpotter59/repos", "events_url": "https://api.github.com/users/davidlpotter59/events{/privacy}", "received_events_url": "https://api.github.com/users/davidlpotter59/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-10-11T19:39:40Z", "updated_at": "2019-11-21T16:38:47Z", "closed_at": "2019-11-21T16:38:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am having issues with the 0365 module. I authenticate perfectly. The errors comes into play at the account objects.\r\n\r\nThe message I get is: Client Error: 400 Client Error: Bad Request for url: https://graph.microsoft.com/v1.0/sendMail | Error Message: Resource not found for the segment 'sendMail'.\r\nTraceback (most recent call last):\r\nFile \"mail5.py\", line 18, in\r\nmessage.send()\r\nFile \"/home/davep/.local/share/virtualenvs/completed-88qwCt9r/lib/python3.7/site-packages/O365/message.py\", line 654, in send\r\nresponse = self.con.post(url, data=data)\r\nFile \"/home/davep/.local/share/virtualenvs/completed-88qwCt9r/lib/python3.7/site-packages/O365/connection.py\", line 718, in post\r\nreturn self.oauth_request(url, 'post', data=data, **kwargs)\r\nFile \"/home/davep/.local/share/virtualenvs/completed-88qwCt9r/lib/python3.7/site-packages/O365/connection.py\", line 696, in oauth_request\r\nreturn self._internal_request(self.session, url, method, **kwargs)\r\nFile \"/home/davep/.local/share/virtualenvs/completed-88qwCt9r/lib/python3.7/site-packages/O365/connection.py\", line 658, in _internal_request\r\nraise HTTPError('{} | Error Message: {}'.format(e.args[0], error_message), response=response) from None\r\nrequests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://graph.microsoft.com/v1.0/sendMail | Error Message: Resource not found for the segment 'sendMail'.\r\n\r\nCode is:\r\nfrom O365 import Account\r\n\r\ncredentials = ('ID', 'secret')\r\n\r\naccount = Account(credentials, auth_flow_type='credentials')\r\nif account.authenticate():\r\n    print('Authenticated!') # this prints\r\n\r\n# note no errors if the following lines are commented out.\r\nmailbox = account.mailbox()\r\nmessage = mailbox.new_message()\r\nmessage.subject = 'Hello Test'\r\nmessage.to.add(['user@somedomain.com'])\r\nmessage.body = \"You have documents\"\r\nmessage.send()\r\n\r\nThank you for anyone that can help me.\r\nVersions: python 3.6.8, O365 2.0.3", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/329", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/329/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/329/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/329/events", "html_url": "https://github.com/O365/python-o365/issues/329", "id": 504858848, "node_id": "MDU6SXNzdWU1MDQ4NTg4NDg=", "number": 329, "title": "How to query another users calendar - check if they are free on MM/DD/YYYY", "user": {"login": "coltenkrauter", "id": 18080897, "node_id": "MDQ6VXNlcjE4MDgwODk3", "avatar_url": "https://avatars1.githubusercontent.com/u/18080897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/coltenkrauter", "html_url": "https://github.com/coltenkrauter", "followers_url": "https://api.github.com/users/coltenkrauter/followers", "following_url": "https://api.github.com/users/coltenkrauter/following{/other_user}", "gists_url": "https://api.github.com/users/coltenkrauter/gists{/gist_id}", "starred_url": "https://api.github.com/users/coltenkrauter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/coltenkrauter/subscriptions", "organizations_url": "https://api.github.com/users/coltenkrauter/orgs", "repos_url": "https://api.github.com/users/coltenkrauter/repos", "events_url": "https://api.github.com/users/coltenkrauter/events{/privacy}", "received_events_url": "https://api.github.com/users/coltenkrauter/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 198099888, "node_id": "MDU6TGFiZWwxOTgwOTk4ODg=", "url": "https://api.github.com/repos/O365/python-o365/labels/Feature%20Request", "name": "Feature Request", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-09T19:53:08Z", "updated_at": "2019-10-11T12:52:25Z", "closed_at": "2019-10-11T12:52:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is there a way to check what a user is up to on a given day? Or a way to find out when a user is free on a given day?\r\n\r\nUse case: I want to be able to programatically check to see if a user is free before inviting them to a meeting event.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/328", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/328/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/328/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/328/events", "html_url": "https://github.com/O365/python-o365/issues/328", "id": 504134541, "node_id": "MDU6SXNzdWU1MDQxMzQ1NDE=", "number": 328, "title": "BeautifulSoap error: soup.body.insert(0, bs(value, 'html.parser'))", "user": {"login": "rena2damas", "id": 16232513, "node_id": "MDQ6VXNlcjE2MjMyNTEz", "avatar_url": "https://avatars3.githubusercontent.com/u/16232513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rena2damas", "html_url": "https://github.com/rena2damas", "followers_url": "https://api.github.com/users/rena2damas/followers", "following_url": "https://api.github.com/users/rena2damas/following{/other_user}", "gists_url": "https://api.github.com/users/rena2damas/gists{/gist_id}", "starred_url": "https://api.github.com/users/rena2damas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rena2damas/subscriptions", "organizations_url": "https://api.github.com/users/rena2damas/orgs", "repos_url": "https://api.github.com/users/rena2damas/repos", "events_url": "https://api.github.com/users/rena2damas/events{/privacy}", "received_events_url": "https://api.github.com/users/rena2damas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268450, "node_id": "MDU6TGFiZWwxNzgyNjg0NTA=", "url": "https://api.github.com/repos/O365/python-o365/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-08T16:00:40Z", "updated_at": "2019-10-10T14:36:07Z", "closed_at": "2019-10-10T14:36:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am getting error on body.setter of message. See the following code:\r\n\r\n```python\r\nmessage = some_message.reply(to_all=True)\r\nmessage.body = 'Other body to text'\r\n```\r\n\r\nThis results in:\r\n```\r\n   ... \r\n   soup.body.insert(0, bs(value, 'html.parser'))\r\nAttributeError: 'NoneType' object has no attribute 'insert'\r\n```\r\n\r\nThe responsible code is this:\r\n```python\r\nfrom bs4 import BeautifulSoup as bs\r\n...\r\nsoup = bs(self.__body, 'html.parser')\r\nsoup.body.insert(0, bs(value, 'html.parser'))\r\n```\r\n\r\nIt looks like the ```soup``` object does not contain a body. Which is true. The message body does not come in html format all the time. Therefore the code does not take into consideration when ```body_type``` comes in different formats. I believe it should look something like this:\r\n\r\n```python\r\n@body.setter\r\ndef body(self, value):\r\n    if self.__body:\r\n        if not value:\r\n            self.__body = ''\r\n        elif self.body_type == 'html':\r\n            soup = bs(self.__body, 'html.parser')\r\n            soup.body.insert(0, bs(value, 'html.parser'))\r\n            self.__body = str(soup)\r\n        elif self.body_type == 'text':\r\n            self.__body = ''.join((value,'\\n',self.__body))\r\n        elif self.body_type == ...:\r\n            ...\r\n    else:\r\n        self.__body = value\r\n    self._track_changes.add('body')\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/327", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/327/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/327/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/327/events", "html_url": "https://github.com/O365/python-o365/issues/327", "id": 503135768, "node_id": "MDU6SXNzdWU1MDMxMzU3Njg=", "number": 327, "title": "Question on filtering events", "user": {"login": "NathanTech7713", "id": 29704261, "node_id": "MDQ6VXNlcjI5NzA0MjYx", "avatar_url": "https://avatars1.githubusercontent.com/u/29704261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NathanTech7713", "html_url": "https://github.com/NathanTech7713", "followers_url": "https://api.github.com/users/NathanTech7713/followers", "following_url": "https://api.github.com/users/NathanTech7713/following{/other_user}", "gists_url": "https://api.github.com/users/NathanTech7713/gists{/gist_id}", "starred_url": "https://api.github.com/users/NathanTech7713/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NathanTech7713/subscriptions", "organizations_url": "https://api.github.com/users/NathanTech7713/orgs", "repos_url": "https://api.github.com/users/NathanTech7713/repos", "events_url": "https://api.github.com/users/NathanTech7713/events{/privacy}", "received_events_url": "https://api.github.com/users/NathanTech7713/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-06T17:52:52Z", "updated_at": "2019-11-11T15:20:19Z", "closed_at": "2019-11-11T15:20:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I wondered if someone could help me.\r\nI'm trying to filter events, like so:\r\n1. get the master list of events, (already done that)\r\n2. Now, get only events that have been modified since x date.\r\nAny help greatly appreciated.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/326", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/326/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/326/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/326/events", "html_url": "https://github.com/O365/python-o365/issues/326", "id": 503048603, "node_id": "MDU6SXNzdWU1MDMwNDg2MDM=", "number": 326, "title": "error \"The access token has expire\" when upload large file", "user": {"login": "mengyyy", "id": 10589755, "node_id": "MDQ6VXNlcjEwNTg5NzU1", "avatar_url": "https://avatars1.githubusercontent.com/u/10589755?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mengyyy", "html_url": "https://github.com/mengyyy", "followers_url": "https://api.github.com/users/mengyyy/followers", "following_url": "https://api.github.com/users/mengyyy/following{/other_user}", "gists_url": "https://api.github.com/users/mengyyy/gists{/gist_id}", "starred_url": "https://api.github.com/users/mengyyy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mengyyy/subscriptions", "organizations_url": "https://api.github.com/users/mengyyy/orgs", "repos_url": "https://api.github.com/users/mengyyy/repos", "events_url": "https://api.github.com/users/mengyyy/events{/privacy}", "received_events_url": "https://api.github.com/users/mengyyy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-06T03:58:51Z", "updated_at": "2019-10-13T07:25:01Z", "closed_at": "2019-10-13T07:25:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello:\r\n       When i upload a large file which is about 44 GB to onedrive with a  slow network (400KB/S),  I get an error message  \r\n\r\n**The access token has expired. It's valid from '10/5/2019 2:27:34 AM' and to '10/6/2019 2:27:34 AM'**\r\n\r\nCould i use multiprocess to refresh token when upload large file?\r\nHere is detail and env:\r\n```\r\n2019-10-06 10:32:51.962 | ERROR    | mengy_O365:upload_file:189 - File mengy_O365.py, line 183, in upload_file\r\n    179  def upload_file(self, file_path, remote_dir, timeout=60):\r\n    180      try:\r\n    181          self.account.connection.refresh_token()\r\n    182          parent_item = self._get_or_create_floder_item(remote_dir, timeout)\r\n--> 183          file_item = parent_item.upload_file(file_path)\r\n    184          share_url = file_item.share_with_link()\r\n    ..................................................\r\n     self = <mengy_O365.MengyO365 object at 0x7f3f93314e10>\r\n     file_path = 'DD.iso'\r\n     remote_dir = '/'\r\n     timeout = 60\r\n     self.account.connection.refresh_token = <method 'Connection.refresh_token' of <O365.connection.Conne\r\n                                              ction object at 0x7f3f89f743d0> connection.py:528>\r\n     parent_item = Folder: root\r\n     self._get_or_create_floder_item = <method 'MengyO365._get_or_create_floder_item' of <mengy_O36\r\n                                        5.MengyO365 object at 0x7f3f93314e10> mengy_O365.py:164>\r\n     parent_item.upload_file = <method 'Folder.upload_file' of Folder: root drive.py:1147>\r\n    ..................................................\r\n\r\nFile /usr/local/lib/python3.7/dist-packages/O365/drive.py, line 1228, in upload_file\r\n    1147  def upload_file(self, item, chunk_size=DEFAULT_UPLOAD_CHUNK_SIZE):\r\n (...)\r\n    1224                  # this request mut NOT send the authorization header.\r\n    1225                  # so we use a naive simple request.\r\n    1226                  response = self.con.naive_request(upload_url, 'PUT',\r\n    1227                                                    data=data,\r\n--> 1228                                                    headers=headers)\r\n    1229                  if not response:\r\n    ..................................................\r\n     self = Folder: root\r\n     item = PosixPath('/DD.iso')\r\n     chunk_size = 5242880\r\n     DEFAULT_UPLOAD_CHUNK_SIZE = 5242880\r\n     response = <Response [202]>\r\n     self.con.naive_request = <method 'Connection.naive_request' of <O365.connection.Conne\r\n                               ction object at 0x7f3f89f743d0> connection.py:668>\r\n     upload_url = \"https://.../_api/v2.0/drive/items/01RENHTTF6Y2GOVW7725BZO354P\r\n                   WSELRRZ/uploadSession?guid='1426b3b3-3ddc-4376-80a1-871438e6\r\n                   196b'&path='~tmp12_DD.iso'&overwrite=True&re\r\n                   name=False&dc=0&tempauth=...\r\n     data = b'\\x12...\r\n     headers = {'Content-type': 'application/octet-stream',\r\n                'Content-Length': '5242880',\r\n                'Content-Range': 'bytes 28453109760-28458352639/44654198784\r\n                '}\r\n    ..................................................\r\n\r\nFile /usr/local/lib/python3.7/dist-packages/O365/connection.py, line 681, in naive_request\r\n    668  def naive_request(self, url, method, **kwargs):\r\n (...)\r\n    677      \"\"\"\r\n    678      if self.naive_session is None:\r\n    679          # lazy creation of a naive session\r\n    680          self.naive_session = self.get_naive_session()\r\n--> 681      return self._internal_request(self.naive_session, url, method, **kwargs)\r\n    ..................................................\r\n     self = <O365.connection.Connection object at 0x7f3f89f743d0>\r\n     url = \"https://.../_api/v2.0/drive/items/01RENHTTF6Y2GOVW7725BZO354P\r\n            WSELRRZ/uploadSession?guid='1426b3b3-3ddc-4376-80a1-871438e6\r\n            196b'&path='~tmp12_DD.iso'&overwrite=True&re\r\n            name=False&dc=0&tempauth=...\r\n     method = 'PUT'\r\n     kwargs = {'data': b'\\x12...\r\n     self.naive_session = <requests.sessions.Session object at 0x7f3f8c82d610>\r\n     self.get_naive_session = <method 'Connection.get_naive_session' of <O365.connection.C\r\n                               onnection object at 0x7f3f89f743d0> connection.py:512>\r\n     self._internal_request = <method 'Connection._internal_request' of <O365.connection.C\r\n                               onnection object at 0x7f3f89f743d0> connection.py:579>\r\n    ..................................................\r\n\r\nFile /usr/local/lib/python3.7/dist-packages/O365/connection.py, line 658, in _internal_request\r\n    579  def _internal_request(self, request_obj, url, method, **kwargs):\r\n (...)\r\n    654                  # Server Error\r\n    655                  log.debug('Server Error: {}'.format(str(e)))\r\n    656              if self.raise_http_errors:\r\n    657                  if error_message:\r\n--> 658                      raise HTTPError('{} | Error Message: {}'.format(e.args[0], error_message), response=response) from None\r\n    659                  else:\r\n    ..................................................\r\n     self = <O365.connection.Connection object at 0x7f3f89f743d0>\r\n     request_obj = <requests.sessions.Session object at 0x7f3f8c82d610>\r\n     url = \"https://.../_api/v2.0/drive/items/01RENHTTF6Y2GOVW7725BZO354P\r\n            WSELRRZ/uploadSession?guid='1426b3b3-3ddc-4376-80a1-871438e6\r\n            196b'&path='~tmp12_DD.iso'&overwrite=True&re\r\n            name=False&dc=0&tempauth=..\r\n     method = 'put'\r\n     kwargs = {'data': b'\\x12\\...\r\n     log.debug = <method 'Logger.debug' of <Logger O365.connection (WARNING)>\r\n                   __init__.py:1356>\r\n     self.raise_http_errors = True\r\n     error_message = \"The access token has expired. It's valid from '10/5/2019 2:\r\n                      27:34 AM' and to '10/6/2019 2:27:34 AM'.\"\r\n     HTTPError = <class 'requests.exceptions.HTTPError'>\r\n     response = <Response [401]>\r\n    ..................................................\r\n\r\n---- (full traceback above) ----\r\nFile /root/acg_sync_alchemy/mengy_O365.py, line 183, in upload_file\r\n    file_item = parent_item.upload_file(file_path)\r\nFile /usr/local/lib/python3.7/dist-packages/O365/drive.py, line 1228, in upload_file\r\n    headers=headers)\r\nFile /usr/local/lib/python3.7/dist-packages/O365/connection.py, line 681, in naive_request\r\n    return self._internal_request(self.naive_session, url, method, **kwargs)\r\nFile /usr/local/lib/python3.7/dist-packages/O365/connection.py, line 658, in _internal_request\r\n    raise HTTPError('{} | Error Message: {}'.format(e.args[0], error_message), response=response) from None\r\n\r\nHTTPError: 401 Client Error: Unauthorized for url: https://.../_api/v2.0/drive/items/01RENHTTF6Y2GOVW7725BZO354PWSELRRZ/uploadSession?guid='1426b3b3-3ddc-4376-80a1-871438e6196b'&path='~tmp12_DD.iso'&overwrite=True&rename=False&dc=0&tempauth=... | Error Message: The access token has expired. It's valid from '10/5/2019 2:27:34 AM' and to '10/6/2019 2:27:34 AM'.\r\n ```\r\n\r\nUbuntu 16.04 x64\r\nPython 3.7.4\r\nO365==2.0.3\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/325", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/325/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/325/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/325/events", "html_url": "https://github.com/O365/python-o365/issues/325", "id": 502635272, "node_id": "MDU6SXNzdWU1MDI2MzUyNzI=", "number": 325, "title": "Reading 'UniqueBody' field", "user": {"login": "rena2damas", "id": 16232513, "node_id": "MDQ6VXNlcjE2MjMyNTEz", "avatar_url": "https://avatars3.githubusercontent.com/u/16232513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rena2damas", "html_url": "https://github.com/rena2damas", "followers_url": "https://api.github.com/users/rena2damas/followers", "following_url": "https://api.github.com/users/rena2damas/following{/other_user}", "gists_url": "https://api.github.com/users/rena2damas/gists{/gist_id}", "starred_url": "https://api.github.com/users/rena2damas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rena2damas/subscriptions", "organizations_url": "https://api.github.com/users/rena2damas/orgs", "repos_url": "https://api.github.com/users/rena2damas/repos", "events_url": "https://api.github.com/users/rena2damas/events{/privacy}", "received_events_url": "https://api.github.com/users/rena2damas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 198099888, "node_id": "MDU6TGFiZWwxOTgwOTk4ODg=", "url": "https://api.github.com/repos/O365/python-o365/labels/Feature%20Request", "name": "Feature Request", "color": "f7c6c7", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-10-04T13:24:13Z", "updated_at": "2019-11-08T14:04:51Z", "closed_at": "2019-10-04T14:29:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "How can I read the 'UniqueBody' property of the message?\r\nLet's say I get a certain message ```message = folder.get_message(query=Query(...).select('UniqueBody'))```. How do access ```UniqueBody``` of ```message```? All I have is the ```body``` attribute which is not exactly what I want.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/324", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/324/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/324/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/324/events", "html_url": "https://github.com/O365/python-o365/issues/324", "id": 502562938, "node_id": "MDU6SXNzdWU1MDI1NjI5Mzg=", "number": 324, "title": "Can't find a way to identify the user", "user": {"login": "grahamoptibrium", "id": 54676881, "node_id": "MDQ6VXNlcjU0Njc2ODgx", "avatar_url": "https://avatars1.githubusercontent.com/u/54676881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grahamoptibrium", "html_url": "https://github.com/grahamoptibrium", "followers_url": "https://api.github.com/users/grahamoptibrium/followers", "following_url": "https://api.github.com/users/grahamoptibrium/following{/other_user}", "gists_url": "https://api.github.com/users/grahamoptibrium/gists{/gist_id}", "starred_url": "https://api.github.com/users/grahamoptibrium/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grahamoptibrium/subscriptions", "organizations_url": "https://api.github.com/users/grahamoptibrium/orgs", "repos_url": "https://api.github.com/users/grahamoptibrium/repos", "events_url": "https://api.github.com/users/grahamoptibrium/events{/privacy}", "received_events_url": "https://api.github.com/users/grahamoptibrium/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 198099888, "node_id": "MDU6TGFiZWwxOTgwOTk4ODg=", "url": "https://api.github.com/repos/O365/python-o365/labels/Feature%20Request", "name": "Feature Request", "color": "f7c6c7", "default": false, "description": null}, {"id": 178268451, "node_id": "MDU6TGFiZWwxNzgyNjg0NTE=", "url": "https://api.github.com/repos/O365/python-o365/labels/duplicate", "name": "duplicate", "color": "cccccc", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-10-04T10:40:23Z", "updated_at": "2019-10-23T23:43:30Z", "closed_at": "2019-10-23T23:43:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have two use-cases:\r\n- Allow a user to log in to our private application with their 365 credentials \r\n- Send automated emails on behalf of the user\r\n\r\nI would like to use the same library for both.\r\n\r\nCurrently I can authenticate a user successfully by sending them off to microsoftonline, but then can't seem to identify that user from the account object, which makes it useless for both use-cases.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/323", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/323/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/323/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/323/events", "html_url": "https://github.com/O365/python-o365/issues/323", "id": 501092302, "node_id": "MDU6SXNzdWU1MDEwOTIzMDI=", "number": 323, "title": "Refreshed Token doesn't work", "user": {"login": "seevoid", "id": 17503183, "node_id": "MDQ6VXNlcjE3NTAzMTgz", "avatar_url": "https://avatars2.githubusercontent.com/u/17503183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seevoid", "html_url": "https://github.com/seevoid", "followers_url": "https://api.github.com/users/seevoid/followers", "following_url": "https://api.github.com/users/seevoid/following{/other_user}", "gists_url": "https://api.github.com/users/seevoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/seevoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seevoid/subscriptions", "organizations_url": "https://api.github.com/users/seevoid/orgs", "repos_url": "https://api.github.com/users/seevoid/repos", "events_url": "https://api.github.com/users/seevoid/events{/privacy}", "received_events_url": "https://api.github.com/users/seevoid/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-10-01T19:14:18Z", "updated_at": "2019-10-02T14:25:51Z", "closed_at": "2019-10-02T14:25:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI have an issue with the refreshed token. \r\n\r\nExplanations :\r\n\r\nMy app is on my dedicated server, run with wsgi and is served by nginx through my domain name. In my app.py I log to O365 like this : \r\n`token_backend = FileSystemTokenBackend(token_path='./', token_filename='o365_token.txt')`\r\n`account = Account(o365_credentials, token_backend=token_backend)`\r\n\r\nBefore using my app, I collected a auth token with another script \"auth.py\" that I launched to follow the auth process (visit the URL and paste back the new auth URL). Here is my code in \"auth.py\":\r\n`client_id = \"PRIVATE\"`\r\n`client_secret = \"PRIVATE\"`\r\n`credentials = (client_id, client_secret)`\r\n`token_backend = FileSystemTokenBackend(token_path='./', token_filename='o365_token.txt')`\r\n`account = Account(credentials, token_backend=token_backend)`\r\n`token = account.authenticate(scopes=['offline_access', 'Calendars.Read', 'Calendars.Read.Shared', 'Calendars.ReadWrite', 'Calendars.ReadWrite.Shared'])`\r\n\r\nWhen I follow the auth step, I see that a file called \"o365_token.txt\" appears and when I read it I see there is a \"refresh token\" line.\r\nHowever, the token expires after 60minutes and after that I can't use the API. I can't figure out why...\r\n\r\nThanks for helping. I tried a lot of differents things to get a refreshed token, without success.\r\n\r\nSeevoid\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/322", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/322/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/322/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/322/events", "html_url": "https://github.com/O365/python-o365/issues/322", "id": 500962616, "node_id": "MDU6SXNzdWU1MDA5NjI2MTY=", "number": 322, "title": "Calendar/Schedule - Create meeting and invite users", "user": {"login": "coltenkrauter", "id": 18080897, "node_id": "MDQ6VXNlcjE4MDgwODk3", "avatar_url": "https://avatars1.githubusercontent.com/u/18080897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/coltenkrauter", "html_url": "https://github.com/coltenkrauter", "followers_url": "https://api.github.com/users/coltenkrauter/followers", "following_url": "https://api.github.com/users/coltenkrauter/following{/other_user}", "gists_url": "https://api.github.com/users/coltenkrauter/gists{/gist_id}", "starred_url": "https://api.github.com/users/coltenkrauter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/coltenkrauter/subscriptions", "organizations_url": "https://api.github.com/users/coltenkrauter/orgs", "repos_url": "https://api.github.com/users/coltenkrauter/repos", "events_url": "https://api.github.com/users/coltenkrauter/events{/privacy}", "received_events_url": "https://api.github.com/users/coltenkrauter/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 178268455, "node_id": "MDU6TGFiZWwxNzgyNjg0NTU=", "url": "https://api.github.com/repos/O365/python-o365/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-01T15:09:44Z", "updated_at": "2019-10-10T15:58:08Z", "closed_at": "2019-10-10T15:58:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to create an Outlook meeting with at least 2 users -- or a way to invite users to the meeting immediately after creating it. Can someone help with this?\r\n\r\nIdeally, I would like to be able to set the: \r\n- invitees\r\n- meeting room\r\n\r\n\r\nNow, I am able to create appointments per the tutorial...\r\n\r\n```\r\nschedule = account.schedule()\r\n\r\ncalendar = schedule.get_default_calendar()\r\nnew_event = calendar.new_event()  # creates a new unsaved event \r\nnew_event.subject = 'Recruit George Best!'\r\nnew_event.location = 'England'\r\n\r\n# naive datetimes will automatically be converted to timezone aware datetime\r\n#  objects using the local timezone detected or the protocol provided timezone\r\n\r\nnew_event.start = dt.datetime(2019, 10, 5, 19, 45) \r\n# so new_event.start becomes: datetime.datetime(2018, 9, 5, 19, 45, tzinfo=<DstTzInfo 'Europe/Paris' CEST+2:00:00 DST>)\r\n\r\nnew_event.recurrence.set_daily(1, end=dt.datetime(2019, 10, 10))\r\nnew_event.remind_before_minutes = 45\r\n\r\nprint(new_event.save())\r\nnew_event\r\n```\r\n\r\nBut I cannot figure out how to make it a meeting.\r\n\r\nAny help would be much appreciated. ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/321", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/321/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/321/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/321/events", "html_url": "https://github.com/O365/python-o365/issues/321", "id": 500504111, "node_id": "MDU6SXNzdWU1MDA1MDQxMTE=", "number": 321, "title": "ImportError: cannot import name Account", "user": {"login": "w0rmh0l3", "id": 39700049, "node_id": "MDQ6VXNlcjM5NzAwMDQ5", "avatar_url": "https://avatars3.githubusercontent.com/u/39700049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/w0rmh0l3", "html_url": "https://github.com/w0rmh0l3", "followers_url": "https://api.github.com/users/w0rmh0l3/followers", "following_url": "https://api.github.com/users/w0rmh0l3/following{/other_user}", "gists_url": "https://api.github.com/users/w0rmh0l3/gists{/gist_id}", "starred_url": "https://api.github.com/users/w0rmh0l3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/w0rmh0l3/subscriptions", "organizations_url": "https://api.github.com/users/w0rmh0l3/orgs", "repos_url": "https://api.github.com/users/w0rmh0l3/repos", "events_url": "https://api.github.com/users/w0rmh0l3/events{/privacy}", "received_events_url": "https://api.github.com/users/w0rmh0l3/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-30T20:23:48Z", "updated_at": "2019-10-13T14:31:42Z", "closed_at": "2019-10-10T19:30:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nfrom O365 import Account\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 1, in <module>\r\nImportError: cannot import name Account\r\n```\r\n\r\n```\r\n$ pip3 show O365\r\nName: O365\r\nVersion: 0.9.16\r\nSummary: Python library for working with Microsoft Office 365\r\nHome-page: https://github.com/Narcolapser/python-o365\r\nAuthor: Toben Archer\r\nAuthor-email: sandslash+O365@gmail.com\r\nLicense: Apache 2.0\r\nLocation: {Redacted}\r\nRequires: requests-oauthlib, requests, future, oauthlib\r\nRequired-by:\r\n```\r\nMac 10.14.6 | Python 3.6.7", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/320", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/320/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/320/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/320/events", "html_url": "https://github.com/O365/python-o365/issues/320", "id": 500485470, "node_id": "MDU6SXNzdWU1MDA0ODU0NzA=", "number": 320, "title": "error when accessing onedrive for business", "user": {"login": "veribus", "id": 55036524, "node_id": "MDQ6VXNlcjU1MDM2NTI0", "avatar_url": "https://avatars0.githubusercontent.com/u/55036524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/veribus", "html_url": "https://github.com/veribus", "followers_url": "https://api.github.com/users/veribus/followers", "following_url": "https://api.github.com/users/veribus/following{/other_user}", "gists_url": "https://api.github.com/users/veribus/gists{/gist_id}", "starred_url": "https://api.github.com/users/veribus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/veribus/subscriptions", "organizations_url": "https://api.github.com/users/veribus/orgs", "repos_url": "https://api.github.com/users/veribus/repos", "events_url": "https://api.github.com/users/veribus/events{/privacy}", "received_events_url": "https://api.github.com/users/veribus/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2019-09-30T19:47:07Z", "updated_at": "2019-11-04T21:42:30Z", "closed_at": "2019-11-04T21:42:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI'm using the \"with your own identity\" method and I have registered an app with Application Permissions in AAD. I can authenticate without issue, but I cannot access onedrive. \r\n\r\nWhen I execute the pictured script below, I keep getting the error \"HTTPError: 403 Client Error: Forbidden for url: https://graph.microsoft.com/v1.0/drives?%24top=999 | Error Message: Either scp or roles claim need to be present in the token.\"\r\n\r\nI'm trying to create a script that runs periodically on a VM and uploads a file to onedrive.\r\n\r\nThank you for any help you can provide.\r\n![issue_od](https://user-images.githubusercontent.com/55036524/65910729-4645ed00-e399-11e9-8c06-9c1f53350f87.PNG)\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/319", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/319/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/319/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/319/events", "html_url": "https://github.com/O365/python-o365/issues/319", "id": 499936231, "node_id": "MDU6SXNzdWU0OTk5MzYyMzE=", "number": 319, "title": "Question: read my inbox returns \"Error Message: Resource not found for the segment 'mailFolders'.\"", "user": {"login": "lia-cha-avalara", "id": 54375621, "node_id": "MDQ6VXNlcjU0Mzc1NjIx", "avatar_url": "https://avatars1.githubusercontent.com/u/54375621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lia-cha-avalara", "html_url": "https://github.com/lia-cha-avalara", "followers_url": "https://api.github.com/users/lia-cha-avalara/followers", "following_url": "https://api.github.com/users/lia-cha-avalara/following{/other_user}", "gists_url": "https://api.github.com/users/lia-cha-avalara/gists{/gist_id}", "starred_url": "https://api.github.com/users/lia-cha-avalara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lia-cha-avalara/subscriptions", "organizations_url": "https://api.github.com/users/lia-cha-avalara/orgs", "repos_url": "https://api.github.com/users/lia-cha-avalara/repos", "events_url": "https://api.github.com/users/lia-cha-avalara/events{/privacy}", "received_events_url": "https://api.github.com/users/lia-cha-avalara/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-09-29T16:02:47Z", "updated_at": "2019-10-17T07:44:52Z", "closed_at": "2019-10-16T17:42:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "I registered an azure app, gave it user.profile and mail.read permissions (application access). Granted admin consent for the permissions  Ran the following code:\r\n\r\nCLIENT_ID = os.environ['CLIENT_ID']\r\nCLIENT_SECRET = os.environ['CLIENT_SECRET']\r\ncredentials = (CLIENT_ID, CLIENT_SECRET)\r\naccount = Account(credentials, auth_flow_type='credentials')\r\nif account.authenticate():\r\n   print('Authenticated!')\r\n   mailbox = account.mailbox()\r\n   inbox = mailbox.inbox_folder()\r\n   for message in inbox.get_messages():\r\n       print(message)\r\n\r\nIt authenticates fine but when it tries to get the messages it fails. I even tried by using the MSGraphProtocol class and defining the api_version arg as 'beta' and the default_resource arg as my own email address but doing that says the token doesn't have the right permissions..\r\n\r\nShould add that if i went the delegated permissions route and using the console authentication method, everything works fine.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/318", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/318/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/318/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/318/events", "html_url": "https://github.com/O365/python-o365/issues/318", "id": 499168482, "node_id": "MDU6SXNzdWU0OTkxNjg0ODI=", "number": 318, "title": "Question about authentication", "user": {"login": "NathanTech7713", "id": 29704261, "node_id": "MDQ6VXNlcjI5NzA0MjYx", "avatar_url": "https://avatars1.githubusercontent.com/u/29704261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NathanTech7713", "html_url": "https://github.com/NathanTech7713", "followers_url": "https://api.github.com/users/NathanTech7713/followers", "following_url": "https://api.github.com/users/NathanTech7713/following{/other_user}", "gists_url": "https://api.github.com/users/NathanTech7713/gists{/gist_id}", "starred_url": "https://api.github.com/users/NathanTech7713/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NathanTech7713/subscriptions", "organizations_url": "https://api.github.com/users/NathanTech7713/orgs", "repos_url": "https://api.github.com/users/NathanTech7713/repos", "events_url": "https://api.github.com/users/NathanTech7713/events{/privacy}", "received_events_url": "https://api.github.com/users/NathanTech7713/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-27T00:02:05Z", "updated_at": "2019-10-06T17:51:42Z", "closed_at": "2019-10-06T17:51:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi there,\r\nJust a quick question about authentication:\r\nUsing the example for web service in the documentation, I am able to, happily, authenticate.\r\nMy problem comes thus:\r\nI need to save the token amongst other program data, and then restore it from that.\r\nSomething like:\r\naccess_token=account.connection.token\r\n# code for saving here.\r\n\r\nThen in the def main:\r\n# load our data\r\nif(token!=0):\r\naccount.connection.access_token=token\r\nif(account.expired())\r\naccount.refresh_token()\r\n\r\ni'm not entire sure how I'd go about this though, and that's why I'm asking for a little help?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/O365/python-o365/issues/317", "repository_url": "https://api.github.com/repos/O365/python-o365", "labels_url": "https://api.github.com/repos/O365/python-o365/issues/317/labels{/name}", "comments_url": "https://api.github.com/repos/O365/python-o365/issues/317/comments", "events_url": "https://api.github.com/repos/O365/python-o365/issues/317/events", "html_url": "https://github.com/O365/python-o365/issues/317", "id": 498646055, "node_id": "MDU6SXNzdWU0OTg2NDYwNTU=", "number": 317, "title": "Authorization error", "user": {"login": "basilgeorge", "id": 38415715, "node_id": "MDQ6VXNlcjM4NDE1NzE1", "avatar_url": "https://avatars3.githubusercontent.com/u/38415715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/basilgeorge", "html_url": "https://github.com/basilgeorge", "followers_url": "https://api.github.com/users/basilgeorge/followers", "following_url": "https://api.github.com/users/basilgeorge/following{/other_user}", "gists_url": "https://api.github.com/users/basilgeorge/gists{/gist_id}", "starred_url": "https://api.github.com/users/basilgeorge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/basilgeorge/subscriptions", "organizations_url": "https://api.github.com/users/basilgeorge/orgs", "repos_url": "https://api.github.com/users/basilgeorge/repos", "events_url": "https://api.github.com/users/basilgeorge/events{/privacy}", "received_events_url": "https://api.github.com/users/basilgeorge/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-26T04:10:25Z", "updated_at": "2019-09-26T08:54:46Z", "closed_at": "2019-09-26T08:54:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI went through other related issues for this repo but none seems to solve my problem. \r\n\r\nI am unable to authenticate and get access token.\r\n\r\nThese are the steps I followed in command-line:\r\n\r\n```\r\nfrom O365 import Account\r\ncredentials = (XXXX, YYYY)\r\nscopes=['basic', 'message_all']\r\naccount = Account(credentials)\r\naccount.authenticate(scopes=scopes)\r\n```\r\n\r\nVisit the following url to give consent:\r\n`https://login.microsoftonline.com/common/oauth2/v2.0/authorize?response_type=code&client_id=XXXX&redirect_uri=https%3A%2F%2Flogin.microsoftonline.com%2Fcommon%2Foauth2%2Fnativeclient&scope=https%3A%2F%2Fgraph.microsoft.com%2FMail.ReadWrite+https%3A%2F%2Fgraph.microsoft.com%2FUser.Read+https%3A%2F%2Fgraph.microsoft.com%2FMail.Send&state=8uYYgVKgZVdyAAB9wJYo4dCcPte2N6&access_type=offline`\r\n\r\nPaste the authenticated url here:\r\n`https://login.microsoftonline.com/common/oauth2/nativeclient?code=Xxxx&state=xxx&session_state=Xxx\r\n\r\nThe pasted URL was received after logging into the account. But I receive the following error:\r\n\r\n```\r\nERROR:O365.connection:Unable to fetch auth token. Error: (invalid_client) AADSTS700025: Client is public so neither 'client_assertion' nor 'client_secret' should be presented.\r\nTrace ID: a3c24393-576f-4884-980a-32ef582d1a00\r\nCorrelation ID: 2ef0ceaf-6968-4884-9d75-5ac4151be4eb\r\nTimestamp: 2019-09-19 10:51:30Z\r\nSomething go wrong. Please try again.\r\n```\r\n\r\nThe following are some screenshots of my Azure App Registration portal:\r\n\r\n![azure_app_1](https://user-images.githubusercontent.com/38415715/65238842-4291ab00-dafb-11e9-9e15-4aaa7474070b.jpg)\r\n\r\n![azure_app_2](https://user-images.githubusercontent.com/38415715/65238850-4ae9e600-dafb-11e9-9877-eec66ebe3124.jpg)\r\n\r\n![azure_app_3](https://user-images.githubusercontent.com/38415715/65238858-50dfc700-dafb-11e9-8c71-3f05e97cf762.jpg)\r\n\r\nPlease help.\r\n\r\nThanks.\r\n", "performed_via_github_app": null, "score": 1.0}]}