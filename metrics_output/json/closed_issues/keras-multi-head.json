{"total_count": 6, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/7", "repository_url": "https://api.github.com/repos/CyberZHG/keras-multi-head", "labels_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/7/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/7/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/7/events", "html_url": "https://github.com/CyberZHG/keras-multi-head/issues/7", "id": 618253408, "node_id": "MDU6SXNzdWU2MTgyNTM0MDg=", "number": 7, "title": "\u60a8\u597d\uff01\u8bf7\u95ee\u8fd9\u91cc\u591a\u5934\u6ce8\u610f\u529b\u8f93\u5165\u7684\u53ea\u662f\u4e00\u4e2atensor\u7684\u8bdd\uff0c\u662f\u4e0d\u662f\u5c31\u662f\u591a\u5934\u81ea\u6ce8\u610f\u529b", "user": {"login": "Saku1Kyne", "id": 56926042, "node_id": "MDQ6VXNlcjU2OTI2MDQy", "avatar_url": "https://avatars2.githubusercontent.com/u/56926042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Saku1Kyne", "html_url": "https://github.com/Saku1Kyne", "followers_url": "https://api.github.com/users/Saku1Kyne/followers", "following_url": "https://api.github.com/users/Saku1Kyne/following{/other_user}", "gists_url": "https://api.github.com/users/Saku1Kyne/gists{/gist_id}", "starred_url": "https://api.github.com/users/Saku1Kyne/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Saku1Kyne/subscriptions", "organizations_url": "https://api.github.com/users/Saku1Kyne/orgs", "repos_url": "https://api.github.com/users/Saku1Kyne/repos", "events_url": "https://api.github.com/users/Saku1Kyne/events{/privacy}", "received_events_url": "https://api.github.com/users/Saku1Kyne/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1060657105, "node_id": "MDU6TGFiZWwxMDYwNjU3MTA1", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1060657106, "node_id": "MDU6TGFiZWwxMDYwNjU3MTA2", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-14T13:56:57Z", "updated_at": "2020-05-22T06:51:49Z", "closed_at": "2020-05-22T06:51:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "\u8fd8\u662f\u9700\u8981\u53e6\u5916\u5199\u4e00\u4e2a\u591a\u5934\u81ea\u6ce8\u610f\u529b\u7c7b\u6765\u8c03\u7528\u8fd9\u4e2a\u591a\u5934\u6ce8\u610f\u529b\u5462\uff0c\u6b63\u5728\u5b66\u4e60\u4e2d\uff0c\u4ee3\u7801\u8bfb\u7684\u4e0d\u662f\u5f88\u660e\u767d\uff0c\u53ef\u4ee5\u89e3\u7b54\u7684\u8bdd\u4e0d\u80dc\u611f\u6fc0", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/6", "repository_url": "https://api.github.com/repos/CyberZHG/keras-multi-head", "labels_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/6/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/6/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/6/events", "html_url": "https://github.com/CyberZHG/keras-multi-head/issues/6", "id": 612998176, "node_id": "MDU6SXNzdWU2MTI5OTgxNzY=", "number": 6, "title": "Example in simple time-series ", "user": {"login": "rjpg", "id": 22857941, "node_id": "MDQ6VXNlcjIyODU3OTQx", "avatar_url": "https://avatars1.githubusercontent.com/u/22857941?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rjpg", "html_url": "https://github.com/rjpg", "followers_url": "https://api.github.com/users/rjpg/followers", "following_url": "https://api.github.com/users/rjpg/following{/other_user}", "gists_url": "https://api.github.com/users/rjpg/gists{/gist_id}", "starred_url": "https://api.github.com/users/rjpg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rjpg/subscriptions", "organizations_url": "https://api.github.com/users/rjpg/orgs", "repos_url": "https://api.github.com/users/rjpg/repos", "events_url": "https://api.github.com/users/rjpg/events{/privacy}", "received_events_url": "https://api.github.com/users/rjpg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1060657101, "node_id": "MDU6TGFiZWwxMDYwNjU3MTAx", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/enhancement", "name": "enhancement", "color": "a2eeef", "default": true, "description": "New feature or request"}, {"id": 1060657106, "node_id": "MDU6TGFiZWwxMDYwNjU3MTA2", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-05-06T01:47:48Z", "updated_at": "2020-05-13T12:02:49Z", "closed_at": "2020-05-13T12:02:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "hello, this is the heart of transformer, GPT, and BERT architectures. I have been trying to see how to apply these architectures directly in time-series problems (not on NPL problems). Just predict the next value in a sequence and/or classify a sequence of values. \r\n\r\nIt would be nice if you could provide some simple example of how to apply this block in a simple multivariable time-series scenario (with simple values in a sequence, with no embeddings, etc), if possible.\r\n\r\nThanks in advance!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/5", "repository_url": "https://api.github.com/repos/CyberZHG/keras-multi-head", "labels_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/5/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/5/events", "html_url": "https://github.com/CyberZHG/keras-multi-head/issues/5", "id": 579653397, "node_id": "MDU6SXNzdWU1Nzk2NTMzOTc=", "number": 5, "title": "feature_dim in muti_head_attention", "user": {"login": "zjzzzz", "id": 34811267, "node_id": "MDQ6VXNlcjM0ODExMjY3", "avatar_url": "https://avatars3.githubusercontent.com/u/34811267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zjzzzz", "html_url": "https://github.com/zjzzzz", "followers_url": "https://api.github.com/users/zjzzzz/followers", "following_url": "https://api.github.com/users/zjzzzz/following{/other_user}", "gists_url": "https://api.github.com/users/zjzzzz/gists{/gist_id}", "starred_url": "https://api.github.com/users/zjzzzz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zjzzzz/subscriptions", "organizations_url": "https://api.github.com/users/zjzzzz/orgs", "repos_url": "https://api.github.com/users/zjzzzz/repos", "events_url": "https://api.github.com/users/zjzzzz/events{/privacy}", "received_events_url": "https://api.github.com/users/zjzzzz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1060657105, "node_id": "MDU6TGFiZWwxMDYwNjU3MTA1", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/question", "name": "question", "color": "d876e3", "default": true, "description": "Further information is requested"}, {"id": 1060657106, "node_id": "MDU6TGFiZWwxMDYwNjU3MTA2", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-12T02:36:04Z", "updated_at": "2020-03-19T04:31:55Z", "closed_at": "2020-03-19T03:33:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I wonder if 'feature_dim' could be assigned by human. In your code, given the input, 'feature_dim' is fixed, so that the shape of 'Wq','Wk','Wv' is fixed. \r\n\r\n`    def build(self, input_shape):\r\n        if isinstance(input_shape, list):\r\n            q, k, v = input_shape\r\n        else:\r\n            q = k = v = input_shape\r\n        feature_dim = int(v[-1])\r\n`\r\n`\r\n self.Wq = self.add_weight(\r\n            shape=(int(q[-1]), feature_dim),\r\n self.Wk = self.add_weight(\r\n            shape=(int(k[-1]), feature_dim),\r\n self.Wv = self.add_weight(\r\n            shape=(int(v[-1]), feature_dim),`", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/4", "repository_url": "https://api.github.com/repos/CyberZHG/keras-multi-head", "labels_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/4/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/4/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/4/events", "html_url": "https://github.com/CyberZHG/keras-multi-head/issues/4", "id": 565925810, "node_id": "MDU6SXNzdWU1NjU5MjU4MTA=", "number": 4, "title": "Multi-head Attention with 2 Input Layers", "user": {"login": "Rmsharks4", "id": 29046516, "node_id": "MDQ6VXNlcjI5MDQ2NTE2", "avatar_url": "https://avatars3.githubusercontent.com/u/29046516?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rmsharks4", "html_url": "https://github.com/Rmsharks4", "followers_url": "https://api.github.com/users/Rmsharks4/followers", "following_url": "https://api.github.com/users/Rmsharks4/following{/other_user}", "gists_url": "https://api.github.com/users/Rmsharks4/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rmsharks4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rmsharks4/subscriptions", "organizations_url": "https://api.github.com/users/Rmsharks4/orgs", "repos_url": "https://api.github.com/users/Rmsharks4/repos", "events_url": "https://api.github.com/users/Rmsharks4/events{/privacy}", "received_events_url": "https://api.github.com/users/Rmsharks4/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1060657101, "node_id": "MDU6TGFiZWwxMDYwNjU3MTAx", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/enhancement", "name": "enhancement", "color": "a2eeef", "default": true, "description": "New feature or request"}, {"id": 1060657106, "node_id": "MDU6TGFiZWwxMDYwNjU3MTA2", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-16T15:49:05Z", "updated_at": "2020-02-23T17:31:55Z", "closed_at": "2020-02-23T17:31:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Currently, if I use two layers as input to the Multi-Head Attention layer like so:\r\n`csr_atten = MultiHeadAttention(head_num=2)([csr_doc_layer, csr_intents_layer])`\r\nit throws out the following error:\r\n> ValueError: not enough values to unpack (expected 3, got 2)\r\n\r\nIs there a workaround for using two input layers? Or is an alternative under development?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/3", "repository_url": "https://api.github.com/repos/CyberZHG/keras-multi-head", "labels_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/3/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/3/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/3/events", "html_url": "https://github.com/CyberZHG/keras-multi-head/issues/3", "id": 528652422, "node_id": "MDU6SXNzdWU1Mjg2NTI0MjI=", "number": 3, "title": "AttributeError: 'Tensor' object has no attribute 'supports_masking'", "user": {"login": "lijinze9456yy000", "id": 32918729, "node_id": "MDQ6VXNlcjMyOTE4NzI5", "avatar_url": "https://avatars1.githubusercontent.com/u/32918729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lijinze9456yy000", "html_url": "https://github.com/lijinze9456yy000", "followers_url": "https://api.github.com/users/lijinze9456yy000/followers", "following_url": "https://api.github.com/users/lijinze9456yy000/following{/other_user}", "gists_url": "https://api.github.com/users/lijinze9456yy000/gists{/gist_id}", "starred_url": "https://api.github.com/users/lijinze9456yy000/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lijinze9456yy000/subscriptions", "organizations_url": "https://api.github.com/users/lijinze9456yy000/orgs", "repos_url": "https://api.github.com/users/lijinze9456yy000/repos", "events_url": "https://api.github.com/users/lijinze9456yy000/events{/privacy}", "received_events_url": "https://api.github.com/users/lijinze9456yy000/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1060657099, "node_id": "MDU6TGFiZWwxMDYwNjU3MDk5", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1060657106, "node_id": "MDU6TGFiZWwxMDYwNjU3MTA2", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "CyberZHG", "id": 853842, "node_id": "MDQ6VXNlcjg1Mzg0Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/853842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CyberZHG", "html_url": "https://github.com/CyberZHG", "followers_url": "https://api.github.com/users/CyberZHG/followers", "following_url": "https://api.github.com/users/CyberZHG/following{/other_user}", "gists_url": "https://api.github.com/users/CyberZHG/gists{/gist_id}", "starred_url": "https://api.github.com/users/CyberZHG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CyberZHG/subscriptions", "organizations_url": "https://api.github.com/users/CyberZHG/orgs", "repos_url": "https://api.github.com/users/CyberZHG/repos", "events_url": "https://api.github.com/users/CyberZHG/events{/privacy}", "received_events_url": "https://api.github.com/users/CyberZHG/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-26T11:07:45Z", "updated_at": "2019-12-03T12:55:52Z", "closed_at": "2019-12-03T12:55:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I got an error while using MultiHead\uff0ccode as follows:\r\n`l_att2=MultiHead(keras.layers.Dot((1, 1))([encoder_embed, attention_weightn]),layer_num=2,name='Multi-Dot')`\r\nHow to solve this problem\uff1f", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/1", "repository_url": "https://api.github.com/repos/CyberZHG/keras-multi-head", "labels_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/1/comments", "events_url": "https://api.github.com/repos/CyberZHG/keras-multi-head/issues/1/events", "html_url": "https://github.com/CyberZHG/keras-multi-head/issues/1", "id": 438411094, "node_id": "MDU6SXNzdWU0Mzg0MTEwOTQ=", "number": 1, "title": "Fitting MultiHeadAttention in memory for long sequences", "user": {"login": "Jsevillamol", "id": 5825805, "node_id": "MDQ6VXNlcjU4MjU4MDU=", "avatar_url": "https://avatars0.githubusercontent.com/u/5825805?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jsevillamol", "html_url": "https://github.com/Jsevillamol", "followers_url": "https://api.github.com/users/Jsevillamol/followers", "following_url": "https://api.github.com/users/Jsevillamol/following{/other_user}", "gists_url": "https://api.github.com/users/Jsevillamol/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jsevillamol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jsevillamol/subscriptions", "organizations_url": "https://api.github.com/users/Jsevillamol/orgs", "repos_url": "https://api.github.com/users/Jsevillamol/repos", "events_url": "https://api.github.com/users/Jsevillamol/events{/privacy}", "received_events_url": "https://api.github.com/users/Jsevillamol/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1060657106, "node_id": "MDU6TGFiZWwxMDYwNjU3MTA2", "url": "https://api.github.com/repos/CyberZHG/keras-multi-head/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-04-29T16:54:00Z", "updated_at": "2019-08-25T09:58:16Z", "closed_at": "2019-08-25T09:58:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to train my own sequence tagging model based on this repository implementation of MultiHeadAttention\r\n\r\n```\r\nimport keras.layers as ll\r\nfrom keras import Model\r\nfrom keras_pos_embd import TrigPosEmbedding\r\nfrom keras_multi_head import MultiHeadAttention\r\n\r\ninputs = ll.Input(shape=(None,))\r\nx = ll.Embedding(10000, 1024)(inputs)\r\nx = TrigPosEmbedding(mode='add')(x)\r\nx = MultiHeadAttention(head_num=8)(x)\r\nx = ll.Dense(units = 512, activation='relu')(x)\r\nx = ll.Dense(units = 4, activation='softmax')(x)\r\noutputs = x\r\nmodel = Model(inputs, outputs)\r\nmodel.summary()\r\n```\r\n\r\nI have one big problem. The sequences in my training set are quite long (length upper bound by 20000), and when I attempt to train it I get an OOM.\r\n\r\nThe OOM happens when trying to allocate a [16, 20000, 20000] tensor. If my calculations are correct, just storing this vector would take >150 GB of RAM!\r\n\r\nI was wondering if you have any suggestions on how to modify the code to make it work in a more serialized way, only loading in memory a context of the length specified by a custom parameter.\r\n\r\nI tried going to a lower level with `keras_self_attention.SeqSelfAttention` and the configurable attention width, but in the end it would still try to allocate a very big tensor to my GPU.\r\n\r\nPD: Awesome repo!", "performed_via_github_app": null, "score": 1.0}]}