{"total_count": 9, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/25", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/25/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/25/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/25/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/25", "id": 574498953, "node_id": "MDU6SXNzdWU1NzQ0OTg5NTM=", "number": 25, "title": "@timecall breaks when used on @functools.lru_cache", "user": {"login": "mgedmin", "id": 159967, "node_id": "MDQ6VXNlcjE1OTk2Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/159967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mgedmin", "html_url": "https://github.com/mgedmin", "followers_url": "https://api.github.com/users/mgedmin/followers", "following_url": "https://api.github.com/users/mgedmin/following{/other_user}", "gists_url": "https://api.github.com/users/mgedmin/gists{/gist_id}", "starred_url": "https://api.github.com/users/mgedmin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mgedmin/subscriptions", "organizations_url": "https://api.github.com/users/mgedmin/orgs", "repos_url": "https://api.github.com/users/mgedmin/repos", "events_url": "https://api.github.com/users/mgedmin/events{/privacy}", "received_events_url": "https://api.github.com/users/mgedmin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 6375058, "node_id": "MDU6TGFiZWw2Mzc1MDU4", "url": "https://api.github.com/repos/mgedmin/profilehooks/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-03-03T08:31:07Z", "updated_at": "2020-03-03T13:21:33Z", "closed_at": "2020-03-03T13:21:33Z", "author_association": "OWNER", "active_lock_reason": null, "body": "This code\r\n```python\r\nimport functools\r\nimport profilehooks\r\n\r\n@profilehooks.timecall(immediate=True)\r\n@functools.lru_cache()\r\ndef func():\r\n    return 42\r\n```\r\n\r\nfails:\r\n\r\n```python\r\n    def __call__(self, *args, **kw):\r\n        \"\"\"Profile a singe call to the function.\"\"\"\r\n        fn = self.fn\r\n        timer = self.timer\r\n        self.ncalls += 1\r\n        start = timer()\r\n        try:\r\n            return fn(*args, **kw)\r\n        finally:\r\n            duration = timer() - start\r\n            self.totaltime += duration\r\n            if self.immediate:\r\n                funcname = fn.__name__\r\n>               filename = fn.__code__.co_filename\r\nE               AttributeError: 'functools._lru_cache_wrapper' object has no attribute '__code__'\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/24", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/24/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/24/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/24/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/24", "id": 557325516, "node_id": "MDU6SXNzdWU1NTczMjU1MTY=", "number": 24, "title": "UnicodeDecodeError on output", "user": {"login": "eboth", "id": 9194971, "node_id": "MDQ6VXNlcjkxOTQ5NzE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9194971?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eboth", "html_url": "https://github.com/eboth", "followers_url": "https://api.github.com/users/eboth/followers", "following_url": "https://api.github.com/users/eboth/following{/other_user}", "gists_url": "https://api.github.com/users/eboth/gists{/gist_id}", "starred_url": "https://api.github.com/users/eboth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eboth/subscriptions", "organizations_url": "https://api.github.com/users/eboth/orgs", "repos_url": "https://api.github.com/users/eboth/repos", "events_url": "https://api.github.com/users/eboth/events{/privacy}", "received_events_url": "https://api.github.com/users/eboth/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-01-30T07:59:09Z", "updated_at": "2020-01-30T11:49:54Z", "closed_at": "2020-01-30T08:46:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Even with the console set to UTF-8, profilehooks hits an exception on outputting `@coverage` results:\r\n\r\n```\r\nError in atexit._run_exitfuncs:\r\nTraceback (most recent call last):\r\n  File \"C:\\Python3-32\\lib\\site-packages\\profilehooks.py\", line 632, in __init__\r\n    self.find_source_lines()\r\n  File \"C:\\Python3-32\\lib\\site-packages\\profilehooks.py\", line 640, in find_source_lines\r\n    strs = self._find_docstrings(self.filename)\r\n  File \"C:\\Python3-32\\lib\\site-packages\\profilehooks.py\", line 658, in _find_docstrings\r\n    for ttype, tstr, start, end, line in tokens:\r\n  File \"C:\\Python3-32\\lib\\tokenize.py\", line 450, in _tokenize\r\n    line = readline()\r\n  File \"C:\\Python3-32\\lib\\encodings\\cp1252.py\", line 23, in decode\r\n    return codecs.charmap_decode(input,self.errors,decoding_table)[0]\r\nUnicodeDecodeError: 'charmap' codec can't decode byte 0x9d in position 3355: character maps to <undefined>\r\n```\r\n\r\n`@profile` results print fine, as does printing unicode to the console:\r\n`print('\\u0173\\u2014\\u0172')`\r\n\r\n**Environment:**\r\nWindows 7 x64\r\nPython x32 3.8.1\r\nprofilehooks 1.11.0\r\nConsole: conemu or IntelliJ IDEA\r\nSome encoding settings (don't ask me about the difference between them, though at first sight `sys.stdout.encoding` seems a good candidate for deciding on the console output encoding):\r\n```\r\n>>> import sys; sys.getdefaultencoding()\r\n'utf-8'\r\n>>> import locale; locale.getpreferredencoding()\r\n'cp1252'\r\n>>> sys.stdout.encoding\r\n'utf-8'\r\n```\r\n\r\nMaybe the \"Note\" about `surrogateescape` under [this link](http://python-notes.curiousefficiency.org/en/latest/python3/text_file_processing.html#files-in-an-ascii-compatible-encoding-best-effort-is-acceptable) would also apply?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/18", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/18/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/18/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/18/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/18", "id": 356318005, "node_id": "MDU6SXNzdWUzNTYzMTgwMDU=", "number": 18, "title": "Cannot use decorators inside a class..", "user": {"login": "projx", "id": 1296359, "node_id": "MDQ6VXNlcjEyOTYzNTk=", "avatar_url": "https://avatars1.githubusercontent.com/u/1296359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/projx", "html_url": "https://github.com/projx", "followers_url": "https://api.github.com/users/projx/followers", "following_url": "https://api.github.com/users/projx/following{/other_user}", "gists_url": "https://api.github.com/users/projx/gists{/gist_id}", "starred_url": "https://api.github.com/users/projx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/projx/subscriptions", "organizations_url": "https://api.github.com/users/projx/orgs", "repos_url": "https://api.github.com/users/projx/repos", "events_url": "https://api.github.com/users/projx/events{/privacy}", "received_events_url": "https://api.github.com/users/projx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 6375061, "node_id": "MDU6TGFiZWw2Mzc1MDYx", "url": "https://api.github.com/repos/mgedmin/profilehooks/labels/invalid", "name": "invalid", "color": "e6e6e6", "default": true, "description": null}, {"id": 6375062, "node_id": "MDU6TGFiZWw2Mzc1MDYy", "url": "https://api.github.com/repos/mgedmin/profilehooks/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-09-02T22:11:36Z", "updated_at": "2020-03-03T13:22:43Z", "closed_at": "2020-03-03T13:22:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi\r\n\r\nI'm trying to use the @timecall() decoractor in a class, as follows:\r\n\r\n    @timecall(immediate=True)\r\n    def toggle_sort(self):\r\n        checked = self.actionToggleSort.isChecked()\r\n        if checked==True:\r\n\r\nBut its returning the following error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/site-packages/profilehooks.py\", line 736, in new_fn\r\n    return fp(*args, **kw)\r\n  File \"/usr/local/lib/python3.7/site-packages/profilehooks.py\", line 762, in __call__\r\n    return fn(*args, **kw)\r\nTypeError: toggle_sort() takes 1 positional argument but 2 were given\r\n```\r\n\r\nCould you advise if I'm doing anything wrong? Is this a bug?\r\n\r\nUnfortunately I'm a python newb, so its probably just something I've missed.\r\n\r\nThanks", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/15", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/15/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/15/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/15/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/15", "id": 280734494, "node_id": "MDU6SXNzdWUyODA3MzQ0OTQ=", "number": 15, "title": "Syntax error line 636", "user": {"login": "zopar", "id": 22060068, "node_id": "MDQ6VXNlcjIyMDYwMDY4", "avatar_url": "https://avatars0.githubusercontent.com/u/22060068?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zopar", "html_url": "https://github.com/zopar", "followers_url": "https://api.github.com/users/zopar/followers", "following_url": "https://api.github.com/users/zopar/following{/other_user}", "gists_url": "https://api.github.com/users/zopar/gists{/gist_id}", "starred_url": "https://api.github.com/users/zopar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zopar/subscriptions", "organizations_url": "https://api.github.com/users/zopar/orgs", "repos_url": "https://api.github.com/users/zopar/repos", "events_url": "https://api.github.com/users/zopar/events{/privacy}", "received_events_url": "https://api.github.com/users/zopar/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-12-09T16:51:33Z", "updated_at": "2017-12-10T08:01:44Z", "closed_at": "2017-12-10T08:01:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi\r\nthe problem is \r\nSyntaxError: ('invalid syntax', ('/usr/lib/python2.6/site-packages/profilehooks.py', 636, 23, '        lines = {ln for off, ln in dis.findlinestarts(self.fn.__code__)\\n'))\r\n\r\nLine 636/7\r\nlines = {ln for off, ln in dis.findlinestarts(self.fn.__code__)\r\n                 if ln not in strs}\r\n\r\nWe need to replace { with [\r\nI will pull a merge requests\r\n\r\nI used python 2.6.6 you could test also compatibility with 2.6 if you like", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/14", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/14/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/14/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/14/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/14", "id": 216496000, "node_id": "MDU6SXNzdWUyMTY0OTYwMDA=", "number": 14, "title": "ValueError: I/O operation on closed file", "user": {"login": "tchap", "id": 697127, "node_id": "MDQ6VXNlcjY5NzEyNw==", "avatar_url": "https://avatars1.githubusercontent.com/u/697127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tchap", "html_url": "https://github.com/tchap", "followers_url": "https://api.github.com/users/tchap/followers", "following_url": "https://api.github.com/users/tchap/following{/other_user}", "gists_url": "https://api.github.com/users/tchap/gists{/gist_id}", "starred_url": "https://api.github.com/users/tchap/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tchap/subscriptions", "organizations_url": "https://api.github.com/users/tchap/orgs", "repos_url": "https://api.github.com/users/tchap/repos", "events_url": "https://api.github.com/users/tchap/events{/privacy}", "received_events_url": "https://api.github.com/users/tchap/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 6375061, "node_id": "MDU6TGFiZWw2Mzc1MDYx", "url": "https://api.github.com/repos/mgedmin/profilehooks/labels/invalid", "name": "invalid", "color": "e6e6e6", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-03-23T16:44:47Z", "updated_at": "2020-07-22T11:21:04Z", "closed_at": "2017-04-07T18:49:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am getting the following error when using `profilehooks`:\r\n\r\n```\r\n*** PROFILER RESULTS ***\r\nget_stream_data (/src/services/public_api/public_api/handlers/streams.py:109)\r\nfunction called 2 times\r\n\r\nError in atexit._run_exitfuncs:\r\nTraceback (most recent call last):\r\n  File \"/venvs/public_api/lib/python3.6/site-packages/profilehooks.py\", line 392, in atexit\r\n    self.print_stats()\r\n  File \"/venvs/public_api/lib/python3.6/site-packages/profilehooks.py\", line 376, in print_stats\r\n    stats.print_stats(self.entries)\r\n  File \"/usr/local/lib/python3.6/pstats.py\", line 336, in print_stats\r\n    print(indent, self.total_calls, \"function calls\", end=' ', file=self.stream)\r\n  File \"/venvs/public_api/lib/python3.6/site-packages/_pytest/capture.py\", line 231, in write\r\n    self.buffer.write(obj)\r\nValueError: I/O operation on closed file\r\n```\r\n\r\nBasically I just imported `profile` and decorated a single function. It is a request handler and it is running during tests in a Docker container.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/12", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/12/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/12/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/12/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/12", "id": 216018007, "node_id": "MDU6SXNzdWUyMTYwMTgwMDc=", "number": 12, "title": "Show full module path in the report", "user": {"login": "mindojo-victor", "id": 17159503, "node_id": "MDQ6VXNlcjE3MTU5NTAz", "avatar_url": "https://avatars1.githubusercontent.com/u/17159503?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mindojo-victor", "html_url": "https://github.com/mindojo-victor", "followers_url": "https://api.github.com/users/mindojo-victor/followers", "following_url": "https://api.github.com/users/mindojo-victor/following{/other_user}", "gists_url": "https://api.github.com/users/mindojo-victor/gists{/gist_id}", "starred_url": "https://api.github.com/users/mindojo-victor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mindojo-victor/subscriptions", "organizations_url": "https://api.github.com/users/mindojo-victor/orgs", "repos_url": "https://api.github.com/users/mindojo-victor/repos", "events_url": "https://api.github.com/users/mindojo-victor/events{/privacy}", "received_events_url": "https://api.github.com/users/mindojo-victor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 163609450, "node_id": "MDU6TGFiZWwxNjM2MDk0NTA=", "url": "https://api.github.com/repos/mgedmin/profilehooks/labels/documentation", "name": "documentation", "color": "eb6420", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2017-03-22T10:38:16Z", "updated_at": "2017-03-23T11:06:42Z", "closed_at": "2017-03-23T11:06:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a report using `@profilehooks.profile(immediate=True)` like:\r\n```\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n        1    0.000    0.000  515.455  515.455 map.py:17(list)\r\n        1    0.000    0.000  515.454  515.454 sections.py:348(make_sections)\r\n        1    0.026    0.026  515.454  515.454 sections.py:251(_make_user_sections)\r\n     1983    0.030    0.000  478.347    0.241 sections.py:33(_make_entity_dict)\r\n      133    0.001    0.000  478.004    3.594 network.py:134(receive_message)\r\n      266    0.063    0.000  478.002    1.797 network.py:160(_receive_data_on_socket)\r\n      297  477.939    1.609  477.939    1.609 {method 'recv' of '_socket.socket' objects}\r\n     2040    0.012    0.000  477.909    0.234 simtest.py:452(exclude_simtests_tasks)\r\n     2040    0.002    0.000  477.853    0.234 simtest.py:276(get_played_in_simtests)\r\n       99    0.001    0.000  477.845    4.827 base.py:1102(aggregate)\r\n       99    0.003    0.000  477.843    4.827 collection.py:1756(aggregate)\r\n      110    0.001    0.000  477.820    4.344 collection.py:188(_command)\r\n      110    0.001    0.000  477.819    4.344 pool.py:373(command)\r\n      111    0.002    0.000  477.818    4.305 network.py:48(command)\r\n333371/305800    0.146    0.000  296.635    0.001 utils.py:68(__get__)\r\n        1    0.000    0.000  295.567  295.567 user_course_state.py:653(practice_tasks_by_arena)\r\n        1    0.001    0.001  295.555  295.555 user_course_state.py:659(<dictcomp>)\r\n     1981    0.007    0.000  182.455    0.092 user_course_state.py:630(practice_tasks_for_entity)\r\n231870/187242    0.075    0.000   35.112    0.000 course_cache.py:66(fget)\r\n        1    0.000    0.000   34.887   34.887 course_cache.py:710(entities_for_user)\r\n        1    0.011    0.011   34.875   34.875 course_cache.py:404(entities)\r\n        1    0.020    0.020   34.850   34.850 course_cache.py:393(all_entities)\r\n    13571    0.075    0.000   34.843    0.003 base.py:1401(__next__)\r\n123842/13559    1.975    0.000   34.007    0.003 document.py:670(_from_son)\r\n   126076    3.902    0.000   29.391    0.000 document.py:36(__init__)\r\n51033/27261    0.386    0.000   27.535    0.001 fields.py:287(to_python)\r\n40510/24726    0.175    0.000   27.044    0.001 fields.py:305(<dictcomp>)\r\n   110283    0.308    0.000   26.900    0.000 fields.py:544(to_python)\r\n   110283    0.411    0.000   23.778    0.000 document.py:62(__init__)\r\n       11    0.013    0.001   23.283    2.117 __init__.py:155(__new__)\r\n        1    0.000    0.000   22.908   22.908 course_cache.py:751(all_tasks)\r\n    10348    0.053    0.000   22.897    0.002 course_cache.py:757(<genexpr>)\r\n3342922/1787946    2.141    0.000   12.540    0.000 {built-in method builtins.setattr}\r\n3025025/2914739    4.282    0.000   12.127    0.000 document.py:144(__setattr__)\r\n        1    0.023    0.023   11.886   11.886 course_cache.py:394(<dictcomp>)\r\n2071925/1209519    1.486    0.000    8.082    0.000 {built-in method builtins.getattr}\r\n  1554976    3.056    0.000    7.954    0.000 fields.py:112(__set__)\r\n  1061525    0.798    0.000    6.957    0.000 fields.py:102(__get__)\r\n  1106899    1.426    0.000    6.208    0.000 datastructures.py:399(get)\r\n  1207854    1.687    0.000    4.835    0.000 datastructures.py:385(__getitem__)\r\n```\r\nMany of the module names are too broad -- not clear which frameworks they are part of. Why not showing full module path?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/6", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/6/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/6/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/6/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/6", "id": 75869263, "node_id": "MDU6SXNzdWU3NTg2OTI2Mw==", "number": 6, "title": "detox fails because tests hardcode profile file names", "user": {"login": "mgedmin", "id": 159967, "node_id": "MDQ6VXNlcjE1OTk2Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/159967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mgedmin", "html_url": "https://github.com/mgedmin", "followers_url": "https://api.github.com/users/mgedmin/followers", "following_url": "https://api.github.com/users/mgedmin/following{/other_user}", "gists_url": "https://api.github.com/users/mgedmin/gists{/gist_id}", "starred_url": "https://api.github.com/users/mgedmin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mgedmin/subscriptions", "organizations_url": "https://api.github.com/users/mgedmin/orgs", "repos_url": "https://api.github.com/users/mgedmin/repos", "events_url": "https://api.github.com/users/mgedmin/events{/privacy}", "received_events_url": "https://api.github.com/users/mgedmin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2015-05-13T06:38:14Z", "updated_at": "2015-07-16T09:14:06Z", "closed_at": "2015-07-16T09:14:06Z", "author_association": "OWNER", "active_lock_reason": null, "body": "```\nmg@platonas: ~/src/projects/profilehooks [git:master $=] $ detox\npy26 create: /home/mg/src/profilehooks/.tox/py26\nGLOB sdist-make: /home/mg/src/profilehooks/setup.py\npy27 create: /home/mg/src/profilehooks/.tox/py27\npy32 create: /home/mg/src/profilehooks/.tox/py32\npy33 create: /home/mg/src/profilehooks/.tox/py33\npy34 create: /home/mg/src/profilehooks/.tox/py34\npypy create: /home/mg/src/profilehooks/.tox/pypy\npy26 inst: /home/mg/src/profilehooks/.tox/dist/profilehooks-1.8.1.dev0.zip\npy27 inst: /home/mg/src/profilehooks/.tox/dist/profilehooks-1.8.1.dev0.zip\npy32 inst: /home/mg/src/profilehooks/.tox/dist/profilehooks-1.8.1.dev0.zip\npy33 inst: /home/mg/src/profilehooks/.tox/dist/profilehooks-1.8.1.dev0.zip\npy34 inst: /home/mg/src/profilehooks/.tox/dist/profilehooks-1.8.1.dev0.zip\npy26 runtests: PYTHONHASHSEED='3440945571'       \npy26 runtests: commands[0] | python test_profilehooks.py\npy27 runtests: PYTHONHASHSEED='3440945571'       \npy27 runtests: commands[0] | python test_profilehooks.py\nERROR: invocation failed (exit code 1), logfile: /home/mg/src/profilehooks/.tox/py27/log/py27-2.log\nERROR: actionid: py27\nmsg: runtests\ncmdargs: [local('/home/mg/src/profilehooks/.tox/py27/bin/python'), 'test_profilehooks.py']\nenv: {'PATH': '/home/mg/src/profilehooks/.tox/py27/bin:/home/mg/src/profilehooks/.tox/py26/bin:/home/mg/bin:/home/mg/.venv/bin:/home/mg/.local/bin:/home/mg/bin:/home/mg/bin/local:/home/mg/.venv/bin:/home/mg/.local/bin:/home/mg/android/platform-tools:/home/mg/android/tools:/usr/lib/ccache:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games', 'VIRTUAL_ENV': '/home/mg/src/profilehooks/.tox/py27', 'PYTHONHASHSEED': '3440945571'}\n\n..E..............\n======================================================================\nERROR: test_coverage (__main__.TestCoverageWithHotShot)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"test_profilehooks.py\", line 102, in test_coverage\n    run_exitfuncs()\n  File \"test_profilehooks.py\", line 37, in run_exitfuncs\n    fn(*args, **kw)\n  File \"/home/mg/src/profilehooks/profilehooks.py\", line 520, in atexit\n    reader = hotshot.log.LogReader(self.logfilename)\n  File \"/usr/lib/python2.7/hotshot/log.py\", line 30, in __init__\n    self._reader = _hotshot.logreader(logfn)\nIOError: [Errno 2] No such file or directory: 'sample_fn.cprof'\n\n----------------------------------------------------------------------\nRan 17 tests in 0.154s\n\nFAILED (errors=1)\n\nERROR: InvocationError: /home/mg/src/profilehooks/.tox/py27/bin/python test_profilehooks.py (see /home/mg/src/profilehooks/.tox/py27/log/py27-2.log)\npy34 runtests: PYTHONHASHSEED='3440945571'                  \npy34 runtests: commands[0] | python test_profilehooks.py\npy33 runtests: PYTHONHASHSEED='3440945571'\npy33 runtests: commands[0] | python test_profilehooks.py\npy32 runtests: PYTHONHASHSEED='3440945571'\npy32 runtests: commands[0] | python test_profilehooks.py\npypy inst: /home/mg/src/profilehooks/.tox/dist/profilehooks-1.8.1.dev0.zip\npypy runtests: PYTHONHASHSEED='3440945571'\npypy runtests: commands[0] | python test_profilehooks.py\n______________________________________________________________________ summary _______________________________________________________________________\n  py26: commands succeeded\nERROR:   py27: commands failed\n  py32: commands succeeded\n  py33: commands succeeded\n  py34: commands succeeded\n  pypy: commands succeeded\n\n[14s, exited with 1]\n```\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/5", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/5/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/5/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/5", "id": 53431266, "node_id": "MDU6SXNzdWU1MzQzMTI2Ng==", "number": 5, "title": "suggested enhancement: option to turn off output to stdout", "user": {"login": "lebedov", "id": 218546, "node_id": "MDQ6VXNlcjIxODU0Ng==", "avatar_url": "https://avatars1.githubusercontent.com/u/218546?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lebedov", "html_url": "https://github.com/lebedov", "followers_url": "https://api.github.com/users/lebedov/followers", "following_url": "https://api.github.com/users/lebedov/following{/other_user}", "gists_url": "https://api.github.com/users/lebedov/gists{/gist_id}", "starred_url": "https://api.github.com/users/lebedov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lebedov/subscriptions", "organizations_url": "https://api.github.com/users/lebedov/orgs", "repos_url": "https://api.github.com/users/lebedov/repos", "events_url": "https://api.github.com/users/lebedov/events{/privacy}", "received_events_url": "https://api.github.com/users/lebedov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 6375060, "node_id": "MDU6TGFiZWw2Mzc1MDYw", "url": "https://api.github.com/repos/mgedmin/profilehooks/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2015-01-05T19:12:19Z", "updated_at": "2015-01-20T18:12:19Z", "closed_at": "2015-01-20T16:05:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "It would be nice to be able to turn off all output to stdout in situations when one only wishes to save profiling data to a file, e.g., for long-running programs that don't emit output by default.\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/mgedmin/profilehooks/issues/2", "repository_url": "https://api.github.com/repos/mgedmin/profilehooks", "labels_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/2/labels{/name}", "comments_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/2/comments", "events_url": "https://api.github.com/repos/mgedmin/profilehooks/issues/2/events", "html_url": "https://github.com/mgedmin/profilehooks/issues/2", "id": 21021163, "node_id": "MDU6SXNzdWUyMTAyMTE2Mw==", "number": 2, "title": "Remove usage of sys.maxint", "user": {"login": "cezarsl", "id": 1081930, "node_id": "MDQ6VXNlcjEwODE5MzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/1081930?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cezarsl", "html_url": "https://github.com/cezarsl", "followers_url": "https://api.github.com/users/cezarsl/followers", "following_url": "https://api.github.com/users/cezarsl/following{/other_user}", "gists_url": "https://api.github.com/users/cezarsl/gists{/gist_id}", "starred_url": "https://api.github.com/users/cezarsl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cezarsl/subscriptions", "organizations_url": "https://api.github.com/users/cezarsl/orgs", "repos_url": "https://api.github.com/users/cezarsl/repos", "events_url": "https://api.github.com/users/cezarsl/events{/privacy}", "received_events_url": "https://api.github.com/users/cezarsl/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "mgedmin", "id": 159967, "node_id": "MDQ6VXNlcjE1OTk2Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/159967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mgedmin", "html_url": "https://github.com/mgedmin", "followers_url": "https://api.github.com/users/mgedmin/followers", "following_url": "https://api.github.com/users/mgedmin/following{/other_user}", "gists_url": "https://api.github.com/users/mgedmin/gists{/gist_id}", "starred_url": "https://api.github.com/users/mgedmin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mgedmin/subscriptions", "organizations_url": "https://api.github.com/users/mgedmin/orgs", "repos_url": "https://api.github.com/users/mgedmin/repos", "events_url": "https://api.github.com/users/mgedmin/events{/privacy}", "received_events_url": "https://api.github.com/users/mgedmin/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mgedmin", "id": 159967, "node_id": "MDQ6VXNlcjE1OTk2Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/159967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mgedmin", "html_url": "https://github.com/mgedmin", "followers_url": "https://api.github.com/users/mgedmin/followers", "following_url": "https://api.github.com/users/mgedmin/following{/other_user}", "gists_url": "https://api.github.com/users/mgedmin/gists{/gist_id}", "starred_url": "https://api.github.com/users/mgedmin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mgedmin/subscriptions", "organizations_url": "https://api.github.com/users/mgedmin/orgs", "repos_url": "https://api.github.com/users/mgedmin/repos", "events_url": "https://api.github.com/users/mgedmin/events{/privacy}", "received_events_url": "https://api.github.com/users/mgedmin/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2013-10-15T14:50:33Z", "updated_at": "2013-10-16T16:20:28Z", "closed_at": "2013-10-16T16:15:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "In `FuncSource.find_code_lines()` there is a mention of sys.maxint. This doesn't work on Python 3.\nSince the actual value is not used, I suggest replacing it with a hardcoded `2 ** 31 - 1`, which will work on all versions of Python (`sys.maxint` is guaranteed to be at least that)\n\n``` python\n    def find_source_lines(self):\n        \"\"\"Mark all executable source lines in fn as executed 0 times.\"\"\"\n        strs = trace.find_strings(self.filename)\n        lines = trace.find_lines_from_code(self.fn.__code__, strs)\n        self.firstcodelineno = sys.maxint # replace here\n        for lineno in lines:\n            self.firstcodelineno = min(self.firstcodelineno, lineno)\n            self.sourcelines.setdefault(lineno, 0)\n        if self.firstcodelineno == sys.maxint: # and here\n            self.firstcodelineno = self.firstlineno\n```\n\nP.S. If I'm not mistaken, and `firstlineno` is included in the set `lines`, then you can remove the lines that depend on that assignment : \n\n``` python\n    def find_source_lines(self):\n        \"\"\"Mark all executable source lines in fn as executed 0 times.\"\"\"\n        strs = trace.find_strings(self.filename)\n        lines = trace.find_lines_from_code(self.fn.__code__, strs)\n        for lineno in lines:\n            self.firstcodelineno = min(self.firstcodelineno, lineno)\n            self.sourcelines.setdefault(lineno, 0)\n```\n", "performed_via_github_app": null, "score": 1.0}]}