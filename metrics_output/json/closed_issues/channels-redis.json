{"total_count": 204, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/django/daphne/issues/321", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/321/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/321/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/321/events", "html_url": "https://github.com/django/daphne/issues/321", "id": 628481183, "node_id": "MDU6SXNzdWU2Mjg0ODExODM=", "number": 321, "title": "--fd 0 , File descriptor Flag error while configuring Daphne for supervisor", "user": {"login": "yashrajvanshi", "id": 51058270, "node_id": "MDQ6VXNlcjUxMDU4Mjcw", "avatar_url": "https://avatars3.githubusercontent.com/u/51058270?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yashrajvanshi", "html_url": "https://github.com/yashrajvanshi", "followers_url": "https://api.github.com/users/yashrajvanshi/followers", "following_url": "https://api.github.com/users/yashrajvanshi/following{/other_user}", "gists_url": "https://api.github.com/users/yashrajvanshi/gists{/gist_id}", "starred_url": "https://api.github.com/users/yashrajvanshi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yashrajvanshi/subscriptions", "organizations_url": "https://api.github.com/users/yashrajvanshi/orgs", "repos_url": "https://api.github.com/users/yashrajvanshi/repos", "events_url": "https://api.github.com/users/yashrajvanshi/events{/privacy}", "received_events_url": "https://api.github.com/users/yashrajvanshi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-01T14:28:41Z", "updated_at": "2020-06-02T09:32:31Z", "closed_at": "2020-06-02T08:03:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "**settings at :/etc/supervisor/conf.d/odm.conf**\r\n\r\n[program:odmasgi]\r\n\r\nsocket=tcp://localhost:8001\r\n\r\ndirectory=/home/yashrajvanshi/ODM/ODM/offdutyservice/\r\n\r\n**command=/home/yashrajvanshi/ODM/virtual/bin/daphne -u /run/daphne/daphne%(process_num)d.sock --fd 0 --access-log - --proxy-headers config.asgi:application**\r\n\r\nnumprocs=4\r\n\r\nprocess_name=asgi%(process_num)d\r\nautostart=true\r\nautorestart=true\r\n\r\nstdout_logfile=/home/yashrajvanshi/Desktop/odm-ws.log\r\nredirect_stderr=true\r\n~                                                                                                                                                                               \r\n~\r\n\r\nRunning Above settings:\r\nThrowing this error in odm-ws.log file\r\n_Environ is...\r\nconfig.settings.chat_settings\r\n<channels.routing.ProtocolTypeRouter object at 0x7f44f55d8f98>\r\n2020-06-01 13:58:44,130 INFO     Starting server at fd:fileno=0, unix:/tmp/daphne/daphne3.sock\r\n2020-06-01 13:58:44,131 INFO     HTTP/2 support enabled\r\n2020-06-01 13:58:44,131 INFO     Configuring endpoint fd:fileno=0\r\n2020-06-01 13:58:44,139 CRITICAL Listen failure: [Errno 88] Socket operation on non-socket\r\n2020-06-01 13:58:44,139 INFO     Configuring endpoint unix:/tmp/daphne/daphne3.sock_     \r\n\r\n\r\nAfter removing --fd , Process runs smoothly.\r\n                          ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/320", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/320/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/320/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/320/events", "html_url": "https://github.com/django/daphne/issues/320", "id": 610187307, "node_id": "MDU6SXNzdWU2MTAxODczMDc=", "number": 320, "title": "daphne can't find custom django apps", "user": {"login": "PhilBusko", "id": 13374003, "node_id": "MDQ6VXNlcjEzMzc0MDAz", "avatar_url": "https://avatars2.githubusercontent.com/u/13374003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilBusko", "html_url": "https://github.com/PhilBusko", "followers_url": "https://api.github.com/users/PhilBusko/followers", "following_url": "https://api.github.com/users/PhilBusko/following{/other_user}", "gists_url": "https://api.github.com/users/PhilBusko/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilBusko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilBusko/subscriptions", "organizations_url": "https://api.github.com/users/PhilBusko/orgs", "repos_url": "https://api.github.com/users/PhilBusko/repos", "events_url": "https://api.github.com/users/PhilBusko/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilBusko/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-30T16:01:34Z", "updated_at": "2020-06-10T18:07:11Z", "closed_at": "2020-06-10T18:07:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm running a django website with channels, so I need to deploy it with daphne. When I use 'python manage.py runserver' on my local it works. The websocket connection from the frontend works as expected. However running on daphne it errors out.\r\n\r\n**command run**:\r\ndaphne -b 0.0.0.0 backend.app_proj.asgi:application\r\n\r\n**error output:** \r\nTraceback (most recent call last):\r\n  File \"C:\\Program Files\\Python38\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    return _run_code(code, main_globals, None,\r\n  File \"C:\\Program Files\\Python38\\lib\\runpy.py\", line 86, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\Projects\\InjuryCheck\\v1\\Scripts\\daphne.exe\\__main__.py\", line 7, in <module>\r\n  File \"c:\\projects\\injurycheck\\v1\\lib\\site-packages\\daphne\\cli.py\", line 191, in entrypoint\r\n    cls().run(sys.argv[1:])\r\n  File \"c:\\projects\\injurycheck\\v1\\lib\\site-packages\\daphne\\cli.py\", line 252, in run\r\n    application = import_by_path(args.application)\r\n  File \"c:\\projects\\injurycheck\\v1\\lib\\site-packages\\daphne\\utils.py\", line 12, in import_by_path\r\n    target = importlib.import_module(module_path)\r\n  File \"C:\\Program Files\\Python38\\lib\\importlib\\__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1014, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 991, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 975, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 671, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 783, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \".\\backend\\app_proj\\asgi.py\", line 8, in <module>\r\n    application = get_asgi_application()\r\n  File \"c:\\projects\\injurycheck\\v1\\lib\\site-packages\\django\\core\\asgi.py\", line 12, in get_asgi_application\r\n    django.setup(set_prefix=False)\r\n  File \"c:\\projects\\injurycheck\\v1\\lib\\site-packages\\django\\__init__.py\", line 24, in setup\r\n    apps.populate(settings.INSTALLED_APPS)\r\n  File \"c:\\projects\\injurycheck\\v1\\lib\\site-packages\\django\\apps\\registry.py\", line 91, in populate\r\n    app_config = AppConfig.create(entry)\r\n  File \"c:\\projects\\injurycheck\\v1\\lib\\site-packages\\django\\apps\\config.py\", line 90, in create\r\n    module = import_module(entry)\r\n  File \"C:\\Program Files\\Python38\\lib\\importlib\\__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1014, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 991, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 973, in _find_and_load_unlocked\r\nModuleNotFoundError: No module named 'pipeline'\r\n\r\n**pipeline custom app**\r\n'pipeline' is a django app created with `python manage.py startapp pipeline`. And it works on runserver command. \r\n\r\n**environment:**\r\nOS: Windows 10 and GCP App Engine Linux\r\nPython: 3.8.2, also tried 3.7 on GCP\r\n\r\n**`pip freeze`** :\r\naioredis==1.3.1\r\nasgiref==3.2.7\r\nasync-timeout==3.0.1\r\nautobahn==20.4.3\r\nAutomat==20.2.0\r\ncertifi==2020.4.5.1\r\ncffi==1.14.0\r\nchannels==2.4.0\r\nchannels-redis==2.4.2\r\nchardet==3.0.4\r\nconstantly==15.1.0\r\ncryptography==2.9.2\r\ndaphne==2.5.0\r\nDjango==3.0.5\r\ndjango-cors-headers==3.2.1\r\ndjango-extensions==2.2.9\r\ndjangorestframework==3.11.0\r\ngunicorn==20.0.4\r\nhiredis==1.0.1\r\nhyperlink==19.0.0\r\nidna==2.9\r\nincremental==17.5.0\r\nMarkupSafe==1.1.1\r\nmsgpack==0.6.2\r\npyasn1==0.4.8\r\npyasn1-modules==0.2.8\r\npycparser==2.20\r\nPyHamcrest==2.0.2\r\npyOpenSSL==19.1.0\r\npython-dateutil==2.8.1\r\npython-engineio==3.12.1\r\npython-socketio==4.5.1\r\npytz==2019.3\r\nrequests==2.23.0\r\nSend2Trash==1.5.0\r\nservice-identity==18.1.0\r\nsix==1.14.0\r\nsqlparse==0.3.1\r\nTwisted @ file:///C:/Projects/InjuryCheck/Twisted-20.3.0-cp38-cp38-win_amd64.whl # windows version\r\ntwisted==20.3.0                 # linux version\r\ntxaio==20.4.1\r\nurllib3==1.25.8\r\nzope.interface==5.1.0\r\n\r\n**Expected behavior:** for daphne to run django and websocket functionality to work. \r\n\r\n**Actual behavior:** Daphne fails to run because it errors out. Somehow it's not able to find a custom app listed in INSTALLED_APPS. \r\n\r\nINSTALLED_APPS = [\r\n    # django base\r\n    'django.contrib.admin',\r\n    'django.contrib.auth',\r\n    'django.contrib.contenttypes',\r\n    'django.contrib.sessions',\r\n    'django.contrib.messages',\r\n    'django.contrib.staticfiles',\r\n\t# installed packages\r\n\t'rest_framework',\r\n    'corsheaders',\r\n    'channels',\r\n    # custom apps\r\n    'pipeline', \r\n]\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/318", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/318/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/318/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/318/events", "html_url": "https://github.com/django/daphne/issues/318", "id": 603410907, "node_id": "MDU6SXNzdWU2MDM0MTA5MDc=", "number": 318, "title": "Offloading SSL Certs to AWS ELB fails to establish websocket (404)", "user": {"login": "LiteWait", "id": 898285, "node_id": "MDQ6VXNlcjg5ODI4NQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/898285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LiteWait", "html_url": "https://github.com/LiteWait", "followers_url": "https://api.github.com/users/LiteWait/followers", "following_url": "https://api.github.com/users/LiteWait/following{/other_user}", "gists_url": "https://api.github.com/users/LiteWait/gists{/gist_id}", "starred_url": "https://api.github.com/users/LiteWait/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LiteWait/subscriptions", "organizations_url": "https://api.github.com/users/LiteWait/orgs", "repos_url": "https://api.github.com/users/LiteWait/repos", "events_url": "https://api.github.com/users/LiteWait/events{/privacy}", "received_events_url": "https://api.github.com/users/LiteWait/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-20T17:33:56Z", "updated_at": "2020-04-20T20:52:31Z", "closed_at": "2020-04-20T20:52:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using AWS ELB, I have been serving HTTP (via uwsgi) and websockets through Nginx with Nginx handling the SSL certs. \r\n\r\nOnce I tried to offloading SSL certs to the ELB so I could capture X-Forwarded-For, websockets fail to route/upgrade to Daphne and I get \"Not Found: /ws/\" in uwsgi's logs.\r\n\r\nHere is the relevant (working) piece of Nginx .conf file using TCP/443 pass thru from the ELB:\r\n\r\nlocation /ws {\r\n            proxy_pass http://unix:/opt/toogo/run/r117.0.4.3720.ws;   #Obviously daphne is listening here\r\n            proxy_set_header Upgrade $http_upgrade;\r\n            proxy_set_header Connection \"upgrade\";\r\n            proxy_http_version 1.1;\r\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n            proxy_set_header Host $host;\r\n    }\r\n\r\nWhat change is required if I offload the SSL certs to the ELB and introduce X-Forwarded-for?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/314", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/314/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/314/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/314/events", "html_url": "https://github.com/django/daphne/issues/314", "id": 597204572, "node_id": "MDU6SXNzdWU1OTcyMDQ1NzI=", "number": 314, "title": "Couldn't listen on  0.0.0.0:8000: [Errno -2] Name or service not known.", "user": {"login": "patvdleer", "id": 1138136, "node_id": "MDQ6VXNlcjExMzgxMzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1138136?v=4", "gravatar_id": "", "url": "https://api.github.com/users/patvdleer", "html_url": "https://github.com/patvdleer", "followers_url": "https://api.github.com/users/patvdleer/followers", "following_url": "https://api.github.com/users/patvdleer/following{/other_user}", "gists_url": "https://api.github.com/users/patvdleer/gists{/gist_id}", "starred_url": "https://api.github.com/users/patvdleer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/patvdleer/subscriptions", "organizations_url": "https://api.github.com/users/patvdleer/orgs", "repos_url": "https://api.github.com/users/patvdleer/repos", "events_url": "https://api.github.com/users/patvdleer/events{/privacy}", "received_events_url": "https://api.github.com/users/patvdleer/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-09T11:06:26Z", "updated_at": "2020-04-09T11:29:16Z", "closed_at": "2020-04-09T11:29:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "While running a pod in kubernetes I encountered the following:\r\n\r\n```\r\n daphne -b 0.0.0.0 -p 8000 config.asgi:application\r\n./config/settings/production.py:127: UserWarning: Mailgun and Sendgrid not enabled, using console logging\r\n  warn(\"Mailgun and Sendgrid not enabled, using console logging\")\r\nINFO 2020-04-09 13:01:29,777 cli 1 139895479084864 Starting server at tcp:port=8000:interface= 0.0.0.0\r\nINFO 2020-04-09 13:01:29,777 server 1 139895479084864 HTTP/2 support enabled\r\nINFO 2020-04-09 13:01:29,778 server 1 139895479084864 Configuring endpoint tcp:port=8000:interface= 0.0.0.0\r\nCRITICAL 2020-04-09 13:01:29,779 server 1 139895479084864 Listen failure: Couldn't listen on  0.0.0.0:8000: [Errno -2] Name or service not known. \r\n```\r\n\r\nPlease note that there is a space in front of 0.0.0.0, \r\nthis seems to originate from the Dockerfile\r\n`CMD [\"daphne\", \"-b 0.0.0.0\", \"-p 8000\" ,\"config.asgi:application\"]`\r\n\r\nMaybe add a str trim?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/313", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/313/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/313/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/313/events", "html_url": "https://github.com/django/daphne/issues/313", "id": 585783663, "node_id": "MDU6SXNzdWU1ODU3ODM2NjM=", "number": 313, "title": "Add an option for auto-reloading.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-22T18:38:15Z", "updated_at": "2020-03-23T02:44:35Z", "closed_at": "2020-03-23T02:44:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is a feature request.\r\n\r\nI want to add `--reload` option for auto-reloading. To detect the change of python files, the following implementation might be useful.\r\nhttps://github.com/kobinpy/kwsgi/blob/master/kwsgi/reloader.py\r\n\r\nCan I submit a pull request? If you don't have the motivation to add this feature, please feel free to close this issue.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/312", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/312/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/312/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/312/events", "html_url": "https://github.com/django/daphne/issues/312", "id": 580134410, "node_id": "MDU6SXNzdWU1ODAxMzQ0MTA=", "number": 312, "title": "kubernetes command fix", "user": {"login": "grusirna", "id": 10393158, "node_id": "MDQ6VXNlcjEwMzkzMTU4", "avatar_url": "https://avatars2.githubusercontent.com/u/10393158?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grusirna", "html_url": "https://github.com/grusirna", "followers_url": "https://api.github.com/users/grusirna/followers", "following_url": "https://api.github.com/users/grusirna/following{/other_user}", "gists_url": "https://api.github.com/users/grusirna/gists{/gist_id}", "starred_url": "https://api.github.com/users/grusirna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grusirna/subscriptions", "organizations_url": "https://api.github.com/users/grusirna/orgs", "repos_url": "https://api.github.com/users/grusirna/repos", "events_url": "https://api.github.com/users/grusirna/events{/privacy}", "received_events_url": "https://api.github.com/users/grusirna/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-12T18:22:25Z", "updated_at": "2020-03-12T18:29:45Z", "closed_at": "2020-03-12T18:29:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**kubernetes res**\r\n      containers:\r\n        - name: xxx\r\n          image: xxx/xxx\r\n          ports:\r\n            - containerPort: 8000\r\n          command:\r\n            - daphne\r\n            - -b 0.0.0.0\r\n            - api:app\r\n\r\n**error**\r\n[api-774566f65b-mzz7s downloader] 2020-03-12 18:16:33,291 INFO     Configuring endpoint tcp:port=8000:**interface= 0.0.0.0**\r\n[api-774566f65b-mzz7s downloader] 2020-03-12 18:16:33,292 CRITICAL Listen failure: Couldn't listen on  0.0.0.0:8000: [Errno -2] Name or service not known.\r\n\r\n**look this**\r\ninterface= 0.0.0.0\r\nThis is strange.\r\n\r\n**fix**\r\n          command:\r\n            - daphne\r\n            - -b0.0.0.0\r\n            - api:app\r\n\r\nIt wasn't a big deal, though it took hours. Hopefully it can help other users avoid this problem.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/311", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/311/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/311/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/311/events", "html_url": "https://github.com/django/daphne/issues/311", "id": 578372589, "node_id": "MDU6SXNzdWU1NzgzNzI1ODk=", "number": 311, "title": "Windows Python 3.8 asyncio ProactorEventLoop NotImplementedError.", "user": {"login": "layabout4233629", "id": 51810421, "node_id": "MDQ6VXNlcjUxODEwNDIx", "avatar_url": "https://avatars3.githubusercontent.com/u/51810421?v=4", "gravatar_id": "", "url": "https://api.github.com/users/layabout4233629", "html_url": "https://github.com/layabout4233629", "followers_url": "https://api.github.com/users/layabout4233629/followers", "following_url": "https://api.github.com/users/layabout4233629/following{/other_user}", "gists_url": "https://api.github.com/users/layabout4233629/gists{/gist_id}", "starred_url": "https://api.github.com/users/layabout4233629/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/layabout4233629/subscriptions", "organizations_url": "https://api.github.com/users/layabout4233629/orgs", "repos_url": "https://api.github.com/users/layabout4233629/repos", "events_url": "https://api.github.com/users/layabout4233629/events{/privacy}", "received_events_url": "https://api.github.com/users/layabout4233629/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-10T06:51:35Z", "updated_at": "2020-03-11T01:00:27Z", "closed_at": "2020-03-10T12:57:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was leaning use channel in django.\r\nmy python enviroment:\r\npython3.8\r\nasgiref==2.3.2\r\nchannels==2.1.7\r\nchannels-redis==2.3.3\r\nDjango==1.11.7\r\nTwisted==19.10.0\r\n\r\nwhen I add app in setting, it always run errors as follow\uff1a\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\ASUS\\Desktop\\webs\\manage.py\", line 15, in <module>\r\n    execute_from_command_line(sys.argv)\r\n  File \"C:\\Python38\\lib\\site-packages\\django\\core\\management\\__init__.py\", line 364, in execute_from_command_line\r\n    utility.execute()\r\n  File \"C:\\Python38\\lib\\site-packages\\django\\core\\management\\__init__.py\", line 338, in execute\r\n    django.setup()\r\n  File \"C:\\Python38\\lib\\site-packages\\django\\__init__.py\", line 27, in setup\r\n    apps.populate(settings.INSTALLED_APPS)\r\n  File \"C:\\Python38\\lib\\site-packages\\django\\apps\\registry.py\", line 85, in populate\r\n    app_config = AppConfig.create(entry)\r\n  File \"C:\\Python38\\lib\\site-packages\\django\\apps\\config.py\", line 120, in create\r\n    mod = import_module(mod_path)\r\n  File \"C:\\Python38\\lib\\importlib\\__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1014, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 991, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 975, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 671, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 783, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"C:\\Python38\\lib\\site-packages\\channels\\apps.py\", line 6, in <module>\r\n    **import daphne.server**\r\n  File \"C:\\Python38\\lib\\site-packages\\daphne\\server.py\", line 17, in <module>\r\n    asyncioreactor.install()\r\n  File \"C:\\Python38\\lib\\site-packages\\twisted\\internet\\asyncioreactor.py\", line 320, in install\r\n    reactor = AsyncioSelectorReactor(eventloop)\r\n  File \"C:\\Python38\\lib\\site-packages\\twisted\\internet\\asyncioreactor.py\", line 69, in __init__\r\n    super().__init__()\r\n  File \"C:\\Python38\\lib\\site-packages\\twisted\\internet\\base.py\", line 571, in __init__\r\n    self.installWaker()\r\n  File \"C:\\Python38\\lib\\site-packages\\twisted\\internet\\posixbase.py\", line 286, in installWaker\r\n    self.addReader(self.waker)\r\n  File \"C:\\Python38\\lib\\site-packages\\twisted\\internet\\asyncioreactor.py\", line 151, in addReader\r\n    self._asyncioEventloop.add_reader(fd, callWithLogger, reader,\r\n  File \"C:\\Python38\\lib\\asyncio\\events.py\", line 501, in add_reader\r\n    raise NotImplementedError\r\nNotImplementedError", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/309", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/309/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/309/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/309/events", "html_url": "https://github.com/django/daphne/issues/309", "id": 562284355, "node_id": "MDU6SXNzdWU1NjIyODQzNTU=", "number": 309, "title": "Does daphne support multi-process?", "user": {"login": "Taikono-Himazin", "id": 25480502, "node_id": "MDQ6VXNlcjI1NDgwNTAy", "avatar_url": "https://avatars0.githubusercontent.com/u/25480502?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Taikono-Himazin", "html_url": "https://github.com/Taikono-Himazin", "followers_url": "https://api.github.com/users/Taikono-Himazin/followers", "following_url": "https://api.github.com/users/Taikono-Himazin/following{/other_user}", "gists_url": "https://api.github.com/users/Taikono-Himazin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Taikono-Himazin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Taikono-Himazin/subscriptions", "organizations_url": "https://api.github.com/users/Taikono-Himazin/orgs", "repos_url": "https://api.github.com/users/Taikono-Himazin/repos", "events_url": "https://api.github.com/users/Taikono-Himazin/events{/privacy}", "received_events_url": "https://api.github.com/users/Taikono-Himazin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-10T02:03:22Z", "updated_at": "2020-02-11T18:22:59Z", "closed_at": "2020-02-11T18:22:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "The words may be strange because they use Google translation. sorry.\r\n\r\nI'm asking a question because there are only a few articles about \"daphne\".\r\n**Does daphne support multi-process?**\r\nI originally thought to use uwsgi. However, due to complicated settings for websocekt using django channels, we will change uwsgi to daphne.\r\nI want to do parallel processing to handle a lot of accesses. However, I could not find the option to make it multi-processed and multi-threaded like uwsgi.\r\n\r\nAre there any options or equivalents for --processes or --threads in uwsgi?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/306", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/306/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/306/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/306/events", "html_url": "https://github.com/django/daphne/issues/306", "id": 553440461, "node_id": "MDU6SXNzdWU1NTM0NDA0NjE=", "number": 306, "title": "Custom TLS handshake with Daphne and Channels", "user": {"login": "MarcMueltin", "id": 4791110, "node_id": "MDQ6VXNlcjQ3OTExMTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/4791110?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarcMueltin", "html_url": "https://github.com/MarcMueltin", "followers_url": "https://api.github.com/users/MarcMueltin/followers", "following_url": "https://api.github.com/users/MarcMueltin/following{/other_user}", "gists_url": "https://api.github.com/users/MarcMueltin/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarcMueltin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarcMueltin/subscriptions", "organizations_url": "https://api.github.com/users/MarcMueltin/orgs", "repos_url": "https://api.github.com/users/MarcMueltin/repos", "events_url": "https://api.github.com/users/MarcMueltin/events{/privacy}", "received_events_url": "https://api.github.com/users/MarcMueltin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-22T10:17:44Z", "updated_at": "2020-01-22T10:39:41Z", "closed_at": "2020-01-22T10:39:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi there, \r\n\r\nI am trying to figure out how I can use Channels (and Daphne) to write an authentication code that can handle three different security profiles for a WebSocket connection:\r\n1. Unsecured Basic authentication headers (-> already works without problems)\r\n2. TLS with Basic authentication headers (-> causes me headaches)\r\n3. TLS with client-side certificate authentication (-> causes me headaches)\r\n\r\nI have a feeling that I would be able to do what I want with the custom authentication described here: https://channels.readthedocs.io/en/latest/topics/authentication.html#custom-authentication\r\n\r\nBut I am still stuck. I want to define exactly\r\n- which cipher suite the TLS server accepts\r\n- which elliptic curve the TLS server uses for ECDHE (Elliptic Curve Diffie-Hellman Ephemeral)\r\n- which ssl options to use (like \"no compression\")\r\n\r\nI've set up the WebSocket CLIENT with an SSLContext (https://docs.python.org/3.8/library/ssl.html) like this:\r\n\r\n```\r\nssl_context = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)\r\nssl_context.set_ciphers('ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384')\r\nssl_context.options |= ssl.OP_NO_COMPRESSION\r\nssl_context.set_ecdh_curve('prime256v1')\r\nssl_context.options |= ssl.OP_SINGLE_ECDH_USE\r\nsl_context.load_cert_chain(get_file(path_to_certchain), get_file(path_to_privatekey))\r\nssl_context.verify_mode = ssl.CERT_REQUIRED\r\nssl_context.load_verify_locations(get_file(path_to_cabundle))\r\n\r\nasync with websockets.client.connect(\r\n                uri=url,\r\n                extra_headers=header,\r\n                subprotocols=['some_subprotocol'],\r\n                ssl=ssl_context) as websocket:\r\n            global ws\r\n            ws = websocket\r\n            await asyncio.gather(on_open(websocket), on_message(websocket))\r\n```\r\n\r\n\r\nThe same way I set the SSLContext for the client, I want to set it for the TLS server, which somehow will be provided by the combination of Channels and Daphne. \r\n\r\nSo please, please tell me how I can achieve this. I've studied the Channels documentation for many hours but I can't seem to find a way to achieve what I want.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/305", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/305/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/305/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/305/events", "html_url": "https://github.com/django/daphne/issues/305", "id": 552631243, "node_id": "MDU6SXNzdWU1NTI2MzEyNDM=", "number": 305, "title": "Getting this error: ModuleNotFoundError: No module named 'asgiref.local'", "user": {"login": "prachisutane", "id": 60125922, "node_id": "MDQ6VXNlcjYwMTI1OTIy", "avatar_url": "https://avatars0.githubusercontent.com/u/60125922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prachisutane", "html_url": "https://github.com/prachisutane", "followers_url": "https://api.github.com/users/prachisutane/followers", "following_url": "https://api.github.com/users/prachisutane/following{/other_user}", "gists_url": "https://api.github.com/users/prachisutane/gists{/gist_id}", "starred_url": "https://api.github.com/users/prachisutane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prachisutane/subscriptions", "organizations_url": "https://api.github.com/users/prachisutane/orgs", "repos_url": "https://api.github.com/users/prachisutane/repos", "events_url": "https://api.github.com/users/prachisutane/events{/privacy}", "received_events_url": "https://api.github.com/users/prachisutane/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-21T05:21:47Z", "updated_at": "2020-02-05T19:27:26Z", "closed_at": "2020-02-05T19:27:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "File \"/home/user/myApp/venv/lib/python3.6/site-packages/django/db/utils.py\", line 4, in from asgiref.local import Local ModuleNotFoundError: No module named 'asgiref.local'\r\n\r\ncode looks like this:\r\n\r\nfrom asgiref.local import Local\r\n\r\nself._connections = Local(thread_critical=True)\r\n\r\nusing python3.6 on ubuntu 16 ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/304", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/304/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/304/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/304/events", "html_url": "https://github.com/django/daphne/issues/304", "id": 550816994, "node_id": "MDU6SXNzdWU1NTA4MTY5OTQ=", "number": 304, "title": "AttributeError: 'WebRequest' object has no attribute 'client_addr'", "user": {"login": "franck-charles", "id": 26493898, "node_id": "MDQ6VXNlcjI2NDkzODk4", "avatar_url": "https://avatars0.githubusercontent.com/u/26493898?v=4", "gravatar_id": "", "url": "https://api.github.com/users/franck-charles", "html_url": "https://github.com/franck-charles", "followers_url": "https://api.github.com/users/franck-charles/followers", "following_url": "https://api.github.com/users/franck-charles/following{/other_user}", "gists_url": "https://api.github.com/users/franck-charles/gists{/gist_id}", "starred_url": "https://api.github.com/users/franck-charles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/franck-charles/subscriptions", "organizations_url": "https://api.github.com/users/franck-charles/orgs", "repos_url": "https://api.github.com/users/franck-charles/repos", "events_url": "https://api.github.com/users/franck-charles/events{/privacy}", "received_events_url": "https://api.github.com/users/franck-charles/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-16T13:45:23Z", "updated_at": "2020-01-16T14:13:47Z", "closed_at": "2020-01-16T14:13:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI opened an issue on stackoverflow \"AttributeError: 'WebRequest' object has no attribute 'client_addr'\"\r\n\r\nhttps://stackoverflow.com/questions/59767291/attributeerror-webrequest-object-has-no-attribute-client-addr\r\n\r\nThanks,\r\nFranck\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/303", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/303/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/303/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/303/events", "html_url": "https://github.com/django/daphne/issues/303", "id": 548099469, "node_id": "MDU6SXNzdWU1NDgwOTk0Njk=", "number": 303, "title": "daphne ssl can not support supervisor  fcgi-program", "user": {"login": "pbxue", "id": 57752283, "node_id": "MDQ6VXNlcjU3NzUyMjgz", "avatar_url": "https://avatars0.githubusercontent.com/u/57752283?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pbxue", "html_url": "https://github.com/pbxue", "followers_url": "https://api.github.com/users/pbxue/followers", "following_url": "https://api.github.com/users/pbxue/following{/other_user}", "gists_url": "https://api.github.com/users/pbxue/gists{/gist_id}", "starred_url": "https://api.github.com/users/pbxue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pbxue/subscriptions", "organizations_url": "https://api.github.com/users/pbxue/orgs", "repos_url": "https://api.github.com/users/pbxue/repos", "events_url": "https://api.github.com/users/pbxue/events{/privacy}", "received_events_url": "https://api.github.com/users/pbxue/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-10T14:08:33Z", "updated_at": "2020-01-10T15:35:44Z", "closed_at": "2020-01-10T15:35:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "[fcgi-program:daphne]\r\nsocket=tcp://192.168.1.144:6443\r\ndirectory=/root/myproject\r\ncommand=daphne -e ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem --endpoint fd:fileno=0 --proxy-headers myproject.asgi:application\r\nnumprocs=4\r\nprocess_name=asgi%(process_num)d\r\nautostart=true\r\nautorestart=true\r\nstdout_logfile=/root/myproject/log.log\r\n\r\n2020-01-07 17:54:33,485 INFO Starting server at fd:fileno=0, ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 17:54:33,497 INFO HTTP/2 support enabled\r\n2020-01-07 17:54:33,497 INFO Configuring endpoint fd:fileno=0\r\n2020-01-07 17:54:33,492 INFO Starting server at fd:fileno=0, ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 17:54:33,493 INFO HTTP/2 support enabled\r\n2020-01-07 17:54:33,493 INFO Configuring endpoint fd:fileno=0\r\n2020-01-07 17:54:33,518 INFO Listening on TCP address 192.168.1.144:6443\r\n2020-01-07 17:54:33,530 INFO Configuring endpoint ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 17:54:33,536 INFO Listening on TCP address 0.0.0.0:34160\r\n2020-01-07 17:54:33,532 INFO Listening on TCP address 192.168.1.144:6443\r\n2020-01-07 17:54:33,532 INFO Configuring endpoint ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 17:54:33,537 INFO Listening on TCP address 0.0.0.0:44704\r\n2020-01-07 17:54:33,542 INFO Starting server at fd:fileno=0, ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 17:54:33,543 INFO HTTP/2 support enabled\r\n2020-01-07 17:54:33,543 INFO Configuring endpoint fd:fileno=0\r\n2020-01-07 17:54:33,557 INFO Listening on TCP address 192.168.1.144:6443\r\n2020-01-07 17:54:33,557 INFO Configuring endpoint ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 17:54:33,560 INFO Starting server at fd:fileno=0, ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 17:54:33,561 INFO HTTP/2 support enabled\r\n2020-01-07 17:54:33,561 INFO Configuring endpoint fd:fileno=0\r\n2020-01-07 17:54:33,565 INFO Listening on TCP address 0.0.0.0:43185\r\n2020-01-07 17:54:33,577 INFO Listening on TCP address 192.168.1.144:6443\r\n2020-01-07 17:54:33,577 INFO Configuring endpoint ssl:0:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 17:54:33,582 INFO Listening on TCP address 0.0.0.0:44572\r\n\r\n[root@localhost myproject]# lsof -i:6443\r\nCOMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME\r\nsuperviso 19525 root 6u IPv4 501483 0t0 TCP localhost.localdomain:sun-sr-https (LISTEN)\r\ndaphne 38865 root 11u IPv4 501483 0t0 TCP localhost.localdomain:sun-sr-https (LISTEN)\r\ndaphne 38866 root 11u IPv4 501483 0t0 TCP localhost.localdomain:sun-sr-https (LISTEN)\r\ndaphne 38867 root 11u IPv4 501483 0t0 TCP localhost.localdomain:sun-sr-https (LISTEN)\r\ndaphne 38868 root 11u IPv4 501483 0t0 TCP localhost.localdomain:sun-sr-https (LISTEN)\r\n\r\n\u542f\u52a8\u6b63\u5e38\uff0c\u7aef\u53e3\u663e\u793a\u7ed1\u5b9a\u4e86\u591a\u4e2ahttps\u8fdb\u7a0b\uff0c\u4f46\u662f\u65e0\u6cd5\u901a\u8fc7supervisor\u4ee3\u7406\u8bbf\u95ee\u670d\u52a1,\u8bf7\u6c42\u5361\u4e3b\u4e0d\u52a8\uff1a\r\n[root@localhost myproject]# curl -vvv https://192.168.1.144:6443/test/\r\n\r\nAbout to connect() to 192.168.1.144 port 6443 (#0)\r\nTrying 192.168.1.144...\r\nConnected to 192.168.1.144 (192.168.1.144) port 6443 (#0)\r\nInitializing NSS with certpath: sql:/etc/pki/nssdb\r\nCAfile: /etc/pki/tls/certs/ca-bundle.crt\r\nCApath: none\r\n^C\r\n[root@localhost myproject]# curl -vvv -i -k https://192.168.1.144:6443/test/\r\nAbout to connect() to 192.168.1.144 port 6443 (#0)\r\nTrying 192.168.1.144...\r\nConnected to 192.168.1.144 (192.168.1.144) port 6443 (#0)\r\nInitializing NSS with certpath: sql:/etc/pki/nssdb\r\n^C", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/302", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/302/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/302/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/302/events", "html_url": "https://github.com/django/daphne/issues/302", "id": 547264302, "node_id": "MDU6SXNzdWU1NDcyNjQzMDI=", "number": 302, "title": "supervisor \u5982\u4f55\u4ee3\u7406\u591a\u4e2adaphne\u7684ssl\u670d\u52a1\uff0c\u8bf7\u7ed9\u4e2a\u914d\u7f6e\u7684\u6837\u4f8b\u3002", "user": {"login": "pbxue", "id": 57752283, "node_id": "MDQ6VXNlcjU3NzUyMjgz", "avatar_url": "https://avatars0.githubusercontent.com/u/57752283?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pbxue", "html_url": "https://github.com/pbxue", "followers_url": "https://api.github.com/users/pbxue/followers", "following_url": "https://api.github.com/users/pbxue/following{/other_user}", "gists_url": "https://api.github.com/users/pbxue/gists{/gist_id}", "starred_url": "https://api.github.com/users/pbxue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pbxue/subscriptions", "organizations_url": "https://api.github.com/users/pbxue/orgs", "repos_url": "https://api.github.com/users/pbxue/repos", "events_url": "https://api.github.com/users/pbxue/events{/privacy}", "received_events_url": "https://api.github.com/users/pbxue/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-09T05:47:33Z", "updated_at": "2020-01-10T15:36:19Z", "closed_at": "2020-01-10T15:36:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "1. \u901a\u8fc7--fd 0\u7ed1\u5b9a\u76d1\u542c\u542f\u52a8\u591a\u4e2ahttp\u670d\u52a1\uff0c\u901a\u8fc7supervisor\u7684\u4ee3\u7406192.168.1.144:8443\u8bbf\u95eedaphne\u8fdb\u7a0b\uff0c\u8fd9\u4e2a\u6ca1\u6709\u95ee\u9898\r\n[fcgi-program:daphne]\r\nsocket=tcp://192.168.1.144:8443\r\ndirectory=/root/myproject\r\ncommand=daphne --proxy-headers --fd 0 myproject.asgi:application\r\nnumprocs=5\r\nautostart=true\r\nautorestart=true\r\nstdout_logfile=/root/myproject/log.log\r\n\r\n2020-01-07 09:11:38,600 INFO     Configuring endpoint fd:fileno=0\r\n2020-01-07 09:11:38,614 INFO     Listening on TCP address 192.168.1.144:6443\r\n2020-01-07 09:11:38,668 INFO     Starting server at fd:fileno=0\r\n2020-01-07 09:11:38,669 INFO     HTTP/2 support enabled\r\n2020-01-07 09:11:38,669 INFO     Configuring endpoint fd:fileno=0\r\n2020-01-07 09:11:38,679 INFO     Starting server at fd:fileno=0\r\n2020-01-07 09:11:38,683 INFO     Listening on TCP address 192.168.1.144:6443\r\n2020-01-07 09:11:38,680 INFO     HTTP/2 support enabled\r\n2020-01-07 09:11:38,680 INFO     Configuring endpoint fd:fileno=0\r\n2020-01-07 09:11:38,695 INFO     Listening on TCP address 192.168.1.144:6443\r\n\r\n\r\n2. \u4f46\u662f\u4e0b\u9762\u8fd9\u4e2a\u542f\u52a8\u591a\u4e2ahttps\u7684\u914d\u7f6e\u8981\u600e\u4e48\u5199\uff0c\u600e\u4e48\u6837\u624d\u53ef\u4ee5\u901a\u8fc7192.168.1.144:8443\u4ee3\u7406\u591a\u4e2ahttps\u7684daphne\u670d\u52a1\uff1f\r\n[fcgi-program:daphne]\r\nsocket=tcp://192.168.1.144:8443\r\ndirectory=/root/myproject\r\ncommand=daphne -e ssl:443:privateKey=server.pem:certKey=server.pem myproject.asgi:application\r\nnumprocs=5\r\nautostart=true\r\nautorestart=true\r\nstdout_logfile=/root/myproject/log.log\r\n\r\n\r\n2020-01-07 09:06:24,155 INFO     Configuring endpoint ssl:443:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 09:06:24,160 CRITICAL Listen failure: Couldn't listen on any:8443: [Errno 98] Address already in use.\r\n2020-01-07 09:06:24,161 INFO     Starting server at ssl:443:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 09:06:24,162 INFO     HTTP/2 support enabled\r\n2020-01-07 09:06:24,162 INFO     Configuring endpoint ssl:443:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 09:06:24,166 CRITICAL Listen failure: Couldn't listen on any:443: [Errno 98] Address already in use.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/301", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/301/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/301/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/301/events", "html_url": "https://github.com/django/daphne/issues/301", "id": 547262358, "node_id": "MDU6SXNzdWU1NDcyNjIzNTg=", "number": 301, "title": "supervisor \u5982\u4f55\u4ee3\u7406\u591a\u4e2adaphne\u7684ssl\u670d\u52a1\uff0c\u8bf7\u7ed9\u4e2a\u914d\u7f6e\u7684\u6837\u4f8b\u3002", "user": {"login": "pbxue", "id": 57752283, "node_id": "MDQ6VXNlcjU3NzUyMjgz", "avatar_url": "https://avatars0.githubusercontent.com/u/57752283?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pbxue", "html_url": "https://github.com/pbxue", "followers_url": "https://api.github.com/users/pbxue/followers", "following_url": "https://api.github.com/users/pbxue/following{/other_user}", "gists_url": "https://api.github.com/users/pbxue/gists{/gist_id}", "starred_url": "https://api.github.com/users/pbxue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pbxue/subscriptions", "organizations_url": "https://api.github.com/users/pbxue/orgs", "repos_url": "https://api.github.com/users/pbxue/repos", "events_url": "https://api.github.com/users/pbxue/events{/privacy}", "received_events_url": "https://api.github.com/users/pbxue/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-09T05:41:06Z", "updated_at": "2020-01-09T05:46:10Z", "closed_at": "2020-01-09T05:46:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "1. \u901a\u8fc7--fd 0\u7ed1\u5b9a\u76d1\u542c\u542f\u52a8\u591a\u4e2ahttp\u670d\u52a1\uff0c\u901a\u8fc7supervisor\u7684\u4ee3\u7406192.168.1.144:8443\u8bbf\u95eedaphne\u8fdb\u7a0b\uff0c\u8fd9\u4e2a\u6ca1\u6709\u95ee\u9898\r\n[fcgi-program:daphne]\r\nsocket=tcp://192.168.1.144:8443\r\ndirectory=/root/myproject\r\ncommand=daphne --proxy-headers --fd 0 myproject.asgi:application\r\nnumprocs=5\r\nautostart=true\r\nautorestart=true\r\nstdout_logfile=/root/myproject/log.log\r\n\r\n2020-01-07 09:11:38,600 INFO     Configuring endpoint fd:fileno=0\r\n2020-01-07 09:11:38,614 INFO     Listening on TCP address 192.168.1.144:6443\r\n2020-01-07 09:11:38,668 INFO     Starting server at fd:fileno=0\r\n2020-01-07 09:11:38,669 INFO     HTTP/2 support enabled\r\n2020-01-07 09:11:38,669 INFO     Configuring endpoint fd:fileno=0\r\n2020-01-07 09:11:38,679 INFO     Starting server at fd:fileno=0\r\n2020-01-07 09:11:38,683 INFO     Listening on TCP address 192.168.1.144:6443\r\n2020-01-07 09:11:38,680 INFO     HTTP/2 support enabled\r\n2020-01-07 09:11:38,680 INFO     Configuring endpoint fd:fileno=0\r\n2020-01-07 09:11:38,695 INFO     Listening on TCP address 192.168.1.144:6443\r\n\r\n\r\n2. \u4f46\u662f\u4e0b\u9762\u8fd9\u4e2a\u542f\u52a8\u591a\u4e2ahttps\u7684\u914d\u7f6e\u8981\u600e\u4e48\u5199\uff0c\u600e\u4e48\u6837\u624d\u53ef\u4ee5\u901a\u8fc7192.168.1.144:8443\u4ee3\u7406\u591a\u4e2ahttps\u7684daphne\u670d\u52a1\uff1f\r\n[fcgi-program:daphne]\r\nsocket=tcp://192.168.1.144:8443\r\ndirectory=/root/myproject\r\ncommand=daphne -e ssl:0:privateKey=server.pem:certKey=server.pem --proxy-headers  \r\n myproject.asgi:application\r\nnumprocs=5\r\nautostart=true\r\nautorestart=true\r\nstdout_logfile=/root/myproject/log.log\r\n\r\n\r\n2020-01-07 09:06:24,155 INFO     Configuring endpoint ssl:8443:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 09:06:24,160 CRITICAL Listen failure: Couldn't listen on any:8443: [Errno 98] Address already in use.\r\n2020-01-07 09:06:24,161 INFO     Starting server at ssl:8443:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 09:06:24,162 INFO     HTTP/2 support enabled\r\n2020-01-07 09:06:24,162 INFO     Configuring endpoint ssl:8443:privateKey=/root/myproject/myproject/key/server.pem:certKey=/root/myproject/myproject/key/server.pem\r\n2020-01-07 09:06:24,166 CRITICAL Listen failure: Couldn't listen on any:8443: [Errno 98] Address already in use.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/297", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/297/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/297/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/297/events", "html_url": "https://github.com/django/daphne/issues/297", "id": 544194574, "node_id": "MDU6SXNzdWU1NDQxOTQ1NzQ=", "number": 297, "title": "Can I use it in pypy?", "user": {"login": "Chise1", "id": 47511274, "node_id": "MDQ6VXNlcjQ3NTExMjc0", "avatar_url": "https://avatars0.githubusercontent.com/u/47511274?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Chise1", "html_url": "https://github.com/Chise1", "followers_url": "https://api.github.com/users/Chise1/followers", "following_url": "https://api.github.com/users/Chise1/following{/other_user}", "gists_url": "https://api.github.com/users/Chise1/gists{/gist_id}", "starred_url": "https://api.github.com/users/Chise1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Chise1/subscriptions", "organizations_url": "https://api.github.com/users/Chise1/orgs", "repos_url": "https://api.github.com/users/Chise1/repos", "events_url": "https://api.github.com/users/Chise1/events{/privacy}", "received_events_url": "https://api.github.com/users/Chise1/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-12-31T13:54:36Z", "updated_at": "2020-03-12T15:38:15Z", "closed_at": "2020-01-02T10:06:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Can I use it in pypy?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/293", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/293/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/293/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/293/events", "html_url": "https://github.com/django/daphne/issues/293", "id": 538300871, "node_id": "MDU6SXNzdWU1MzgzMDA4NzE=", "number": 293, "title": "Daphne process killed due to out of memory error", "user": {"login": "vaisaghvt", "id": 1639105, "node_id": "MDQ6VXNlcjE2MzkxMDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/1639105?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vaisaghvt", "html_url": "https://github.com/vaisaghvt", "followers_url": "https://api.github.com/users/vaisaghvt/followers", "following_url": "https://api.github.com/users/vaisaghvt/following{/other_user}", "gists_url": "https://api.github.com/users/vaisaghvt/gists{/gist_id}", "starred_url": "https://api.github.com/users/vaisaghvt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vaisaghvt/subscriptions", "organizations_url": "https://api.github.com/users/vaisaghvt/orgs", "repos_url": "https://api.github.com/users/vaisaghvt/repos", "events_url": "https://api.github.com/users/vaisaghvt/events{/privacy}", "received_events_url": "https://api.github.com/users/vaisaghvt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-12-16T09:51:22Z", "updated_at": "2019-12-17T13:36:52Z", "closed_at": "2019-12-17T13:36:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "**The issue**\r\n\r\nWe recently changed to django 2.x and channels. 2.2 from a system that has been running relatively stable on channels 1.x for almost 3 years now. Our tests did not show any issues when we were running django channels in our test servers. And even when we tried load testing with frequent requests, the errors were not unexpected i.e. there would be connections dropped and a few 502s and as soon as the load was cut off things would work fine. \r\n\r\nThis changed drastically when we deployed it in our prod environment. Our daphne process SIGKILLS every few minutes and as a result our websockets connections are extremely unstable and requires frequent reconnects. Our setup is such that we have an AWS ALB sitting in front of NGINX that directs all non-websockets traffic to a gunicorn process (which is pretty stable) and all websockets traffic to a daphne process. \r\n\r\nWe tried Uvicorn in the middle as well, howeer Uvicorn wouldn't sigkill itself but it was just as unresponsive. \r\n\r\nOur ELB logs show a steady stream of 502 errors. \r\n\r\nOn investigating into the logs its seems Daphne is being killed by supervisor because of an out of memory error. \r\n\r\nWe currently have about 1GB allotted to the ECS-task and channels capacity set as \r\n```\r\n\r\nCHANNEL_LAYERS = {\r\n    \"default\": {\r\n        \"BACKEND\": \"channels_redis.core.RedisChannelLayer\",\r\n        \"CONFIG\": {\r\n            \"hosts\": [(REDIS_HOST, int(REDIS_PORT))],\r\n            \"capacity\": 10000\r\n        }\r\n    },\r\n}\r\n```\r\n\r\n**Could you advice on if there is something obviously stupid about our configuration? Is the capacity impractical or the memory way too low for daphne?**\r\n\r\n**Requested background details**\r\n\r\n- Your OS and runtime environment, and browser if applicable\r\n\r\nRunning in a docker container, ecs-task on amazon linux-ami. The docker-container is build from `python:3.7-alpine3.10` as base\r\n\r\n- A `pip freeze` output showing your package versions\r\n\r\n```\r\naioredis==1.3.1\r\namqp==2.5.2\r\nappdirs==1.4.3\r\nargon2-cffi==16.3.0\r\nasgiref==3.2.3\r\nasync-timeout==3.0.1\r\nattrs==19.3.0\r\nautobahn==19.11.1\r\nAutomat==0.8.0\r\nawscli==1.16.303\r\nbilliard==3.6.1.0\r\nbleach==3.0.2\r\nblis==0.2.4\r\nboto3==1.9.101\r\nbotocore==1.12.253\r\ncached-property==1.5.1\r\ncelery==4.3.0\r\ncertifi==2019.11.28\r\ncffi==1.13.2\r\nchannels==2.2.0\r\nchannels-redis==2.4.0\r\nchardet==3.0.4\r\nClick==7.0\r\ncolorama==0.4.1\r\nConcurrentLogHandler==0.9.1\r\nconstantly==15.1.0\r\ncoverage==4.5.3\r\ncryptography==2.8\r\ncymem==2.0.3\r\nCython==0.29.14\r\ndaphne==2.4.0\r\ndefusedxml==0.6.0\r\nDjango==2.2.8\r\ndjango-activity-stream==0.8.0\r\ndjango-allauth==0.40.0\r\ndjango-allauth-2fa==0.6\r\ndjango-appconf==1.0.3\r\ndjango-avatar==4.1.0\r\ndjango-celery-beat==1.5.0\r\ndjango-celery-results==1.1.2\r\ndjango-cors-middleware==1.3.1\r\ndjango-debug-toolbar==1.9.1\r\ndjango-extensions==2.0.7\r\ndjango-guardian==1.4.9\r\ndjango-jsonfield==1.2.0\r\ndjango-jsonfield-compat==0.4.4\r\ndjango-oauth-toolkit==1.2.0\r\ndjango-otp==0.7.4\r\ndjango-otp-twilio==0.5.1\r\ndjango-prometheus==1.0.15\r\ndjango-redis==4.10.0\r\ndjango-storages==1.7.2\r\ndjango-test-plus==1.1.1\r\ndjango-timezone-field==4.0\r\ndjango-webpack-loader==0.6.0\r\ndjangorestframework==3.10.3\r\ndocutils==0.15.2\r\nen-core-web-md==2.1.0\r\nen-core-web-sm==2.1.0\r\nfactory-boy==2.11.1\r\nFaker==3.0.0\r\ngunicorn==20.0.4\r\nh11==0.8.1\r\nhiredis==1.0.1\r\nhttptools==0.0.13\r\nhunspell==0.5.0\r\nhyperlink==19.0.0\r\nidna==2.8\r\nincremental==17.5.0\r\nisodate==0.6.0\r\nitsdangerous==0.24\r\njieba==0.39\r\njmespath==0.9.4\r\njoblib==0.14.0\r\njsonschema==2.6.0\r\nkombu==4.6.0\r\nlxml==4.3.3\r\nmeld3==2.0.0\r\nmsgpack==0.6.1\r\nmsgpack-python==0.5.4\r\nmurmurhash==1.0.2\r\nnumpy==1.17.2\r\noauthlib==3.1.0\r\npandas==0.25.3\r\nPillow==5.4.1\r\nplac==0.9.6\r\npreshed==2.0.1\r\nprometheus-client==0.7.1\r\npsycopg2==2.7.3\r\nPuLP==1.6.9\r\npyasn1==0.4.8\r\npyasn1-modules==0.2.7\r\npycparser==2.19\r\nPyHamcrest==1.9.0\r\nPyJWT==1.7.1\r\npyOpenSSL==19.1.0\r\npyparsing==2.4.5\r\nPySocks==1.7.1\r\npython-crontab==2.4.0\r\npython-dateutil==2.8.0\r\npython3-openid==3.1.0\r\npytz==2019.3\r\nPyYAML==5.1.2\r\nqrcode==6.1\r\nraven==6.10.0\r\nredis==3.3.8\r\nreportlab==3.4.0\r\nrequests==2.22.0\r\nrequests-file==1.4.3\r\nrequests-oauthlib==1.3.0\r\nrequests-toolbelt==0.9.1\r\nrsa==3.4.2\r\ns3transfer==0.2.1\r\nscikit-learn==0.22\r\nscipy==1.3.1\r\nsentry-sdk==0.13.2\r\nservice-identity==18.1.0\r\nsix==1.13.0\r\nslackclient==1.2.1\r\nspacy==2.1.0\r\nspacy-hunspell==0.1.0\r\nsqlparse==0.3.0\r\nsrsly==0.2.0\r\nstatistics==1.0.3.5\r\nsupervisor==4.0.4\r\ntext-unidecode==1.3\r\nthinc==7.0.8\r\ntldextract==2.2.0\r\ntqdm==4.40.0\r\ntwilio==6.30.0\r\nTwisted==19.10.0\r\ntxaio==18.8.1\r\nurllib3==1.25.7\r\nuvicorn==0.10.8\r\nuvloop==0.14.0\r\nvine==1.3.0\r\nwasabi==0.4.2\r\nwebencodings==0.5.1\r\nwebsocket-client==0.56.0\r\nwebsockets==8.1\r\nxlrd==1.2.0\r\nyara-python==3.10.0\r\nzeep==2.5.0\r\nzh-model==0.0.0\r\nzope.interface==4.7.1\r\n\r\n- What you expected to happen vs. what actually happened\r\n\r\nI didn't expect the process to keep getting sigkilled. Earlier versions of channels did not have this issue.\r\n\r\n- How you're running Channels (runserver? daphne/runworker? Nginx/Apache in front?)\r\n\r\nI'm running channels using daphne in supervisor behind Nginx which itself sits behind a loadbalancer. \r\n\r\n- Console logs and full tracebacks of any errors\r\n\r\nProbably relevant logs:\r\n```\r\n[208557.248169] Task in /ecs/63f414dd-5286-4cf8-a911-8f161bbd09c4/0721d1d3babfc0a1f64a10b6793ca243720aad49f733875cbf9d075dcc467e90 killed as a result of limit of /ecs/63f414dd-5286-4cf8-a911-8f161bbd09c4/0721d1d3babfc0a1f64a10b6793ca243720aad49f733875cbf9d075dcc467e90\r\n[208557.269384] memory: usage 1048572kB, limit 1048576kB, failcnt 2277610\r\n[208557.274009] memory+swap: usage 1048572kB, limit 2097152kB, failcnt 0\r\n[208557.278596] kmem: usage 9772kB, limit 9007199254740988kB, failcnt 0\r\n[208557.283176] Memory cgroup stats for /ecs/63f414dd-5286-4cf8-a911-8f161bbd09c4/0721d1d3babfc0a1f64a10b6793ca243720aad49f733875cbf9d075dcc467e90: cache:532KB rss:1037704KB rss_huge:0KB shmem:28KB mapped_file:300KB dirty:0KB writeback:0KB swap:0KB inactive_anon:28KB active_anon:1037704KB inactive_file:356KB active_file:164KB unevictable:0KB\r\n[208557.308074] [ pid ]   uid  tgid total_vm      rss nr_ptes nr_pmds swapents oom_score_adj name\r\n[208557.316418] [28485]     0 28485      407       30       4       3        0             0 secrets_entrypo\r\n[208557.324641] [28533]     0 28533      406       31       5       3        0             0 run_microservic\r\n[208557.332463] [29518]     0 29518     5723     3634      15       3        0             0 supervisord\r\n[208557.340081] [29520]   102 29520      251       24       4       3        0             0 chronyd\r\n[208557.347886] [29521]     0 29521     5628     3571      15       3        0             0 gunicorn\r\n[208557.355402] [29522]     0 29522     2007      259       8       3        0             0 nginx\r\n[208557.362926] [29525]   100 29525     2188      368       7       3        0             0 nginx\r\n[208557.370375] [29526]   100 29526     2121      366       7       3        0             0 nginx\r\n[208557.377736] [29531]     0 29531    91045    49348     155       3        0             0 gunicorn\r\n[208557.385270] [29532]     0 29532    87644    46745     148       3        0             0 gunicorn\r\n[208557.392925] [ 2642]     0  2642   194931   157096     357       5        0             0 daphne\r\n[208557.400421] Memory cgroup out of memory: Kill process 2642 (daphne) score 582 or sacrifice child\r\n[208557.407897] Killed process 2642 (daphne) total-vm:779724kB, anon-rss:628384kB, file-rss:0kB, shmem-rss:0kB\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/292", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/292/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/292/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/292/events", "html_url": "https://github.com/django/daphne/issues/292", "id": 538018894, "node_id": "MDU6SXNzdWU1MzgwMTg4OTQ=", "number": 292, "title": "daphne with django 3 ", "user": {"login": "dimkoug", "id": 12394516, "node_id": "MDQ6VXNlcjEyMzk0NTE2", "avatar_url": "https://avatars2.githubusercontent.com/u/12394516?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dimkoug", "html_url": "https://github.com/dimkoug", "followers_url": "https://api.github.com/users/dimkoug/followers", "following_url": "https://api.github.com/users/dimkoug/following{/other_user}", "gists_url": "https://api.github.com/users/dimkoug/gists{/gist_id}", "starred_url": "https://api.github.com/users/dimkoug/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dimkoug/subscriptions", "organizations_url": "https://api.github.com/users/dimkoug/orgs", "repos_url": "https://api.github.com/users/dimkoug/repos", "events_url": "https://api.github.com/users/dimkoug/events{/privacy}", "received_events_url": "https://api.github.com/users/dimkoug/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2019-12-15T08:18:20Z", "updated_at": "2020-04-08T15:27:12Z", "closed_at": "2019-12-15T10:39:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "When i ran daphne with unix socket  and django version 3 i get this error  Django can only handle ASGI/HTTP connections, not websocket.\r\n\r\nI try to run the django channels tutorial with  nginx gunicorn supervisor and daphne\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/285", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/285/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/285/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/285/events", "html_url": "https://github.com/django/daphne/issues/285", "id": 517142844, "node_id": "MDU6SXNzdWU1MTcxNDI4NDQ=", "number": 285, "title": "ModuleNotFoundError: No module named 'sp_test'", "user": {"login": "chongjing001", "id": 43492621, "node_id": "MDQ6VXNlcjQzNDkyNjIx", "avatar_url": "https://avatars3.githubusercontent.com/u/43492621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chongjing001", "html_url": "https://github.com/chongjing001", "followers_url": "https://api.github.com/users/chongjing001/followers", "following_url": "https://api.github.com/users/chongjing001/following{/other_user}", "gists_url": "https://api.github.com/users/chongjing001/gists{/gist_id}", "starred_url": "https://api.github.com/users/chongjing001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chongjing001/subscriptions", "organizations_url": "https://api.github.com/users/chongjing001/orgs", "repos_url": "https://api.github.com/users/chongjing001/repos", "events_url": "https://api.github.com/users/chongjing001/events{/privacy}", "received_events_url": "https://api.github.com/users/chongjing001/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-04T13:12:12Z", "updated_at": "2019-11-20T18:58:19Z", "closed_at": "2019-11-20T18:58:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n(sp_testenv) [root@izwz9h0o4qt40z2ynugbe2z sp_test]# ls\r\nasgi.py  __init__.py  __pycache__  routing.py  settings.py  urls.py  wsgi.py\r\n\r\n(sp_testenv) [root@izwz9h0o4qt40z2ynugbe2z sp_test]# daphne -p 8082 sp_test.asgi:application\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/env/sp_testenv/bin/daphne\", line 10, in <module>\r\n    sys.exit(CommandLineInterface.entrypoint())\r\n  File \"/home/env/sp_testenv/lib/python3.7/site-packages/daphne/cli.py\", line 191, in entrypoint\r\n    cls().run(sys.argv[1:])\r\n  File \"/home/env/sp_testenv/lib/python3.7/site-packages/daphne/cli.py\", line 252, in run\r\n    application = import_by_path(args.application)\r\n  File \"/home/env/sp_testenv/lib/python3.7/site-packages/daphne/utils.py\", line 12, in import_by_path\r\n    target = importlib.import_module(module_path)\r\n  File \"/usr/local/python37/lib/python3.7/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1006, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 953, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap>\", line 1006, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 965, in _find_and_load_unlocked\r\nModuleNotFoundError: No module named 'sp_test'\r\n\r\n(sp_testenv) [root@izwz9h0o4qt40z2ynugbe2z sp_test]# \r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/280", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/280/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/280/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/280/events", "html_url": "https://github.com/django/daphne/issues/280", "id": 492455064, "node_id": "MDU6SXNzdWU0OTI0NTUwNjQ=", "number": 280, "title": "'RedisChannelLayer' object is not callable", "user": {"login": "akaliwod", "id": 16594412, "node_id": "MDQ6VXNlcjE2NTk0NDEy", "avatar_url": "https://avatars3.githubusercontent.com/u/16594412?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akaliwod", "html_url": "https://github.com/akaliwod", "followers_url": "https://api.github.com/users/akaliwod/followers", "following_url": "https://api.github.com/users/akaliwod/following{/other_user}", "gists_url": "https://api.github.com/users/akaliwod/gists{/gist_id}", "starred_url": "https://api.github.com/users/akaliwod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akaliwod/subscriptions", "organizations_url": "https://api.github.com/users/akaliwod/orgs", "repos_url": "https://api.github.com/users/akaliwod/repos", "events_url": "https://api.github.com/users/akaliwod/events{/privacy}", "received_events_url": "https://api.github.com/users/akaliwod/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-11T20:38:31Z", "updated_at": "2019-09-12T09:17:34Z", "closed_at": "2019-09-12T09:17:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am running into similar (the same?) problem as described in https://github.com/django/channels/issues/1035. However, this thread does not give a solution...\r\n\r\nDaphne error:\r\n\r\n```\r\n2019-09-11 20:21:36,098 ERROR    [Failure instance: Traceback: <class 'TypeError'>: 'RedisChannelLayer' object is not callable\r\n/usr/local/lib/python3.6/dist-packages/autobahn/websocket/protocol.py:2844:processHandshake\r\n/usr/local/lib/python3.6/dist-packages/txaio/tx.py:429:as_future\r\n/usr/local/lib/python3.6/dist-packages/twisted/internet/defer.py:151:maybeDeferred\r\n/usr/local/lib/python3.6/dist-packages/daphne/ws_protocol.py:82:onConnect\r\n--- <exception caught here> ---\r\n/usr/local/lib/python3.6/dist-packages/twisted/internet/defer.py:151:maybeDeferred\r\n/usr/local/lib/python3.6/dist-packages/daphne/server.py:200:create_application\r\n```\r\n\r\nSome relevant sections from settings:\r\n\r\n```\r\nASGI_APPLICATION = 'nfvi.routing.application'\r\nCHANNEL_LAYERS = {\r\n    \"default\": {\r\n        \"BACKEND\": \"channels_redis.core.RedisChannelLayer\",\r\n        \"CONFIG\": {\r\n            \"hosts\": [(\"localhost\", 6379)],\r\n        },\r\n    },\r\n}\r\n```\r\n\r\nasgi.py\r\n\r\n```\r\nfrom channels.layers import get_channel_layer\r\nos.environ.setdefault(\"DJANGO_SETTINGS_MODULE\", \"nfvi.settings\")\r\nchannel_layer = get_channel_layer()\r\n```\r\n\r\nMy runtime environment is in docker ubuntu:18.04 with all the latest pip packages (i.e. i do not limit the versions of pip package). I am really clueless how to solve this problem and would appreciate guidance.\r\n\r\nKali", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/279", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/279/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/279/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/279/events", "html_url": "https://github.com/django/daphne/issues/279", "id": 483359331, "node_id": "MDU6SXNzdWU0ODMzNTkzMzE=", "number": 279, "title": "daphne.server.current_reactor related issues", "user": {"login": "pppigg", "id": 44393853, "node_id": "MDQ6VXNlcjQ0MzkzODUz", "avatar_url": "https://avatars2.githubusercontent.com/u/44393853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pppigg", "html_url": "https://github.com/pppigg", "followers_url": "https://api.github.com/users/pppigg/followers", "following_url": "https://api.github.com/users/pppigg/following{/other_user}", "gists_url": "https://api.github.com/users/pppigg/gists{/gist_id}", "starred_url": "https://api.github.com/users/pppigg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pppigg/subscriptions", "organizations_url": "https://api.github.com/users/pppigg/orgs", "repos_url": "https://api.github.com/users/pppigg/repos", "events_url": "https://api.github.com/users/pppigg/events{/privacy}", "received_events_url": "https://api.github.com/users/pppigg/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-08-21T11:18:40Z", "updated_at": "2020-02-26T13:02:57Z", "closed_at": "2019-08-21T12:08:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am now using the pyinstaller module for django project packaging.\r\nThere was a problem that caused websocket to become unusable\uff1a\r\n`d:\\envs\\record\\lib\\site-packages\\daphne\\server.py:15: UserWarning: Something has already installed a non-asyncio Twisted reactor. Attempting to uninstall it; you can fix this warning by importing daphne.server early in your codebase or finding the package that imports Twisted and importing it later on.`\r\nI look at these two problems[#793](https://github.com/django/channels/issues/793)[#195](https://github.com/django/daphne/issues/195),Then I tried putting channels at the top of INSTALL APPS.But it hasn't worked out...\r\nI tried to print the value of current_reactor, it is <twisted.internet.selectreactor.SelectReactor object at 0x000001DC2B647710>.\r\nPlease give me a hand, thanks\uff01", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/277", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/277/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/277/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/277/events", "html_url": "https://github.com/django/daphne/issues/277", "id": 479356952, "node_id": "MDU6SXNzdWU0NzkzNTY5NTI=", "number": 277, "title": "Unclear if buffering requests is required or not", "user": {"login": "WhyNotHugo", "id": 730811, "node_id": "MDQ6VXNlcjczMDgxMQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/730811?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WhyNotHugo", "html_url": "https://github.com/WhyNotHugo", "followers_url": "https://api.github.com/users/WhyNotHugo/followers", "following_url": "https://api.github.com/users/WhyNotHugo/following{/other_user}", "gists_url": "https://api.github.com/users/WhyNotHugo/gists{/gist_id}", "starred_url": "https://api.github.com/users/WhyNotHugo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WhyNotHugo/subscriptions", "organizations_url": "https://api.github.com/users/WhyNotHugo/orgs", "repos_url": "https://api.github.com/users/WhyNotHugo/repos", "events_url": "https://api.github.com/users/WhyNotHugo/events{/privacy}", "received_events_url": "https://api.github.com/users/WhyNotHugo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-08-11T10:50:01Z", "updated_at": "2019-08-12T11:25:07Z", "closed_at": "2019-08-12T11:25:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've been looking at the documentation, and it's not clear if a reverse proxy that does request buffering is required when using daphne (I'm coming over from using gunicorn).\r\n\r\nThe documentation example uses `nginx`+daphne, but I'm not 100% sure if this is because request buffering is required or not (since it's not explain anywhere).\r\n\r\nWould daphne be fine directly exposed to the internet, or would I require having a reverse proxy in front of it to buffer slow clients? Can we add a brief mention of this in the docs?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/276", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/276/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/276/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/276/events", "html_url": "https://github.com/django/daphne/issues/276", "id": 477835006, "node_id": "MDU6SXNzdWU0Nzc4MzUwMDY=", "number": 276, "title": "Headers not being correctly validated as bytes. ", "user": {"login": "carltongibson", "id": 64686, "node_id": "MDQ6VXNlcjY0Njg2", "avatar_url": "https://avatars1.githubusercontent.com/u/64686?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carltongibson", "html_url": "https://github.com/carltongibson", "followers_url": "https://api.github.com/users/carltongibson/followers", "following_url": "https://api.github.com/users/carltongibson/following{/other_user}", "gists_url": "https://api.github.com/users/carltongibson/gists{/gist_id}", "starred_url": "https://api.github.com/users/carltongibson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carltongibson/subscriptions", "organizations_url": "https://api.github.com/users/carltongibson/orgs", "repos_url": "https://api.github.com/users/carltongibson/repos", "events_url": "https://api.github.com/users/carltongibson/events{/privacy}", "received_events_url": "https://api.github.com/users/carltongibson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-08-07T10:12:10Z", "updated_at": "2019-11-14T06:13:17Z", "closed_at": "2019-11-14T06:13:17Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Refs https://github.com/django/channels/issues/1331.\r\n\r\nAfter e93643ff5a2797f05e88bc59800d7b4dbf41765d header should be validated.\r\n\r\nBut the example provided in https://github.com/yuriiz/myproject/ just hangs. \r\nLooking at it in the debugger the `ValueError` is raised but just disappears\u2122 \u2014\u00a0it's doesn't correctly lead to an error response being returned. \ud83e\udd14", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/274", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/274/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/274/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/274/events", "html_url": "https://github.com/django/daphne/issues/274", "id": 470357232, "node_id": "MDU6SXNzdWU0NzAzNTcyMzI=", "number": 274, "title": "websocket reject and disconnect connection with vue.js ", "user": {"login": "marlin-dev", "id": 46589585, "node_id": "MDQ6VXNlcjQ2NTg5NTg1", "avatar_url": "https://avatars1.githubusercontent.com/u/46589585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marlin-dev", "html_url": "https://github.com/marlin-dev", "followers_url": "https://api.github.com/users/marlin-dev/followers", "following_url": "https://api.github.com/users/marlin-dev/following{/other_user}", "gists_url": "https://api.github.com/users/marlin-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/marlin-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marlin-dev/subscriptions", "organizations_url": "https://api.github.com/users/marlin-dev/orgs", "repos_url": "https://api.github.com/users/marlin-dev/repos", "events_url": "https://api.github.com/users/marlin-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/marlin-dev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-19T14:32:16Z", "updated_at": "2019-11-20T18:58:50Z", "closed_at": "2019-11-20T18:58:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi there!\r\n\r\nour team having issue on connection to websocket via Vue.js app.\r\nconfiguration of channels applied as mentioned on docs. I am using asigiref async_to_sync function to send data to channel_layer.\r\neverything works fine on default browser. When Vue app tries to connect where attemption get rejected. it Actually disconnects from websocket, what could be the problem, have faced this problem before?\r\nBelow attaching the codes and pictures:\r\n\r\nconsumer.py:\r\nhttps://pastebin.com/dxrCy4YX\r\n\r\nvue.js:\r\nhttps://pastebin.com/SKA4Y3hm\r\n<img width=\"1440\" alt=\"Screen Shot 2019-07-19 at 11 27 37 AM\" src=\"https://user-images.githubusercontent.com/46589585/61542837-64b37200-aa53-11e9-80a3-8d4110bb4d73.png\">\r\n<img width=\"743\" alt=\"Screen Shot 2019-07-19 at 11 28 12 AM\" src=\"https://user-images.githubusercontent.com/46589585/61542839-64b37200-aa53-11e9-8e60-6b4b28df222a.png\">\r\n<img width=\"555\" alt=\"Screen Shot 2019-07-19 at 11 28 47 AM\" src=\"https://user-images.githubusercontent.com/46589585/61542841-64b37200-aa53-11e9-9b76-1405a6c3d4ba.png\">\r\n<img width=\"1217\" alt=\"Screen Shot 2019-07-19 at 11 30 12 AM\" src=\"https://user-images.githubusercontent.com/46589585/61542842-654c0880-aa53-11e9-8529-8567b6f207c5.png\">\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/272", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/272/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/272/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/272/events", "html_url": "https://github.com/django/daphne/issues/272", "id": 464070675, "node_id": "MDU6SXNzdWU0NjQwNzA2NzU=", "number": 272, "title": "Heroku 500 server error : 'dict' object is not callable \"server\": self.server_addr,", "user": {"login": "sanjeevsiva17", "id": 18184457, "node_id": "MDQ6VXNlcjE4MTg0NDU3", "avatar_url": "https://avatars2.githubusercontent.com/u/18184457?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjeevsiva17", "html_url": "https://github.com/sanjeevsiva17", "followers_url": "https://api.github.com/users/sanjeevsiva17/followers", "following_url": "https://api.github.com/users/sanjeevsiva17/following{/other_user}", "gists_url": "https://api.github.com/users/sanjeevsiva17/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjeevsiva17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjeevsiva17/subscriptions", "organizations_url": "https://api.github.com/users/sanjeevsiva17/orgs", "repos_url": "https://api.github.com/users/sanjeevsiva17/repos", "events_url": "https://api.github.com/users/sanjeevsiva17/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjeevsiva17/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-04T05:36:05Z", "updated_at": "2019-07-05T06:21:48Z", "closed_at": "2019-07-05T06:21:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Heroku logs**\r\n`2019-07-04T05:29:23.255199+00:00 heroku[web.1]: State changed from down to starting\r\n2019-07-04T05:29:28.999685+00:00 heroku[web.1]: Starting process with command `daphne poormanswiggy.settings:CHANNEL_LAYERS --port 44014 --bind 0.0.0.0 -v2`\r\n2019-07-04T05:29:32.749952+00:00 heroku[web.1]: State changed from starting to up\r\n2019-07-04T05:29:32.345069+00:00 app[web.1]: 2019-07-04 05:29:32,344 INFO     Starting server at tcp:port=44014:interface=0.0.0.0\r\n2019-07-04T05:29:32.346060+00:00 app[web.1]: 2019-07-04 05:29:32,345 INFO     HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n2019-07-04T05:29:32.346595+00:00 app[web.1]: 2019-07-04 05:29:32,346 INFO     Configuring endpoint tcp:port=44014:interface=0.0.0.0\r\n2019-07-04T05:29:32.347378+00:00 app[web.1]: 2019-07-04 05:29:32,347 INFO     HTTPFactory starting on 44014\r\n2019-07-04T05:29:32.347620+00:00 app[web.1]: 2019-07-04 05:29:32,347 INFO     Starting factory <daphne.http_protocol.HTTPFactory object at 0x7f88d7a54d68>\r\n2019-07-04T05:29:32.348052+00:00 app[web.1]: 2019-07-04 05:29:32,347 INFO     Listening on TCP address 0.0.0.0:44014\r\n2019-07-04T05:29:34.010821+00:00 heroku[router]: at=info method=GET path=\"/\" host=boiling-cliffs-37570.herokuapp.com request_id=b024f510-19b9-44f1-b139-18c0125a9934 fwd=\"42.107.222.255\" dyno=web.1 connect=0ms service=6ms status=500 bytes=589 protocol=https\r\n2019-07-04T05:29:34.003907+00:00 app[web.1]: 2019-07-04 05:29:34,003 DEBUG    HTTP b'GET' request for ['10.111.203.27', 24611]\r\n2019-07-04T05:29:34.005205+00:00 app[web.1]: 2019-07-04 05:29:34,005 ERROR    Traceback (most recent call last):\r\n2019-07-04T05:29:34.005208+00:00 app[web.1]: File \"/app/.heroku/python/lib/python3.6/site-packages/daphne/http_protocol.py\", line 179, in process\r\n2019-07-04T05:29:34.005211+00:00 app[web.1]: \"server\": self.server_addr,\r\n2019-07-04T05:29:34.005213+00:00 app[web.1]: TypeError: 'dict' object is not callable\r\n2019-07-04T05:29:34.005220+00:00 app[web.1]: \r\n2019-07-04T05:29:34.005401+00:00 app[web.1]: 2019-07-04 05:29:34,005 DEBUG    HTTP 500 response started for ['10.111.203.27', 24611]\r\n2019-07-04T05:29:34.006048+00:00 app[web.1]: 2019-07-04 05:29:34,005 DEBUG    HTTP close for ['10.111.203.27', 24611]\r\n2019-07-04T05:29:34.006468+00:00 app[web.1]: 2019-07-04 05:29:34,006 INFO     \"10.111.203.27\" - - [10/Jan/1970:19:24:44 +0000] \"GET / HTTP/1.1\" 500 452 \"-\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36\"\r\n2019-07-04T05:29:34.006760+00:00 app[web.1]: 2019-07-04 05:29:34,006 DEBUG    HTTP response complete for ['10.111.203.27', 24611]\r\n2019-07-04T05:29:34.006885+00:00 app[web.1]: 10.111.203.27:24611 - - [04/Jul/2019:05:29:34] \"GET /\" 500 452\r\n`\r\n\r\n**Procfile**\r\n`web: daphne poormanswiggy.settings:CHANNEL_LAYERS --port $PORT --bind 0.0.0.0 -v2`\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/271", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/271/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/271/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/271/events", "html_url": "https://github.com/django/daphne/issues/271", "id": 463517285, "node_id": "MDU6SXNzdWU0NjM1MTcyODU=", "number": 271, "title": "Feature request: Ability to shorten log message", "user": {"login": "hongquan", "id": 314607, "node_id": "MDQ6VXNlcjMxNDYwNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/314607?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hongquan", "html_url": "https://github.com/hongquan", "followers_url": "https://api.github.com/users/hongquan/followers", "following_url": "https://api.github.com/users/hongquan/following{/other_user}", "gists_url": "https://api.github.com/users/hongquan/gists{/gist_id}", "starred_url": "https://api.github.com/users/hongquan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hongquan/subscriptions", "organizations_url": "https://api.github.com/users/hongquan/orgs", "repos_url": "https://api.github.com/users/hongquan/repos", "events_url": "https://api.github.com/users/hongquan/events{/privacy}", "received_events_url": "https://api.github.com/users/hongquan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303174330, "node_id": "MDU6TGFiZWwzMDMxNzQzMzA=", "url": "https://api.github.com/repos/django/daphne/labels/enhancement", "name": "enhancement", "color": "1d76db", "default": true, "description": null}, {"id": 439648660, "node_id": "MDU6TGFiZWw0Mzk2NDg2NjA=", "url": "https://api.github.com/repos/django/daphne/labels/exp/beginner", "name": "exp/beginner", "color": "bfdadc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-03T02:47:09Z", "updated_at": "2019-07-16T08:25:50Z", "closed_at": "2019-07-03T13:30:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "In my setup, I use systemd to start/stop Daphne server, and use journalctl to see Daphne log.\r\n\r\nWhen viewing via Journalctl, the log line is pretty long and redundant:\r\n\r\n```\r\nJul 03 09:06:05 elevator-acs-c daphne[6223]: DEBUG 2019-07-03 09:06:05,846 consumers 6223 140236757043008 devinfo DeviceUpdate(beacon_mode=False, firmware_available=None, request_reboot=None, request_open_gate=None, floor_number=None, elevator_shaft=None)\r\nJul 03 09:06:05 elevator-acs-c daphne[6223]: DEBUG 2019-07-03 09:06:05,850 consumers 6223 140236757043008 Device: None\r\nJul 03 09:06:05 elevator-acs-c daphne[6223]: INFO 2019-07-03 09:06:05,850 consumers 6223 140236757043008 MainMessage(hwid=None, proxy_hwid=None, reg_request=None, reg_response=DeviceRegistrationResponse(device_token='ROznIElDdJnIPSNEUjaJ', result=<RegistrationResult.REG_SUCCESS: 0>), auth_request=None, auth_response=None, device_update=None, call_elevator_request=None, call_elevator_response=None, device_info=None, auth=None)\r\n```\r\n\r\nI want to shorten it, maybe by telling Daphne not to print out its timestamp, process ID. Could you add this feature?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/270", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/270/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/270/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/270/events", "html_url": "https://github.com/django/daphne/issues/270", "id": 459606420, "node_id": "MDU6SXNzdWU0NTk2MDY0MjA=", "number": 270, "title": "Not seeing trivial CLI info message", "user": {"login": "ambsw-technology", "id": 8583181, "node_id": "MDQ6VXNlcjg1ODMxODE=", "avatar_url": "https://avatars0.githubusercontent.com/u/8583181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ambsw-technology", "html_url": "https://github.com/ambsw-technology", "followers_url": "https://api.github.com/users/ambsw-technology/followers", "following_url": "https://api.github.com/users/ambsw-technology/following{/other_user}", "gists_url": "https://api.github.com/users/ambsw-technology/gists{/gist_id}", "starred_url": "https://api.github.com/users/ambsw-technology/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ambsw-technology/subscriptions", "organizations_url": "https://api.github.com/users/ambsw-technology/orgs", "repos_url": "https://api.github.com/users/ambsw-technology/repos", "events_url": "https://api.github.com/users/ambsw-technology/events{/privacy}", "received_events_url": "https://api.github.com/users/ambsw-technology/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-06-23T18:56:11Z", "updated_at": "2019-06-23T20:15:42Z", "closed_at": "2019-06-23T20:15:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm actually running everything in docker/supervisor/fcgi-program, but have eliminated any potential configuration issues by manually running the following (replacing \"myapp\" with the right value for my app):\r\n\r\n```\r\ndaphne -u /code/pid/daphne_2.sock -v 2 --fd 0 --access-log - --proxy-headers myapp.asgi:application\r\n```\r\n\r\nSince I'm running with `-v 2` (debug) and `--access-log -` (log to stdout), I expect [cli.py](https://github.com/django/daphne/blob/master/daphne/cli.py#L287) (edit: point link at master) to log an info messages for the startup.  I get a bunch of debug messages from a django package (`django-environ`) but not the daphne cli message.\r\n\r\nI started with the trivial CLI message as a way to make sure I'm seeing logging so I can find/resolve my real issue that should be generating a stack trace [here](https://github.com/django/daphne/blob/master/daphne/http_protocol.py#L191).", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/267", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/267/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/267/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/267/events", "html_url": "https://github.com/django/daphne/issues/267", "id": 456716702, "node_id": "MDU6SXNzdWU0NTY3MTY3MDI=", "number": 267, "title": "Implement raw_path", "user": {"login": "simonw", "id": 9599, "node_id": "MDQ6VXNlcjk1OTk=", "avatar_url": "https://avatars0.githubusercontent.com/u/9599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/simonw", "html_url": "https://github.com/simonw", "followers_url": "https://api.github.com/users/simonw/followers", "following_url": "https://api.github.com/users/simonw/following{/other_user}", "gists_url": "https://api.github.com/users/simonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/simonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/simonw/subscriptions", "organizations_url": "https://api.github.com/users/simonw/orgs", "repos_url": "https://api.github.com/users/simonw/repos", "events_url": "https://api.github.com/users/simonw/events{/privacy}", "received_events_url": "https://api.github.com/users/simonw/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-06-17T02:37:22Z", "updated_at": "2019-07-03T18:22:04Z", "closed_at": "2019-07-03T18:22:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Assuming https://github.com/django/asgiref/pull/92 is merged into ASGI (see also https://github.com/django/asgiref/issues/87) Daphne should support the `raw_path` scope key for both HTTP and websocket.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/265", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/265/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/265/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/265/events", "html_url": "https://github.com/django/daphne/issues/265", "id": 454445836, "node_id": "MDU6SXNzdWU0NTQ0NDU4MzY=", "number": 265, "title": "SSL not support CertificateChain", "user": {"login": "HoangJerry", "id": 27281406, "node_id": "MDQ6VXNlcjI3MjgxNDA2", "avatar_url": "https://avatars0.githubusercontent.com/u/27281406?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HoangJerry", "html_url": "https://github.com/HoangJerry", "followers_url": "https://api.github.com/users/HoangJerry/followers", "following_url": "https://api.github.com/users/HoangJerry/following{/other_user}", "gists_url": "https://api.github.com/users/HoangJerry/gists{/gist_id}", "starred_url": "https://api.github.com/users/HoangJerry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HoangJerry/subscriptions", "organizations_url": "https://api.github.com/users/HoangJerry/orgs", "repos_url": "https://api.github.com/users/HoangJerry/repos", "events_url": "https://api.github.com/users/HoangJerry/events{/privacy}", "received_events_url": "https://api.github.com/users/HoangJerry/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-11T02:02:25Z", "updated_at": "2019-06-11T06:51:47Z", "closed_at": "2019-06-11T06:51:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello there,\r\n\r\nI want to run ssl on daphane, and I ran:\r\ndaphne -e ssl:443:privateKey=key.pem:certKey=crt.pem django_project.asgi:application\r\n\r\nBut on godaddy I got the chain certificate and I dont know how the daphne  run it I guess some thing like this?\r\ndaphne -e ssl:443:privateKey=key.pem:certKey=crt.pem:chainKey:chancrt.pem django_project.asgi:application\r\nBut it's not true.\r\n\r\nI got this issue when I scan. Correctly, chrome is work well, however some browser on mobile cannot load my page\r\n![image](https://user-images.githubusercontent.com/27281406/59238249-6d7c8100-8c27-11e9-9f25-172509d0cad2.png)\r\n\r\nThank for your help\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/263", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/263/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/263/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/263/events", "html_url": "https://github.com/django/daphne/issues/263", "id": 446770167, "node_id": "MDU6SXNzdWU0NDY3NzAxNjc=", "number": 263, "title": "CRITICAL Listen failure: [Errno 88] Socket operation on non-socket", "user": {"login": "hardikbansal", "id": 4491944, "node_id": "MDQ6VXNlcjQ0OTE5NDQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/4491944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hardikbansal", "html_url": "https://github.com/hardikbansal", "followers_url": "https://api.github.com/users/hardikbansal/followers", "following_url": "https://api.github.com/users/hardikbansal/following{/other_user}", "gists_url": "https://api.github.com/users/hardikbansal/gists{/gist_id}", "starred_url": "https://api.github.com/users/hardikbansal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hardikbansal/subscriptions", "organizations_url": "https://api.github.com/users/hardikbansal/orgs", "repos_url": "https://api.github.com/users/hardikbansal/repos", "events_url": "https://api.github.com/users/hardikbansal/events{/privacy}", "received_events_url": "https://api.github.com/users/hardikbansal/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2019-05-21T18:48:18Z", "updated_at": "2020-06-18T09:52:02Z", "closed_at": "2019-06-05T07:38:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have made a server using Django REST framework and Django channels but I am unable to configure supervisor to run with it. My supervisor config is as follow:\r\n\r\n    [program:frnd_django]\r\n    socket=tcp://localhost:8000\r\n    directory=/home/coldbrewtech/frnd/backend/dating-app-backend/django-server/cbproj/\r\n    environment=DJANGO_SETTINGS_MODULE=cbproj.dev_settings\r\n    command=/home/coldbrewtech/frnd/backend/env/bin/daphne -u /run/daphne/daphne%(process_num)d.sock --fd 0 --access-log - --proxy-headers cbproj.asgi:application\r\n    stdout_logfile=/home/coldbrewtech/frnd/backend/dating-app-backend/django-server/cbproj/logs/django_out.log\r\n    stderr_logfile=/home/coldbrewtech/frnd/backend/dating-app-backend/django-server/cbproj/logs/django_err.log\r\n    numprocs=4\r\n    process_name=asgi%(process_num)d\r\n    autostart=true\r\n    autorestart=true\r\n    user=root\r\n    startsecs=10\r\n    stopwaitsecs=600\r\n    stopasgroup=true\r\n    stopsignal=KILL\r\n\r\nAnd the error that I am getting is as follow:\r\n\r\n    2019-05-21 18:03:50,111 INFO     Starting server at fd:fileno=0, unix:/run/daphne/daphne3.sock\r\n    2019-05-21 18:03:50,121 INFO     HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n    2019-05-21 18:03:50,125 INFO     Configuring endpoint fd:fileno=0\r\n    2019-05-21 18:03:50,130 INFO     Starting server at fd:fileno=0, unix:/run/daphne/daphne1.sock\r\n    2019-05-21 18:03:50,131 INFO     Starting server at fd:fileno=0, unix:/run/daphne/daphne0.sock\r\n    2019-05-21 18:03:50,132 INFO     HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n    2019-05-21 18:03:50,133 INFO     Configuring endpoint fd:fileno=0\r\n    2019-05-21 18:03:50,134 INFO     HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n    2019-05-21 18:03:50,145 INFO     Configuring endpoint fd:fileno=0\r\n    2019-05-21 18:03:50,154 INFO     Starting server at fd:fileno=0, unix:/run/daphne/daphne2.sock\r\n    2019-05-21 18:03:50,158 CRITICAL Listen failure: [Errno 88] Socket operation on non-socket\r\n    2019-05-21 18:03:50,159 INFO     HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n    2019-05-21 18:03:50,160 INFO     Configuring endpoint fd:fileno=0\r\n    2019-05-21 18:03:50,163 CRITICAL Listen failure: [Errno 88] Socket operation on non-socket\r\n    2019-05-21 18:03:50,160 INFO     Configuring endpoint unix:/run/daphne/daphne3.sock\r\n    2019-05-21 18:03:50,168 CRITICAL Listen failure: [Errno 88] Socket operation on non-socket\r\n    2019-05-21 18:03:50,177 INFO     Configuring endpoint unix:/run/daphne/daphne0.sock\r\n    2019-05-21 18:03:50,181 INFO     Configuring endpoint unix:/run/daphne/daphne1.sock\r\n    2019-05-21 18:03:50,192 CRITICAL Listen failure: [Errno 88] Socket operation on non-socket\r\n    2019-05-21 18:03:50,204 INFO     Configuring endpoint unix:/run/daphne/daphne2.sock\r\n\r\nI am not sure whether this is daphne issue or some supervisor issue\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/258", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/258/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/258/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/258/events", "html_url": "https://github.com/django/daphne/issues/258", "id": 433327733, "node_id": "MDU6SXNzdWU0MzMzMjc3MzM=", "number": 258, "title": "Require Python 3.6", "user": {"login": "carltongibson", "id": 64686, "node_id": "MDQ6VXNlcjY0Njg2", "avatar_url": "https://avatars1.githubusercontent.com/u/64686?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carltongibson", "html_url": "https://github.com/carltongibson", "followers_url": "https://api.github.com/users/carltongibson/followers", "following_url": "https://api.github.com/users/carltongibson/following{/other_user}", "gists_url": "https://api.github.com/users/carltongibson/gists{/gist_id}", "starred_url": "https://api.github.com/users/carltongibson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carltongibson/subscriptions", "organizations_url": "https://api.github.com/users/carltongibson/orgs", "repos_url": "https://api.github.com/users/carltongibson/repos", "events_url": "https://api.github.com/users/carltongibson/events{/privacy}", "received_events_url": "https://api.github.com/users/carltongibson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-04-15T14:54:16Z", "updated_at": "2019-07-03T13:34:08Z", "closed_at": "2019-07-03T13:34:08Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Ref https://github.com/django/channels_redis/issues/156\r\n\r\nChannels-Redis requires Python 3.6. It doesn\u2019t make much sense for Channels and Daphne not to do the same. ", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/256", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/256/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/256/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/256/events", "html_url": "https://github.com/django/daphne/issues/256", "id": 430983527, "node_id": "MDU6SXNzdWU0MzA5ODM1Mjc=", "number": 256, "title": "No module named 'asgiref.compatibility'", "user": {"login": "Catastropha", "id": 1425601, "node_id": "MDQ6VXNlcjE0MjU2MDE=", "avatar_url": "https://avatars1.githubusercontent.com/u/1425601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Catastropha", "html_url": "https://github.com/Catastropha", "followers_url": "https://api.github.com/users/Catastropha/followers", "following_url": "https://api.github.com/users/Catastropha/following{/other_user}", "gists_url": "https://api.github.com/users/Catastropha/gists{/gist_id}", "starred_url": "https://api.github.com/users/Catastropha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Catastropha/subscriptions", "organizations_url": "https://api.github.com/users/Catastropha/orgs", "repos_url": "https://api.github.com/users/Catastropha/repos", "events_url": "https://api.github.com/users/Catastropha/events{/privacy}", "received_events_url": "https://api.github.com/users/Catastropha/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-04-09T13:57:57Z", "updated_at": "2019-04-14T13:41:06Z", "closed_at": "2019-04-14T13:41:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "ModuleNotFoundError: No module named 'asgiref.compatibility'\r\n\r\nAfter the last realease. What should be done?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/254", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/254/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/254/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/254/events", "html_url": "https://github.com/django/daphne/issues/254", "id": 422873682, "node_id": "MDU6SXNzdWU0MjI4NzM2ODI=", "number": 254, "title": "Issues with deployment and daphne socket listeners", "user": {"login": "pythonBerg", "id": 22894385, "node_id": "MDQ6VXNlcjIyODk0Mzg1", "avatar_url": "https://avatars3.githubusercontent.com/u/22894385?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pythonBerg", "html_url": "https://github.com/pythonBerg", "followers_url": "https://api.github.com/users/pythonBerg/followers", "following_url": "https://api.github.com/users/pythonBerg/following{/other_user}", "gists_url": "https://api.github.com/users/pythonBerg/gists{/gist_id}", "starred_url": "https://api.github.com/users/pythonBerg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pythonBerg/subscriptions", "organizations_url": "https://api.github.com/users/pythonBerg/orgs", "repos_url": "https://api.github.com/users/pythonBerg/repos", "events_url": "https://api.github.com/users/pythonBerg/events{/privacy}", "received_events_url": "https://api.github.com/users/pythonBerg/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-19T17:56:29Z", "updated_at": "2020-02-26T16:48:37Z", "closed_at": "2019-03-20T14:57:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've seen this before in #233 and #234. I followed those instructions to replace --fd:0 with --endpoint fd:fileno=0. I get the same errors in both configurations.  Probably something basic I don't understand but need some guidance here...\r\n\r\nStarting using exact specification in django-channels 2 deployment using supervisor..., modified according to closed issues above.\r\n\r\nubuntu 18.04. Python 3.6, Daphne 2.2.5\r\n```\r\n[fcgi-program:daphne]\r\nsocket=tcp://localhost:8001\r\n\r\ndirectory=/home/edbergman/compscre\r\n\r\ncommand=daphne -u /run/daphne/daphne%(process_num)d.sock --endpoint fd:fileno=0 --access-log - --proxy-headers compscre.asgi:application\r\n\r\n# Number of processes to startup, roughly the number of CPUs you have\r\nnumprocs=4\r\n\r\nprocess_name=asgi%(process_num)d\r\n\r\nautostart=false\r\nautorestart=true\r\n\r\nstdout_logfile=/home/edbergman/compscre/logs/asgi.log\r\nredirect_stderr=true\r\n\r\n```\r\n\r\n2019-03-19 17:46:39,064 INFO     Starting server at fd:fileno=0, unix:/run/daphne/daphne0.sock\r\n2019-03-19 17:46:39,066 INFO     HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n2019-03-19 17:46:39,066 INFO     Configuring endpoint fd:fileno=0\r\n2019-03-19 17:46:39,086 INFO     Listening on TCP address 127.0.0.1:8001\r\n2019-03-19 17:46:39,086 INFO     Configuring endpoint unix:/run/daphne/daphne0.sock\r\n2019-03-19 17:46:39,087 CRITICAL Listen failure: [Errno 2] No such file or directory: '3051' -> b'/run/daphne/daphne0.sock.lock'", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/253", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/253/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/253/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/253/events", "html_url": "https://github.com/django/daphne/issues/253", "id": 422348561, "node_id": "MDU6SXNzdWU0MjIzNDg1NjE=", "number": 253, "title": "Prevent the full loading of content of HTTP POST requests into the RAM", "user": {"login": "hozblok", "id": 17067394, "node_id": "MDQ6VXNlcjE3MDY3Mzk0", "avatar_url": "https://avatars2.githubusercontent.com/u/17067394?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hozblok", "html_url": "https://github.com/hozblok", "followers_url": "https://api.github.com/users/hozblok/followers", "following_url": "https://api.github.com/users/hozblok/following{/other_user}", "gists_url": "https://api.github.com/users/hozblok/gists{/gist_id}", "starred_url": "https://api.github.com/users/hozblok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hozblok/subscriptions", "organizations_url": "https://api.github.com/users/hozblok/orgs", "repos_url": "https://api.github.com/users/hozblok/repos", "events_url": "https://api.github.com/users/hozblok/events{/privacy}", "received_events_url": "https://api.github.com/users/hozblok/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-18T17:38:09Z", "updated_at": "2019-03-18T20:00:50Z", "closed_at": "2019-03-18T20:00:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please, can anyone say how to avoid the following behavior?\r\n\r\nFor example, we send a large HTTP POST request with multipart/form-data (~2 Gb) using channels, daphne, `AsgiHandler` and `AsgiRequest`. (let's say we chose the wrong file to upload).\r\n\r\nsettings.py contains `DATA_UPLOAD_MAX_MEMORY_SIZE = 1024 * 1024 * 25` and `FILE_UPLOAD_MAX_MEMORY_SIZE = 1024 * 1024 * 5` settings.\r\n\r\n[Here](https://github.com/django/channels/blob/a1ecd5ee72a538f19bdd9e8f6bb91bb8aabba5d9/channels/http.py#L127) in `AsgiRequest` we raise `RequestDataTooBig` exception.\r\n\r\nSo the response is `HttpResponse(\"413 Payload too large\", status=413)` [(here)](https://github.com/django/channels/blob/a1ecd5ee72a538f19bdd9e8f6bb91bb8aabba5d9/channels/http.py#L244). Ok.\r\n\r\nBut before all this: [here](https://github.com/django/daphne/blob/67cfa98b0016abee66fe1d90c7db3ea1ea1d001f/daphne/http_protocol.py#L188) we load two gigabytes of unwanted data into RAM... ?\r\n\r\nPerhaps is there a way to check the `content-length` in the  `__init__` method of `AsgiHandler`?  How to prevent uploads to RAM correctly?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/249", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/249/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/249/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/249/events", "html_url": "https://github.com/django/daphne/issues/249", "id": 415650345, "node_id": "MDU6SXNzdWU0MTU2NTAzNDU=", "number": 249, "title": "daphne + supervisor : strange behavior", "user": {"login": "tboulogne", "id": 6205275, "node_id": "MDQ6VXNlcjYyMDUyNzU=", "avatar_url": "https://avatars0.githubusercontent.com/u/6205275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tboulogne", "html_url": "https://github.com/tboulogne", "followers_url": "https://api.github.com/users/tboulogne/followers", "following_url": "https://api.github.com/users/tboulogne/following{/other_user}", "gists_url": "https://api.github.com/users/tboulogne/gists{/gist_id}", "starred_url": "https://api.github.com/users/tboulogne/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tboulogne/subscriptions", "organizations_url": "https://api.github.com/users/tboulogne/orgs", "repos_url": "https://api.github.com/users/tboulogne/repos", "events_url": "https://api.github.com/users/tboulogne/events{/privacy}", "received_events_url": "https://api.github.com/users/tboulogne/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-02-28T14:28:45Z", "updated_at": "2019-02-28T14:56:16Z", "closed_at": "2019-02-28T14:56:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI follow https://channels.readthedocs.io/en/latest/deploying.html#example-setups and i get a strange behavior if numprocs > 1.\r\n\r\nI get ony few messages (around one on three). If i set numprocs to 1, i get all messages.\r\n\r\nAny idea on what happend (bug on running daphne in supervisor) ?\r\n\r\nThanks for help.\r\n\r\nregards\r\n\r\nOS: ubuntu 18.04\r\nsupervisor: 3.3.1\r\nchannels: 2.1.5\r\nevent stream: latest", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/248", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/248/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/248/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/248/events", "html_url": "https://github.com/django/daphne/issues/248", "id": 408621176, "node_id": "MDU6SXNzdWU0MDg2MjExNzY=", "number": 248, "title": "Django Error: (2013, 'Lost connection to MySQL server during query') after running for \"mysql wait_timeout\" second", "user": {"login": "gojuukaze", "id": 15613304, "node_id": "MDQ6VXNlcjE1NjEzMzA0", "avatar_url": "https://avatars3.githubusercontent.com/u/15613304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gojuukaze", "html_url": "https://github.com/gojuukaze", "followers_url": "https://api.github.com/users/gojuukaze/followers", "following_url": "https://api.github.com/users/gojuukaze/following{/other_user}", "gists_url": "https://api.github.com/users/gojuukaze/gists{/gist_id}", "starred_url": "https://api.github.com/users/gojuukaze/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gojuukaze/subscriptions", "organizations_url": "https://api.github.com/users/gojuukaze/orgs", "repos_url": "https://api.github.com/users/gojuukaze/repos", "events_url": "https://api.github.com/users/gojuukaze/events{/privacy}", "received_events_url": "https://api.github.com/users/gojuukaze/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-02-11T03:17:55Z", "updated_at": "2019-02-11T09:13:25Z", "closed_at": "2019-02-11T09:13:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "In order to recreate this bug\uff0ci set mysql `wait_timeout=10` and `interactive_timeout=10` .\r\n\r\nrun server :\r\n\r\n```bash\r\ndaphne -b 0.0.0.0 -p 8000 django_api.asgi:application\r\n```\r\n\r\nafter 10s connect websocket\uff0c\r\n```\r\n2019-02-11 11:11:25,321 ERROR    [Failure instance: Traceback: <class 'django.db.utils.OperationalError'>: (2013, 'Lost connection to MySQL server during query')\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/autobahn/websocket/protocol.py:2801:processHandshake\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/txaio/tx.py:429:as_future\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/twisted/internet/defer.py:151:maybeDeferred\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/daphne/ws_protocol.py:82:onConnect\r\n--- <exception caught here> ---\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/twisted/internet/defer.py:151:maybeDeferred\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/daphne/server.py:198:create_application\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/channels/routing.py:58:__call__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/channels/sessions.py:43:__call__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/channels/sessions.py:141:__call__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/channels/sessions.py:165:__init__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/channels/middleware.py:31:__call__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/channels/routing.py:144:__call__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/channels/routing.py:144:__call__\r\n./xx/base/consumer_base.py:100:__init__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/models/manager.py:82:manager_method\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/models/query.py:393:get\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/models/query.py:250:__len__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/models/query.py:1186:_fetch_all\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/models/query.py:54:__iter__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/models/sql/compiler.py:1065:execute_sql\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/backends/utils.py:68:execute\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/backends/utils.py:77:_execute_with_wrappers\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/backends/utils.py:85:_execute\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/utils.py:89:__exit__\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/backends/utils.py:85:_execute\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/django/db/backends/mysql/base.py:71:execute\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/MySQLdb/cursors.py:250:execute\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/MySQLdb/connections.py:50:defaulterrorhandler\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/MySQLdb/cursors.py:247:execute\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/MySQLdb/cursors.py:412:_query\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/MySQLdb/cursors.py:375:_do_query\r\n/Users/xx/project/py3.6/lib/python3.6/site-packages/MySQLdb/connections.py:276:query\r\n]\r\n127.0.0.1:50300 - - [11/Feb/2019:11:11:29] \"WSDISCONNECT /ws/base/audio_push\" - -\r\n```\r\n\r\nbut http work fine.\r\n\r\n```\r\nDjango==2.1.3\r\nchannels==2.1.5\r\nchannels_redis==2.3.1\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/246", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/246/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/246/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/246/events", "html_url": "https://github.com/django/daphne/issues/246", "id": 403059784, "node_id": "MDU6SXNzdWU0MDMwNTk3ODQ=", "number": 246, "title": "Error during the websocket handshake: 404", "user": {"login": "MoncefB", "id": 9143117, "node_id": "MDQ6VXNlcjkxNDMxMTc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9143117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MoncefB", "html_url": "https://github.com/MoncefB", "followers_url": "https://api.github.com/users/MoncefB/followers", "following_url": "https://api.github.com/users/MoncefB/following{/other_user}", "gists_url": "https://api.github.com/users/MoncefB/gists{/gist_id}", "starred_url": "https://api.github.com/users/MoncefB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MoncefB/subscriptions", "organizations_url": "https://api.github.com/users/MoncefB/orgs", "repos_url": "https://api.github.com/users/MoncefB/repos", "events_url": "https://api.github.com/users/MoncefB/events{/privacy}", "received_events_url": "https://api.github.com/users/MoncefB/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-01-25T08:51:46Z", "updated_at": "2019-01-28T22:54:01Z", "closed_at": "2019-01-28T22:54:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nFirst of all, kudos for everything <3 \r\n\r\nPlease, I have basically exhausted all the already existing topics (previously opened issues on Github, questions on StackOverflow, etc.) about the error message \"WebSocket connection to 'wss://www.mbiaz.org/ws/v1.0/office/' failed: Error during WebSocket handshake: Unexpected response code: 404\"\r\n\r\nThe weird thing is that I moved all the traffic to Daphne (I used to rely on Gunicorn but not anymore) for both HTTP requests and sockets. My Django app is definitely running as ASGI. These are my dependencies:\r\n\r\n`aioredis==1.2.0\r\namqp==1.4.9\r\nanalytics-python==1.2.5\r\nanyjson==0.3.3\r\napiai==1.2.3\r\nasgiref==2.3.2\r\nasync-timeout==2.0.1\r\natomicwrites==1.2.1\r\nattrs==18.2.0\r\nautobahn==19.1.1\r\nAutomat==0.7.0\r\nBabel==2.6.0\r\nbilliard==3.3.0.23\r\nbleach==3.1.0\r\nboto==2.48.0\r\nboto3==1.3.1\r\nbotocore==1.4.93\r\nbz2file==0.98\r\ncelery==3.1.25\r\ncertifi==2018.11.29\r\nchannels==2.1.6\r\nchannels-redis==2.3.2\r\nchardet==3.0.4\r\nClick==7.0\r\nconstantly==15.1.0\r\ncontractions==0.0.17\r\ncycler==0.10.0\r\ndaphne==2.2.4\r\ndecorator==4.3.2\r\ndefusedxml==0.5.0\r\nDjango==2.0.1\r\ndjango-axes==2.1.0\r\ndjango-celery==3.2.1\r\ndjango-constance==2.0.0\r\ndjango-debug-toolbar==1.8\r\ndjango-extensions==1.9.1\r\ndjango-localflavor==1.3\r\ndjango-nose==1.4.4\r\ndjango-picklefield==2.0\r\ndjango-webpack-loader==0.5.0\r\ndnspython==1.16.0\r\ndocutils==0.14\r\nemoji==0.3.9\r\nentrypoints==0.3\r\nenum34==1.1.6\r\nFlask==1.0.2\r\nFlask-Caching==1.4.0\r\nflower==0.9.1\r\nfreezegun==0.3.8\r\nfuzzywuzzy==0.16.0\r\ngensim==3.6.0\r\ngraphviz==0.8\r\ngunicorn==19.6.0\r\nhashids==1.1.0\r\nhiredis==1.0.0\r\nhumanize==0.5.1\r\nhyperlink==18.0.0\r\nidna==2.6\r\nincremental==17.5.0\r\nipwhois==1.0.0\r\nipykernel==5.1.0\r\nipython==5.2.0\r\nipython-genutils==0.2.0\r\nipywidgets==7.4.2\r\nitsdangerous==1.1.0\r\nJinja2==2.10\r\njmespath==0.9.3\r\njsonschema==2.6.0\r\njupyter==1.0.0\r\njupyter-client==5.2.4\r\njupyter-console==6.0.0\r\njupyter-core==4.4.0\r\nKeras==2.0.6\r\nkombu==3.0.37\r\nMarkupSafe==1.1.0\r\nmatplotlib==2.0.2\r\nmistune==0.8.4\r\nmore-itertools==5.0.0\r\nmsgpack==0.5.6\r\nnbconvert==5.4.0\r\nnbformat==4.4.0\r\nnltk==3.4\r\nnose==1.3.7\r\nnotebook==5.7.4\r\nnumpy==1.16.0\r\nolefile==0.46\r\npandas==0.20.1\r\npandocfilters==1.4.2\r\npathlib2==2.3.3\r\npexpect==4.6.0\r\npickleshare==0.7.5\r\nPillow==4.2.1\r\npkg-resources==0.0.0\r\nplaid-python==2.3.3\r\npluggy==0.8.1\r\nprometheus-client==0.5.0\r\nprompt-toolkit==1.0.15\r\npsycopg2==2.7.3.2\r\nptyprocess==0.6.0\r\npy==1.7.0\r\npycorenlp==0.3.0\r\npydot==1.2.3\r\nPygments==2.3.1\r\nPyHamcrest==1.9.0\r\nPyJWT==1.7.1\r\npyparsing==2.3.1\r\nPySocks==1.6.8\r\npytest==4.0.1\r\npython-dateutil==2.5.3\r\npython-Levenshtein==0.12.0\r\npytz==2018.9\r\nPyYAML==3.13\r\npyzmq==17.1.2\r\nqtconsole==4.4.3\r\nraven==6.6.0\r\nredis==2.10.5\r\nrequests==2.18.4\r\nscaleapi==0.1.8\r\nscikit-learn==0.18.2\r\nscipy==1.2.0\r\nSend2Trash==1.5.0\r\nsimplegeneric==0.8.1\r\nsingledispatch==3.4.0.3\r\nsix==1.12.0\r\nsklearn-pandas==1.5.0\r\nsmart-open==1.8.0\r\nsqlparse==0.2.4\r\nterminado==0.8.1\r\ntestpath==0.4.2\r\nTheano==1.0.4\r\ntornado==4.2\r\ntraitlets==4.3.2\r\ntwilio==6.10.0\r\nTwisted==18.9.0\r\ntxaio==18.8.1\r\nua-parser==0.7.3\r\nurllib3==1.22\r\nuszipcode==0.1.3\r\nwcwidth==0.1.7\r\nwebencodings==0.5.1\r\nWerkzeug==0.14.1\r\nwidgetsnbextension==3.4.2\r\nzope.interface==4.6.0`\r\n\r\nI am confident about my routing:\r\n`from channels.auth import AuthMiddlewareStack\r\nfrom channels.routing import ProtocolTypeRouter, URLRouter\r\nfrom django.conf.urls import url\r\n\r\nfrom account.consumers import PlaidLinkConsumer\r\n\r\n\r\napplication = ProtocolTypeRouter({\r\n    # (http->django views is added by default)\r\n    'websocket': AuthMiddlewareStack(\r\n        URLRouter([\r\n            url(r'^ws/v1.0/office/$', PlaidLinkConsumer),\r\n        ])\r\n    ),\r\n})\r\n`\r\n\r\nI'm using Daphne through Supervisor:\r\n`[fcgi-program:daphne]\r\nsocket=tcp://localhost:8000\r\n\r\ndirectory=/home/ubuntu/src/charlie\r\n\r\ncommand=/home/ubuntu/Envs/charlie_env/bin/daphne -u /tmp/daphne/daphne%(process_num)d.sock --fd 0 --access-log - --proxy-headers charlie_web.charlie_web_project.asgi:application\r\n\r\nnumprocs=2\r\n\r\nprocess_name=daphne%(process_num)d\r\n\r\nautostart=true\r\nautorestart=true\r\n\r\nstdout_logfile=/var/log/daphne.log\r\nredirect_stderr=true\r\n\r\nenvironment=LANG=en_US.UTF-8,LC_ALL=en_US.UTF-8,PYTHONPATH=\"/home/ubuntu/src/charlie/charlie_web/\"\r\n`\r\n\r\nMy OS is Ubuntu 16, and I'm using Nginx. I followed the Channels docs about Deployment, and I did add the lines about HTTP 1.1 and the connection upgrade:\r\n\r\n`\r\nupstream channels-backend {\r\n    server localhost:8000;\r\n}\r\n\r\nserver {\r\n    listen 80;\r\n    server_name mbiaz.org;\r\n\r\n    access_log /var/log/nginx/access.log custom_log;\r\n\r\n    location /static/ {\r\n        alias /home/ubuntu/www/static/;\r\n    }\r\n\r\n    location / {\r\n        try_files $uri @proxy_to_app;\r\n    }\r\n\r\n    location @proxy_to_app {\r\n        proxy_pass http://channels-backend;\r\n\r\n        proxy_http_version 1.1;\r\n        proxy_set_header Upgrade $http_upgrade;\r\n        proxy_set_header Connection \"upgrade\";\r\n\r\n        proxy_redirect off;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Host $server_name;\r\n    }\r\n\r\n}\r\n`\r\n\r\nThe HTTP part works well, when I visit the page supposed to use websockets. The page is rendered properly, but the socket part fails with the 404... When I look at the Daphne log, I get:\r\n2019-01-25 08:35:07,904 WARNING  Not Found: /ws/v1.0/office/\r\n\r\nWhat is going wrong? :(", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/245", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/245/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/245/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/245/events", "html_url": "https://github.com/django/daphne/issues/245", "id": 400093121, "node_id": "MDU6SXNzdWU0MDAwOTMxMjE=", "number": 245, "title": "Daphne write log bug", "user": {"login": "leavest", "id": 30454841, "node_id": "MDQ6VXNlcjMwNDU0ODQx", "avatar_url": "https://avatars2.githubusercontent.com/u/30454841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leavest", "html_url": "https://github.com/leavest", "followers_url": "https://api.github.com/users/leavest/followers", "following_url": "https://api.github.com/users/leavest/following{/other_user}", "gists_url": "https://api.github.com/users/leavest/gists{/gist_id}", "starred_url": "https://api.github.com/users/leavest/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leavest/subscriptions", "organizations_url": "https://api.github.com/users/leavest/orgs", "repos_url": "https://api.github.com/users/leavest/repos", "events_url": "https://api.github.com/users/leavest/events{/privacy}", "received_events_url": "https://api.github.com/users/leavest/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-01-17T03:16:16Z", "updated_at": "2020-01-25T11:10:31Z", "closed_at": "2019-01-17T18:17:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I start project in command  line,\r\n```\u279c  daphne -u /tmp/django_ws.socket --access-log - --proxy-headers django_ws.asgi:application```\r\n the stdout is normal.\r\nBut when I start project with supervisor ,  tail -f  only get start log but not any stdout log.\r\n```\r\n\u279c tail -f django_ws.log\r\n2019-01-17 10:43:57,183 INFO     Starting server at unix:/tmp/django_ws.socket\r\n2019-01-17 10:43:57,184 INFO     HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n2019-01-17 10:43:57,184 INFO     Configuring endpoint unix:/tmp/django_ws.socket\r\n``` \r\nUntil I stop project with supervisor,  tail -f  get stdout log.\r\n```\r\n# After  I stop project with supervisor.\r\n192.168.169.57:0 - - [17/Jan/2019:10:44:00] \"WSCONNECTING /ws/terminal/\" - -\r\n192.168.169.57:0 - - [17/Jan/2019:10:44:00] \"WSCONNECT /ws/terminal/\" - -\r\n192.168.169.57:0 - - [17/Jan/2019:10:44:12] \"WSDISCONNECT /ws/terminal/\" - -\r\n192.168.169.57:0 - - [17/Jan/2019:10:44:23] \"WSCONNECTING /ws/terminal/\" - -\r\n192.168.169.57:0 - - [17/Jan/2019:10:44:23] \"WSCONNECT /ws/terminal/dev/\" - -\r\n192.168.169.57:0 - - [17/Jan/2019:10:44:49] \"WSDISCONNECT /ws/terminal/\" - -\r\n192.168.169.57:0 - - [17/Jan/2019:10:44:50] \"WSCONNECTING /ws/terminal/\" - -\r\n```\r\nThis problem  happen in both  my mac os 10.13.6  and centes7.5 .\r\n\r\nmy package versions\r\nchannels==2.1.6\r\nDjango==1.11\r\npython==3.5\r\n\r\n```\r\n# supervisor.conf\r\n[program:django_ws]\r\ncommand=daphne -u /tmp/django_ws.socket --access-log - --proxy-headers django_ws.asgi:application\r\ndirectory=/data/django_ws\r\nredirect_stderr=true\r\nstdout_logfile=/tmp/django_ws.log\r\nstdout_logfile_maxbytes=100MB\r\nstdout_logfile_backups=1\r\n```\r\n```\r\n# nginx.conf\r\n        location ^~ /ws/ {\r\n            proxy_pass http://unix:/tmp/django_ws.socket;\r\n            proxy_buffering off;\r\n            proxy_redirect off;\r\n            proxy_http_version 1.1;\r\n            proxy_set_header X-Real-IP $remote_addr;\r\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n            proxy_set_header Host $host:$server_port;\r\n            proxy_set_header Upgrade $http_upgrade;\r\n            proxy_set_header Connection $http_connection;\r\n            proxy_set_header X-Forwarded-Proto $scheme;\r\n        }\r\n```\r\n\r\nI expected get the stdout when i start project with supervisor without stop it.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/244", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/244/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/244/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/244/events", "html_url": "https://github.com/django/daphne/issues/244", "id": 396567317, "node_id": "MDU6SXNzdWUzOTY1NjczMTc=", "number": 244, "title": "'WebRequest' object has no attribute 'client_addr' under Firefox", "user": {"login": "lfaucheux", "id": 19575612, "node_id": "MDQ6VXNlcjE5NTc1NjEy", "avatar_url": "https://avatars0.githubusercontent.com/u/19575612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lfaucheux", "html_url": "https://github.com/lfaucheux", "followers_url": "https://api.github.com/users/lfaucheux/followers", "following_url": "https://api.github.com/users/lfaucheux/following{/other_user}", "gists_url": "https://api.github.com/users/lfaucheux/gists{/gist_id}", "starred_url": "https://api.github.com/users/lfaucheux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lfaucheux/subscriptions", "organizations_url": "https://api.github.com/users/lfaucheux/orgs", "repos_url": "https://api.github.com/users/lfaucheux/repos", "events_url": "https://api.github.com/users/lfaucheux/events{/privacy}", "received_events_url": "https://api.github.com/users/lfaucheux/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 439649777, "node_id": "MDU6TGFiZWw0Mzk2NDk3Nzc=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/user-response", "name": "blocked/user-response", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-01-07T16:57:07Z", "updated_at": "2019-01-28T13:17:31Z", "closed_at": "2019-01-28T13:17:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "While instantiating a `WebSocket` object under ***Firefox64***, i.e.\r\n\r\n    new WebSocket(`wss://${window.location.host}/path/to/room`);\r\n\r\n... and having Daphne set to the highest level of verbosity, I get the following server-side error:\r\n    \r\n\t[07/Jan/2019:17:09:51 +0100] [upstream] [903083] STDERR: 2019-01-07 16:09:51,657 INFO     \"127.0.0.1\" - - [11/Mar/1970:02:49:09 +0000] \"GET / HTTP/1.1\" 500 27 \"https://bored.alwaysdata.net/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0\"\r\n\t[07/Jan/2019:17:09:51 +0100] [upstream] [903083] STDERR: 2019-01-07 16:09:51,657 DEBUG    HTTP response complete for ['127.0.0.1', 42164]\r\n\t[07/Jan/2019:17:09:51 +0100] [upstream] [903083] STDERR: 2019-01-07 16:09:51,658 DEBUG    poll 622.967 ms took 0.098 ms: 1 events\r\n\t[07/Jan/2019:17:09:51 +0100] [upstream] [903083] STDERR: 2019-01-07 16:09:51,658 DEBUG    poll 622.617 ms took 0.050 ms: 1 events\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR: 2019-01-07 16:09:53,819 DEBUG    poll 999.816 ms took 536.038 ms: 1 events\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR: 2019-01-07 16:09:53,819 DEBUG    poll 463.229 ms took 0.011 ms: 1 events\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR: 2019-01-07 16:09:53,820 DEBUG    poll 462.904 ms took 0.008 ms: 1 events\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR: 2019-01-07 16:09:53,821 CRITICAL Unhandled Error\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR: Traceback (most recent call last):\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/internet/asyncioreactor.py\", line 267, in run\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     self._asyncioEventloop.run_forever()\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/usr/alwaysdata/python/3.7.1/lib/python3.7/asyncio/base_events.py\", line 528, in run_forever\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     self._run_once()\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/usr/alwaysdata/python/3.7.1/lib/python3.7/asyncio/base_events.py\", line 1756, in _run_once\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     handle._run()\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/usr/alwaysdata/python/3.7.1/lib/python3.7/asyncio/events.py\", line 88, in _run\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     self._context.run(self._callback, *self._args)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR: --- <exception caught here> ---\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/python/log.py\", line 103, in callWithLogger\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     return callWithContext({\"system\": lp}, func, *args, **kw)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/python/log.py\", line 86, in callWithContext\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     return context.call({ILogContext: newCtx}, func, *args, **kw)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/python/context.py\", line 122, in callWithContext\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     return self.currentContext().callWithContext(ctx, func, *args, **kw)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/python/context.py\", line 85, in callWithContext\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     return func(*args,**kw)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/internet/asyncioreactor.py\", line 141, in _readOrWrite\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     self._disconnectSelectable(selectable, why, read)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/internet/posixbase.py\", line 255, in _disconnectSelectable\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     selectable.connectionLost(f)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/internet/tcp.py\", line 327, in connectionLost\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     protocol.connectionLost(reason)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/twisted/web/http.py\", line 2339, in connectionLost\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     request.connectionLost(reason)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:   File \"/home/.virtualenvs/boredenv/lib/python3.7/site-packages/daphne/http_protocol.py\", line 202, in connectionLost\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR:     logger.debug(\"HTTP disconnect for %s\", self.client_addr)\r\n\t[07/Jan/2019:17:09:53 +0100] [upstream] [903083] STDERR: builtins.AttributeError: 'WebRequest' object has no attribute 'client_addr'\r\n\r\n***With Chrome***, the [WebSocket-Upgrade](https://developer.mozilla.org/en-US/docs/Web/HTTP/Protocol_upgrade_mechanism#Upgrading_to_a_WebSocket_connection) is perfectly handled, see \r\n\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,440 INFO     \"127.0.0.1\" - - [11/Mar/1970:02:52:07 +0000] \"GET / HTTP/1.1\" 200 2540 \"https://bored.alwaysdata.net/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/17.17134\"\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,440 DEBUG    HTTP response complete for ['127.0.0.1', 59340]\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,440 DEBUG    poll 20.169 ms took 0.019 ms: 1 events\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,441 DEBUG    poll 19.849 ms took 0.052 ms: 1 events\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,535 DEBUG    poll 957.750 ms took 74.050 ms: 1 events\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,536 DEBUG    HTTP b'GET' request for ['127.0.0.1', 59340]\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,580 DEBUG    poll 881.080 ms took 42.220 ms: 1 events\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,581 DEBUG    poll 838.234 ms took 0.014 ms: 1 events\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,586 DEBUG    Upgraded connection ['127.0.0.1', 60946] to WebSocket\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,635 DEBUG    poll 783.904 ms took 0.011 ms: 1 events\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,638 DEBUG    poll 780.953 ms took 0.026 ms: 1 events\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,639 DEBUG    WebSocket ['127.0.0.1', 60946] open and established\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,639 DEBUG    WebSocket ['127.0.0.1', 60946] accepted by application\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,651 DEBUG    poll 779.949 ms took 12.212 ms: 1 events\r\n\t[07/Jan/2019:17:12:50 +0100] [upstream] [903083] STDERR: 2019-01-07 16:12:50,652 DEBUG    HTTP 200 response started for ['127.0.0.1', 59340]\r\n\t...\r\n\r\n\r\n***Client-side***, all this results in a 400 status code. \r\n\r\n<hr>\r\n\r\nMy *OS* is *Debian GNU/Linux 8.11 (jessie)* and `pip freeze` returns\r\n \r\n\taioredis==1.2.0\r\n\tasgiref==2.3.2\r\n\tasn1crypto==0.24.0\r\n\tasync-timeout==3.0.1\r\n\tattrs==18.2.0\r\n\tautobahn==18.12.1\r\n\tAutomat==0.7.0\r\n\tcertifi==2018.11.29\r\n\tcffi==1.11.5\r\n\tchannels==2.1.6\r\n\tchannels-redis==2.3.2\r\n\tchardet==3.0.4\r\n\tconstantly==15.1.0\r\n\tcryptography==2.4.2\r\n\tCython==0.29.2\r\n\tdaphne==2.2.4\r\n\tdefusedxml==0.5.0\r\n\tDjango==2.1.4\r\n\tdjango-allauth==0.38.0\r\n\tdjango-extensions==1.6.7\r\n\th2==3.0.1\r\n\thiredis==0.3.1\r\n\thpack==3.0.0\r\n\thyperframe==5.1.0\r\n\thyperlink==18.0.0\r\n\tidna==2.8\r\n\tincremental==17.5.0\r\n\tmsgpack==0.5.6\r\n\toauthlib==2.1.0\r\n\tPillow==5.3.0\r\n\tpriority==1.3.0\r\n\tpsycopg2-binary==2.7.6.1\r\n\tpyasn1==0.4.5\r\n\tpyasn1-modules==0.2.3\r\n\tpycparser==2.19\r\n\tPyHamcrest==1.9.0\r\n\tpyOpenSSL==18.0.0\r\n\tpyproj==1.9.5.1\r\n\tpython-dateutil==2.7.5\r\n\tpython3-openid==3.1.0\r\n\tpytz==2018.7\r\n\tredis==3.0.1\r\n\trequests==2.21.0\r\n\trequests-oauthlib==1.0.0\r\n\tservice-identity==18.1.0\r\n\tsix==1.12.0\r\n\tTwisted==18.9.0\r\n\ttxaio==18.8.1\r\n\turllib3==1.24.1\r\n\twhitenoise==4.1.2\r\n\tzope.interface==4.6.0\r\n\r\nBut I had the same problem with previous versions, regarding the libraries' or Python3's.\r\n\r\nps: Daphne is awesome.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/243", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/243/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/243/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/243/events", "html_url": "https://github.com/django/daphne/issues/243", "id": 394814754, "node_id": "MDU6SXNzdWUzOTQ4MTQ3NTQ=", "number": 243, "title": "Serving static files", "user": {"login": "ChibahAbdelwahab", "id": 32682904, "node_id": "MDQ6VXNlcjMyNjgyOTA0", "avatar_url": "https://avatars0.githubusercontent.com/u/32682904?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChibahAbdelwahab", "html_url": "https://github.com/ChibahAbdelwahab", "followers_url": "https://api.github.com/users/ChibahAbdelwahab/followers", "following_url": "https://api.github.com/users/ChibahAbdelwahab/following{/other_user}", "gists_url": "https://api.github.com/users/ChibahAbdelwahab/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChibahAbdelwahab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChibahAbdelwahab/subscriptions", "organizations_url": "https://api.github.com/users/ChibahAbdelwahab/orgs", "repos_url": "https://api.github.com/users/ChibahAbdelwahab/repos", "events_url": "https://api.github.com/users/ChibahAbdelwahab/events{/privacy}", "received_events_url": "https://api.github.com/users/ChibahAbdelwahab/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-29T18:16:52Z", "updated_at": "2018-12-30T17:23:09Z", "closed_at": "2018-12-30T17:23:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nI'm trying to use Daphne on production for all traffic HTTP and WebSocket, the problem is that the static files are not found,\r\nI saw in a previous issue that i should  follow these 3 steps from https://docs.djangoproject.com/en/2.0/howto/static-files/deployment/#serving-static-files-in-production\r\n\r\n- Push your code up to the deployment server.\r\n- On the server, run collectstatic to copy all the static files into STATIC_ROOT.\r\n- Configure your web server to serve the files in STATIC_ROOT under the URL STATIC_URL. \r\nHow can i configure Daphne so that it can serve the static files? \r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/242", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/242/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/242/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/242/events", "html_url": "https://github.com/django/daphne/issues/242", "id": 393899849, "node_id": "MDU6SXNzdWUzOTM4OTk4NDk=", "number": 242, "title": "Server.websocket_handshake_timeout is ignored in CLI", "user": {"login": "snb2013", "id": 4496388, "node_id": "MDQ6VXNlcjQ0OTYzODg=", "avatar_url": "https://avatars2.githubusercontent.com/u/4496388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/snb2013", "html_url": "https://github.com/snb2013", "followers_url": "https://api.github.com/users/snb2013/followers", "following_url": "https://api.github.com/users/snb2013/following{/other_user}", "gists_url": "https://api.github.com/users/snb2013/gists{/gist_id}", "starred_url": "https://api.github.com/users/snb2013/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/snb2013/subscriptions", "organizations_url": "https://api.github.com/users/snb2013/orgs", "repos_url": "https://api.github.com/users/snb2013/repos", "events_url": "https://api.github.com/users/snb2013/events{/privacy}", "received_events_url": "https://api.github.com/users/snb2013/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-12-24T15:31:33Z", "updated_at": "2018-12-24T17:49:47Z", "closed_at": "2018-12-24T16:06:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "I cannot set handshake timeout when using daphne CLI. websocket_connect_timeout is not useful, connection breaks after 5 seconds. I try to emulate 300 users and 5 seconds timeout is too small.\r\nI want to have option websocket_handshake_timeout in CLI.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/241", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/241/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/241/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/241/events", "html_url": "https://github.com/django/daphne/issues/241", "id": 392919590, "node_id": "MDU6SXNzdWUzOTI5MTk1OTA=", "number": 241, "title": "daphne running bug?", "user": {"login": "jeeyshe", "id": 33649388, "node_id": "MDQ6VXNlcjMzNjQ5Mzg4", "avatar_url": "https://avatars0.githubusercontent.com/u/33649388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeeyshe", "html_url": "https://github.com/jeeyshe", "followers_url": "https://api.github.com/users/jeeyshe/followers", "following_url": "https://api.github.com/users/jeeyshe/following{/other_user}", "gists_url": "https://api.github.com/users/jeeyshe/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeeyshe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeeyshe/subscriptions", "organizations_url": "https://api.github.com/users/jeeyshe/orgs", "repos_url": "https://api.github.com/users/jeeyshe/repos", "events_url": "https://api.github.com/users/jeeyshe/events{/privacy}", "received_events_url": "https://api.github.com/users/jeeyshe/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-20T07:16:07Z", "updated_at": "2018-12-20T13:51:24Z", "closed_at": "2018-12-20T13:51:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "I found a bug while develop daphne, the case is: if i set one more works in supervisor, my servermachine CPU useing up to very highly rate, with time going by, even to 100%, what a surprise\uff01here is the screen and my supervisor settings:\r\n\r\n![image](https://user-images.githubusercontent.com/33649388/50269499-55daf180-0469-11e9-87df-d3010ccd7712.png)\r\n\r\n![image](https://user-images.githubusercontent.com/33649388/50269717-24aef100-046a-11e9-821b-2912cb8e8675.png)\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/240", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/240/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/240/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/240/events", "html_url": "https://github.com/django/daphne/issues/240", "id": 392425480, "node_id": "MDU6SXNzdWUzOTI0MjU0ODA=", "number": 240, "title": "develop project problem", "user": {"login": "jeeyshe", "id": 33649388, "node_id": "MDQ6VXNlcjMzNjQ5Mzg4", "avatar_url": "https://avatars0.githubusercontent.com/u/33649388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeeyshe", "html_url": "https://github.com/jeeyshe", "followers_url": "https://api.github.com/users/jeeyshe/followers", "following_url": "https://api.github.com/users/jeeyshe/following{/other_user}", "gists_url": "https://api.github.com/users/jeeyshe/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeeyshe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeeyshe/subscriptions", "organizations_url": "https://api.github.com/users/jeeyshe/orgs", "repos_url": "https://api.github.com/users/jeeyshe/repos", "events_url": "https://api.github.com/users/jeeyshe/events{/privacy}", "received_events_url": "https://api.github.com/users/jeeyshe/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-19T03:24:03Z", "updated_at": "2018-12-20T00:13:58Z", "closed_at": "2018-12-20T00:13:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "I used to develop my channels project with daphne+supervisor+nginx, I am sure it works good in test,  when i develop it on my server machin, all of the http-interface is right, but websocket-interface got unexpected code 404, here are my settings:\r\n\r\n- supervisor.ini:\r\n# ------------------------------------------------start---------------------------------------------------\r\n[fcgi-program:asgi]\r\n# TCP socket used by Nginx backend upstream\r\n\r\n#user=root\r\n\r\nsocket=tcp://127.0.0.1:8000\r\n\r\n# Directory where your site's project files are located\r\ndirectory=/var/www/DEEPANDSERVER\r\n\r\ncommand=/root/venvs/deepand-server/bin/daphne -u /run/daphne/daphne%(process_num)d.sock --fd 0 --access-log - --proxy-headers smaill_project.asgi:application\r\n\r\n#command=/root/evens/deepand-server/bin/daphne -b 127.0.0.1 -p 8000 --access-log - --proxy-headers smaill_project.asgi:application\r\nnumprocs=4\r\n\r\n# Give each process a unique name so they can be told apart\r\nprocess_name=asgi%(process_num)d\r\n\r\n# Automatically start and recover processes\r\nautostart=true\r\nautorestart=true\r\n\r\n# Choose where you want your log to go\r\nstdout_logfile=/etc/asgi/asgi.log\r\nredirect_stderr=true\r\n# ------------------------------------------------end---------------------------------------------------\r\n\r\n- nginx.conf\r\n\r\nupstream channels-backend {\r\n    server 127.0.0.1:8000;\r\n}\r\n# ...\r\nserver {\r\n    #...\r\n    listen 80;\r\n    listen 443 ssl;\r\n    server_name api.deepand.com;\r\n    #include snippets/snakeoil.conf;\r\n    ssl_certificate   /etc/nginx/ssl/certs/214786680550050.pem;\r\n    ssl_certificate_key  /etc/nginx/ssl/private/214786680550050.key;\r\n    location / {\r\n        try_files $uri @proxy_to_app;\r\n    }\r\n    #...\r\n    access_log /etc/nginx/asgi.log;\r\n    error_log /etc/nginx/asgi_error.log;\r\n    location @proxy_to_app {\r\n        proxy_pass http://channels-backend;\r\n        #proxy_pass http://127.0.0.1:8001;\r\n        proxy_http_version 1.1;\r\n        proxy_set_header Upgrade $http_upgrade;\r\n        proxy_set_header Connection \"upgrade\";\r\n\r\n        proxy_redirect off;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n\r\n\r\n        proxy_redirect off;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Host $server_name;\r\n    }\r\n    location /static {\r\n\r\n    }\r\n    # ...\r\n}\r\n   \r\n------\r\nmy packages and versions like this:\r\n\r\naioredis==1.2.0\r\nalipay-sdk-python==3.2.53\r\naliyun-python-sdk-core-v3==2.11.0\r\naliyun-python-sdk-dysmsapi==1.0.0\r\namqp==2.3.2\r\nasgiref==2.3.2\r\nasn1crypto==0.24.0\r\nasync-timeout==3.0.1\r\nattrs==18.2.0\r\nautobahn==18.11.2\r\nAutomat==0.7.0\r\nbilliard==3.5.0.4\r\ncelery==4.2.1\r\ncertifi==2018.4.16\r\ncffi==1.11.5\r\nchannels==2.1.6\r\nchannels-redis==2.3.2\r\nchardet==3.0.4\r\nconstantly==15.1.0\r\nconstruct==2.5.3\r\ncoreapi==2.3.3\r\ncoreschema==0.0.4\r\ncryptography==2.2.2\r\ndaphne==2.2.3\r\ndiff-match-patch==20181111\r\nDjango==2.0.7\r\ndjango-ckeditor==5.6.1\r\ndjango-cors-headers==2.3.0\r\ndjango-crispy-forms==1.7.2\r\ndjango-crontab==0.7.1\r\ndjango-filter==1.1.0\r\ndjango-filters==0.2.1\r\ndjango-formtools==2.1\r\ndjango-haystack==2.8.1\r\ndjango-import-export==1.1.0\r\ndjango-js-asset==1.1.0\r\ndjango-redis==4.9.0\r\ndjango-rest-swagger==2.2.0\r\ndjango-reversion==3.0.2\r\ndjangorestframework==3.8.2\r\ndjangorestframework-jwt==1.11.0\r\ndrf-extensions==0.3.1\r\ndrf-haystack==1.8.3\r\ndrf-writable-nested==0.5.0\r\nelasticsearch==2.4.1\r\net-xmlfile==1.0.1\r\nfdfs-client-py==1.2.6\r\nfuture==0.15.2\r\nhaystack==0.42\r\nhiredis==0.3.0\r\nhttplib2==0.9.2\r\nhyperlink==18.0.0\r\nidna==2.7\r\nincremental==17.5.0\r\nitsdangerous==0.24\r\nitypes==1.1.0\r\njdcal==1.4\r\nJinja2==2.10\r\nkombu==4.2.1\r\nlxml==4.2.5\r\nMarkdown==2.6.11\r\nMarkupSafe==1.0\r\nmsgpack==0.5.6\r\nmutagen==1.41.0\r\nnumpy==1.15.1\r\nodfpy==1.3.6\r\nopenapi-codec==1.3.2\r\nopenpyxl==2.5.10\r\npandas==0.23.4\r\npefile==2018.8.8\r\nPillow==5.2.0\r\npyasn1==0.4.4\r\npycparser==2.18\r\npycrypto==2.6.1\r\npycryptodome==3.7.2\r\nPyHamcrest==1.9.0\r\nPyJWT==1.6.4\r\nPyMySQL==0.9.1\r\npython-dateutil==2.7.3\r\npython-ptrace==0.9.3\r\npytz==2018.5\r\nPyYAML==3.13\r\nredis==2.10.6\r\nrequests==2.19.1\r\nrsa==4.0\r\nsimplejson==3.16.0\r\nsix==1.12.0\r\ntablib==0.12.1\r\n#Twisted==18.9.0\r\ntxaio==18.8.1\r\nunicodecsv==0.14.1\r\nuritemplate==3.0.0\r\nurllib3==1.23\r\nvine==1.1.4\r\nxlrd==1.1.0\r\nXlsxWriter==1.1.2\r\nxlwt==1.3.0\r\nzope.interface==4.6.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/239", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/239/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/239/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/239/events", "html_url": "https://github.com/django/daphne/issues/239", "id": 389159395, "node_id": "MDU6SXNzdWUzODkxNTkzOTU=", "number": 239, "title": "When using daphne with supervisor ,it crashed!", "user": {"login": "heroxxCN", "id": 19882347, "node_id": "MDQ6VXNlcjE5ODgyMzQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/19882347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heroxxCN", "html_url": "https://github.com/heroxxCN", "followers_url": "https://api.github.com/users/heroxxCN/followers", "following_url": "https://api.github.com/users/heroxxCN/following{/other_user}", "gists_url": "https://api.github.com/users/heroxxCN/gists{/gist_id}", "starred_url": "https://api.github.com/users/heroxxCN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heroxxCN/subscriptions", "organizations_url": "https://api.github.com/users/heroxxCN/orgs", "repos_url": "https://api.github.com/users/heroxxCN/repos", "events_url": "https://api.github.com/users/heroxxCN/events{/privacy}", "received_events_url": "https://api.github.com/users/heroxxCN/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-10T06:34:18Z", "updated_at": "2018-12-11T03:39:49Z", "closed_at": "2018-12-11T03:39:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am writing a small django project with channels,deploying it with daphne & nginx.\r\nWhen use command like below,it works well:\r\ndaphne --bind 127.0.0.1 --port 8003 my_proj.asgi:application\r\n\r\nBut I got an error when i use supervisor to manage daphne.\r\nThe supervisor configuration is like this:\r\n[program:daphne]\r\ndirectory=/my/path\r\ncommand=daphne --bind 127.0.0.1 --port 8003 myproj.asgi:application\r\nuser=root\r\nautostart=true\r\nautorestart=true\r\nstderr_logfile=/var/log/daphne_err.log\r\nstdout_logfile=/var/log/daphne_out.log\r\n\r\n\r\nI checked the daphne_err.log, it lookes like this:\r\nTraceback (most recent call last):\r\n  File \"/var/www/py3env/bin/daphne\", line 11, in <module>\r\n    sys.exit(CommandLineInterface.entrypoint())\r\n  File \"/var/www/py3env/lib/python3.6/site-packages/daphne/cli.py\", line 161, in entrypoint\r\n    cls().run(sys.argv[1:])\r\n  File \"/var/www/py3env/lib/python3.6/site-packages/daphne/cli.py\", line 222, in run\r\n    application = import_by_path(args.application)\r\n  File \"/var/www/py3env/lib/python3.6/site-packages/daphne/utils.py\", line 11, in import_by_path\r\n    module_path, object_path = path.split(\":\", 1)\r\nValueError: not enough values to unpack (expected 2, got 1)\r\n\r\nOS:ubuntu 16.04\r\npython 3.6.7\r\n\r\nchannels 2.1.5\r\ndaphne 2.2.3\r\nDjango 2.1.3\r\nuWSGI 2.0.17.1\r\n\r\nSupervisor is installed at:\r\n\r\n/usr/lib/python2.7/dist-packages/supervisor-3.2.0-nspkg.pth\r\n\r\n\r\nWhat should I do?\r\nCan anyone help me?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/238", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/238/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/238/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/238/events", "html_url": "https://github.com/django/daphne/issues/238", "id": 386638615, "node_id": "MDU6SXNzdWUzODY2Mzg2MTU=", "number": 238, "title": "daphne cannot support on python3.4", "user": {"login": "dazhi509", "id": 39083077, "node_id": "MDQ6VXNlcjM5MDgzMDc3", "avatar_url": "https://avatars2.githubusercontent.com/u/39083077?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dazhi509", "html_url": "https://github.com/dazhi509", "followers_url": "https://api.github.com/users/dazhi509/followers", "following_url": "https://api.github.com/users/dazhi509/following{/other_user}", "gists_url": "https://api.github.com/users/dazhi509/gists{/gist_id}", "starred_url": "https://api.github.com/users/dazhi509/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dazhi509/subscriptions", "organizations_url": "https://api.github.com/users/dazhi509/orgs", "repos_url": "https://api.github.com/users/dazhi509/repos", "events_url": "https://api.github.com/users/dazhi509/events{/privacy}", "received_events_url": "https://api.github.com/users/dazhi509/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-03T02:49:14Z", "updated_at": "2018-12-04T19:38:55Z", "closed_at": "2018-12-04T19:38:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "i try to run my project in enviroment ```python3.4,  channels 2.0.2, daphne 2.2.2```, but error such as: ```async def main_wrap(self, args, kwargs, call_result):  SyntaxError: invalid syntax```,  is there a daphne version that support python3.4 ?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/236", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/236/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/236/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/236/events", "html_url": "https://github.com/django/daphne/issues/236", "id": 384413101, "node_id": "MDU6SXNzdWUzODQ0MTMxMDE=", "number": 236, "title": "Add way to pass custom options to WebSocketServerFactory", "user": {"login": "cbergmiller", "id": 3929252, "node_id": "MDQ6VXNlcjM5MjkyNTI=", "avatar_url": "https://avatars3.githubusercontent.com/u/3929252?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cbergmiller", "html_url": "https://github.com/cbergmiller", "followers_url": "https://api.github.com/users/cbergmiller/followers", "following_url": "https://api.github.com/users/cbergmiller/following{/other_user}", "gists_url": "https://api.github.com/users/cbergmiller/gists{/gist_id}", "starred_url": "https://api.github.com/users/cbergmiller/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cbergmiller/subscriptions", "organizations_url": "https://api.github.com/users/cbergmiller/orgs", "repos_url": "https://api.github.com/users/cbergmiller/repos", "events_url": "https://api.github.com/users/cbergmiller/events{/privacy}", "received_events_url": "https://api.github.com/users/cbergmiller/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-26T16:35:27Z", "updated_at": "2018-11-26T17:16:34Z", "closed_at": "2018-11-26T17:16:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Currently there is no way to pass custom options to `WebSocketServerFactory` (autobahn).\r\nIn my case i want to set a `perMessageCompressionAccept` to enable a compression extension.\r\nIs this a feature that would be considered useful for other users?\r\nIf so, should this be added as an CLI argument?\r\nI could try to work on an a feature branch if there is a chance for merging.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/234", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/234/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/234/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/234/events", "html_url": "https://github.com/django/daphne/issues/234", "id": 382133170, "node_id": "MDU6SXNzdWUzODIxMzMxNzA=", "number": 234, "title": "When using --fd 0, daphne still listen on 127.0.0.1:8000", "user": {"login": "sprat", "id": 577183, "node_id": "MDQ6VXNlcjU3NzE4Mw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sprat", "html_url": "https://github.com/sprat", "followers_url": "https://api.github.com/users/sprat/followers", "following_url": "https://api.github.com/users/sprat/following{/other_user}", "gists_url": "https://api.github.com/users/sprat/gists{/gist_id}", "starred_url": "https://api.github.com/users/sprat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sprat/subscriptions", "organizations_url": "https://api.github.com/users/sprat/orgs", "repos_url": "https://api.github.com/users/sprat/repos", "events_url": "https://api.github.com/users/sprat/events{/privacy}", "received_events_url": "https://api.github.com/users/sprat/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-11-19T09:49:37Z", "updated_at": "2020-01-06T07:39:10Z", "closed_at": "2018-11-19T22:13:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When you pass `--fd 0` on the command line, daphne still listens on `127.0.0.1:8000`. It's is due to a bad test on `args.file_descriptor` in `CommandLineInterface.run` method when providing default host and port.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/233", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/233/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/233/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/233/events", "html_url": "https://github.com/django/daphne/issues/233", "id": 381121664, "node_id": "MDU6SXNzdWUzODExMjE2NjQ=", "number": 233, "title": "Deployment instructions inaccurate?", "user": {"login": "adrzystek", "id": 26262275, "node_id": "MDQ6VXNlcjI2MjYyMjc1", "avatar_url": "https://avatars3.githubusercontent.com/u/26262275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adrzystek", "html_url": "https://github.com/adrzystek", "followers_url": "https://api.github.com/users/adrzystek/followers", "following_url": "https://api.github.com/users/adrzystek/following{/other_user}", "gists_url": "https://api.github.com/users/adrzystek/gists{/gist_id}", "starred_url": "https://api.github.com/users/adrzystek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adrzystek/subscriptions", "organizations_url": "https://api.github.com/users/adrzystek/orgs", "repos_url": "https://api.github.com/users/adrzystek/repos", "events_url": "https://api.github.com/users/adrzystek/events{/privacy}", "received_events_url": "https://api.github.com/users/adrzystek/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-11-15T11:37:23Z", "updated_at": "2018-11-28T16:31:51Z", "closed_at": "2018-11-19T22:13:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nSorry if this is a noob issue but I find deployment instructions for Django Channels (https://channels.readthedocs.io/en/latest/deploying.html) inaccurate. I have described my problem at Stack Overflow (https://stackoverflow.com/questions/53304883/configuring-supervisor-for-daphne-django-channels) but as there I got no response, I write it here.\r\n\r\nNamely, in the example setup, in the supervisor configuration file, the command for running daphne is: `daphne -u /run/daphne/daphne%(process_num)d.sock --fd 0 --access-log - --proxy-headers mysite.asgi:application`. My key point is that there is no explanation about whether these socket files should be created by the user (and if so, what should they include). When I configurated my files according to these instructions the web application didn't work and in log files I saw critical errors `Listen failure: [Errno 2] No such file or directory: '1416' -> b'/run/daphne/daphne0.sock.lock'`. When I created these files (empty) then the error changed to `Listen failure: Couldn't listen on any:b'/run/daphne/daphne0.sock': [Errno 98] Address already in use.`. Additionally, the file descriptor parameter is also messy to me, why in this example it is set to 0?\r\n\r\nI know that this is probably not a place for such questions but explaining it here may help other inexperienced users...", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/229", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/229/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/229/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/229/events", "html_url": "https://github.com/django/daphne/issues/229", "id": 364349784, "node_id": "MDU6SXNzdWUzNjQzNDk3ODQ=", "number": 229, "title": "Implicit encoding of headers", "user": {"login": "imbolc", "id": 747996, "node_id": "MDQ6VXNlcjc0Nzk5Ng==", "avatar_url": "https://avatars0.githubusercontent.com/u/747996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imbolc", "html_url": "https://github.com/imbolc", "followers_url": "https://api.github.com/users/imbolc/followers", "following_url": "https://api.github.com/users/imbolc/following{/other_user}", "gists_url": "https://api.github.com/users/imbolc/gists{/gist_id}", "starred_url": "https://api.github.com/users/imbolc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imbolc/subscriptions", "organizations_url": "https://api.github.com/users/imbolc/orgs", "repos_url": "https://api.github.com/users/imbolc/repos", "events_url": "https://api.github.com/users/imbolc/events{/privacy}", "received_events_url": "https://api.github.com/users/imbolc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 439648660, "node_id": "MDU6TGFiZWw0Mzk2NDg2NjA=", "url": "https://api.github.com/repos/django/daphne/labels/exp/beginner", "name": "exp/beginner", "color": "bfdadc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-09-27T08:00:08Z", "updated_at": "2018-09-28T16:45:05Z", "closed_at": "2018-09-28T16:45:05Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Just swapped daphne with uvicorn for my django app and found some errors related to not encoded headers I was sending. Prove me if I'm wrong, but shouldn't daphne reject not encoded strings accordingly to ASGI standard? Here's an example which will be served by daphne but not by uvicorn (notice decoded heareds there):\r\n\r\n```python\r\nclass App():\r\n    def __init__(self, scope):\r\n        self.scope = scope\r\n\r\n    async def __call__(self, receive, send):\r\n        await send({\r\n            'type': 'http.response.start',\r\n            'status': 200,\r\n            'headers': [\r\n                ['content-type', 'text/plain'],\r\n            ]\r\n        })\r\n        await send({\r\n            'type': 'http.response.body',\r\n            'body': b'Hello, world!',\r\n        })\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/228", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/228/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/228/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/228/events", "html_url": "https://github.com/django/daphne/issues/228", "id": 363336925, "node_id": "MDU6SXNzdWUzNjMzMzY5MjU=", "number": 228, "title": "Improve compatibility with other ASGI server implementations", "user": {"login": "almarklein", "id": 3015475, "node_id": "MDQ6VXNlcjMwMTU0NzU=", "avatar_url": "https://avatars2.githubusercontent.com/u/3015475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/almarklein", "html_url": "https://github.com/almarklein", "followers_url": "https://api.github.com/users/almarklein/followers", "following_url": "https://api.github.com/users/almarklein/following{/other_user}", "gists_url": "https://api.github.com/users/almarklein/gists{/gist_id}", "starred_url": "https://api.github.com/users/almarklein/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/almarklein/subscriptions", "organizations_url": "https://api.github.com/users/almarklein/orgs", "repos_url": "https://api.github.com/users/almarklein/repos", "events_url": "https://api.github.com/users/almarklein/events{/privacy}", "received_events_url": "https://api.github.com/users/almarklein/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-24T22:01:25Z", "updated_at": "2018-09-25T08:19:40Z", "closed_at": "2018-09-24T23:32:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi! I love ASGI and how it cleanly separates server implementations from frameworks. But I am a bit disappointed that each server implementation has to be called in a slightly different way. I wonder if we can do better. I explored this a idea a bit [here](https://github.com/erm/asgi-examples/issues/2). In summary, it would be very hard and unnecessary to align things all the way; it would already be awesome if we could do:\r\n\r\n```\r\n$ daphne --bind 127.0.0.1:80 --log-level info mymodule:myapp\r\n$ uvicorn --bind 127.0.0.1:80 --log-level info mymodule:myapp\r\n$ hypercorn --bind 127.0.0.1:80 --log-level info mymodule:myapp\r\n$ server-something ... you get the idea\r\n```\r\n\r\nAnd also:\r\n```py\r\nfrom unicorn import run  # replace \"unicorn\" with \"daphne\" etc.\r\nrun(myapp, bind='127.0.0.1:80', log_level='info', **more_server_specifics)\r\n```\r\n\r\nEach server implementation would need just a bit of work to make this happen. For daphne:\r\n* The `--bind` argument to also include the port number, and maybe `fd:` and `unix:` style strings.\r\n* A `run()` function that sits in between [`CommandLineInterface.run()`](https://github.com/django/daphne/blob/master/daphne/cli.py#L143) and [`Server.__init__`](https://github.com/django/daphne/blob/master/daphne/server.py#L37).\r\n* Maybe a `log_level` arg as an \"alias\" for `verbosity`.\r\n\r\nI'd be happy to do some work on this. What do you think?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/227", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/227/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/227/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/227/events", "html_url": "https://github.com/django/daphne/issues/227", "id": 361721919, "node_id": "MDU6SXNzdWUzNjE3MjE5MTk=", "number": 227, "title": "Channels websocket AsyncJsonWebsocketConsumer disconnect method not reached", "user": {"login": "mindfuucker", "id": 5075692, "node_id": "MDQ6VXNlcjUwNzU2OTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/5075692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mindfuucker", "html_url": "https://github.com/mindfuucker", "followers_url": "https://api.github.com/users/mindfuucker/followers", "following_url": "https://api.github.com/users/mindfuucker/following{/other_user}", "gists_url": "https://api.github.com/users/mindfuucker/gists{/gist_id}", "starred_url": "https://api.github.com/users/mindfuucker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mindfuucker/subscriptions", "organizations_url": "https://api.github.com/users/mindfuucker/orgs", "repos_url": "https://api.github.com/users/mindfuucker/repos", "events_url": "https://api.github.com/users/mindfuucker/events{/privacy}", "received_events_url": "https://api.github.com/users/mindfuucker/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-19T12:21:09Z", "updated_at": "2018-09-21T11:07:04Z", "closed_at": "2018-09-21T05:24:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have the following consumer:\r\n```\r\nclass ChatConsumer(AsyncJsonWebsocketConsumer):\r\n    pusher = None\r\n\r\n    async def connect(self):\r\n        print(self.scope)\r\n        ip = self.scope['client'][0]\r\n        print(ip)\r\n        self.pusher = await self.get_pusher(ip)\r\n        print(self.pusher)\r\n        await self.accept()\r\n\r\n    async def disconnect(self, event):\r\n        print(\"closed connection\")\r\n        print(\"Close code = \", event)\r\n        await self.close()\r\n        raise StopConsumer\r\n\r\n    async def receive_json(self, content):\r\n        #print(content)\r\n        if 'categoryfunctionname' in content:\r\n            await cellvoltage(self.pusher, content)\r\n        else:\r\n            print(\"ERROR: Wrong data packets send\")\r\n            print(content)\r\n\r\n\r\n    @database_sync_to_async\r\n    def get_pusher(self, ip):\r\n        p = Pusher.objects.get(auto_id=1)\r\n        try:\r\n            p = Pusher.objects.get(ip=ip)\r\n        except ObjectDoesNotExist:\r\n            print(\"no pusher found\")\r\n        finally:\r\n            return p\r\n```\r\nConnecting, receiving and even getting stuff async from the database works perfectly. Only disconnecting does not work as expected. The following Terminal Log explains what's going on:\r\n\r\n```\r\n2018-09-19 07:09:56,653 - INFO - server - HTTP/2 support not enabled (install the http2 and tls Twisted extras)\r\n2018-09-19 07:09:56,653 - INFO - server - Configuring endpoint tcp:port=1111:interface=192.168.1.111\r\n2018-09-19 07:09:56,653 - INFO - server - Listening on TCP address 192.168.1.111:1111\r\n[2018/09/19 07:11:25] HTTP GET / 302 [0.02, 10.171.253.112:35236]\r\n[2018/09/19 07:11:25] HTTP GET /login/?next=/ 200 [0.05, 10.111.253.112:35236]\r\n{'type': 'websocket', 'path': '/ws/chat/RP1/', 'headers': [(b'upgrade', b'websocket'), (b'connection', b'Upgrade'), (b'host', b'10.111.111.112:1111'), (b'origin', b'http://10.111.253.112:1111'), (b'sec-websocket-key', b'vKFAnqaRMm84AGUCxbAm3g=='), (b'sec-websocket-version', b'13')], 'query_string': b'', 'client': ['10.111.253.112', 35238], 'server': ['192.168.1.111', 1111], 'subprotocols': [], 'cookies': {}, 'session': <django.utils.functional.LazyObject object at 0x7fe4a8d1ba20>, 'user': <django.utils.functional.LazyObject object at 0x7fe4a8d1b9e8>, 'path_remaining': '', 'url_route': {'args': (), 'kwargs': {'room_name': 'RP1'}}}\r\n10.111.253.112\r\n[2018/09/19 07:11:25] WebSocket HANDSHAKING /ws/chat/RP1/ [10.111.253.112:35238]\r\n[2018/09/19 07:11:25] WebSocket CONNECT /ws/chat/RP1/ [10.111.111.112:35238]\r\nno pusher found\r\n1 - DEFAULT - 0.0.0.0\r\nERROR: Wrong data packets send\r\n{'hello': 'Did I achieve my objective?'}\r\n[2018/09/19 07:11:46] WebSocket DISCONNECT /ws/chat/RP1/ [10.111.253.112:35238]\r\n2018-09-19 07:11:56,792 - WARNING - server - Application instance <Task pending coro=<SessionMiddlewareInstance.__call__() running at /home/pi/PycharmProjects/LOGGER/venv/lib/python3.6/site-packages/channels/sessions.py:175> wait_for=<Future pending cb=[_chain_future.<locals>._call_check_cancel() at /usr/lib/python3.6/asyncio/futures.py:403, <TaskWakeupMethWrapper object at 0x7fe4a82e6fd8>()]>> for connection <WebSocketProtocol client=['10.171.253.112', 35238] path=b'/ws/chat/RP1/'> took too long to shut down and was killed.\r\n```\r\nAfter the 10 seconds timeout it gives a warning that the connection was killed:\r\n\r\n> WARNING - server - Application instance taskname running at location at linenumber for connection cxn-name took too long to shut down and was killed.\r\nThe disconnect method was thus also not reached.\r\n\r\n- What could this be?\r\n- Am I using the correct method?\r\n- Could I expand the timeout period?\r\n\r\n---\r\nUbuntu 18.04 running Django 2.1\r\nChannels 2.1.3\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/226", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/226/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/226/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/226/events", "html_url": "https://github.com/django/daphne/issues/226", "id": 360043292, "node_id": "MDU6SXNzdWUzNjAwNDMyOTI=", "number": 226, "title": "CONFIGURABLE FILE UPLOAD SIZE LIMIT", "user": {"login": "alain-chevanier", "id": 16228995, "node_id": "MDQ6VXNlcjE2MjI4OTk1", "avatar_url": "https://avatars1.githubusercontent.com/u/16228995?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alain-chevanier", "html_url": "https://github.com/alain-chevanier", "followers_url": "https://api.github.com/users/alain-chevanier/followers", "following_url": "https://api.github.com/users/alain-chevanier/following{/other_user}", "gists_url": "https://api.github.com/users/alain-chevanier/gists{/gist_id}", "starred_url": "https://api.github.com/users/alain-chevanier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alain-chevanier/subscriptions", "organizations_url": "https://api.github.com/users/alain-chevanier/orgs", "repos_url": "https://api.github.com/users/alain-chevanier/repos", "events_url": "https://api.github.com/users/alain-chevanier/events{/privacy}", "received_events_url": "https://api.github.com/users/alain-chevanier/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-13T19:56:36Z", "updated_at": "2018-09-14T22:07:01Z", "closed_at": "2018-09-13T20:01:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please also try and include, if you can:\r\n\r\n- Your OS and runtime environment, and browser if applicable\r\n\r\nWe are running our application from  Heroku given the following Pocfile:\r\n\r\n```\r\nweb: daphne MyAppName.asgi:channel_layer --port $PORT --bind 0.0.0.0\r\nworker: python manage.py runworker\r\n```\r\n\r\n- A `pip freeze` output showing your package versions\r\n\r\n```\r\nchannels==1.1.8\r\nchannels-api==0.4.0\r\nasgi-redis==1.3.0\r\n```\r\n- What you expected to happen vs. what actually happened\r\n\r\nI'd like to configure the upload maximum allowed file size easily, either in a config file or a command line option.\r\n\r\n- How you're running Channels (runserver? daphne/runworker? Nginx/Apache in front?)\r\n\r\ndaphne/runworker\r\n\r\n- Console logs and full tracebacks of any errors\r\n\r\n```\r\n2018-09-13T19:53:11.927215+00:00 heroku[router]: at=info method=POST path=\"/vendor_data/2048/fin_state/1203/files/\" host=tradetapp-restapi-dev-pr-35.herokuapp.com request_id=4ee5c95d-5d40-4c32-b719-f6718c6eb15f fwd=\"201.174.156.26\" dyno=web.1 connect=0ms service=2067ms status=500 bytes=582 protocol=https\r\n2018-09-13T19:53:11.919674+00:00 app[web.1]: 10.93.179.248:32879 - - [13/Sep/2018:19:53:11] \"POST /vendor_data/2048/fin_state/1203/files/\" 500 445\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/225", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/225/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/225/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/225/events", "html_url": "https://github.com/django/daphne/issues/225", "id": 358778769, "node_id": "MDU6SXNzdWUzNTg3Nzg3Njk=", "number": 225, "title": "Couldn't connect daphne with nginx using proxy pass", "user": {"login": "ajithsayonetech", "id": 38239160, "node_id": "MDQ6VXNlcjM4MjM5MTYw", "avatar_url": "https://avatars3.githubusercontent.com/u/38239160?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ajithsayonetech", "html_url": "https://github.com/ajithsayonetech", "followers_url": "https://api.github.com/users/ajithsayonetech/followers", "following_url": "https://api.github.com/users/ajithsayonetech/following{/other_user}", "gists_url": "https://api.github.com/users/ajithsayonetech/gists{/gist_id}", "starred_url": "https://api.github.com/users/ajithsayonetech/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ajithsayonetech/subscriptions", "organizations_url": "https://api.github.com/users/ajithsayonetech/orgs", "repos_url": "https://api.github.com/users/ajithsayonetech/repos", "events_url": "https://api.github.com/users/ajithsayonetech/events{/privacy}", "received_events_url": "https://api.github.com/users/ajithsayonetech/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-09-10T20:20:06Z", "updated_at": "2018-09-11T06:31:27Z", "closed_at": "2018-09-11T06:31:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "I couldn't use the Nginx proxy pass to access Daphne server for my Django tenant schema architecture, since I use host names to identify my tenant and that is getting altered when I use proxy pass. Is there any alternative way such that I can access web socket requests through Daphne without losing request host name.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/223", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/223/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/223/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/223/events", "html_url": "https://github.com/django/daphne/issues/223", "id": 353459508, "node_id": "MDU6SXNzdWUzNTM0NTk1MDg=", "number": 223, "title": "Request not getting removed from queue", "user": {"login": "agronick", "id": 2042303, "node_id": "MDQ6VXNlcjIwNDIzMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/2042303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agronick", "html_url": "https://github.com/agronick", "followers_url": "https://api.github.com/users/agronick/followers", "following_url": "https://api.github.com/users/agronick/following{/other_user}", "gists_url": "https://api.github.com/users/agronick/gists{/gist_id}", "starred_url": "https://api.github.com/users/agronick/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agronick/subscriptions", "organizations_url": "https://api.github.com/users/agronick/orgs", "repos_url": "https://api.github.com/users/agronick/repos", "events_url": "https://api.github.com/users/agronick/events{/privacy}", "received_events_url": "https://api.github.com/users/agronick/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-23T16:29:20Z", "updated_at": "2018-11-27T21:02:36Z", "closed_at": "2018-08-24T02:19:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I am seeing the same log printing every two seconds \r\n\r\n```\r\nAug 23 12:22:50  python3[15132]: 2018-08-23 12:22:50,326 WARNING  Application timed out while sending response\r\nAug 23 12:22:52  python3[15132]: 2018-08-23 12:22:52,330 WARNING  Application timed out while sending response\r\nAug 23 12:22:54  python3[15132]: 2018-08-23 12:22:54,333 WARNING  Application timed out while sending response\r\nAug 23 12:22:56  python3[15132]: 2018-08-23 12:22:56,336 WARNING  Application timed out while sending response\r\nAug 23 12:22:58  python3[15132]: 2018-08-23 12:22:58,339 WARNING  Application timed out while sending response\r\nAug 23 12:23:00  python3[15132]: 2018-08-23 12:23:00,342 WARNING  Application timed out while sending response\r\nAug 23 12:23:02  python3[15132]: 2018-08-23 12:23:02,345 WARNING  Application timed out while sending response\r\nAug 23 12:23:04  python3[15132]: 2018-08-23 12:23:04,348 WARNING  Application timed out while sending response\r\nAug 23 12:23:06  python3[15132]: 2018-08-23 12:23:06,350 WARNING  Application timed out while sending response\r\n```\r\n\r\nIt appears that some request did time out but is not being removed. My HTTP timeout is very log (1800 seconds). There appears to be some code path where the timed out request never gets removed. This is a low traffic site so I know a new request isn't timing out for every iteration of this loop. This appears to be a rare error as this is the first time I've seen it.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/222", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/222/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/222/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/222/events", "html_url": "https://github.com/django/daphne/issues/222", "id": 350310612, "node_id": "MDU6SXNzdWUzNTAzMTA2MTI=", "number": 222, "title": "how cat i set the pidfile for daphne?", "user": {"login": "wilean", "id": 19581902, "node_id": "MDQ6VXNlcjE5NTgxOTAy", "avatar_url": "https://avatars3.githubusercontent.com/u/19581902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wilean", "html_url": "https://github.com/wilean", "followers_url": "https://api.github.com/users/wilean/followers", "following_url": "https://api.github.com/users/wilean/following{/other_user}", "gists_url": "https://api.github.com/users/wilean/gists{/gist_id}", "starred_url": "https://api.github.com/users/wilean/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wilean/subscriptions", "organizations_url": "https://api.github.com/users/wilean/orgs", "repos_url": "https://api.github.com/users/wilean/repos", "events_url": "https://api.github.com/users/wilean/events{/privacy}", "received_events_url": "https://api.github.com/users/wilean/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-14T07:26:53Z", "updated_at": "2018-08-14T17:15:31Z", "closed_at": "2018-08-14T17:15:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "how cat i set the pidfile for daphne?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/221", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/221/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/221/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/221/events", "html_url": "https://github.com/django/daphne/issues/221", "id": 348960661, "node_id": "MDU6SXNzdWUzNDg5NjA2NjE=", "number": 221, "title": "WebSocket connections unstable (Apache 2.4.6 / Daphne 2.2.1)", "user": {"login": "OMCS", "id": 3914622, "node_id": "MDQ6VXNlcjM5MTQ2MjI=", "avatar_url": "https://avatars0.githubusercontent.com/u/3914622?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OMCS", "html_url": "https://github.com/OMCS", "followers_url": "https://api.github.com/users/OMCS/followers", "following_url": "https://api.github.com/users/OMCS/following{/other_user}", "gists_url": "https://api.github.com/users/OMCS/gists{/gist_id}", "starred_url": "https://api.github.com/users/OMCS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OMCS/subscriptions", "organizations_url": "https://api.github.com/users/OMCS/orgs", "repos_url": "https://api.github.com/users/OMCS/repos", "events_url": "https://api.github.com/users/OMCS/events{/privacy}", "received_events_url": "https://api.github.com/users/OMCS/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-08-09T03:09:26Z", "updated_at": "2018-08-20T15:37:23Z", "closed_at": "2018-08-09T17:23:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm developing a Channels application and everything has been working perfectly with the built-in `runserver` command but I'm running into connection issues after deploying Daphne on my development server.\r\n\r\nMore often than not, WebSockets correctly connect over HTTPS and I can send and receive messages. Unfortunately I'm having issues related to connection stability.\r\n\r\n1. WebSockets often get stuck connecting (readyState 0) on page load. If I reload the page the connection is usually successful (readyState 1) but occasionally gets stuck again.\r\n\r\n2. I regularly see sockets close with an error that (on Safari) reads `connection to wss://my-domain.com/ws/6 failed: Status line contains non-ASCII characters`. At the same time I see a message in the Daphne log that reads `dropping connection to peer tcp4:127.0.0.1:38118 with abort=True: I dropped the WebSocket TCP connection: RSV = 4 and no extension negotiated`.\r\n\r\nI'm using Python 3.6.5, channels 2.1.2, channels-redis 2.2.1, Daphne 2.2.1 and Apache 2.4.6 to proxy WS requests. I know nginx is more commonly used for this purpose but unfortunately I'm stuck with Apache for this deployment.\r\n\r\nPlease see below for relevant code / config snippets, happy to provide more. This is my first time working with WebSockets and proxying so any help or ideas would be greatly appreciated!\r\n\r\nDaphne \r\n```\r\ndaphne -v2 -b 127.0.0.1 -e ssl:8443:privateKey=myKey.key:certKey=myCert.cert asgi:application\r\n```\r\n\r\nApache Config\r\n```\r\n<VirtualHost my.server.ip.address:443>\r\n...\r\nSSLProxyEngine on\r\nProxyPass /ws/ wss://localhost:8443/ws/\r\n...\r\n</VirtualHost>\r\n```\r\n\r\nWebSocket client connection - called in `$(document).ready()`\r\n```js\r\nfunction getWebSocket(userId) {\r\n    if (typeof window.prSocket === 'undefined')\r\n    {\r\n        var PROTOCOL =  location.host.includes(\"127.0.0.1\") ? \"ws://\" : \"wss://\";\r\n        var prSocket = new WebSocket(PROTOCOL + window.location.host +'/ws/' + userId + '/');\r\n        prSocket.onopen = handleSocketOpen;\r\n        prSocket.onclose = handleSocketClose;\r\n        prSocket.onmessage = function(message) { handleSocketMessage(message);};\r\n        return prSocket;\r\n    }\r\n    else\r\n    {\r\n        return window.prSocket;\r\n    }\r\n}\r\n```\r\n\r\nrouting.py (root of project)\r\n```py\r\nfrom channels.auth import AuthMiddlewareStack\r\nfrom channels.routing import ProtocolTypeRouter, URLRouter\r\n\r\nimport myapp.routing\r\n\r\napplication = ProtocolTypeRouter({\r\n    # (http->django views is added by default)\r\n     'websocket': AuthMiddlewareStack(\r\n        URLRouter(\r\n            myapp.routing.websocket_urlpatterns\r\n        )\r\n     ),\r\n})\r\n```\r\nrouting.py (inside app)\r\n```py\r\nfrom django.conf.urls import url\r\n\r\nfrom . import consumers\r\n\r\nwebsocket_urlpatterns = [\r\n    url(r'^ws/(?P<user_id>.+?)/$', consumers.MyConsumer),\r\n]\r\n```\r\n\r\nConnection in consumers.py\r\n\r\n```py\r\n async def connect(self):\r\n        self.user = self.scope[\"user\"]\r\n\r\n        if self.user.is_anonymous:\r\n            await self.close()\r\n        await self.accept()\r\n\r\n        # Create the Channel \"group\" for this user ID so messages can be sent and received outside this consumer\r\n        await self.channel_layer.group_add(str(self.user.id), self.channel_name)\r\n\r\n        self.groups = list(map(str, self.user.active_groups))\r\n\r\n        if not self.groups:\r\n            await self.handle_pending_invitations()\r\n        else:\r\n            for group_id in self.groups:\r\n                # Reconnect to any existing group channels and update state in DB\r\n                await self.channel_layer.group_add(\"{}{}\".format(settings.GROUP_REDIS_PREFIX, group_id), self.channel_name)\r\n                group_member = ParticipantGroupMember.objects.get(group=group_id, user=self.user)\r\n\r\n                if group_member.state != \"active\":\r\n                    group_member.state = \"active\"\r\n                    group_member.save()\r\n```\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/220", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/220/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/220/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/220/events", "html_url": "https://github.com/django/daphne/issues/220", "id": 344001588, "node_id": "MDU6SXNzdWUzNDQwMDE1ODg=", "number": 220, "title": "No module named 'daphne.cli'", "user": {"login": "RealLau", "id": 16678624, "node_id": "MDQ6VXNlcjE2Njc4NjI0", "avatar_url": "https://avatars2.githubusercontent.com/u/16678624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RealLau", "html_url": "https://github.com/RealLau", "followers_url": "https://api.github.com/users/RealLau/followers", "following_url": "https://api.github.com/users/RealLau/following{/other_user}", "gists_url": "https://api.github.com/users/RealLau/gists{/gist_id}", "starred_url": "https://api.github.com/users/RealLau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RealLau/subscriptions", "organizations_url": "https://api.github.com/users/RealLau/orgs", "repos_url": "https://api.github.com/users/RealLau/repos", "events_url": "https://api.github.com/users/RealLau/events{/privacy}", "received_events_url": "https://api.github.com/users/RealLau/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-24T11:45:41Z", "updated_at": "2018-07-26T23:30:24Z", "closed_at": "2018-07-26T23:30:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "I encountered a problem with version 2.2.1 as below:\r\n\r\n![image](https://user-images.githubusercontent.com/16678624/43136235-ac2469fe-8f7a-11e8-8cd8-7fe69b329c41.png)\r\n\r\nI'm sure I've installed daphne version 2.2.1:\r\n![image](https://user-images.githubusercontent.com/16678624/43136337-f7d42c0e-8f7a-11e8-8c91-567aae07e805.png)\r\n\r\nOS: CentOS 7\r\n\r\n\r\nBUT, when I clone this Repository and install it with 'python3 setup.py install' it works correctly.\r\n\r\nPlease have a check on daphne 2.2.1 integration with channels.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/217", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/217/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/217/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/217/events", "html_url": "https://github.com/django/daphne/issues/217", "id": 341364819, "node_id": "MDU6SXNzdWUzNDEzNjQ4MTk=", "number": 217, "title": "Daphne servers urlpatterns but does not routing", "user": {"login": "twrutniak", "id": 40645539, "node_id": "MDQ6VXNlcjQwNjQ1NTM5", "avatar_url": "https://avatars0.githubusercontent.com/u/40645539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/twrutniak", "html_url": "https://github.com/twrutniak", "followers_url": "https://api.github.com/users/twrutniak/followers", "following_url": "https://api.github.com/users/twrutniak/following{/other_user}", "gists_url": "https://api.github.com/users/twrutniak/gists{/gist_id}", "starred_url": "https://api.github.com/users/twrutniak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/twrutniak/subscriptions", "organizations_url": "https://api.github.com/users/twrutniak/orgs", "repos_url": "https://api.github.com/users/twrutniak/repos", "events_url": "https://api.github.com/users/twrutniak/events{/privacy}", "received_events_url": "https://api.github.com/users/twrutniak/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-16T00:23:27Z", "updated_at": "2018-07-16T17:16:35Z", "closed_at": "2018-07-16T17:16:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "- Ubuntu 16.04\r\n- Channels 2.1.2\r\n- Daphne 2.2.0\r\n- Twisted 18.4.0\r\n- Django 2.0.7\r\n- Python 3.5.2\r\nIt's run on remote Ubuntu VPS. What happens is that it serves `urlpatterns` urls just fine but it does not serve what is in `routing.py`. This was not an issue when running by manage.py, but now it's backed up by Nginx via a socket. When I want to connect to a `ws://`, log throws:\r\n```\r\nJul 16 02:19:04 isailor daphne[12445]: Not Found: /ws/usercode/e1cfb86161/236b6553fd4b215846e204dfed597f5abaa56147/\r\nJul 16 02:19:04 isailor daphne[12445]: 2018-07-16 00:19:04,223 WARNING  Not Found /ws/usercode/e1cfb86161/236b6553fd4b215846e204dfed597f5abaa56147/\r\n```\r\nMy `routing.py` looks like this:\r\n```\r\napplication = ProtocolTypeRouter({\r\n    \"websocket\":TokenAuthMiddlewareStack(\r\n        URLRouter([\r\n            path(\"ws/usercode/<str:usercode>/<str:authtoken>/\", ChatConsumer),\r\n            ]),\r\n        ),\r\n    })\r\n```\r\nRest is configured according to Channels deploying docs.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/216", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/216/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/216/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/216/events", "html_url": "https://github.com/django/daphne/issues/216", "id": 341058757, "node_id": "MDU6SXNzdWUzNDEwNTg3NTc=", "number": 216, "title": "Nginx Config", "user": {"login": "Pinaz993", "id": 4016145, "node_id": "MDQ6VXNlcjQwMTYxNDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/4016145?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Pinaz993", "html_url": "https://github.com/Pinaz993", "followers_url": "https://api.github.com/users/Pinaz993/followers", "following_url": "https://api.github.com/users/Pinaz993/following{/other_user}", "gists_url": "https://api.github.com/users/Pinaz993/gists{/gist_id}", "starred_url": "https://api.github.com/users/Pinaz993/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Pinaz993/subscriptions", "organizations_url": "https://api.github.com/users/Pinaz993/orgs", "repos_url": "https://api.github.com/users/Pinaz993/repos", "events_url": "https://api.github.com/users/Pinaz993/events{/privacy}", "received_events_url": "https://api.github.com/users/Pinaz993/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-07-13T15:17:11Z", "updated_at": "2018-07-19T12:46:15Z", "closed_at": "2018-07-15T06:57:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to define a deployment method for a Django Channels project. Right now, I'm very hung up on how to configure Nginx as a proxy for Daphne. I understand how to route to a unix socket using the `-u` option on Daphne. (For now, until I choose the location of the socket, I'm using TCP.) I understand how to configure static files. What's puzzling me is how to send all non-media requests to Daphne. \r\n\r\nI have not been able to find any tutorials or example configuration on how to do this with Daphne. I can do it with uwsgi, even if I don't quite understand what I'm doing.\r\n\r\nMy ultimate goal is to provide the project files and a no-knowledge-assumption tutorial on how to deploy the project to a Raspberry Pi. \r\n\r\nI would also like (but do not require) details about what each line in the configuration is doing. This will allow me to round out my understanding of the stack and be able to solve some problems on my own.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/215", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/215/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/215/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/215/events", "html_url": "https://github.com/django/daphne/issues/215", "id": 340217952, "node_id": "MDU6SXNzdWUzNDAyMTc5NTI=", "number": 215, "title": "Application instances killed before delivering `websocket.disconnect` message \"in case of an exception\"", "user": {"login": "youshn", "id": 19710408, "node_id": "MDQ6VXNlcjE5NzEwNDA4", "avatar_url": "https://avatars2.githubusercontent.com/u/19710408?v=4", "gravatar_id": "", "url": "https://api.github.com/users/youshn", "html_url": "https://github.com/youshn", "followers_url": "https://api.github.com/users/youshn/followers", "following_url": "https://api.github.com/users/youshn/following{/other_user}", "gists_url": "https://api.github.com/users/youshn/gists{/gist_id}", "starred_url": "https://api.github.com/users/youshn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/youshn/subscriptions", "organizations_url": "https://api.github.com/users/youshn/orgs", "repos_url": "https://api.github.com/users/youshn/repos", "events_url": "https://api.github.com/users/youshn/events{/privacy}", "received_events_url": "https://api.github.com/users/youshn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 439649777, "node_id": "MDU6TGFiZWw0Mzk2NDk3Nzc=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/user-response", "name": "blocked/user-response", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-07-11T12:21:16Z", "updated_at": "2018-07-23T15:57:30Z", "closed_at": "2018-07-23T15:57:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nchannels==2.1.2\r\nchannels-redis==2.1.1\r\ndaphne==2.2.0\r\nDjango==2.0.7\r\n```\r\n\r\nis it possible that #152 is still not fixed in case of an exception in my app", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/214", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/214/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/214/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/214/events", "html_url": "https://github.com/django/daphne/issues/214", "id": 339686965, "node_id": "MDU6SXNzdWUzMzk2ODY5NjU=", "number": 214, "title": "Extremely slow HTTP on DEBUG=False", "user": {"login": "SHxKM", "id": 6573474, "node_id": "MDQ6VXNlcjY1NzM0NzQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6573474?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SHxKM", "html_url": "https://github.com/SHxKM", "followers_url": "https://api.github.com/users/SHxKM/followers", "following_url": "https://api.github.com/users/SHxKM/following{/other_user}", "gists_url": "https://api.github.com/users/SHxKM/gists{/gist_id}", "starred_url": "https://api.github.com/users/SHxKM/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SHxKM/subscriptions", "organizations_url": "https://api.github.com/users/SHxKM/orgs", "repos_url": "https://api.github.com/users/SHxKM/repos", "events_url": "https://api.github.com/users/SHxKM/events{/privacy}", "received_events_url": "https://api.github.com/users/SHxKM/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-07-10T04:15:13Z", "updated_at": "2018-11-19T22:14:11Z", "closed_at": "2018-11-19T22:14:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Update:** this is also happening, to a lessser degree, on production when DEBUG=False.\r\n\r\nI'm running the following stack:\r\n\r\n```\r\nchannels==2.1.2\r\nchannels-redis==2.2.1\r\ndaphne==2.2.0\r\nDjango==1.11.6\r\n```\r\n\r\nProcfile:\r\n\r\n```\r\nweb: daphne -p $PORT -b 0.0.0.0 artist_notify.asgi:application\r\ncelerybeat: celery -A artist_notify beat -l debug\r\nceleryworker: celery -A artist_notify worker -l info\r\n```\r\n\r\nIf I change `web:` to `gunicorn artist_notify.wsgi` site becomes instantly faster.\r\n\r\nSo I'm on the channels-redis version that is mentioned as a fix for  #185, which seems very simillar to what I'm experiencing.\r\n\r\nAttached is a screenshot: Channels 2 is the spike in the middle, rest is Channels 1. I am using group_send, but the slow responses occur regardless of whether a websocket connection is even present:\r\n\r\n![musicbutler metrics heroku 2](https://user-images.githubusercontent.com/6573474/42488987-1eb81ef4-8411-11e8-878b-e5ceb40180b1.png)\r\n\r\n\r\nI've tried disabling all kinds of potential culprits but that didn't help much.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/212", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/212/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/212/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/212/events", "html_url": "https://github.com/django/daphne/issues/212", "id": 337203023, "node_id": "MDU6SXNzdWUzMzcyMDMwMjM=", "number": 212, "title": "Add nginx example config", "user": {"login": "kamilgregorczyk", "id": 9266336, "node_id": "MDQ6VXNlcjkyNjYzMzY=", "avatar_url": "https://avatars1.githubusercontent.com/u/9266336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kamilgregorczyk", "html_url": "https://github.com/kamilgregorczyk", "followers_url": "https://api.github.com/users/kamilgregorczyk/followers", "following_url": "https://api.github.com/users/kamilgregorczyk/following{/other_user}", "gists_url": "https://api.github.com/users/kamilgregorczyk/gists{/gist_id}", "starred_url": "https://api.github.com/users/kamilgregorczyk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kamilgregorczyk/subscriptions", "organizations_url": "https://api.github.com/users/kamilgregorczyk/orgs", "repos_url": "https://api.github.com/users/kamilgregorczyk/repos", "events_url": "https://api.github.com/users/kamilgregorczyk/events{/privacy}", "received_events_url": "https://api.github.com/users/kamilgregorczyk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-06-30T09:59:47Z", "updated_at": "2018-07-02T05:56:16Z", "closed_at": "2018-06-30T21:58:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, could you maybe provide a nginx config (maybe even for http 2) which could be used? \r\nMany people use nginx as a reverse proxy for static files and for gunicorn/uwsgi proxy to django", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/211", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/211/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/211/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/211/events", "html_url": "https://github.com/django/daphne/issues/211", "id": 334849110, "node_id": "MDU6SXNzdWUzMzQ4NDkxMTA=", "number": 211, "title": "how to monitor daphne using nagios or similar tools?", "user": {"login": "Henner", "id": 1674487, "node_id": "MDQ6VXNlcjE2NzQ0ODc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1674487?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Henner", "html_url": "https://github.com/Henner", "followers_url": "https://api.github.com/users/Henner/followers", "following_url": "https://api.github.com/users/Henner/following{/other_user}", "gists_url": "https://api.github.com/users/Henner/gists{/gist_id}", "starred_url": "https://api.github.com/users/Henner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Henner/subscriptions", "organizations_url": "https://api.github.com/users/Henner/orgs", "repos_url": "https://api.github.com/users/Henner/repos", "events_url": "https://api.github.com/users/Henner/events{/privacy}", "received_events_url": "https://api.github.com/users/Henner/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-06-22T11:45:54Z", "updated_at": "2018-06-24T18:11:38Z", "closed_at": "2018-06-24T18:11:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "what do I have to monitor an how would I do it? Should I monitor all protocols? Using the default check_http does not work. it returns:\r\nInvalid HTTP response received from host on port 443: HTTP/1.1 400 WebSocket connection denied - Hixie76 protocol not supported.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/210", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/210/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/210/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/210/events", "html_url": "https://github.com/django/daphne/issues/210", "id": 334212799, "node_id": "MDU6SXNzdWUzMzQyMTI3OTk=", "number": 210, "title": "Any chance of having a base init script to manage lifecycle via systemd/upstart/etc?", "user": {"login": "greysondn", "id": 3652901, "node_id": "MDQ6VXNlcjM2NTI5MDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/3652901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/greysondn", "html_url": "https://github.com/greysondn", "followers_url": "https://api.github.com/users/greysondn/followers", "following_url": "https://api.github.com/users/greysondn/following{/other_user}", "gists_url": "https://api.github.com/users/greysondn/gists{/gist_id}", "starred_url": "https://api.github.com/users/greysondn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/greysondn/subscriptions", "organizations_url": "https://api.github.com/users/greysondn/orgs", "repos_url": "https://api.github.com/users/greysondn/repos", "events_url": "https://api.github.com/users/greysondn/events{/privacy}", "received_events_url": "https://api.github.com/users/greysondn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-06-20T19:12:49Z", "updated_at": "2018-06-28T21:25:49Z", "closed_at": "2018-06-21T02:31:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Wow, what a mouthful.\r\n\r\nI can't track everything that daphne must be dependent on already being loaded, but it seems like there is no reason that basic init recipes can't be given. And it's precisely because I can't track all of that for a django-channels project that, you know, this is put here.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/209", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/209/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/209/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/209/events", "html_url": "https://github.com/django/daphne/issues/209", "id": 333513497, "node_id": "MDU6SXNzdWUzMzM1MTM0OTc=", "number": 209, "title": "Serving static and media files", "user": {"login": "void4", "id": 11392207, "node_id": "MDQ6VXNlcjExMzkyMjA3", "avatar_url": "https://avatars3.githubusercontent.com/u/11392207?v=4", "gravatar_id": "", "url": "https://api.github.com/users/void4", "html_url": "https://github.com/void4", "followers_url": "https://api.github.com/users/void4/followers", "following_url": "https://api.github.com/users/void4/following{/other_user}", "gists_url": "https://api.github.com/users/void4/gists{/gist_id}", "starred_url": "https://api.github.com/users/void4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/void4/subscriptions", "organizations_url": "https://api.github.com/users/void4/orgs", "repos_url": "https://api.github.com/users/void4/repos", "events_url": "https://api.github.com/users/void4/events{/privacy}", "received_events_url": "https://api.github.com/users/void4/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-06-19T04:15:17Z", "updated_at": "2018-06-20T12:29:06Z", "closed_at": "2018-06-20T12:29:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've searched some time, but couldn't find any tutorial on how to serve static *and* user uploaded (/media/) files in conjunction with Daphne. I've read that Apache doesn't support ASGI, that it may be possible to use Nginx, but nothing specific.\r\n\r\nI've also tried [whitenoise](https://github.com/evansd/whitenoise) (which only supports static files) and [dj-static](https://github.com/heroku-python/dj-static) (which only supports WSGI). I'd like not to use external CDNs, for privacy reasons.\r\n\r\nCan you provide any hints on possible setups?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/207", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/207/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/207/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/207/events", "html_url": "https://github.com/django/daphne/issues/207", "id": 326196929, "node_id": "MDU6SXNzdWUzMjYxOTY5Mjk=", "number": 207, "title": "Version 2.1.2 breaks websocket connections with AssertionError", "user": {"login": "xolan", "id": 670050, "node_id": "MDQ6VXNlcjY3MDA1MA==", "avatar_url": "https://avatars2.githubusercontent.com/u/670050?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xolan", "html_url": "https://github.com/xolan", "followers_url": "https://api.github.com/users/xolan/followers", "following_url": "https://api.github.com/users/xolan/following{/other_user}", "gists_url": "https://api.github.com/users/xolan/gists{/gist_id}", "starred_url": "https://api.github.com/users/xolan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xolan/subscriptions", "organizations_url": "https://api.github.com/users/xolan/orgs", "repos_url": "https://api.github.com/users/xolan/repos", "events_url": "https://api.github.com/users/xolan/events{/privacy}", "received_events_url": "https://api.github.com/users/xolan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 18, "created_at": "2018-05-24T16:23:18Z", "updated_at": "2018-05-26T10:17:04Z", "closed_at": "2018-05-26T10:16:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi!\r\n\r\nThe newly released version `2.1.2` breaks my websocket connections with the following error:\r\n\r\n```\r\n2018-05-24 16:00:48,563 ERROR    Traceback (most recent call last):\r\n  File \"/root/.local/share/virtualenvs/lh8-tools-QNwECfds/lib/python3.6/site-packages/daphne/ws_protocol.py\", line 56, in onConnect\r\n    self.client_addr\r\n  File \"/root/.local/share/virtualenvs/lh8-tools-QNwECfds/lib/python3.6/site-packages/daphne/utils.py\", line 49, in parse_x_forwarded_for\r\n    assert all(isinstance(name, bytes) for name in headers.keys())\r\nAssertionError\r\n```\r\n\r\nWould be nice if it told us what was wrong instead of just raising an AssertionError :)\r\n\r\nJavascript websocket-client.\r\nDaphne proxied behind nginx or caddy.\r\n\r\nReverting to `2.1.1` fixes the issue.\r\n\r\nRelated commit: https://github.com/django/daphne/commit/b3c097aabdc477ed7e666a4a0d87250db1b2a9d2", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/206", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/206/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/206/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/206/events", "html_url": "https://github.com/django/daphne/issues/206", "id": 325975357, "node_id": "MDU6SXNzdWUzMjU5NzUzNTc=", "number": 206, "title": "AttributeError: 'NoneType' object has no attribute 'done'", "user": {"login": "em1208", "id": 14072653, "node_id": "MDQ6VXNlcjE0MDcyNjUz", "avatar_url": "https://avatars0.githubusercontent.com/u/14072653?v=4", "gravatar_id": "", "url": "https://api.github.com/users/em1208", "html_url": "https://github.com/em1208", "followers_url": "https://api.github.com/users/em1208/followers", "following_url": "https://api.github.com/users/em1208/following{/other_user}", "gists_url": "https://api.github.com/users/em1208/gists{/gist_id}", "starred_url": "https://api.github.com/users/em1208/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/em1208/subscriptions", "organizations_url": "https://api.github.com/users/em1208/orgs", "repos_url": "https://api.github.com/users/em1208/repos", "events_url": "https://api.github.com/users/em1208/events{/privacy}", "received_events_url": "https://api.github.com/users/em1208/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 439649777, "node_id": "MDU6TGFiZWw0Mzk2NDk3Nzc=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/user-response", "name": "blocked/user-response", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-05-24T06:02:33Z", "updated_at": "2018-05-25T10:34:12Z", "closed_at": "2018-05-25T10:34:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm running daphne 2.1.1 under nginx proxy. When I connect to the websocket I get this error:\r\n\r\nERROR 2018-05-24 05:46:01,284 base_events 22 140015681480448 Exception in callback AsyncioSelectorReactor.callLater.<locals>.run() at /usr/local/lib/python3.5/site-packages/twisted/internet/asyncioreactor.py:287\r\nhandle: <TimerHandle when=599743.236895389 AsyncioSelectorReactor.callLater.<locals>.run() at /usr/local/lib/python3.5/site-packages/twisted/internet/asyncioreactor.py:287>\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.5/asyncio/events.py\", line 127, in _run\r\n    self._callback(*self._args)\r\n  File \"/usr/local/lib/python3.5/site-packages/twisted/internet/asyncioreactor.py\", line 290, in run\r\n    f(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/site-packages/daphne/server.py\", line 213, in application_checker\r\n    if not application_instance.done():\r\nAttributeError: 'NoneType' object has no attribute 'done'\r\n\r\nLooks like a bug in daphne. Any help please?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/205", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/205/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/205/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/205/events", "html_url": "https://github.com/django/daphne/issues/205", "id": 325937337, "node_id": "MDU6SXNzdWUzMjU5MzczMzc=", "number": 205, "title": "KeyError from create_application", "user": {"login": "brianmay", "id": 112729, "node_id": "MDQ6VXNlcjExMjcyOQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/112729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianmay", "html_url": "https://github.com/brianmay", "followers_url": "https://api.github.com/users/brianmay/followers", "following_url": "https://api.github.com/users/brianmay/following{/other_user}", "gists_url": "https://api.github.com/users/brianmay/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianmay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianmay/subscriptions", "organizations_url": "https://api.github.com/users/brianmay/orgs", "repos_url": "https://api.github.com/users/brianmay/repos", "events_url": "https://api.github.com/users/brianmay/events{/privacy}", "received_events_url": "https://api.github.com/users/brianmay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 439648660, "node_id": "MDU6TGFiZWw0Mzk2NDg2NjA=", "url": "https://api.github.com/repos/django/daphne/labels/exp/beginner", "name": "exp/beginner", "color": "bfdadc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 26, "created_at": "2018-05-24T02:03:05Z", "updated_at": "2018-07-06T01:26:35Z", "closed_at": "2018-07-06T01:26:35Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Since upgrading to Channels 2, I get a number of these errors. I suspect this happens when restarting the deployed instance:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/daphne/http_protocol.py\", line 160, in process\r\n    \"server\": self.server_addr,\r\n  File \"/usr/local/lib/python3.6/site-packages/twisted/internet/defer.py\", line 1386, in _inlineCallbacks\r\n    result = g.send(result)\r\n  File \"/usr/local/lib/python3.6/site-packages/daphne/server.py\", line 191, in create_application\r\n    ), loop=asyncio.get_event_loop())\r\nKeyError: <WebRequest at 0x7ff738677710 method=GET uri=/api/internal/projects/21/managed_objects/ clientproto=HTTP/1.1>\r\n```\r\n\r\nUnfortunately, it doesn't help that there is a lot happening on this line, and I am not sure what part causes this error.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/204", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/204/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/204/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/204/events", "html_url": "https://github.com/django/daphne/issues/204", "id": 325390494, "node_id": "MDU6SXNzdWUzMjUzOTA0OTQ=", "number": 204, "title": "Add Env Var to suggest Twisted's thread pool size", "user": {"login": "robdoesstuff", "id": 3971396, "node_id": "MDQ6VXNlcjM5NzEzOTY=", "avatar_url": "https://avatars2.githubusercontent.com/u/3971396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robdoesstuff", "html_url": "https://github.com/robdoesstuff", "followers_url": "https://api.github.com/users/robdoesstuff/followers", "following_url": "https://api.github.com/users/robdoesstuff/following{/other_user}", "gists_url": "https://api.github.com/users/robdoesstuff/gists{/gist_id}", "starred_url": "https://api.github.com/users/robdoesstuff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robdoesstuff/subscriptions", "organizations_url": "https://api.github.com/users/robdoesstuff/orgs", "repos_url": "https://api.github.com/users/robdoesstuff/repos", "events_url": "https://api.github.com/users/robdoesstuff/events{/privacy}", "received_events_url": "https://api.github.com/users/robdoesstuff/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-22T17:23:00Z", "updated_at": "2018-05-23T12:27:58Z", "closed_at": "2018-05-23T12:27:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "For deployment tuning, it would be helpful if daphne could be configured with a variable to call reactor.suggestThreadPoolSize(TWISTED_THREADS) in twisted\r\n\r\nRight now it can be hacked in to an app if needed but this route would be better.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/203", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/203/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/203/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/203/events", "html_url": "https://github.com/django/daphne/issues/203", "id": 325386998, "node_id": "MDU6SXNzdWUzMjUzODY5OTg=", "number": 203, "title": "Initialize asyncio reactor with preconfigured ThreadPoolExecutor to control thread counts", "user": {"login": "robdoesstuff", "id": 3971396, "node_id": "MDQ6VXNlcjM5NzEzOTY=", "avatar_url": "https://avatars2.githubusercontent.com/u/3971396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robdoesstuff", "html_url": "https://github.com/robdoesstuff", "followers_url": "https://api.github.com/users/robdoesstuff/followers", "following_url": "https://api.github.com/users/robdoesstuff/following{/other_user}", "gists_url": "https://api.github.com/users/robdoesstuff/gists{/gist_id}", "starred_url": "https://api.github.com/users/robdoesstuff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robdoesstuff/subscriptions", "organizations_url": "https://api.github.com/users/robdoesstuff/orgs", "repos_url": "https://api.github.com/users/robdoesstuff/repos", "events_url": "https://api.github.com/users/robdoesstuff/events{/privacy}", "received_events_url": "https://api.github.com/users/robdoesstuff/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-22T17:12:31Z", "updated_at": "2018-05-24T08:29:28Z", "closed_at": "2018-05-24T08:29:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Daphne currently initializes an asyncio reactor with no default executor, so when something like aioredis is used (as it is in redis_channels), a default ThreadPoolExecutor is created on first execute call which has cpu_count * 5 threads as default (which is suboptimal for many deployments).\r\n\r\nConsider adding something like the following to daphne's server.py where plain asyncioreactor.install() is being used now:\r\n\r\nfrom asyncio.events import new_event_loop\r\nfrom concurrent.futures import ThreadPoolExecutor\r\n\r\n    event_loop = new_event_loop()\r\n    threadpool = ThreadPoolExecutor(\r\n        max_workers=(\r\n            int(os.environ[\"ASIO_THREADS\"])\r\n            if \"ASIO_THREADS\" in os.environ\r\n            else None\r\n        )\r\n    )\r\n    event_loop.set_default_executor(threadpool)\r\n    asyncioreactor.install(event_loop)\r\n\r\nWhen testing on OSX, I was able to control the asyncioreactor thread pool size using the ASIO_THREADS env variable with this code.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/202", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/202/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/202/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/202/events", "html_url": "https://github.com/django/daphne/issues/202", "id": 325297962, "node_id": "MDU6SXNzdWUzMjUyOTc5NjI=", "number": 202, "title": "Daphne sevice unit for systemd is not working, daphne.socket vs daphne.sevice", "user": {"login": "mahsa-poorjafari", "id": 5405035, "node_id": "MDQ6VXNlcjU0MDUwMzU=", "avatar_url": "https://avatars1.githubusercontent.com/u/5405035?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mahsa-poorjafari", "html_url": "https://github.com/mahsa-poorjafari", "followers_url": "https://api.github.com/users/mahsa-poorjafari/followers", "following_url": "https://api.github.com/users/mahsa-poorjafari/following{/other_user}", "gists_url": "https://api.github.com/users/mahsa-poorjafari/gists{/gist_id}", "starred_url": "https://api.github.com/users/mahsa-poorjafari/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mahsa-poorjafari/subscriptions", "organizations_url": "https://api.github.com/users/mahsa-poorjafari/orgs", "repos_url": "https://api.github.com/users/mahsa-poorjafari/repos", "events_url": "https://api.github.com/users/mahsa-poorjafari/events{/privacy}", "received_events_url": "https://api.github.com/users/mahsa-poorjafari/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-05-22T13:38:00Z", "updated_at": "2020-06-03T14:27:39Z", "closed_at": "2018-05-22T15:03:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, @andrewgodwin\r\nI am facing a problem to start daphne service by systemd on CentOS.\r\nThe first question, I've got confused with daphne.socket and daphne.sevice. Is daphne.socket file necessary? Or I can run daphne service by having only daphne.sevice?\r\n\r\nThe second question, daphne.service is not running.\r\nHere my daphne.socket unit which starts successfully:\r\n\r\n```\r\n#/etc/systemd/system/daphne.socket\r\n[Unit]\r\nDescription=Daphne Socket\r\n\r\n[Socket]\r\nListenStream=0.0.0.0:80\r\nAccept=yes\r\n[Install]\r\nWantedBy=sockets.target\r\n```\r\n\r\n\r\n**systemctl status daphne.socket** :\r\n\r\n> daphne.socket - Daphne Socket\r\n>    Loaded: loaded (/etc/systemd/system/daphne.socket; enabled; vendor preset: disabled)\r\n>    Active: active (listening) since (date) CEST; 1s ago\r\n>    Listen: 0.0.0.0:80 (Stream)\r\n>  Accepted: 1; Connected: 0\r\n\r\nAnd here is my daphne.service unit:\r\n\r\n ```\r\n#/etc/systemd/system/daphne.service\r\n [Unit]\r\n Description=daphne server script for MyProject\r\n Requires=daphne.socket\r\n After=syslog.target\r\n After=network.target\r\n After=nginx.service\r\n \r\n [Service]\r\n Type=simple\r\n WorkingDirectory=/path/to/MyProject\r\n ExecStart=path/to/venv/bin/daphne -b 0.0.0.0 -p 80 --root-path=/path/to/MyProject MyProject.asgi:channel_layer\r\n Restart=always\r\n StandardInput=socket\r\n StandardError=journal\r\n \r\n [Install]\r\n WantedBy=multi-user.target\r\n```\r\n\r\n**systemctl status daphne.service**\r\n\r\n> daphne.service - daphne server script for MyProject\r\n>    Loaded: loaded (/etc/systemd/system/daphne.service; enabled; vendor preset: disabled)\r\n>    Active: failed (Result: start-limit) since (date) CEST; 3s ago\r\n>  Main PID: 20347 (code=exited, status=1/FAILURE)\r\n\r\n> CentOS-74-64-minimal systemd[1]: daphne.service failed to run 'start' task: Invalid argument\r\n> CentOS-74-64-minimal systemd[1]: Failed to start daphne server script for MyProject\r\n> CentOS-74-64-minimal systemd[1]: Unit daphne.service entered failed state.\r\n> CentOS-74-64-minimal systemd[1]: daphne.service failed.\r\n> CentOS-74-64-minimal systemd[1]: Starting daphne server script for MyProject...\r\n> CentOS-74-64-minimal systemd[1]: daphne.service holdoff time over, scheduling restart.\r\n> CentOS-74-64-minimal systemd[1]: start request repeated too quickly for daphne.service\r\n\r\n**journalctl -u daphne.service**\r\n\r\n> CentOS-74-64-minimal systemd[1]: Got more than one socket.\r\n\r\nSo, anyone has any idea what is wrong here? Because I don't.\r\nThank you so much in advance\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/201", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/201/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/201/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/201/events", "html_url": "https://github.com/django/daphne/issues/201", "id": 325068904, "node_id": "MDU6SXNzdWUzMjUwNjg5MDQ=", "number": 201, "title": "ram consumption", "user": {"login": "luk156", "id": 1016684, "node_id": "MDQ6VXNlcjEwMTY2ODQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/1016684?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luk156", "html_url": "https://github.com/luk156", "followers_url": "https://api.github.com/users/luk156/followers", "following_url": "https://api.github.com/users/luk156/following{/other_user}", "gists_url": "https://api.github.com/users/luk156/gists{/gist_id}", "starred_url": "https://api.github.com/users/luk156/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luk156/subscriptions", "organizations_url": "https://api.github.com/users/luk156/orgs", "repos_url": "https://api.github.com/users/luk156/repos", "events_url": "https://api.github.com/users/luk156/events{/privacy}", "received_events_url": "https://api.github.com/users/luk156/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-05-21T21:41:19Z", "updated_at": "2018-07-03T16:50:21Z", "closed_at": "2018-05-22T09:03:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Sorry for my english.\r\n\r\nthe ram consumption of my istances grow over time. \r\nI've a big query in my code that raise a 504 error on my server,i've to fix this bug but at the same time i see that the memory consumed by daphne process it is not reduced. it increases during query but does not decrease after", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/200", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/200/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/200/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/200/events", "html_url": "https://github.com/django/daphne/issues/200", "id": 324696729, "node_id": "MDU6SXNzdWUzMjQ2OTY3Mjk=", "number": 200, "title": "daphne doesn't close websocket ", "user": {"login": "Necrobsd", "id": 25165728, "node_id": "MDQ6VXNlcjI1MTY1NzI4", "avatar_url": "https://avatars1.githubusercontent.com/u/25165728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Necrobsd", "html_url": "https://github.com/Necrobsd", "followers_url": "https://api.github.com/users/Necrobsd/followers", "following_url": "https://api.github.com/users/Necrobsd/following{/other_user}", "gists_url": "https://api.github.com/users/Necrobsd/gists{/gist_id}", "starred_url": "https://api.github.com/users/Necrobsd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Necrobsd/subscriptions", "organizations_url": "https://api.github.com/users/Necrobsd/orgs", "repos_url": "https://api.github.com/users/Necrobsd/repos", "events_url": "https://api.github.com/users/Necrobsd/events{/privacy}", "received_events_url": "https://api.github.com/users/Necrobsd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 439649777, "node_id": "MDU6TGFiZWw0Mzk2NDk3Nzc=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/user-response", "name": "blocked/user-response", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-05-20T09:46:13Z", "updated_at": "2018-05-22T09:02:41Z", "closed_at": "2018-05-21T02:52:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello! I use Daphne 2 and Channels 2 on my backend behind Nginx. \r\nI want to disconnect websockets if clients connection is broken.\r\nNginx config:\r\n```\r\nserver {\r\n    listen 80;\r\n    location / {\r\n                proxy_pass http://unix:/home/myproject/daphne.sock;\r\n                proxy_http_version 1.1;\r\n                proxy_set_header Upgrade $http_upgrade;\r\n                proxy_set_header Connection \"upgrade\";\r\n                proxy_redirect     off;\r\n                proxy_set_header   Host $host;\r\n                proxy_set_header   X-Real-IP $remote_addr;\r\n                proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;\r\n                proxy_set_header   X-Forwarded-Host $server_name;\r\n    }\r\n}\r\n```\r\nDaphne runs with command: \r\n`daphne --ping-interval 2 --ping-timeout 10 -u /home/myproject/daphne.sock  myproject.asgi:application`\r\n\r\nUsing a browser, I connect to the websocket, receive some messages, then I close browser, but websocket is still running and doesnt close even after 10 seconds.\r\nWhat Im doing wrong?\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/198", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/198/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/198/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/198/events", "html_url": "https://github.com/django/daphne/issues/198", "id": 320531463, "node_id": "MDU6SXNzdWUzMjA1MzE0NjM=", "number": 198, "title": "ODROID , resolution settings not working", "user": {"login": "bebess", "id": 38323653, "node_id": "MDQ6VXNlcjM4MzIzNjUz", "avatar_url": "https://avatars2.githubusercontent.com/u/38323653?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bebess", "html_url": "https://github.com/bebess", "followers_url": "https://api.github.com/users/bebess/followers", "following_url": "https://api.github.com/users/bebess/following{/other_user}", "gists_url": "https://api.github.com/users/bebess/gists{/gist_id}", "starred_url": "https://api.github.com/users/bebess/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bebess/subscriptions", "organizations_url": "https://api.github.com/users/bebess/orgs", "repos_url": "https://api.github.com/users/bebess/repos", "events_url": "https://api.github.com/users/bebess/events{/privacy}", "received_events_url": "https://api.github.com/users/bebess/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-05T18:33:30Z", "updated_at": "2018-05-06T05:25:07Z", "closed_at": "2018-05-06T05:25:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi !\r\ni'm on odroid (xu4) version of daphne\r\n\r\nthe command line \r\n-fullscreen x-640 y-480\r\n\r\ndoesn't work at all , i can change to 640x480 or 1024x768 or another resolutions\r\nthat dont change anything , i stay with a very very tiny screen (maybe 320x200)\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/197", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/197/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/197/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/197/events", "html_url": "https://github.com/django/daphne/issues/197", "id": 320142803, "node_id": "MDU6SXNzdWUzMjAxNDI4MDM=", "number": 197, "title": "Apps aren't loaded yet error", "user": {"login": "rubyxyr", "id": 13798364, "node_id": "MDQ6VXNlcjEzNzk4MzY0", "avatar_url": "https://avatars1.githubusercontent.com/u/13798364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rubyxyr", "html_url": "https://github.com/rubyxyr", "followers_url": "https://api.github.com/users/rubyxyr/followers", "following_url": "https://api.github.com/users/rubyxyr/following{/other_user}", "gists_url": "https://api.github.com/users/rubyxyr/gists{/gist_id}", "starred_url": "https://api.github.com/users/rubyxyr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rubyxyr/subscriptions", "organizations_url": "https://api.github.com/users/rubyxyr/orgs", "repos_url": "https://api.github.com/users/rubyxyr/repos", "events_url": "https://api.github.com/users/rubyxyr/events{/privacy}", "received_events_url": "https://api.github.com/users/rubyxyr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-05-04T03:16:32Z", "updated_at": "2018-05-04T03:43:07Z", "closed_at": "2018-05-04T03:43:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "my asgi.py is \r\n```\r\nimport os\r\nimport django\r\nfrom channels.routing import get_default_application\r\n\r\nos.environ.setdefault(\"DJANGO_SETTINGS_MODULE\", \"my_project.settings\")\r\ndjango.setup()\r\napplication = get_default_application()\r\n```\r\nbut when I run my nameko events in my project \r\n```\r\nnameko run microservice.client:ResultClient --config config.yaml\r\n```\r\nand my ```ResultClient``` has another app's celery tasks code\r\n```\r\nfrom scheduler.tasks import result_get\r\nresult_get.delay(payload['service_name'], payload['uuid'], payload['target_type'])\r\n```\r\nthen error appear \r\n```\r\nTraceback (most recent call last):\r\n  File \"./microservice/client/result_client.py\", line 16, in result_exists\r\n    from scheduler.tasks import result_get\r\n  File \"./scheduler/tasks.py\", line 7, in <module>\r\n    from django.contrib.auth.models import User\r\n  File \"/usr/local/lib/python3.6/site-packages/django/contrib/auth/models.py\", line 2, in <module>\r\n    from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager\r\n  File \"/usr/local/lib/python3.6/site-packages/django/contrib/auth/base_user.py\", line 47, in <module>\r\n    class AbstractBaseUser(models.Model):\r\n  File \"/usr/local/lib/python3.6/site-packages/django/db/models/base.py\", line 100, in __new__\r\n    app_config = apps.get_containing_app_config(module)\r\n  File \"/usr/local/lib/python3.6/site-packages/django/apps/registry.py\", line 244, in get_containing_app_config\r\n    self.check_apps_ready()\r\n  File \"/usr/local/lib/python3.6/site-packages/django/apps/registry.py\", line 127, in check_apps_ready\r\n    raise AppRegistryNotReady(\"Apps aren't loaded yet.\")\r\ndjango.core.exceptions.AppRegistryNotReady: Apps aren't loaded yet.\r\n```\r\nAnd in my settings:\r\n```\r\nINSTALLED_APPS = [\r\n   ...\r\n   'scheduler',\r\n   'channels',\r\n]\r\n\r\nASGI_APPLICATION = \"my_project.routing.application\"\r\n\r\nCHANNEL_LAYERS = {\r\n    \"default\": {\r\n        \"BACKEND\": \"channels_redis.core.RedisChannelLayer\",\r\n        \"CONFIG\": {\r\n            \"hosts\": [os.environ.get('CHANNEL_REDIS_URL', '')],\r\n        },\r\n    },\r\n}\r\n\r\n```\r\n\r\nI run ```daphne -b 0.0.0.0 -p 8000 my_project.asgi:application``` in supervisord.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/196", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/196/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/196/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/196/events", "html_url": "https://github.com/django/daphne/issues/196", "id": 319091193, "node_id": "MDU6SXNzdWUzMTkwOTExOTM=", "number": 196, "title": "No route found for path for static file", "user": {"login": "DiegoGallegos4", "id": 5933437, "node_id": "MDQ6VXNlcjU5MzM0Mzc=", "avatar_url": "https://avatars0.githubusercontent.com/u/5933437?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DiegoGallegos4", "html_url": "https://github.com/DiegoGallegos4", "followers_url": "https://api.github.com/users/DiegoGallegos4/followers", "following_url": "https://api.github.com/users/DiegoGallegos4/following{/other_user}", "gists_url": "https://api.github.com/users/DiegoGallegos4/gists{/gist_id}", "starred_url": "https://api.github.com/users/DiegoGallegos4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DiegoGallegos4/subscriptions", "organizations_url": "https://api.github.com/users/DiegoGallegos4/orgs", "repos_url": "https://api.github.com/users/DiegoGallegos4/repos", "events_url": "https://api.github.com/users/DiegoGallegos4/events{/privacy}", "received_events_url": "https://api.github.com/users/DiegoGallegos4/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-05-01T01:40:30Z", "updated_at": "2018-05-01T03:11:55Z", "closed_at": "2018-05-01T03:11:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Got an error when daphne tries to serve staticfiles under **python manage.py runserver**\r\n\r\n- Versions: Django(2.0.3), Channels (2.1.1), daphne(2.1.1)\r\nTraceback: \r\n\r\n> 2018-05-01 01:33:03,344 - ERROR - http_protocol - Traceback (most recent call last):\r\n...\r\nFile \"/lib/python3.6/site-packages/channels/routing.py\", line 140, in __call__\r\n    raise ValueError(\"No route found for path %r.\" % path)\r\nValueError: No route found for path 'favicon.ico'.\r\n\r\n\r\nRunning the server without channels work without any warnings or problems.\r\n\r\nWhen running *channel* or *websocket* type router it works fine but when adding *http* type then this error is thrown.\r\n\r\n\r\nEDIT: Forgot to add match everything pattern as documentation states: \r\n\r\n```\r\nurl(r\"(.*?)\", AsgiHandler),\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/195", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/195/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/195/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/195/events", "html_url": "https://github.com/django/daphne/issues/195", "id": 318429435, "node_id": "MDU6SXNzdWUzMTg0Mjk0MzU=", "number": 195, "title": "[Question] Warning about Twisted reactor", "user": {"login": "abhrj", "id": 38240391, "node_id": "MDQ6VXNlcjM4MjQwMzkx", "avatar_url": "https://avatars1.githubusercontent.com/u/38240391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhrj", "html_url": "https://github.com/abhrj", "followers_url": "https://api.github.com/users/abhrj/followers", "following_url": "https://api.github.com/users/abhrj/following{/other_user}", "gists_url": "https://api.github.com/users/abhrj/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhrj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhrj/subscriptions", "organizations_url": "https://api.github.com/users/abhrj/orgs", "repos_url": "https://api.github.com/users/abhrj/repos", "events_url": "https://api.github.com/users/abhrj/events{/privacy}", "received_events_url": "https://api.github.com/users/abhrj/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-04-27T14:24:49Z", "updated_at": "2018-05-01T16:41:18Z", "closed_at": "2018-04-27T16:30:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "In a django app that is using daphne + channels 2, when running any command such as `./manage.py migrate` or `daphne I see the following warning:\r\n\r\n```\r\nvenv/lib/python3.6/site-packages/daphne/server.py:12: UserWarning: Something has already installed a\r\nnon-asyncio Twisted reactor. Attempting to uninstall it; you can fix this warning by importing\r\ndaphne.server early in your codebase or finding the package that imports Twisted and importing it later\r\non.\r\n```\r\n\r\nI found out the other library which was installing a \"non-asyncio Twisted reactor\". And I can probably delay its import.\r\n\r\nBut I have some questions:\r\n* If I import the other library after daphne, wouldn't daphne's reactor get replaced?\r\n* If the other library is based on a sync reactor, is it incompatible with daphne?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/194", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/194/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/194/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/194/events", "html_url": "https://github.com/django/daphne/issues/194", "id": 318051352, "node_id": "MDU6SXNzdWUzMTgwNTEzNTI=", "number": 194, "title": "AttributeError: 'WebSocketProtocol' object has no attribute 'application_queue' error", "user": {"login": "bsr3000", "id": 26166272, "node_id": "MDQ6VXNlcjI2MTY2Mjcy", "avatar_url": "https://avatars2.githubusercontent.com/u/26166272?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bsr3000", "html_url": "https://github.com/bsr3000", "followers_url": "https://api.github.com/users/bsr3000/followers", "following_url": "https://api.github.com/users/bsr3000/following{/other_user}", "gists_url": "https://api.github.com/users/bsr3000/gists{/gist_id}", "starred_url": "https://api.github.com/users/bsr3000/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bsr3000/subscriptions", "organizations_url": "https://api.github.com/users/bsr3000/orgs", "repos_url": "https://api.github.com/users/bsr3000/repos", "events_url": "https://api.github.com/users/bsr3000/events{/privacy}", "received_events_url": "https://api.github.com/users/bsr3000/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 439648704, "node_id": "MDU6TGFiZWw0Mzk2NDg3MDQ=", "url": "https://api.github.com/repos/django/daphne/labels/exp/intermediate", "name": "exp/intermediate", "color": "bfdadc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-04-26T14:19:43Z", "updated_at": "2018-04-27T16:36:08Z", "closed_at": "2018-04-27T16:36:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I have mentioned this error on django-channels issue tracker, I am currently testing channels 2 for performance and reliability, currently, we use channels 1 on production and preparing to use channels 2 to production. Today, when I was load testing the application (Stack: Nginx + UWSGI + Daphne), 10 daphne instances setup, each `ASGI_THREADS=8` 16 cores server, Debian 9 OS, AsyncConsumers, this errors has appeared:\r\n\r\n```\r\nERROR    [Failure instance: Traceback: <class 'KeyError'>: <WebSocketProtocol client=['127.0.0.1', 55226] path=b'/ws/'>\r\n/venv/lib/python3.5/site-packages/twisted/internet/defer.py:459:callback\r\n/venv/lib/python3.5/site-packages/twisted/internet/defer.py:567:_startRunCallbacks\r\n/venv/lib/python3.5/site-packages/twisted/internet/defer.py:653:_runCallbacks\r\n/venv/lib/python3.5/site-packages/twisted/internet/defer.py:1442:gotResult\r\n--- <exception caught here> ---\r\n/venv/lib/python3.5/site-packages/twisted/internet/defer.py:1386:_inlineCallbacks\r\n/venv/lib/python3.5/site-packages/daphne/server.py:191:create_application\r\n]\r\n```\r\n\r\n```\r\nERROR    Exception in callback AsyncioSelectorReactor.callLater.<locals>.run() at /venv/lib/python3.5/site-packages/twisted/internet/asyncioreactor.py:287\r\nhandle: <TimerHandle when=1713807.003341125 AsyncioSelectorReactor.callLater.<locals>.run() at /venv/lib/python3.5/site-packages/twisted/internet/asyncioreactor.py:287>\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.5/asyncio/events.py\", line 126, in _run\r\n    self._callback(*self._args)\r\n  File \"/venv/lib/python3.5/site-packages/twisted/internet/asyncioreactor.py\", line 290, in run\r\n    f(*args, **kwargs)\r\n  File \"/venv/lib/python3.5/site-packages/twisted/internet/tcp.py\", line 289, in connectionLost\r\n    protocol.connectionLost(reason)\r\n  File \"/venv/lib/python3.5/site-packages/autobahn/twisted/websocket.py\", line 128, in connectionLost\r\n    self._connectionLost(reason)\r\n  File \"/venv/lib/python3.5/site-packages/autobahn/websocket/protocol.py\", line 2467, in _connectionLost\r\n    WebSocketProtocol._connectionLost(self, reason)\r\n  File \"/venv/lib/python3.5/site-packages/autobahn/websocket/protocol.py\", line 1096, in _connectionLost\r\n    self._onClose(self.wasClean, WebSocketProtocol.CLOSE_STATUS_CODE_ABNORMAL_CLOSE, \"connection was closed uncleanly (%s)\" % self.wasNotCleanReason)\r\n  File \"/venv/lib/python3.5/site-packages/autobahn/twisted/websocket.py\", line 171, in _onClose\r\n    self.onClose(wasClean, code, reason)\r\n  File \"/venv/lib/python3.5/site-packages/daphne/ws_protocol.py\", line 146, in onClose\r\n    self.application_queue.put_nowait({\r\nAttributeError: 'WebSocketProtocol' object has no attribute 'application_queue'\r\n```\r\nPackages\r\n```\r\naioredis==1.0.0\r\nasgi-redis==1.3.0\r\nasgiref==2.2.0\r\nasync-timeout==2.0.1\r\nautobahn==18.3.1\r\nchannels==2.1.1\r\nchannels-redis==2.1.1\r\ndaphne==2.1.1\r\nDjango==1.11\r\nTwisted==17.9.0\r\ntxaio==2.9.0\r\ntxredisapi==1.4.4\r\nzope.interface==4.4.3\r\n```\r\n\r\n\r\nOn this setup I have got 10 new connections per second to one endpoint, without throwing that error.\r\n\r\nHere are the results of load testing tool:\r\n```\r\n  Scenarios launched:  1200\r\n  Scenarios completed: 1200\r\n  Requests completed:  1200\r\n```\r\nLoad test setup:\r\n```\r\nphases:\r\n    - duration: 120\r\n       arrivalRate: 10\r\n```\r\n\r\nScenario phases: 1. Connects to ws, 2. Send message 3. Wait for 4 seconds 4. Disconnect\r\n\r\nIf I set the arrivalRate to any value bigger then 10, this error starts to occur `AttributeError: 'WebSocketProtocol' object has no attribute 'application_queue'` and I can`t normally connect to ws, while those errors are thrown to console.\r\n\r\nCurrently, it`s whole info, which I have from logs.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/193", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/193/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/193/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/193/events", "html_url": "https://github.com/django/daphne/issues/193", "id": 316064850, "node_id": "MDU6SXNzdWUzMTYwNjQ4NTA=", "number": 193, "title": "301 redirect on Heroku", "user": {"login": "kltdwrds", "id": 5615037, "node_id": "MDQ6VXNlcjU2MTUwMzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5615037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kltdwrds", "html_url": "https://github.com/kltdwrds", "followers_url": "https://api.github.com/users/kltdwrds/followers", "following_url": "https://api.github.com/users/kltdwrds/following{/other_user}", "gists_url": "https://api.github.com/users/kltdwrds/gists{/gist_id}", "starred_url": "https://api.github.com/users/kltdwrds/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kltdwrds/subscriptions", "organizations_url": "https://api.github.com/users/kltdwrds/orgs", "repos_url": "https://api.github.com/users/kltdwrds/repos", "events_url": "https://api.github.com/users/kltdwrds/events{/privacy}", "received_events_url": "https://api.github.com/users/kltdwrds/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-04-19T22:37:27Z", "updated_at": "2020-07-20T02:30:25Z", "closed_at": "2018-04-19T22:39:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "Works great locally with `runserver` or `heroku local` (uses procfile/daphne) but on heroku I receive nothing but 301's at any endpoint until the browser cancels the request (except for preflight OPTIONS):\r\n```\r\n app[web.1]: 2018-04-19 22:00:54,105 DEBUG    HTTP 200 response started for ['10.67.237.54', 22273]\r\n app[web.1]: 2018-04-19 22:00:54,099 DEBUG    HTTP b'OPTIONS' request for ['10.67.237.54', 22273]\r\n app[web.1]: 2018-04-19 22:00:54,106 DEBUG    HTTP close for ['10.67.237.54', 22273]\r\n app[web.1]: 2018-04-19 22:00:54,107 INFO     \"10.67.237.54\" - - [07/Feb/1970:15:11:45 +0000] \"OPTIONS /login HTTP/1.1\" 200 - \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\"\r\n app[web.1]: 2018-04-19 22:00:54,108 DEBUG    HTTP response complete for ['10.67.237.54', 22273]\r\n app[web.1]: 10.67.237.54:22273 - - [19/Apr/2018:22:00:54] \"OPTIONS /login\" 200 -\r\n app[web.1]: 2018-04-19 22:00:54,166 DEBUG    HTTP b'POST' request for ['10.67.237.54', 24540]\r\n app[web.1]: 2018-04-19 22:00:54,171 DEBUG    HTTP 301 response started for ['10.67.237.54', 24540]\r\n app[web.1]: 2018-04-19 22:00:54,172 DEBUG    HTTP close for ['10.67.237.54', 24540]\r\n app[web.1]: 2018-04-19 22:00:54,172 INFO     \"10.67.237.54\" - - [07/Feb/1970:15:11:45 +0000] \"POST /login HTTP/1.1\" 301 - \"https://portal-stage.safechain.io/login\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\"\r\n app[web.1]: 2018-04-19 22:00:54,173 DEBUG    HTTP response complete for ['10.67.237.54', 24540]\r\n app[web.1]: 10.67.237.54:24540 - - [19/Apr/2018:22:00:54] \"POST /login\" 301 -\r\n app[web.1]: 2018-04-19 22:00:54,225 DEBUG    HTTP b'GET' request for ['10.67.237.54', 27137]\r\n app[web.1]: 2018-04-19 22:00:54,242 DEBUG    HTTP 301 response started for ['10.67.237.54', 27137]\r\n app[web.1]: 2018-04-19 22:00:54,243 DEBUG    HTTP close for ['10.67.237.54', 27137]\r\n app[web.1]: 2018-04-19 22:00:54,243 INFO     \"10.67.237.54\" - - [07/Feb/1970:15:11:45 +0000] \"GET /login HTTP/1.1\" 301 - \"https://portal-stage.safechain.io/login\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\"\r\n app[web.1]: 2018-04-19 22:00:54,243 DEBUG    HTTP response complete for ['10.67.237.54', 27137]\r\n app[web.1]: 10.67.237.54:27137 - - [19/Apr/2018:22:00:54] \"GET /login\" 301 -\r\n heroku[router]: at=info method=OPTIONS path=\"/login\" host=api-stage.safechain.io request_id=40923337-04c1-4926-934d-9ea61074140b fwd=\"24.166.234.32\" dyno=web.1 connect=2ms service=19ms status=200 bytes=430 protocol=https\r\n heroku[router]: at=info method=GET path=\"/login\" host=api-stage.safechain.io request_id=73f88c63-8140-4523-82f8-543ab40aab76 fwd=\"24.166.234.32\" dyno=web.1 connect=0ms service=21ms status=301 bytes=252 protocol=https\r\n heroku[router]: at=info method=POST path=\"/login\" host=api-stage.safechain.io request_id=8005388e-f55f-4b73-b86b-c6492e3e1edc fwd=\"24.166.234.32\" dyno=web.1 connect=2ms service=12ms status=301 bytes=252 protocol=https\r\n app[web.1]: 2018-04-19 22:01:04,713 DEBUG    HTTP b'POST' request for ['10.67.237.54', 30304]\r\n app[web.1]: 2018-04-19 22:01:04,717 DEBUG    HTTP 301 response started for ['10.67.237.54', 30304]\r\n app[web.1]: 2018-04-19 22:01:04,718 DEBUG    HTTP close for ['10.67.237.54', 30304]\r\n app[web.1]: 2018-04-19 22:01:04,719 INFO     \"10.67.237.54\" - - [07/Feb/1970:15:11:55 +0000] \"POST /login HTTP/1.1\" 301 - \"https://portal-stage.safechain.io/login\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\"\r\n app[web.1]: 2018-04-19 22:01:04,719 DEBUG    HTTP response complete for ['10.67.237.54', 30304]\r\n app[web.1]: 10.67.237.54:30304 - - [19/Apr/2018:22:01:04] \"POST /login\" 301 -\r\n app[web.1]: 2018-04-19 22:01:04,771 DEBUG    HTTP b'GET' request for ['10.67.237.54', 22432]\r\n app[web.1]: 2018-04-19 22:01:04,773 DEBUG    HTTP 301 response started for ['10.67.237.54', 22432]\r\n app[web.1]: 2018-04-19 22:01:04,774 DEBUG    HTTP close for ['10.67.237.54', 22432]\r\n app[web.1]: 2018-04-19 22:01:04,774 INFO     \"10.67.237.54\" - - [07/Feb/1970:15:11:55 +0000] \"GET /login HTTP/1.1\" 301 - \"https://portal-stage.safechain.io/login\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\"\r\n app[web.1]: 2018-04-19 22:01:04,774 DEBUG    HTTP response complete for ['10.67.237.54', 22432]\r\n app[web.1]: 10.67.237.54:22432 - - [19/Apr/2018:22:01:04] \"GET /login\" 301 -\r\n heroku[router]: at=info method=GET path=\"/login\" host=api-stage.safechain.io request_id=c3f120ac-6bb9-4a7a-ab9a-d1209ed4e0a3 fwd=\"24.166.234.32\" dyno=web.1 connect=0ms service=6ms status=301 bytes=252 protocol=https\r\n```\r\n\r\n**Procfile**\r\n```\r\nweb: daphne safechain.asgi:application -t 60 --access-log - --port $PORT --bind 0.0.0.0 -v2\r\nworker: celery worker -A safechain -l info -Q api\r\n```\r\n\r\n**Using the latest and greatest**\r\n```\r\naioredis==1.1.0\r\namqp==2.2.2\r\nanyjson==0.3.3\r\nasgiref==2.2.0\r\nasn1crypto==0.24.0\r\nasync-timeout==2.0.1\r\nattrs==17.4.0\r\nautobahn==18.4.1\r\nAutomat==0.6.0\r\nchannels==2.0.2\r\nchannels-redis==2.1.1\r\nchardet==3.0.4\r\nchargebee==2.4.9\r\nclick==6.7\r\nconstantly==15.1.0\r\ncryptography==2.2.2\r\ndaphne==2.1.0\r\nDjango==2.0.4\r\ndjangorestframework==3.8.2\r\ndjangorestframework-jsonapi==2.4.0\r\ndjangorestframework-jwt==1.11.0\r\nhashids==1.2.0\r\nhiredis==0.2.0\r\nhyperlink==18.0.0\r\nidna==2.6\r\nincremental==17.5.0\r\nredis==2.10.6\r\nrequests==2.18.4\r\nTwisted==17.9.0\r\ntxaio==2.10.0\r\nzope.interface==4.4.3\r\n```\r\n\r\nThanks for all the hard work on this project!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/192", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/192/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/192/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/192/events", "html_url": "https://github.com/django/daphne/issues/192", "id": 315382489, "node_id": "MDU6SXNzdWUzMTUzODI0ODk=", "number": 192, "title": "Very High Load", "user": {"login": "jarhainx", "id": 29372129, "node_id": "MDQ6VXNlcjI5MzcyMTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/29372129?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jarhainx", "html_url": "https://github.com/jarhainx", "followers_url": "https://api.github.com/users/jarhainx/followers", "following_url": "https://api.github.com/users/jarhainx/following{/other_user}", "gists_url": "https://api.github.com/users/jarhainx/gists{/gist_id}", "starred_url": "https://api.github.com/users/jarhainx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jarhainx/subscriptions", "organizations_url": "https://api.github.com/users/jarhainx/orgs", "repos_url": "https://api.github.com/users/jarhainx/repos", "events_url": "https://api.github.com/users/jarhainx/events{/privacy}", "received_events_url": "https://api.github.com/users/jarhainx/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-04-18T08:35:49Z", "updated_at": "2018-04-23T10:46:47Z", "closed_at": "2018-04-18T17:22:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to develop a new websocket server with channels.\r\nI need to have a websocket connection with each of my clients (IOT cards) \r\nI find  very high cpu rates with daphne.\r\n**Configuration debian 9.4:**\r\nasgiref (2.3.0)\r\nchannels (2.1.0)\r\nchannels-redis (2.1.1)\r\ndefusedxml (0.5.0)\r\nDjango (1.11.12)\r\nIn channels we use WebsocketConsumer or AsyncWebsocketConsumer\r\n\r\nIn Channels\r\n```\r\nclass OcppJA(AsyncWebsocketConsumer):\r\n    groups = []\r\n\r\n    async def connect(self):\r\n        await self.accept()\r\n\r\n    async def websocket_receive(self, text_data=None, bytes_data=None):\r\n        text = json.loads(text_data['text'])\r\n        borne = self.scope['url_route']['kwargs']['borne']\r\n\r\n        status = \"enabled\"\r\n\r\n        payload = {\"status\": status, \"test1\": 3600, \"test2\": 3600}\r\n        msg = json.dumps([3, text[1], payload])\r\n        await self.send(text_data=msg)\r\n```\r\n\r\nWith 500 clients whe have 70% CPU load (1core)\r\nWith 750 client swhe have 100% CPU load (1core)\r\nCustomers just connect and wait messages\r\nIn my old weksocket server (python 3 + Autobahn + Twisted) we have very low cpu rates .\r\nFor example 3% with 1000 clients\r\n\r\nDo you have an idea or maybe this product is not suitable for my use", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/191", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/191/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/191/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/191/events", "html_url": "https://github.com/django/daphne/issues/191", "id": 314978871, "node_id": "MDU6SXNzdWUzMTQ5Nzg4NzE=", "number": 191, "title": "Running daphne behind nginx reverse proxy with protocol upgrade always routes to http instead of websocket", "user": {"login": "jagadeshbabut", "id": 17573957, "node_id": "MDQ6VXNlcjE3NTczOTU3", "avatar_url": "https://avatars2.githubusercontent.com/u/17573957?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jagadeshbabut", "html_url": "https://github.com/jagadeshbabut", "followers_url": "https://api.github.com/users/jagadeshbabut/followers", "following_url": "https://api.github.com/users/jagadeshbabut/following{/other_user}", "gists_url": "https://api.github.com/users/jagadeshbabut/gists{/gist_id}", "starred_url": "https://api.github.com/users/jagadeshbabut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jagadeshbabut/subscriptions", "organizations_url": "https://api.github.com/users/jagadeshbabut/orgs", "repos_url": "https://api.github.com/users/jagadeshbabut/repos", "events_url": "https://api.github.com/users/jagadeshbabut/events{/privacy}", "received_events_url": "https://api.github.com/users/jagadeshbabut/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-04-17T09:31:41Z", "updated_at": "2020-02-26T18:44:53Z", "closed_at": "2018-04-17T16:57:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI am trying to deploy django channels powered notification application behind Nginx reverse proxy server to only serve the websocket communications, while having Nginx + uWSGI setup to serve the django application.\r\n\r\nThe application works in my local machine seamlessly when run with either `python manage.py runserver --noasgi` + `daphne -p 8000 myproject.asgi:application` or `python manage.py runserver` with `daphne` handling all the requests internally.\r\n\r\nProblem:\r\nAll the websocket requests are routed to `http` protocol type instead of `websocket` protocol type and it returns `WebSocket connection to 'ws://ip_address/ws/' failed: Error during WebSocket handshake: Unexpected response code: 404`\r\n\r\nPackages Installed:\r\nDjango==2.0.3\r\nchannels==2.0.2\r\nchannels-redis==2.1.1\r\ndaphne==2.1.0\r\nasgiref==2.3.0\r\nTwisted==17.9.0\r\naioredis==1.0.0\r\nautobahn==18.4.1\r\n\r\nEnvironment:\r\nUbuntu - 16.04\r\nNginx - 1.12.0\r\n\r\nNginx Configuration for upgrading the request:\r\n```\r\nmap $http_upgrade $connection_upgrade {\r\n    default upgrade;\r\n    '' close;\r\n}\r\n\r\n# the upstream component nginx needs to connect to websocket requests\r\nupstream websocket {\r\n    server unix:/path/to/my/app/daphne.sock;\r\n}\r\n\r\n# configuration of the server\r\nserver {\r\n\r\n        # the port your site will be served on\r\n        listen      80;\r\n\r\n        # the domain name it will serve for\r\n        server_name ip_address;\r\n        charset     utf-8;\r\n\r\n       # Sending all non-media requests for websockets to the Daphne server.\r\n        location /ws/ {\r\n            proxy_pass http://websocket;\r\n            proxy_http_version 1.1;\r\n            proxy_set_header Upgrade $http_upgrade;\r\n            proxy_set_header Connection $connection_upgrade;\r\n        }\r\n\r\n}\r\n```\r\n\r\nrouting.py\r\n```\r\nfrom django.conf.urls import url\r\n\r\nfrom channels.auth import AuthMiddlewareStack\r\nfrom channels.routing import ProtocolTypeRouter, URLRouter\r\nfrom myapp import consumers\r\n\r\napplication = ProtocolTypeRouter({\r\n    'websocket': AuthMiddlewareStack(\r\n        URLRouter([\r\n            url(r'^ws/$', consumers.MyConsumer),\r\n        ])\r\n    ),\r\n})\r\n```\r\n\r\nDaphne Logs:\r\n```\r\nNone - - [TimeStamp] \"GET /ws/\" 404 3\r\nNone - - [TimeStamp] \"GET /ws/\" 404 3\r\nNone - - [TimeStamp] \"GET /ws/\" 404 3\r\n```\r\n\r\nKindly let me know if anything in addition is required to help.\r\n\r\nP.S: I have deployed the same application in two servers(both having the same configuration and environment as above) and the result was same.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/190", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/190/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/190/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/190/events", "html_url": "https://github.com/django/daphne/issues/190", "id": 314799591, "node_id": "MDU6SXNzdWUzMTQ3OTk1OTE=", "number": 190, "title": "Django no shows custom template, 4xx 5xxx", "user": {"login": "felipe3dfx", "id": 4070833, "node_id": "MDQ6VXNlcjQwNzA4MzM=", "avatar_url": "https://avatars1.githubusercontent.com/u/4070833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/felipe3dfx", "html_url": "https://github.com/felipe3dfx", "followers_url": "https://api.github.com/users/felipe3dfx/followers", "following_url": "https://api.github.com/users/felipe3dfx/following{/other_user}", "gists_url": "https://api.github.com/users/felipe3dfx/gists{/gist_id}", "starred_url": "https://api.github.com/users/felipe3dfx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/felipe3dfx/subscriptions", "organizations_url": "https://api.github.com/users/felipe3dfx/orgs", "repos_url": "https://api.github.com/users/felipe3dfx/repos", "events_url": "https://api.github.com/users/felipe3dfx/events{/privacy}", "received_events_url": "https://api.github.com/users/felipe3dfx/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-16T20:09:38Z", "updated_at": "2018-04-16T20:11:02Z", "closed_at": "2018-04-16T20:11:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Django 2.0.4\r\nChannels 2.1.0\r\n\r\nSettings:\r\n`DEBUG = False`\r\n\r\nIf Django raise a server error, it no shown custom template:\r\n\r\n![Daphne error](https://s3.amazonaws.com/uploads.hipchat.com/50553/3393916/AsHs2KmTtXuRNv1/Screen%20Shot%202018-04-16%20at%203.04.12%20PM.png)\r\n\r\nDaphne service:\r\n```\r\n\r\n[Unit]\r\nDescription=Daphne Service\r\nAfter=network.target\r\n\r\n[Service]\r\nUser=deploy\r\nGroup=deploy\r\nWorkingDirectory=/home/deploy/{{ repo_slug }}/\r\nExecStart=/usr/local/bin/daphne app.asgi:application --unix-socket=/tmp/daphne.sock\r\nRestart=always\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\n```\r\n\r\nWhat I'm I missing here?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/189", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/189/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/189/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/189/events", "html_url": "https://github.com/django/daphne/issues/189", "id": 312956761, "node_id": "MDU6SXNzdWUzMTI5NTY3NjE=", "number": 189, "title": "Is it really recommended to use daphne with another wsgi application like uwsgi?", "user": {"login": "hongmingu", "id": 19422933, "node_id": "MDQ6VXNlcjE5NDIyOTMz", "avatar_url": "https://avatars2.githubusercontent.com/u/19422933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hongmingu", "html_url": "https://github.com/hongmingu", "followers_url": "https://api.github.com/users/hongmingu/followers", "following_url": "https://api.github.com/users/hongmingu/following{/other_user}", "gists_url": "https://api.github.com/users/hongmingu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hongmingu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hongmingu/subscriptions", "organizations_url": "https://api.github.com/users/hongmingu/orgs", "repos_url": "https://api.github.com/users/hongmingu/repos", "events_url": "https://api.github.com/users/hongmingu/events{/privacy}", "received_events_url": "https://api.github.com/users/hongmingu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-10T14:46:06Z", "updated_at": "2018-04-10T17:08:38Z", "closed_at": "2018-04-10T17:08:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "In django-channels docs, there is some adverting of using another wsgi application [from this](http://channels.readthedocs.io/en/latest/deploying.html#http-and-websocket),\r\n\r\nSo, I want to ask about difference between daphne and uwsgi.\r\n\r\nThere is no serious performance difference but just difference like accumulation of experience, users? Isn't it?\r\n\r\nSorry for such abstract question. But because I already read that daphne can do auto-balancing somewhat, this [sentence](http://channels.readthedocs.io/en/latest/deploying.html#http-and-websocket) is making me confused. \r\n\r\nIs it really recommended or It is just one of other options?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/188", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/188/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/188/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/188/events", "html_url": "https://github.com/django/daphne/issues/188", "id": 311821616, "node_id": "MDU6SXNzdWUzMTE4MjE2MTY=", "number": 188, "title": "Run ASGI application constructors in a sync thread", "user": {"login": "andrewgodwin", "id": 36182, "node_id": "MDQ6VXNlcjM2MTgy", "avatar_url": "https://avatars1.githubusercontent.com/u/36182?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewgodwin", "html_url": "https://github.com/andrewgodwin", "followers_url": "https://api.github.com/users/andrewgodwin/followers", "following_url": "https://api.github.com/users/andrewgodwin/following{/other_user}", "gists_url": "https://api.github.com/users/andrewgodwin/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewgodwin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewgodwin/subscriptions", "organizations_url": "https://api.github.com/users/andrewgodwin/orgs", "repos_url": "https://api.github.com/users/andrewgodwin/repos", "events_url": "https://api.github.com/users/andrewgodwin/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewgodwin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 439648704, "node_id": "MDU6TGFiZWw0Mzk2NDg3MDQ=", "url": "https://api.github.com/repos/django/daphne/labels/exp/intermediate", "name": "exp/intermediate", "color": "bfdadc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-04-06T01:29:51Z", "updated_at": "2018-05-26T10:24:54Z", "closed_at": "2018-05-26T10:24:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "As they may be blocking. Also update the ASGI spec to note this.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/186", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/186/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/186/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/186/events", "html_url": "https://github.com/django/daphne/issues/186", "id": 310726621, "node_id": "MDU6SXNzdWUzMTA3MjY2MjE=", "number": 186, "title": "Wrong result from django.url.reverse when using Daphne in production", "user": {"login": "morlandi", "id": 299854, "node_id": "MDQ6VXNlcjI5OTg1NA==", "avatar_url": "https://avatars2.githubusercontent.com/u/299854?v=4", "gravatar_id": "", "url": "https://api.github.com/users/morlandi", "html_url": "https://github.com/morlandi", "followers_url": "https://api.github.com/users/morlandi/followers", "following_url": "https://api.github.com/users/morlandi/following{/other_user}", "gists_url": "https://api.github.com/users/morlandi/gists{/gist_id}", "starred_url": "https://api.github.com/users/morlandi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/morlandi/subscriptions", "organizations_url": "https://api.github.com/users/morlandi/orgs", "repos_url": "https://api.github.com/users/morlandi/repos", "events_url": "https://api.github.com/users/morlandi/events{/privacy}", "received_events_url": "https://api.github.com/users/morlandi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-04-03T07:38:02Z", "updated_at": "2018-04-07T08:58:50Z", "closed_at": "2018-04-03T15:50:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "I recently started using Daphne to learn django-channels.\r\nTo keep configuration as simple as possible, I got rid of gunicorn for the moment, thus using Daphne as WSGI for HTTP. \r\nI'm using Nginx as reverse-proxy and installed the following:\r\n\r\n- Django: 2.0.3\r\n- Python 3.6.3\r\n- channels==2.0.2\r\n- channels-redis==2.1.1\r\n\r\nSurprisingly, both HTTP and websocket messages seem to work even with no worker running.\r\n\r\nWhat puzzles me is the behaviour of django.urls.reverse():\r\n\r\n```\r\nTesting reverse('admin:auth_group_changelist') ...\r\nExpected result: \"/admin/auth/group/\"\r\nActual result: \"/home/testproject/testproject/admin/auth/group/\"\r\n```\r\n\r\nNote that the actual result cointains the root of the Django project, instead of a relative address.\r\nIf I follow the link, it just works, but this might be a source of problems should the application logic need to parse the url for any reason.\r\nWhen I run the same code for local development, using the version of runserver managed by Daphne, I obtain the expected result:\r\n\r\n```\r\nTesting reverse('admin:auth_group_changelist') ...\r\nExpected result: \"/admin/auth/group/\"\r\nActual result: \"/admin/auth/group/\"\r\n```\r\n\r\nThis is the view used to run the test:\r\n\r\n```\r\ndef testpage(request):\r\n    from django.urls import reverse\r\n    from django.http import HttpResponse\r\n\r\n    text = \"\"\"\r\n    Testing reverse('admin:auth_group_changelist') ...<br />\r\n    Expected result: \"/admin/auth/group/\"<br />\r\n    Actual result: \"%s\"<br />\r\n\"\"\" % reverse('admin:auth_group_changelist')\r\n\r\n    return HttpResponse(text)\r\n\r\n```\r\nand this is my nginx config file:\r\n\r\n```\r\nserver {\r\n    listen 80;\r\n    server_name testproject.brainstorm.it;\r\n    location ~ \\.(cgi|fcgi|rb)$  { deny all; }\r\n    location ~ /\\.ht             { deny all; }\r\n\r\n    location /media {\r\n        alias /home/testproject/public/media;\r\n    }\r\n\r\n    location /static {\r\n        alias /home/testproject/public/static;\r\n        access_log   off;\r\n        expires modified 1m;\r\n    }\r\n\r\n    location / {\r\n            proxy_pass http://unix://home/testproject/run/daphne.sock;\r\n            proxy_http_version 1.1;\r\n            proxy_set_header Upgrade $http_upgrade;\r\n            proxy_set_header Connection \"upgrade\";\r\n\r\n            proxy_redirect     off;\r\n            proxy_set_header   Host $host;\r\n            proxy_set_header   X-Real-IP $remote_addr;\r\n            proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;\r\n            proxy_set_header   X-Forwarded-Host $server_name;\r\n    }\r\n\r\n    access_log /home/testproject/logs/access.log;\r\n    error_log /home/testproject/logs/error.log;\r\n}\r\n\r\n```\r\nAny suggestion is very welcome\r\n\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/185", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/185/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/185/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/185/events", "html_url": "https://github.com/django/daphne/issues/185", "id": 308434509, "node_id": "MDU6SXNzdWUzMDg0MzQ1MDk=", "number": 185, "title": "Exceedingly slow response time for HTTP requests", "user": {"login": "michaelhays", "id": 6445661, "node_id": "MDQ6VXNlcjY0NDU2NjE=", "avatar_url": "https://avatars1.githubusercontent.com/u/6445661?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelhays", "html_url": "https://github.com/michaelhays", "followers_url": "https://api.github.com/users/michaelhays/followers", "following_url": "https://api.github.com/users/michaelhays/following{/other_user}", "gists_url": "https://api.github.com/users/michaelhays/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelhays/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelhays/subscriptions", "organizations_url": "https://api.github.com/users/michaelhays/orgs", "repos_url": "https://api.github.com/users/michaelhays/repos", "events_url": "https://api.github.com/users/michaelhays/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelhays/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 439649777, "node_id": "MDU6TGFiZWw0Mzk2NDk3Nzc=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/user-response", "name": "blocked/user-response", "color": "f9d0c4", "default": false, "description": null}, {"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2018-03-26T05:08:10Z", "updated_at": "2018-07-10T08:46:05Z", "closed_at": "2018-05-13T15:45:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm running a very simple (backend-wise) app with Daphne 2.0 as the app server. The app is hosted on Heroku. I recently noticed that HTTP requests on the live webpage are _really_ slow when using Daphne.\r\n\r\nI ran some speed tests for Daphne vs. Gunicorn. The web worker run command was the only thing I changed between tests.\r\n\r\nMy `routing.py` file:\r\n\r\n``` python\r\napplication = ProtocolTypeRouter({\r\n    'websocket': AuthMiddlewareStack(\r\n        URLRouter([\r\n            url('^chat/stream/$', ChatbotConsumer),\r\n        ]),\r\n    ),\r\n})\r\n```\r\n\r\nHowever, keep in mind that I never triggered the `/chat/stream/` endpoint when running these tests, so requests were all HTTP. As I [understand it](https://channels.readthedocs.io/en/latest/topics/routing.html#protocoltyperouter), leaving `'http'` unrouted defaults to using Django's usual method of handing HTTP requests.\r\n\r\n---\r\n\r\nFor a web worker using `daphne myproject.asgi:application -b 0.0.0.0 -p $PORT`:\r\n\r\n![daphne waterfall](https://user-images.githubusercontent.com/6445661/37887487-aa07599e-3087-11e8-9807-da2d98e35e83.png)\r\n\r\nFor the exact same app, using `gunicorn myproject.wsgi`:\r\n\r\n![gunicorn waterfall](https://user-images.githubusercontent.com/6445661/37887493-b689f73a-3087-11e8-84a2-f56efbccb19d.png)\r\n\r\nNotice the extreme disparity between the two: 2000 ms vs. 100 ms for small static files. The call to `/app-data` simply loads user-based information using the Django ORM.\r\n\r\n---\r\n\r\nSome Heroku metrics, tested by clearing the cache and refreshing the page very five minutes. Daphne is on the left and right, Gunicorn in the middle.\r\n\r\n![selection_014](https://user-images.githubusercontent.com/6445661/37887598-4c67f162-3088-11e8-81d3-56d7fe732a8c.png)\r\n\r\n![selection_015](https://user-images.githubusercontent.com/6445661/37887619-709252b2-3088-11e8-8ee6-a7cc9afa4f1b.png)\r\n\r\n![selection_013](https://user-images.githubusercontent.com/6445661/37887657-9ec9df42-3088-11e8-9311-adfd98860384.png)\r\n\r\nI couldn't definitively determine if the app was also more likely to have a high Dyno Load when using Daphne, but that seemed to be the case. There's no memory issue; memory usage was slightly lower for Daphne than Gunicorn.\r\n\r\n---\r\n\r\nAny ideas?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/184", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/184/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/184/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/184/events", "html_url": "https://github.com/django/daphne/issues/184", "id": 307703437, "node_id": "MDU6SXNzdWUzMDc3MDM0Mzc=", "number": 184, "title": "Django REMOTE_USER-based authentication does not work", "user": {"login": "prokher", "id": 399393, "node_id": "MDQ6VXNlcjM5OTM5Mw==", "avatar_url": "https://avatars1.githubusercontent.com/u/399393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prokher", "html_url": "https://github.com/prokher", "followers_url": "https://api.github.com/users/prokher/followers", "following_url": "https://api.github.com/users/prokher/following{/other_user}", "gists_url": "https://api.github.com/users/prokher/gists{/gist_id}", "starred_url": "https://api.github.com/users/prokher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prokher/subscriptions", "organizations_url": "https://api.github.com/users/prokher/orgs", "repos_url": "https://api.github.com/users/prokher/repos", "events_url": "https://api.github.com/users/prokher/events{/privacy}", "received_events_url": "https://api.github.com/users/prokher/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-03-22T15:51:04Z", "updated_at": "2018-03-23T13:51:38Z", "closed_at": "2018-03-22T15:53:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "Dear Colleagues!\r\n\r\nI follow [Django instructions](https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.META) to enable `REMOTE_USER` authentication, but looks like Daphne does not set `request.META` as it does Django server does by default. When I remove `channels` from `INSTALLED_APPS` it works fine, but then I enable Channels back again the `REMOTE_USER` disappears from the `request.META`. What am I doing wrong?\r\n\r\nActually, I need to automate authorization in one case of deployment, and to keep native Django authentication in another. I hoped to use Django `REMOTE_USER`-based authentication with regular Django auth as a fallback.\r\n\r\nThanks in advance!", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/183", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/183/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/183/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/183/events", "html_url": "https://github.com/django/daphne/issues/183", "id": 303186299, "node_id": "MDU6SXNzdWUzMDMxODYyOTk=", "number": 183, "title": "Run daphne from python script", "user": {"login": "rafaelthca", "id": 9335851, "node_id": "MDQ6VXNlcjkzMzU4NTE=", "avatar_url": "https://avatars0.githubusercontent.com/u/9335851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rafaelthca", "html_url": "https://github.com/rafaelthca", "followers_url": "https://api.github.com/users/rafaelthca/followers", "following_url": "https://api.github.com/users/rafaelthca/following{/other_user}", "gists_url": "https://api.github.com/users/rafaelthca/gists{/gist_id}", "starred_url": "https://api.github.com/users/rafaelthca/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rafaelthca/subscriptions", "organizations_url": "https://api.github.com/users/rafaelthca/orgs", "repos_url": "https://api.github.com/users/rafaelthca/repos", "events_url": "https://api.github.com/users/rafaelthca/events{/privacy}", "received_events_url": "https://api.github.com/users/rafaelthca/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-07T17:18:20Z", "updated_at": "2018-03-07T17:22:29Z", "closed_at": "2018-03-07T17:22:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is it possible to run daphne from a python script? I would like to bundle it with my project that is packaged with pyinstaller.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/182", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/182/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/182/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/182/events", "html_url": "https://github.com/django/daphne/issues/182", "id": 303071698, "node_id": "MDU6SXNzdWUzMDMwNzE2OTg=", "number": 182, "title": "Doc: deploying with multiple daphne processes (v1 -> v2)", "user": {"login": "jxrossel", "id": 12891830, "node_id": "MDQ6VXNlcjEyODkxODMw", "avatar_url": "https://avatars2.githubusercontent.com/u/12891830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jxrossel", "html_url": "https://github.com/jxrossel", "followers_url": "https://api.github.com/users/jxrossel/followers", "following_url": "https://api.github.com/users/jxrossel/following{/other_user}", "gists_url": "https://api.github.com/users/jxrossel/gists{/gist_id}", "starred_url": "https://api.github.com/users/jxrossel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jxrossel/subscriptions", "organizations_url": "https://api.github.com/users/jxrossel/orgs", "repos_url": "https://api.github.com/users/jxrossel/repos", "events_url": "https://api.github.com/users/jxrossel/events{/privacy}", "received_events_url": "https://api.github.com/users/jxrossel/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 21, "created_at": "2018-03-07T12:02:15Z", "updated_at": "2018-08-10T13:17:58Z", "closed_at": "2018-03-07T17:03:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nWith v1, I could run a single Daphne process and several workers, so that I could bind Daphne directly to a port number.\r\n\r\nWith v2, the worker and the server share the same Daphne process, so that the number of daphne processes must be increased to reach a similar situation. The Channels doc mentions using a process supervisor to increase the number of processes, but it doesn't state how a port can be shared between the Daphne processes. \r\n\r\nI use Circus (http://circus.readthedocs.io/en/latest/tutorial/step-by-step/) as a process supervisor. Their doc mentions using Circus to create a socket bound to the desired port and to run multiple servers (Chaussette in the case) with the resulting (and common) socket file descriptor. Chaussette's doc explicitly mentions that:\r\n\r\n> The particularity of Chaussette is that it can either bind a socket on a port like any other server does or run against already opened sockets.\r\n\r\nIs that also true for Daphne? Can Daphne processes share the same socket file descriptor? If yes, could that be mentionned in the doc?\r\n\r\nThanks in advance!\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/180", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/180/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/180/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/180/events", "html_url": "https://github.com/django/daphne/issues/180", "id": 299934389, "node_id": "MDU6SXNzdWUyOTk5MzQzODk=", "number": 180, "title": "Why is asgiref required?", "user": {"login": "bluetech", "id": 1223550, "node_id": "MDQ6VXNlcjEyMjM1NTA=", "avatar_url": "https://avatars3.githubusercontent.com/u/1223550?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluetech", "html_url": "https://github.com/bluetech", "followers_url": "https://api.github.com/users/bluetech/followers", "following_url": "https://api.github.com/users/bluetech/following{/other_user}", "gists_url": "https://api.github.com/users/bluetech/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluetech/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluetech/subscriptions", "organizations_url": "https://api.github.com/users/bluetech/orgs", "repos_url": "https://api.github.com/users/bluetech/repos", "events_url": "https://api.github.com/users/bluetech/events{/privacy}", "received_events_url": "https://api.github.com/users/bluetech/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-24T11:30:12Z", "updated_at": "2018-02-24T18:45:21Z", "closed_at": "2018-02-24T18:45:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "It looks like it isn't used in this project, so can be removed from `install_requires`.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/179", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/179/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/179/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/179/events", "html_url": "https://github.com/django/daphne/issues/179", "id": 299854946, "node_id": "MDU6SXNzdWUyOTk4NTQ5NDY=", "number": 179, "title": "`RuntimeError` when running tests locally", "user": {"login": "ckcollab", "id": 2185159, "node_id": "MDQ6VXNlcjIxODUxNTk=", "avatar_url": "https://avatars2.githubusercontent.com/u/2185159?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ckcollab", "html_url": "https://github.com/ckcollab", "followers_url": "https://api.github.com/users/ckcollab/followers", "following_url": "https://api.github.com/users/ckcollab/following{/other_user}", "gists_url": "https://api.github.com/users/ckcollab/gists{/gist_id}", "starred_url": "https://api.github.com/users/ckcollab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ckcollab/subscriptions", "organizations_url": "https://api.github.com/users/ckcollab/orgs", "repos_url": "https://api.github.com/users/ckcollab/repos", "events_url": "https://api.github.com/users/ckcollab/events{/privacy}", "received_events_url": "https://api.github.com/users/ckcollab/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 439649734, "node_id": "MDU6TGFiZWw0Mzk2NDk3MzQ=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/needs-investigation", "name": "blocked/needs-investigation", "color": "f9d0c4", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-02-23T21:25:09Z", "updated_at": "2020-07-08T18:26:56Z", "closed_at": "2020-07-08T18:05:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "I followed the README and did:\r\n\r\n```bash\r\n# inside a fresh Python 3.6 virtualenv\r\n$ pip install -e .[tests]\r\n$ pytest\r\n```\r\n\r\nIt hangs right here:\r\n\r\n```\r\n$ pytest\r\n=================================================== test session starts ====================================================\r\nplatform darwin -- Python 3.6.1, pytest-3.4.1, py-1.5.2, pluggy-0.6.0\r\nrootdir: /Users/eric/src/daphne, inifile: setup.cfg\r\nplugins: asyncio-0.8.0, hypothesis-3.45.3\r\ncollected 46 items\r\n\r\ntests/test_cli.py .........                                                                                          [ 19%]\r\ntests/test_http_request.py\r\n```\r\n\r\nThen slowly the failing tests roll in\r\n\r\n```\r\nself = <daphne.testing.DaphneTestingInstance object at 0x10834d0b8>\r\n\r\n    def __enter__(self):\r\n        # Clear result storage\r\n        TestApplication.delete_setup()\r\n        TestApplication.delete_result()\r\n        # Option Daphne features\r\n        kwargs = {}\r\n        # Optionally enable X-Forwarded-For support.\r\n        if self.xff:\r\n            kwargs[\"proxy_forwarded_address_header\"] = \"X-Forwarded-For\"\r\n            kwargs[\"proxy_forwarded_port_header\"] = \"X-Forwarded-Port\"\r\n        if self.http_timeout:\r\n            kwargs[\"http_timeout\"] = self.http_timeout\r\n        # Start up process\r\n        self.process = DaphneProcess(\r\n            host=self.host,\r\n            application=TestApplication,\r\n            kwargs=kwargs,\r\n            setup=self.process_setup,\r\n            teardown=self.process_teardown,\r\n        )\r\n        self.process.start()\r\n        # Wait for the port\r\n        if self.process.ready.wait(self.startup_timeout):\r\n            self.port = self.process.port.value\r\n            return self\r\n        else:\r\n            if self.process.errors.empty():\r\n>               raise RuntimeError(\"Daphne did not start up, no error caught\")\r\nE               RuntimeError: Daphne did not start up, no error caught\r\n\r\ndaphne/testing.py:57: RuntimeError\r\n========================================== 25 failed, 21 passed in 100.29 seconds ==========================================\r\n```\r\n\r\nI *think* I am doing most everything right. I looked at how travis was running tests so I went further and did:\r\n\r\n```\r\n$ pip install twisted isort unify flake8 -e .[tests]\r\n```\r\n\r\nSame result, though. Tests are passing on Travis so I must be doing something wrong... again hopefully this issue just helps the next person figure out the simple thing they are missing :)", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/178", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/178/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/178/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/178/events", "html_url": "https://github.com/django/daphne/issues/178", "id": 298771470, "node_id": "MDU6SXNzdWUyOTg3NzE0NzA=", "number": 178, "title": "AttributeError: 'WebRequest' object has no attribute 'channel'", "user": {"login": "brianmay", "id": 112729, "node_id": "MDQ6VXNlcjExMjcyOQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/112729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianmay", "html_url": "https://github.com/brianmay", "followers_url": "https://api.github.com/users/brianmay/followers", "following_url": "https://api.github.com/users/brianmay/following{/other_user}", "gists_url": "https://api.github.com/users/brianmay/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianmay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianmay/subscriptions", "organizations_url": "https://api.github.com/users/brianmay/orgs", "repos_url": "https://api.github.com/users/brianmay/repos", "events_url": "https://api.github.com/users/brianmay/events{/privacy}", "received_events_url": "https://api.github.com/users/brianmay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 439648660, "node_id": "MDU6TGFiZWw0Mzk2NDg2NjA=", "url": "https://api.github.com/repos/django/daphne/labels/exp/beginner", "name": "exp/beginner", "color": "bfdadc", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-02-20T22:23:11Z", "updated_at": "2018-02-21T17:52:28Z", "closed_at": "2018-02-21T17:52:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When testing the fix for https://github.com/django/channels/issues/897 I noticed this error between tests:\r\n\r\n```\r\n[2018-02-21 09:16:54,587: ERROR/asyncio] Exception in callback AsyncioSelectorReactor.callLater.<locals>.run() at /home/brian/.pyenv/versions/3.6.4/envs/myrocc-channels2/lib/python3.6/site-packages/twisted/internet/asyncioreactor.py:287\r\nhandle: <TimerHandle when=245658.386868275 AsyncioSelectorReactor.callLater.<locals>.run() at /home/brian/.pyenv/versions/3.6.4/envs/myrocc-channels2/lib/python3.6/site-packages/twisted/internet/asyncioreactor.py:287>\r\nTraceback (most recent call last):\r\n  File \"/home/brian/.pyenv/versions/3.6.4/lib/python3.6/asyncio/events.py\", line 145, in _run\r\n    self._callback(*self._args)\r\n  File \"/home/brian/.pyenv/versions/3.6.4/envs/myrocc-channels2/lib/python3.6/site-packages/twisted/internet/asyncioreactor.py\", line 290, in run\r\n    f(*args, **kwargs)\r\n  File \"/home/brian/tree/myro/channels2/daphne/daphne/server.py\", line 274, in timeout_checker\r\n    protocol.check_timeouts()\r\n  File \"/home/brian/tree/myro/channels2/daphne/daphne/http_protocol.py\", line 248, in check_timeouts\r\n    self.basic_error(503, b\"Service Unavailable\", \"Application failed to respond within time limit.\")\r\n  File \"/home/brian/tree/myro/channels2/daphne/daphne/http_protocol.py\", line 281, in basic_error\r\n    (b\"Content-Type\", b\"text/html; charset=utf-8\"),\r\n  File \"/home/brian/tree/myro/channels2/daphne/daphne/http_protocol.py\", line 193, in handle_reply\r\n    if self.channel is None:\r\nAttributeError: 'WebRequest' object has no attribute 'channel'\r\n```\r\n\r\nI am going to try the following change for now:\r\n\r\n```diff\r\ndiff --git a/daphne/http_protocol.py b/daphne/http_protocol.py\r\nindex 7044109..0e03491 100755\r\n--- a/daphne/http_protocol.py\r\n+++ b/daphne/http_protocol.py\r\n@@ -190,7 +190,7 @@ class WebRequest(http.Request):\r\n         Handles a reply from the client\r\n         \"\"\"\r\n         # Handle connections that are already closed\r\n-        if self.channel is None:\r\n+        if getattr(self, 'channel', None) is None:\r\n             return\r\n         # Check message validity\r\n         if \"type\" not in message:\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/176", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/176/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/176/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/176/events", "html_url": "https://github.com/django/daphne/issues/176", "id": 298654452, "node_id": "MDU6SXNzdWUyOTg2NTQ0NTI=", "number": 176, "title": "Running multiple daphne processes", "user": {"login": "ploggingdev", "id": 23113993, "node_id": "MDQ6VXNlcjIzMTEzOTkz", "avatar_url": "https://avatars3.githubusercontent.com/u/23113993?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ploggingdev", "html_url": "https://github.com/ploggingdev", "followers_url": "https://api.github.com/users/ploggingdev/followers", "following_url": "https://api.github.com/users/ploggingdev/following{/other_user}", "gists_url": "https://api.github.com/users/ploggingdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ploggingdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ploggingdev/subscriptions", "organizations_url": "https://api.github.com/users/ploggingdev/orgs", "repos_url": "https://api.github.com/users/ploggingdev/repos", "events_url": "https://api.github.com/users/ploggingdev/events{/privacy}", "received_events_url": "https://api.github.com/users/ploggingdev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-20T16:14:40Z", "updated_at": "2018-02-20T17:53:00Z", "closed_at": "2018-02-20T17:53:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "Gunicorn has an option to specify the number of workers using `--workers`. Is there such an option with daphne as well? If not, any recommendations/guidelines about running multiple daphne processes?", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/175", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/175/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/175/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/175/events", "html_url": "https://github.com/django/daphne/issues/175", "id": 298198279, "node_id": "MDU6SXNzdWUyOTgxOTgyNzk=", "number": 175, "title": "Request.finish called on a request after its connection was lost", "user": {"login": "intellineers", "id": 17159259, "node_id": "MDEyOk9yZ2FuaXphdGlvbjE3MTU5MjU5", "avatar_url": "https://avatars1.githubusercontent.com/u/17159259?v=4", "gravatar_id": "", "url": "https://api.github.com/users/intellineers", "html_url": "https://github.com/intellineers", "followers_url": "https://api.github.com/users/intellineers/followers", "following_url": "https://api.github.com/users/intellineers/following{/other_user}", "gists_url": "https://api.github.com/users/intellineers/gists{/gist_id}", "starred_url": "https://api.github.com/users/intellineers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/intellineers/subscriptions", "organizations_url": "https://api.github.com/users/intellineers/orgs", "repos_url": "https://api.github.com/users/intellineers/repos", "events_url": "https://api.github.com/users/intellineers/events{/privacy}", "received_events_url": "https://api.github.com/users/intellineers/received_events", "type": "Organization", "site_admin": false}, "labels": [{"id": 439649734, "node_id": "MDU6TGFiZWw0Mzk2NDk3MzQ=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/needs-investigation", "name": "blocked/needs-investigation", "color": "f9d0c4", "default": false, "description": null}, {"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-02-19T08:50:21Z", "updated_at": "2018-02-21T17:51:22Z", "closed_at": "2018-02-21T17:51:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "After dockerizing my application everything works as it should, but sometimes I get the above mentioned error message. The error message is actually coming from Twisted, however it tells me that I should use Request.notify. I am not sure if this is a bug or if I use daphne just in a wrong way. I have the feeling that the error message is coming mostly when I getting to a page where I am redirected, however I am unable to reproduce this consistently. \r\n\r\nAfter instpecting the trace a bit more, this might belong actually to django-channels and not here?\r\n\r\nBelow the trace:\r\ninterface_1  | 2018-02-19 09:21:17,628 ERROR    Exception inside application: Request.finish called on a request after its connection was lost; use Request.notifyFinish to keep track of this.\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/channels/http.py\", line 191, in __call__\r\ninterface_1  |     await self.handle(body)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/asgiref/sync.py\", line 108, in __call__\r\ninterface_1  |     return await asyncio.wait_for(future, timeout=None)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/asyncio/tasks.py\", line 339, in wait_for\r\ninterface_1  |     return (yield from fut)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/concurrent/futures/thread.py\", line 56, in run\r\ninterface_1  |     result = self.fn(*self.args, **self.kwargs)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/asgiref/sync.py\", line 123, in thread_handler\r\ninterface_1  |     return self.func(*args, **kwargs)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/channels/http.py\", line 227, in handle\r\ninterface_1  |     self.send(response_message)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/asgiref/sync.py\", line 62, in __call__\r\ninterface_1  |     return call_result.result()\r\ninterface_1  |   File \"/usr/local/lib/python3.6/concurrent/futures/_base.py\", line 432, in result\r\ninterface_1  |     return self.__get_result()\r\ninterface_1  |   File \"/usr/local/lib/python3.6/concurrent/futures/_base.py\", line 384, in __get_result\r\ninterface_1  |     raise self._exception\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/asgiref/sync.py\", line 76, in main_wrap\r\ninterface_1  |     result = await self.awaitable(*args, **kwargs)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/daphne/server.py\", line 196, in handle_reply\r\ninterface_1  |     protocol.handle_reply(message)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/daphne/http_protocol.py\", line 213, in handle_reply\r\ninterface_1  |     self.finish()\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/daphne/http_protocol.py\", line 183, in finish\r\ninterface_1  |     http.Request.finish(self)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/twisted/web/http.py\", line 992, in finish\r\ninterface_1  |     \"Request.finish called on a request after its connection was lost; \"\r\ninterface_1  |   Request.finish called on a request after its connection was lost; use Request.notifyFinish to keep track of this.\r\ninterface_1  | 2018-02-19 09:21:17,629 ERROR    Exception inside application: Request.finish called on a request after its connection was lost; use Request.notifyFinish to keep track of this.\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/channels/http.py\", line 191, in __call__\r\ninterface_1  |     await self.handle(body)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/asgiref/sync.py\", line 108, in __call__\r\ninterface_1  |     return await asyncio.wait_for(future, timeout=None)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/asyncio/tasks.py\", line 339, in wait_for\r\ninterface_1  |     return (yield from fut)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/concurrent/futures/thread.py\", line 56, in run\r\ninterface_1  |     result = self.fn(*self.args, **self.kwargs)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/asgiref/sync.py\", line 123, in thread_handler\r\ninterface_1  |     return self.func(*args, **kwargs)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/channels/http.py\", line 227, in handle\r\ninterface_1  |     self.send(response_message)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/asgiref/sync.py\", line 62, in __call__\r\ninterface_1  |     return call_result.result()\r\ninterface_1  |   File \"/usr/local/lib/python3.6/concurrent/futures/_base.py\", line 432, in result\r\ninterface_1  |     return self.__get_result()\r\ninterface_1  |   File \"/usr/local/lib/python3.6/concurrent/futures/_base.py\", line 384, in __get_result\r\ninterface_1  |     raise self._exception\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/asgiref/sync.py\", line 76, in main_wrap\r\ninterface_1  |     result = await self.awaitable(*args, **kwargs)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/daphne/server.py\", line 196, in handle_reply\r\ninterface_1  |     protocol.handle_reply(message)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/daphne/http_protocol.py\", line 213, in handle_reply\r\ninterface_1  |     self.finish()\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/daphne/http_protocol.py\", line 183, in finish\r\ninterface_1  |     http.Request.finish(self)\r\ninterface_1  |   File \"/usr/local/lib/python3.6/site-packages/twisted/web/http.py\", line 992, in finish\r\ninterface_1  |     \"Request.finish called on a request after its connection was lost; \"\r\ninterface_1  |   Request.finish called on a request after its connection was lost; use Request.notifyFinish to keep track of this.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/174", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/174/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/174/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/174/events", "html_url": "https://github.com/django/daphne/issues/174", "id": 298018465, "node_id": "MDU6SXNzdWUyOTgwMTg0NjU=", "number": 174, "title": "Two project in same instance EC2", "user": {"login": "oularrea", "id": 15090002, "node_id": "MDQ6VXNlcjE1MDkwMDAy", "avatar_url": "https://avatars2.githubusercontent.com/u/15090002?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oularrea", "html_url": "https://github.com/oularrea", "followers_url": "https://api.github.com/users/oularrea/followers", "following_url": "https://api.github.com/users/oularrea/following{/other_user}", "gists_url": "https://api.github.com/users/oularrea/gists{/gist_id}", "starred_url": "https://api.github.com/users/oularrea/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oularrea/subscriptions", "organizations_url": "https://api.github.com/users/oularrea/orgs", "repos_url": "https://api.github.com/users/oularrea/repos", "events_url": "https://api.github.com/users/oularrea/events{/privacy}", "received_events_url": "https://api.github.com/users/oularrea/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-17T16:50:22Z", "updated_at": "2018-02-17T22:18:21Z", "closed_at": "2018-02-17T18:13:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have an EC2 server with redis, when I run two django projects on the same server \"environment prod and dev with its virtual independent enviroments\" in the dev domain the websocket is not able to join the groups in this environment and in the configuration of channels I have the prefix and everything\r\n\r\nYou can run two different projects sharing the same daphne server and redis instance\r\n\r\nThank you so much", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/173", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/173/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/173/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/173/events", "html_url": "https://github.com/django/daphne/issues/173", "id": 297908648, "node_id": "MDU6SXNzdWUyOTc5MDg2NDg=", "number": 173, "title": "Apps aren't loaded yet error", "user": {"login": "kimond", "id": 1423906, "node_id": "MDQ6VXNlcjE0MjM5MDY=", "avatar_url": "https://avatars3.githubusercontent.com/u/1423906?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kimond", "html_url": "https://github.com/kimond", "followers_url": "https://api.github.com/users/kimond/followers", "following_url": "https://api.github.com/users/kimond/following{/other_user}", "gists_url": "https://api.github.com/users/kimond/gists{/gist_id}", "starred_url": "https://api.github.com/users/kimond/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kimond/subscriptions", "organizations_url": "https://api.github.com/users/kimond/orgs", "repos_url": "https://api.github.com/users/kimond/repos", "events_url": "https://api.github.com/users/kimond/events{/privacy}", "received_events_url": "https://api.github.com/users/kimond/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 439649777, "node_id": "MDU6TGFiZWw0Mzk2NDk3Nzc=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/user-response", "name": "blocked/user-response", "color": "f9d0c4", "default": false, "description": null}, {"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-02-16T20:21:26Z", "updated_at": "2018-02-16T21:21:56Z", "closed_at": "2018-02-16T21:14:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since I updated django channels to 2.0.3 I got this error from daphne. Everything else seems to work correctly except stuff related to daphne.\r\n```\r\nERROR    Exception inside application: Apps aren't loaded yet.\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/channels/consumer.py\", line 54, in __call__\r\nFeb 16 15:17:43 tig-server daphne[2180]:     await await_many_dispatch([receive, self.channel_receive], self.dispatch)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/channels/utils.py\", line 48, in await_many_dispatch\r\nFeb 16 15:17:43 tig-server daphne[2180]:     await dispatch(result)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/asgiref/sync.py\", line 108, in __call__\r\nFeb 16 15:17:43 tig-server daphne[2180]:     return await asyncio.wait_for(future, timeout=None)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/usr/lib/python3.6/asyncio/tasks.py\", line 333, in wait_for\r\nFeb 16 15:17:43 tig-server daphne[2180]:     return (yield from fut)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/usr/lib/python3.6/concurrent/futures/thread.py\", line 55, in run\r\nFeb 16 15:17:43 tig-server daphne[2180]:     result = self.fn(*self.args, **self.kwargs)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/channels/db.py\", line 13, in thread_handler\r\nFeb 16 15:17:43 tig-server daphne[2180]:     return super().thread_handler(loop, *args, **kwargs)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/asgiref/sync.py\", line 123, in thread_handler\r\nFeb 16 15:17:43 tig-server daphne[2180]:     return self.func(*args, **kwargs)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/channels/consumer.py\", line 99, in dispatch\r\nFeb 16 15:17:43 tig-server daphne[2180]:     handler(message)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/channels/generic/websocket.py\", line 19, in websocket_connect\r\nFeb 16 15:17:43 tig-server daphne[2180]:     self.connect()\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"./tiguidou/notifications/consumers.py\", line 8, in connect\r\nFeb 16 15:17:43 tig-server daphne[2180]:     async_to_sync(self.channel_layer.group_add)(f\"notifications-{self.scope['user'].pk}\", self.channel_name)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/django/utils/functional.py\", line 215, in inner\r\nFeb 16 15:17:43 tig-server daphne[2180]:     self._setup()\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/django/utils/functional.py\", line 349, in _setup\r\nFeb 16 15:17:43 tig-server daphne[2180]:     self._wrapped = self._setupfunc()\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/channels/auth.py\", line 31, in <lambda>\r\nFeb 16 15:17:43 tig-server daphne[2180]:     scope[\"user\"] = SimpleLazyObject(lambda: get_user(scope))\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/channels/auth.py\", line 12, in get_user\r\nFeb 16 15:17:43 tig-server daphne[2180]:     scope[\"_cached_user\"] = auth.get_user(fake_request)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/django/contrib/auth/__init__.py\", line 208, in get_user\r\nFeb 16 15:17:43 tig-server daphne[2180]:     from .models import AnonymousUser\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/django/contrib/auth/models.py\", line 2, in <module>\r\nFeb 16 15:17:43 tig-server daphne[2180]:     from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/django/contrib/auth/base_user.py\", line 47, in <module>\r\nFeb 16 15:17:43 tig-server daphne[2180]:     class AbstractBaseUser(models.Model):\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/django/db/models/base.py\", line 100, in __new__\r\nFeb 16 15:17:43 tig-server daphne[2180]:     app_config = apps.get_containing_app_config(module)\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/django/apps/registry.py\", line 244, in get_containing_app_config\r\nFeb 16 15:17:43 tig-server daphne[2180]:     self.check_apps_ready()\r\nFeb 16 15:17:43 tig-server daphne[2180]:   File \"/srv/tiguidou/venv/lib/python3.6/site-packages/django/apps/registry.py\", line 127, in check_apps_ready\r\nFeb 16 15:17:43 tig-server daphne[2180]:     raise AppRegistryNotReady(\"Apps aren't loaded yet.\")\r\nFeb 16 15:17:43 tig-server daphne[2180]:   Apps aren't loaded yet.\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/172", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/172/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/172/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/172/events", "html_url": "https://github.com/django/daphne/issues/172", "id": 297813536, "node_id": "MDU6SXNzdWUyOTc4MTM1MzY=", "number": 172, "title": "WebSocket server shouldn't postpone ping for server side send", "user": {"login": "yli-cpr", "id": 30503431, "node_id": "MDQ6VXNlcjMwNTAzNDMx", "avatar_url": "https://avatars2.githubusercontent.com/u/30503431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yli-cpr", "html_url": "https://github.com/yli-cpr", "followers_url": "https://api.github.com/users/yli-cpr/followers", "following_url": "https://api.github.com/users/yli-cpr/following{/other_user}", "gists_url": "https://api.github.com/users/yli-cpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/yli-cpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yli-cpr/subscriptions", "organizations_url": "https://api.github.com/users/yli-cpr/orgs", "repos_url": "https://api.github.com/users/yli-cpr/repos", "events_url": "https://api.github.com/users/yli-cpr/events{/privacy}", "received_events_url": "https://api.github.com/users/yli-cpr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-02-16T15:02:09Z", "updated_at": "2018-02-28T20:01:22Z", "closed_at": "2018-02-16T17:57:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "The last_data is updated when server sends any data to client. And WebSocket server uses this timestamp to decide if it should send a ping.\r\n\r\nThis actually defeats the purpose of the ping.\r\n\r\nThe ping is used to check if the client is still responsive. Server sending data doesn't mean client is good", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/171", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/171/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/171/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/171/events", "html_url": "https://github.com/django/daphne/issues/171", "id": 297706240, "node_id": "MDU6SXNzdWUyOTc3MDYyNDA=", "number": 171, "title": "static pages get ERROR 404 if daphne port is different from 8000.", "user": {"login": "felipemaion", "id": 25100827, "node_id": "MDQ6VXNlcjI1MTAwODI3", "avatar_url": "https://avatars3.githubusercontent.com/u/25100827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/felipemaion", "html_url": "https://github.com/felipemaion", "followers_url": "https://api.github.com/users/felipemaion/followers", "following_url": "https://api.github.com/users/felipemaion/following{/other_user}", "gists_url": "https://api.github.com/users/felipemaion/gists{/gist_id}", "starred_url": "https://api.github.com/users/felipemaion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/felipemaion/subscriptions", "organizations_url": "https://api.github.com/users/felipemaion/orgs", "repos_url": "https://api.github.com/users/felipemaion/repos", "events_url": "https://api.github.com/users/felipemaion/events{/privacy}", "received_events_url": "https://api.github.com/users/felipemaion/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-02-16T08:02:27Z", "updated_at": "2018-02-16T08:39:09Z", "closed_at": "2018-02-16T08:39:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nIf I run `python manage.py runserver` all my static files are loaded ok.\r\nIf I run `daphne multichat.asgi:application --port 8888` server returns error 404 for the static files.\r\n\r\nOnly if I run `daphne multichat.asgi:application --port 8000` the files (CSS, js, etc) are loaded right.\r\n\r\nI am trying to deploy this to Heroku, so, my Procfile is \r\n`web: daphne multichat.asgi:application --port $PORT --bind 0.0.0.0 -v2`\r\n\r\nIs there any configuration I am missing? \r\nAs far as I understood I could \"pick\" the door without this kind of problems.\r\n", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/169", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/169/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/169/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/169/events", "html_url": "https://github.com/django/daphne/issues/169", "id": 297259746, "node_id": "MDU6SXNzdWUyOTcyNTk3NDY=", "number": 169, "title": "unable to handle premature client closure", "user": {"login": "brianmay", "id": 112729, "node_id": "MDQ6VXNlcjExMjcyOQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/112729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianmay", "html_url": "https://github.com/brianmay", "followers_url": "https://api.github.com/users/brianmay/followers", "following_url": "https://api.github.com/users/brianmay/following{/other_user}", "gists_url": "https://api.github.com/users/brianmay/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianmay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianmay/subscriptions", "organizations_url": "https://api.github.com/users/brianmay/orgs", "repos_url": "https://api.github.com/users/brianmay/repos", "events_url": "https://api.github.com/users/brianmay/events{/privacy}", "received_events_url": "https://api.github.com/users/brianmay/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-02-14T21:57:17Z", "updated_at": "2018-02-15T23:56:49Z", "closed_at": "2018-02-14T22:53:13Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Copied from https://github.com/django/channels/issues/904:\r\n\r\nIf the client (browser) closes connection prematurely, we crash.\r\n\r\nLooks like ``handle_reply()`` should not do anything if the connection is closed.\r\n\r\nCopied from #897.\r\n\r\n```\r\n[2018-02-14 11:07:37,017: ERROR/daphne.server] Exception inside application: 'NoneType' object has no attribute 'writeHeaders'\r\n  File \"/home/brian/tree/myro/channels/channels/http.py\", line 191, in __call__\r\n    await self.handle(body)\r\n  File \"/home/brian/.pyenv/versions/3.6.4/envs/myrocc/lib/python3.6/site-packages/asgiref/sync.py\", line 95, in __call__\r\n    return await asyncio.wait_for(future, timeout=None)\r\n  File \"/home/brian/.pyenv/versions/3.6.4/lib/python3.6/asyncio/tasks.py\", line 339, in wait_for\r\n    return (yield from fut)\r\n  File \"/home/brian/.pyenv/versions/3.6.4/lib/python3.6/concurrent/futures/thread.py\", line 56, in run\r\n    result = self.fn(*self.args, **self.kwargs)\r\n  File \"/home/brian/.pyenv/versions/3.6.4/envs/myrocc/lib/python3.6/site-packages/asgiref/sync.py\", line 110, in thread_handler\r\n    return self.func(*args, **kwargs)\r\n  File \"/home/brian/tree/myro/channels/channels/http.py\", line 227, in handle\r\n    self.send(response_message)\r\n  File \"/home/brian/.pyenv/versions/3.6.4/envs/myrocc/lib/python3.6/site-packages/asgiref/sync.py\", line 49, in __call__\r\n    return call_result.result()\r\n  File \"/home/brian/.pyenv/versions/3.6.4/lib/python3.6/concurrent/futures/_base.py\", line 432, in result\r\n    return self.__get_result()\r\n  File \"/home/brian/.pyenv/versions/3.6.4/lib/python3.6/concurrent/futures/_base.py\", line 384, in __get_result\r\n    raise self._exception\r\n  File \"/home/brian/.pyenv/versions/3.6.4/envs/myrocc/lib/python3.6/site-packages/asgiref/sync.py\", line 63, in main_wrap\r\n    result = await self.awaitable(*args, **kwargs)\r\n  File \"/home/brian/.pyenv/versions/3.6.4/envs/myrocc/lib/python3.6/site-packages/daphne/server.py\", line 197, in handle_reply\r\n    protocol.handle_reply(message)\r\n  File \"/home/brian/.pyenv/versions/3.6.4/envs/myrocc/lib/python3.6/site-packages/daphne/http_protocol.py\", line 212, in handle_reply\r\n    http.Request.write(self, message.get(\"body\", b\"\"))\r\n  File \"/home/brian/.pyenv/versions/3.6.4/envs/myrocc/lib/python3.6/site-packages/twisted/web/http.py\", line 1068, in write\r\n    self.channel.writeHeaders(version, code, reason, headers)\r\n  'NoneType' object has no attribute 'writeHeaders'\r\n```", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/168", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/168/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/168/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/168/events", "html_url": "https://github.com/django/daphne/issues/168", "id": 296861525, "node_id": "MDU6SXNzdWUyOTY4NjE1MjU=", "number": 168, "title": "Is there are auto mechanism of websocket_connect_timeout?", "user": {"login": "hongmingu", "id": 19422933, "node_id": "MDQ6VXNlcjE5NDIyOTMz", "avatar_url": "https://avatars2.githubusercontent.com/u/19422933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hongmingu", "html_url": "https://github.com/hongmingu", "followers_url": "https://api.github.com/users/hongmingu/followers", "following_url": "https://api.github.com/users/hongmingu/following{/other_user}", "gists_url": "https://api.github.com/users/hongmingu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hongmingu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hongmingu/subscriptions", "organizations_url": "https://api.github.com/users/hongmingu/orgs", "repos_url": "https://api.github.com/users/hongmingu/repos", "events_url": "https://api.github.com/users/hongmingu/events{/privacy}", "received_events_url": "https://api.github.com/users/hongmingu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-02-13T19:43:20Z", "updated_at": "2018-02-13T22:12:41Z", "closed_at": "2018-02-13T20:42:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, Thanks for this great package. \r\n\r\nActually, while considering implementing channels, I read some issue : https://github.com/django/channels/issues/293\r\n\r\nAt that issue, as your answer, I skimmed daphne.\r\n\r\nSo I found that lines of code.\r\n\r\n        websocket_timeout=86400,\r\n        websocket_connect_timeout=20,\r\n        ping_interval=20,\r\n        ping_timeout=30,\r\n\r\nBecause I'm newbie in programming and python, I want to ask these means that there are auto check system that for removing dead websocket connection.\r\n\r\nAm I understanding it properly?\r\n\r\nIf I am right, Is it okay that I take it for granted that auto check system will trigger 'channels' websocket disconnect method?\r\n\r\nThanks for reading my poor writing.", "performed_via_github_app": null, "score": 1.0}, {"url": "https://api.github.com/repos/django/daphne/issues/167", "repository_url": "https://api.github.com/repos/django/daphne", "labels_url": "https://api.github.com/repos/django/daphne/issues/167/labels{/name}", "comments_url": "https://api.github.com/repos/django/daphne/issues/167/comments", "events_url": "https://api.github.com/repos/django/daphne/issues/167/events", "html_url": "https://github.com/django/daphne/issues/167", "id": 296515860, "node_id": "MDU6SXNzdWUyOTY1MTU4NjA=", "number": 167, "title": "Don't server Static Files.", "user": {"login": "darwinv", "id": 10063069, "node_id": "MDQ6VXNlcjEwMDYzMDY5", "avatar_url": "https://avatars2.githubusercontent.com/u/10063069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/darwinv", "html_url": "https://github.com/darwinv", "followers_url": "https://api.github.com/users/darwinv/followers", "following_url": "https://api.github.com/users/darwinv/following{/other_user}", "gists_url": "https://api.github.com/users/darwinv/gists{/gist_id}", "starred_url": "https://api.github.com/users/darwinv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/darwinv/subscriptions", "organizations_url": "https://api.github.com/users/darwinv/orgs", "repos_url": "https://api.github.com/users/darwinv/repos", "events_url": "https://api.github.com/users/darwinv/events{/privacy}", "received_events_url": "https://api.github.com/users/darwinv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 439649777, "node_id": "MDU6TGFiZWw0Mzk2NDk3Nzc=", "url": "https://api.github.com/repos/django/daphne/labels/blocked/user-response", "name": "blocked/user-response", "color": "f9d0c4", "default": false, "description": null}, {"id": 303174328, "node_id": "MDU6TGFiZWwzMDMxNzQzMjg=", "url": "https://api.github.com/repos/django/daphne/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-02-12T20:37:43Z", "updated_at": "2018-09-21T05:26:14Z", "closed_at": "2018-02-13T01:27:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "I already commented to Andrew via Twitterr.I have the most recent versions of channels, daphne and asgi-ref, and the static files doesn't load.\r\n\r\n On version 1.1.8 works Well. I already have the staticfiles turned on as an app", "performed_via_github_app": null, "score": 1.0}]}